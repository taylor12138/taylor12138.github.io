<!DOCTYPE HTML>
<html lang="zh-CN">


<head>
    <meta charset="utf-8">
    <meta name="keywords" content="Vite, Hexo">
    <meta name="description" content="">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <!-- Global site tag (gtag.js) - Google Analytics -->


    <title>Vite | Hexo</title>
    <link rel="icon" type="image/png" href="/favicon.png">

    <link rel="stylesheet" type="text/css" href="/libs/awesome/css/all.css">
    <link rel="stylesheet" type="text/css" href="/libs/materialize/materialize.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/aos/aos.css">
    <link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css">
    <link rel="stylesheet" type="text/css" href="/css/matery.css">
    <link rel="stylesheet" type="text/css" href="/css/my.css">

    <script src="/libs/jquery/jquery.min.js"></script>

<meta name="generator" content="Hexo 4.2.1"><link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css"></head>


<body>
    <header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper container">
            <div class="brand-logo">
                <a href="/" class="waves-effect waves-light">
                    
                    <img src="/medias/logo.png" class="logo-img" alt="LOGO">
                    
                    <span class="logo-span">Hexo</span>
                </a>
            </div>
            

<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fas fa-bars"></i></a>
<ul class="right nav-menu">
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/" class="waves-effect waves-light">
      
      <i class="fas fa-home" style="zoom: 0.6;"></i>
      
      <span>首页</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/tags" class="waves-effect waves-light">
      
      <i class="fas fa-tags" style="zoom: 0.6;"></i>
      
      <span>标签</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/categories" class="waves-effect waves-light">
      
      <i class="fas fa-bookmark" style="zoom: 0.6;"></i>
      
      <span>分类</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/archives" class="waves-effect waves-light">
      
      <i class="fas fa-archive" style="zoom: 0.6;"></i>
      
      <span>归档</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/about" class="waves-effect waves-light">
      
      <i class="fas fa-user-circle" style="zoom: 0.6;"></i>
      
      <span>关于</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/contact" class="waves-effect waves-light">
      
      <i class="fas fa-comments" style="zoom: 0.6;"></i>
      
      <span>留言板</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/friends" class="waves-effect waves-light">
      
      <i class="fas fa-grin-stars" style="zoom: 0.6;"></i>
      
      <span>友情链接</span>
    </a>
    
  </li>
  
  <li>
    <a href="#searchModal" class="modal-trigger waves-effect waves-light">
      <i id="searchIcon" class="fas fa-search" title="搜索" style="zoom: 0.85;"></i>
    </a>
  </li>
</ul>


<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <img src="/medias/logo.png" class="logo-img circle responsive-img">
        
        <div class="logo-name">Hexo</div>
        <div class="logo-desc">
            
            Never really desperate, only the lost of the soul.
            
        </div>
    </div>

    

    <ul class="menu-list mobile-menu-list">
        
        <li class="m-nav-item">
	  
		<a href="/" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-home"></i>
			
			首页
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/tags" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-tags"></i>
			
			标签
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/categories" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-bookmark"></i>
			
			分类
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/archives" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-archive"></i>
			
			归档
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/about" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-user-circle"></i>
			
			关于
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/contact" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-comments"></i>
			
			留言板
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/friends" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-grin-stars"></i>
			
			友情链接
		</a>
          
        </li>
        
        
        <li><div class="divider"></div></li>
        <li>
            <a href="https://github.com/blinkfox/hexo-theme-matery" class="waves-effect waves-light" target="_blank">
                <i class="fab fa-github-square fa-fw"></i>Fork Me
            </a>
        </li>
        
    </ul>
</div>


        </div>

        
            <style>
    .nav-transparent .github-corner {
        display: none !important;
    }

    .github-corner {
        position: absolute;
        z-index: 10;
        top: 0;
        right: 0;
        border: 0;
        transform: scale(1.1);
    }

    .github-corner svg {
        color: #0f9d58;
        fill: #fff;
        height: 64px;
        width: 64px;
    }

    .github-corner:hover .octo-arm {
        animation: a 0.56s ease-in-out;
    }

    .github-corner .octo-arm {
        animation: none;
    }

    @keyframes a {
        0%,
        to {
            transform: rotate(0);
        }
        20%,
        60% {
            transform: rotate(-25deg);
        }
        40%,
        80% {
            transform: rotate(10deg);
        }
    }
</style>

<a href="https://github.com/blinkfox/hexo-theme-matery" class="github-corner tooltipped hide-on-med-and-down" target="_blank"
   data-tooltip="Fork Me" data-position="left" data-delay="50">
    <svg viewBox="0 0 250 250" aria-hidden="true">
        <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
        <path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2"
              fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
        <path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z"
              fill="currentColor" class="octo-body"></path>
    </svg>
</a>
        
    </nav>

</header>

    



<div class="bg-cover pd-header post-cover" style="background-image: url('/medias/featureimages/12.jpg')">
    <div class="container" style="right: 0px;left: 0px;">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <h1 class="description center-align post-title">Vite</h1>
                </div>
            </div>
        </div>
    </div>
</div>




<main class="post-container content">

    
    <link rel="stylesheet" href="/libs/tocbot/tocbot.css">
<style>
    #articleContent h1::before,
    #articleContent h2::before,
    #articleContent h3::before,
    #articleContent h4::before,
    #articleContent h5::before,
    #articleContent h6::before {
        display: block;
        content: " ";
        height: 100px;
        margin-top: -100px;
        visibility: hidden;
    }

    #articleContent :focus {
        outline: none;
    }

    .toc-fixed {
        position: fixed;
        top: 64px;
    }

    .toc-widget {
        width: 345px;
        padding-left: 20px;
    }

    .toc-widget .toc-title {
        margin: 35px 0 15px 0;
        padding-left: 17px;
        font-size: 1.5rem;
        font-weight: bold;
        line-height: 1.5rem;
    }

    .toc-widget ol {
        padding: 0;
        list-style: none;
    }

    #toc-content {
        height: calc(100vh - 250px);
        overflow: auto;
    }

    #toc-content ol {
        padding-left: 10px;
    }

    #toc-content ol li {
        padding-left: 10px;
    }

    #toc-content .toc-link:hover {
        color: #42b983;
        font-weight: 700;
        text-decoration: underline;
    }

    #toc-content .toc-link::before {
        background-color: transparent;
        max-height: 25px;

        position: absolute;
        right: 23.5vw;
        display: block;
    }

    .toc-fixed .toc-link::before{
        position: fixed!important;/*当toc的位置改为fixed时，.toc-link::before也要改为fixed*/
    }

    #toc-content .is-active-link {
        color: #42b983;
    }

    #toc-content .is-active-link::before {
        background-color: #42b983;
    }

    #floating-toc-btn {
        position: fixed;
        right: 15px;
        bottom: 76px;
        padding-top: 15px;
        margin-bottom: 0;
        z-index: 998;
    }

    #floating-toc-btn .btn-floating {
        width: 48px;
        height: 48px;
    }

    #floating-toc-btn .btn-floating i {
        line-height: 48px;
        font-size: 1.4rem;
    }
</style>
<div class="row">
    <div id="main-content" class="col s12 m12 l9">
        <!-- 文章内容详情 -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                          <div class="article-tag">
                            <span class="chip bg-color">无标签</span>
                          </div>
                    
                </div>
                <div class="col s5 right-align">
                    
                    <div class="post-cate">
                        <i class="fas fa-bookmark fa-fw icon-category"></i>
                        
                            <a href="/categories/%E5%89%8D%E7%AB%AF/" class="post-category">
                                前端
                            </a>
                        
                    </div>
                    
                </div>
            </div>

            <div class="post-info">
                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-minus fa-fw"></i>发布日期:&nbsp;&nbsp;
                    2023-03-01
                </div>
                

                

                
                <div class="info-break-policy">
                    <i class="far fa-file-word fa-fw"></i>文章字数:&nbsp;&nbsp;
                    3.7k
                </div>
                

                

                
                    <div id="busuanzi_container_page_pv" class="info-break-policy">
                        <i class="far fa-eye fa-fw"></i>阅读次数:&nbsp;&nbsp;
                        <span id="busuanzi_value_page_pv"></span>
                    </div>
				
            </div>
        </div>
        <hr class="clearfix">
        <div class="card-content article-card-content">
            <div id="articleContent">
                <h2 id="Vite概述"><a href="#Vite概述" class="headerlink" title="Vite概述"></a>Vite概述</h2><p>Webpack是前端使用最多的构建工具，但是除了webpack还有一些其他的构建工具，比如rollup、parcel、gulp、vite</p>
<p> <em>Vite</em> 是 vue 的作者尤雨溪在开发 vue3.0 的时候开发的一个基于原生 <strong>ES-Module</strong> 的前端构建工具</p>
<p>Vite官方的定位：下一代前端开发和构建工具</p>
<p>他主要由两部分组成</p>
<ul>
<li>一个开发服务器，它基于原生ES模块提供了丰富的内建功能，并且借助 Esbuild 超快的编译速度来做第三方库构建和 TS/JSX 语法编译，这使得HMR速度非常快</li>
<li>一套构建指令，它使用rollup打包我们的代码（使用rollup打包功能），并且它是预配置的，输出生成环境优化过的静态资源</li>
</ul>
<p>所以构建过程中 Vite 中仍然使用 Esbuild 进行编译和压缩，但打包留给 Rollup。所以 esbuild 用于构建过程的一部分。</p>
<p><img src="/2023/03/01/vite/engine.png" alt></p>
<p>图片源自神三元的《深入浅出vite》</p>
<p>Vite初衷就是依赖浏览器本身就识别的依赖关系直接将js解析呈现，而不考虑其他</p>
<p>Vite 所倡导的<code>no-bundle</code>理念的真正含义: <strong>利用浏览器原生 ES 模块的支持，实现开发阶段的 Dev Server，进行模块的按需加载</strong>，而不是<strong>先整体打包再进行加载</strong></p>
<p>优点：</p>
<p>快，构建快、冷启动快、热更新快。快在哪？</p>
<p>开发阶段：</p>
<ol>
<li>使用esbuild进行了预构建</li>
<li>esbuild本身的打包速度快</li>
<li>本身的no-bundle，懒加载</li>
<li>使用<a href="https://github.com/vitejs/vite-plugin-react-swc" target="_blank" rel="noopener">@vitejs/plugin-react-swc</a>，在开发阶段，将 Babel 替换为 SWC，冷启动和模块热替换（HMR）将会有显著提升</li>
</ol>
<p>生产环境：</p>
<ol>
<li>预构建阶段，编译能力依然用到了esbuild（Transformer），对 TS(X)/JS(X) 进行编译，所以快（但是vite的一些默认React 预设使用 Babel 来转换 React HMR 和 JSX。）</li>
<li>从vite2.6开始，自动启用esbuild对代码压缩（esbuild的压缩速度是要比webpack的terser快的）</li>
</ol>
<p>但是缺点就是：</p>
<ul>
<li>如果包依赖太多，会发送过多的网络请求（import 语句即代表一个 HTTP 请求）</li>
<li>一些兼容性问题，在官网的issue可以看到</li>
<li>写自己插件有需要的话，也要同时兼容 <code>rollup</code> 和 <code>esbuild</code></li>
</ul>
<p>Vite将基于原生浏览器的特点，解决以上缺点</p>
<p>还有尤大怼人的相关链接：<a href="https://juejin.cn/post/7161356191614894088" target="_blank" rel="noopener">尤雨溪：Turbopack 真的比 Vite 快 10 倍吗？</a></p>
<h4 id="Esbuild"><a href="#Esbuild" class="headerlink" title="Esbuild"></a>Esbuild</h4><p>esbuild 是一个用 Go 语言编写的用于打包，（自带压缩）压缩  Javascript 代码的工具库（类似webpack的构建工具）</p>
<p>优点：编译、构建速度快</p>
<p>为什么这么快？</p>
<ul>
<li><p>它是用 Go 语言编写的，该语言可以编译为本地代码</p>
</li>
<li><p>解析，生成最终打包文件和生成 source maps 的操作全部完全并行化</p>
</li>
<li><p>无需昂贵的数据转换，没有使用第三方依赖，只需很少的几步即可完成所有操作</p>
<p>在 Webpack、Rollup 这类工具中，我们不得不使用很多<strong>额外的第三方插件来解决各种工程需求</strong>，比如：</p>
<ul>
<li>使用 babel 实现 ES 版本转译</li>
<li>使用 eslint 实现代码检查</li>
<li>使用 TSC 实现 ts 代码转译与代码检查</li>
<li>使用 less、stylus、sass 等 css 预处理工具</li>
</ul>
<p>但是Esbuild 完全重写整套编译流程所需要用到的所有工具</p>
</li>
<li><p>该库以提高编译速度为编写代码时的第一原则，并尽量避免不必要的内存分配（go的能力）</p>
</li>
</ul>
<p>缺点：</p>
<ol>
<li><p>babel插件问题</p>
<p>为了保证 esbuild 的编译效率，esbuild 没有提供 AST 的操作能力。所以一些通过 AST 处理代码的 babel-plugin 没有很好的方法过渡到 esbuild 中（比如 babel-plugin-import）</p>
</li>
<li><p>作为打包工具的话，<code>代码分割</code>和 <code>CSS处理</code>方面 较差</p>
</li>
<li><p>虽然自带（捆绑）了压缩功能，但是在 esbuild 命令中使用“ <a href="https://esbuild.github.io/api/#minify" target="_blank" rel="noopener">minify</a> ”和“ <a href="https://esbuild.github.io/api/#bundle" target="_blank" rel="noopener">bundle</a> ”选项不会创建与<a href="https://rollupjs.org/" target="_blank" rel="noopener">Rollup</a> / <a href="https://terser.org/" target="_blank" rel="noopener">Terser</a>管道一样小的包。这是因为 esbuild 牺牲了一些包大小优化以尽可能少地通过您的代码。但是，差异可能可以忽略不计，并且对于提高捆绑速度来说是值得的，具体取决于您的项目。</p>
</li>
</ol>
<p>在生产环境下使用 esbuild 是可行的。像 snowpack , vite 等构建工具都已经是用了 esbuild 作为代码处理工具（稳定性已经足够）。如果你一定要使用，可以看看是否符合下面标准</p>
<ol>
<li>没有使用一些自定义的 babel-plugin (如 babel-plugin-import)</li>
<li>不需要兼容一些低版本浏览器（esbuild 只能将代码转成 es6） 那你就可以大胆使用 esbuild-loader 为你的项目提效了</li>
</ol>
<h4 id="rollup"><a href="#rollup" class="headerlink" title="rollup"></a>rollup</h4><p>Rollup 也是前端模块化的一个打包工具，它的开发本意，是打造一款简单易用的 ES 模块打包（和esbuild天然配合）工具，<strong>不必配置，直接使用</strong></p>
<p>优点：</p>
<ul>
<li>不必配置，直接食用，对 tree shaking 有着良好的支持，产物非常干净，支持多种输出格式，适合做库的开发</li>
<li>rollup插件思路很棒，Vite的插件写法就是模仿rollup的，甚至有不少 Rollup 插件可以直接复用到 Vite 。</li>
</ul>
<p>注意：如果你想用rollup打包commonjs，比如项目中用了lodash，那要走和webpack一样麻烦的配置流程，那还不如用webpack</p>
<ul>
<li>如果你需要 code-splitting，有很多 static assets，需要使用很多 CommonJS 依赖，使用 Webpack</li>
<li>如果你的 codebase 是ES Module，写一些给其他人使用的代码或库，那么使用 Rollup</li>
</ul>
<h4 id="webpack"><a href="#webpack" class="headerlink" title="webpack"></a>webpack</h4><p>优点：</p>
<ul>
<li>兼容性无敌</li>
<li>生态强大，插件、loader强大，灵活</li>
</ul>
<p>所以适合大型项目</p>
<p>缺点：</p>
<ul>
<li>上手麻烦，冷启动，热更新慢</li>
</ul>
<h2 id="性能测试-该数据测试截止于2022-4"><a href="#性能测试-该数据测试截止于2022-4" class="headerlink" title="性能测试(该数据测试截止于2022.4)"></a>性能测试(该数据测试截止于2022.4)</h2><p>打包工具特性对比总览</p>
<p><img src="/2023/03/01/vite/all.png" alt></p>
<h4 id="打包速度"><a href="#打包速度" class="headerlink" title="打包速度"></a>打包速度</h4><p>测试打包 antd + lodash + react + react-dom + three.js 的速度。为了控制变量，统一采用 esbuild 作为 minifier（spack 不支持除外）。</p>
<p><a href="https://github.com/guoyunhe/benchmark-bundlers" target="_blank" rel="noopener">测试数据来源</a></p>
<table>
<thead>
<tr>
<th></th>
<th>webpack</th>
<th>rollup</th>
<th>parcel</th>
<th>esbuild</th>
<th>spack</th>
</tr>
</thead>
<tbody><tr>
<td>ThinkPad T480</td>
<td>5.347s</td>
<td>14.548s</td>
<td>6.069s</td>
<td>0.249s</td>
<td>1.082s</td>
</tr>
<tr>
<td>MacBook 16, 2019</td>
<td>4.229s</td>
<td>12.790s</td>
<td>5.225s</td>
<td>0.227s</td>
<td>1.012s</td>
</tr>
</tbody></table>
<p>打包速度上首当其冲的就是esbuild，毋庸置疑，，spack（swcpack）也挺快的，但令人意外的是， webpack 居然比 parcel 和 rollup 更快。尤其是 rollup 的性能，令人意外地差。有可能是因为 lodash 和 react 都是 CJS 模块，rollup 需要将其转化成 ESM 才能使用，这才降低了rollup的速度</p>
<h4 id="包体积"><a href="#包体积" class="headerlink" title="包体积"></a>包体积</h4><p><a href="https://github.com/guoyunhe/benchmark-js-minifiers" target="_blank" rel="noopener">测试数据来源</a></p>
<table>
<thead>
<tr>
<th></th>
<th>no-minify</th>
<th>terser</th>
<th>esbuild</th>
<th>swc</th>
</tr>
</thead>
<tbody><tr>
<td>产物尺寸</td>
<td>4.7MB</td>
<td>1.8MB</td>
<td>1.9MB</td>
<td>1.9MB</td>
</tr>
<tr>
<td>运行时间 ThinkPad T480</td>
<td>4.677s</td>
<td>17.046s</td>
<td>5.615s</td>
<td>8.997s</td>
</tr>
<tr>
<td>运行时间 MacBook 16, 2019</td>
<td>3.556s</td>
<td>13.834s</td>
<td>4.052s</td>
<td>6.892s</td>
</tr>
</tbody></table>
<p>webpack v5 开箱即带有最新版本的 <code>terser-webpack-plugin</code>，这次对比的是 terser、esbuild和swc的压缩能力，terser是用node.js、esbuild使用go、swc使用rust， 对于这类高计算量任务，node.js的性能比原生程序差得多。但是从压缩结果来没什么差距</p>
<h4 id="编译特性对比"><a href="#编译特性对比" class="headerlink" title="编译特性对比"></a>编译特性对比</h4><table>
<thead>
<tr>
<th></th>
<th>babel</th>
<th>esbuild</th>
<th>swc</th>
</tr>
</thead>
<tbody><tr>
<td>ES Next</td>
<td>✅</td>
<td>✅</td>
<td>✅</td>
</tr>
<tr>
<td>ES5, IE11</td>
<td>✅</td>
<td>❌</td>
<td>✅</td>
</tr>
<tr>
<td>JS 修饰器语法</td>
<td>✅</td>
<td>❌</td>
<td>❌</td>
</tr>
<tr>
<td>Flow 语言</td>
<td>✅</td>
<td>❌</td>
<td>❌</td>
</tr>
<tr>
<td>TypeScript 语言</td>
<td>✅</td>
<td>✅</td>
<td>✅</td>
</tr>
<tr>
<td>TS 修饰器语法</td>
<td>✅</td>
<td>✅</td>
<td>✅</td>
</tr>
<tr>
<td>JSX</td>
<td>✅</td>
<td>✅</td>
<td>✅</td>
</tr>
<tr>
<td>运行时间在ThinkPad T480编译速度</td>
<td>10.133s</td>
<td>0.464s</td>
<td>0.549s</td>
</tr>
</tbody></table>
<p>从特性上来看，babel 依旧是最全面的，而esbuild 和 swc 则注重对最新 ES 标准的支持，并且esbuild对旧版本兼容性一般，这也是为什么vite生产环境用rollup的原因吧</p>
<p>小总结： webpack 仍然是最全面的 Bundler 选择，支持特性最丰富，生态最为庞大。而且它的性能并不差，某些打包场景要优于 rollup 和 parcel；而esbuild、SWC等潜力也很大，vite有意在esbuild生态完善后全面使用，而不是参合着rollup，同时也用SWC取代babel的位置</p>
<h2 id="CRA和Vite"><a href="#CRA和Vite" class="headerlink" title="CRA和Vite"></a>CRA和Vite</h2><p>在业界，使用<code>CRA</code>已经成为了创建<code>React应用</code>约定俗成的惯例。它确实是个好办法，多年来也一直在迭代升级。</p>
<pre class=" language-bash"><code class="language-bash">npx create-react-app my-app
<span class="token function">cd</span> my-app
<span class="token function">npm</span> start</code></pre>
<p>然而，<code>CRA</code>也有自身的痛点（也是<code>Vite</code>力主提升的方向）：当项目体积变大，开发时间和构建时间也会大幅增加。<strong>原因是，无论进行任何更改，<code>CRA</code>都会全量的重新构建应用。</strong></p>
<p><img src="/2023/03/01/vite/cra.png" alt></p>
<p>而vite不同</p>
<p>不同于<code>CRA</code>的全量构建，<code>Vite</code>是按需构建的。<code>Vite</code>将一个应用分为两个部分：依赖和源码。</p>
<h4 id="依赖"><a href="#依赖" class="headerlink" title="依赖"></a>依赖</h4><p>依赖在开发过程中，基本不会变动。<code>Vite</code>使用<a href="https://link.juejin.cn?target=https%3A%2F%2Fesbuild.docschina.org%2F"><code>esbuild</code></a>（基于Go语言，比传统JS要快10-100倍）预打包了依赖，而且由于依赖变动极少，所以会被缓存起来以节省大量时间。</p>
<h4 id="源码"><a href="#源码" class="headerlink" title="源码"></a>源码</h4><p>源码采用了ESM（ECMAScript modules）作为模块体系。好处是无需打包，按需加载，从图中我们可以看到那种按需的感觉</p>
<p><img src="/2023/03/01/vite/cra2.png" alt></p>
<h2 id="Vite的预构建"><a href="#Vite的预构建" class="headerlink" title="Vite的预构建"></a>Vite的预构建</h2><p>Vite预构建主要是为了</p>
<ol>
<li><strong>CommonJS 和 UMD 兼容性</strong>：本地开发依赖于esbuild，所以需要代码转换成esm才能正常编译 + 构建，但是目前一些模块并不是esm，比如react、lodash，所以此时预构建起到一个转换的作用</li>
<li><strong>性能：</strong>：由于vite的no-bundle性质，每一个import都对应一个请求，对于像lodash这种依赖层级深、涉及模块数量多的依赖包，直接回引发瀑布流请求，而预构建会帮忙直接把这种依赖层级深的包打包成一个文件，直接引入，这样会减少请求次数</li>
</ol>
<p>vite默认自动开启，在项目启动成功后，你可以在根目录下的<code>node_modules</code>中发现<code>.vite</code>目录，这就是预构建产物文件存放的目录</p>
<p>当然，我们也可以自定义预构建配置，通过在vite.config.js里面进行更改optimizeDeps选项，可以自定义添加预构建入口<code>entries</code>、以来添加<code>include</code>、手动取消<code>exclude</code>，详情可查看：<a href="https://cn.vitejs.dev/config/dep-optimization-options.html" target="_blank" rel="noopener">这里</a></p>
<h2 id="Vite安装和使用"><a href="#Vite安装和使用" class="headerlink" title="Vite安装和使用"></a>Vite安装和使用</h2><h4 id="start"><a href="#start" class="headerlink" title="start"></a>start</h4><p>Node版本 &gt;= 12版本</p>
<p>安装一个完整的项目(直接上脚手架)</p>
<pre class=" language-shell"><code class="language-shell">npm init @vitejs/app</code></pre>
<p>相当于</p>
<pre class=" language-shell"><code class="language-shell">npm i @vuejs/create-app
create-app</code></pre>
<p>或者入门的话老师推荐先安装vite工具</p>
<pre class=" language-shell"><code class="language-shell">npm install vite -g</code></pre>
<p>or</p>
<pre class=" language-shell"><code class="language-shell">npm i vite -D</code></pre>
<p>开启vite服务器使用：</p>
<pre class=" language-shell"><code class="language-shell">npx vite</code></pre>
<p>vite打包</p>
<pre class=" language-shell"><code class="language-shell">npx vite build</code></pre>
<h4 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h4><p>我们可以直接用<code>vite.config.ts</code>作为配置文件</p>
<ol>
<li>为避免类型报错，你需要通过 <code>pnpm i @types/node -D</code> 安装类型</li>
<li>tsconfig.node.json 中设置 <code>allowSyntheticDefaultImports: true</code>，以允许下面的 default 导入方式</li>
</ol>
<pre class=" language-ts"><code class="language-ts"><span class="token comment" spellcheck="true">// vite.config.ts</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> defineConfig <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vite'</span>
<span class="token keyword">import</span> path <span class="token keyword">from</span> <span class="token string">'path'</span>
<span class="token keyword">import</span> react <span class="token keyword">from</span> <span class="token string">'@vitejs/plugin-react'</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">defineConfig</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token comment" spellcheck="true">// 手动指定项目根目录位置(html的根目录)</span>
  root<span class="token punctuation">:</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'src'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token comment" spellcheck="true">//配置了官方的 react 插件</span>
  plugins<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token function">react</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre>
<p>配置别名</p>
<pre class=" language-js"><code class="language-js"><span class="token comment" spellcheck="true">// vite.config.ts</span>
<span class="token keyword">import</span> path <span class="token keyword">from</span> <span class="token string">'path'</span><span class="token punctuation">;</span>

<span class="token punctuation">{</span>
  resolve<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token comment" spellcheck="true">// 别名配置</span>
    alias<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      <span class="token string">'@assets'</span><span class="token punctuation">:</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'src/assets'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
<h2 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h2><p>没有像webpack一样的loader，比如要使用less文件，直接</p>
<pre class=" language-shell"><code class="language-shell">npm install less -D</code></pre>
<p>重新跑vite即可</p>
<p>vite默认支持TS</p>
<p>vite服务器内部Connect会对我们的请求做转发，完成less -&gt; js、ts -&gt; js，然后浏览器得到编译后的js代码</p>
<p>Vite1搭建的服务器为koa，而Vite2搭建的服务器为connect</p>
<h4 id="Vite对Vue的支持"><a href="#Vite对Vue的支持" class="headerlink" title="Vite对Vue的支持"></a>Vite对Vue的支持</h4><p>Vue3单文件组件支持： @vitejs/plugin-vue</p>
<p>Vue3 JSX支持： @vite/plugin-vue-jsx</p>
<p>Vue 2支持：underfin/vite-plugin-vue2</p>
<p>比如加入vue3的支持(@vue/complier-sfc负责编译vue文件)</p>
<pre class=" language-shell"><code class="language-shell">npm i @vitejs/plugin-vue -D
npm i @vue/complier-sfc -D</code></pre>
<p>vite的配置</p>
<p>在目录下新建vite.config.js文件，并将配置文件导出</p>
<pre class=" language-js"><code class="language-js"><span class="token keyword">const</span> vue <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'@vitejs/plugin-vue'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    plugins<span class="token punctuation">:</span> <span class="token punctuation">[</span>
        <span class="token function">vue</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span></code></pre>
<h4 id="用esbuild起一个服务"><a href="#用esbuild起一个服务" class="headerlink" title="用esbuild起一个服务"></a>用esbuild起一个服务</h4><p>（类似 webpack-dev-server）</p>
<p>首先在根目录下创建build.js</p>
<pre class=" language-js"><code class="language-js"><span class="token comment" spellcheck="true">// build.js</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> build<span class="token punctuation">,</span> buildSync<span class="token punctuation">,</span> serve <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"esbuild"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">runBuild</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">serve</span><span class="token punctuation">(</span>
    <span class="token punctuation">{</span>
      port<span class="token punctuation">:</span> <span class="token number">8000</span><span class="token punctuation">,</span>
      <span class="token comment" spellcheck="true">// 静态资源目录</span>
      servedir<span class="token punctuation">:</span> <span class="token string">'./dist'</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
      absWorkingDir<span class="token punctuation">:</span> process<span class="token punctuation">.</span><span class="token function">cwd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      entryPoints<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">"./src/index.jsx"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      bundle<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      format<span class="token punctuation">:</span> <span class="token string">"esm"</span><span class="token punctuation">,</span>
      splitting<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      sourcemap<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      ignoreAnnotations<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      metafile<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span>server<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"HTTP Server starts at port"</span><span class="token punctuation">,</span> server<span class="token punctuation">.</span>port<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token function">runBuild</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<h4 id="直接调vite的服务进行启动"><a href="#直接调vite的服务进行启动" class="headerlink" title="直接调vite的服务进行启动"></a>直接调vite的服务进行启动</h4><p> <a href="https://cn.vitejs.dev/guide/api-javascript.html#createserver" target="_blank" rel="noopener">createServer Api</a>，这就意味着无论在什么类型的项目中，只要提供给这个 API 准确的入参，就能启动 vite 服务。</p>
<h4 id="vite插件-钩子"><a href="#vite插件-钩子" class="headerlink" title="vite插件 钩子"></a>vite插件 钩子</h4><p><strong>通用钩子</strong></p>
<p>在开发中，Vite 开发服务器会创建一个插件容器来调用 <a href="https://rollupjs.org/plugin-development/#build-hooks" target="_blank" rel="noopener">Rollup 构建钩子</a>，与 Rollup 如出一辙。</p>
<p>以下钩子在服务器启动时被调用：</p>
<ul>
<li><a href="https://rollupjs.org/plugin-development/#options" target="_blank" rel="noopener"><code>options</code></a></li>
<li><a href="https://rollupjs.org/plugin-development/#buildstart" target="_blank" rel="noopener"><code>buildStart</code></a></li>
</ul>
<p>以下钩子会在每个传入模块<strong>请求</strong>时被调用：</p>
<ul>
<li><a href="https://rollupjs.org/plugin-development/#resolveid" target="_blank" rel="noopener"><code>resolveId</code></a></li>
<li><a href="https://rollupjs.org/plugin-development/#load" target="_blank" rel="noopener"><code>load</code></a></li>
<li><a href="https://rollupjs.org/plugin-development/#transform" target="_blank" rel="noopener"><code>transform</code></a></li>
</ul>
<p>它们还有一个扩展的 <code>options</code> 参数，包含其他特定于 Vite 的属性。你可以在 <a href="https://cn.vitejs.dev/guide/ssr.html#ssr-specific-plugin-logic" target="_blank" rel="noopener">SSR 文档</a> 中查阅更多内容。</p>
<p>以下钩子在服务器关闭时被调用：</p>
<ul>
<li><a href="https://rollupjs.org/plugin-development/#buildend" target="_blank" rel="noopener"><code>buildEnd</code></a></li>
<li><a href="https://rollupjs.org/plugin-development/#closebundle" target="_blank" rel="noopener"><code>closeBundle</code></a></li>
</ul>
<p>请注意 <a href="https://rollupjs.org/plugin-development/#moduleparsed" target="_blank" rel="noopener"><code>moduleParsed</code></a> 钩子在开发中是 <strong>不会</strong> 被调用的，因为 Vite 为了性能会避免完整的 AST 解析。</p>
<p><a href="https://rollupjs.org/plugin-development/#output-generation-hooks" target="_blank" rel="noopener">Output Generation Hooks</a>（除了 <code>closeBundle</code>) 在开发中是 <strong>不会</strong> 被调用的。你可以认为 Vite 的开发服务器只调用了 <code>rollup.rollup()</code> 而没有调用 <code>bundle.generate()</code>。</p>
<p><strong>特有钩子</strong></p>
<ul>
<li><p>config</p>
<p>在读取完<code>vite.config.ts</code>后执行该钩子</p>
</li>
<li><p>configResolved</p>
<p>使用这个钩子读取和存储最终解析的配置。当插件需要根据运行的命令做一些不同的事情时，它也很有用，但是不建议再修改配置</p>
</li>
<li><p>configureServer</p>
<p>是用于配置开发服务器的钩子。最常见的用例是在内部 <a href="https://github.com/senchalabs/connect" target="_blank" rel="noopener">connect</a> 应用程序中添加自定义中间件:</p>
</li>
<li><p>configurePreviewServer</p>
<p>与 <a href="https://cn.vitejs.dev/guide/api-plugin.html#configureserver" target="_blank" rel="noopener"><code>configureServer</code></a> 相同但是作为预览服务器。它提供了一个 <a href="https://github.com/senchalabs/connect" target="_blank" rel="noopener">connect</a> 服务器实例及其底层的 <a href="https://nodejs.org/api/http.html" target="_blank" rel="noopener">http server</a>。与 <code>configureServer</code> 类似，<code>configurePreviewServer</code> 这个钩子也是在其他中间件安装前被调用的。如果你想要在其他中间件 <strong>之后</strong> 安装一个插件，你可以从 <code>configurePreviewServer</code> 返回一个函数，它将会在内部中间件被安装之后再调用</p>
<pre class=" language-js"><code class="language-js"><span class="token keyword">const</span> myPlugin <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
  name<span class="token punctuation">:</span> <span class="token string">'configure-preview-server'</span><span class="token punctuation">,</span>
  <span class="token function">configurePreviewServer</span><span class="token punctuation">(</span>server<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment" spellcheck="true">// 返回一个钩子，会在其他中间件安装完成后调用</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>
      server<span class="token punctuation">.</span>middlewares<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token punctuation">(</span>req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>
        <span class="token comment" spellcheck="true">// 自定义处理请求 ...</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre>
</li>
<li><p>transformIndexHtml</p>
<p>这个钩子用来灵活控制 HTML 的内容，你可以拿到原始的 html 内容后进行任意的转换</p>
</li>
<li><p>handleHotUpdate</p>
<p>这个钩子会在 Vite 服务端处理热更新时被调用，你可以在这个钩子中拿到热更新相关的上下文信息，进行热更模块的过滤，或者进行自定义的热更处理</p>
</li>
</ul>
<p><strong>普通用户插件钩子执行顺序</strong></p>
<pre class=" language-js"><code class="language-js"><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> testHookPlugin <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      name<span class="token punctuation">:</span> <span class="token string">'test-hooks-plugin'</span><span class="token punctuation">,</span> 
      <span class="token comment" spellcheck="true">// 独有</span>
      <span class="token function">config</span><span class="token punctuation">(</span>config<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'config'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token comment" spellcheck="true">// 独有</span>
      <span class="token function">configResolved</span><span class="token punctuation">(</span>resolvedCofnig<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'configResolved'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token comment" spellcheck="true">// 通用钩子</span>
      <span class="token function">options</span><span class="token punctuation">(</span>opts<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'options'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> opts<span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token comment" spellcheck="true">// 独有</span>
      <span class="token function">configureServer</span><span class="token punctuation">(</span>server<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'configureServer'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>
          <span class="token comment" spellcheck="true">// 手动退出进程</span>
          process<span class="token punctuation">.</span><span class="token function">kill</span><span class="token punctuation">(</span>process<span class="token punctuation">.</span>pid<span class="token punctuation">,</span> <span class="token string">'SIGTERM'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">3000</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token comment" spellcheck="true">// 通用钩子</span>
      <span class="token function">buildStart</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'buildStart'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token comment" spellcheck="true">// 通用钩子</span>
      <span class="token function">buildEnd</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'buildEnd'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token comment" spellcheck="true">// 通用钩子</span>
      <span class="token function">closeBundle</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'closeBundle'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
<p>下图源自神三元的《深入浅出Vite》</p>
<p><img src="/2023/03/01/vite/vite-plugin.png" alt></p>
<p><strong>插件顺序</strong></p>
<p>如果是直接看全部插件种类的顺序则为</p>
<p><img src="/2023/03/01/vite/vite-plugin-2.png" alt></p>
<p>参考文章：</p>
<p><a href="https://juejin.cn/post/7211909301866348604" target="_blank" rel="noopener">【译文】Vite是什么？为何推荐使用Vite代替Create React App？</a></p>
<p><a href="https://juejin.cn/post/6918927987056312327" target="_blank" rel="noopener">ESbuild 介绍</a></p>
<p><a href="https://juejin.cn/book/7050063811973218341" target="_blank" rel="noopener">深入浅出 Vite</a></p>
<p><a href="https://css-tricks.com/comparing-the-new-generation-of-build-tools/" target="_blank" rel="noopener">Comparing the New Generation of Build Tools</a></p>
<p><a href="https://guoyunhe.me/2022/01/24/front-end-build-tool-benchmark/" target="_blank" rel="noopener">前端构建工具测评</a></p>

            </div>
            <hr/>

            

    <div class="reprint" id="reprint-statement">
        
            <div class="reprint__author">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-user">
                        文章作者:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="https://taylor12138.github.io" rel="external nofollow noreferrer">Hello</a>
                </span>
            </div>
            <div class="reprint__type">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-link">
                        文章链接:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="https://taylor12138.github.io/2023/03/01/vite/">https://taylor12138.github.io/2023/03/01/vite/</a>
                </span>
            </div>
            <div class="reprint__notice">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-copyright">
                        版权声明:
                    </i>
                </span>
                <span class="reprint-info">
                    本博客所有文章除特別声明外，均采用
                    <a href="https://creativecommons.org/licenses/by/4.0/deed.zh" rel="external nofollow noreferrer" target="_blank">CC BY 4.0</a>
                    许可协议。转载请注明来源
                    <a href="https://taylor12138.github.io" target="_blank">Hello</a>
                    !
                </span>
            </div>
        
    </div>

    <script async defer>
      document.addEventListener("copy", function (e) {
        let toastHTML = '<span>复制成功，请遵循本文的转载规则</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">查看</a>';
        M.toast({html: toastHTML})
      });

      function navToReprintStatement() {
        $("html, body").animate({scrollTop: $("#reprint-statement").offset().top - 80}, 800);
      }
    </script>



            <div class="tag_share" style="display: block;">
                <div class="post-meta__tag-list" style="display: inline-block;">
                    
                        <div class="article-tag">
                            <span class="chip bg-color">无标签</span>
                        </div>
                    
                </div>
                <div class="post_share" style="zoom: 80%; width: fit-content; display: inline-block; float: right; margin: -0.15rem 0;">
                    <link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css">
<div id="article-share">

    
    <div class="social-share" data-sites="twitter,facebook,google,qq,qzone,wechat,weibo,douban,linkedin" data-wechat-qrcode-helper="<p>微信扫一扫即可分享！</p>"></div>
    <script src="/libs/share/js/social-share.min.js"></script>
    

    

</div>

                </div>
            </div>
            
                <style>
    #reward {
        margin: 40px 0;
        text-align: center;
    }

    #reward .reward-link {
        font-size: 1.4rem;
        line-height: 38px;
    }

    #reward .btn-floating:hover {
        box-shadow: 0 6px 12px rgba(0, 0, 0, 0.2), 0 5px 15px rgba(0, 0, 0, 0.2);
    }

    #rewardModal {
        width: 320px;
        height: 350px;
    }

    #rewardModal .reward-title {
        margin: 15px auto;
        padding-bottom: 5px;
    }

    #rewardModal .modal-content {
        padding: 10px;
    }

    #rewardModal .close {
        position: absolute;
        right: 15px;
        top: 15px;
        color: rgba(0, 0, 0, 0.5);
        font-size: 1.3rem;
        line-height: 20px;
        cursor: pointer;
    }

    #rewardModal .close:hover {
        color: #ef5350;
        transform: scale(1.3);
        -moz-transform:scale(1.3);
        -webkit-transform:scale(1.3);
        -o-transform:scale(1.3);
    }

    #rewardModal .reward-tabs {
        margin: 0 auto;
        width: 210px;
    }

    .reward-tabs .tabs {
        height: 38px;
        margin: 10px auto;
        padding-left: 0;
    }

    .reward-content ul {
        padding-left: 0 !important;
    }

    .reward-tabs .tabs .tab {
        height: 38px;
        line-height: 38px;
    }

    .reward-tabs .tab a {
        color: #fff;
        background-color: #ccc;
    }

    .reward-tabs .tab a:hover {
        background-color: #ccc;
        color: #fff;
    }

    .reward-tabs .wechat-tab .active {
        color: #fff !important;
        background-color: #22AB38 !important;
    }

    .reward-tabs .alipay-tab .active {
        color: #fff !important;
        background-color: #019FE8 !important;
    }

    .reward-tabs .reward-img {
        width: 210px;
        height: 210px;
    }
</style>

<div id="reward">
    <a href="#rewardModal" class="reward-link modal-trigger btn-floating btn-medium waves-effect waves-light red">赏</a>

    <!-- Modal Structure -->
    <div id="rewardModal" class="modal">
        <div class="modal-content">
            <a class="close modal-close"><i class="fas fa-times"></i></a>
            <h4 class="reward-title">你的赏识是我前进的动力</h4>
            <div class="reward-content">
                <div class="reward-tabs">
                    <ul class="tabs row">
                        <li class="tab col s6 alipay-tab waves-effect waves-light"><a href="#alipay">支付宝</a></li>
                        <li class="tab col s6 wechat-tab waves-effect waves-light"><a href="#wechat">微 信</a></li>
                    </ul>
                    <div id="alipay">
                        <img src="/" class="reward-img" alt="支付宝打赏二维码">
                    </div>
                    <div id="wechat">
                        <img src="/medias/reward/wechat.jpg" class="reward-img" alt="微信打赏二维码">
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    $(function () {
        $('.tabs').tabs();
    });
</script>

            
        </div>
    </div>

    

    

    

    

    

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="fas fa-chevron-left"></i>&nbsp;上一篇</div>
            <div class="card">
                <a href="/2023/03/27/monorepo/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/3.jpg" class="responsive-img" alt="Monorepo">
                        
                        <span class="card-title">Monorepo</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            monorepo一个 monorepo 是一个代码库中许多不同应用程序和包的集合。
用于替代polyrepo方案，你可以理解为 monorepo 就是将制定的都项目移动到一个存储库中，这些项目可以相互依赖，因此它们可以共享代码。并且几乎不需
                        
                    </div>
                    <div class="publish-info">
                        <span class="publish-date">
                            <i class="far fa-clock fa-fw icon-date"></i>2023-03-27
                        </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-user fa-fw"></i>
                            Hello
                            
                        </span>
                    </div>
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                下一篇&nbsp;<i class="fas fa-chevron-right"></i>
            </div>
            <div class="card">
                <a href="/2023/01/05/react-de-yi-xie-gong-ju/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/10.jpg" class="responsive-img" alt="React的一些工具">
                        
                        <span class="card-title">React的一些工具</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            普通动画用 transition 只能做一些简单的动画，稍微复杂的动画可以使用keyframes：
.show{ animation:show-item 2s ease-in forwards; }
.hide{ animation:hid
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2023-01-05
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/%E5%89%8D%E7%AB%AF/" class="post-category">
                                    前端
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
            </div>
        </div>
        
    </div>
</article>

</div>



<!-- 代码块功能依赖 -->
<script type="text/javascript" src="/libs/codeBlock/codeBlockFuction.js"></script>

<!-- 代码语言 -->

<script type="text/javascript" src="/libs/codeBlock/codeLang.js"></script>


<!-- 代码块复制 -->

<script type="text/javascript" src="/libs/codeBlock/codeCopy.js"></script>


<!-- 代码块收缩 -->

<script type="text/javascript" src="/libs/codeBlock/codeShrink.js"></script>


<!-- 代码块折行 -->

<style type="text/css">
code[class*="language-"], pre[class*="language-"] { white-space: pre !important; }
</style>


    </div>
    <div id="toc-aside" class="expanded col l3 hide-on-med-and-down">
        <div class="toc-widget">
            <div class="toc-title"><i class="far fa-list-alt"></i>&nbsp;&nbsp;目录</div>
            <div id="toc-content"></div>
        </div>
    </div>
</div>

<!-- TOC 悬浮按钮. -->

<div id="floating-toc-btn" class="hide-on-med-and-down">
    <a class="btn-floating btn-large bg-color">
        <i class="fas fa-list-ul"></i>
    </a>
</div>


<script src="/libs/tocbot/tocbot.min.js"></script>
<script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            collapseDepth: Number('0'),
            headingSelector: 'h2, h3, h4'
        });

        // modify the toc link href to support Chinese.
        let i = 0;
        let tocHeading = 'toc-heading-';
        $('#toc-content a').each(function () {
            $(this).attr('href', '#' + tocHeading + (++i));
        });

        // modify the heading title id to support Chinese.
        i = 0;
        $('#articleContent').children('h2, h3, h4').each(function () {
            $(this).attr('id', tocHeading + (++i));
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });

        
        /* 修复文章卡片 div 的宽度. */
        let fixPostCardWidth = function (srcId, targetId) {
            let srcDiv = $('#' + srcId);
            if (srcDiv.length === 0) {
                return;
            }

            let w = srcDiv.width();
            if (w >= 450) {
                w = w + 21;
            } else if (w >= 350 && w < 450) {
                w = w + 18;
            } else if (w >= 300 && w < 350) {
                w = w + 16;
            } else {
                w = w + 14;
            }
            $('#' + targetId).width(w);
        };

        // 切换TOC目录展开收缩的相关操作.
        const expandedClass = 'expanded';
        let $tocAside = $('#toc-aside');
        let $mainContent = $('#main-content');
        $('#floating-toc-btn .btn-floating').click(function () {
            if ($tocAside.hasClass(expandedClass)) {
                $tocAside.removeClass(expandedClass).hide();
                $mainContent.removeClass('l9');
            } else {
                $tocAside.addClass(expandedClass).show();
                $mainContent.addClass('l9');
            }
            fixPostCardWidth('artDetail', 'prenext-posts');
        });
        
    });
</script>

    

</main>




    <footer class="page-footer bg-color">
    
    <div class="container row center-align" style="margin-bottom: 0px !important;">
        <div class="col s12 m8 l8 copy-right">
            Copyright&nbsp;&copy;
            <span id="year">2019</span>
            <a href="https://taylor12138.github.io" target="_blank">Hello</a>
            |&nbsp;Powered by&nbsp;<a href="https://hexo.io/" target="_blank">Hexo</a>
            |&nbsp;Theme&nbsp;<a href="https://github.com/blinkfox/hexo-theme-matery" target="_blank">Matery</a>
            <br>
            
            &nbsp;<i class="fas fa-chart-area"></i>&nbsp;站点总字数:&nbsp;<span
                class="white-color">371.8k</span>&nbsp;字
            
            
            
            
            
            
            <span id="busuanzi_container_site_pv">
                |&nbsp;<i class="far fa-eye"></i>&nbsp;总访问量:&nbsp;<span id="busuanzi_value_site_pv"
                    class="white-color"></span>&nbsp;次
            </span>
            
            
            <span id="busuanzi_container_site_uv">
                |&nbsp;<i class="fas fa-users"></i>&nbsp;总访问人数:&nbsp;<span id="busuanzi_value_site_uv"
                    class="white-color"></span>&nbsp;人
            </span>
            
            <br>
            
            <br>
            
        </div>
        <div class="col s12 m4 l4 social-link social-statis">
    <a href="https://github.com/taylor12138" class="tooltipped" target="_blank" data-tooltip="访问我的GitHub" data-position="top" data-delay="50">
        <i class="fab fa-github"></i>
    </a>



    <a href="mailto:277421392@qq.com" class="tooltipped" target="_blank" data-tooltip="邮件联系我" data-position="top" data-delay="50">
        <i class="fas fa-envelope-open"></i>
    </a>







    <a href="tencent://AddContact/?fromId=50&fromSubId=1&subcmd=all&uin=277421392" class="tooltipped" target="_blank" data-tooltip="QQ联系我: 277421392" data-position="top" data-delay="50">
        <i class="fab fa-qq"></i>
    </a>







    <a href="/atom.xml" class="tooltipped" target="_blank" data-tooltip="RSS 订阅" data-position="top" data-delay="50">
        <i class="fas fa-rss"></i>
    </a>

</div>
    </div>
</footer>

<div class="progress-bar"></div>


    <!-- 搜索遮罩框 -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fas fa-search"></i>&nbsp;&nbsp;搜索</span>
            <input type="search" id="searchInput" name="s" placeholder="请输入搜索的关键字"
                   class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script src="/js/search.js"></script>
<script type="text/javascript">
$(function () {
    searchFunc("/search.xml", 'searchInput', 'searchResult');
});
</script>

    <!-- 回到顶部按钮 -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fas fa-arrow-up"></i>
    </a>
</div>


    <script src="/libs/materialize/materialize.min.js"></script>
    <script src="/libs/masonry/masonry.pkgd.min.js"></script>
    <script src="/libs/aos/aos.js"></script>
    <script src="/libs/scrollprogress/scrollProgress.min.js"></script>
    <script src="/libs/lightGallery/js/lightgallery-all.min.js"></script>
    <script src="/js/matery.js"></script>

    <!-- Baidu Analytics -->

    <!-- Baidu Push -->

<script>
    (function () {
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        } else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>

    
    <script src="/libs/others/clicklove.js" async="async"></script>
    
    
    <script async src="/libs/others/busuanzi.pure.mini.js"></script>
    

    

    

    

    

    

    
    <script src="/libs/instantpage/instantpage.js" type="module"></script>
    

<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginModelPath":"assets/","model":{"jsonPath":"live2d-widget-model-hijiki"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":false},"log":false,"pluginJsPath":"lib/","pluginRootPath":"live2dw/","tagMode":false});</script></body>

</html>
