{"meta":{"title":"Hexo","subtitle":"Books are the ladder of human progress","description":"","author":"Hello","url":"https://taylor12138.github.io","root":"/"},"pages":[{"title":"about","date":"2018-09-30T09:25:30.000Z","updated":"2020-05-04T06:35:25.450Z","comments":true,"path":"about/index.html","permalink":"https://taylor12138.github.io/about/index.html","excerpt":"","text":""},{"title":"contact","date":"2020-05-03T17:21:52.000Z","updated":"2020-05-04T06:33:52.664Z","comments":true,"path":"contact/index.html","permalink":"https://taylor12138.github.io/contact/index.html","excerpt":"","text":""},{"title":"friends","date":"2020-05-03T17:22:42.000Z","updated":"2020-05-04T06:34:25.403Z","comments":true,"path":"friends/index.html","permalink":"https://taylor12138.github.io/friends/index.html","excerpt":"","text":""},{"title":"categories","date":"2020-05-03T17:20:07.000Z","updated":"2020-05-04T06:33:11.259Z","comments":true,"path":"categories/index.html","permalink":"https://taylor12138.github.io/categories/index.html","excerpt":"","text":""},{"title":"tags","date":"2020-05-03T17:17:32.000Z","updated":"2020-05-04T06:33:28.454Z","comments":true,"path":"tags/index.html","permalink":"https://taylor12138.github.io/tags/index.html","excerpt":"","text":""}],"posts":[{"title":"WebGL","slug":"WebGL","date":"2023-06-11T16:00:00.000Z","updated":"2023-06-12T16:12:20.942Z","comments":true,"path":"2023/06/12/webgl/","link":"","permalink":"https://taylor12138.github.io/2023/06/12/webgl/","excerpt":"","text":"WebGLç®€ä»‹WebGLæ˜¯ä¸€ç§JavaScript APIï¼Œç”¨äºåœ¨ä¸ä½¿ç”¨å¤–æŒ‚ç¨‹å¼çš„æƒ…å†µä¸‹åœ¨ä»»ä½•ç›¸å®¹çš„ç½‘é¡µæµè§ˆå™¨ä¸­å‘ˆç°äº¤äº’å¼2Då’Œ3Då›¾å½¢[3]ã€‚WebGLå®Œå…¨æ•´åˆåˆ°æµè§ˆå™¨çš„æ‰€æœ‰ç½‘é¡µæ ‡å‡†ä¸­ï¼Œå¯å°†å½±åƒå¤„ç†å’Œæ•ˆæœçš„GPUåŠ é€Ÿä½¿ç”¨æ–¹å¼å½“åšç½‘é¡µCanvasçš„ä¸€éƒ¨åˆ†ã€‚WebGLå…ƒç´ å¯ä»¥åŠ å…¥å…¶ä»–HTMLå…ƒç´ ä¹‹ä¸­å¹¶ä¸ç½‘é¡µæˆ–ç½‘é¡µèƒŒæ™¯çš„å…¶ä»–éƒ¨åˆ†æ··åˆ[4]ã€‚WebGLç¨‹åºç”±JavaScriptç¼–å†™çš„æ§åˆ¶ä»£ç å’ŒOpenGL Shading Languageï¼ˆGLSLï¼‰ç¼–å†™çš„è‘—è‰²å™¨ä»£ç ç»„æˆï¼Œè¯¥è¯­è¨€ç±»ä¼¼äºCæˆ–C++ï¼Œå¹¶åœ¨ç”µè„‘çš„å›¾å½¢å¤„ç†å™¨ï¼ˆGPUï¼‰ä¸Šæ‰§è¡Œã€‚WebGLç”±éè¥åˆ©Khronos Groupè®¾è®¡å’Œç»´æŠ¤[5]ã€‚ å…¼å®¹æ€§ï¼šï¼ˆæˆªæ­¢2023å¹´6æœˆï¼‰ GLSLGLSL - OpenGL Shading Language ä¹Ÿç§°ä½œ GLslangï¼Œæ˜¯ä¸€ä¸ªä»¥Cè¯­è¨€ä¸ºåŸºç¡€çš„é«˜é˜¶ç€è‰²è¯­è¨€ã€‚å®ƒæ˜¯ç”± OpenGL ARB æ‰€å»ºç«‹ï¼Œæä¾›å¼€å‘è€…å¯¹ç»˜å›¾ç®¡çº¿æ›´å¤šçš„ç›´æ¥æ§åˆ¶ï¼Œè€Œæ— éœ€ä½¿ç”¨æ±‡ç¼–è¯­è¨€æˆ–ç¡¬ä»¶è§„æ ¼è¯­è¨€ã€‚ æƒ³è¦ä½¿ç”¨WebGLä½œå›¾å°±å¿…é¡»è¦ä½¿ç”¨åˆ°ç€è‰²å™¨ï¼ˆshaderï¼‰ã€‚ç€è‰²å™¨åŒ…æ‹¬ï¼š é¡¶ç‚¹ç€è‰²å™¨ï¼ˆVertex shaderï¼‰ç”¨æ¥æè¿°é¡¶ç‚¹çš„ç‰¹å¾ï¼ˆä½ç½®ã€é¢œè‰²ã€å¤§å°ç­‰ï¼‰ï¼Œé¡¶ç‚¹æŒ‡çš„å°±æ˜¯ç©ºé—´ä¸­çš„æŸä¸€ä¸ªç‚¹ã€‚ ç‰‡å…ƒç€è‰²å™¨ï¼ˆFragment shaderï¼‰å¤„ç†æ¯ä¸€ä¸ªç‰‡å…ƒï¼Œç‰‡å…ƒå¯ä»¥ç†è§£æˆåƒç´ ç‚¹ã€‚ æ¯”å¦‚è¯´æˆ‘ä»¬æƒ³ç”»ä¸€ä¸ªä¸‰è§’å½¢é¦–å…ˆè¦çŸ¥é“ä¸‰è§’å½¢çš„ä¸‰ä¸ªç‚¹åœ¨å“ªï¼Œè¿™å°±éœ€è¦æˆ‘ä»¬é€šè¿‡é¡¶ç‚¹ç€è‰²å™¨æ¥æè¿°ç‚¹çš„ä½ç½®ï¼Œç„¶åå¦‚æœè¦æŠŠè¿™ä¸ªä¸‰è§’å½¢ç”»å‡ºæ¥å°±éœ€è¦å¡«å……é¢œè‰²ï¼Œä¸‰è§’å½¢ä¸Šæ¯ä¸ªåƒç´ ç‚¹éœ€è¦ä»€ä¹ˆé¢œè‰²å°±å¯ä»¥ä½¿ç”¨ç‰‡å…ƒç€è‰²å™¨æ¥å†³å®šã€‚ æ‰€ä»¥ï¼Œæˆ‘ä»¬ä¸€èˆ¬åˆ©ç”¨JavaScriptä¸­åˆ›å»ºå­—ç¬¦ä¸²çš„æ–¹å¼åˆ›å»ºGLSLå­—ç¬¦ä¸²ï¼šç”¨ä¸²è”çš„æ–¹å¼ï¼ˆconcatenatingï¼‰(ç”¨å¾—æœ€å¤š)ï¼Œ ç”¨AJAXä¸‹è½½ï¼Œç”¨å¤šè¡Œæ¨¡æ¿æ•°æ®ã€‚ gl_FragColoræ˜¯ä¸€ä¸ªç‰‡æ®µç€è‰²å™¨ä¸»è¦è®¾ç½®çš„å˜é‡ã€gl_Position æ˜¯ä¸€ä¸ªé¡¶ç‚¹ç€è‰²å™¨ä¸»è¦è®¾ç½®çš„å˜é‡ // é¡¶ç‚¹ç€è‰²å™¨glslä»£ç  const vsSource = ` attribute vec4 aVertexPosition; attribute vec4 aVertexColor; varying lowp vec4 vColor; void main() { gl_Position = aVertexPosition; vColor = aVertexColor; } `; // ç‰‡æ®µç€è‰²å™¨glslä»£ç  const fsSource = ` varying lowp vec4 vColor; void main() { gl_FragColor = vColor; } `; æˆ–è€…åœ¨è¿™ä¸ªä¾‹å­é‡Œï¼Œæˆ‘ä»¬å¯ä»¥å°†å®ƒä»¬æ”¾åœ¨éJavaScriptç±»å‹çš„æ ‡ç­¾ä¸­ã€‚ &lt;script id=\"vertex-shader-2d\" type=\"notjs\"> //xxxxxx &lt;/script> ç„¶åï¼Œæˆ‘ä»¬é€šè¿‡å¯¹GLSLæ•°æ®çš„ä¸Šä¼ ï¼Œç„¶åç¼–è¯‘æˆã€‚é¡¶ç‚¹/ç‰‡å…ƒ ç€è‰²å™¨ã€‚ // åˆ›å»ºç€è‰²å™¨ï¼Œglä¸ºä¸Šä¸‹æ–‡ï¼ŒtypeæŒ‡æ˜æ˜¯é¡¶ç‚¹ç€è‰²å™¨è¿˜æ˜¯ç‰‡æ®µç€è‰²å™¨ï¼Œsourceå³ä¸ºæºç  function createShader(gl, type, source) { const shader = gl.createShader(type); // åˆ›å»ºç€è‰²å™¨å¯¹è±¡ gl.shaderSource(shader, source); // æä¾›æ•°æ®æº gl.compileShader(shader); var success = gl.getShaderParameter(shader, gl.COMPILE_STATUS); if (success) { return shader; } else { //ä¸€äº›å¤„ç† } return shader; } function initShaderProgram(gl, vsSource, fsSource) { const vshader = createShader(gl, gl.VERTEX_SHADER, vsSource); const fshader = createShader(gl, gl.FRAGMENT_SHADER, fsSource); const shaderProgram = gl.createProgram(); // åˆ›å»ºç€è‰²å™¨ç¨‹åº gl.attachShader(shaderProgram, vshader); // é“¾æ¥ç€è‰²å™¨åˆ°å¯¹åº”çš„ç€è‰²å™¨ç¨‹åºä¸­ gl.attachShader(shaderProgram, fshader); gl.linkProgram(shaderProgram); // å…³è”ç€è‰²å™¨ç¨‹åºåˆ°æ•´ä¸ªç»˜åˆ¶å¯¹è±¡ä¸­ var success = gl.getProgramParameter(program, gl.LINK_STATUS); if (success) { return shaderProgram; } else { //ä¸€äº›å¤„ç† } } Basic è¯­æ³•ï¼ˆ1ï¼‰å˜é‡ç±»å‹ å±æ€§ï¼ˆAttributesï¼‰å’Œç¼“å†² ç¼“å†²æ˜¯å‘é€åˆ°GPUçš„ä¸€äº›äºŒè¿›åˆ¶æ•°æ®åºåˆ—ï¼Œé€šå¸¸æƒ…å†µä¸‹ç¼“å†²æ•°æ®åŒ…æ‹¬ä½ç½®ï¼Œæ³•å‘é‡ï¼Œçº¹ç†åæ ‡ï¼Œé¡¶ç‚¹é¢œè‰²å€¼ç­‰ã€‚ ä½ å¯ä»¥å­˜å‚¨ä»»ä½•æ•°æ®ã€‚æˆ‘ä»¬å¯ä»¥ç†è§£ä¸ºå’Œthreejs çš„ attribute ç±»ä¼¼ å…¨å±€å˜é‡ï¼ˆUniformsï¼‰ å…¨å±€å˜é‡åœ¨ç€è‰²ç¨‹åºè¿è¡Œå‰èµ‹å€¼ï¼Œåœ¨è¿è¡Œè¿‡ç¨‹ä¸­å…¨å±€æœ‰æ•ˆã€‚ çº¹ç†ï¼ˆTexturesï¼‰ çº¹ç†æ˜¯ä¸€ä¸ªæ•°æ®åºåˆ—ï¼Œå¯ä»¥åœ¨ç€è‰²ç¨‹åºè¿è¡Œä¸­éšæ„è¯»å–å…¶ä¸­çš„æ•°æ®ã€‚ å¤§å¤šæ•°æƒ…å†µå­˜æ”¾çš„æ˜¯å›¾åƒæ•°æ®ï¼Œä½†æ˜¯çº¹ç†ä»…ä»…æ˜¯æ•°æ®åºåˆ—ï¼Œ ä½ ä¹Ÿå¯ä»¥éšæ„å­˜æ”¾é™¤äº†é¢œè‰²æ•°æ®ä»¥å¤–çš„å…¶å®ƒæ•°æ®ã€‚ å¯å˜é‡ï¼ˆVaryingsï¼‰ å¯å˜é‡æ˜¯ä¸€ç§é¡¶ç‚¹ç€è‰²å™¨ç»™ç‰‡æ®µç€è‰²å™¨ä¼ å€¼çš„æ–¹å¼ï¼Œä¾ç…§æ¸²æŸ“çš„å›¾å…ƒæ˜¯ç‚¹ï¼Œ çº¿è¿˜æ˜¯ä¸‰è§’å½¢ï¼Œé¡¶ç‚¹ç€è‰²å™¨ä¸­è®¾ç½®çš„å¯å˜é‡ä¼šåœ¨ç‰‡æ®µç€è‰²å™¨è¿è¡Œä¸­è·å–ä¸åŒçš„æ’å€¼ã€‚ ï¼ˆ2ï¼‰åŸºæœ¬ç±»å‹voidç©ºç±»å‹,å³ä¸è¿”å›ä»»ä½•å€¼ boolå¸ƒå°”ç±»å‹ true,false intå¸¦ç¬¦å·çš„æ•´æ•° signed integer floatå¸¦ç¬¦å·çš„æµ®ç‚¹æ•° floating scalar vec2, vec3, vec4nç»´æµ®ç‚¹æ•°å‘é‡ n-component floating point vector bvec2, bvec3, bvec4nç»´å¸ƒå°”å‘é‡ Boolean vector ivec2, ivec3, ivec4nç»´æ•´æ•°å‘é‡ signed integer vector mat2, mat3, mat42x2, 3x3, 4x4 æµ®ç‚¹æ•°çŸ©é˜µ float matrix sampler2D2Dçº¹ç† a 2D texture samplerCubeç›’çº¹ç† cube mapped texture ç²¾åº¦é™å®šç¬¦ ç²¾åº¦èŒƒå›´ æµ®ç‚¹æ•°èŒƒå›´ highp (-2çš„62æ¬¡æ–¹, 2çš„62æ¬¡æ–¹); mediump (-2çš„14æ¬¡æ–¹, 2çš„14æ¬¡æ–¹); lowp (-2,2); æ•´æ•°èŒƒå›´ highp (-2çš„16æ¬¡æ–¹, 2çš„16æ¬¡æ–¹); mediump (-2çš„10æ¬¡æ–¹, 2çš„10æ¬¡æ–¹); lowp (-2çš„8æ¬¡æ–¹, 2çš„8æ¬¡æ–¹); æŒ‡å®šé»˜è®¤ç²¾åº¦ precision é¡¶ç‚¹ç€è‰²å™¨é¢„å®šä¹‰ï¼Œé¢„å®šä¹‰å³ä¸ºé»˜è®¤å€¼ precision highp float; // æµ®ç‚¹æ•°é«˜ç²¾åº¦ precision highp int; // æ•´å‹é«˜ç²¾åº¦ precision lowp sampler2D; precision lowp samplerCube; ç‰‡æ®µç€è‰²å™¨é¢„å®šä¹‰ precision mediump int; // æ•´å‹ä¸­ç²¾åº¦ precision lowp sampler2D; precision lowp samplerCube; å…¼å®¹æ€§var gl = canvas.getContext(\"webgl\"); if (!gl) { // ä½ ä¸èƒ½ä½¿ç”¨WebGLï¼ ... å‚è€ƒWebGL åŸºç¡€æ¦‚å¿µ webglä»0åˆ°å†™ä¸€ä¸ªç®€æ˜“æ»¤é•œ","categories":[{"name":"å‰ç«¯","slug":"å‰ç«¯","permalink":"https://taylor12138.github.io/categories/%E5%89%8D%E7%AB%AF/"}],"tags":[],"author":"Hello"},{"title":"h5åŠ¨ç”»ç›¸å…³","slug":"h5åŠ¨ç”»ç›¸å…³","date":"2023-05-07T16:00:00.000Z","updated":"2023-06-12T06:59:21.625Z","comments":true,"path":"2023/05/08/h5-dong-hua-xiang-guan/","link":"","permalink":"https://taylor12138.github.io/2023/05/08/h5-dong-hua-xiang-guan/","excerpt":"","text":"åŠ¨ç”»åŸç†è¿™é‡ŒæŠŠåŠ¨ç”»æ–¹æ¡ˆçš„å®ç°åŸç†åˆ†ä¸ºä¸‰ç§ã€‚ ç¬¬ä¸€ç§æ˜¯çº¯é¢å‘è¿‡ç¨‹çš„åŠ¨ç”»è®°å½•æ–¹å¼ï¼Œç›®å‰å¸‚é¢ä¸Šä¸»æµçš„æœ‰Airbnb çš„Lottieå’Œè…¾è®¯æœ€è¿‘å¼€æºçš„PAGï¼ŒåŸç†æ˜¯é€šè¿‡è®°å½•åŠ¨ç”»è®¾è®¡å¸ˆåˆ¶ä½œåŠ¨ç”»çš„æ¯ä¸ªå…ƒç´ ï¼Œè¿˜æœ‰æ¯ä¸ªå…ƒç´ çš„è¿åŠ¨è¿‡ç¨‹ï¼Œç„¶åå¼€å‘è€…å†è¿˜åŸè¿™äº›å…ƒç´ çš„è¿åŠ¨ã€‚è¿™ä¸ªæ–¹æ¡ˆçš„ä¼˜ç‚¹æ˜¯æ–‡ä»¶ä½“ç§¯å°ï¼Œèƒ½å®ç°å¤§éƒ¨åˆ†åŸºç¡€ç‰¹æ•ˆå’Œå˜æ¢ä¸‹çš„åŠ¨ç”»ã€‚ç¼ºç‚¹æ˜¯ä¸æ”¯æŒæ¯”è¾ƒå¤æ‚çš„ç‰¹æ•ˆï¼ˆå¦‚3Dæ•ˆæœç­‰ï¼‰ï¼Œæ’­æ”¾æ€§èƒ½ä¹Ÿæ¯”è¾ƒå·®ï¼Œå› ä¸ºè®°å½•è¿‡ç¨‹å°±å¿…ç„¶æœ‰ä¸€ä¸ªè¿˜åŸåŠ¨ç”»çš„è®¡ç®—è¿‡ç¨‹ï¼Œåœ¨æ¸²æŸ“çš„åŒæ—¶è¿˜éœ€è¦è®¡ç®—æ¯ä¸ªå…ƒç´ çš„å˜åŒ–è¿‡ç¨‹ï¼Œå¯¹æ¯”å…¶ä»–æ–¹æ¡ˆå°±å¤šäº†ä¸€é¡¹è®¡ç®—çš„æ€§èƒ½æŸè€—ã€‚ ç¬¬äºŒç§æ˜¯åŠé¢å‘è¿‡ç¨‹åŠç»“æœçš„åŠ¨ç”»è®°å½•æ–¹å¼ ç›®å‰å¸‚é¢ä¸Šä¸»æµçš„æ–¹æ¡ˆæœ‰YYçš„SVGAå’ŒY2Aæ–¹æ¡ˆï¼ŒåŸç†æ˜¯è®°å½•åŠ¨ç”»è®¾è®¡å¸ˆåˆ¶ä½œåŠ¨ç”»æ—¶ç”¨åˆ°çš„æ¯ä¸€ä¸ªå…ƒç´ ï¼Œç„¶åè®°å½•å…ƒç´ åœ¨æ¯ä¸€å¸§çš„ç‰¹å¾ï¼ˆå½¢çŠ¶ï¼Œå¤§å°ï¼Œä½ç½®ï¼Œalphaç­‰ï¼‰ã€‚SVGAçš„ä¼˜ç‚¹æ˜¯èƒ½æ”¯æŒæ›´å¤æ‚çš„åŠ¨ç”»ï¼ŒåŒæ—¶æ’­æ”¾æ€§èƒ½ä¹Ÿæ¯”ç¬¬ä¸€ç§æ–¹æ¡ˆå¥½è®¸å¤šã€‚ç¼ºç‚¹æ˜¯ä½“ç§¯ä¼šå¤§ä¸€äº›ï¼ŒåŒæ—¶ä¹Ÿä¸æ”¯æŒå¤æ‚çš„ç‰¹æ•ˆï¼ˆå¦‚3Dæ•ˆæœç­‰ï¼‰ã€‚ä¸ºä»€ä¹ˆç¬¬äºŒç§æ–¹æ¡ˆç›¸æ¯”ç¬¬ä¸€ç§æ–¹æ¡ˆæ€§èƒ½ä¸Šæ¯”è¾ƒå¥½ï¼Œä¹Ÿèƒ½å¤Ÿæ”¯æŒæ›´å¤æ‚çš„åŠ¨ç”»å‘¢ï¼Œè¿™æ˜¯ç‰ºç‰²äº†ä¸€éƒ¨åˆ†æ–‡ä»¶ä½“ç§¯ï¼Œä»è€Œå‡å°‘äº†è®¡ç®—è¿™ä¸€ç¯èŠ‚çš„å› ç´ ã€‚SVGAçš„æ–‡ä»¶ç»è¿‡zlibå‹ç¼©å’Œbase64ç¼–ç åï¼Œå‹ç¼©ç‡èƒ½è¾¾åˆ°85%~90% ç¬¬ä¸‰ç§æ˜¯è®°å½•ç»“æœæ–¹å¼ï¼Œç›®å‰ä¸»è¦æœ‰PNGåºåˆ—å›¾å’Œå¸¦é€æ˜é€šé“çš„MP4æ–¹æ¡ˆã€‚åŸç†æ˜¯è®°å½•æ¯ä¸€å¸§æ¯ä¸ªåƒç´ ç‚¹çš„åƒç´ å€¼æ¥æ¸²æŸ“ï¼Œä¼˜ç‚¹æ˜¯æ‰€è§å³æ‰€å¾—ï¼Œå……åˆ†è§£æ”¾è®¾è®¡å¸ˆçš„æ€æƒ³ï¼Œèƒ½å¤Ÿæ”¯æŒæ‰€æœ‰è®¾è®¡å¸ˆèƒ½è®¾è®¡å‡ºæ¥çš„åŠ¨ç”»ï¼ŒåŒ…æ‹¬3DåŠ¨æ•ˆç­‰ æ€»ç»“ï¼š ç¬¬ä¸€ç§æ–¹æ¡ˆ æ”¯æŒä¸€èˆ¬çš„åŠ¨æ•ˆï¼Œæ¯”å¦‚UIåŠ¨ç”»ï¼Œåœºæ™¯åˆ‡æ¢åŠ¨æ•ˆå’Œä¸€äº›è¿›åœºã€å¾—åˆ†ç­‰åŠ¨æ•ˆã€‚ ç¬¬äºŒç§æ–¹æ¡ˆèƒ½æ”¯æŒç¬¬ä¸€ç§èƒ½æ”¯æŒçš„æ‰€æœ‰åŠ¨æ•ˆï¼Œä¸”èƒ½å¤Ÿæ”¯æŒæ›´å¤æ‚çš„åŠ¨æ•ˆï¼Œä¾‹å¦‚å¤æ‚çš„ç¤¼ç‰©åŠ¨æ•ˆï¼Œé…·ç‚«çš„åéª‘åŠ¨ç”»ç­‰ã€‚ ç¬¬ä¸‰ç§æ–¹æ¡ˆèƒ½æ”¯æŒæ‰€æœ‰çš„åŠ¨æ•ˆï¼Œåªè¦è®¾è®¡å¸ˆèƒ½è®¾è®¡å‡ºæ¥çš„åŠ¨æ•ˆéƒ½æ”¯æŒã€‚åœ¨ä½“ç§¯ä¸Šï¼Œä¹Ÿæ˜¯ä¾æ¬¡é€’å¢çš„ï¼Œç¬¬ä¸€ç§æ–¹æ¡ˆä½“ç§¯æœ€å°ã€‚ä½†æ˜¯åœ¨æ€§èƒ½ä¸Šåˆšå¥½åè¿‡æ¥ï¼Œç¬¬ä¸€ç§æ–¹æ¡ˆæ€§èƒ½æœ€å·®ï¼ŒCPUå’ŒGPUå ç”¨è¾ƒé«˜ã€‚ LottieLottieæ˜¯Airbnbå¼€æºçš„ä¸€ä¸ªæ”¯æŒ Androidã€iOS ä»¥åŠ ReactNativeï¼Œåˆ©ç”¨jsonæ–‡ä»¶çš„æ–¹å¼å¿«é€Ÿå®ç°åŠ¨ç”»æ•ˆæœçš„åº“ã€‚ è®¾è®¡å¸ˆå¯ä»¥ä½¿ç”¨ Adobe After Effects è®¾è®¡å‡ºæ¼‚äº®çš„åŠ¨ç”»ä¹‹åï¼Œä½¿ç”¨ Lottic æä¾›çš„ Bodymovin æ’ä»¶å°†è®¾è®¡å¥½çš„åŠ¨ç”»å¯¼å‡ºæˆ JSON æ ¼å¼ï¼Œå°±å¯ä»¥ç›´æ¥è¿ç”¨åœ¨ iOSã€Androidã€Web å’Œ React Nativeä¹‹ä¸Šï¼Œæ— éœ€å…¶ä»–é¢å¤–æ“ä½œã€‚ Lottie-webLottie-webæ˜¯çˆ±å½¼è¿æä¾›çš„é’ˆå¯¹htmlçš„lottieæ’­æ”¾å™¨ç‰ˆæœ¬ usage npm i lottie-web --save import lottie from 'lottie-web/build/player/lottie_light_canvas'; import JSONL from './ani/dataModal.json'; const modalRef = useRef(); modalRef.current = lottie.loadAnimation({ container: modalRef?.current, renderer: 'canvas', animationData: JSONL, autoplay: true, loop: false, }); &lt;div className=\"rock-lottie\" ref={modalRef} /> lottieçš„jsonæ–‡ä»¶{ \"v\": \"5.6.10\", // ä½¿ç”¨bodymovieæ’ä»¶çš„ç‰ˆæœ¬ \"fr\": 32, // å¸§é€Ÿç‡ \"ip\": 0, // åˆæˆå¼€å§‹æ—¶é—´ \"op\": 64, // åˆæˆæŒç»­æ—¶é—´ \"w\": 750, // åˆæˆå®½åº¦ \"h\": 1334, // åˆæˆé«˜åº¦ \"nm\": \"åˆæˆ 1\", // åˆæˆå \"ddd\": 0, // æ˜¯å¦3då›¾å±‚ \"assets\": [ // ä½¿ç”¨çš„èµ„æº { \"id\": \"image_0\", // ä½¿ç”¨çš„èµ„æºid \"w\": 750, // å½“å‰å›¾ç‰‡èµ„æºçš„å®½ \"h\": 1334, // å½“å‰å›¾ç‰‡èµ„æºçš„é«˜ \"u\": \"images/\", // å½“å‰å›¾ç‰‡å¯¼å‡ºååœ¨ä½¿ç”¨bodymovieå¯¼å‡ºåçš„æ–‡ä»¶å¤¹ \"p\": \"img_0.jpg\", // å½“å‰å›¾ç‰‡èµ„æºè·¯å¾„ \"e\": 0 // e=0 åå°†æ‹¼æ¥u+pä½œä¸ºå›¾ç‰‡è·¯å¾„ï¼Œe=1 ä¸ä½¿ç”¨uï¼Œç›´æ¥ä½¿ç”¨pçš„è·¯å¾„ã€‚ } ], \"layers\": [ // å›¾å±‚ { \"ddd\": 0, // æ˜¯å¦æ˜¯3då›¾å±‚ \"ind\": 1, // å½“å‰å›¾å±‚æ‰€åœ¨çš„ç´¢å¼• \"ty\": 2, // 2ä»£è¡¨å›¾ç‰‡å›¾å±‚ \"nm\": \"img_0.jpg\", // æºåç§° \"cl\": \"jpg\", // åç¼€ \"refId\": \"image_0\", // ä½¿ç”¨assetsä¸­çš„id \"sr\": 1, // å›¾å±‚ =>æ—¶é—´=>æ—¶é—´ä¼¸ç¼© \"ks\": { // å›¾å±‚ => å˜æ¢ \"o\": { // é€æ˜åº¦ \"a\": 1, // æ˜¯å¦æ˜¯å…³é”®å¸§ \"k\": [ // å¦‚æœæ˜¯å…³é”®å¸§æ—¶æ˜¯æ•°ç»„ { // æ¯ä¸€ä¸ªå…³é”®å¸§ä½ç½®çš„é…ç½®ä¿¡æ¯ \"i\": { \"x\": [0.833], \"y\": [0.833] }, // å½“å‰è´å¡å°”æ›²çº¿çš„å…¥å€¼ï¼Œè¿™ä¸ªæ˜¯åœ¨lottieä¸­å†™æ­»çš„å€¼ \"o\": { \"x\": [0.167], \"y\": [0.167] }, // å½“å‰è´å¡å°”æ›²çº¿çš„å‡ºå€¼ï¼Œè¿™ä¸ªæ˜¯åœ¨lottieä¸­å†™æ­»çš„å€¼ \"t\": 0, // å½“å‰å…³é”®å¸§å¼€å§‹æ—¶é—´ \"s\": [60] // å¼€å§‹çš„opacity }, { // ç¬¬äºŒä¸ªå…³é”®å¸§çš„é…ç½®ä¿¡æ¯ \"i\": { \"x\": [0.833], \"y\": [0.833] }, \"o\": { \"x\": [0.167], \"y\": [0.167] }, \"t\": 25, \"s\": [100] }, // ç¬¬ä¸‰ä¸ªå…³é”®å¸§çš„é…ç½®ä¿¡æ¯ { \"i\": { \"x\": [0.833], \"y\": [0.833] }, \"o\": { \"x\": [0.167], \"y\": [0.167] }, \"t\": 30, \"s\": [100] }, // ç¬¬å››ä¸ªå…³é”®å¸§çš„é…ç½®ä¿¡æ¯ { \"t\": 50, \"s\": [50] } ], \"ix\": 11 // Property Index. Used for expressionsã€‚è¡¨è¾¾å¼æ ‡è®°ã€‚è¿˜æ²¡ç ”ç©¶åˆ°è¿™ä¸ªæ€ä¹ˆç”¨ }, \"r\": { // æ—‹è½¬ \"a\": 0, // æ˜¯å¦æ˜¯å…³é”®å¸§ï¼Œ 0ä»£è¡¨ä¸æ˜¯å…³é”®å¸§ \"k\": 0, // ä¸æ˜¯å…³é”®å¸§æ—¶ä¸ºnumberï¼Œæ—‹è½¬è§’åº¦ä¸º0 \"ix\": 10 // Property Index. Used for expressionsã€‚è¡¨è¾¾å¼æ ‡è®° }, \"p\": { // ä½ç½® \"a\": 1, // æ˜¯å…³é”®å¸§ \"k\": [ { \"i\": { \"x\": 0.833, \"y\": 0.833 }, // å½“å‰è´å¡å°”æ›²çº¿çš„å…¥å€¼ï¼Œè¿™ä¸ªæ˜¯åœ¨lottieä¸­å†™æ­»çš„å€¼ \"o\": { \"x\": 0.167, \"y\": 0.167 }, // å½“å‰è´å¡å°”æ›²çº¿çš„å‡ºå€¼ï¼Œè¿™ä¸ªæ˜¯åœ¨lottieä¸­å†™æ­»çš„å€¼ \"t\": 0, // å¼€å§‹æ—¶é—´ \"s\": [-375, 675, 0], // å½“å‰å…³é”®å¸§ä½ç½®ï¼Œæ¨ªåæ ‡-375ï¼Œçºµåæ ‡675ï¼Œ ä¸æ˜¯3då›¾å±‚ï¼Œzæ–¹å‘ä¸º0 \"to\": [125, 0, 0], // In Spatial Tangent. Only for spatial properties. Array of numbers. å…¥å€¼ è¿˜ä¸çŸ¥é“ç©ºé—´åˆ‡çº¿åœ¨AEä¸­æ˜¯ä¸ªä»€ä¹ˆé¬¼ \"ti\": [-125, 0, 0] // Out Spatial Tangent. Only for spatial properties. Array of numbers. å‡ºå€¼ è¿˜ä¸çŸ¥é“ç©ºé—´åˆ‡çº¿åœ¨AEä¸­æ˜¯ä¸ªä»€ä¹ˆé¬¼ }, { \"i\": { \"x\": 0.833, \"y\": 0.833 }, \"o\": { \"x\": 0.167, \"y\": 0.167 }, \"t\": 25, \"s\": [375, 675, 0], \"to\": [0, 0, 0], \"ti\": [0, 0, 0] }, { \"i\": { \"x\": 0.833, \"y\": 0.833 }, \"o\": { \"x\": 0.167, \"y\": 0.167 }, \"t\": 30, \"s\": [375, 675, 0], \"to\": [125.167, 0, 0] \"ti\": [-125.167, 0, 0] }, { \"t\": 50, \"s\": [1126, 675, 0] } ], \"ix\": 2 // Property Index. Used for expressions. }, \"a\": { // é”šç‚¹ \"a\": 0, // ä¸æ˜¯å…³é”®å¸§ \"k\": [375, 667, 0], // é”šç‚¹å€¼ \"ix\": 1 // Property Index. Used for expressions. }, \"s\": { // ç¼©æ”¾æ¯”ä¾‹ \"a\": 0, // ä¸æ˜¯å…³é”®å¸§ \"k\": [100, 100, 100], // // ç¼©æ”¾æ¯”ä¾‹å€¼ \"ix\": 6 // Property Index. Used for expressions. } }, \"ao\": 0, // æ˜¯å¦è‡ªåŠ¨è·Ÿè¸ª \"ip\": 0, // å¼€å§‹å¸§ \"op\": 64, // æŒç»­å¸§é•¿ \"st\": 0, // å¼€å§‹æ—¶é—´ \"bm\": 0 // æ··åˆæ¨¡å¼ } ], \"markers\": [] } ç„¶åæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¿®æ”¹jsonæ–‡ä»¶ï¼Œæ¥ä¿®æ”¹æˆ‘ä»¬çš„lottieèµ„æº import JSONL from './ani/dataModal.json'; JSONL.assets[9].p = 'xxxurl'; JSONL.assets[8].p = 'xxxurl'; JSONL.assets[5].p = 'xxxurl'; JSONL.assets[4].p = 'xxxurl'; JSONL.assets[7].p = 'xxxurl'; JSONL.assets[6].p = 'xxxurl'; modalRef.current = lottie.loadAnimation({ container: modalRef?.current, renderer: 'canvas', animationData: JSONL, autoplay: true, loop: false, }); å‚è€ƒ ç¬¬ä¸€ç¯‡:ç›´æ’­é—´ç¤¼ç‰©åŠ¨æ•ˆ - å®ç°æ–¹æ¡ˆ","categories":[{"name":"å‰ç«¯","slug":"å‰ç«¯","permalink":"https://taylor12138.github.io/categories/%E5%89%8D%E7%AB%AF/"}],"tags":[],"author":"Hello"},{"title":"SSR","slug":"SSR","date":"2023-04-11T16:00:00.000Z","updated":"2023-05-24T11:33:42.095Z","comments":true,"path":"2023/04/12/ssr/","link":"","permalink":"https://taylor12138.github.io/2023/04/12/ssr/","excerpt":"","text":"SSRæ¸²æŸ“SSRç®€ä»‹SSRï¼šserver side render å½“å‰ç«¯ä¸ºvueã€reactè¿™ç§spaåº”ç”¨æ—¶ï¼Œéå¸¸ä¸åˆ©äºSEOï¼Œå„ç§è·¯ç”±çš„è·³è½¬ä¹Ÿå˜å¾—å¤æ‚ï¼Œå¹¶ä¸”åœ¨é¦–å±æ¸²æŸ“æ—¶é—´ä¸Šä¹ŸèŠ±è´¹äº†å¤§é‡æ—¶é—´ã€‚åœ¨æ•´ä½“æ¶æ„éƒ¨ç½²ä¸Šï¼Œè¿˜éœ€è¦åˆ©ç”¨å„ç§webæœåŠ¡ï¼ˆå¦‚ngxinï¼‰ï¼Œè¿™ç‚¹å¾ˆéº»çƒ¦ æœåŠ¡ç«¯å°†æˆ‘ä»¬éœ€è¦çš„HTMLæ–‡æœ¬ç»„è£…å¥½ï¼Œå¹¶è¿”å›ç»™æµè§ˆå™¨ï¼Œè¿™ä¸ªHTMLæ–‡æœ¬è¢«æµè§ˆå™¨è§£æä¹‹åï¼Œä¸éœ€è¦ç»è¿‡ JavaScript è„šæœ¬çš„æ‰§è¡Œï¼Œå³å¯ç›´æ¥æ„å»ºå‡ºå¸Œæœ›çš„ DOM æ ‘å¹¶å±•ç¤ºåˆ°é¡µé¢ä¸­ã€‚è¿™ä¸ªæœåŠ¡ç«¯ç»„è£…HTMLçš„è¿‡ç¨‹ï¼Œå«åšæœåŠ¡ç«¯æ¸²æŸ“ã€‚ SSRä¼˜åŠ¿ æ›´åˆ©äºSEOã€‚ æ›´åˆ©äºé¦–å±æ¸²æŸ“ï¼Œå³ç™½å±æ—¶é•¿æ›´çŸ­ SSRåŠ£åŠ¿ ç›¸å¯¹äºä»…ä»…éœ€è¦æä¾›é™æ€æ–‡ä»¶çš„æœåŠ¡å™¨ï¼ŒSSRä¸­ä½¿ç”¨çš„æ¸²æŸ“ç¨‹åºè‡ªç„¶ä¼šå ç”¨æ›´å¤šçš„CPUå’Œå†…å­˜èµ„æºã€‚ ä¸€äº›å¸¸ç”¨çš„æµè§ˆå™¨APIå¯èƒ½æ— æ³•æ­£å¸¸ä½¿ç”¨ï¼Œæ¯”å¦‚windowã€docmentå’Œalertç­‰ï¼Œå¦‚æœä½¿ç”¨çš„è¯éœ€è¦å¯¹è¿è¡Œçš„ç¯å¢ƒåŠ ä»¥åˆ¤æ–­ã€‚ å¼€å‘è°ƒè¯•ä¼šæœ‰ä¸€äº›éº»çƒ¦ï¼Œå› ä¸ºæ¶‰åŠäº†æµè§ˆå™¨åŠæœåŠ¡å™¨ï¼Œå¯¹äºSPAçš„ä¸€äº›ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸçš„ç®¡ç†ä¼šå˜å¾—å¤æ‚ã€‚ å¯èƒ½ä¼šç”±äºæŸäº›å› ç´ å¯¼è‡´æœåŠ¡å™¨ç«¯æ¸²æŸ“çš„ç»“æœä¸æµè§ˆå™¨ç«¯çš„ç»“æœä¸ä¸€è‡´ã€‚ FIDæ€§èƒ½å¯èƒ½ä¼šæœ‰é—®é¢˜ï¼šè¿™é‡Œæœ‰ä»‹ç»è¯´æ˜ ä¹Ÿå¯ä»¥çœ‹è¿™é‡Œ https://github.com/reactwg/react-18/discussions/37 æ‰€ä»¥ä¸€èˆ¬æ¥è¯´ä¸ºäº†è§£å†³æµè§ˆå™¨APIäº¤äº’é—®é¢˜ï¼Œå› æ­¤éœ€è¦åœ¨æµè§ˆå™¨ä¸­æ‰§è¡Œ CSR çš„ JS è„šæœ¬ï¼Œå®Œæˆäº‹ä»¶ç»‘å®šï¼Œè®©é¡µé¢æ‹¥æœ‰äº¤äº’çš„èƒ½åŠ›ï¼Œè¿™ä¸ªè¿‡ç¨‹è¢«ç§°ä½œhydrate(ç¿»è¯‘ä¸ºæ³¨æ°´æˆ–è€…æ¿€æ´»)ã€‚åŒæ—¶ï¼Œåƒè¿™æ ·æœåŠ¡ç«¯æ¸²æŸ“ + å®¢æˆ·ç«¯ hydrate çš„åº”ç”¨ä¹Ÿè¢«ç§°ä¸ºåŒæ„åº”ç”¨ã€‚ é¥æœ›å†å²ä¹‹é‡æ–°è®¤è¯†æœåŠ¡ç«¯æ¸²æŸ“ç°åœ¨çš„æœåŠ¡ç«¯æ¸²æŸ“å’Œè¿‡å»çš„æœåŠ¡ç«¯æ¸²æŸ“å®Œå…¨æ˜¯ä¸¤ç äº‹ Web1.0æ—¶æœŸï¼Œåœ¨æ²¡æœ‰AJAXçš„æ—¶å€™ï¼Œä¹Ÿå°±æ˜¯web1.0æ—¶ä»£ï¼Œå‡ ä¹æ‰€æœ‰åº”ç”¨éƒ½æ˜¯æœåŠ¡ç«¯æ¸²æŸ“ï¼Œæµè§ˆå™¨æ¥æ”¶è¯·æ±‚åï¼Œåˆ°æ•°æ®åº“æŸ¥è¯¢æ•°æ®ï¼Œå°†æ•°æ®ä¸¢åˆ°åç«¯çš„ç»„ä»¶æ¨¡æ¿ï¼ˆphpã€aspã€jspç­‰ï¼‰ä¸­ï¼Œå¹¶æ¸²æŸ“æˆHTMLç‰‡æ®µï¼Œç„¶åæµè§ˆå™¨æ‹¿åˆ°çš„æ˜¯ä¸€ä¸ªå®Œæ•´çš„HTMLï¼Œç„¶åæ¸²æŸ“é¡µé¢ï¼Œè¿‡ç¨‹æ²¡æœ‰ä»»ä½•JavaScriptä»£ç çš„å‚ä¸ã€‚ã€‚ è¿™æ ·åšçš„ç¼ºç‚¹æ˜¯ï¼šæ¯ä¸€æ¬¡æ›´æ–°éƒ½è¦è¯·æ±‚åï¼Œè®©æœåŠ¡ç«¯æŸ¥ä¸€æ¬¡æ•°æ®åº“ï¼Œé‡æ–°ç»„è£…htmlè¿”å› ä»£ç æ··æ‚ï¼Œéš¾ä»¥ç»´æŠ¤ï¼ˆjspã€phpï¼‰ å‰åç«¯åˆ†ç¦»æ—¶ä»£ï¼ŒSPAæ¨¡å¼å‡ºç°ï¼Œå‰ç«¯å›¢é˜Ÿæ¥ç®¡é¡µé¢æ¸²æŸ“ï¼Œåç«¯å›¢é˜Ÿä»…è´Ÿè´£æ•°æ®æŸ¥è¯¢å’ŒAPI éšç€SPAçš„å‘å±•ï¼Œå¼Šç«¯ä¹Ÿé€æ¸æš´éœ²ï¼šJSè„šæœ¬çš„è‡ƒè‚¿ï¼ŒSEOçš„é€€åŒ– æ­¤æ—¶åç«¯æ¸²æŸ“å†æ¬¡å‡ºç°ï¼Œä½†ä¸åŒçš„æ˜¯è¿æ¥å£å¯¼å‘ æµè§ˆå™¨ &lt;-&gt; å‰ç«¯æœåŠ¡å™¨ &lt;-&gt; åç«¯æœåŠ¡å™¨ å…¶å®ä¹Ÿå¯ä»¥çœ‹ä½œåŠ å…¥äº†nodejsä¸­é—´ä»¶ï¼Œè¿™ä¸ªä¸­é—´ä»¶ä½œä¸ºä¼ªâ€œæœåŠ¡ç«¯â€ï¼Œç”±è¿™ä¸ªå‰ç«¯æœåŠ¡å™¨ç»„è£…ä¸€ä¸ªæºå¸¦äº†å…·ä½“æ•°æ®çš„HTMLæ–‡æœ¬ï¼Œå¹¶ä¸”è¿”å›ç»™æµè§ˆå™¨ã€‚ ä½†æ˜¯ï¼å€¼å¾—ä¸€æçš„æ˜¯ï¼Œæµè§ˆå™¨åŠ è½½å¹¶æ‰§è¡Œ JavaScript è„šæœ¬ï¼Œï¼ˆè¿™ä¸ªæ˜¯ä¹‹å‰æœåŠ¡ç«¯æ¸²æŸ“ä¸ä¼šçš„åšï¼‰ç»™é¡µé¢ä¸Šçš„å…ƒç´ ç»‘å®šäº‹ä»¶ï¼Œè®©é¡µé¢å˜å¾—å¯äº¤äº’ï¼Œå½“ç”¨æˆ·ä¸æµè§ˆå™¨é¡µé¢è¿›è¡Œäº¤äº’ï¼Œå¦‚è·³è½¬åˆ°ä¸‹ä¸€ä¸ªé¡µé¢æ—¶ï¼Œæµè§ˆå™¨ä¼šæ‰§è¡Œ JavaScript è„šæœ¬ï¼Œå‘åç«¯æœåŠ¡å™¨è¯·æ±‚æ•°æ®ï¼Œè·å–å®Œæ•°æ®ä¹‹åå†æ¬¡æ‰§è¡Œ JavaScript ä»£ç åŠ¨æ€æ¸²æŸ“é¡µé¢ã€‚ ä½¿ç”¨äº†æœåŠ¡ç«¯æ¸²æŸ“ä¹‹åï¼Œä½ è¿˜è¦å®ç°åŒæ„ï¼å³ä¸€ä»½ä»£ç ï¼Œæ—¢å¯ä»¥å®¢æˆ·ç«¯æ¸²æŸ“ï¼Œä¹Ÿå¯ä»¥æœåŠ¡ç«¯æ¸²æŸ“ã€‚ å› ä¸ºè¿™æ—¶ä½ è¦ç”¨åˆ°ä¸¤ç§é¡µé¢æ¸²æŸ“ï¼š å‰ç«¯æœåŠ¡å™¨é€šè¿‡è¯·æ±‚åç«¯æœåŠ¡å™¨è·å–æ•°æ®å¹¶ç»„è£…HTMLè¿”å›ç»™æµè§ˆå™¨ï¼Œæµè§ˆå™¨ç›´æ¥è§£æHTMLåæ¸²æŸ“é¡µé¢ï¼ˆé¦–å±æ¸²æŸ“ï¼‰ æµè§ˆå™¨å®Œæˆäº‹ä»¶ç»‘å®šï¼Œåœ¨äº¤äº’è¿‡ç¨‹ä¸­ï¼Œè¯·æ±‚æ–°çš„æ•°æ®å¹¶åŠ¨æ€æ›´æ–°æ¸²æŸ“é¡µé¢ï¼ˆäº¤äº’æ¸²æŸ“ï¼‰ 2å¤§æ­¥æ­¤æ—¶æˆ‘ä»¬å¯ä»¥åˆ†ä¸º2å¤§æ­¥ 1.æ„å»ºæ—¶ å°†ä»£ç ç”Ÿæˆcommonjsæ ¼å¼äº§ç‰©ï¼Œè®©å‰ç«¯æœåŠ¡å™¨ï¼ˆnodeï¼‰å¯ä»¥æ­£å¸¸åŠ è½½ï¼ˆéšç€nodejså¯¹esmçš„æ”¯æŒæˆç†Ÿç¨‹åº¦å¢åŠ ï¼Œä¹Ÿåœ¨ä¸æ–­å˜å¾—å‹å¥½ï¼‰ ç§»é™¤ä»£ç æ ·å¼å¼•å…¥ ä¾èµ–å¤–éƒ¨åŒ–(external)ã€‚å¯¹äºæŸäº›ç¬¬ä¸‰æ–¹ä¾èµ–æˆ‘ä»¬å¹¶ä¸éœ€è¦ä½¿ç”¨æ„å»ºåçš„ç‰ˆæœ¬ï¼Œè€Œæ˜¯ç›´æ¥ä» node_modules ä¸­è¯»å–ï¼Œæ¯”å¦‚ react-domï¼Œè¿™æ ·åœ¨ SSR æ„å»ºçš„è¿‡ç¨‹ä¸­å°†ä¸ä¼šæ„å»ºè¿™äº›ä¾èµ–ï¼Œä»è€Œæå¤§ç¨‹åº¦ä¸ŠåŠ é€Ÿ SSR çš„æ„å»ºã€‚ 2.è¿è¡Œæ—¶ ä»SSRå…¥å£è®°è½½æ¨¡å— å°†æ•°æ®æ”¶å±éœ€è¦æ¸²æŸ“çš„æ•°æ®æå‰è¯·æ±‚ï¼ˆå†…ç½‘è¯·æ±‚ï¼‰ æ¸²æŸ“ç»„ä»¶ -&gt; html æ‹¼æ¥html å­—ç¬¦ä¸² SSGä½†æ˜¯ä¸€èˆ¬æ¥è¯´ï¼Œé¦–å±ä¸€èˆ¬ä¸ä¼šå¯¹å†…å®¹äº§ç”Ÿä»€ä¹ˆä¿®æ”¹ï¼Œä½†æ˜¯æ•°ä»¥ä¸‡è®¡çš„è®¿å®¢æ‰“å¼€ç½‘ç«™æ—¶å€™ï¼Œéƒ½è¦è¿›è¡Œæ•°æ®åº“æŸ¥è¯¢å—ï¼Ÿè¿™æ— ç–‘ä¼šå¯¼è‡´æ•°æ®åº“åç«¯çš„é‡å¤å¼€é”€ï¼Œè€Œè§£å†³é—®é¢˜çš„æ–¹æ³•æ˜¯ï¼š ï¼ˆSSGï¼‰å°†åç«¯æ¸²æŸ“çš„HTMLç¼“å­˜ï¼Œè¿™ä»½ç¼“å­˜ä½œä¸ºé™æ€å†…å®¹ï¼Œä¹Ÿæ›´å®¹æ˜“è¢«æ¨é€è‡³CDNï¼Œå®ç°å…¨å›½ç”šè‡³å…¨çƒåŠ é€Ÿï¼›å³ä½¿éœ€è¦ä¿®æ”¹å†…å®¹ï¼Œä¹Ÿå¯ä»¥é‡æ–°ç”Ÿæˆé™æ€å†…å®¹ï¼Œå†æ›´æ–°cdnå†…å®¹çš„æ–¹å¼è½»æ¾åº”å¯¹ ä½ å¯ä»¥ç†è§£ä¸ºæ„å»ºæ—¶è¯·æ±‚æ•°æ® + å¡«å…¥ ç¼ºç‚¹ï¼šæ‰€æœ‰ç”¨æˆ·çœ‹åˆ°çš„éƒ½æ˜¯åŒä¸€ä¸ªé¡µé¢ï¼Œæ— æ³•ç”Ÿæˆç”¨æˆ·ç›¸å…³å†…å®¹ï¼Œå¹¶ä¸”å¯¹äºç™¾ä¸‡çº§ã€åƒä¸‡çº§ã€äº¿çº§é¡µé¢çš„å¤§å‹ç½‘ç«™è€Œè¨€ï¼Œä¸€æ—¦æœ‰æ•°æ®æ”¹åŠ¨ï¼Œè¦è¿›è¡Œä¸€æ¬¡å…¨éƒ¨é¡µé¢çš„æ¸²æŸ“ï¼Œéœ€è¦çš„æ—¶é—´å¯èƒ½æ˜¯æŒ‰å°æ—¶ç”šè‡³æŒ‰å¤©è®¡çš„ï¼Œè¿™æ˜¯ä¸å¯æ¥å—çš„ã€‚ IslandSSR çš„é¡µé¢ä¼šç¬¬ä¸€æ—¶é—´å‘ˆç°ç»™ç”¨æˆ·ï¼Œä½†æ˜¯åªæœ‰å½“ js åŠ è½½å®Œæ¯•ï¼Œæ‰§è¡Œå®Œæ¯•åï¼ŒåŠŸèƒ½æ‰æ˜¯çœŸæ­£å¯ç”¨çš„ï¼š åŠŸèƒ½æ–¹é¢ï¼šç”¨æˆ·çœ‹åˆ°äº†ä½†æ˜¯ä¸èƒ½æ“ä½œ æ€§èƒ½æ–¹é¢ï¼šå¤§é‡ js åœ¨é¡µé¢åŠ è½½å®Œæˆåé›†ä¸­çš„è§£æã€æ‰§è¡Œï¼ŒFID å¿…ç„¶å—åˆ°å½±å“ è¿™å°±æ˜¯ Progressive Hydration å’Œ Islands Architecture è¦è§£å†³çš„é—®é¢˜ã€‚ä½†å®é™…ä¸Šï¼ŒæŸäº›åœºæ™¯ä¸‹ SSG + CSR æ‰æ˜¯æ›´å¥½çš„é€‰æ‹©ã€‚ æ˜ç™½äº†SSRã€CSRä¸¤è€…çš„ä¼˜åŠ¿åŠ£åŠ¿ä¹‹åï¼ŒIslands Architecture æ¡†æ¶çš„æ¦‚å¿µåœ¨äº ä¸å®¢æˆ·ç«¯æ¸²æŸ“ï¼ˆCSRï¼‰ç›¸å½“çš„äº¤äº’æ€§ ä¸æœåŠ¡ç«¯æ¸²æŸ“ï¼ˆSSRï¼‰ç›¸åª²ç¾çš„ SEO ä¼˜åŠ¿ ä½ å¯ä»¥ç†è§£ä¸ºå®¢æˆ·ç«¯è´Ÿè´£äº¤äº’JSï¼ˆé™ä½ åçš„JS ä½“ç§¯ï¼‰ï¼ŒæœåŠ¡ç«¯è´Ÿè´£SSRé™æ€ç›¸å…³çš„è¿›è¡Œæ¸²æŸ“ï¼ŒäºŒè€…ç»“åˆ Islandä¼˜ç‚¹ï¼š æ€§èƒ½ï¼šé™ä½å®¢æˆ·ç«¯ JS ä»£ç çš„ä½“ç§¯ã€‚åŠ è½½çš„ä»£ç ï¼Œä»…åŒ…å«äº¤äº’å¼ç»„ä»¶æ‰€éœ€çš„ JSï¼Œè¿™æ¯”ä¸ºæ•´ä¸ªé¡µé¢é‡æ–°åˆ›å»º Virtual DOMï¼Œå¹¶é‡æ–° hydrate é¡µé¢ä¸Šçš„æ‰€æœ‰å…ƒç´ æ‰€éœ€çš„ JS è¦å°‘å¾—å¤šã€‚è¾ƒå°çš„ JS ä¼šå¸¦æ¥æ›´å¿«çš„é¡µé¢åŠ è½½å’Œäº¤äº’æ—¶é—´ (TTI)ã€‚ Astro ä¸ä½¿ç”¨ Next.js å’Œ Nuxt.js åˆ›å»ºçš„æ–‡æ¡£ç½‘ç«™ç›¸æ¯”ï¼ŒJS ä»£ç å‡å°‘äº† 83%ã€‚å…¶ä»–ç”¨æˆ·ä¹Ÿåé¦ˆäº†ä½¿ç”¨ Astro çš„æ€§èƒ½æ”¹è¿›ã€‚ ï¼ˆå›¾ç‰‡æ¥è‡ª https://divriots.com/blog/our-experience-with-astro/ï¼‰ SEOï¼šç”±äºæ‰€æœ‰é™æ€å†…å®¹ç»è¿‡æœåŠ¡ç«¯æ¸²æŸ“ï¼Œæ‰€ä»¥é¡µé¢å¯¹ SEO åœºæ™¯æ˜¯å‹å¥½çš„ å…³é”®å†…å®¹ä¼˜å…ˆï¼šç”¨æˆ·å‡ ä¹å¯ä»¥ç«‹å³è·å¾—å…³é”®å†…å®¹ï¼ˆå°¤å…¶æ˜¯åšå®¢ã€æ–°é—»æ–‡ç« å’Œäº§å“ç±»çš„é¡µé¢ï¼‰ã€‚åœ¨å…³é”®å†…å®¹é€æ¸å¯ç”¨åï¼Œå¯äº¤äº’çš„æ¬¡è¦åŠŸèƒ½ä¹Ÿæ˜¯å¿…é¡»çš„ã€‚ å¯è®¿é—®æ€§ï¼šä½¿ç”¨æ ‡å‡†é™æ€ HTML é“¾æ¥å¯¼èˆªï¼Œæœ‰åŠ©äºæé«˜ç½‘ç«™çš„å¯è®¿é—®æ€§ï¼ˆAccessibilityï¼‰ã€‚ åŸºäºç»„ä»¶ï¼šè¯¥æ¶æ„å…·æœ‰åŸºäºç»„ä»¶çš„æ¶æ„çš„æ‰€æœ‰ä¼˜ç‚¹ï¼Œå¦‚ï¼šå¯é‡ç”¨ã€å¯ç»´æŠ¤ã€‚ IsLandç¼ºç‚¹ï¼š å°½ç®¡æœ‰è¿™äº›ä¼˜åŠ¿ï¼Œä½†è¯¥æ¦‚å¿µä»å¤„äºåˆæœŸé˜¶æ®µã€‚â€œæœ‰é™çš„æ”¯æŒâ€å¯¼è‡´äº†ä¸€äº›ç¼ºç‚¹ï¼š å¼€å‘äººå‘˜å®ç° Islands çš„å”¯ä¸€é€‰æ‹©ï¼Œæ˜¯ä½¿ç”¨å°‘æ•°å¯ç”¨çš„æ¡†æ¶ä¹‹ä¸€ï¼Œæˆ–è‡ªå·±å®ç°æ¶æ„ã€‚å°†ç°æœ‰ç«™ç‚¹è¿ç§»åˆ° Astro æˆ– Marko éœ€è¦é¢å¤–çš„å·¥ä½œé‡ã€‚ é™¤äº† Jason æœ€åˆçš„æ–‡ç« å¤–ï¼Œå‡ ä¹æ²¡æœ‰æ›´å¤šçš„ä¿¡æ¯ã€‚ æœ‰ä¸€äº›æ–°æ¡†æ¶å£°ç§°æ”¯æŒ Islands Architectureï¼Œå› æ­¤ç­›é€‰å‡ºé€‚åˆä½ çš„æ¶æ„ä¼šæ›´éš¾ã€‚ è¯¥æ¶æ„ä¸é€‚åˆå¤æ‚äº¤äº’é¡µé¢ï¼Œä¾‹å¦‚å¯èƒ½éœ€è¦æ•°åƒä¸ª Islands çš„ç¤¾äº¤åº”ç”¨ã€‚ å‚è€ƒ Islands Architecture Islands Architectureç»­ æ›´å¥½çš„ React SSR å½»åº•ç†è§£æœåŠ¡ç«¯æ¸²æŸ“ - SSRåŸç† Next.js çš„ä¸‰ç§æ¸²æŸ“æ–¹å¼ï¼ˆBSRã€SSGã€SSRï¼‰ æ·±å…¥æµ…å‡ºvite","categories":[{"name":"å‰ç«¯","slug":"å‰ç«¯","permalink":"https://taylor12138.github.io/categories/%E5%89%8D%E7%AB%AF/"}],"tags":[],"author":"Hello"},{"title":"SWC","slug":"SWC","date":"2023-03-27T03:22:26.044Z","updated":"2023-03-29T15:20:13.554Z","comments":true,"path":"2023/03/27/swc/","link":"","permalink":"https://taylor12138.github.io/2023/03/27/swc/","excerpt":"","text":"SWCSWC æ˜¯ä¸€ä¸ªå¯æ‰©å±•çš„åŸºäº Rust çš„å¹³å°ï¼Œç”¨äºä¸‹ä¸€ä»£å¿«é€Ÿå¼€å‘å·¥å…· SWC å¯ç”¨äºç¼–è¯‘å’Œæ†ç»‘ã€‚å¯¹äºç¼–è¯‘ï¼Œå®ƒä½¿ç”¨ç°ä»£ JavaScript åŠŸèƒ½è·å– JavaScript / TypeScript æ–‡ä»¶ï¼Œå¹¶è¾“å‡ºæ‰€æœ‰ä¸»è¦æµè§ˆå™¨éƒ½æ”¯æŒçš„æœ‰æ•ˆä»£ç ï¼Œç±»ä¼¼äº babelã€‚ è™½ç„¶ç›®å‰SWC ä¹Ÿæä¾›äº† Bundle èƒ½åŠ›ï¼Œä½†æ˜¯å…¶ç”Ÿæ€å’Œç¨³å®šæ€§ä¸Šæ¥è¯´ç¨å¾®é€Šè‰² å®˜æ–¹ï¼šSWCåœ¨å•çº¿ç¨‹ä¸Šæ¯” Babel å¿« 20 å€ï¼Œåœ¨å››æ ¸ä¸Š**å¿« 70 å€**ã€‚ å¿«çš„åŸå› ç½‘ä¸Šçœ‹äº†å¤§æ¦‚æ˜¯å› ä¸ºæ”¯æŒå¹¶è¡Œçš„ç‰¹æ€§ SWC çš„ç¼–è¯‘æ—¨åœ¨æ”¯æŒæ‰€æœ‰ ECMAScript ç‰¹æ€§ã€‚SWC CLI æ—¨åœ¨æˆä¸º Babel çš„ç›´æ¥æ›¿ä»£å“ï¼š $ npx babel # old $ npx swc # new SWC æ”¯æŒæ‰€æœ‰ stage 3 proposalså’Œ preset-envï¼ŒåŒ…æ‹¬ bugfix è½¬æ¢ã€‚ ç‰¹æ€§ Compilation ï¼ˆç¼–è¯‘ï¼‰ Bundling (swcpack, under development) ï¼ˆæ‰“åŒ…ï¼Œæ­£åœ¨å¼€å‘ä¸­ï¼‰ Minification ï¼ˆå‹ç¼©ï¼‰ Transforming with WebAssembly ï¼ˆä½¿ç”¨WebAssemblyè¿›è¡Œè½¬æ¢ï¼‰ Usage inside webpack (swc-loader) ï¼ˆåœ¨webpackä¸­ä½¿ç”¨ï¼‰ Improving Jest performance (@swc/jest) ï¼ˆæé«˜jestå•æµ‹æ€§èƒ½ï¼‰ Custom Plugins ï¼ˆä¸ªæ€§åŒ–æ’ä»¶å®šåˆ¶ï¼‰ ä½¿ç”¨pnpm i -D @swc/cli @swc/core æˆ–è€… npm i -D @swc/cli @swc/core æˆ–è€… yarn add -D @swc/cli @swc/core ç„¶å npx swc ./file.js å‚è€ƒæ–‡ç« SWCå®˜ç½‘ swc-node, æœ€å¿«çš„ TypeScript/JavaScript compiler","categories":[],"tags":[]},{"title":"Monorepo","slug":"Monorepo","date":"2023-03-27T02:19:46.585Z","updated":"2023-03-27T03:07:29.212Z","comments":true,"path":"2023/03/27/monorepo/","link":"","permalink":"https://taylor12138.github.io/2023/03/27/monorepo/","excerpt":"","text":"monorepoä¸€ä¸ª monorepo æ˜¯ä¸€ä¸ªä»£ç åº“ä¸­è®¸å¤šä¸åŒåº”ç”¨ç¨‹åºå’ŒåŒ…çš„é›†åˆã€‚ ç”¨äºæ›¿ä»£polyrepoæ–¹æ¡ˆï¼Œä½ å¯ä»¥ç†è§£ä¸º monorepo å°±æ˜¯å°†åˆ¶å®šçš„éƒ½é¡¹ç›®ç§»åŠ¨åˆ°ä¸€ä¸ªå­˜å‚¨åº“ä¸­ï¼Œè¿™äº›é¡¹ç›®å¯ä»¥ç›¸äº’ä¾èµ–ï¼Œå› æ­¤å®ƒä»¬å¯ä»¥å…±äº«ä»£ç ã€‚å¹¶ä¸”å‡ ä¹ä¸éœ€è¦åŒ…ç®¡ç†å™¨ï¼Œæ¯•ç«Ÿæ‰€æœ‰æ¨¡å—éƒ½æ‰˜ç®¡åœ¨åŒä¸€ä¸ªå­˜å‚¨åº“ä¸­ åœ¨polyrepoä¸­å‡è®¾æ‚¨æ‹¥æœ‰ä¸‰ä¸ªç‹¬ç«‹çš„å­˜å‚¨åº“ - appã€docså’Œshared-utilsã€‚å’Œappéƒ½docsä¾èµ–äºshared-utilsï¼Œå®ƒä½œä¸ºä¸€ä¸ªåŒ…å‘å¸ƒåœ¨ npm ä¸Šã€‚ æ­¤æ—¶ shared-utils å‡ºç°ä¸¥é‡é—®é¢˜ï¼Œä½†æ˜¯ä½ çš„ appã€docs éƒ½ä¾èµ–äº† shared-utils ï¼Œæ­¤æ—¶ä½ éœ€è¦ï¼š æäº¤shared-utilsä¿®å¤é”™è¯¯ è¿è¡Œä¸€ä¸ªpublishä»»åŠ¡shared-utilså‘å¸ƒåˆ° npm å‡çº§ app çš„ä¾èµ–ç‰ˆæœ¬ å‡çº§ docs çš„ä¾èµ–ç‰ˆæœ¬ é‡æ–°éƒ¨ç½² docsã€app é¡¹ç›® æ„Ÿè§‰æµç¨‹æ˜¯ä¸æ˜¯æ¯”è¾ƒé•¿. åœ¨monorepoä¸­é‡åˆ°ä»¥ä¸Šé—®é¢˜ï¼Œä½ åªéœ€ æäº¤shared-utilsä¿®å¤é”™è¯¯ é‡æ–°éƒ¨ç½² docsã€app é¡¹ç›® ä¼˜ç‚¹ å¯è§æ€§ï¼šæ¯ä¸ªäººéƒ½å¯ä»¥çœ‹åˆ°å…¶ä»–äººçš„ä»£ç ã€‚æ­¤å±æ€§å¯ä»¥å¸¦æ¥æ›´å¥½çš„åä½œå’Œè·¨å›¢é˜Ÿçš„è´¡çŒ®â€”â€”ä¸åŒå›¢é˜Ÿä¸­çš„å¼€å‘äººå‘˜å¯ä»¥ä¿®å¤ä»£ç ä¸­ä½ ç”šè‡³ä¸çŸ¥é“å­˜åœ¨çš„é”™è¯¯ã€‚ æ›´ç®€å•çš„ä¾èµ–ç®¡ç†ï¼šå…±äº«ä¾èµ–æ˜¯å¾®ä¸è¶³é“çš„ã€‚å‡ ä¹ä¸éœ€è¦åŒ…ç®¡ç†å™¨ï¼Œå› ä¸ºæ‰€æœ‰æ¨¡å—éƒ½æ‰˜ç®¡åœ¨åŒä¸€ä¸ªå­˜å‚¨åº“ä¸­ã€‚ å•ä¸€äº‹å®æ¥æºï¼šæ¯ä¸ªä¾èµ–çš„ä¸€ä¸ªç‰ˆæœ¬æ„å‘³ç€æ²¡æœ‰ç‰ˆæœ¬å†²çªï¼Œä¹Ÿæ²¡æœ‰ä¾èµ–åœ°ç‹±ã€‚ ä¸€è‡´æ€§ï¼šå½“æ‚¨å°†æ‰€æœ‰ä»£ç åº“æ”¾åœ¨ä¸€ä¸ªåœ°æ–¹æ—¶ï¼Œæ‰§è¡Œä»£ç è´¨é‡æ ‡å‡†å’Œç»Ÿä¸€é£æ ¼ä¼šæ›´å®¹æ˜“ã€‚ å…±äº«æ—¶é—´è¡¨ï¼šAPI æˆ–å…±äº«åº“ä¸­çš„é‡å¤§æ›´æ”¹ä¼šç«‹å³å…¬å¼€ï¼Œè¿«ä½¿ä¸åŒçš„å›¢é˜Ÿæå‰æ²Ÿé€šå¹¶è”åˆèµ·æ¥ã€‚æ¯ä¸ªäººéƒ½æŠ•å…¥ç²¾åŠ›è·Ÿä¸Šå˜åŒ–ã€‚ åŸå­æäº¤ï¼šåŸå­æäº¤ä½¿å¤§è§„æ¨¡é‡æ„æ›´å®¹æ˜“ã€‚å¼€å‘äººå‘˜å¯ä»¥åœ¨ä¸€æ¬¡æäº¤ä¸­æ›´æ–°å¤šä¸ªåŒ…æˆ–é¡¹ç›®ã€‚ éšå¼ CIï¼šæŒç»­é›†æˆå¾—åˆ°ä¿è¯ï¼Œå› ä¸ºæ‰€æœ‰ä»£ç éƒ½å·²ç»ç»Ÿä¸€åœ¨ä¸€ä¸ªåœ°æ–¹ã€‚ ç»Ÿä¸€ CI/CDï¼šæ‚¨å¯ä»¥å¯¹å­˜å‚¨åº“ä¸­çš„æ¯ä¸ªé¡¹ç›®ä½¿ç”¨ç›¸åŒçš„CI/CDéƒ¨ç½²è¿‡ç¨‹ã€‚ ç»Ÿä¸€æ„å»ºè¿‡ç¨‹ï¼šæˆ‘ä»¬å¯ä»¥ä¸º repo ä¸­çš„æ¯ä¸ªåº”ç”¨ç¨‹åºä½¿ç”¨å…±äº«æ„å»ºè¿‡ç¨‹ã€‚ ç¼ºç‚¹ æ€§èƒ½ä¸ä½³ï¼šmonorepos éš¾ä»¥æ‰©å±•ã€‚åƒè¿™æ ·çš„å‘½ä»¤git blameå¯èƒ½ä¼šèŠ±è´¹ä¸åˆç†çš„é•¿æ—¶é—´ï¼ŒIDE å¼€å§‹æ»åå¹¶ä¸”ç”Ÿäº§åŠ›å—åˆ°å½±å“ï¼Œå¹¶ä¸”åœ¨æ¯æ¬¡æäº¤æ—¶æµ‹è¯•æ•´ä¸ª repo å˜å¾—ä¸å¯è¡Œã€‚ æŸåçš„ main/masterï¼šæŸåçš„ master ä¼šå½±å“åœ¨ monorepo ä¸­å·¥ä½œçš„æ¯ä¸ªäººã€‚è¿™å¯ä»¥è¢«è§†ä¸ºç¾éš¾æ€§çš„ï¼Œä¹Ÿå¯ä»¥è¢«è§†ä¸ºä¿æŒæµ‹è¯•æ¸…æ´å’Œæœ€æ–°çš„è‰¯å¥½åŠ¨æœºã€‚ å­¦ä¹ æ›²çº¿ï¼šå¦‚æœå­˜å‚¨åº“è·¨è¶Šè®¸å¤šç´§å¯†è€¦åˆçš„é¡¹ç›®ï¼Œæ–°å¼€å‘äººå‘˜çš„å­¦ä¹ æ›²çº¿ä¼šæ›´é™¡å³­ã€‚ å¤§é‡æ•°æ®ï¼šmonorepos å¯ä»¥è¾¾åˆ°åºå¤§çš„æ•°æ®é‡å’Œæ¯å¤©çš„æäº¤é‡ã€‚ æ‰€æœ‰æƒï¼šç»´æŠ¤æ–‡ä»¶çš„æ‰€æœ‰æƒæ›´å…·æŒ‘æˆ˜æ€§ï¼Œå› ä¸ºåƒ Git æˆ– Mercurial è¿™æ ·çš„ç³»ç»Ÿæ²¡æœ‰å†…ç½®çš„ç›®å½•æƒé™ã€‚ï¼ˆä½†æ˜¯æœ‰è§£å†³æ–¹å¼ï¼‰ ä»£ç å®¡æŸ¥ï¼šé€šçŸ¥ä¼šå˜å¾—éå¸¸å˜ˆæ‚ã€‚ä¾‹å¦‚ï¼ŒGitHub çš„é€šçŸ¥è®¾ç½®æœ‰é™ï¼Œä¸é€‚åˆå¤§é‡çš„æ‹‰å–è¯·æ±‚å’Œä»£ç å®¡æŸ¥ã€‚ æ›´å¤šçš„è€ƒè™‘ï¼šè¿ç§»åˆ° monorepo éœ€è¦æ‚¨é‡æ–°è€ƒè™‘å¦‚ä½•è¿›è¡ŒæŒç»­é›†æˆã€‚æ¯•ç«Ÿï¼Œæ‚¨ä¸å†æ„å»ºå•ä¸ªåº”ç”¨ç¨‹åºã€‚æ‚¨åªæ˜¯åœ¨æ„å»ºå—æ‚¨çš„æ›´æ”¹å½±å“çš„ä¸œè¥¿ã€‚ è¿ä½œæ¨¡å¼monorepo çš„ä¸»è¦æ„å»ºå—æ˜¯workspaceã€‚æ‚¨æ„å»ºçš„æ¯ä¸ªåº”ç”¨ç¨‹åºå’ŒåŒ…éƒ½å°†ä½äºè‡ªå·±çš„å·¥ä½œåŒºä¸­ï¼Œå¹¶å¸¦æœ‰è‡ªå·±çš„package.json. æ­£å¦‚æ‚¨å°†ä»æˆ‘ä»¬çš„æŒ‡å—ä¸­äº†è§£åˆ°çš„ï¼Œå·¥ä½œç©ºé—´å¯ä»¥ç›¸äº’ä¾èµ–ï¼Œè¿™æ„å‘³ç€æ‚¨çš„docså·¥ä½œç©ºé—´å¯ä»¥ä¾èµ–äºshared-utilsï¼š npmï¼š { \"dependencies\": { \"shared-utils\": \"*\" } } yarnï¼š { \"dependencies\": { \"shared-utils\": \"*\" } } pnpm { \"dependencies\": { \"shared-utils\": \"workspace:*\" } } å‚è€ƒï¼š what is monorepo What is monorepo? (and should you use it?) Misconceptions about Monorepos: Monorepo != Monolith","categories":[],"tags":[]},{"title":"Vite","slug":"Vite","date":"2023-02-28T16:00:00.000Z","updated":"2023-04-15T09:09:00.272Z","comments":true,"path":"2023/03/01/vite/","link":"","permalink":"https://taylor12138.github.io/2023/03/01/vite/","excerpt":"","text":"Viteæ¦‚è¿°Webpackæ˜¯å‰ç«¯ä½¿ç”¨æœ€å¤šçš„æ„å»ºå·¥å…·ï¼Œä½†æ˜¯é™¤äº†webpackè¿˜æœ‰ä¸€äº›å…¶ä»–çš„æ„å»ºå·¥å…·ï¼Œæ¯”å¦‚rollupã€parcelã€gulpã€vite Vite æ˜¯ vue çš„ä½œè€…å°¤é›¨æºªåœ¨å¼€å‘ vue3.0 çš„æ—¶å€™å¼€å‘çš„ä¸€ä¸ªåŸºäºåŸç”Ÿ ES-Module çš„å‰ç«¯æ„å»ºå·¥å…· Viteå®˜æ–¹çš„å®šä½ï¼šä¸‹ä¸€ä»£å‰ç«¯å¼€å‘å’Œæ„å»ºå·¥å…· ä»–ä¸»è¦ç”±ä¸¤éƒ¨åˆ†ç»„æˆ ä¸€ä¸ªå¼€å‘æœåŠ¡å™¨ï¼Œå®ƒåŸºäºåŸç”ŸESæ¨¡å—æä¾›äº†ä¸°å¯Œçš„å†…å»ºåŠŸèƒ½ï¼Œå¹¶ä¸”å€ŸåŠ© Esbuild è¶…å¿«çš„ç¼–è¯‘é€Ÿåº¦æ¥åšç¬¬ä¸‰æ–¹åº“æ„å»ºå’Œ TS/JSX è¯­æ³•ç¼–è¯‘ï¼Œè¿™ä½¿å¾—HMRé€Ÿåº¦éå¸¸å¿« ä¸€å¥—æ„å»ºæŒ‡ä»¤ï¼Œå®ƒä½¿ç”¨rollupæ‰“åŒ…æˆ‘ä»¬çš„ä»£ç ï¼ˆä½¿ç”¨rollupæ‰“åŒ…åŠŸèƒ½ï¼‰ï¼Œå¹¶ä¸”å®ƒæ˜¯é¢„é…ç½®çš„ï¼Œè¾“å‡ºç”Ÿæˆç¯å¢ƒä¼˜åŒ–è¿‡çš„é™æ€èµ„æº æ‰€ä»¥æ„å»ºè¿‡ç¨‹ä¸­ Vite ä¸­ä»ç„¶ä½¿ç”¨ Esbuild è¿›è¡Œç¼–è¯‘å’Œå‹ç¼©ï¼Œä½†æ‰“åŒ…ç•™ç»™ Rollupã€‚æ‰€ä»¥ esbuild ç”¨äºæ„å»ºè¿‡ç¨‹çš„ä¸€éƒ¨åˆ†ã€‚ å›¾ç‰‡æºè‡ªç¥ä¸‰å…ƒçš„ã€Šæ·±å…¥æµ…å‡ºviteã€‹ Viteåˆè¡·å°±æ˜¯ä¾èµ–æµè§ˆå™¨æœ¬èº«å°±è¯†åˆ«çš„ä¾èµ–å…³ç³»ç›´æ¥å°†jsè§£æå‘ˆç°ï¼Œè€Œä¸è€ƒè™‘å…¶ä»– Vite æ‰€å€¡å¯¼çš„no-bundleç†å¿µçš„çœŸæ­£å«ä¹‰: åˆ©ç”¨æµè§ˆå™¨åŸç”Ÿ ES æ¨¡å—çš„æ”¯æŒï¼Œå®ç°å¼€å‘é˜¶æ®µçš„ Dev Serverï¼Œè¿›è¡Œæ¨¡å—çš„æŒ‰éœ€åŠ è½½ï¼Œè€Œä¸æ˜¯å…ˆæ•´ä½“æ‰“åŒ…å†è¿›è¡ŒåŠ è½½ ä¼˜ç‚¹ï¼š å¿«ï¼Œæ„å»ºå¿«ã€å†·å¯åŠ¨å¿«ã€çƒ­æ›´æ–°å¿«ã€‚å¿«åœ¨å“ªï¼Ÿ å¼€å‘é˜¶æ®µï¼š ä½¿ç”¨esbuildè¿›è¡Œäº†é¢„æ„å»º esbuildæœ¬èº«çš„æ‰“åŒ…é€Ÿåº¦å¿« æœ¬èº«çš„no-bundleï¼Œæ‡’åŠ è½½ ä½¿ç”¨@vitejs/plugin-react-swcï¼Œåœ¨å¼€å‘é˜¶æ®µï¼Œå°† Babel æ›¿æ¢ä¸º SWCï¼Œå†·å¯åŠ¨å’Œæ¨¡å—çƒ­æ›¿æ¢ï¼ˆHMRï¼‰å°†ä¼šæœ‰æ˜¾è‘—æå‡ ç”Ÿäº§ç¯å¢ƒï¼š é¢„æ„å»ºé˜¶æ®µï¼Œç¼–è¯‘èƒ½åŠ›ä¾ç„¶ç”¨åˆ°äº†esbuildï¼ˆTransformerï¼‰ï¼Œå¯¹ TS(X)/JS(X) è¿›è¡Œç¼–è¯‘ï¼Œæ‰€ä»¥å¿«ï¼ˆä½†æ˜¯viteçš„ä¸€äº›é»˜è®¤React é¢„è®¾ä½¿ç”¨ Babel æ¥è½¬æ¢ React HMR å’Œ JSXã€‚ï¼‰ ä»vite2.6å¼€å§‹ï¼Œè‡ªåŠ¨å¯ç”¨esbuildå¯¹ä»£ç å‹ç¼©ï¼ˆesbuildçš„å‹ç¼©é€Ÿåº¦æ˜¯è¦æ¯”webpackçš„terserå¿«çš„ï¼‰ ä½†æ˜¯ç¼ºç‚¹å°±æ˜¯ï¼š å¦‚æœåŒ…ä¾èµ–å¤ªå¤šï¼Œä¼šå‘é€è¿‡å¤šçš„ç½‘ç»œè¯·æ±‚ï¼ˆimport è¯­å¥å³ä»£è¡¨ä¸€ä¸ª HTTP è¯·æ±‚ï¼‰ ä¸€äº›å…¼å®¹æ€§é—®é¢˜ï¼Œåœ¨å®˜ç½‘çš„issueå¯ä»¥çœ‹åˆ° å†™è‡ªå·±æ’ä»¶æœ‰éœ€è¦çš„è¯ï¼Œä¹Ÿè¦åŒæ—¶å…¼å®¹ rollup å’Œ esbuild Viteå°†åŸºäºåŸç”Ÿæµè§ˆå™¨çš„ç‰¹ç‚¹ï¼Œè§£å†³ä»¥ä¸Šç¼ºç‚¹ è¿˜æœ‰å°¤å¤§æ€¼äººçš„ç›¸å…³é“¾æ¥ï¼šå°¤é›¨æºªï¼šTurbopack çœŸçš„æ¯” Vite å¿« 10 å€å—ï¼Ÿ Esbuildesbuild æ˜¯ä¸€ä¸ªç”¨ Go è¯­è¨€ç¼–å†™çš„ç”¨äºæ‰“åŒ…ï¼Œï¼ˆè‡ªå¸¦å‹ç¼©ï¼‰å‹ç¼© Javascript ä»£ç çš„å·¥å…·åº“ï¼ˆç±»ä¼¼webpackçš„æ„å»ºå·¥å…·ï¼‰ ä¼˜ç‚¹ï¼šç¼–è¯‘ã€æ„å»ºé€Ÿåº¦å¿« ä¸ºä»€ä¹ˆè¿™ä¹ˆå¿«ï¼Ÿ å®ƒæ˜¯ç”¨ Go è¯­è¨€ç¼–å†™çš„ï¼Œè¯¥è¯­è¨€å¯ä»¥ç¼–è¯‘ä¸ºæœ¬åœ°ä»£ç  è§£æï¼Œç”Ÿæˆæœ€ç»ˆæ‰“åŒ…æ–‡ä»¶å’Œç”Ÿæˆ source maps çš„æ“ä½œå…¨éƒ¨å®Œå…¨å¹¶è¡ŒåŒ– æ— éœ€æ˜‚è´µçš„æ•°æ®è½¬æ¢ï¼Œæ²¡æœ‰ä½¿ç”¨ç¬¬ä¸‰æ–¹ä¾èµ–ï¼Œåªéœ€å¾ˆå°‘çš„å‡ æ­¥å³å¯å®Œæˆæ‰€æœ‰æ“ä½œ åœ¨ Webpackã€Rollup è¿™ç±»å·¥å…·ä¸­ï¼Œæˆ‘ä»¬ä¸å¾—ä¸ä½¿ç”¨å¾ˆå¤šé¢å¤–çš„ç¬¬ä¸‰æ–¹æ’ä»¶æ¥è§£å†³å„ç§å·¥ç¨‹éœ€æ±‚ï¼Œæ¯”å¦‚ï¼š ä½¿ç”¨ babel å®ç° ES ç‰ˆæœ¬è½¬è¯‘ ä½¿ç”¨ eslint å®ç°ä»£ç æ£€æŸ¥ ä½¿ç”¨ TSC å®ç° ts ä»£ç è½¬è¯‘ä¸ä»£ç æ£€æŸ¥ ä½¿ç”¨ lessã€stylusã€sass ç­‰ css é¢„å¤„ç†å·¥å…· ä½†æ˜¯Esbuild å®Œå…¨é‡å†™æ•´å¥—ç¼–è¯‘æµç¨‹æ‰€éœ€è¦ç”¨åˆ°çš„æ‰€æœ‰å·¥å…· è¯¥åº“ä»¥æé«˜ç¼–è¯‘é€Ÿåº¦ä¸ºç¼–å†™ä»£ç æ—¶çš„ç¬¬ä¸€åŸåˆ™ï¼Œå¹¶å°½é‡é¿å…ä¸å¿…è¦çš„å†…å­˜åˆ†é…ï¼ˆgoçš„èƒ½åŠ›ï¼‰ ç¼ºç‚¹ï¼š babelæ’ä»¶é—®é¢˜ ä¸ºäº†ä¿è¯ esbuild çš„ç¼–è¯‘æ•ˆç‡ï¼Œesbuild æ²¡æœ‰æä¾› AST çš„æ“ä½œèƒ½åŠ›ã€‚æ‰€ä»¥ä¸€äº›é€šè¿‡ AST å¤„ç†ä»£ç çš„ babel-plugin æ²¡æœ‰å¾ˆå¥½çš„æ–¹æ³•è¿‡æ¸¡åˆ° esbuild ä¸­ï¼ˆæ¯”å¦‚ babel-plugin-importï¼‰ ä½œä¸ºæ‰“åŒ…å·¥å…·çš„è¯ï¼Œä»£ç åˆ†å‰²å’Œ CSSå¤„ç†æ–¹é¢ è¾ƒå·® è™½ç„¶è‡ªå¸¦ï¼ˆæ†ç»‘ï¼‰äº†å‹ç¼©åŠŸèƒ½ï¼Œä½†æ˜¯åœ¨ esbuild å‘½ä»¤ä¸­ä½¿ç”¨â€œ minify â€å’Œâ€œ bundle â€é€‰é¡¹ä¸ä¼šåˆ›å»ºä¸Rollup / Terserç®¡é“ä¸€æ ·å°çš„åŒ…ã€‚è¿™æ˜¯å› ä¸º esbuild ç‰ºç‰²äº†ä¸€äº›åŒ…å¤§å°ä¼˜åŒ–ä»¥å°½å¯èƒ½å°‘åœ°é€šè¿‡æ‚¨çš„ä»£ç ã€‚ä½†æ˜¯ï¼Œå·®å¼‚å¯èƒ½å¯ä»¥å¿½ç•¥ä¸è®¡ï¼Œå¹¶ä¸”å¯¹äºæé«˜æ†ç»‘é€Ÿåº¦æ¥è¯´æ˜¯å€¼å¾—çš„ï¼Œå…·ä½“å–å†³äºæ‚¨çš„é¡¹ç›®ã€‚ åœ¨ç”Ÿäº§ç¯å¢ƒä¸‹ä½¿ç”¨ esbuild æ˜¯å¯è¡Œçš„ã€‚åƒ snowpack , vite ç­‰æ„å»ºå·¥å…·éƒ½å·²ç»æ˜¯ç”¨äº† esbuild ä½œä¸ºä»£ç å¤„ç†å·¥å…·ï¼ˆç¨³å®šæ€§å·²ç»è¶³å¤Ÿï¼‰ã€‚å¦‚æœä½ ä¸€å®šè¦ä½¿ç”¨ï¼Œå¯ä»¥çœ‹çœ‹æ˜¯å¦ç¬¦åˆä¸‹é¢æ ‡å‡† æ²¡æœ‰ä½¿ç”¨ä¸€äº›è‡ªå®šä¹‰çš„ babel-plugin (å¦‚ babel-plugin-import) ä¸éœ€è¦å…¼å®¹ä¸€äº›ä½ç‰ˆæœ¬æµè§ˆå™¨ï¼ˆesbuild åªèƒ½å°†ä»£ç è½¬æˆ es6ï¼‰ é‚£ä½ å°±å¯ä»¥å¤§èƒ†ä½¿ç”¨ esbuild-loader ä¸ºä½ çš„é¡¹ç›®ææ•ˆäº† rollupRollup ä¹Ÿæ˜¯å‰ç«¯æ¨¡å—åŒ–çš„ä¸€ä¸ªæ‰“åŒ…å·¥å…·ï¼Œå®ƒçš„å¼€å‘æœ¬æ„ï¼Œæ˜¯æ‰“é€ ä¸€æ¬¾ç®€å•æ˜“ç”¨çš„ ES æ¨¡å—æ‰“åŒ…ï¼ˆå’Œesbuildå¤©ç„¶é…åˆï¼‰å·¥å…·ï¼Œä¸å¿…é…ç½®ï¼Œç›´æ¥ä½¿ç”¨ ä¼˜ç‚¹ï¼š ä¸å¿…é…ç½®ï¼Œç›´æ¥é£Ÿç”¨ï¼Œå¯¹ tree shaking æœ‰ç€è‰¯å¥½çš„æ”¯æŒï¼Œäº§ç‰©éå¸¸å¹²å‡€ï¼Œæ”¯æŒå¤šç§è¾“å‡ºæ ¼å¼ï¼Œé€‚åˆåšåº“çš„å¼€å‘ rollupæ’ä»¶æ€è·¯å¾ˆæ£’ï¼ŒViteçš„æ’ä»¶å†™æ³•å°±æ˜¯æ¨¡ä»¿rollupçš„ï¼Œç”šè‡³æœ‰ä¸å°‘ Rollup æ’ä»¶å¯ä»¥ç›´æ¥å¤ç”¨åˆ° Vite ã€‚ å·¥å…·åº“æ‰“åŒ…åä½“ç§¯æ›´å°ä¸€ç‚¹ ç¼ºç‚¹ï¼š ä»‹ç»æ˜¯è¿™ä¹ˆä»‹ç»ï¼Œä½†æ˜¯æˆ‘ä¸ªäººç”¨ä¸‹æ¥ï¼Œ webapck5ä¹‹åé…ç½®é¡¹ä¸Šæ¥çœ‹ï¼Œwebpackæ˜¯æ¯”rollupå°‘çš„ï¼Œ è€Œä¸”webpack5è¿˜è‡ªå¸¦terserå„ç§ä»£ç å‹ç¼©ï¼Œéƒ½ä¸ç”¨é…ç½®äº†ï¼Œä½†æ˜¯rollupè¿˜éœ€è¦é…ç½®ï¼Œæˆªæ­¢2023.4.14ä¸ºæ­¢ï¼Œrollupå·²ç»æ›´æ–°è‡³3.20ç‰ˆæœ¬ï¼Œéƒ¨åˆ†æ’ä»¶è¿˜ä¸å…¼å®¹rollup3.0ï¼ˆå®˜æ–¹æ–‡æ¡£æœªæ›´æ–°ï¼Œæ¯”å¦‚æ–‡æ¡£æ¨èç”¨rollup-plugin-terserå‹ç¼©ï¼Œä½†æ˜¯å®é™…ä¸Šæœ‰å…¼å®¹é—®é¢˜ï¼Œè¦ç”¨ åŸterserè¿›è¡Œæ›¿ä»£ï¼‰ è€Œä¸”rollupå®˜æ–¹æ–‡æ¡£ä¹Ÿæ¯”webpacké€Šè‰²ï¼Œè€Œä¸”rollupæ‰“åŒ…è¿˜éœ€è¦æ›´é«˜ç‰ˆæœ¬çš„nodeæ”¯æŒï¼Œwebpack5å…¼å®¹nodeæ›´å¥½ æ³¨æ„ï¼šå¦‚æœä½ æƒ³ç”¨rollupæ‰“åŒ…commonjsï¼Œæ¯”å¦‚é¡¹ç›®ä¸­ç”¨äº†lodashï¼Œé‚£è¦èµ°å’Œwebpackä¸€æ ·éº»çƒ¦çš„é…ç½®æµç¨‹ï¼Œé‚£è¿˜ä¸å¦‚ç”¨webpack å¦‚æœä½ éœ€è¦ code-splittingï¼Œæœ‰å¾ˆå¤š static assetsï¼Œéœ€è¦ä½¿ç”¨å¾ˆå¤š CommonJS ä¾èµ–ï¼Œä½¿ç”¨ Webpack å¦‚æœä½ çš„ codebase æ˜¯ES Moduleï¼Œå†™ä¸€äº›ç»™å…¶ä»–äººä½¿ç”¨çš„ä»£ç æˆ–åº“ï¼Œé‚£ä¹ˆä½¿ç”¨ Rollup webpackä¼˜ç‚¹ï¼š å…¼å®¹æ€§æ— æ•Œ ç”Ÿæ€å¼ºå¤§ï¼Œæ’ä»¶ã€loaderå¼ºå¤§ï¼Œçµæ´» æ‰€ä»¥é€‚åˆå¤§å‹é¡¹ç›® ç¼ºç‚¹ï¼š ä¸Šæ‰‹éº»çƒ¦ï¼Œå†·å¯åŠ¨ï¼Œçƒ­æ›´æ–°æ…¢ æ€§èƒ½æµ‹è¯•(è¯¥æ•°æ®æµ‹è¯•æˆªæ­¢äº2022.4)æ‰“åŒ…å·¥å…·ç‰¹æ€§å¯¹æ¯”æ€»è§ˆ æ‰“åŒ…é€Ÿåº¦æµ‹è¯•æ‰“åŒ… antd + lodash + react + react-dom + three.js çš„é€Ÿåº¦ã€‚ä¸ºäº†æ§åˆ¶å˜é‡ï¼Œç»Ÿä¸€é‡‡ç”¨ esbuild ä½œä¸º minifierï¼ˆspack ä¸æ”¯æŒé™¤å¤–ï¼‰ã€‚ æµ‹è¯•æ•°æ®æ¥æº webpack rollup parcel esbuild spack ThinkPad T480 5.347s 14.548s 6.069s 0.249s 1.082s MacBook 16, 2019 4.229s 12.790s 5.225s 0.227s 1.012s æ‰“åŒ…é€Ÿåº¦ä¸Šé¦–å½“å…¶å†²çš„å°±æ˜¯esbuildï¼Œæ¯‹åº¸ç½®ç–‘ï¼Œï¼Œspackï¼ˆswcpackï¼‰ä¹ŸæŒºå¿«çš„ï¼Œä½†ä»¤äººæ„å¤–çš„æ˜¯ï¼Œ webpack å±…ç„¶æ¯” parcel å’Œ rollup æ›´å¿«ã€‚å°¤å…¶æ˜¯ rollup çš„æ€§èƒ½ï¼Œä»¤äººæ„å¤–åœ°å·®ã€‚æœ‰å¯èƒ½æ˜¯å› ä¸º lodash å’Œ react éƒ½æ˜¯ CJS æ¨¡å—ï¼Œrollup éœ€è¦å°†å…¶è½¬åŒ–æˆ ESM æ‰èƒ½ä½¿ç”¨ï¼Œè¿™æ‰é™ä½äº†rollupçš„é€Ÿåº¦ åŒ…ä½“ç§¯æµ‹è¯•æ•°æ®æ¥æº no-minify terser esbuild swc äº§ç‰©å°ºå¯¸ 4.7MB 1.8MB 1.9MB 1.9MB è¿è¡Œæ—¶é—´ ThinkPad T480 4.677s 17.046s 5.615s 8.997s è¿è¡Œæ—¶é—´ MacBook 16, 2019 3.556s 13.834s 4.052s 6.892s webpack v5 å¼€ç®±å³å¸¦æœ‰æœ€æ–°ç‰ˆæœ¬çš„ terser-webpack-pluginï¼Œè¿™æ¬¡å¯¹æ¯”çš„æ˜¯ terserã€esbuildå’Œswcçš„å‹ç¼©èƒ½åŠ›ï¼Œterseræ˜¯ç”¨node.jsã€esbuildä½¿ç”¨goã€swcä½¿ç”¨rustï¼Œ å¯¹äºè¿™ç±»é«˜è®¡ç®—é‡ä»»åŠ¡ï¼Œnode.jsçš„æ€§èƒ½æ¯”åŸç”Ÿç¨‹åºå·®å¾—å¤šã€‚ä½†æ˜¯ä»å‹ç¼©ç»“æœæ¥æ²¡ä»€ä¹ˆå·®è· ç¼–è¯‘ç‰¹æ€§å¯¹æ¯” babel esbuild swc ES Next âœ… âœ… âœ… ES5, IE11 âœ… âŒ âœ… JS ä¿®é¥°å™¨è¯­æ³• âœ… âŒ âŒ Flow è¯­è¨€ âœ… âŒ âŒ TypeScript è¯­è¨€ âœ… âœ… âœ… TS ä¿®é¥°å™¨è¯­æ³• âœ… âœ… âœ… JSX âœ… âœ… âœ… è¿è¡Œæ—¶é—´åœ¨ThinkPad T480ç¼–è¯‘é€Ÿåº¦ 10.133s 0.464s 0.549s ä»ç‰¹æ€§ä¸Šæ¥çœ‹ï¼Œbabel ä¾æ—§æ˜¯æœ€å…¨é¢çš„ï¼Œè€Œesbuild å’Œ swc åˆ™æ³¨é‡å¯¹æœ€æ–° ES æ ‡å‡†çš„æ”¯æŒï¼Œå¹¶ä¸”esbuildå¯¹æ—§ç‰ˆæœ¬å…¼å®¹æ€§ä¸€èˆ¬ï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆviteç”Ÿäº§ç¯å¢ƒç”¨rollupçš„åŸå› å§ å°æ€»ç»“ï¼š webpack ä»ç„¶æ˜¯æœ€å…¨é¢çš„ Bundler é€‰æ‹©ï¼Œæ”¯æŒç‰¹æ€§æœ€ä¸°å¯Œï¼Œç”Ÿæ€æœ€ä¸ºåºå¤§ã€‚è€Œä¸”å®ƒçš„æ€§èƒ½å¹¶ä¸å·®ï¼ŒæŸäº›æ‰“åŒ…åœºæ™¯è¦ä¼˜äº rollup å’Œ parcelï¼›è€Œesbuildã€SWCç­‰æ½œåŠ›ä¹Ÿå¾ˆå¤§ï¼Œviteæœ‰æ„åœ¨esbuildç”Ÿæ€å®Œå–„åå…¨é¢ä½¿ç”¨ï¼Œè€Œä¸æ˜¯å‚åˆç€rollupï¼ŒåŒæ—¶ä¹Ÿç”¨SWCå–ä»£babelçš„ä½ç½® CRAå’ŒViteåœ¨ä¸šç•Œï¼Œä½¿ç”¨CRAå·²ç»æˆä¸ºäº†åˆ›å»ºReactåº”ç”¨çº¦å®šä¿—æˆçš„æƒ¯ä¾‹ã€‚å®ƒç¡®å®æ˜¯ä¸ªå¥½åŠæ³•ï¼Œå¤šå¹´æ¥ä¹Ÿä¸€ç›´åœ¨è¿­ä»£å‡çº§ã€‚ npx create-react-app my-app cd my-app npm start ç„¶è€Œï¼ŒCRAä¹Ÿæœ‰è‡ªèº«çš„ç—›ç‚¹ï¼ˆä¹Ÿæ˜¯ViteåŠ›ä¸»æå‡çš„æ–¹å‘ï¼‰ï¼šå½“é¡¹ç›®ä½“ç§¯å˜å¤§ï¼Œå¼€å‘æ—¶é—´å’Œæ„å»ºæ—¶é—´ä¹Ÿä¼šå¤§å¹…å¢åŠ ã€‚åŸå› æ˜¯ï¼Œæ— è®ºè¿›è¡Œä»»ä½•æ›´æ”¹ï¼ŒCRAéƒ½ä¼šå…¨é‡çš„é‡æ–°æ„å»ºåº”ç”¨ã€‚ è€Œviteä¸åŒ ä¸åŒäºCRAçš„å…¨é‡æ„å»ºï¼ŒViteæ˜¯æŒ‰éœ€æ„å»ºçš„ã€‚Viteå°†ä¸€ä¸ªåº”ç”¨åˆ†ä¸ºä¸¤ä¸ªéƒ¨åˆ†ï¼šä¾èµ–å’Œæºç ã€‚ ä¾èµ–ä¾èµ–åœ¨å¼€å‘è¿‡ç¨‹ä¸­ï¼ŒåŸºæœ¬ä¸ä¼šå˜åŠ¨ã€‚Viteä½¿ç”¨esbuildï¼ˆåŸºäºGoè¯­è¨€ï¼Œæ¯”ä¼ ç»ŸJSè¦å¿«10-100å€ï¼‰é¢„æ‰“åŒ…äº†ä¾èµ–ï¼Œè€Œä¸”ç”±äºä¾èµ–å˜åŠ¨æå°‘ï¼Œæ‰€ä»¥ä¼šè¢«ç¼“å­˜èµ·æ¥ä»¥èŠ‚çœå¤§é‡æ—¶é—´ã€‚ æºç æºç é‡‡ç”¨äº†ESMï¼ˆECMAScript modulesï¼‰ä½œä¸ºæ¨¡å—ä½“ç³»ã€‚å¥½å¤„æ˜¯æ— éœ€æ‰“åŒ…ï¼ŒæŒ‰éœ€åŠ è½½ï¼Œä»å›¾ä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°é‚£ç§æŒ‰éœ€çš„æ„Ÿè§‰ Viteçš„é¢„æ„å»ºViteé¢„æ„å»ºä¸»è¦æ˜¯ä¸ºäº† CommonJS å’Œ UMD å…¼å®¹æ€§ï¼šæœ¬åœ°å¼€å‘ä¾èµ–äºesbuildï¼Œæ‰€ä»¥éœ€è¦ä»£ç è½¬æ¢æˆesmæ‰èƒ½æ­£å¸¸ç¼–è¯‘ + æ„å»ºï¼Œä½†æ˜¯ç›®å‰ä¸€äº›æ¨¡å—å¹¶ä¸æ˜¯esmï¼Œæ¯”å¦‚reactã€lodashï¼Œæ‰€ä»¥æ­¤æ—¶é¢„æ„å»ºèµ·åˆ°ä¸€ä¸ªè½¬æ¢çš„ä½œç”¨ æ€§èƒ½ï¼šï¼šç”±äºviteçš„no-bundleæ€§è´¨ï¼Œæ¯ä¸€ä¸ªimportéƒ½å¯¹åº”ä¸€ä¸ªè¯·æ±‚ï¼Œå¯¹äºåƒlodashè¿™ç§ä¾èµ–å±‚çº§æ·±ã€æ¶‰åŠæ¨¡å—æ•°é‡å¤šçš„ä¾èµ–åŒ…ï¼Œç›´æ¥å›å¼•å‘ç€‘å¸ƒæµè¯·æ±‚ï¼Œè€Œé¢„æ„å»ºä¼šå¸®å¿™ç›´æ¥æŠŠè¿™ç§ä¾èµ–å±‚çº§æ·±çš„åŒ…æ‰“åŒ…æˆä¸€ä¸ªæ–‡ä»¶ï¼Œç›´æ¥å¼•å…¥ï¼Œè¿™æ ·ä¼šå‡å°‘è¯·æ±‚æ¬¡æ•° viteé»˜è®¤è‡ªåŠ¨å¼€å¯ï¼Œåœ¨é¡¹ç›®å¯åŠ¨æˆåŠŸåï¼Œä½ å¯ä»¥åœ¨æ ¹ç›®å½•ä¸‹çš„node_modulesä¸­å‘ç°.viteç›®å½•ï¼Œè¿™å°±æ˜¯é¢„æ„å»ºäº§ç‰©æ–‡ä»¶å­˜æ”¾çš„ç›®å½• å½“ç„¶ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥è‡ªå®šä¹‰é¢„æ„å»ºé…ç½®ï¼Œé€šè¿‡åœ¨vite.config.jsé‡Œé¢è¿›è¡Œæ›´æ”¹optimizeDepsé€‰é¡¹ï¼Œå¯ä»¥è‡ªå®šä¹‰æ·»åŠ é¢„æ„å»ºå…¥å£entriesã€ä»¥æ¥æ·»åŠ includeã€æ‰‹åŠ¨å–æ¶ˆexcludeï¼Œè¯¦æƒ…å¯æŸ¥çœ‹ï¼šè¿™é‡Œ Viteå®‰è£…å’Œä½¿ç”¨startNodeç‰ˆæœ¬ &gt;= 12ç‰ˆæœ¬ å®‰è£…ä¸€ä¸ªå®Œæ•´çš„é¡¹ç›®(ç›´æ¥ä¸Šè„šæ‰‹æ¶) npm init @vitejs/app ç›¸å½“äº npm i @vuejs/create-app create-app æˆ–è€…å…¥é—¨çš„è¯è€å¸ˆæ¨èå…ˆå®‰è£…viteå·¥å…· npm install vite -g or npm i vite -D å¼€å¯viteæœåŠ¡å™¨ä½¿ç”¨ï¼š npx vite viteæ‰“åŒ… npx vite build é…ç½®æˆ‘ä»¬å¯ä»¥ç›´æ¥ç”¨vite.config.tsä½œä¸ºé…ç½®æ–‡ä»¶ ä¸ºé¿å…ç±»å‹æŠ¥é”™ï¼Œä½ éœ€è¦é€šè¿‡ pnpm i @types/node -D å®‰è£…ç±»å‹ tsconfig.node.json ä¸­è®¾ç½® allowSyntheticDefaultImports: trueï¼Œä»¥å…è®¸ä¸‹é¢çš„ default å¯¼å…¥æ–¹å¼ // vite.config.ts import { defineConfig } from 'vite' import path from 'path' import react from '@vitejs/plugin-react' export default defineConfig({ // æ‰‹åŠ¨æŒ‡å®šé¡¹ç›®æ ¹ç›®å½•ä½ç½®(htmlçš„æ ¹ç›®å½•) root: path.join(__dirname, 'src'), //é…ç½®äº†å®˜æ–¹çš„ react æ’ä»¶ plugins: [react()] }) é…ç½®åˆ«å // vite.config.ts import path from 'path'; { resolve: { // åˆ«åé…ç½® alias: { '@assets': path.join(__dirname, 'src/assets') } } } Viteçš„æ‹†åŒ…ç­–ç•¥ä¸ºä»€ä¹ˆè¦æ‹†åŒ…ï¼Ÿ ä¼ ç»Ÿæ‰“åŒ…æ¨¡å¼ä¸‹ï¼Œä¼šç›´æ¥æŠŠæ•´ä¸ªé¡¹ç›®ä¸€æ¬¡æ€§æ‰“åŒ…ï¼Œå®ƒä¼š æ— æ³•æŒ‰éœ€åŠ è½½ï¼Œæœ€ç»å…¸çš„å°±æ˜¯è·¯ç”±ç»„ä»¶ çº¿ä¸Šç¼“å­˜å¤ç”¨ç‡ä½ï¼Œæ”¹åŠ¨ä¸€è¡Œä»£ç æ›¿æ¢æ•´ä¸ª bundle äº§ç‰©ï¼Œå¯¼è‡´urlæ”¹å˜ï¼Œæ¥è€Œç¼“å­˜å¤±æ•ˆã€‚ æ‰€ä»¥æˆ‘ä»¬è¿›è¡Œæ‹†åŒ…ä¹‹åï¼ŒåŠ å…¥å…¥å£æ–‡ä»¶æœ‰ 5ä¸ªæ–‡ä»¶ï¼Œå…¶ä¸­ä¸€ä¸ªæ–‡ä»¶å˜åŠ¨äº†ï¼Œåˆ™å˜åŠ¨çš„chunkåªæœ‰é‚£ä¸€ä»½ï¼Œæ­¤æ—¶è¾¾åˆ°æ‹†åŒ…çš„æ•ˆæœ viteé»˜è®¤æ‹†åŒ…ç­–ç•¥ï¼š â”œâ”€â”€ assets â”‚ â”œâ”€â”€ Dynamic.xxx.js // Async Chunk, æ”¾åŠ¨æ€å¯¼å…¥çš„ä»£ç  â”‚ â”œâ”€â”€ Dynamic.xxx.css // Async CSS Chunk â”‚ â”œâ”€â”€ favicon.xxx.svg // é™æ€èµ„æº â”‚ â”œâ”€â”€ index.xxx.css // Initial CSS Chunk â”‚ â”œâ”€â”€ index.xxx.js // Initial Chunkï¼Œæ”¾æœ¬åœ°ä»£ç  â”‚ â””â”€â”€ vendor.xxx.js // æ”¾ç¬¬ä¸‰æ–¹åŒ…äº§ç‰© â””â”€â”€ index.htmlå½“ç„¶æˆ‘ä»¬å¯ä»¥é€šè¿‡manualChunksè‡ªå®šä¹‰æ‹†åŒ…ç­–ç•¥ï¼Œä½†æ˜¯å¯èƒ½ä¼šæœ‰å¾ªç¯å¼•ç”¨çš„é—®é¢˜ï¼Œæ‰€ä»¥è¿˜æ˜¯æ¨èç”¨ä¸€ä¸ª vite-plugin-chunk-split æ’ä»¶å»åšè‡ªå®šä¹‰æ‹†åŒ… å…¶ä»–æ²¡æœ‰åƒwebpackä¸€æ ·çš„loaderï¼Œæ¯”å¦‚è¦ä½¿ç”¨lessæ–‡ä»¶ï¼Œç›´æ¥ npm install less -D é‡æ–°è·‘viteå³å¯ viteé»˜è®¤æ”¯æŒTS viteæœåŠ¡å™¨å†…éƒ¨Connectä¼šå¯¹æˆ‘ä»¬çš„è¯·æ±‚åšè½¬å‘ï¼Œå®Œæˆless -&gt; jsã€ts -&gt; jsï¼Œç„¶åæµè§ˆå™¨å¾—åˆ°ç¼–è¯‘åçš„jsä»£ç  Vite1æ­å»ºçš„æœåŠ¡å™¨ä¸ºkoaï¼Œè€ŒVite2æ­å»ºçš„æœåŠ¡å™¨ä¸ºconnect Viteå¯¹Vueçš„æ”¯æŒVue3å•æ–‡ä»¶ç»„ä»¶æ”¯æŒï¼š @vitejs/plugin-vue Vue3 JSXæ”¯æŒï¼š @vite/plugin-vue-jsx Vue 2æ”¯æŒï¼šunderfin/vite-plugin-vue2 æ¯”å¦‚åŠ å…¥vue3çš„æ”¯æŒ(@vue/complier-sfcè´Ÿè´£ç¼–è¯‘vueæ–‡ä»¶) npm i @vitejs/plugin-vue -D npm i @vue/complier-sfc -D viteçš„é…ç½® åœ¨ç›®å½•ä¸‹æ–°å»ºvite.config.jsæ–‡ä»¶ï¼Œå¹¶å°†é…ç½®æ–‡ä»¶å¯¼å‡º const vue = require('@vitejs/plugin-vue'); module.exports = { plugins: [ vue() ] } ç”¨esbuildèµ·ä¸€ä¸ªæœåŠ¡ï¼ˆç±»ä¼¼ webpack-dev-serverï¼‰ é¦–å…ˆåœ¨æ ¹ç›®å½•ä¸‹åˆ›å»ºbuild.js // build.js const { build, buildSync, serve } = require(\"esbuild\"); function runBuild() { serve( { port: 8000, // é™æ€èµ„æºç›®å½• servedir: './dist' }, { absWorkingDir: process.cwd(), entryPoints: [\"./src/index.jsx\"], bundle: true, format: \"esm\", splitting: true, sourcemap: true, ignoreAnnotations: true, metafile: true, } ).then((server) => { console.log(\"HTTP Server starts at port\", server.port); }); } runBuild(); ç›´æ¥è°ƒviteçš„æœåŠ¡è¿›è¡Œå¯åŠ¨ createServer Apiï¼Œè¿™å°±æ„å‘³ç€æ— è®ºåœ¨ä»€ä¹ˆç±»å‹çš„é¡¹ç›®ä¸­ï¼Œåªè¦æä¾›ç»™è¿™ä¸ª API å‡†ç¡®çš„å…¥å‚ï¼Œå°±èƒ½å¯åŠ¨ vite æœåŠ¡ã€‚ viteæ’ä»¶ é’©å­é€šç”¨é’©å­ åœ¨å¼€å‘ä¸­ï¼ŒVite å¼€å‘æœåŠ¡å™¨ä¼šåˆ›å»ºä¸€ä¸ªæ’ä»¶å®¹å™¨æ¥è°ƒç”¨ Rollup æ„å»ºé’©å­ï¼Œä¸ Rollup å¦‚å‡ºä¸€è¾™ã€‚ ä»¥ä¸‹é’©å­åœ¨æœåŠ¡å™¨å¯åŠ¨æ—¶è¢«è°ƒç”¨ï¼š options buildStart ä»¥ä¸‹é’©å­ä¼šåœ¨æ¯ä¸ªä¼ å…¥æ¨¡å—è¯·æ±‚æ—¶è¢«è°ƒç”¨ï¼š resolveId load transform å®ƒä»¬è¿˜æœ‰ä¸€ä¸ªæ‰©å±•çš„ options å‚æ•°ï¼ŒåŒ…å«å…¶ä»–ç‰¹å®šäº Vite çš„å±æ€§ã€‚ä½ å¯ä»¥åœ¨ SSR æ–‡æ¡£ ä¸­æŸ¥é˜…æ›´å¤šå†…å®¹ã€‚ ä»¥ä¸‹é’©å­åœ¨æœåŠ¡å™¨å…³é—­æ—¶è¢«è°ƒç”¨ï¼š buildEnd closeBundle è¯·æ³¨æ„ moduleParsed é’©å­åœ¨å¼€å‘ä¸­æ˜¯ ä¸ä¼š è¢«è°ƒç”¨çš„ï¼Œå› ä¸º Vite ä¸ºäº†æ€§èƒ½ä¼šé¿å…å®Œæ•´çš„ AST è§£æã€‚ Output Generation Hooksï¼ˆé™¤äº† closeBundle) åœ¨å¼€å‘ä¸­æ˜¯ ä¸ä¼š è¢«è°ƒç”¨çš„ã€‚ä½ å¯ä»¥è®¤ä¸º Vite çš„å¼€å‘æœåŠ¡å™¨åªè°ƒç”¨äº† rollup.rollup() è€Œæ²¡æœ‰è°ƒç”¨ bundle.generate()ã€‚ ç‰¹æœ‰é’©å­ config åœ¨è¯»å–å®Œvite.config.tsåæ‰§è¡Œè¯¥é’©å­ configResolved ä½¿ç”¨è¿™ä¸ªé’©å­è¯»å–å’Œå­˜å‚¨æœ€ç»ˆè§£æçš„é…ç½®ã€‚å½“æ’ä»¶éœ€è¦æ ¹æ®è¿è¡Œçš„å‘½ä»¤åšä¸€äº›ä¸åŒçš„äº‹æƒ…æ—¶ï¼Œå®ƒä¹Ÿå¾ˆæœ‰ç”¨ï¼Œä½†æ˜¯ä¸å»ºè®®å†ä¿®æ”¹é…ç½® configureServer æ˜¯ç”¨äºé…ç½®å¼€å‘æœåŠ¡å™¨çš„é’©å­ã€‚æœ€å¸¸è§çš„ç”¨ä¾‹æ˜¯åœ¨å†…éƒ¨ connect åº”ç”¨ç¨‹åºä¸­æ·»åŠ è‡ªå®šä¹‰ä¸­é—´ä»¶: configurePreviewServer ä¸ configureServer ç›¸åŒä½†æ˜¯ä½œä¸ºé¢„è§ˆæœåŠ¡å™¨ã€‚å®ƒæä¾›äº†ä¸€ä¸ª connect æœåŠ¡å™¨å®ä¾‹åŠå…¶åº•å±‚çš„ http serverã€‚ä¸ configureServer ç±»ä¼¼ï¼ŒconfigurePreviewServer è¿™ä¸ªé’©å­ä¹Ÿæ˜¯åœ¨å…¶ä»–ä¸­é—´ä»¶å®‰è£…å‰è¢«è°ƒç”¨çš„ã€‚å¦‚æœä½ æƒ³è¦åœ¨å…¶ä»–ä¸­é—´ä»¶ ä¹‹å å®‰è£…ä¸€ä¸ªæ’ä»¶ï¼Œä½ å¯ä»¥ä» configurePreviewServer è¿”å›ä¸€ä¸ªå‡½æ•°ï¼Œå®ƒå°†ä¼šåœ¨å†…éƒ¨ä¸­é—´ä»¶è¢«å®‰è£…ä¹‹åå†è°ƒç”¨ const myPlugin = () => ({ name: 'configure-preview-server', configurePreviewServer(server) { // è¿”å›ä¸€ä¸ªé’©å­ï¼Œä¼šåœ¨å…¶ä»–ä¸­é—´ä»¶å®‰è£…å®Œæˆåè°ƒç”¨ return () => { server.middlewares.use((req, res, next) => { // è‡ªå®šä¹‰å¤„ç†è¯·æ±‚ ... }) } }, }) transformIndexHtml è¿™ä¸ªé’©å­ç”¨æ¥çµæ´»æ§åˆ¶ HTML çš„å†…å®¹ï¼Œä½ å¯ä»¥æ‹¿åˆ°åŸå§‹çš„ html å†…å®¹åè¿›è¡Œä»»æ„çš„è½¬æ¢ handleHotUpdate è¿™ä¸ªé’©å­ä¼šåœ¨ Vite æœåŠ¡ç«¯å¤„ç†çƒ­æ›´æ–°æ—¶è¢«è°ƒç”¨ï¼Œä½ å¯ä»¥åœ¨è¿™ä¸ªé’©å­ä¸­æ‹¿åˆ°çƒ­æ›´æ–°ç›¸å…³çš„ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼Œè¿›è¡Œçƒ­æ›´æ¨¡å—çš„è¿‡æ»¤ï¼Œæˆ–è€…è¿›è¡Œè‡ªå®šä¹‰çš„çƒ­æ›´å¤„ç† æ™®é€šç”¨æˆ·æ’ä»¶é’©å­æ‰§è¡Œé¡ºåº export default function testHookPlugin () { return { name: 'test-hooks-plugin', // ç‹¬æœ‰ config(config) { console.log('config'); }, // ç‹¬æœ‰ configResolved(resolvedCofnig) { console.log('configResolved'); }, // é€šç”¨é’©å­ options(opts) { console.log('options'); return opts; }, // ç‹¬æœ‰ configureServer(server) { console.log('configureServer'); setTimeout(() => { // æ‰‹åŠ¨é€€å‡ºè¿›ç¨‹ process.kill(process.pid, 'SIGTERM'); }, 3000) }, // é€šç”¨é’©å­ buildStart() { console.log('buildStart'); }, // é€šç”¨é’©å­ buildEnd() { console.log('buildEnd'); }, // é€šç”¨é’©å­ closeBundle() { console.log('closeBundle'); } } } ä¸‹å›¾æºè‡ªç¥ä¸‰å…ƒçš„ã€Šæ·±å…¥æµ…å‡ºViteã€‹ æ’ä»¶é¡ºåº å¦‚æœæ˜¯ç›´æ¥çœ‹å…¨éƒ¨æ’ä»¶ç§ç±»çš„é¡ºåºåˆ™ä¸º å‚è€ƒæ–‡ç« ï¼š ã€è¯‘æ–‡ã€‘Viteæ˜¯ä»€ä¹ˆï¼Ÿä¸ºä½•æ¨èä½¿ç”¨Viteä»£æ›¿Create React Appï¼Ÿ ESbuild ä»‹ç» æ·±å…¥æµ…å‡º Vite Comparing the New Generation of Build Tools å‰ç«¯æ„å»ºå·¥å…·æµ‹è¯„","categories":[{"name":"å‰ç«¯","slug":"å‰ç«¯","permalink":"https://taylor12138.github.io/categories/%E5%89%8D%E7%AB%AF/"}],"tags":[],"author":"Hello"},{"title":"Reactçš„ä¸€äº›å·¥å…·","slug":"Reactçš„ä¸€äº›å·¥å…·","date":"2023-01-04T16:00:00.000Z","updated":"2023-01-06T07:39:11.271Z","comments":true,"path":"2023/01/05/react-de-yi-xie-gong-ju/","link":"","permalink":"https://taylor12138.github.io/2023/01/05/react-de-yi-xie-gong-ju/","excerpt":"","text":"æ™®é€šåŠ¨ç”»ç”¨ transition åªèƒ½åšä¸€äº›ç®€å•çš„åŠ¨ç”»ï¼Œç¨å¾®å¤æ‚çš„åŠ¨ç”»å¯ä»¥ä½¿ç”¨keyframesï¼š .show{ animation:show-item 2s ease-in forwards; } .hide{ animation:hide-item 2s ease-in forwards; } @keyframes hide-item{ 0% { opacity:1; color:yellow; } 50%{ opacity: 0.5 ; color:red; } 100%{ opacity:0; color: green; } } @keyframes show-item{ 0% { opacity:0; color:yellow; } 50%{ opacity: 0.5 ; color:red; } 100%{ opacity:1; color: green; } } å½“ç„¶ï¼ŒReactä¹Ÿæœ‰å®ƒå¥½çš„å¥—ä»¶ï¼šå°±å«åš react-transition-group npm install react-transition-group --save å®˜æ–¹æ–‡æ¡£ å®ƒæœ‰ä¸‰ä¸ªæ ¸å¿ƒå¥—ä»¶ï¼š Transition CSSTransition TransitionGroup CSSTransitionimport { CSSTransition } from 'react-transition-group' render() { return ( &lt;> &lt;CSSTransition in={this.state.isShow} // ç”¨æˆ·åˆ¤æ–­æ˜¯å¦å‡ºç°çš„çŠ¶æ€ timeout={2000} // åŠ¨ç”»æŒç»­æ—¶é—´ classNames=\"boss-text\" // é˜²æ­¢é‡å¤ï¼Œå¯ä»¥ç†è§£æˆ namespace > &lt;div>BOSS - king&lt;/div> &lt;/CSSTransition> &lt;div> &lt;button onClick={this.toToggle}>å¬å–šã€Œé¢¨é­šã€ &lt;/button> &lt;/div> &lt;/> ); } å†çœ‹çœ‹å®˜æ–¹æ–‡ä»¶èªªæ˜å¯ä»¥çŸ¥é“ï¼Œæˆ‘ä»¬æ¥ä¸‹æ¥å°±å¯ä»¥ç¼–å†™csså±æ€§äº† åœ¨ç»„ä»¶å‡ºç°ã€è¿›å…¥ã€é€€å‡ºæˆ–å®Œæˆè¿‡æ¸¡æ—¶åº”ç”¨äºç»„ä»¶çš„åŠ¨ç”»ç±»åã€‚å¯ä»¥æä¾›å•ä¸ªåç§°ï¼Œæ¯ä¸ªé˜¶æ®µéƒ½å°†æ·»åŠ åç¼€ï¼Œä¾‹å¦‚classNames=&quot;fade&quot;applysï¼š fade-appear, fade-appear-active,fade-appear-done fade-enter, fade-enter-active,fade-enter-done fade-exit, fade-exit-active,fade-exit-done ä¸¾ä¸ªä¾‹å­ï¼š namespace-enter: è¿›å…¥å‰çš„æ ·å¼ / åˆå§‹å€¼ namespace-enter-activeï¼šåŠ¨ç”»å¼€å§‹ç›´åˆ°å®Œæˆçš„css namespace-enter-doneï¼šå®Œæˆæ—¶css namespace-exitï¼šé€€å‡ºä¹‹å‰CSS namespace-exit-activeï¼šé€€å‡ºåŠ¨ç”»ç›´åˆ°å®Œæˆæ™‚ä¹‹å‰çš„çš„ CSS ã€‚ namespace-exit-doneï¼šé€€å‡ºå®Œæˆæ™‚çš„ CSS ã€‚ ç°åœ¨æˆ‘ä»¬ä¸ç”¨è‡ªå·±ç¼–å†™ / ç®¡ç†classnameå•¦ğŸ¥µï½ .boss-text-enter{ opacity: 0; } .boss-text-enter-active{ opacity: 1; transition: opacity 2000ms; } .boss-text-enter-done{ opacity: 1; } .boss-text-exit{ opacity: 1; } .boss-text-exit-active{ opacity: 0; transition: opacity 2000ms; } .boss-text-exit-done{ opacity: 0; } å‡ ä¸ªå›è°ƒonEnterç»„ä»¶çš„å›è°ƒå‡½æ•°ï¼Œå½“ç»„ä»¶enteræˆ–appearæ—¶ä¼šç«‹å³è°ƒç”¨ã€‚ type: Function(node: HtmlElement, isAppearing: bool) onEnteringä¹Ÿæ˜¯ä¸€ä¸ªè¿‡æ¸¡ç»„ä»¶çš„å›è°ƒå‡½æ•°ï¼Œå½“ç»„ä»¶enter-activeæˆ–appear-activeæ—¶ï¼Œç«‹å³è°ƒç”¨æ­¤å‡½æ•° type: Function(node: HtmlElement, isAppearing: bool) onEnteredåŒæ ·æ˜¯å›è°ƒå‡½æ•°ï¼Œå½“ç»„ä»¶çš„enter,appearclassNameè¢«ç§»é™¤æ—¶ï¼Œæ„å³è°ƒç”¨æ­¤å‡½æ•° type: Function(node: HtmlElement, isAppearing: bool) onExitå½“ç»„ä»¶åº”ç”¨exitç±»åæ—¶ï¼Œè°ƒç”¨æ­¤å‡½æ•° type: Function(node: HtmlElement) onExitingå½“ç»„ä»¶åº”ç”¨exit-activeç±»åæ—¶ï¼Œè°ƒç”¨æ­¤å‡½æ•° type: Function(node: HtmlElement) onExitedå½“ç»„ä»¶exitç±»åè¢«ç§»é™¤ï¼Œä¸”æ·»åŠ äº†exit-doneç±»åæ—¶ï¼Œè°ƒç”¨æ­¤å‡½æ•° type: Function(node: HtmlElement) å…¶ä»–mountOnEnterï¼š&lt;bool = false&gt;ï¼Œé»˜è®¤æƒ…å†µå­ç»„ä»¶ä¸transtionç»„ä»¶ä¸€èµ·åŠ è½½(ä¹Ÿå°±æ˜¯è¯´å³ä½¿inå±æ€§ä¸ºfalseï¼Œç»„ä»¶ä¹Ÿä¼šå…ˆä»¥éšè—çŠ¶æ€(exited)æ­£å¸¸åŠ è½½)ï¼Œå½“mountOnEnter ä¸ºtrueæ—¶ï¼Œä¼šåœ¨ç¬¬ä¸€æ¬¡inå±æ€§ä¸ºtrueæ—¶åŠ è½½å­ç»„ä»¶ unmountOnExitï¼š&lt;bool = false&gt;ï¼Œåœ¨å…ƒç´ é€€åœºæ—¶ï¼Œè‡ªåŠ¨æŠŠDOMä¹Ÿåˆ é™¤ï¼Œè¿™æ˜¯ä»¥å‰ç”¨CSSåŠ¨ç”»æ²¡åŠæ³•åšåˆ°çš„ã€‚åœ¨è¿‡æ¸¡ç»“æŸåå¸è½½ç»„ä»¶, æµ‹è¯•å‘ç°è¿™é‡Œç¡®å®å¸è½½äº†å­ç»„ä»¶ç”Ÿæˆçš„domèŠ‚ç‚¹ï¼Œä½†æ˜¯å¹¶ä¸ä¼šè§¦å‘componentWillUnmounté’©å­ï¼Œåœ¨å­ç»„ä»¶é‡æ–°è¿›å…¥enteredçŠ¶æ€æ—¶ä¹Ÿä¸ä¼šé‡æ–°è§¦å‘componentDidMountç­‰åˆ›å»ºé˜¶æ®µé’©å­ react-canvas-drawä¸€ä¸ªcanvasç»˜ç”»ç»„ä»¶ import CanvasDraw from 'react-canvas-draw'; &lt;CanvasDraw brushRadius={5} brushColor=\"#fad54b\" ref={saveableCanvas} onChange={onChange} backgroundColor=\"transparent\" className=\"draw-canvas-wrap\" hideInterface hideGrid /> static defaultProps = { onChange: null loadTimeOffset: 5, lazyRadius: 30, //æ‹–æ‹½ç‚¹è·ç¦»é¼ æ ‡çš„è·ç¦» brushRadius: 12, //çº¿æ¡ç²—åº¦ brushColor: \"#444\", //çº¿æ¡é¢œè‰² catenaryColor: \"#0a0302\", gridColor: \"rgba(150,150,150,0.17)\", hideGrid: false, canvasWidth: 400, canvasHeight: 400, disabled: false, imgSrc: \"\", saveData: null, immediateLoading: false, hideInterface: false, gridSizeX: 25, gridSizeY: 25, gridLineWidth: 0.5, hideGridX: false, hideGridY: false enablePanAndZoom: false, mouseZoomFactor: 0.01, zoomExtents: { min: 0.33, max: 3 }, };","categories":[{"name":"å‰ç«¯","slug":"å‰ç«¯","permalink":"https://taylor12138.github.io/categories/%E5%89%8D%E7%AB%AF/"}],"tags":[],"author":"Hello"},{"title":"qiankunå®æˆ˜","slug":"qiankunå®æˆ˜","date":"2022-09-21T16:00:00.000Z","updated":"2022-12-07T11:13:20.133Z","comments":true,"path":"2022/09/22/qiankun-shi-zhan/","link":"","permalink":"https://taylor12138.github.io/2022/09/22/qiankun-shi-zhan/","excerpt":"","text":"1.qiankunå¿«é€Ÿä¸Šæ‰‹å¿«é€Ÿä¸Šæ‰‹ï¼šhttps://qiankun.umijs.org/zh/guide/getting-started ä¸»åº”ç”¨in ä¸»åº”ç”¨ï¼Œè¦å®Œæˆå¯¹å¾®åº”ç”¨çš„æ³¨å†Œï¼š yarn add qiankun # æˆ–è€… npm i qiankun -S import { registerMicroApps, start } from 'qiankun'; registerMicroApps([ { name: 'react app', // app name registered entry: '//localhost:7100', container: '#yourContainer', activeRule: '/yourActiveRule', }, { name: 'vue app', entry: { scripts: ['//localhost:7100/main.js'] }, container: '#yourContainer2', activeRule: '/yourActiveRule2', }, ]); start(); å½“å¾®åº”ç”¨ä¿¡æ¯æ³¨å†Œå®Œä¹‹åï¼Œä¸€æ—¦æµè§ˆå™¨çš„ url å‘ç”Ÿå˜åŒ–ï¼Œä¾¿ä¼šè‡ªåŠ¨è§¦å‘ qiankun çš„åŒ¹é…é€»è¾‘ï¼Œæ‰€æœ‰ activeRule è§„åˆ™åŒ¹é…ä¸Šçš„å¾®åº”ç”¨å°±ä¼šè¢«æ’å…¥åˆ°æŒ‡å®šçš„ container ä¸­ï¼ŒåŒæ—¶ä¾æ¬¡è°ƒç”¨å¾®åº”ç”¨æš´éœ²å‡ºçš„ç”Ÿå‘½å‘¨æœŸé’©å­ã€‚ registerMicroApps(apps, lifeCycles?)ï¼šhttps://qiankun.umijs.org/zh/api#registermicroappsapps-lifecycles å¦‚æœä¸æƒ³è¦ç”¨urlæ§åˆ¶å­åº”ç”¨çš„åŠ è½½ï¼Œå¯ä»¥é€‰æ‹©æ‰‹åŠ¨åŠ è½½å®Œæ¯• import { loadMicroApp } from 'qiankun'; loadMicroApp({ name: 'app', entry: '//localhost:7100', container: '#yourContainer', }); å­åº”ç”¨in å­åº”ç”¨ï¼Œä¸éœ€è¦npmè£…å•¥ä¸œè¥¿ï¼Œä½†æ˜¯éœ€è¦åšä¸¤ä¸ªé…ç½® é…ç½®ä¸€å¾®åº”ç”¨éœ€è¦åœ¨è‡ªå·±çš„å…¥å£ js (é€šå¸¸å°±æ˜¯ä½ é…ç½®çš„ webpack çš„ entry js) å¯¼å‡º bootstrapã€mountã€unmount ä¸‰ä¸ªç”Ÿå‘½å‘¨æœŸé’©å­ï¼Œä»¥ä¾›ä¸»åº”ç”¨åœ¨é€‚å½“çš„æ—¶æœºè°ƒç”¨ã€‚ bootstrapï¼šç±»ä¼¼äºspecial mountï¼Œä»…åœ¨ç¬¬ä¸€æ¬¡ mountï¼š æ¯æ¬¡æŒ‚è½½å­åº”ç”¨å°±ä¼šè°ƒç”¨ unmountï¼š æ¯æ¬¡å¸è½½å­åº”ç”¨è°ƒç”¨ updateï¼šå¯é€‰ï¼Œä»…ä½¿ç”¨ loadMicroApp æ–¹å¼åŠ è½½å¾®åº”ç”¨æ—¶ç”Ÿæ•ˆ /** * bootstrap åªä¼šåœ¨å¾®åº”ç”¨åˆå§‹åŒ–çš„æ—¶å€™è°ƒç”¨ä¸€æ¬¡ï¼Œä¸‹æ¬¡å¾®åº”ç”¨é‡æ–°è¿›å…¥æ—¶ä¼šç›´æ¥è°ƒç”¨ mount é’©å­ï¼Œä¸ä¼šå†é‡å¤è§¦å‘ bootstrapã€‚ * é€šå¸¸æˆ‘ä»¬å¯ä»¥åœ¨è¿™é‡Œåšä¸€äº›å…¨å±€å˜é‡çš„åˆå§‹åŒ–ï¼Œæ¯”å¦‚ä¸ä¼šåœ¨ unmount é˜¶æ®µè¢«é”€æ¯çš„åº”ç”¨çº§åˆ«çš„ç¼“å­˜ç­‰ã€‚ */ export async function bootstrap() { console.log('react app bootstraped'); } /** * åº”ç”¨æ¯æ¬¡è¿›å…¥éƒ½ä¼šè°ƒç”¨ mount æ–¹æ³•ï¼Œé€šå¸¸æˆ‘ä»¬åœ¨è¿™é‡Œè§¦å‘åº”ç”¨çš„æ¸²æŸ“æ–¹æ³• */ export async function mount(props) { ReactDOM.render(&lt;App />, props.container ? props.container.querySelector('#root') : document.getElementById('root')); } /** * åº”ç”¨æ¯æ¬¡ åˆ‡å‡º/å¸è½½ ä¼šè°ƒç”¨çš„æ–¹æ³•ï¼Œé€šå¸¸åœ¨è¿™é‡Œæˆ‘ä»¬ä¼šå¸è½½å¾®åº”ç”¨çš„åº”ç”¨å®ä¾‹ */ export async function unmount(props) { ReactDOM.unmountComponentAtNode( props.container ? props.container.querySelector('#root') : document.getElementById('root'), ); } /** * å¯é€‰ç”Ÿå‘½å‘¨æœŸé’©å­ï¼Œä»…ä½¿ç”¨ loadMicroApp æ–¹å¼åŠ è½½å¾®åº”ç”¨æ—¶ç”Ÿæ•ˆ */ export async function update(props) { console.log('update props', props); } é…ç½®äºŒé…ç½®å¾®åº”ç”¨çš„æ‰“åŒ…å·¥å…· é™¤äº†ä»£ç ä¸­æš´éœ²å‡ºç›¸åº”çš„ç”Ÿå‘½å‘¨æœŸé’©å­ä¹‹å¤–ï¼Œä¸ºäº†è®©ä¸»åº”ç”¨èƒ½æ­£ç¡®è¯†åˆ«å¾®åº”ç”¨æš´éœ²å‡ºæ¥çš„ä¸€äº›ä¿¡æ¯ï¼Œå¾®åº”ç”¨çš„æ‰“åŒ…å·¥å…·éœ€è¦å¢åŠ å¦‚ä¸‹é…ç½®ï¼š webpack: const packageName = require('./package.json').name; module.exports = { output: { library: `${packageName}-[name]`, libraryTarget: 'umd', jsonpFunction: `webpackJsonp_${packageName}`, //webpack5ä¸ç”¨é…ç½® }, }; jsonpFunctionï¼š åœ¨ webpack 4 ä¸­ï¼Œå¤šä¸ª webpack è¿è¡Œæ—¶å¯èƒ½åœ¨åŒä¸€ä¸ª HTML é¡µé¢ä¸Šå‘ç”Ÿå†²çªï¼Œå› ä¸ºå®ƒä»¬ä½¿ç”¨ç›¸åŒçš„å…¨å±€å˜é‡æ¥åŠ è½½å—ã€‚è¦è§£å†³æ­¤é—®é¢˜ï¼Œéœ€è¦ä¸ºoutput.jsonpFunctioné…ç½®æä¾›è‡ªå®šä¹‰åç§°ã€‚ Webpack 5 ä¼šè‡ªåŠ¨æ¨æ–­æ„å»ºçš„å”¯ä¸€åç§°ï¼Œpackage.json nameå¹¶å°†å…¶ç”¨ä½œoutput.uniqueName. 2.qiankunåŸºæœ¬é¡¹ç›®ä¸Šæ‰‹å¯¹äºä¸»åº”ç”¨ï¼Œä¸€èˆ¬æ¥è¯´å’Œå¿«é€Ÿä¸Šæ‰‹ä¸»åº”ç”¨çš„é…ç½®ä¸€æ ·å³å¯ å¯¹äºå­åº”ç”¨ï¼Œå¾®åº”ç”¨åˆ†ä¸ºæœ‰ webpack æ„å»ºå’Œæ—  webpack æ„å»ºé¡¹ç›®ï¼Œæœ‰ webpack çš„å¾®åº”ç”¨ï¼ˆä¸»è¦æ˜¯æŒ‡ Vueã€Reactã€Angularï¼‰éœ€è¦åšçš„äº‹æƒ…æœ‰ï¼š æ–°å¢ public-path.js æ–‡ä»¶ï¼Œç”¨äºä¿®æ”¹è¿è¡Œæ—¶çš„ publicPathã€‚ æ³¨æ„ï¼šè¿è¡Œæ—¶çš„ publicPath å’Œæ„å»ºæ—¶çš„ publicPath æ˜¯ä¸åŒçš„ï¼Œä¸¤è€…ä¸èƒ½ç­‰ä»·æ›¿ä»£ã€‚ å¾®åº”ç”¨å»ºè®®ä½¿ç”¨ history æ¨¡å¼çš„è·¯ç”±ï¼Œéœ€è¦è®¾ç½®è·¯ç”± baseï¼Œå€¼å’Œå®ƒçš„ activeRule æ˜¯ä¸€æ ·çš„ã€‚ï¼ˆè·¯ç”±ä¸å¸¦ # å·ï¼‰ åœ¨å…¥å£æ–‡ä»¶æœ€é¡¶éƒ¨å¼•å…¥ public-path.jsï¼Œä¿®æ”¹å¹¶å¯¼å‡ºä¸‰ä¸ªç”Ÿå‘½å‘¨æœŸå‡½æ•°ã€‚ ä¿®æ”¹ webpack æ‰“åŒ…ï¼Œå…è®¸å¼€å‘ç¯å¢ƒè·¨åŸŸå’Œ umd æ‰“åŒ…ã€‚ å¯¹äº1ï¼Œæˆ‘ä»¬å…ˆæ¥äº†è§£ä¸€ä¸ªæ¦‚å¿µï¼šwebpackçš„å…¬å…±è·¯å¾„ publicPath é…ç½®é€‰é¡¹åœ¨å„ç§åœºæ™¯ä¸­éƒ½éå¸¸æœ‰ç”¨ã€‚ä½ å¯ä»¥é€šè¿‡å®ƒæ¥æŒ‡å®šåº”ç”¨ç¨‹åºä¸­æ‰€æœ‰èµ„æºçš„åŸºç¡€è·¯å¾„ã€‚ ä½ å¯ä»¥ç†è§£ä¸ºæˆ‘ä»¬å¸¸ç”¨çš„åœ¨è„šæ‰‹æ¶ä¸­configé…ç½®çš„å…¨å±€è·¯å¾„å‰ç¼€â€@â€ã€â€$â€ç­‰ ä½†æ˜¯åœ¨å¾®å‰ç«¯ä¸­ï¼Œè¿™ä¸ªå…¬å…±è·¯å¾„å¯èƒ½ä¼šéšç€ä¸»åº”ç”¨æ”¹å˜ï¼Œéœ€è¦ä¸€ä¸ªå­åº”ç”¨è¿è¡Œæ—¶çš„å…¬å…±è·¯å¾„é…ç½®ï¼ˆè¿è¡Œæ—¶æ”¹å˜ï¼‰ webpack æš´éœ²äº†ä¸€ä¸ªåä¸º __webpack_public_path__ çš„å…¨å±€å˜é‡ã€‚æ‰€ä»¥åœ¨åº”ç”¨ç¨‹åºçš„ entry point ä¸­ï¼Œå¯ä»¥ç›´æ¥å¦‚ä¸‹è®¾ç½®ï¼š __webpack_public_path__ = process.env.ASSET_PATH; å¯¹äºæ—  webpack æ„å»ºçš„å­åº”ç”¨é¡¹ç›®ï¼Œç›´æ¥å°† lifecycles æŒ‚è½½åˆ° window ä¸Šå³å¯ã€‚ window.__POWERED_BY_QIANKUN__åœ¨qiankunç¯å¢ƒä¸­ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ° window.__POWERED_BY_QIANKUN__)è¿™ä¸ªå€¼ï¼Œä¸ºtrueï¼Œé€šå¸¸ç”¨æ¥åˆ¤æ–­å­åº”ç”¨æ˜¯å¦ä¸ºä¹¾å¤ç¯å¢ƒ å±•å¼€è¯´è¯´Reactå¾®åº”ç”¨é¡¹ç›® ä»¥ create react app ç”Ÿæˆçš„ react 16 é¡¹ç›®ä¸ºä¾‹ï¼Œæ­é… react-router-dom 5.xã€‚ åœ¨ src ç›®å½•æ–°å¢ public-path.jsï¼š if (window.__POWERED_BY_QIANKUN__) { __webpack_public_path__ = window.__INJECTED_PUBLIC_PATH_BY_QIANKUN__; } è®¾ç½® history æ¨¡å¼è·¯ç”±çš„ baseï¼š &lt;BrowserRouter basename={window.__POWERED_BY_QIANKUN__ ? '/app-react' : '/'}> å…¥å£æ–‡ä»¶ index.js ä¿®æ”¹ï¼Œä¸ºäº†é¿å…æ ¹ id #root ä¸å…¶ä»–çš„ DOM å†²çªï¼Œéœ€è¦é™åˆ¶æŸ¥æ‰¾èŒƒå›´ã€‚ å¹¶ä¸”åœ¨å…¥å£æ–‡ä»¶å¯¼å‡ºç”Ÿå‘½å‘¨æœŸå‡½æ•° import './public-path'; import React from 'react'; import ReactDOM from 'react-dom'; import App from './App'; function render(props) { const { container } = props; ReactDOM.render(, container ? container.querySelector(â€˜#rootâ€™) : document.querySelector(â€˜#rootâ€™)); } if (!window.POWERED_BY_QIANKUN) { render({}); } export async function bootstrap() { console.log(â€˜[react16] react app bootstrapedâ€™); } export async function mount(props) { console.log(â€˜[react16] props from main frameworkâ€™, props); render(props); } export async function unmount(props) { const { container } = props; ReactDOM.unmountComponentAtNode(container ? container.querySelector(â€˜#rootâ€™) : document.querySelector(â€˜#rootâ€™)); } 4. ä¿®æ”¹ `webpack` é…ç½® å®‰è£…æ’ä»¶ `@rescripts/cli`ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥é€‰æ‹©å…¶ä»–çš„æ’ä»¶ï¼Œä¾‹å¦‚ `react-app-rewired`ã€‚ ```dash npm i -D @rescripts/cli æ ¹ç›®å½•æ–°å¢ .rescriptsrc.jsï¼š const { name } = require('./package'); module.exports = { webpack: (config) => { config.output.library = `${name}-[name]`; config.output.libraryTarget = 'umd'; config.output.jsonpFunction = `webpackJsonp_${name}`; config.output.globalObject = 'window'; return config; }, devServer: (_) => { const config = _; config.headers = { 'Access-Control-Allow-Origin': '*', }; config.historyApiFallback = true; config.hot = false; config.watchContentBase = false; config.liveReload = false; return config; }, }; ä¿®æ”¹ package.jsonï¼š - \"start\": \"react-scripts start\", + \"start\": \"rescripts start\", - \"build\": \"react-scripts build\", + \"build\": \"rescripts build\", - \"test\": \"react-scripts test\", + \"test\": \"rescripts test\", - \"eject\": \"react-scripts eject\" å…¶ä»–é¡¹ç›®ï¼ˆvueã€angularï¼‰ä¹Ÿå¯æŸ¥çœ‹qiankunå®˜ç½‘çš„é¡¹ç›®å®è·µï¼šqiankunå®˜ç½‘é¡¹ç›®å®è·µ 3.å…¨å±€çŠ¶æ€ä¸»åº”ç”¨ï¼š // main/src/main.js import { initGlobalState } from 'qiankun'; // åˆå§‹åŒ– state const initialState = { user: {} // ç”¨æˆ·ä¿¡æ¯ }; const actions = initGlobalState(initialState); actions.onGlobalStateChange((state, prev) => { // state: å˜æ›´åçš„çŠ¶æ€; prev å˜æ›´å‰çš„çŠ¶æ€ console.log(state, prev); }); actions.setGlobalState(state); actions.offGlobalStateChange(); å­åº”ç”¨ï¼š // ä»ç”Ÿå‘½å‘¨æœŸ mount ä¸­è·å–é€šä¿¡æ–¹æ³•ï¼Œpropsé»˜è®¤ä¼šæœ‰onGlobalStateChangeå’ŒsetGlobalStateä¸¤ä¸ªapi export function mount(props) { props.onGlobalStateChange((state, prev) => { // state: å˜æ›´åçš„çŠ¶æ€; prev å˜æ›´å‰çš„çŠ¶æ€ console.log(state, prev); }); props.setGlobalState(state); å½¢æˆäº†ä¸€ä¸ªçˆ¶å­åº”ç”¨çš„å‘å¸ƒè®¢é˜…æ¨¡å¼ 4.æ³¨å†Œå­åº”ç”¨æˆ‘ä»qiankunæºä»£ç ç›´æ¥çœ‹åˆ°çš„æµç¨‹ä¸ºï¼šregisterMicroApps -&gt; loadApp -&gt; const { template, execScripts, assetPublicPath } = await importEntry(entry, importEntryOpts); ç„¶ååˆå§‹åŒ–htmlæ¨¡ç‰ˆï¼ˆåŠ ä¸Šå„ç§qiankun-headï¼‰ const appContent = getDefaultTplWrapper(appInstanceId)(template); let initialAppWrapperElement: HTMLElement | null = createElement( appContent, strictStyleIsolation, scopedCSS, appInstanceId, ); å…¶å® createElement ä¹Ÿå°±æ˜¯åœ¨åšä¸€äº› document.createElement(&#39;div&#39;); containerElement.innerHTML = appContent; shadow = appElement.attachShadow({ mode: &#39;open&#39; }); çš„ä¸€äº›æ“ä½œ åœ¨åŠ è½½scriptçš„æ—¶å€™æ‰§è¡Œå­åº”ç”¨ç”Ÿå‘½å‘¨æœŸ const scriptExports: any = await execScripts(global, sandbox &amp;&amp; !useLooseSandbox); const { bootstrap, mount, unmount, update } = getLifecyclesFromExports( scriptExports, appName, global, sandboxContainer?.instance?.latestSetProp, ); 5.import-html-entryimport-html-entry æ˜¯ qiankun ä¸­ä¸€ä¸ªä¸¾è¶³è½»é‡çš„ä¾èµ–ï¼Œç”¨äºè·å–å­åº”ç”¨çš„ HTML å’Œ JSï¼Œå®ƒå…è®¸ä»¥htmlæ–‡ä»¶ä¸ºåº”ç”¨å…¥å£ï¼Œç„¶åé€šè¿‡ä¸€ä¸ªhtmlè§£æå™¨ä»æ–‡ä»¶ä¸­æå–jså’Œcssä¾èµ–ï¼Œå¹¶é€šè¿‡fetchä¸‹è½½ä¾èµ–ï¼ŒåŒæ—¶å¯¹ HTML å’Œ JS è¿›è¡Œäº†å„è‡ªçš„å¤„ç†ï¼Œä»¥ä¾¿äºå­åº”ç”¨åœ¨çˆ¶åº”ç”¨ä¸­åŠ è½½ è¯¥æ–¹æ¡ˆçš„ä¸»è¦æ€è·¯æ˜¯å…è®¸ä»¥htmlæ–‡ä»¶ä¸ºåº”ç”¨å…¥å£ï¼Œç„¶åé€šè¿‡ä¸€ä¸ªhtmlè§£æå™¨ä»æ–‡ä»¶ä¸­æå–jså’Œcssä¾èµ–ï¼Œå¹¶é€šè¿‡fetchä¸‹è½½ä¾èµ– export default function importHTML(url, opts = {}) { // 1. é€šè¿‡ fetch è·å–åˆ° url å¯¹åº”çš„ html return embedHTMLCache[url] || (embedHTMLCache[url] = fetch(url) .then(html => { // 2. ä»è¿”å›çš„ç»“æœä¸­è§£æå‡ºä»¥ä¸‹å†…å®¹a.ç»è¿‡åˆæ­¥å¤„ç†åçš„ html, b.ç”±æ‰€æœ‰ \"script\" ç»„æˆçš„æ•°ç»„, c.ç”±æ‰€æœ‰ \"style\" ç»„æˆçš„æ•°ç»„ const { template, scripts, entry, styles } = processTpl(getTemplate(html), assetPublicPath, postProcessTemplate); // 3. å°†æ‰€æœ‰çš„ css åµŒå…¥åˆ°ä¸Šè¿°ç»è¿‡åˆæ­¥å¤„ç†åçš„ html ä¸­ return getEmbedHTML(template, styles, { fetch }).then(embedHTML => (...)); })); } äºæ˜¯åœ¨qiankunä¸­ä½ å¯ä»¥è¿™æ ·é…ç½®å…¥å£ï¼š const MicroApps = [{ name: 'app1', entry: 'http://localhost:8080', container: '#app', activeRule: '/app1' }] qiankunä¼šé€šè¿‡import-html-entryè¯·æ±‚http://localhost:8080ï¼Œå¾—åˆ°å¯¹åº”çš„htmlæ–‡ä»¶ï¼Œè§£æå†…éƒ¨çš„æ‰€æœ‰scriptå’Œstyleæ ‡ç­¾ï¼Œä¾æ¬¡ä¸‹è½½å’Œæ‰§è¡Œå®ƒä»¬ï¼Œè¿™ä½¿å¾—åº”ç”¨åŠ è½½å˜å¾—æ›´æ˜“ç”¨ã€‚ ä¸‰ä¸ªapiimport-html-entryï¼Œæœ‰ importHTMLï¼šå°†ç´¢å¼• html è§†ä¸ºæ¸…å•å¹¶åŠ è½½èµ„äº§ï¼ˆcssï¼Œjsï¼‰ï¼Œä»å…¥å£è„šæœ¬è·å–å¯¼å‡ºã€‚ å¯¼å‡º //è§£ææ¨¡æ¿çš„æ ¸å¿ƒå‡½æ•°_processTpl2 var _processTpl = (0, _processTpl2[\"default\"])(getTemplate(html), assetPublicPath, postProcessTemplate), template = _processTpl.template, scripts = _processTpl.scripts, entry = _processTpl.entry, styles = _processTpl.styles; return getEmbedHTML(template, styles, { fetch: fetch }).then(function (embedHTML) { return { template: embedHTML, assetPublicPath: assetPublicPath, getExternalScripts: function getExternalScripts() { return _getExternalScripts(scripts, fetch); }, getExternalStyleSheets: function getExternalStyleSheets() { return _getExternalStyleSheets(styles, fetch); }, execScripts: function execScripts(proxy, strictGlobal) { var opts = arguments.length > 2 &amp;&amp; arguments[2] !== undefined ? arguments[2] : {}; if (!scripts.length) { return Promise.resolve(); } return _execScripts(entry, scripts, proxy, _objectSpread({ fetch: fetch, strictGlobal: strictGlobal }, opts)); } }; }); importEntryï¼šåŠ è½½èµ„äº§ï¼ˆcssï¼Œjsï¼‰å¹¶åµŒå…¥åˆ° HTML æ¨¡æ¿ä¸­ï¼Œä»å…¥å£è„šæœ¬è·å–å¯¼å‡ºã€‚ï¼ˆå®é™…ä¸Šå¦‚æœ type of å‚æ•° === stringï¼Œå°±ä¼šè¿”å›importHTMLï¼‰ ä¸ºå¯¹è±¡çš„æ—¶å€™ï¼Œä¼ å…¥çš„æ˜¯è„šæœ¬å’Œæ ·å¼çš„èµ„æºåˆ—è¡¨ã€‚ { html:\"http://xxx.com/static/tpl.html\", scripts:[ { src:\"http://xxx.com/static/xx.js\", async:true }, ... ], styles:[ { href:\"http://xxx.com/static/style.css\" }, ... ] } execScriptsï¼šåœ¨è‡ªå®šä¹‰æ²™ç®±ä¸Šé€šè¿‡ URL åŠ è½½è„šæœ¬ï¼Œä»å…¥å£è„šæœ¬è·å–å¯¼å‡ºã€‚ æš´éœ²å‡ºçš„æ ¸å¿ƒæ¥å£æ˜¯importHTMLï¼Œè€Œ importHTML çš„å…·ä½“æµç¨‹ï¼š æ£€æŸ¥æ˜¯å¦æœ‰ç¼“å­˜ï¼Œå¦‚æœæœ‰ï¼Œç›´æ¥ä»ç¼“å­˜ä¸­è¿”å› å¦‚æœæ²¡æœ‰ï¼Œåˆ™é€šè¿‡fetchä¸‹è½½ï¼Œå¹¶å­—ç¬¦ä¸²åŒ– åŸºäºæ­£åˆ™è¡¨è¾¾å¼å¯¹æ¨¡æ¿å­—ç¬¦ä¸²åŸºäºæ­£åˆ™è¡¨è¾¾å¼å¯¹æ¨¡æ¿å­—ç¬¦ä¸² è¿›è¡Œä¸€æ¬¡æ¨¡æ¿è§£æï¼Œä¸»è¦ä»»åŠ¡æ˜¯æ‰«æå‡ºå¤–è”è„šæœ¬å’Œå¤–è”æ ·å¼ï¼Œä¿å­˜åœ¨scriptså’Œstylesä¸­ è°ƒç”¨getEmbedHTMLï¼Œå°†å¤–è”æ ·å¼ä¸‹è½½ä¸‹æ¥ï¼Œå¹¶æ›¿æ¢åˆ°æ¨¡æ¿å†…ï¼Œä½¿å…¶å˜æˆå†…éƒ¨æ ·å¼ è¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œè¯¥å¯¹è±¡åŒ…å«å¤„ç†åçš„æ¨¡æ¿ï¼Œä»¥åŠgetExternalScriptsã€getExternalStyleSheetsã€execScriptsç­‰å‡ ä¸ªæ ¸å¿ƒæ–¹æ³•ã€‚ getExternalStyleSheetsï¼šprefetchä¸‹è½½stylesæ ·å¼è¡¨ï¼ŒisInlineCodeåˆ¤æ–­æ˜¯å¦ä¸ºå†…è”ä»£ç ï¼Œè¿”å›cssçš„ä»£ç  function _getExternalStyleSheets(styles) { var fetch = arguments.length > 1 &amp;&amp; arguments[1] !== undefined ? arguments[1] : defaultFetch; return Promise.all(styles.map(function (styleLink) { if (isInlineCode(styleLink)) { // if it is inline style return (0, _utils.getInlineCode)(styleLink); } else { // external styles return styleCache[styleLink] || (styleCache[styleLink] = fetch(styleLink).then(function (response) { return response.text(); })); } })); } getExternalScriptsï¼šprefetchä¸‹è½½scriptè¡¨ï¼ŒisInlineCodeåˆ¤æ–­æ˜¯å¦ä¸ºå†…è”ä»£ç ï¼Œæ˜¯çš„è¯ç›´æ¥æˆªå–scripté‡Œé¢çš„ä»£ç ï¼Œè¿”å›jsçš„ä»£ç  // for prefetch function _getExternalScripts(scripts) { var fetch = arguments.length > 1 &amp;&amp; arguments[1] !== undefined ? arguments[1] : defaultFetch; var errorCallback = arguments.length > 2 &amp;&amp; arguments[2] !== undefined ? arguments[2] : function () {}; var fetchScript = function fetchScript(scriptUrl) { return scriptCache[scriptUrl] || (scriptCache[scriptUrl] = fetch(scriptUrl).then(function (response) { // usually browser treats 4xx and 5xx response of script loading as an error and will fire a script error event // https://stackoverflow.com/questions/5625420/what-http-headers-responses-trigger-the-onerror-handler-on-a-script-tag/5625603 if (response.status >= 400) { errorCallback(); throw new Error(\"\".concat(scriptUrl, \" load failed with status \").concat(response.status)); } return response.text(); })[\"catch\"](function (e) { errorCallback(); throw e; })); }; return Promise.all(scripts.map(function (script) { if (typeof script === 'string') { if (isInlineCode(script)) { // if it is inline script return (0, _utils.getInlineCode)(script); } else { // external script return fetchScript(script); } } else { // use idle time to load async script var src = script.src, async = script.async; if (async) { return { src: src, async: true, content: new Promise(function (resolve, reject) { return (0, _utils.requestIdleCallback)(function () { return fetchScript(src).then(resolve, reject); }); }) }; } return fetchScript(src); } })); } execScriptsï¼šæ‰§è¡Œè„šæœ¬ï¼Œè¿”å›_getExternalScripts.then() + è·å–ä»£ç ï¼ˆgetExecutableScript,æ”¹å˜è„šæœ¬æ‰§è¡Œæ—¶å€™çš„window/self/this çš„æŒ‡å‘ã€‚ï¼‰ + schedule å‡½æ•°è°ƒåº¦ä¸­æŒ‰åºæ‰§è¡Œ exec function getExecutableScript(scriptSrc, scriptText) { var opts = arguments.length > 2 &amp;&amp; arguments[2] !== undefined ? arguments[2] : {}; var proxy = opts.proxy, strictGlobal = opts.strictGlobal, _opts$scopedGlobalVar = opts.scopedGlobalVariables, scopedGlobalVariables = _opts$scopedGlobalVar === void 0 ? [] : _opts$scopedGlobalVar; var sourceUrl = isInlineCode(scriptSrc) ? '' : \"//# sourceURL=\".concat(scriptSrc, \"\\n\"); // å°† scopedGlobalVariables æ‹¼æ¥æˆå‡½æ•°å£°æ˜ï¼Œç”¨äºç¼“å­˜å…¨å±€å˜é‡ï¼Œé¿å…æ¯æ¬¡ä½¿ç”¨æ—¶éƒ½èµ°ä¸€éä»£ç† var scopedGlobalVariableFnParameters = scopedGlobalVariables.length ? scopedGlobalVariables.join(',') : ''; // é€šè¿‡è¿™ç§æ–¹å¼è·å–å…¨å±€ windowï¼Œå› ä¸º script ä¹Ÿæ˜¯åœ¨å…¨å±€ä½œç”¨åŸŸä¸‹è¿è¡Œçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬é€šè¿‡ window.proxy ç»‘å®šæ—¶ä¹Ÿå¿…é¡»ç¡®ä¿ç»‘å®šåˆ°å…¨å±€ window ä¸Š // å¦åˆ™åœ¨åµŒå¥—åœºæ™¯ä¸‹ï¼Œ window.proxy è®¾ç½®çš„æ˜¯å†…å±‚åº”ç”¨çš„ windowï¼Œè€Œä»£ç å…¶å®æ˜¯åœ¨å…¨å±€ä½œç”¨åŸŸè¿è¡Œçš„ï¼Œä¼šå¯¼è‡´é—­åŒ…é‡Œçš„ window.proxy å–çš„æ˜¯æœ€å¤–å±‚çš„å¾®åº”ç”¨çš„ proxy var globalWindow = (0, eval)('window'); globalWindow.proxy = proxy; // TODO é€šè¿‡ strictGlobal æ–¹å¼åˆ‡æ¢ with é—­åŒ…ï¼Œå¾… with æ–¹å¼å‘è¶Ÿå¹³åå†åˆå¹¶ return strictGlobal ? scopedGlobalVariableFnParameters ? \";(function(){with(window.proxy){(function(\".concat(scopedGlobalVariableFnParameters, \"){;\").concat(scriptText, \"\\n\").concat(sourceUrl, \"}).bind(window.proxy)(\").concat(scopedGlobalVariableFnParameters, \")}})();\") : \";(function(window, self, globalThis){with(window){;\".concat(scriptText, \"\\n\").concat(sourceUrl, \"}}).bind(window.proxy)(window.proxy, window.proxy, window.proxy);\") : \";(function(window, self, globalThis){;\".concat(scriptText, \"\\n\").concat(sourceUrl, \"}).bind(window.proxy)(window.proxy, window.proxy, window.proxy);\"); } å‚è€ƒï¼š qiankunå®˜ç½‘é¡¹ç›®å®è·µ","categories":[{"name":"å‰ç«¯","slug":"å‰ç«¯","permalink":"https://taylor12138.github.io/categories/%E5%89%8D%E7%AB%AF/"}],"tags":[],"author":"Hello"},{"title":"ä¸€äº›å¥½ç”¨çš„ç½‘ç«™","slug":"ä¸€äº›å¥½ç”¨çš„ç½‘ç«™","date":"2022-08-22T16:00:00.000Z","updated":"2023-04-26T07:00:09.597Z","comments":true,"path":"2022/08/23/yi-xie-hao-yong-de-wang-zhan/","link":"","permalink":"https://taylor12138.github.io/2022/08/23/yi-xie-hao-yong-de-wang-zhan/","excerpt":"","text":"Exampleä»¥ä¸‹éƒ¨åˆ†ç½‘ç«™åˆ†äº«å‡æ¥æºäºè€é™ˆæ‰“ç çš„ç½‘ç«™æ¨èï¼š å›¾æ ‡ åŠ¨ç”»å›¾æ ‡åº“ https://loading.io/ css åŠ¨ç”»cssä»£ç åœ¨çº¿æ¼”ç¤ºï¼ˆå¯ä»¥ç›´æ¥cvåŠ¨ç”»ä»£ç ï¼‰ https://xsgames.co/animatiss/ css flexå¸ƒå±€æ¸¸æˆç»ƒä¹ ç½‘ç«™ and cssä¸€äº›æ–°çš„åŠŸèƒ½å°è¯•ç½‘ç«™ http://www.flexboxdefense.com/ https://css-tricks.com/ CSS-doodle æ˜¯ä¸€ä¸ªåŸºäº Web-Component çš„åº“ã€‚å…è®¸æˆ‘ä»¬å¿«é€Ÿçš„åˆ›å»ºåŸºäº CSS Grid å¸ƒå±€çš„é¡µé¢ï¼Œä»¥å®ç°å„ç§ CSS æ•ˆæœï¼ˆæˆ–è®¸å¯ä»¥ç§°ä¹‹ä¸º CSS è‰ºæœ¯ï¼‰ã€‚ https://css-doodle.com/ https://www.cnblogs.com/coco1s/p/15178959.html reactä¸­ä½¿ç”¨ï¼šhttps://github.com/css-doodle/css-doodle/issues/35 3D Web3Dç¼–è¾‘å™¨ https://techbrood.com/ åŠ¨ç”» æ‰å¹³åŒ–çš„3dæ•ˆæœå›¾æ¡ˆï¼šzdogï¼Œç±»ä¼¼äºå§ä¸€äº›logoã€svgè¿›è¡Œ3då±•ç° ä½“ç§¯28kï¼Œä¸éœ€è¦åƒthreejsé‚£ç§ä¸€æ ·éœ€è¦ä¸€å¤§å †çš„æ”¯æŒ https://zzz.dog/ å¯¹äºvueã€reactå¯ä»¥åœ¨githubä¸Šæœç´¢vue-zdogã€react-zdogæ¥ç©ä¸€ç© PPT pptæ¨¡æ¿ç½‘ç«™ https://www.youyedoc.com/ppt/ ç»˜åˆ¶æµç¨‹å›¾ç½‘ç«™ https://app.diagrams.net/ ç”»å›¾ç½‘ç«™ https://app.diagrams.net/ Gifç”Ÿæˆç½‘ç«™ diagramsï¼šhttps://www.qtool.net/gif å¤‡æ³¨ï¼šè¯¥æŒ‚ä»¶é…ç½®å’Œæˆ‘ä»¬æ­£å¸¸è¿è¥å¹³å°çš„æŒ‚ä»¶é…ç½®å¹¶æ— äºŒè‡´ï¼Œåªæ˜¯è¯¥cmsæ•´é¡¿äº†ä¸€åŠæ‰€æœ‰ç›´æ’­ä¸šåŠ¡çš„cmsç‹¬ç«‹å‡ºæ¥ï¼Œå¹¶ä¸”å¯ä»¥åœ¨æ–°ä¸šåŠ¡çš„å¼€å‘è¿è¥åå°æœªå¼€å‘æŒ‚ä»¶é…ç½®æ—¶ï¼Œå¯ä»¥ç›´æ¥ä½œä¸ºå­åº”ç”¨æ’æ‹”åˆ°è¿ç”¨åå°ä¸»åº”ç”¨å½“ä¸­å» é¢œè‰²ç½‘ç«™ï¼š è®©ä½ çš„ç½‘ç«™æ‰¾åˆ°å±äºè‡ªå·±çš„ä¸»è‰²è°ƒ https://www.palettable.io/FDF903 æ¸å˜è‰² https://www.joshwcomeau.com/gradient-generator/ ä¸­å›½çº¢ http://zhongguose.com/ è‡ªé€‰è‰²è°ƒï¼Œä¼šè‡ªåŠ¨å¸®ä½ æ­é…åº”æœ‰çš„è‰²è°ƒ https://m2.material.io/resources/color/#!/?view.left=0&amp;view.right=0 adobe color https://color.adobe.com/zh/create/color-wheel colors https://coolors.co/ logoè‡ªåŠ¨ç”Ÿæˆç½‘ç«™https://www.logosc.cn/make åœ¨çº¿è„‘å›¾ç»˜åˆ¶https://gitmind.cn/ JSåº“ Polyfillæ˜¯ä¸€ä¸ªjsåº“ï¼Œä¸»è¦æŠšå¹³ä¸åŒæµè§ˆå™¨ä¹‹é—´å¯¹jså®ç°çš„å·®å¼‚ã€‚ ECMAScript çš„è¿…é€Ÿæˆé•¿ä»¥åŠæµè§ˆå™¨çš„é¢‘ç¹æ›´æ–°æ¢ä»£ï¼Œæ¯å¹´ä¼šå‡ºç°æ–°çš„ api ï¼Œä¸¾ä¸ªä¾‹å­ es6 æ—¶æœŸè¯ç”Ÿçš„ â€˜Promiseâ€™ ï¼Œâ€™Setâ€™ æˆ–è€…æ˜¯ â€˜es7â€™ æ•°ç»„æ–°æä¾›çš„æ–¹æ³• â€˜includesâ€™ ,è¿™äº›æ–°åŠ å…¥çš„ â€˜apiâ€™ ï¼Œå°±å¼•å‡ºä¸€ä¸ªè¯ â€œpolyfillâ€ â€˜polyfill(å«ç‰‡/è¡¥ä¸)â€™ å°±æ˜¯ç”¨ç¤¾åŒºä¸Šæä¾›çš„ä¸€æ®µä»£ç ï¼Œè®©æˆ‘ä»¬åœ¨ä¸å…¼å®¹æŸäº›æ–°ç‰¹æ€§çš„æµè§ˆå™¨ä¸Šï¼Œä½¿ç”¨è¯¥æ–°ç‰¹æ€§ lodashï¼Œè¿™ä¸ªæ— éœ€å¤šè¨€ Ramda.jsï¼šhttps://www.ruanyifeng.com/blog/2017/03/ramda.htmlï¼Œé˜®ä¸€å³°è€å¸ˆçš„æ•™ç¨‹ core-jsï¼šä¹Ÿé€‚ç”¨äºpolyfillçš„åº“","categories":[{"name":"å‰ç«¯","slug":"å‰ç«¯","permalink":"https://taylor12138.github.io/categories/%E5%89%8D%E7%AB%AF/"}],"tags":[],"author":"Hello"},{"title":"æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½","slug":"æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½","date":"2022-07-27T16:00:00.000Z","updated":"2023-05-08T09:24:08.306Z","comments":true,"path":"2022/07/28/wen-jian-shang-chuan-gong-neng/","link":"","permalink":"https://taylor12138.github.io/2022/07/28/wen-jian-shang-chuan-gong-neng/","excerpt":"","text":"1.Blobblobæ•°æ®ç±»å‹ä»¥éšæœºå­˜å–å—çš„å½¢å¼å­˜å‚¨ä»»ä½•ç§ç±»çš„äºŒè¿›åˆ¶æ•°æ®ï¼›äºŒè¿›åˆ¶æ•°æ®é€šå¸¸ç”±å·²ä¿å­˜çš„ç”µå­è¡¨æ ¼ã€ç¨‹åºè£…å…¥æ¨¡å—å’Œæ•°å­—åŒ–å£°éŸ³æ¨¡å¼ç­‰ç­‰ç»„æˆï¼Œä¹Ÿå°±æ˜¯è¯´å®ƒé€šå¸¸ç”¨äºå­˜å‚¨å¤§æ–‡ä»¶ï¼Œé€šå¸¸ç”¨æ¥è¯»å†™æ–‡ä»¶ï¼Œæ¯”å¦‚ä¸€ä¸ªå›¾ç‰‡æ–‡ä»¶çš„å†…å®¹å°±å¯ä»¥é€šè¿‡Blob å¯¹è±¡è¯»å†™ åœ¨Webä¸­ï¼ŒBlobç±»å‹çš„å¯¹è±¡è¡¨ç¤ºä¸å¯å˜çš„ç±»ä¼¼æ–‡ä»¶å¯¹è±¡çš„åŸå§‹æ•°æ®ï¼Œé€šä¿—ç‚¹è¯´ï¼Œå°±æ˜¯Blobå¯¹è±¡æ˜¯äºŒè¿›åˆ¶æ•°æ®ï¼Œä½†å®ƒæ˜¯ç±»ä¼¼æ–‡ä»¶å¯¹è±¡çš„äºŒè¿›åˆ¶æ•°æ®ï¼Œå› æ­¤å¯ä»¥åƒæ“ä½œFileå¯¹è±¡ä¸€æ ·æ“ä½œBlobå¯¹è±¡ï¼Œå®é™…ä¸Šï¼ŒFileç»§æ‰¿è‡ªBlobï¼ˆæ–‡ä»¶å¯¹è±¡ï¼‰ã€‚ æ„é€ å‡½æ•° array æ˜¯ä¸€ä¸ªç”±ArrayBuffer, ArrayBufferView, Blob, DOMString ç­‰å¯¹è±¡æ„æˆçš„ Array ï¼Œæˆ–è€…å…¶ä»–ç±»ä¼¼å¯¹è±¡çš„æ··åˆä½“ï¼Œå®ƒå°†ä¼šè¢«æ”¾è¿› Blobã€‚DOMStrings ä¼šè¢«ç¼–ç ä¸º UTF-8ã€‚ optionsï¼ˆå¯é€‰ï¼‰ å®ƒå¯èƒ½ä¼šæŒ‡å®šå¦‚ä¸‹ä¸¤ä¸ªå±æ€§ï¼š typeï¼Œé»˜è®¤å€¼ä¸º &quot;&quot;ï¼Œå®ƒä»£è¡¨äº†å°†ä¼šè¢«æ”¾å…¥åˆ° blob ä¸­çš„æ•°ç»„å†…å®¹çš„ MIME ç±»å‹ã€‚ endingsï¼Œé»˜è®¤å€¼ä¸º&quot;transparent&quot;ï¼Œç”¨äºæŒ‡å®šåŒ…å«è¡Œç»“æŸç¬¦\\nçš„å­—ç¬¦ä¸²å¦‚ä½•è¢«å†™å…¥ã€‚å®ƒæ˜¯ä»¥ä¸‹ä¸¤ä¸ªå€¼ä¸­çš„ä¸€ä¸ªï¼š&quot;native&quot;ï¼Œä»£è¡¨è¡Œç»“æŸç¬¦ä¼šè¢«æ›´æ”¹ä¸ºé€‚åˆå®¿ä¸»æ“ä½œç³»ç»Ÿæ–‡ä»¶ç³»ç»Ÿçš„æ¢è¡Œç¬¦ï¼Œæˆ–è€… &quot;transparent&quot;ï¼Œä»£è¡¨ä¼šä¿æŒ blob ä¸­ä¿å­˜çš„ç»“æŸç¬¦ä¸å˜ éæ ‡å‡† let blob = new Blob([typedArray.buffer], {type: 'application/octet-stream'}); // ä¼ å…¥ä¸€ä¸ªåˆé€‚çš„ MIME ç±»å‹ let blob2 = new Blob([\"image/jpeg\"],{type:\"application/json\"}) ä½¿ç”¨å­—ç¬¦ä¸²æ„é€ ä¸€ä¸ªblobå¯¹è±¡ var debug = {hello: \"world\"}; var blob = new Blob([JSON.stringify(debug)], {type : 'application/json'}); ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯æ•°ç»„ï¼Œæ•°ç»„å…ƒç´ å¯ä»¥æ˜¯å­—ç¬¦ä¸²æˆ–äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œç”¨æ¥è¡¨ç¤ºBlobå®ä¾‹å¯¹è±¡çš„æ•°æ®å†…å®¹ã€‚ ç¬¬äºŒä¸ªå‚æ•°æ˜¯é…ç½®å¯¹è±¡ï¼Œä½†æ˜¯ç›®å‰è¯¥å¯¹è±¡åªæœ‰ä¸€ä¸ªtypeå±æ€§å¯æä¾›é…ç½®ï¼Œå®ƒçš„å€¼æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè¡¨ç¤ºæ•°æ®çš„MIMEç±»å‹ï¼Œé»˜è®¤æ˜¯ç©ºå­—ç¬¦ä¸²ï¼Œå…³äºMIMEç±»å‹åˆ†ç±»ï¼Œå¯ä»¥å‚ç…§ä»¥ä¸‹è¿™å¼ è¡¨ï¼š blob2urlæ­¤æ—¶å‰ç«¯å¯ä»¥å°†Blobæ•°æ®è½¬æ¢ä¸ºurlä¸‹è½½åœ°å€ export function downBlob(blobData: Blob, fileName: string) { // ä¸‹è½½åœ°å€ const downUrl = window.URL.createObjectURL(blobData); const a = document.createElement('a'); a.style.display = 'none'; a.href = downUrl; a.target = '_blank'; if (fileName) { a.download = fileName; } document.body.appendChild(a); a.click(); a.remove(); window.URL.revokeObjectURL(downUrl); // é‡Šæ”¾æ‰blobå¯¹è±¡ } url2blobå¯¹äºcanvasç”Ÿæˆçš„base64 urlï¼Œä¹Ÿå°±æ˜¯Data URL æ ¼å¼çš„å›¾ç‰‡æ•°æ®ï¼Œä¸ºäº†è¿›ä¸€æ­¥å‡å°‘ä¼ è¾“çš„æ•°æ®é‡ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠå®ƒè½¬æ¢ä¸º Blob å¯¹è±¡ï¼Œå†ä¼ ç»™æœåŠ¡ç«¯ function dataUrlToBlob(base64, mimeType) { let bytes = window.atob(base64.split(\",\")[1]); let ab = new ArrayBuffer(bytes.length); let ia = new Uint8Array(ab); for (let i = 0; i &lt; bytes.length; i++) { ia[i] = bytes.charCodeAt(i); } return new Blob([ab], { type: mimeType }); } URL.createObjectURLURL.createObjectURL() é™æ€æ–¹æ³•ä¼šåˆ›å»ºä¸€ä¸ª DOMStringï¼Œå…¶ä¸­åŒ…å«ä¸€ä¸ªè¡¨ç¤ºå‚æ•°ä¸­ç»™å‡ºçš„å¯¹è±¡çš„URLã€‚è¿™ä¸ª URL çš„ç”Ÿå‘½å‘¨æœŸå’Œåˆ›å»ºå®ƒçš„çª—å£ä¸­çš„ document ç»‘å®šã€‚è¿™ä¸ªæ–°çš„URL å¯¹è±¡è¡¨ç¤ºæŒ‡å®šçš„ File å¯¹è±¡æˆ– Blob å¯¹è±¡ã€‚ createObjectURLè¿”å›ä¸€æ®µå¸¦hashçš„urlï¼Œå¹¶ä¸”ä¸€ç›´å­˜å‚¨åœ¨å†…å­˜ä¸­ï¼Œç›´åˆ°documentè§¦å‘äº†unloadäº‹ä»¶ï¼ˆä¾‹å¦‚ï¼šdocument closeï¼‰æˆ–è€…æ‰§è¡ŒrevokeObjectURLæ¥é‡Šæ”¾ã€‚ Fileæ–‡ä»¶ï¼ˆFileï¼‰æ¥å£æä¾›æœ‰å…³æ–‡ä»¶çš„ä¿¡æ¯ï¼Œå¹¶å…è®¸ç½‘é¡µä¸­çš„ JavaScript è®¿é—®å…¶å†…å®¹ã€‚ é€šå¸¸æƒ…å†µä¸‹ï¼Œ File å¯¹è±¡æ˜¯æ¥è‡ªç”¨æˆ·åœ¨ä¸€ä¸ª input å…ƒç´ ä¸Šé€‰æ‹©æ–‡ä»¶åè¿”å›çš„ FileList å¯¹è±¡ï¼Œä¹Ÿå¯ä»¥æ˜¯æ¥è‡ªç”±æ‹–æ”¾æ“ä½œç”Ÿæˆçš„ DataTransfer å¯¹è±¡ï¼Œæˆ–è€…æ¥è‡ª HTMLCanvasElement ä¸Šçš„ mozGetAsFile() APIã€‚ File å¯¹è±¡æ˜¯ç‰¹æ®Šç±»å‹çš„ Blobï¼Œä¸”å¯ä»¥ç”¨åœ¨ä»»æ„çš„ Blob ç±»å‹çš„ context ä¸­ã€‚ File() FormDataFormData æ¥å£æä¾›äº†ä¸€ç§è¡¨ç¤ºè¡¨å•æ•°æ®çš„é”®å€¼å¯¹ key/value çš„æ„é€ æ–¹å¼ï¼Œå¹¶ä¸”å¯ä»¥è½»æ¾çš„å°†æ•°æ®é€šè¿‡XMLHttpRequest.send() æ–¹æ³•å‘é€å‡ºå»ï¼Œæœ¬æ¥å£å’Œæ­¤æ–¹æ³•éƒ½ç›¸å½“ç®€å•ç›´æ¥ã€‚å¦‚æœé€å‡ºæ—¶çš„ç¼–ç ç±»å‹è¢«è®¾ä¸º &quot;multipart/form-data&quot;ï¼Œå®ƒä¼šä½¿ç”¨å’Œè¡¨å•ä¸€æ ·çš„æ ¼å¼ã€‚ å®ƒçš„ç”¨æ³•å’Œ map æœ‰ç‚¹åƒ æ„é€ å‡½æ•° FormData() åˆ›å»ºä¸€ä¸ªæ–°çš„ FormData å¯¹è±¡ã€‚ æ–¹æ³• FormData.append() å‘ FormData ä¸­æ·»åŠ æ–°çš„å±æ€§å€¼ï¼ŒFormData å¯¹åº”çš„å±æ€§å€¼å­˜åœ¨ä¹Ÿä¸ä¼šè¦†ç›–åŸå€¼ï¼Œè€Œæ˜¯æ–°å¢ä¸€ä¸ªå€¼ï¼Œå¦‚æœå±æ€§ä¸å­˜åœ¨åˆ™æ–°å¢ä¸€é¡¹å±æ€§å€¼ã€‚ FormData.delete() ä» FormData å¯¹è±¡é‡Œé¢åˆ é™¤ä¸€ä¸ªé”®å€¼å¯¹ã€‚ FormData.entries() è¿”å›ä¸€ä¸ªåŒ…å«æ‰€æœ‰é”®å€¼å¯¹çš„iteratorå¯¹è±¡ã€‚ FormData.get() è¿”å›åœ¨ FormData å¯¹è±¡ä¸­ä¸ç»™å®šé”®å…³è”çš„ç¬¬ä¸€ä¸ªå€¼ã€‚ FormData.getAll() è¿”å›ä¸€ä¸ªåŒ…å« FormData å¯¹è±¡ä¸­ä¸ç»™å®šé”®å…³è”çš„æ‰€æœ‰å€¼çš„æ•°ç»„ã€‚ FormData.has() è¿”å›ä¸€ä¸ªå¸ƒå°”å€¼è¡¨æ˜ FormData å¯¹è±¡æ˜¯å¦åŒ…å«æŸäº›é”®ã€‚ FormData.keys() è¿”å›ä¸€ä¸ªåŒ…å«æ‰€æœ‰é”®çš„iteratorå¯¹è±¡ã€‚ FormData.set() ç»™ FormData è®¾ç½®å±æ€§å€¼ï¼Œå¦‚æœFormData å¯¹åº”çš„å±æ€§å€¼å­˜åœ¨åˆ™è¦†ç›–åŸå€¼ï¼Œå¦åˆ™æ–°å¢ä¸€é¡¹å±æ€§å€¼ã€‚ FormData.values() è¿”å›ä¸€ä¸ªåŒ…å«æ‰€æœ‰å€¼çš„iteratorå¯¹è±¡ã€‚ 2.é€‰æ‹©å›¾ç‰‡ä¸Šä¼ åœ¨å…ƒç´ æ–¹é¢ï¼Œæˆ‘ä»¬å¯ä»¥é€‰æ‹© input &lt;input type=\"file\" /> &lt;input type=\"file\" accept=\"image/*\"> &lt;input type=\"file\" accept=\"image/gif,image/jpeg,image/jpg,image/png\" multiple /> é€šè¿‡è®¾ç½®å…¶ multiple å±æ€§å’Œ accept å±æ€§å¯ä»¥ä½¿å¾— input æ ‡ç­¾æ”¯æŒå¤šé€‰å’Œä»…æ”¯æŒé€‰æ‹© gifã€jpg/jpeg å’Œ png ç±»å‹çš„æ–‡ä»¶ ç„¶åå¯ä»¥å¯¹inputè¯»å–åˆ°çš„æ•°æ®ï¼Œé‡‡ç”¨ 2ç§æ–¹å¼ URL.createObjectURL(file)ï¼Œå¾—åˆ°å›¾ç‰‡çš„urlï¼Œç”±äºå¯ä»¥è·å–åˆ°æ¯å¼ å›¾ç‰‡çš„ File å¯¹è±¡ï¼Œåˆ™å¯ä»¥ä½¿ç”¨ URL.createObjectURL() åˆ›å»ºä¸€ä¸ªå¯¹è±¡ URLï¼Œå¯ä»¥ä½œä¸º img æ ‡ç­¾çš„ src å€¼è¿›è¡Œä¼ å…¥ï¼Œåˆ™èƒ½å®ç°æœ¬åœ°å›¾ç‰‡çš„é¢„è§ˆåŠŸèƒ½ã€‚ éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå½“ä¸å†éœ€è¦è¿™äº›ä½¿ç”¨ URL.createObjectURL() åˆ›å»ºçš„ URL å¯¹è±¡æ—¶ï¼Œæ¯ä¸ªå¯¹è±¡å¿…é¡»é€šè¿‡è°ƒç”¨ URL.revokeObjectURL() æ–¹æ³•æ¥é‡Šæ”¾ const localUrl = URL.createObjectURL(flieList[0]) // localUrl å¯ä½œä¸ºå›¾ç‰‡çš„æº &lt;img src={localUrl} alt='' /> // æ— éœ€ä½¿ç”¨æ—¶é‡Šæ”¾å†…å­˜ window.URL.revokeObjectURL(localUrl); åˆ›å»ºä¸€ä¸ªFileReaderå¯¹è±¡ï¼Œç›‘å¬å®ƒçš„loadäº‹ä»¶ $inputFile.addEventListener('change', function() { const file = this.files[0]; const reader = new FileReader(); reader.addEventListener('load', function() { $previewImage.src = reader.result; }, false); if(file) { reader.readAsDataURL(file); } } ä¸Šä¼ å‰ç«¯è¦å®ç°å›¾ç‰‡ä¸Šä¼ çš„åŸç†å°±æ˜¯é€šè¿‡æ„å»ºFormDataå¯¹è±¡ï¼ŒæŠŠæ–‡ä»¶å¯¹è±¡append()åˆ°è¯¥å¯¹è±¡ï¼Œç„¶åæŒ‚è½½åœ¨XMLHttpRequestå¯¹è±¡ä¸Š send() åˆ°æœåŠ¡ç«¯ã€‚ï¼ˆå¦‚æœæ˜¯å¾—åˆ°æœ¬åœ°urlå¯ä»¥é€šè¿‡ fetch(data.url).then((resp) => { console.log(resp); return resp.blob(); }).then((b) => { console.log('---- bb', b); const fd = new FormData(); fd.append('file', b); console.log(fd, 'fd'); }); å¾—åˆ°blobæ•°æ®æ ¼å¼) function uploadFile() { //è¿™é‡Œæ˜¯ç”¨cropperjså¯¹å›¾ç‰‡è¿›è¡Œè£å‰ª cropperInstance.getCroppedCanvas().toBlob(function(blob) { const formData = new FormData(); formData.append('avatar', blob); fetch('xxxx', { method: 'POST', body: formData }); }); } 3.æ–‡ä»¶ä¸Šä¼ æ–‡ä»¶ä¸Šä¼ å®è´¨ä¸Šå’Œå›¾ç‰‡ä¸Šä¼ å·®ä¸å¤šï¼Œéƒ½æ˜¯ä½¿ç”¨inputè·å–æ–‡ä»¶ &lt;div> &lt;input onChange={(v)=>this.handleChange(v)} type=\"file\" size={this.state.size} name=\"fileSelect\" accept=\"image/*\" multiple={this.state.multiple} /> &lt;span ref=\"dragBox\" onDragOver={(e)=>this.handleDragHover(e)} onDragLeave={(e)=>this.handleDragHover(e)} onDrop={(e)=>this.handleDrop(e)} className=\"upload-drag-area\"> æˆ–è€…å°†å›¾ç‰‡æ‹–åˆ°æ­¤å¤„ &lt;/span> &lt;/div> å¤„ç†å›¾ç‰‡ä¸Šä¼ çš„å‡½æ•°handleChange e.preventDefault() let target = event.target let files = target.files let count = this.state.multiple ? files.length : 1 for (let i = 0; i &lt; count; i++) { files[i].thumb = URL.createObjectURL(files[i]) } // è½¬æ¢ä¸ºçœŸæ­£çš„æ•°ç»„ files = Array.prototype.slice.call(files, 0) // è¿‡æ»¤éå›¾ç‰‡ç±»å‹çš„æ–‡ä»¶ files = files.filter(function (file) { return /image/i.test(file.type) }) å¤„ç†æ‹–æ‹½è¿›æ¥çš„æ–‡ä»¶ï¼š handleDrop(e) { this.setState({progress:[]}) this.handleDragHover(e) // è·å–æ–‡ä»¶åˆ—è¡¨å¯¹è±¡ let files = e.target.files || e.dataTransfer.files let count = this.state.multiple ? files.length : 1 for (let i = 0; i &lt; count; i++) { files[i].thumb = URL.createObjectURL(files[i]) } // è½¬æ¢ä¸ºçœŸæ­£çš„æ•°ç»„ files = Array.prototype.slice.call(files, 0) // è¿‡æ»¤éå›¾ç‰‡ç±»å‹çš„æ–‡ä»¶ files = files.filter(function (file) { return /image/i.test(file.type) }) this.setState({files: this.state.files.concat(files)}) } ä¸Šä¼ å‡½æ•° upload(file, idx) { return new Promise((resolve, reject) => { let xhr = new XMLHttpRequest() if (xhr.upload) { // ä¸Šä¼ ä¸­ xhr.upload.addEventListener(\"progress\", (e) => { // å¤„ç†ä¸Šä¼ è¿›åº¦ this.handleProgress(file, e.loaded, e.total, idx); }, false) // æ–‡ä»¶ä¸Šä¼ æˆåŠŸæˆ–æ˜¯å¤±è´¥ xhr.onreadystatechange = (e) => { if (xhr.readyState === 4) { if (xhr.status === 200) { // ä¸Šä¼ æˆåŠŸæ“ä½œ this.handleSuccess(file, xhr.responseText) // æŠŠè¯¥æ–‡ä»¶ä»ä¸Šä¼ é˜Ÿåˆ—ä¸­åˆ é™¤ this.handleDeleteFile(file) resolve(xhr.responseText); } else { // ä¸Šä¼ å‡ºé”™å¤„ç† this.handleFailure(file, xhr.responseText) reject(xhr.responseText); } } } // å¼€å§‹ä¸Šä¼  xhr.open(\"POST\", this.state.uri, true) let form = new FormData() form.append(\"filedata\", file) xhr.send(form) }) } åªæ˜¯ä¸Šçœ‹äº†å¥½å¤šç¯‡æ–‡ç« ï¼Œä»–ä»¬å¯¹äºä¸Šä¼ å›¾ç‰‡çš„è¯·æ±‚å¥½å¤šéƒ½æ˜¯ç›´æ¥ç”¨åŸç”Ÿxhræ¥å†™ï¼Œè€Œä¸”åŸå£°xhrä¹Ÿæœ‰è‡ªå¸¦çš„ä¸Šä¼ ç»ˆæ­¢åŠŸèƒ½ï¼ˆabortï¼‰ ä¿®æ”¹è¯·æ±‚å¤´åœ¨ä¸Šä¼ çš„æ—¶å€™å¦‚æœè¯·æ±‚çš„æ•°æ®æ ¼å¼æœ‰ç‚¹é—®é¢˜ï¼Œå¯ä»¥è°ƒæ•´ä¸€ä¸‹è¯·æ±‚å¤´å†å‘è¯·æ±‚ï¼Œæ¯”å¦‚ï¼š let config = { headers:{'Content-Type':'multipart/form-data'} }; //æ·»åŠ è¯·æ±‚å¤´ this.axios.post('http://upload.qiniu.com/',param,config) .then(response=>{ console.log(response.data); }) å‚è€ƒï¼š å‰ç«¯å›¾ç‰‡ä¸Šä¼ é‚£äº›äº‹å„¿ React å®ç°å›¾ç‰‡ä¸Šä¼ å’Œå±•ç¤ºåŠŸèƒ½ åŸºäºNodeçš„Reactå›¾ç‰‡ä¸Šä¼ ç»„ä»¶å®ç°","categories":[{"name":"å‰ç«¯","slug":"å‰ç«¯","permalink":"https://taylor12138.github.io/categories/%E5%89%8D%E7%AB%AF/"}],"tags":[],"author":"Hello"},{"title":"React(ä¸‹)","slug":"React(ä¸‹)","date":"2022-07-02T15:33:04.139Z","updated":"2022-10-28T02:34:34.017Z","comments":true,"path":"2022/07/02/react-xia/","link":"","permalink":"https://taylor12138.github.io/2022/07/02/react-xia/","excerpt":"","text":"11.HooksReactçš„Hook æ˜¯ 16.8ç‰ˆæœ¬æ–°å¢çš„ç‰¹æ€§/è¯­æ³•ï¼Œå¯ä»¥è®©æˆ‘ä»¬åœ¨å‡½æ•°å¼ç»„ä»¶ä¸­ä½¿ç”¨stateå’Œå…¶ä»–Reactç‰¹æ€§ å‡½æ•°å¼ç»„ä»¶æœ€ä¸»è¦æ²¡æœ‰ä¸Šè¿°åŠŸèƒ½çš„åŸå› æ˜¯æ²¡æœ‰å®ä¾‹å¯¹è±¡ï¼Œæ²¡æœ‰thisï¼ˆç°åœ¨å‡½æ•°å¼ç»„ä»¶æ˜¯ä¸»æµäº†ï¼‰ Hookä¸»è¦æ˜¯è·µè¡Œä»£æ•°æ•ˆåº”çš„æ€æƒ³ï¼ˆæ¯”å¦‚ä¸ä½¿ç”¨asyncå¤„ç†æ­£å¸¸çš„å‡½æ•°ï¼ˆå› ä¸ºå›å°†è¯¥å‡½æ•°å˜æˆä¸€ä¸ªpromiseï¼‰ï¼Œè€Œæ˜¯è‡ªå®šä¹‰è¯­æ³•ä»¥tryã€catchçš„ç†å¿µå°†å‡½æ•°å†…éƒ¨æ‰§è¡Œçš„æ— è®ºåŒæ­¥ã€å¼‚æ­¥æ“ä½œå‰¥ç¦»å‡ºå‡½æ•°æœ¬èº«ï¼‰ï¼Œé•¿æ­¤ä»¥å¾€ï¼Œå¯èƒ½å¯ä»¥å½¢æˆæœåŠ¡å³ç»„ä»¶çš„ç»“æœï¼Œä»ä¸åŒæ•°æ®åº“ï¼Œå³ä¸åŒçš„æºè·å–ï¼Œå¯¹åº”ä¸åŒçš„å•ç‹¬ç»„ä»¶ ä¸‰ä¸ªå¸¸ç”¨çš„Hook State Hookï¼šReact.useState()ï¼Œè®©æˆ‘ä»¬æ˜¯ä½¿ç”¨state const [xxx, setXxx] = React.useState(initValue) å‚æ•°: ç¬¬ä¸€æ¬¡åˆå§‹åŒ–æŒ‡å®šçš„å€¼åœ¨å†…éƒ¨ä½œç¼“å­˜ è¿”å›å€¼: åŒ…å«2ä¸ªå…ƒç´ çš„æ•°ç»„, ç¬¬1ä¸ªä¸ºå†…éƒ¨å½“å‰çŠ¶æ€å€¼, ç¬¬2ä¸ªä¸ºæ›´æ–°çŠ¶æ€å€¼çš„å‡½æ•° Effect Hookï¼šReact.useEffect()ï¼Œè®©æˆ‘ä»¬ä½¿ç”¨ç”Ÿå‘½å‘¨æœŸå‡½æ•° useEffect(fn, [stateValue]) æ ¹æ®stateValueæ•°ç»„çš„èŒƒå›´ï¼Œå¯åˆ’åˆ† componentDidMount()ã€componentDidUpdate()ä¸¤ç§ç”Ÿå‘½å‘¨æœŸå‡½æ•°ï¼ŒstateValueä¸ºç›‘å¬çš„state fnæ˜¯ä½œä¸ºä»¥ä¸Šä¸¤ç§ç”Ÿå‘½å‘¨æœŸå‡½æ•°è¿›å…¥è¯¥å‘¨æœŸæ‰§è¡Œçš„å›è°ƒå‡½æ•°ã€‚ fnå¯ä»¥å†è¿”å›ä¸€ä¸ªå‡½æ•°fn2ï¼Œfnæ˜¯ä½œä¸ºcomponentWillUnmount()è¿™ä¸ªç”Ÿå‘½å‘¨æœŸå‡½æ•° ç»¼ä¸Šæ‰€è¿°ï¼Œå¯ä»¥æŠŠ useEffect Hook çœ‹åšå¦‚ä¸‹ä¸‰ä¸ªå‡½æ•°çš„ç»„åˆ`componentDidMount()` `componentDidUpdate()` `componentWillUnmount()` Ref Hookï¼šReact.useRef() const refContainer = useRef() State Hookä½¿ç”¨ç¤ºèŒƒ import React from 'react' // è¿™ä¸ªdemoå‡½æ•°è°ƒç”¨æ¬¡æ•° = renderæ¬¡æ•° function Demo() { // ä¿å­˜çŠ¶æ€å’Œæ›´æ–°çŠ¶æ€çš„æ–¹æ³•ï¼Œéƒ½è‡ªå®šä¹‰åå­— const [count, setCount] = React.useState(0); const [NewArr, setArr] = React.useState([0]); function add() { // ç¬¬ä¸€ç§å†™æ³•ï¼Œé€‚ç”¨äºæ”¹å˜ä¸€æ¬¡çš„æƒ…å†µ setCount(count + 1); // ç¬¬äºŒç§å†™æ³•ï¼Œé€‚ç”¨äºä¸æ–­æ”¹å˜çš„æƒ…å†µï¼Œæ¯”å¦‚å®šæ—¶å™¨ï¼Œæ­¤æ—¶countæ€»èƒ½è·å–åˆ°ä¸Šæ¬¡çŠ¶æ€è®¾ç½®å¥½çš„count // setCount(count => count+1) // setCount(preState => preState+1) æ›´å®¹æ˜“ç†è§£ } function addArr() { setArr([NewArr.length, ...NewArr]) } return ( &lt;div> &lt;h2>å½“å‰çš„Countä¸ºï¼š{count}&lt;/h2> &lt;button onClick={add}>+1&lt;/button> &lt;button onClick={addArr}>ä¸ºæ•°ç»„æ·»åŠ æ•°æ®&lt;/button> å½“å‰æ•°ç»„ï¼š&lt;ul>{ NewArr.map((item, index) => { return ( &lt;li key={index}>{item}&lt;/li> ) }) } &lt;/ul> &lt;/div> ) } export default Demo; Ref Hook ç¤ºèŒƒ function Demo() { // æ„Ÿè§‰å’Œç±»å¼ç»„ä»¶çš„createRefå·®ä¸å¤š const myRef = React.useRef(); function show() { alert(myRef.current.value); } return ( &lt;div> &lt;input type=\"text\" ref={myRef} /> &lt;button onClick={show}>tip&lt;/button> &lt;/div> ) } refå¯ä»¥çœ‹æˆfiberä¸­éé“¾è¡¨å½¢å¼ï¼Œè€Œæ˜¯å•çº¯ä½œä¸ºä¸€ä¸ªä¸ªä½“å­˜å‚¨çš„hookå¯¹è±¡ const hook = workInProgressHook(); //workInProgresså¯ä»¥ç†è§£æˆå½“å‰fiberçš„æš‚å­˜åŒº hook.memoizedState = {current: initialValue} useEffectEffect Hook ç¤ºèŒƒ // æ€»è§‰å¾—æœ‰ç‚¹åƒvueé‡Œçš„watch //ç¬¬ä¸€ä¸ªå‚æ•°ç›¸å½“äºä¸¤ä¸ªé’©å­ï¼Œä¸€ä¸ªæ˜¯DidMountã€ä¸€ä¸ªæ˜¯DidUpdate React.useEffect(() => { let timer = setInterval(() => { setCount(count => count + 1); }, 1000); return () => { //ç»„ä»¶å¸è½½å‰æ‰§è¡Œï¼Œç›¸å½“äºcomponentWillUnmountï¼Œå¯ä»¥æ‰§è¡Œæ¯”å¦‚æ¸…é™¤å®šæ—¶å™¨ï¼Œå–æ¶ˆè®¢é˜…ç­‰æ“ä½œ clearInterval(timer); } }, []) //è¿™é‡Œä¼ å…¥ç©ºæ•°ç»„ï¼Œå¯ä»¥å½“ä½œcomponentDidMountæ¥ä½¿ç”¨ // React.useEffect(() => { // // do something // }, [count]) åªç›‘æµ‹countçš„å˜åŒ–ï¼Œæœ‰ç‚¹åƒéš¶å±äºcountçš„watcherï¼Œå¦‚æœç¬¬äºŒä¸ªå‚æ•°ä¸ä¼ å…¥ï¼Œåˆ™å…¨éƒ¨stateéƒ½ç›‘å¬ ç¬¬ä¸€ä¸ªå‚æ•°è¿”å›å€¼æ˜¯ä¸€ä¸ªæ¸…é™¤å‡½æ•°ï¼Œä¸ºé˜²æ­¢å†…å­˜æ³„æ¼ï¼Œæ¸…é™¤å‡½æ•°ä¼šåœ¨ç»„ä»¶å¸è½½å‰æ‰§è¡Œã€‚å¦å¤–ï¼Œå¦‚æœç»„ä»¶å¤šæ¬¡æ¸²æŸ“ï¼ˆé€šå¸¸å¦‚æ­¤ï¼‰ï¼Œåˆ™åœ¨æ‰§è¡Œä¸‹ä¸€ä¸ª effect ä¹‹å‰ï¼Œä¸Šä¸€ä¸ª effect å°±å·²è¢«æ¸…é™¤ å…¶ä¸­ç¬¬äºŒä¸ªå‚æ•°ä¸ºä¾èµ–æ•°ç»„ï¼Œæ¯æ¬¡éƒ½ä¼šè¿›è¡Œâ€œæµ…æ¯”è¾ƒâ€ï¼ˆObject.js()ï¼‰ï¼Œåˆ¤æ–­æ˜¯å¦é‡æ–°æ¸²æŸ“ å¯¹äºHookçš„ç†è§£ä¸èƒ½åªåœç•™åœ¨è¿™ç§æ¡Œé¢ä¸Šå¯¹äºå‘¨æœŸå‡½æ•° -&gt; useEffectï¼Œæ›´è¦å¿ƒé¢†ç¥ä¼šï¼Œå¿˜è®°ä¹‹å‰æ‰€å­¦çš„â€œç”Ÿå‘½å‘¨æœŸâ€ï¼Œä»–ä»¬è¿˜æ˜¯æœ‰å¾ˆå¤šä¸åŒä¹‹å¤„çš„ï¼Œ æ¯”å¦‚ useEffect ç›´æ¥ä½¿ç”¨stateã€propsï¼Œä¼šæ•è·åˆ° â€œåˆå§‹çš„ propså’Œstateâ€ï¼ˆå½“å‰æ¸²æŸ“çŠ¶æ€/ æ¬¡æ•°ä¸‹çš„propså’Œstateï¼‰ï¼Œè€Œåœ¨useEffectä¸­ä½¿ç”¨useRefå¯ä»¥è·å–åˆ°æœ€æ–°çš„æ•°æ®ä¹‹ç±»çš„ã€‚ ä¸‹é¢è¿™ç¯‡æ–‡ç« å¯ä»¥å¸®åŠ©å¤§å®¶åŠ æ·±React Hookçš„å°è±¡https://overreacted.io/zh-hans/a-complete-guide-to-useeffect/ åœ¨renderé˜¶æ®µè¿›å…¥åˆ°commité˜¶æ®µçš„æ—¶å€™ï¼Œä¼šé€šè¿‡ä¸€ç§è¢«ç§°ä¸ºEffectï¼ˆFlagsï¼‰çš„æ•°æ®ç»“æ„ æ’å…¥DOM -&gt; fiberèŠ‚ç‚¹ä¸Šå¢åŠ Placementçš„effect æ›´æ–°DOM -&gt; fiberèŠ‚ç‚¹ä¸Šå¢åŠ Updateçš„effect åˆ é™¤DOM -&gt; fiberèŠ‚ç‚¹ä¸Šå¢åŠ Deletionçš„effect æ›´æ–°Ref -&gt; fiberèŠ‚ç‚¹ä¸Šå¢åŠ Refçš„effect useEffectå›è°ƒæ‰§è¡Œ -&gt; fiberèŠ‚ç‚¹ä¸Šå¢åŠ Passiveçš„effect ç„¶ååœ¨renderé˜¶æ®µ -&gt; commité˜¶æ®µçš„æ—¶å€™ï¼Œä¼šä¼ é€’ä¸€æ¡effecté“¾è¡¨ï¼Œé‡Œé¢å¯èƒ½åŒ…å«äº†Placementã€Passiveç­‰ commité˜¶æ®µå¤„ç†é“¾è¡¨ä¸Šçš„æ¯ä¸ªeffect commité˜¶æ®µæœ‰ä¸‰ä¸ªå°æ®µï¼š 1.beforeMutationé˜¶æ®µ 2.mutationé˜¶æ®µ 3.layouté˜¶æ®µ useEffectå’Œç”Ÿå‘½å‘¨æœŸå‡½æ•°çš„åŒºåˆ« Placement -&gt; ï¼ˆmutationé˜¶æ®µï¼‰æ–°å¢DOMèŠ‚ç‚¹ï¼Œä½¿ç”¨appendChildæ–¹æ³•ï¼Œç„¶åå†layouté˜¶æ®µè°ƒç”¨componentDidmountï¼ˆåŒæ­¥ï¼‰ Passive -&gt; åœ¨ä»¥ä¸Šä¸‰ä¸ªå­é˜¶æ®µéƒ½æ‰§è¡Œå®Œæ¯•åï¼Œå¼‚æ­¥è°ƒç”¨æˆ‘ä»¬çš„useEffectå›è°ƒ æ­¤æ—¶æˆ‘ä»¬å¯ä»¥æ˜¯ç”¨useLayoutEffect(fn, [])ï¼Œé‚£æ•ˆæœå°±å’Œç”Ÿå‘½å‘¨æœŸå‡½æ•°ä¸€æ ·äº†ï¼Œéƒ½åœ¨layouté˜¶æ®µè°ƒç”¨ï¼ˆuseLayoutEffect å†…éƒ¨çš„æ›´æ–°è®¡åˆ’å°†è¢«åŒæ­¥åˆ·æ–°ã€‚ï¼‰ æ‘˜å½•è‡ªReactæ–‡æ¡£effect çš„æ‰§è¡Œæ—¶æœº (opens new window)ï¼š ä¸ componentDidMountã€componentDidUpdate ä¸åŒçš„æ˜¯ï¼Œåœ¨æµè§ˆå™¨å®Œæˆå¸ƒå±€ä¸ç»˜åˆ¶ä¹‹åï¼Œä¼ ç»™ useEffect çš„å‡½æ•°ä¼šå»¶è¿Ÿè°ƒç”¨ã€‚è¿™ä½¿å¾—å®ƒé€‚ç”¨äºè®¸å¤šå¸¸è§çš„å‰¯ä½œç”¨åœºæ™¯ï¼Œæ¯”å¦‚è®¾ç½®è®¢é˜…å’Œäº‹ä»¶å¤„ç†ç­‰æƒ…å†µï¼Œå› æ­¤ä¸åº”åœ¨å‡½æ•°ä¸­æ‰§è¡Œé˜»å¡æµè§ˆå™¨æ›´æ–°å±å¹•çš„æ“ä½œã€‚ å¯è§ï¼ŒuseEffectå¼‚æ­¥æ‰§è¡Œçš„åŸå› ä¸»è¦æ˜¯é˜²æ­¢åŒæ­¥æ‰§è¡Œæ—¶é˜»å¡æµè§ˆå™¨æ¸²æŸ“ã€‚ useLayoutEffectå®˜æ–¹çš„æ¨èä½¿ç”¨æ—¶æœºï¼š å¦‚æœä½ æ­£åœ¨å°†ä»£ç ä» class ç»„ä»¶è¿ç§»åˆ°ä½¿ç”¨ Hook çš„å‡½æ•°ç»„ä»¶ï¼Œåˆ™éœ€è¦æ³¨æ„ useLayoutEffect ä¸ componentDidMountã€componentDidUpdate çš„è°ƒç”¨é˜¶æ®µæ˜¯ä¸€æ ·çš„ã€‚ä½†æ˜¯ï¼Œæˆ‘ä»¬æ¨èä½ ä¸€å¼€å§‹å…ˆç”¨ useEffectï¼Œåªæœ‰å½“å®ƒå‡ºé—®é¢˜çš„æ—¶å€™å†å°è¯•ä½¿ç”¨ useLayoutEffectã€‚ æ‰€ä»¥æˆ‘ä»¬å¯ä»¥çœ‹åˆ°useEffect å¹¶ä¸ç­‰ä»·äº componentDidMoutï¼Œè€ŒuseLayoutEffect æ‰æ˜¯ä¸ componentDidMount ç­‰ä»· useEffect å’Œ useLayoutEffectçš„å·®å¼‚ useEffect æ˜¯å¼‚æ­¥æ‰§è¡Œçš„ï¼Œè€ŒuseLayoutEffectæ˜¯åŒæ­¥æ‰§è¡Œçš„ã€‚ï¼ˆæ‰€ä»¥è®¾è®¡åˆ°æ¸²æŸ“æ“ä½œæ”¾åˆ°useLayoutEffecté‡Œé¢å»ï¼‰ useEffect çš„æ‰§è¡Œæ—¶æœºæ˜¯æµè§ˆå™¨å®Œæˆæ¸²æŸ“ä¹‹åï¼Œè€Œ useLayoutEffect çš„æ‰§è¡Œæ—¶æœºæ˜¯æµè§ˆå™¨æŠŠå†…å®¹çœŸæ­£æ¸²æŸ“åˆ°ç•Œé¢ä¹‹å‰ï¼Œå’Œ componentDidMount ç­‰ä»·ã€‚ å¦‚æœä½¿ç”¨æœåŠ¡ç«¯æ¸²æŸ“ï¼Œä½¿ç”¨ useLayoutEffect å¯èƒ½ä¼šå¯¼è‡´å®é™…æ¸²æŸ“æ•ˆæœå’ŒæœåŠ¡ç«¯æ¸²æŸ“åˆè¡·ä¸ä¸€è‡´ å‚è€ƒé“¾æ¥ https://zhuanlan.zhihu.com/p/348701319 React Hookä¹¦å†™ä¹ æƒ¯ï¼ˆBorrowed by Robin Wieruchï¼Œwho is famous in GitHubï¼‰ åœ¨useEffectä¸­è°ƒç”¨å¼‚æ­¥è¯·æ±‚æ—¶ï¼Œé¡ºä¾¿åœ¨useEffectä¸­å®šä¹‰å¼‚æ­¥è¯·æ±‚ï¼Œå¦‚ä¸‹ï¼ˆä½¿ç”¨ try/catch å—è¿›è¡Œé”™è¯¯å¤„ç†ï¼‰ useEffect(() => { const fetchData = async () => { try{ const result = await axios( 'https://hn.algolia.com/api/v1/search?query=redux', ); setData(result.data); } catch { //.... } fetchData(); }, []); ç”±äºæŒ‚é’©ä¸åº”è¿”å›ä»»ä½•å†…å®¹æˆ–æ¸…ç†å‡½æ•°ï¼Œè€Œasync å‡½æ•°è¿”å›ä¸€ä¸ªAsyncFunctionå¯¹è±¡ï¼Œæ‰€ä»¥ä»¥ä¸‹å†™æ³•ä¸ºé”™è¯¯çš„ Ã— //é”™è¯¯ç¤ºèŒƒ Ã— useEffect(async () => { const result = await axios( 'https://hn.algolia.com/api/v1/search?query=redux', ); setData(result.data); }, []); ä¸€èˆ¬å»ºè®®æŠŠä¸ä¾èµ–propså’Œstateçš„å‡½æ•°æåˆ°ä½ çš„ç»„ä»¶å¤–é¢ï¼Œå¹¶ä¸”æŠŠé‚£äº›ä»…è¢«effectä½¿ç”¨çš„å‡½æ•°æ”¾åˆ°effecté‡Œé¢ã€‚ å¦‚æœeffectè¦ç”¨åˆ°å¤–é¢çš„å‡½æ•°ï¼ˆä¸åœ¨effectä¸­å®šä¹‰çš„å‡½æ•°ï¼‰ å¦‚æœä¸€ä¸ªå‡½æ•°æ²¡æœ‰ä½¿ç”¨ç»„ä»¶å†…çš„ä»»ä½•å€¼ï¼Œä½ åº”è¯¥æŠŠå®ƒæåˆ°ç»„ä»¶å¤–é¢å»å®šä¹‰ï¼Œç„¶åå°±å¯ä»¥è‡ªç”±åœ°åœ¨effectsä¸­ä½¿ç”¨ ä¹Ÿå¯ä»¥åœ¨å®šä¹‰è¿™äº›å‡½æ•°çš„åœ°æ–¹ç”¨useCallbackåŒ…ä¸€å±‚ å‡ºç°æ— é™é‡å¤è¯·æ±‚çš„é—®é¢˜ï¼š æ²¡æœ‰è®¾ç½®effectä¾èµ–å‚æ•°ï¼ˆä½ è‡³å°‘ä¹Ÿè®¾ç½®ä¸€ä¸ªç©ºæ•°ç»„[] ï¼Œå¦‚æœæ²¡æœ‰çš„è¯ä¸ªäººæ„Ÿè§‰æœ‰ç‚¹åƒè¿›å…¥åˆ°ç±»å¼ç»„ä»¶çš„rednerä¸­ï¼‰ æ— é™å¾ªç¯çš„å‘ç”Ÿä¹Ÿå¯èƒ½æ˜¯å› ä¸ºä½ è®¾ç½®çš„ä¾èµ–æ€»æ˜¯ä¼šæ”¹å˜ ä¸è¦å¯¹ä¾èµ–é¡¹è¿›è¡Œæ’’è°ï¼Œeffectä¸­ç”¨åˆ°çš„æ‰€æœ‰ç»„ä»¶å†…çš„å€¼éƒ½è¦åŒ…å«åœ¨ä¾èµ–ä¸­ã€‚è¿™åŒ…æ‹¬propsï¼Œstateï¼Œå‡½æ•° â€” ç»„ä»¶å†…çš„ä»»ä½•ä¸œè¥¿ã€‚ï¼ˆè™½ç„¶æœ‰æ—¶å¯èƒ½å¯¼è‡´æ­»å¾ªç¯ï¼Œä½†æ˜¯è§£å†³æ–¹æ³•ä¸æ˜¯ç§»é™¤ä¾èµ–é¡¹ï¼â€”â€”å‰ç«¯å¤§å¸ˆ Danè¯´åˆ°ï¼‰ function SearchResults() { async function fetchData() { // ... } useEffect(() => { fetchData(); }, []); // Is this okay? Not always -- and there's a better way to write it. // ... } å¦‚æœå¯¼è‡´æ­»å¾ªç¯ï¼Œä¹Ÿå°±æ˜¯ä¾èµ–é¡¹åœ¨Effectä¸­è¢«æ”¹åŠ¨ï¼Œè¯¥å¦‚ä½•æ˜¯å¥½ï¼Ÿ è®©Effectå‡å°‘ä¾èµ–é¡¹ï¼Œä»”ç»†æ€è€ƒä¸€ä¸‹ï¼Œæˆ‘ä»¬çœŸçš„éœ€è¦åœ¨Effectä¸­æ—¶ç”¨åˆ°è¿™ä¸ªä¾èµ–é¡¹å—ï¼Ÿå‡å°‘â€œé”™è¯¯ä¾èµ–â€çš„äº§ç”Ÿï¼Œå·§ç”¨ setCount(c =&gt; c+1)ï¼Œä¹Ÿå°±æ˜¯è¿™ç§å‡½æ•°çš„å½¢å¼ï¼Œå‡å°‘ä¾èµ–é¡¹ å¤„ç†stateä¸­å‡ºç°ç›¸äº’ä¾èµ–çš„å…³ç³»æ—¶ï¼Œæ¯”å¦‚ setCount(c =&gt; c + step);ï¼ˆstepæ˜¯ä¸€ç§çŠ¶æ€ï¼‰ï¼Œæ­¤æ—¶ä¾èµ–é¡¹è¦æ·»åŠ ä¸Šstepï¼Œæ¶ˆé™¤è¿™ä¸ªä¾èµ–é¡¹æˆ‘ä»¬å¯ä»¥ä½¿ç”¨useReducerï¼ æŠ€æœ¯å‚è€ƒï¼šhttps://overreacted.io/zh-hans/a-complete-guide-to-useeffect/ è‡ªå®šä¹‰hookè‡ªå®šä¹‰ Hook æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œå…¶åç§°ä»¥ â€œuseâ€ å¼€å¤´ï¼Œå‡½æ•°å†…éƒ¨å¯ä»¥è°ƒç”¨å…¶ä»–çš„ Hookï¼ˆå®è´¨ä¸Šè‡ªå®šä¹‰hookä¹Ÿæˆ‘ä»¬å¹³æ—¶ä½¿ç”¨å‡½æ•°å¤ç”¨ç›¸åŒé€»è¾‘çš„ä»£ç æ˜¯ä¸€æ ·çš„ï¼Œåªæ˜¯è‡ªå®šä¹‰hookè¿™ä¸ªå‡½æ•°é‡Œé¢æˆ‘ä»¬å¯ä»¥è°ƒç”¨å…¶ä»–çš„hookï¼Œæ¯”å¦‚State Hookã€Effect Hookç­‰ï¼‰ Reactå®˜æ–¹ç¤ºä¾‹ import { useState, useEffect } from 'react'; function useFriendStatus(friendID) { const [isOnline, setIsOnline] = useState(null); useEffect(() => { function handleStatusChange(status) { setIsOnline(status.isOnline); } ChatAPI.subscribeToFriendStatus(friendID, handleStatusChange); return () => { ChatAPI.unsubscribeFromFriendStatus(friendID, handleStatusChange); }; }); return isOnline; } å®ƒå°±åƒä¸€ä¸ªæ­£å¸¸çš„å‡½æ•°ã€‚ä½†æ˜¯å®ƒçš„åå­—åº”è¯¥å§‹ç»ˆä»¥ use å¼€å¤´ï¼Œè¿™æ ·å¯ä»¥ä¸€çœ¼çœ‹å‡ºå…¶ç¬¦åˆ Hook çš„è§„åˆ™ã€‚ åœ¨React å‡½æ•°ä¸­ä½¿ç”¨ï¼ˆåˆ†åˆ«åœ¨ä¸¤ä¸ªç»„ä»¶ä¸­ä½¿ç”¨ç›¸åŒçš„é€»è¾‘ä»£ç ï¼‰ function FriendStatus(props) { const isOnline = useFriendStatus(props.friend.id); if (isOnline === null) { return 'Loading...'; } return isOnline ? 'Online' : 'Offline'; } function FriendListItem(props) { const isOnline = useFriendStatus(props.friend.id); return ( &lt;li style={{ color: isOnline ? 'green' : 'black' }}> {props.friend.name} &lt;/li> ); } å®˜æ–¹çš„é—®é¢˜å›ç­”ï¼š åœ¨ä¸¤ä¸ªç»„ä»¶ä¸­ä½¿ç”¨ç›¸åŒçš„ Hook ä¼šå…±äº« state å—ï¼Ÿä¸ä¼šã€‚è‡ªå®šä¹‰ Hook æ˜¯ä¸€ç§é‡ç”¨çŠ¶æ€é€»è¾‘çš„æœºåˆ¶ï¼Œä»–ä»¬çš„stateæ˜¯ç›¸äº’éš”ç¦»çš„ useReduceruseReduceræ˜¯useStateçš„æ›¿ä»£æ–¹æ¡ˆ const [state, dispatch] = useReducer(reducer, initialArg, init); åœ¨æŸäº›åœºæ™¯ä¸‹ï¼ŒuseReducer ä¼šæ¯” useState æ›´é€‚ç”¨ï¼Œä¾‹å¦‚ state é€»è¾‘è¾ƒå¤æ‚ä¸”åŒ…å«å¤šä¸ªå­å€¼ï¼Œæˆ–è€…ä¸‹ä¸€ä¸ª state ä¾èµ–äºä¹‹å‰çš„ state ç­‰ã€‚æ‰€ä»¥å½“ä½ å†™ç±»ä¼¼setSomething(something =&gt; ...)è¿™ç§ä»£ç çš„æ—¶å€™ï¼Œä¹Ÿè®¸å°±æ˜¯è€ƒè™‘ä½¿ç”¨reducerçš„å¥‘æœº å½“ä½ æƒ³æ›´æ–°ä¸€ä¸ªçŠ¶æ€ï¼Œå¹¶ä¸”è¿™ä¸ªçŠ¶æ€æ›´æ–°ä¾èµ–äºå¦ä¸€ä¸ªçŠ¶æ€ï¼ˆéè‡ªèº«çŠ¶æ€ï¼‰çš„å€¼æ—¶ï¼Œä½ å¯èƒ½éœ€è¦ç”¨useReducerå»æ›¿æ¢å®ƒä»¬ã€‚ å®˜ç½‘çš„ä½¿ç”¨ç¤ºä¾‹ const initialState = {count: 0}; function reducer(state, action) { switch (action.type) { case 'increment': return {count: state.count + 1}; case 'decrement': return {count: state.count - 1}; default: throw new Error(); } } function Counter() { const [state, dispatch] = useReducer(reducer, initialState); return ( &lt;> Count: {state.count} &lt;button onClick={() => dispatch({type: 'decrement'})}>-&lt;/button> &lt;button onClick={() => dispatch({type: 'increment'})}>+&lt;/button> &lt;/> ); } ä»æ­¤ä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œæ˜¯æœ‰ç‚¹ç±»ä¼¼äºreduxçš„æ¨¡å¼ ä¸ºä»€ä¹ˆç”¨dispatchæ›¿æ¢ä¾èµ–é¡¹ä¼šæ›´å¥½ï¼ŸReactä¼šä¿è¯dispatchåœ¨ç»„ä»¶çš„å£°æ˜å‘¨æœŸå†…ä¿æŒä¸å˜ã€‚ è¿™å°±æ˜¯dispatchçš„å¥½å¤„ä¹‹ä¸€ï¼Œ dispatch ä¸ä¼šéšç€ re-render è€Œé‡æ–°åˆ†é…è®°å¿†ä½ç½®ï¼ˆä»–ä¼šæš‚æ—¶è®°å¿†ï¼‰ï¼Œåœ¨ä½œä¸º props ä¼ å…¥åˆ° child component çš„æ—¶å€™ä¹Ÿå¯ä»¥ä¸ç”¨æ‹…å¿ƒæ²¡æœ‰ useMemo è€Œé€ æˆ re-render çš„é—®é¢˜ã€‚ åœ¨ä¸‹é¢çš„ä¾‹å­ä¸­æˆ‘ä»¬ä¸å†é‡æ–°è®¢é˜…å®šæ—¶å™¨ï¼ˆidï¼‰ ï¼ˆæ­£å¸¸æƒ…å†µä¸‹ä½¿ç”¨useEffectè®¢é˜…å®šæ—¶å™¨ï¼Œå½“stepä¾èµ–é¡¹å‘ç”Ÿæ”¹å˜æ—¶ï¼Œå®šæ—¶å™¨å°†ä¼šè¢«é‡æ–°è®¢é˜…ï¼›åè§‚ä½¿ç”¨dispatchï¼Œåœ¨å®šæ—¶å™¨å¼€å¯åï¼Œå¦‚æœstepå‘ç”Ÿæ”¹å˜ï¼Œå®šæ—¶å™¨ä¸ä¼šè¢«é‡æ–°æ¸²æŸ“ï¼Œè€Œæ˜¯é‡‡ç”¨ä¹‹å‰çš„stepï¼‰ import React, { useReducer, useEffect } from \"react\"; import ReactDOM from \"react-dom\"; function Counter() { const [state, dispatch] = useReducer(reducer, initialState); const { count, step } = state; useEffect(() => { const id = setInterval(() => { dispatch({ type: 'tick' }); }, 1000); return () => clearInterval(id); }, [dispatch]); return ( &lt;> &lt;h1>{count}&lt;/h1> &lt;input value={step} onChange={e => { dispatch({ type: 'step', step: Number(e.target.value) }); }} /> &lt;/> ); } const initialState = { count: 0, step: 1, }; function reducer(state, action) { const { count, step } = state; if (action.type === 'tick') { return { count: count + step, step }; } else if (action.type === 'step') { return { count, step: action.step }; } else { throw new Error(); } } ï¼ˆä½ å¯ä»¥ä»ä¾èµ–ä¸­å»é™¤dispatch, setState, å’ŒuseRefåŒ…è£¹çš„å€¼å› ä¸ºReactä¼šç¡®ä¿å®ƒä»¬æ˜¯é™æ€çš„ã€‚ä¸è¿‡ä½ è®¾ç½®äº†å®ƒä»¬ä½œä¸ºä¾èµ–ä¹Ÿæ²¡ä»€ä¹ˆé—®é¢˜ã€‚ï¼‰ å°çŸ¥è¯†ï¼šuseStateåº•å±‚ä¹Ÿæ˜¯ä½¿ç”¨useReducerå®ç°çš„ export function useState&lt;S>( initialState: (() => S) | S, ): [S, Dispatch&lt;BasicStateAction&lt;S>>] { return useReducer( basicStateReducer, // useReducer has a special case to support lazy useState initializers (initialState: any), ); } function basicStateReducer&lt;S>(state: S, action: BasicStateAction&lt;S>): S { return typeof action === 'function' ? action(state) : action; } useStateå°Demoæºè‡ªé­”æœ¯å¸ˆå¡é¢‚ï¼‰ let isMount = true; let workInProgressHook = null; const fiber = { stateNode: App, memoizedState: null //ä¿å­˜Appé‡Œé¢çš„state } function schedule() { workInProgressHook = fiber.memoizedState; //åˆå§‹åŒ–ï¼Œå¾—åˆ°stateçš„è¡¨å¤´ const app = fiber.stateNode(); isMount = false; return app; } function useState(initialState) { let hook; //hookä½œä¸ºä¸€ä¸ªé“¾è¡¨ if (isMount) { hook = { memoizedState: initialState, next: null, queue: { pending: null } } if (!fiber.memoizedState) { fiber.memoizedState = hook } else { workInProgressHook.next = hook; } workInProgressHook = hook; } else { hook = workInProgressHook; workInProgressHook = workInProgressHook.next; } let baseState = hook.memoizedState; if (hook.queue.pending) { let firstUpdate = hook.queue.pending.next; do { const action = firstUpdate.action; baseState = action(baseState); firstUpdate = firstUpdate.next; } while (firstUpdate !== hook.queue.pending.next) hook.queue.pending = null; } hook.memoizedState = baseState; return [baseState, dispatchAction.bind(null, hook.queue)]; } function dispatchAction(queue, action) { const update = { //ä½œä¸ºä¸€ä¸ªç¯çŠ¶é“¾è¡¨ action, next: null } if (queue.pending === null) { update.next = update } else { update.next = queue.pending.next; //è®©update.nextæŒ‡å‘é˜Ÿå¤´ queue.pending.next = update; //è®©å½“å‰updateæˆä¸ºé˜Ÿå¤´ } queue.pending = update; schedule(); } function App() { const [num, setNum] = useState(0); return { onClick() { setNum(num => num + 1); } } } window.app = schedule(); reactä¾èµ–é¡¹å¯¹äºreacté‚£äº›hooksçš„ä¾èµ–é¡¹ï¼Œè¦åˆ‡å®åœ°å¡«å†™ï¼ˆå…³ä¹åˆ°å½“å‰åœ°hookä¼šä¸ä¼šé‡æ–°æ¸²æŸ“ï¼‰ï¼Œå¯¹äºreactçš„ä¾èµ–å°½å¯èƒ½å†™è¯¦ç»†ï¼Œæ¯”å¦‚æˆ‘ currentDay.indexå†™æˆäº†currentDayï¼Œé‡æ–°æ¸²æŸ“å¤šäº†ä¸€æ¬¡ï¼ŒuseEffectï¼Œå¯¼è‡´è¯·æ±‚å¤šå‘äº†ä¸€æ¬¡ 12.Reactæ‹“å±•setStateä½¿ç”¨æ–¹æ³•æ–¹æ³•ä¸€ï¼šä¼ ç»Ÿçš„å¯¹è±¡å¼setStateï¼ˆclassï¼‰ setState(stateChange, [callback]) stateChangeä¸ºçŠ¶æ€æ”¹å˜å¯¹è±¡ï¼ˆåŸstateçš„key: æ–°çš„å€¼ï¼‰ callbackæ˜¯å¯é€‰çš„å›è°ƒå‡½æ•°, å®ƒåœ¨çŠ¶æ€æ›´æ–°å®Œæ¯•ã€ç•Œé¢ä¹Ÿæ›´æ–°å(renderè°ƒç”¨å)æ‰è¢«è°ƒç”¨ ï¼ˆå®é™…ä¸Šï¼ŒsetStateæ˜¯ä¸€ä¸ªåŒæ­¥çš„æ–¹æ³•ï¼Œä½†æ˜¯å¼‚æ­¥æ‰§è¡Œï¼Œä¹Ÿå°±æ˜¯æ”¹åŠ¨stateçš„æ•°æ®æ˜¯å¼‚æ­¥çš„ï¼Œä¸ºäº†æé«˜æ€§èƒ½ï¼Œä¼šå°†æ”¶é›†åˆ°å¤šä¸ªstateä¸€æ¬¡æ€§æ•´åˆæ›´æ–°ã€‚è¿™é‡Œå…¶å®å’ŒVueçš„å¼‚æ­¥æ¸²æŸ“åŸå› æ˜¯ä¸€è‡´çš„ï¼‰ something = () => { const {a} = this.state; //1 this.setState({a:a+1}, () => { //2 console.log(this.state.a) //2 }); console.log(this.state.a); //1 } æ–¹æ³•äºŒï¼šå‡½æ•°å¼çš„setStateï¼ˆclassï¼‰ setState(updater, [callback]) updateræ˜¯ä¸€ä¸ªè¿”å›stateChangeå¯¹è±¡ï¼ˆï¼ˆåŸstateçš„key: æ–°çš„å€¼ï¼‰çš„ä¸€ä¸ªå¯¹è±¡ï¼‰çš„å‡½æ•°ã€‚ updaterå¯ä»¥æ¥æ”¶åˆ°stateå’Œpropsã€‚ callbackæ˜¯å¯é€‰çš„å›è°ƒå‡½æ•°, å®ƒåœ¨çŠ¶æ€æ›´æ–°ã€ç•Œé¢ä¹Ÿæ›´æ–°å(renderè°ƒç”¨å)æ‰è¢«è°ƒç”¨ã€‚ something = () => { this.setState((state, props) => { return {a:state.a+1} },() => { console.log(this.state.a) }); } something2 = () => { this.setState(state => {a:state.a-1}); //ä¸å†éœ€è¦ const {a} = this.state; è¿™ä¸ªè¯­å¥ï¼Œä¸€è¡Œè§£å†³ } å¯¹è±¡å¼çš„setStateæ˜¯å‡½æ•°å¼setStateçš„è¯­æ³•ç³– æ–¹æ³•ä¸‰ï¼šhookçš„setState setCount(c => c + 1); å¦‚æœæ‚¨å°† State Hook æ›´æ–°ä¸ºä¸å½“å‰çŠ¶æ€ç›¸åŒçš„å€¼ï¼ŒReact å°†é€€å‡ºè€Œä¸æ¸²æŸ“å­çº§æˆ–è§¦å‘æ•ˆæœã€‚ï¼ˆReact ä½¿ç”¨Object.isæ¯”è¾ƒç®—æ³•ã€‚ï¼‰ setStateåŒæ­¥ã€å¼‚æ­¥é—®é¢˜Reactçš„ä¸‰ä¸ªæ¨¡å¼ï¼š //- legancyæ¨¡å¼ï¼š ReactDOM.render(&lt;App />, rootNode) //- blockingæ¨¡å¼ï¼š ReactDOM.createBlockingRoot(root).render(&lt;App />) //- Concurrentæ¨¡å¼ï¼š ReactDOM.createRoot(rootNode).render(&lt;App />) é’ˆå¯¹legancyæ¨¡å¼ï¼š å¼‚æ­¥æ¸²æŸ“ã€‚æ ¹æ®batchedUpdateså‡½æ•°è¿›è¡Œä¼˜åŒ–ï¼Œè¿›è¡Œæ‰¹å¤„ç†ï¼Œå°†å¤šæ¬¡setStateè½¬åŒ–ä¸ºä¸€æ¬¡ã€‚å…¶å®ä¹Ÿæ˜¯batchedUpdateså‡½æ•°ä¸­ï¼Œæœ‰ä¸€ä¸ª executionContextå…¨å±€å˜é‡ï¼Œå¦‚æœå½“å‰æ›´æ–°ï¼ŒåŒ…å«äº† BatchedContextï¼Œåˆ™ä¼šè®¤ä¸ºè¿™æ˜¯ä¸€æ¬¡æ‰¹å¤„ç†ï¼ˆå› ä¸ºæ˜¯ |=ï¼Œ æ‰€ä»¥å¯èƒ½åŒ…å«ï¼Œå¯èƒ½ä¸åŒ…å«ï¼‰ï¼Œæ‰¹å¤„ç†ä¸­çš„ setStateéƒ½ä¼šè¢«åˆå¹¶ä¸ºä¸€æ¬¡ executionContext |= BatchedContext æ‰€ä»¥æ­¤æ—¶å¦‚æœå°† setState()æ–¹æ³•æ”¾å…¥setTimeoutä¸­ï¼ˆè¿›è¡Œå¼‚æ­¥æ‰§è¡Œï¼‰ï¼Œæ¯”å¦‚ä¸‹é¢è¿™ç§æƒ…å†µ function handleClick() { console.log(\"=== click ===\"); fetchSomething().then(() => { setCount((c) => c + 1); // Causes a re-render setFlag((f) => !f); // Causes a re-render }); } ä½¿å¾— executionContext |= BatchedContextä¸èƒ½åŒæ­¥å¾—åˆ° BatchedContextè¿™ä¸ªå€¼ï¼Œåˆ™æ­¤æ—¶ executionContextå•¥ä¹Ÿæ²¡æœ‰ï¼Œæºç ä¸­æœ‰ï¼š if(executionContext === NoContext) { resetRenderTimer(); flushSyncCallbackQueue(); //åŒæ­¥æ‰§è¡Œæœ¬æ¬¡æ¸²æŸ“setState } é’ˆå¯¹Concurrentæ¨¡å¼ï¼š å³ä½¿å°† setState()æ–¹æ³•æ”¾å…¥setTimeoutä¸­ï¼ˆè¿›è¡Œå¼‚æ­¥æ‰§è¡Œï¼‰ï¼Œä¹Ÿä¸ä¼šåŒæ­¥æ¸²æŸ“ï¼Œå› ä¸ºè¿›å…¥ä»¥ä¸Šåˆ¤æ–­æ¡ä»¶ä¹‹å‰ï¼Œè¿˜è¦è¿›å…¥ä¸€ä¸ªåˆ¤æ–­ï¼Œå³æ˜¯å¦ä¸ºåŒæ­¥çš„ä¼˜å…ˆçº§ï¼ˆReactDOM.renderï¼‰ï¼Œç”±äºæ­¤æ—¶æ˜¯ConCurrentæ¨¡å¼ï¼Œåˆ™ä¸ä¼šè¿›å…¥è¿™ä¸ªé€»è¾‘åˆ¤æ–­ï¼Œç»§ç»­å¾€ä¸‹èµ°å‘½ä¸­ flushSyncCallbackQueue()å‡½æ•°ã€‚ åœ¨Concurrentæ¨¡å¼å‡ºç°ä¹‹å‰ï¼Œæ˜¯é€šè¿‡ åŒ…è£¹unstable_batchedupdateså®ç°å¼‚æ­¥ä»»åŠ¡ä¸­æ‰¹å¤„ç† å®é™…ä¸Šï¼ŒConcurrentè¿˜å¤„äºå®éªŒé˜¶æ®µï¼Œåœ¨ç¨³å®šç‰ˆæœ¬ä¸­å°šä¸å¯ç”¨ã€‚å®ƒé¢å‘çš„äººç¾¤æ˜¯æ—©æœŸä½¿ç”¨è€…ä»¥åŠå¥½å¥‡å¿ƒè¾ƒå¼ºçš„äººã€‚ setTimeout(() => { // æ¨¡æ‹Ÿå¼‚æ­¥ ReactDOM.unstable_batchedUpdates(() => { // ä»…ä»…åŠ äº†unstable_batchedUpdates // è¿™é‡Œçš„ä¸¤ä¸ªsetStateä¼šåˆå¹¶æ‰§è¡Œä¸€æ¬¡ã€‚ setNum(2); setStr('c'); }); }, 1000); è¡¥å……ï¼š åœ¨react18ä»¥åï¼Œä¸å†æœ‰è¿™ä¸‰ç§æ¨¡å¼ï¼Œè€Œæ˜¯ä»¥â€œæ˜¯å¦ä½¿ç”¨å¹¶å‘ç‰¹æ€§â€ä½œä¸ºâ€œæ˜¯å¦å¼€å¯å¹¶å‘æ›´æ–°â€çš„ä¾æ® å¹¶ä¸”ä» React 18 å¼€å§‹createRootï¼Œæ‰€æœ‰æ›´æ–°éƒ½å°†è‡ªåŠ¨æ‰¹å¤„ç†ï¼Œæ— è®ºå®ƒä»¬æ¥è‡ªä½•å¤„ã€‚è¿™æ„å‘³ç€è¶…æ—¶ã€æ‰¿è¯ºã€æœ¬æœºäº‹ä»¶å¤„ç†ç¨‹åºæˆ–ä»»ä½•å…¶ä»–äº‹ä»¶å†…éƒ¨çš„æ›´æ–°å°†ä»¥ä¸ React äº‹ä»¶å†…éƒ¨çš„æ›´æ–°ç›¸åŒçš„æ–¹å¼è¿›è¡Œæ‰¹å¤„ç†ï¼š è¿½æº¯å¼‚æ­¥å›è°ƒä¸­æ‰¹å¤„ç†é—®é¢˜ä¸ºä»€ä¹ˆä¹‹å‰å¼‚æ­¥å›è°ƒä¸­çš„setStateä¸èƒ½æ‰¹å¤„ç†ï¼Ÿ React çš„æ›´æ–°æ˜¯åŸºäº Transactionï¼ˆäº‹åŠ¡ï¼‰çš„ï¼ŒTransacation å°±æ˜¯ç»™ç›®æ ‡æ‰§è¡Œçš„å‡½æ•°åŒ…è£¹ä¸€ä¸‹ï¼ŒåŠ ä¸Šå‰ç½®å’Œåç½®çš„ hook ï¼ˆæœ‰ç‚¹ç±»ä¼¼ koa çš„ middlewareï¼‰ï¼Œåœ¨å¼€å§‹æ‰§è¡Œä¹‹å‰å…ˆæ‰§è¡Œ initialize hookï¼Œç»“æŸä¹‹åå†æ‰§è¡Œ close hookï¼Œè¿™æ ·æ­é…ä¸Š isBatchingUpdates è¿™æ ·çš„å¸ƒå°”æ ‡å¿—ä½å°±å¯ä»¥å®ç°ä¸€æ•´ä¸ªå‡½æ•°è°ƒç”¨æ ˆå†…çš„å¤šæ¬¡ setState å…¨éƒ¨å…¥ pending é˜Ÿåˆ—ï¼Œç»“æŸåç»Ÿä¸€ apply äº†ã€‚ ä½†æ˜¯ setTimeout è¿™æ ·çš„æ–¹æ³•æ‰§è¡Œæ˜¯è„±ç¦»äº†äº‹åŠ¡çš„ï¼Œreact ç®¡æ§ä¸åˆ°ï¼Œæ‰€ä»¥å°±æ²¡æ³• batch äº†ã€‚ ï¼ˆä½†æ˜¯18.xä»¥åéƒ½å¯ä»¥batchäº†ï¼‰ ä¸ºä»€ä¹ˆVueæ²¡æœ‰è¿™ä¸ªé™åˆ¶ï¼Ÿ æ˜¯å› ä¸º vue é‡‡ç”¨äº† nexttick çš„æ–¹å¼ï¼Œåˆ©ç”¨ EventLoopï¼Œå°†ä¸€ä¸ªåŒæ­¥äº‹ä»¶å¾ªç¯è¿‡ç¨‹ä¸­æ‰€æœ‰ä¿®æ”¹åˆå¹¶ï¼Œå®ƒæœ¬è´¨ä¸Šå±äºå»¶è¿Ÿçš„æ‰¹é‡æ›´æ–° LazyLoad-Reactçš„æ‡’åŠ è½½æ‡’åŠ è½½ç»„ä»¶ å¦‚æœæœ‰å¤šä¸ªæ‰€æœ‰è·¯ç”±ç»„ä»¶ï¼Œæ‰€æœ‰çš„è·¯ç”±ç»„ä»¶éƒ½ä¼šåœ¨ç¬¬ä¸€æ¬¡å°±å…¨éƒ¨ç»™ä½ åŠ è½½å®Œæ¯•ã€‚æˆ‘ä»¬å¯ä»¥å€ŸåŠ©reacté‡Œé¢çš„ Lazy å‡½æ•° // lazyä¸ºè·¯ç”±æ‡’åŠ è½½å‡½æ•°ï¼ŒSuspenceä¸ºå¦‚æœå½“å‰è·¯ç”±ç»„ä»¶æ²¡èƒ½å³ä½¿è¯·æ±‚å‡ºæ¥ï¼Œç»™ç”¨æˆ·å±•ç¤ºçš„é¡µé¢ä¿¡æ¯ import React, { Component, lazy, Suspense } from 'react' å¼•å…¥è·¯ç”±ç»„ä»¶æ˜¯å†™çš„æ–¹å¼æœ‰æ‰€å˜åŒ– ï¼ˆåœ¨Vueä¸­æ˜¯ç›´æ¥ const Home = () =&gt; import(&#39;../components/home&#39;);ï¼‰ // import Home from './pages/Home' // import About from './pages/About' const Home = lazy(() => import('./pages/Home')) const About = lazy(() => import('./pages/About')) ä½†æ˜¯æ³¨å†Œè·¯ç”±éƒ¨åˆ†éœ€è¦ä½¿ç”¨ ä»React å¼•å…¥çš„ Suspense ç»„ä»¶è¿›è¡ŒåŒ…è£¹ï¼Œä¸ºçš„æ˜¯å½“å‰è·¯ç”±ç»„ä»¶æ²¡èƒ½åŠæ—¶åŠ è½½å‡ºæ¥ï¼Œç»™ç”¨æˆ·å±•ç¤ºçš„é¡µé¢ä¿¡æ¯ {/* æ³¨å†Œè·¯ç”±éƒ¨åˆ†éƒ½ç»™æˆ‘ç”¨SuspenceåŒ…è£¹èµ·æ¥,fallbackéƒ¨åˆ†å¯ä»¥æ”¾ç½®ä¸€ä¸ªç»„ä»¶ */} {/* ä½†æ˜¯è¿™ä¸ªæ”¾ç½®çš„åŠ è½½ç»„ä»¶ï¼Œä¸èƒ½ä½¿ç”¨è·¯ç”±æ‡’åŠ è½½ */} &lt;Suspense fallback={&lt;h2>Loading...&lt;/h2>}> {/* æ³¨å†Œè·¯ç”± */} &lt;Route path=\"/about\" component={About}>&lt;/Route> &lt;Route path=\"/home\" component={Home}>&lt;/Route> &lt;Redirect to=\"/about\" /> &lt;/Suspense> å¦‚æœä¸æ˜¯ä»¥ react-router-dom è¿›è¡Œè·¯ç”±åˆ†é…ï¼Œè€Œæ˜¯é€šè¿‡æœ¬ç»„ä»¶çš„stateå†³å®šæ˜¯å¦æ¸²æŸ“å­ç»„ä»¶çš„ç®€æ˜“ç‰ˆåŠ¨æ€è·¯ç”±ï¼Œåˆ™ä¹Ÿå¯ä»¥ç”¨ä»¥ä¸Šç±»ä¼¼å†™æ³• const Home = lazy(() => import('./pages/Home')) const About = lazy(() => import('./pages/About')) {/* æ³¨å†Œè·¯ç”±éƒ¨åˆ†éƒ½ç»™æˆ‘ç”¨SuspenceåŒ…è£¹èµ·æ¥,fallbackéƒ¨åˆ†å¯ä»¥æ”¾ç½®ä¸€ä¸ªç»„ä»¶ */} {/* ä½†æ˜¯è¿™ä¸ªæ”¾ç½®çš„åŠ è½½ç»„ä»¶ï¼Œä¸èƒ½ä½¿ç”¨è·¯ç”±æ‡’åŠ è½½ */} &lt;Suspense fallback={&lt;h2>Loading...&lt;/h2>}> { isShow ? &lt;Home /> : &lt;About/> } &lt;/Suspense> å®ç°åŸç† å½“Webpackè§£æè¯¥è¯­æ³•æ—¶ï¼Œä»–ä¼šè‡ªåŠ¨å¼€å§‹è¿›è¡Œä»£ç åˆ†å‰²ï¼Œåˆ†å‰²æˆä¸€ä¸ªæ–‡ä»¶ï¼ˆCode Splitingï¼‰ï¼Œå½“ä½¿ç”¨åˆ°è¿™ä¸ªæ–‡ä»¶æ—¶è¿™æ®µä»£ç ä¼šè¢«å¼‚æ­¥åŠ è½½ å½“ç„¶é™¤äº†å¼‚æ­¥æ‡’åŠ è½½ç»„ä»¶ï¼Œè¿˜å¯ä»¥å¼‚æ­¥æ‡’åŠ è½½æ–¹æ³•ï¼Œè¯¦æƒ…å¯ä»¥çœ‹ã€ŠPC&amp;ç§»åŠ¨ç«¯ç½‘é¡µç‰¹æ•ˆ(JS)ã€‹ç¯‡ç«  Fragmentæ­£å¸¸æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä½¿ç”¨jsxè¯­æ³•ä»¬éƒ½éœ€è¦åœ¨å¤–å±‚åŒ…è£¹ä¸€å±‚divï¼Œä½†å…¶å®æœ‰å¦å¤–ä¸€ä¸ªé€‰æ‹©ï¼Œå°±æ˜¯åœ¨å¤–å±‚åŒ…ä¸€å±‚Fragmentï¼ˆéš¶å±äºæºç å¹²å‡€å¼ºè¿«ç—‡æ‚£è€…ï¼‰ &lt;Fragment> .... &lt;/Fragment> æœ€ç»ˆFragmentä¼šè¢«Reactè§£æï¼Œä¸¢å¼ƒï¼Œæ’°å†™Fragmentå®é™…ä¸Šæ˜¯ä¸ºäº†éª—è¿‡jsxè¯­æ³•ï¼ˆç±»ä¼¼Vueçš„templateï¼‰ï¼Œç”±æ­¤å¯ä»¥å¾—åˆ°æ²¡æœ‰å¤ªå¤šæ›¾divåŒ…è£¹çš„å¹²å‡€htmlä»£ç  0.0 å®é™…ä¸Šæˆ‘ä»¬å¯ä»¥å†™ç©ºæ ‡ç­¾ï¼Œå®ƒä¹Ÿå¯ä»¥å®ç°fragmentçš„æ•ˆæœ &lt;> ..... &lt;/> åªä¸è¿‡å¦‚æœä½¿ç”¨fragmentæ ‡ç­¾ï¼Œå¯ä»¥ç»™å®ƒæ·»åŠ keyå±æ€§ï¼š &lt;Fragment key={1}&gt;ï¼Œæ‰€ä»¥ä½¿ç”¨fragmentæ ‡ç­¾å¯ä»¥è¿›è¡Œéå†ï¼ŒäºŒç©ºæ ‡ç­¾ä¸è¡Œ Contextä¸€ç§ç»„ä»¶é—´é€šä¿¡æ–¹å¼ï¼ˆç”Ÿäº§æ¶ˆè´¹è€…æ¨¡å¼ï¼‰ï¼Œå¸¸ç”¨äºç¥–ç»„ä»¶å’Œåä»£ç»„ä»¶çš„é€šä¿¡ï¼ˆç¥–å­™ï¼‰ï¼Œåœ¨åº”ç”¨å¼€å‘ä¸­ä¸€èˆ¬ä¸ç”¨context, ä¸€èˆ¬éƒ½ç”¨å®ƒçš„å°è£…reactæ’ä»¶ ï¼ˆå›å¿†ï¼šçˆ¶ä¼ å­ç›´æ¥propsï¼Œå­ä¼ çˆ¶ç”¨å›è°ƒï¼Œå…„å¼Ÿç­‰è·¨çˆ¶å­å¯ç”¨è®¢é˜…å‘å¸ƒæœºåˆ¶æˆ–è€…reduxï¼‰ 1.åˆ›å»ºContextå®¹å™¨å¯¹è±¡ï¼šconst XxxContext = React.createContext() 2.æ¸²æŸ“å­ç»„æ—¶ï¼Œå¤–é¢åŒ…è£¹xxxContext.Provideræ ‡ç­¾, é€šè¿‡valueå±æ€§ç»™åä»£ç»„ä»¶ä¼ é€’æ•°æ® 3.å“ªä¸ªå­ç»„ä»¶è¦ä½¿ç”¨ï¼Œåˆ™ å¦‚æœæ˜¯ç±»å¼å­ç»„ä»¶ï¼Œéœ€è¦ static contextType = XxxContext;è¿›è¡Œå£°æ˜æ¥æ”¶ï¼›ç„¶å this.context.username å°±å¯ä»¥ä½¿ç”¨ç¥–ç»„ä»¶ä¼ è¿‡æ¥çš„æ•°æ®äº† å¦‚æœæ˜¯å‡½æ•°å¼ç»„ä»¶ï¼Œåˆ™éœ€è¦é€šè¿‡ XxxContext.Consumeræ ‡ç­¾è¿›è¡Œå£°æ˜æ¥æ”¶ï¼Œå¹¶ä¸”ç”±å›è°ƒå‡½æ•°å¾—åˆ°ç¥–ç»„ä»¶ä¼ æ¥çš„æ•°æ® import React, { Component } from 'react' //è®°ä½è¿™é‡Œèµ‹å€¼å˜é‡åé¦–å­—æ¯å¤§å†™ï¼Œå› ä¸ºç°åœ¨è¦æŠŠMyContextä½œä¸ºç»„ä»¶å»ä½¿ç”¨ const MyContext = React.createContext(); export default class App extends Component { state = { username: 'Allen', age: 18 } render() { const { username, age } = this.state return ( &lt;div> I am grandFather &lt;MyContext.Provider value={{ username, age }}> &lt;Son /> &lt;/MyContext.Provider> &lt;/div> ) } } class Son extends Component { render() { return ( &lt;div> &lt;Grand /> &lt;/div> ) } } // class Grand extends Component { // // ä¸¾æ‰‹ç¤ºæ„æˆ‘è¦ä½¿ç”¨(å¿…é¡»è¦å£°æ˜æ‰èƒ½æ¥æ”¶åˆ°) // static contextType = MyContext; // render() { // return ( // &lt;div> // {this.context.username} // &lt;/div> // ) // } // } // å‡½æ•°å¼ç»„ä»¶å†™æ³• function Grand() { return ( &lt;div> &lt;MyContext.Consumer> { value => { return `My name is ${value.username}, my age is ${value.age}` } } &lt;/MyContext.Consumer> &lt;/div> ) } useContextå‡½æ•°å¼ç»„ä»¶é™¤äº†å¯ä»¥ä½¿ç”¨ Consumer æ¥æ”¶Contextçš„æ•°æ®ï¼Œè¿˜å¯ä»¥ä½¿ç”¨useContextè¿›è¡Œæ¥æ”¶ï¼ˆç‰¹åˆ«æ˜¯åœ¨å¤šä¸ªcontextçš„æ—¶å€™ï¼Œæ›´èƒ½ä½“ç°å‡ºuseContextçš„ä¼˜åŠ¿ï¼‰ï¼ˆç»“åˆä¸Šé¢çš„æ¡ˆä¾‹æ¥çœ‹ï¼‰ import { useContext } from 'react' function Grand() { const value = useContext(MyContext); return ( &lt;div> &lt;MyContext.Consumer> {`My name is ${value.username}, my age is ${value.age}`} &lt;/MyContext.Consumer> &lt;/div> ) } ä¸€èˆ¬contextç³»åˆ—å’ŒuseReducerä½¿ç”¨èµ·æ¥ä¼šå¾ˆçˆ½ import React, { useReducer, useContext } from 'react'; const initialState = { count: 0 } function reducer(state, action) { const { count } = state; switch (action.type) { case 'increment': return { count: count + 1 }; case 'decrement': return { count: count - 1 } default: return state } } const MyContext = React.createContext(); function App() { const [state, dispatch] = useReducer(reducer, initialState); return ( &lt;> &lt;div>{state.count}&lt;/div> &lt;MyContext.Provider value={ { state, dispatch } }> &lt;Child>&lt;/Child> &lt;Child>&lt;/Child> &lt;Child>&lt;/Child> &lt;/MyContext.Provider> &lt;/> ) } function Child() { const {dispatch, state} = useContext(MyContext) return ( &lt;div> &lt;div>{state.count}&lt;/div> &lt;button onClick={() => dispatch({type: 'increment'})}>+++&lt;/button> &lt;button onClick={() => dispatch({type: 'decrement'})}>---&lt;/button> &lt;/div> ) } export default App; Reactçš„æ’æ§½æŠ€æœ¯åœ¨æˆ‘ä»¬å°è£…è‡ªå®šä¹‰çš„ Link æ ‡ç­¾æ—¶ï¼ˆReactï¼ˆä¸­ï¼‰è·¯ç”±ç¯‡ç« éƒ¨åˆ†ï¼‰ï¼Œæˆ‘ä»¬ç›´æ¥åœ¨è‡ªå®šä¹‰è·¯ç”±ç»„ä»¶æ ‡ç­¾å†…å†™å…¥æ–‡å­—ï¼Œä»è€Œåœ¨å­ç»„ä»¶é‡Œé¢å¯ä»¥ä½¿ç”¨ childrenå±æ€§è¿›è¡Œæ¥æ”¶ï¼ˆthis.props.childrenï¼‰ æ’æ§½æŠ€æœ¯çš„å®ç”¨æ€§åœ¨äºï¼šé¢„ç•™ä½ç½®ï¼Œéšæ—¶æ”¹å˜æ•´ä¸ªç»„ä»¶ ç”±æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°Reactåœ¨å¤„ç†ç»„ä»¶æ’æ§½æ—¶çš„ç­–ç•¥ class App extends Component { render() { return ( &lt;div> &lt;A> &lt;B /> &lt;/A> &lt;/div> ); } } class A extends Component { render() { return ( &lt;div> I am A {this.props.children} &lt;/div> ); } } class B extends Component { render() { return ( &lt;div> I am B &lt;/div> ); } } æ­¤æ—¶Bè¦ç®—ä½œAçš„å­ç»„ä»¶ï¼Œå¯æ˜¯æ­¤æ—¶Bå¦‚ä½•è·å–åˆ°Açš„stateå‘¢ï¼Ÿä»¥ä¸Šçš„ children propsåªèƒ½å®ç°ä¼ é€’ç»“æ„ï¼Œæ— æ³•ä¼ é€’æ•°æ® æˆ‘ä»¬è¦ä½¿ç”¨render propsï¼ˆå®é™…ä¸Šä¹Ÿæœ‰ç‚¹åƒåˆ©ç”¨æ­£å¸¸çš„å­ä¼ çˆ¶é—­åŒ…ç‰¹æ€§å®ç°ï¼‰ class App extends Component { render() { return ( &lt;div> {/* renderæ˜¯è‡ªå®šä¹‰çš„å±æ€§åï¼Œä½†æ˜¯æˆ‘ä»¬ä¸€èˆ¬éƒ½å®šä¹‰ä¸ºrender */} &lt;A render={(name) => &lt;B name={name} />} /> &lt;/div> ); } } class A extends Component { state = { name: 'Allen' } render() { return ( &lt;div> I am A {this.props.render(this.state.name)} &lt;/div> ); } } class B extends Component { render() { return ( &lt;div> I am B &lt;br /> {this.props.name} &lt;/div> ); } } ç”±æ­¤ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥æ˜¯å®ç°ä½œä¸ºæ’æ§½çš„çˆ¶å­ç»„ä»¶æ•°æ®ä¼ é€’äº† åœ¨Vueä¸­ï¼Œä»¥ä¸Šè¢«ç§°ä¸ºslotæŠ€æœ¯ã€‚ é”™è¯¯è¾¹ç•Œï¼ˆreact16ä»¥ä¸Šï¼‰ ç”±äºæŸäº›ä¸å¯æ§å› ç´ ï¼Œä»£ç é”™è¯¯ã€åç«¯æ•°æ®é—®é¢˜ã€æœåŠ¡å™¨å´©æºƒã€è¿”å›æ•°æ®undefinedç­‰ è€ŒErrorBoundaryï¼Œä¸è¦è®©ä¸€ä¸ªå­ç»„ä»¶çš„é”™è¯¯ï¼Œå½±å“åˆ°æ•´ä¸ªç»„ä»¶éƒ½æ— æ³•å‘ˆç° æˆ‘ä»¬ä¹‹å‰å­¦ä¹ è¿‡ getDerivedStateFromPropsé’©å­ï¼ˆæ–°é’©å­ï¼‰ï¼Œè¿™ä¸€æ¬¡æ˜¯ æˆ‘ä»¬ä½¿ç”¨ getDerivedStateFromErrorå¤„ç†é”™è¯¯è¾¹ç•Œ getDerivedStateFromErrorï¼š å¦‚æœè¯¥ç»„ä»¶çš„å­ç»„ä»¶å‡ºç°ä»»ä½•çš„æŠ¥é”™ï¼Œéƒ½ä¼šè°ƒç”¨è¿™ä¸ªé’©å­ï¼Œå¹¶æºå¸¦é”™è¯¯ä¿¡æ¯ä½œä¸ºå‚æ•° å®ƒå¿…é¡»è¿”å›ä¸€ä¸ªçŠ¶æ€å¯¹è±¡ï¼Œåªèƒ½æ•è·åä»£ç»„ä»¶ç”Ÿå‘½å‘¨æœŸäº§ç”Ÿçš„é”™è¯¯ï¼ˆåŒ…æ‹¬renderï¼‰ getDerivedStateFromError ç»å¸¸æ­é…å¦å¤–ä¸€ä¸ªä¸å¤ªå¸¸ç”¨çš„ é’©å­ componentDidCatch ä¸€èµ·ä½¿ç”¨ class App extends Component { state = { hasError: '' //ç”¨äºè¡¨ç¤ºå­ç»„ä»¶æ˜¯å¦äº§ç”Ÿé”™è¯¯ } // åœ¨å‡ºé”™ç»„ä»¶çš„çˆ¶ç»„ä»¶è¿›è¡Œå¤„ç† getDerivedStateFromError static getDerivedStateFromError(err) { return { hasError: err } } // ç»Ÿè®¡å­ç»„ä»¶é”™è¯¯æ¬¡æ•°ï¼Œåé¦ˆç»™æœåŠ¡å™¨ï¼Œç”¨äºé€šçŸ¥ç¼–ç äººå‘˜bugçš„è§£å†³ï¼š componentDidCatch() { console.log(); } render() { return ( &lt;div> I am App {/* ä¸è¿‡åœ¨devç¯å¢ƒä¸‹å…¶å®è¿˜æ˜¯ä¼šå‡ºç°ç½‘é¡µæ•´ä½“æŠ¥é”™ï¼Œä½†æ˜¯æ‰“åŒ…åå°±ä¸ä¼šäº† 0.0 */} {this.hasError ? &lt;h2>å½“å‰ç½‘ç»œä¸ç¨³å®šï¼Œè¯·ç¨åé‡è¯•&lt;/h2> : &lt;A />} &lt;/div> ); } } Server Componentå®˜æ–¹æå‡ºè‰æ¡ˆçš„ç›®çš„æ˜¯è§£å†³æ¥å£è¯·æ±‚åˆ†æ•£åœ¨å„ä¸ªç»„ä»¶ä¸­å¸¦æ¥çš„å­ç»„å»ºçš„æ•°æ®è¯·æ±‚ï¼Œéœ€è¦ç­‰å¾…çˆ¶ç»„ä»¶è¯·æ±‚å®Œæˆæ¸²æŸ“å­ç»„ä»¶æ—¶æ‰èƒ½å¼€å§‹è¯·æ±‚çš„æ•°æ®è¯·æ±‚é˜Ÿåˆ—é—®é¢˜ æ–¹æ¡ˆå¤§æ¦‚æ˜¯å°†Reactæ‹†åˆ†ä¸ºServerç»„ä»¶å’ŒClientçš„ç»„ä»¶ï¼Œç„¶è€Œå’ŒSSRä¸åŒçš„åœ°æ–¹åœ¨äºServer Componentè¿”å›çš„æ˜¯åºåˆ—åŒ–çš„ç»„ä»¶æ•°æ®ï¼ˆJSXï¼‰ï¼Œè€ŒSSRè¿”å›çš„æ˜¯html ä¸æ­¤åŒæ—¶ï¼Œä»ç„¶ä¼šå¸¦æ¥ä¸€äº›é—®é¢˜ï¼ˆå–è‡ªé­”æ³•å¸ˆå¡é¢‚ï¼Œå¡è€å¸ˆï¼‰ 1.æ¥å£è¿”å›ï¼Œä¼šé¢å¤–å¤šå‡ºå†—ä½™çš„ç»„ä»¶ç»“æ„ 2.æœåŠ¡å™¨æˆæœ¬é—®é¢˜ï¼Œåœ¨ç›®å‰è¡Œä¸šå¤§åŠ¿è§‚çœ‹ï¼ŒæœåŠ¡å™¨çš„æˆæœ¬è¿˜æ˜¯æ¯”è¾ƒæ˜‚è´µçš„ï¼Œå¾ˆå¤šä¸ºäº†èŠ‚çº¦æœåŠ¡å™¨æˆæœ¬ï¼Œå°†é€»è¾‘è®¡ç®—ä¸‹ç§»è‡³å®¢æˆ·ç«¯å¤„ç† 3.å¿ƒæ™ºè´Ÿæ‹…ï¼ŒServerComponentæ— æ³•ä½¿ç”¨useStateã€useEffectç­‰hooks forwardRefæœ‰æ—¶å€™çˆ¶ç»„ä»¶éœ€è¦æ‹¿åˆ°å­ç»„ä»¶çš„refç»„ä»¶ï¼Œè¿›è¡Œç›´æ¥æ“ä½œï¼ˆè™½ç„¶æˆ‘ä»¬è¦å°½é‡é¿å…è¿™ç§æƒ…å†µï¼‰ï¼Œæ­¤æ—¶é€šè¿‡çˆ¶å­ç»„ä»¶é€šä¿¡çš„æ–¹å¼ï¼Œå¯èƒ½ä¼šæ¯”è¾ƒéº»çƒ¦ï¼ˆè™½ç„¶å¯ä»¥å®ç°ï¼Œæ¯”å¦‚ç”¨propsç©¿å›è°ƒå‡½æ•°ï¼‰ï¼Œä»äº‹æˆ‘ä»¬å¯ä»¥ä½¿ç”¨forwardRef import React, { forwardRef, useRef } from 'react' const Child = forwardRef((props, ref) => { return ( child ) }) export default function Index() { const text = useRef(null) return ( father { console.log(text); }}>click ) } åˆ¤æ–­æ˜¯å¦ä¸ºReactç»„ä»¶import React, { isValidElement } from 'react'; console.log(isValidElement(xxxx)); // true 13.Reactä¼˜åŒ–PureComponent &amp; memoé—®é¢˜ä¸€ï¼šæ‰§è¡ŒsetStateçš„æ—¶å€™ï¼Œå³ä½¿stateæœªå‘ç”Ÿæ”¹å˜ï¼Œä¹Ÿä¼šé‡æ–°renderï¼ˆä¸è¿‡ç±»å¼ç»„ä»¶ä¸­reduxçš„æ›´æ–°ä¹Ÿç”±æ­¤å¾—ç›Šï¼‰ é—®é¢˜äºŒï¼šReactä¸­ä½¿ç”¨çˆ¶å­ç»„ä»¶åµŒå¥—æ—¶ï¼Œçˆ¶ç»„ä»¶ä½¿ç”¨propsä¼ å…¥stateçš„çŠ¶æ€ï¼Œå‘ç”Ÿ setState æ—¶stateæ”¹å˜ï¼ŒsetStateè§¦å‘ render()ï¼Œè€Œä¼ å…¥çš„propsä¹Ÿéšä¹‹æ”¹å˜ï¼Œå­ç»„ä»¶ä¹Ÿå‘ç”Ÿ render()ï¼›ä½†æ˜¯å¦‚æœæ²¡æœ‰ä¼ å…¥propsï¼Œçˆ¶ç»„ä»¶å‘ç”Ÿ render()æ›´æ–°æ—¶ï¼Œå› ä¸ºå­ç»„ä»¶ä¹Ÿæ”¾åœ¨ render()é‡Œé¢ï¼Œæ‰€ä»¥å­ç»„ä»¶å³ä½¿æ²¡ä»€ä¹ˆè¦æ”¹çš„åœ°æ–¹ï¼Œä¹Ÿä¸å¾—ä¸éšç€çˆ¶ç»„ä»¶ä¸€èµ· render()æ›´æ–° é€ æˆåŸå› ï¼š Componentä¸­çš„shouldComponentUpdate()æ€»æ˜¯è¿”å›trueï¼ˆæ‹‰é—¸å¼€é—¨ï¼‰ åœ¨æˆ‘ä»¬ç ”ç©¶ä¸­ï¼Œå¯ä»¥åˆ¤æ–­ï¼š shouldComponentUpdate(nextProps, nextState) { console.log(this.props, this.state); //å½“å‰ç»„ä»¶çš„propsã€state console.log(nextProps, nextState); //å‘ç”Ÿæ›´æ–°åçš„propsã€æ›´æ–°åçš„state return !this.props.å±æ€§ === nextProps.å±æ€§ &amp;&amp; !this.state.å±æ€§ === nextState.å±æ€§ } åœ¨å¼€å‘ä¸­è§£å†³ï¼š å¯¹äºç±»å¼ç»„ä»¶ æˆ‘ä»¬å¯ä»¥ä½¿ç”¨Reactå¸¦çš„ PureComponentï¼Œå®ƒèƒ½å¸®æˆ‘ä»¬è‡ªåŠ¨é‡å†™é˜€é—¨è¿™ä¸ªé€»è¾‘ import React, { PureComponent } from 'react' ç„¶åå®šä¹‰ç±»å¼ç»„ä»¶æ—¶ï¼ŒåŸæœ¬ç»§æ‰¿Component -&gt; ç»§æ‰¿PureComponent export default class App extends PureComponent { //xxx } ä½†å®é™…ä¸Š PureComponent æœ‰äº›è®¸å°ç‘•ç–µï¼ˆç±»ä¼¼äºreduxå°bugï¼‰,å®ƒåœ¨åº•å±‚ä¹Ÿæ˜¯åšä¸€ä¸ªæµ…æ¯”è¾ƒï¼ˆObject.is()ï¼‰ï¼Œå¦‚æœåªæ˜¯æ•°æ®å¯¹è±¡å†…éƒ¨æ•°æ®å˜äº†ï¼ŒshouldComponentUpdate()è¿”å›false changeSomething = () => { let obj = this.state; obj.username = 'Bruce'; this.setState(obj); //åœ°å€æ²¡æœ‰æ”¹å˜ï¼Œä¸å‘ç”Ÿå˜åŒ– // this.setState({ username: 'Bruce' }) è¿™ä¸ªä¹Ÿä¸é¡¶ç”¨äº† // ä¹‹å‰ä¸æ¨èä½¿ç”¨pushã€unshift const { student } = this.state; student.push('Olivia'); this.setState({ student: student }); ////åœ°å€æ²¡æœ‰æ”¹å˜ï¼Œä¸å‘ç”Ÿå˜åŒ– } æ­£ç¡®å†™æ³•ï¼š this.setState({ username:'Bruce', student: ['Olivia', ...student] }); äº¦æˆ–æ˜¯éœ€è¦æ·±å±‚æ¯”è¾ƒçš„æ—¶å€™ï¼Œè‡ªè¡Œå®ç° shouldComponentUpdate å¯¹äºå‡½æ•°å¼ç»„ä»¶ æˆ‘ä»¬æ­¤æ—¶æ— æ³•ä½¿ç”¨åˆ°PureComponentï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ React.memo ä»–æ¥æ”¶ä¸€ä¸ªç»„ä»¶ä½œä¸ºå‚æ•°è¿”å›ä¸€ä¸ªæ–°ç»„ä»¶ï¼Œæ–°ç»„ä»¶ä»…æ£€æŸ¥propså˜æ›´ï¼Œä¼šå°†å½“å‰propså’Œä¸Šä¸€æ¬¡propsè¿›è¡Œæµ…å±‚æ¯”è¾ƒï¼Œç›¸åŒåˆ™é˜»æ­¢æ¸²æŸ“ æ‰€ä»¥å¯¹äºå‡½æ•°å¼ç»„ä»¶æ¥è¯´ï¼ŒReact.memo ä»…æ£€æŸ¥ props å˜æ›´ã€‚å¦‚æœå‡½æ•°ç»„ä»¶è¢« React.memo åŒ…è£¹ï¼Œä¸”å…¶å®ç°ä¸­æ‹¥æœ‰ useStateï¼ŒuseReducer æˆ– useContext çš„ Hookï¼Œå½“ state æˆ– context å‘ç”Ÿå˜åŒ–æ—¶ï¼Œå®ƒä»ä¼šé‡æ–°æ¸²æŸ“ã€‚ const ChildComponent = React.memo(function MyComponent(props) { /* ä½¿ç”¨ props æ¸²æŸ“ */ }); React.memo ä¸ºé«˜é˜¶ç»„ä»¶ã€‚ å¦‚æœä½ çš„ç»„ä»¶åœ¨ç›¸åŒ props çš„æƒ…å†µä¸‹æ¸²æŸ“ç›¸åŒçš„ç»“æœï¼Œé‚£ä¹ˆä½ å¯ä»¥é€šè¿‡å°†å…¶åŒ…è£…åœ¨ React.memo ä¸­è°ƒç”¨ï¼Œä»¥æ­¤é€šè¿‡è®°å¿†ç»„ä»¶æ¸²æŸ“ç»“æœçš„æ–¹å¼æ¥æé«˜ç»„ä»¶çš„æ€§èƒ½è¡¨ç°ã€‚è¿™æ„å‘³ç€åœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒReact å°†è·³è¿‡æ¸²æŸ“ç»„ä»¶çš„æ“ä½œå¹¶ç›´æ¥å¤ç”¨æœ€è¿‘ä¸€æ¬¡æ¸²æŸ“çš„ç»“æœã€‚ é»˜è®¤æƒ…å†µä¸‹å…¶åªä¼šå¯¹å¤æ‚å¯¹è±¡åšæµ…å±‚å¯¹æ¯”ï¼Œå¦‚æœä½ æƒ³è¦æ§åˆ¶å¯¹æ¯”è¿‡ç¨‹ï¼Œé‚£ä¹ˆè¯·å°†è‡ªå®šä¹‰çš„æ¯”è¾ƒå‡½æ•°é€šè¿‡ç¬¬äºŒä¸ªå‚æ•°ä¼ å…¥æ¥å®ç°ã€‚ function MyComponent(props) { /* ä½¿ç”¨ props æ¸²æŸ“ */ } function areEqual(prevProps, nextProps) { /* å¦‚æœæŠŠ nextProps ä¼ å…¥ render æ–¹æ³•çš„è¿”å›ç»“æœä¸ å°† prevProps ä¼ å…¥ render æ–¹æ³•çš„è¿”å›ç»“æœä¸€è‡´åˆ™è¿”å› trueï¼Œ å¦åˆ™è¿”å› false */ } export default React.memo(MyComponent, areEqual); æ­¤æ–¹æ³•ä»…ä½œä¸ºæ€§èƒ½ä¼˜åŒ–çš„æ–¹å¼è€Œå­˜åœ¨ã€‚ä½†è¯·ä¸è¦ä¾èµ–å®ƒæ¥â€œé˜»æ­¢â€æ¸²æŸ“ï¼Œå› ä¸ºè¿™ä¼šäº§ç”Ÿ bugã€‚ æ³¨æ„ ä¸ class ç»„ä»¶ä¸­ shouldComponentUpdate() æ–¹æ³•ä¸åŒçš„æ˜¯ï¼Œå¦‚æœ props ç›¸ç­‰ï¼ŒareEqual ä¼šè¿”å› trueï¼›å¦‚æœ props ä¸ç›¸ç­‰ï¼Œåˆ™è¿”å› falseã€‚è¿™ä¸ shouldComponentUpdate æ–¹æ³•çš„è¿”å›å€¼ç›¸åã€‚ é«˜é˜¶ç»„ä»¶æ˜¯å‚æ•°ä¸ºç»„ä»¶ï¼Œè¿”å›å€¼ä¸ºæ–°ç»„ä»¶çš„å‡½æ•°ã€‚ useCallbackå®˜æ–¹ï¼š æŠŠå†…è”å›è°ƒå‡½æ•°åŠä¾èµ–é¡¹æ•°ç»„ä½œä¸ºå‚æ•°ä¼ å…¥ useCallbackï¼Œå®ƒå°†è¿”å›è¯¥å›è°ƒå‡½æ•°çš„ memoized ç‰ˆæœ¬ï¼Œè¯¥å›è°ƒå‡½æ•°ä»…åœ¨æŸä¸ªä¾èµ–é¡¹æ”¹å˜æ—¶æ‰ä¼šæ›´æ–°ã€‚å½“ä½ æŠŠå›è°ƒå‡½æ•°ä¼ é€’ç»™ç»è¿‡ä¼˜åŒ–çš„å¹¶ä½¿ç”¨å¼•ç”¨ç›¸ç­‰æ€§å»é¿å…éå¿…è¦æ¸²æŸ“ï¼ˆä¾‹å¦‚ shouldComponentUpdateï¼‰çš„å­ç»„ä»¶æ—¶ï¼Œå®ƒå°†éå¸¸æœ‰ç”¨ã€‚ è¿™é‡Œå¼•å…¥ä¸€ä¸ªä¾‹å­ function Foo() { const [count, setCount] = useState(0); const handleClick() { console.log(`Click happened with dependency: ${count}`) } return &lt;Button onClick={handleClick}>Click Me&lt;/Button>; } è¿™é‡Œæ¯æ¬¡æ¸²æŸ“ï¼Œéƒ½ä¼šé€ æˆhandleClické‡æ–°åˆ›å»ºï¼Œç»™Buttonæ˜¯ä¸åŒçš„å¼•ç”¨ï¼Œç„¶åButtonä¹Ÿè·Ÿç€æ¸²æŸ“ã€‚ function Foo() { const [count, setCount] = useState(0); const memoizedHandleClick = useCallback( () => console.log(`Click happened with dependency: ${count}`), [count], ); return &lt;Button onClick={memoizedHandleClick}>Click Me&lt;/Button>; } æ­¤æ—¶åœ¨ä¾èµ–é¡¹countä¸å˜çš„æƒ…å†µä¸‹ï¼Œä»–ä¼šè¿”å›ç›¸åŒçš„å¼•ç”¨ï¼Œé¿å…Buttonæ— æ„ä¹‰çš„é‡å¤æ¸²æŸ“ã€‚ æºç èµæ function mountCallback&lt;T>(callback: T, deps: Array&lt;mixed> | void | null): T { const hook = mountWorkInProgressHook(); const nextDeps = deps === undefined ? null : deps; hook.memoizedState = [callback, nextDeps]; return callback; } function updateCallback&lt;T>(callback: T, deps: Array&lt;mixed> | void | null): T { const hook = updateWorkInProgressHook(); const nextDeps = deps === undefined ? null : deps; const prevState = hook.memoizedState; if (prevState !== null) { if (nextDeps !== null) { const prevDeps: Array&lt;mixed> | null = prevState[1]; if (areHookInputsEqual(nextDeps, prevDeps)) { return prevState[0]; } } } hook.memoizedState = [callback, nextDeps]; return callback; } useCallback(fn, deps) ç›¸å½“äº useMemo(() =&gt; fn, deps)ã€‚ useMemoconst memoizedValue = useMemo(() => computeExpensiveValue(a, b), [a, b]); æŠŠâ€œåˆ›å»ºâ€å‡½æ•°å’Œä¾èµ–é¡¹æ•°ç»„ä½œä¸ºå‚æ•°ä¼ å…¥ useMemoï¼Œå®ƒä»…ä¼šåœ¨æŸä¸ªä¾èµ–é¡¹æ”¹å˜æ—¶æ‰é‡æ–°è®¡ç®— memoized å€¼ã€‚è¿™ç§ä¼˜åŒ–æœ‰åŠ©äºé¿å…åœ¨æ¯æ¬¡æ¸²æŸ“æ—¶éƒ½è¿›è¡Œé«˜å¼€é”€çš„è®¡ç®—ã€‚ å…³äºuseCallbackå’ŒuseMemoæ›´æ·±ä¸€ä¾§çš„äº†è§£ï¼ˆåˆ©å¼Šå…³ç³»ï¼‰å¯ä»¥æŸ¥çœ‹https://jancat.github.io/post/2019/translation-usememo-and-usecallback/ï¼Œå®è´¨ä¸Šå¯ä»¥å½“æˆå¯¹æ—¶é—´ã€ç©ºé—´çš„åˆ†é…ç½®æ¢å…³ç³»æ¥çœ‹å°±è¡Œäº† ä½¿ç”¨åœºæ™¯ï¼š ä¸€ã€åº”è¯¥ä½¿ç”¨ useMemo çš„åœºæ™¯ ä¿æŒå¼•ç”¨ç›¸ç­‰ å¯¹äºç»„ä»¶å†…éƒ¨ç”¨åˆ°çš„ objectã€arrayã€å‡½æ•°ç­‰ï¼Œå¦‚æœç”¨åœ¨äº†å…¶ä»– Hook çš„ä¾èµ–æ•°ç»„ä¸­ï¼Œæˆ–è€…ä½œä¸º props ä¼ é€’ç»™äº†ä¸‹æ¸¸ç»„ä»¶ï¼Œåº”è¯¥ä½¿ç”¨ useMemoã€‚ è‡ªå®šä¹‰ Hook ä¸­æš´éœ²å‡ºæ¥çš„ objectã€arrayã€å‡½æ•°ç­‰ï¼Œéƒ½åº”è¯¥ä½¿ç”¨ useMemo ã€‚ä»¥ç¡®ä¿å½“å€¼ç›¸åŒæ—¶ï¼Œå¼•ç”¨ä¸å‘ç”Ÿå˜åŒ–ã€‚ ä½¿ç”¨ Context æ—¶ï¼Œå¦‚æœ Provider çš„ value ä¸­å®šä¹‰çš„å€¼ï¼ˆç¬¬ä¸€å±‚ï¼‰å‘ç”Ÿäº†å˜åŒ–ï¼Œå³ä¾¿ç”¨äº† Pure Component æˆ–è€… React.memoï¼Œä»ç„¶ä¼šå¯¼è‡´å­ç»„ä»¶ re-renderã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œä»ç„¶å»ºè®®ä½¿ç”¨ useMemo ä¿æŒå¼•ç”¨çš„ä¸€è‡´æ€§ã€‚ æˆæœ¬å¾ˆé«˜çš„è®¡ç®— æ¯”å¦‚ cloneDeep ä¸€ä¸ªå¾ˆå¤§å¹¶ä¸”å±‚çº§å¾ˆæ·±çš„æ•°æ® äºŒã€æ— éœ€ä½¿ç”¨ useMemo çš„åœºæ™¯ å¦‚æœè¿”å›çš„å€¼æ˜¯åŸå§‹å€¼ï¼š string, boolean, null, undefined, number, symbolï¼ˆä¸åŒ…æ‹¬åŠ¨æ€å£°æ˜çš„ Symbolï¼‰ï¼Œä¸€èˆ¬ä¸éœ€è¦ä½¿ç”¨ useMemoã€‚ ä»…åœ¨ç»„ä»¶å†…éƒ¨ç”¨åˆ°çš„ objectã€arrayã€å‡½æ•°ç­‰ï¼ˆæ²¡æœ‰ä½œä¸º props ä¼ é€’ç»™å­ç»„ä»¶ï¼‰ï¼Œä¸”æ²¡æœ‰ç”¨åˆ°å…¶ä»– Hook çš„ä¾èµ–æ•°ç»„ä¸­ï¼Œä¸€èˆ¬ä¸éœ€è¦ä½¿ç”¨ useMemoã€‚ æºç èµæ function mountMemo&lt;T>( nextCreate: () => T, deps: Array&lt;mixed> | void | null, ): T { const hook = mountWorkInProgressHook(); const nextDeps = deps === undefined ? null : deps; const nextValue = nextCreate(); hook.memoizedState = [nextValue, nextDeps]; return nextValue; } function updateMemo&lt;T>( nextCreate: () => T, deps: Array&lt;mixed> | void | null, ): T { const hook = updateWorkInProgressHook(); const nextDeps = deps === undefined ? null : deps; const prevState = hook.memoizedState; if (prevState !== null) { // Assume these are defined. If they're not, areHookInputsEqual will warn. if (nextDeps !== null) { const prevDeps: Array&lt;mixed> | null = prevState[1]; if (areHookInputsEqual(nextDeps, prevDeps)) { return prevState[0]; } } } const nextValue = nextCreate(); hook.memoizedState = [nextValue, nextDeps]; return nextValue; } useCallbackä½¿ç”¨åœºæ™¯ + æ­»å¾ªç¯https://segmentfault.com/a/1190000020108840 æ­»å¾ªç¯çš„å‡ºç°ï¼ˆé“¾æ¥é‡Œé¢çš„ä¸¤ä¸ªä¾‹å­ï¼‰ï¼š å­ç»„ä»¶çš„æ¸²æŸ“ä¾èµ–çˆ¶ç»„ä»¶ä¼ é€’çš„å‡½æ•°ï¼Œè€Œå‡½æ•°è¢«åœ¨è¢«è°ƒç”¨çš„æ—¶å€™ä¼šè§¦å‘çˆ¶ç»„ä»¶çš„æ¸²æŸ“ï¼Œä¼šå¯¼è‡´çˆ¶ç»„ä»¶å†…ï¼Œè¯¥å‡½æ•°çš„å¼•ç”¨å‘ç”Ÿæ”¹å˜ -&gt; ä¼ å…¥å­ç»„ä»¶å‡½æ•°å‘ç”Ÿæ”¹å˜ï¼Œå‡½æ•°å†æ¬¡è°ƒç”¨ -&gt; æ­»å¾ªç¯ å‡½æ•°ä¾èµ–è‡ªèº«è‡ªå®¶ç»„ä»¶çš„stateï¼ˆåŠ ä¸Šusecallbackï¼Œä½†ä¾èµ–åˆ—è¡¨ä¹Ÿè¦æ·»åŠ è‡ªèº«çš„stateï¼‰ï¼Œstateå‘ç”Ÿæ”¹å˜ï¼Œå¼•ç”¨å†æ¬¡æ”¹å˜ -&gt; å†è°ƒç”¨ï¼Œå†æ”¹å˜ï¼Œå†è°ƒç”¨ï¼Œå†æ”¹å˜ã€‚ è§£å†³æ–¹æ³•ï¼š å°†æ–¹æ³•ä¼ é€’ç»™å­ç»„ä»¶çš„æ—¶å€™åŒ…ä¸€å±‚useCallback è‡ªå®šä¹‰hook 14.React 17 | 18æ–°å¢ç‰¹æ€§ä¸€è§ˆï¼ˆä¸»è¦çš„ï¼Œä¹Ÿå¯ä»¥è¯´æ˜¯æˆ‘æ‰€å…³æ³¨çš„ï¼‰ ï¼ˆ1ï¼‰åœ¨React 16å’Œæ›´æ—©çš„ç‰ˆæœ¬ä¸­ï¼ŒReactå°†å¯¹å¤§å¤šæ•°äº‹ä»¶æ‰§è¡Œdocument.addEventListener()ã€‚ React 17å°†åœ¨åè°ƒç”¨rootNode.addEventListener()ã€‚ï¼ˆä¹Ÿå°±æ˜¯å°†äº‹ä»¶å§”æ‰˜ä» document åˆ‡æ¢ä¸º rootï¼‰ ä¸€å¼ å›¾æ˜ç¤ºä¸¤è€…çš„å·®å¼‚ )ï¼ˆ2) React 17æ”¯æŒæ–°çš„JSXè½¬æ¢ã€‚æˆ‘ä»¬è¿˜å°†å¯¹å®ƒæ”¯æŒåˆ°React 16.14.0ï¼ŒReact 15.7.0å’Œ0.14.10ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™æ˜¯å®Œå…¨é€‰æ‹©å¯ç”¨çš„ï¼Œæ‚¨ä¹Ÿä¸å¿…ä½¿ç”¨å®ƒã€‚ä¹‹å‰çš„JSXè½¬æ¢çš„æ–¹å¼å°†ç»§ç»­å­˜åœ¨ï¼Œå¹¶ä¸”æ²¡æœ‰è®¡åˆ’åœæ­¢å¯¹å…¶æ”¯æŒã€‚ æ›´å¤šï¼šhttps://juejin.cn/post/6885881513741647886 React18ï¼š ä»å¸¦æœ‰ createRoot çš„ React 18 å¼€å§‹ï¼Œæ‰€æœ‰æ›´æ–°éƒ½å°†è‡ªåŠ¨æ‰¹å¤„ç†ï¼Œæ— è®ºå®ƒä»¬æ¥è‡ªä½•å¤„ã€‚ï¼ˆä¹Ÿå°±æ˜¯è¯´ä¸ç”¨æˆ‘ä»¬è‡ªå·±ï¼‰ è¿™æ„å‘³ç€timeoutsã€promisesã€native eventså¤„ç†ç¨‹åºæˆ–ä»»ä½•å…¶ä»–äº‹ä»¶å†…çš„æ›´æ–°å°†ä»¥ä¸ React äº‹ä»¶å†…çš„æ›´æ–°ç›¸åŒçš„æ–¹å¼è¿›è¡Œæ‰¹å¤„ç†ã€‚æˆ‘ä»¬å¸Œæœ›è¿™ä¼šå¯¼è‡´æ›´å°‘çš„æ¸²æŸ“å·¥ä½œï¼Œä»è€Œåœ¨æ‚¨çš„åº”ç”¨ç¨‹åºä¸­è·å¾—æ›´å¥½çš„æ€§èƒ½ ReactDOM.createRoot(rootElement).render(&lt;App />); é€šå¸¸ï¼Œæ‰¹å¤„ç†æ˜¯å®‰å…¨çš„ï¼Œä½†æŸäº›ä»£ç å¯èƒ½ä¾èµ–äºåœ¨çŠ¶æ€æ›´æ”¹åç«‹å³ä» DOM ä¸­è¯»å–æŸäº›å†…å®¹ã€‚å¯¹äºè¿™äº›ç”¨ä¾‹ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ ReactDOM.flushSync() é€‰æ‹©é€€å‡ºæ‰¹å¤„ç†ï¼š import { flushSync } from 'react-dom'; // Note: react-dom, not react function handleClick() { flushSync(() => { setCounter(c => c + 1); }); // React ç°åœ¨å·²ç»æ›´æ–°äº† DOM flushSync(() => { setFlag(f => !f); }); // React ç°åœ¨å·²ç»æ›´æ–°äº† DOM } å¯¹äºä¹‹å‰ç”¨äºå¼‚æ­¥æ‰¹å¤„ç†çš„ unstable_batchedUpdatesï¼š è¿™ä¸ª API åœ¨ 18 ä¸­ä»ç„¶å­˜åœ¨ï¼Œä½†ä¸å†éœ€è¦å®ƒäº†ï¼Œå› ä¸ºæ‰¹å¤„ç†æ˜¯è‡ªåŠ¨å‘ç”Ÿçš„ã€‚æˆ‘ä»¬ä¸ä¼šåœ¨ 18 ä¸­åˆ é™¤å®ƒï¼Œå°½ç®¡åœ¨æµè¡Œçš„åº“ä¸å†ä¾èµ–äºå®ƒçš„å­˜åœ¨ä¹‹åï¼Œå®ƒå¯èƒ½ä¼šåœ¨æœªæ¥çš„ä¸»è¦ç‰ˆæœ¬ä¸­è¢«åˆ é™¤ã€‚ https://juejin.cn/post/6998763055685304356 15.Reactå…¶ä»–PortalPortalæä¾›äº†ä¸€ä¸ªæœ€å¥½çš„åœ¨çˆ¶ç»„ä»¶åŒ…å«DOMç»“æ„å±‚æ¬¡å¤–çš„DOMèŠ‚ç‚¹æ¸²æŸ“ç»„ä»¶çš„æ–¹æ³•ï¼ˆè¯´äººè¯å°±æ˜¯ï¼ŒæŠŠç»„ä»¶æ¸²æŸ“åˆ°rootä¹‹å¤–ï¼‰ï¼Œè¿™é‡Œçš„containeræ˜¯æŒ‡æŒ‚è½½çš„ä½ç½® ReactDOM.createPortal(child, container) åº”ç”¨åœºæ™¯ï¼šç»„ä»¶æƒ³è¦ä½œä¸ºæç¤ºçª—å£è¦†ç›–æ•´ä¸ªçª—å£ï¼ˆfixedï¼‰ï¼Œä½†æ˜¯å¯èƒ½å› ä¸ºçˆ¶ç›’å­ä½¿ç”¨äº†å®šä½+z-indexï¼Œå¯¼è‡´äº†ç»„ä»¶æœ¬èº«å®šä½çš„z-indexå†å¤§ï¼Œä¹Ÿæ— æ³•è¦†ç›–åˆ°å…¨å±€ æ­¤æ—¶åœ¨å†™ç»„ä»¶æ—¶ï¼Œæˆ‘ä»¬å°†å…¶å†™ä¸ºPortalç»„ä»¶ import { createPortal } from 'react-dom' export default function Dialog() { return createPortal( Dialog, document.body ) } è™½ç„¶é€šè¿‡Portalæ¸²æŸ“çš„ç»„ä»¶åœ¨çˆ¶ç»„ä»¶ç›’å­ä¹‹å¤–ï¼Œä½†æ˜¯æ¸²æŸ“çš„domèŠ‚ç‚¹ä»ç„¶åœ¨Reactå…ƒç´ æ ‘ä¸Šï¼Œåœ¨é‚£ä¸ªdomå…ƒç´ ä¸Šçš„ç‚¹å‡»äº‹ä»¶ä»ç„¶èƒ½åœ¨domæ ‘ä¸­ç›‘å¬åˆ°ï¼ˆä»ç„¶ä¼šå†’æ³¡å†’åˆ°çˆ¶èŠ‚ç‚¹ä¸Šï¼‰ React.StrictModeStrictMode æ˜¯ä¸€ä¸ªç”¨ä»¥æ ‡è®°å‡ºåº”ç”¨ä¸­æ½œåœ¨é—®é¢˜çš„å·¥å…·ã€‚å°±åƒ Fragment ï¼ŒStrictMode ä¸ä¼šæ¸²æŸ“ä»»ä½•çœŸå®çš„UIã€‚å®ƒä¸ºå…¶åä»£å…ƒç´ è§¦å‘é¢å¤–çš„æ£€æŸ¥å’Œè­¦å‘Šã€‚ ä½†æ˜¯æœ‰ä¸ªå°å‘ï¼šReact.StrictMode å¤šæ¬¡è°ƒç”¨é—®é¢˜ï¼Œå¯¼è‡´è¿™ä¸ªå‡½æ•°ç»„ä»¶è¢«è°ƒç”¨äº†ä¸¤æ¬¡ã€‚","categories":[{"name":"å‰ç«¯","slug":"å‰ç«¯","permalink":"https://taylor12138.github.io/categories/%E5%89%8D%E7%AB%AF/"}],"tags":[],"author":"Hello"},{"title":"Nextjs","slug":"Nextjs","date":"2022-06-26T16:02:27.806Z","updated":"2022-07-17T12:34:09.159Z","comments":true,"path":"2022/06/27/nextjs/","link":"","permalink":"https://taylor12138.github.io/2022/06/27/nextjs/","excerpt":"","text":"1.Next.jså¼€ç«¯è‹±æ–‡å®˜ç½‘ï¼šhttps://nextjs.org/ ä¸­æ–‡å®˜ç½‘ï¼šhttps://www.nextjs.cn/docs/getting-started æ­å»ºé¡¹ç›® yarn create next-app æˆ–è€… npx create-next-app@latest ä½¿ç”¨Nextjsæ­å»ºSSRä¼˜ç‚¹ï¼š æ­å»ºè½»æ¾ è‡ªå¸¦æ•°æ®åŒæ­¥ SSR ä¸°å¯Œæ’ä»¶ çµæ´»é…ç½® 2.è·¯ç”±next.jsæ˜¯çº¦å®šå¼è·¯ç”±ç›´æ¥åœ¨pagesæ–‡ä»¶å¤¹ä¸‹å¯¹åº”çš„è·¯ç”±é¡µé¢ æ¯”å¦‚æˆ‘è¦æ–°å»ºä¸€ä¸ªdetailé¡µé¢ï¼ˆlocalhost:3000/detialï¼‰ è·¯ç”±è·³è½¬Linkæ–¹å¼ import Link from \"next/link\"; export default function Home() { return ( &lt;Link href=\"/detail/1\"> &lt;a>Go to pages/detail/1&lt;/a> &lt;/Link> &lt;/div> ); } è¿æ¥åˆ°åŠ¨æ€è·¯å¾„ï¼š //æ–¹æ³•ä¸€ &lt;Link href={`/blog/${encodeURIComponent(post.slug)}`}> &lt;a>{post.title}&lt;/a> &lt;/Link> //æ–¹æ³•äºŒ &lt;Link href={{ pathname: '/blog/[slug]', query: { slug: post.slug }, }} > &lt;a>{post.title}&lt;/a> &lt;/Link> å®¢æˆ·ç«¯å¯¼èˆª è¯¥Linkç»„ä»¶æ”¯æŒåœ¨åŒä¸€ä¸ª Next.js åº”ç”¨ç¨‹åºä¸­çš„ä¸¤ä¸ªé¡µé¢ä¹‹é—´è¿›è¡Œå®¢æˆ·ç«¯å¯¼èˆªã€‚ å®¢æˆ·ç«¯å¯¼èˆªæ„å‘³ç€ä½¿ç”¨ JavaScriptè¿›è¡Œé¡µé¢è½¬æ¢ï¼Œè¿™æ¯”æµè§ˆå™¨å®Œæˆçš„é»˜è®¤å¯¼èˆªè¦å¿«ã€‚ è¿™æ˜¯æ‚¨å¯ä»¥éªŒè¯çš„ç®€å•æ–¹æ³•ï¼š ä½¿ç”¨æµè§ˆå™¨çš„å¼€å‘è€…å·¥å…·å°†backgroundCSS å±æ€§æ›´æ”¹&lt;html&gt;ä¸ºyellowã€‚ å•å‡»é“¾æ¥å¯åœ¨ä¸¤ä¸ªé¡µé¢ä¹‹é—´æ¥å›åˆ‡æ¢ã€‚ æ‚¨ä¼šçœ‹åˆ°é»„è‰²èƒŒæ™¯åœ¨é¡µé¢è½¬æ¢ä¹‹é—´æŒç»­å­˜åœ¨ã€‚ ç¼–ç¨‹å¼å¯¼èˆª ä½¿ç”¨ä¸€ä¸ªuseRouterï¼Œå’ŒReactä¸­çš„useHistoryç”¨èµ·æ¥å·®ä¸å¤š è¦è®¿é—® React ç»„ä»¶ä¸­çš„routerå¯¹è±¡ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨useRouteræˆ–withRouterã€‚ ä¸€èˆ¬æ¥è¯´ï¼Œæˆ‘ä»¬å»ºè®®ä½¿ç”¨useRouter. import React from \"react\"; import { useRouter } from \"next/router\"; export default function Detial() { const router = useRouter(); const linkToHome = () => { router.push(\"/\"); }; return ( &lt;div> &lt;button onClick={linkToHome}>ç‚¹å‡»è·³è½¬åˆ°é¦–é¡µ&lt;/button> &lt;/div> ); } åµŒå¥—è·¯ç”±å¯¹äºå¤šçº§åµŒå¥—è·¯ç”±ï¼Œå¯ä»¥ç›´æ¥åœ¨è¯¥è·¯ç”±æ–‡ä»¶å¤¹ä¸‹ ï¼ˆäºŒçº§è·¯ç”±ï¼‰ï¼šç›´æ¥å†™è·¯ç”±å + jsæ–‡ä»¶ ï¼ˆåµŒå¥—å¤šçº§è·¯ç”±ï¼‰ï¼šæ–°å»ºæ–‡ä»¶å¤¹ï¼Œæ–‡ä»¶å¤¹åä¸ºè·¯ç”±åï¼Œå†æ–°å»ºindex.jsæ–‡ä»¶ pages/blog/first-post.jsâ†’/blog/first-post pages/dashboard/settings/username.jsâ†’/dashboard/settings/username åŠ¨æ€è·¯ç”±è¦åŒ¹é…åŠ¨æ€æ®µï¼Œæ‚¨å¯ä»¥ä½¿ç”¨æ‹¬å·è¯­æ³•ã€‚è¿™å…è®¸æ‚¨åŒ¹é…å‘½åå‚æ•°ã€‚ pages/blog/[slug].js â†’ /blog/:slug (/blog/hello-world) pages/[username]/settings.js â†’ /:username/settings (/foo/settings) pages/post/[...all].js â†’ /post/* (/post/2020/id/title) è·¯ç”±ä¼ å‚nextjsä¼ å‚æ–¹å¼ä¸€å…±ä¸¤ç§ï¼š åŠ¨æ€è·¯ç”±ä¼ å‚ å¯¹äºparamsä¼ å‚æ–¹å¼ï¼Œæ–°å»ºæ–‡ä»¶ [è‡ªå®šä¹‰å‚æ•°å].jsï¼ˆå¯è§ä¸Šå›¾ï¼‰ï¼Œæ­¤æ—¶é€šè¿‡urlè·¯ç”±åœ°å€å¯¼å‘ï¼Œå°±å¯ä»¥è·å–å¯¹åº”çš„paramså‚æ•°ï¼ˆä¾ç„¶æ˜¯é€šè¿‡useRouterçš„hookï¼‰ const id = 1 // Link aså†…æ˜¯å‚æ•° import Link from 'next/link'; &lt;Link href={`/details/${id}`>&lt;a>è·³è½¬&lt;/a>&lt;/Link> // router import { useRouter } from 'next/router'; const router = useRouter(); router.push(`/details/${id}`); // detailsæ¥æ”¶å‚æ•°ID import { useRouter } from 'next/router'; export default function details() { const router = useRouter(); const { id }: any = router.query; console.log(id); } queryä¼ å‚ // Link import Link from 'next/link'; &lt;Link href={{ pathname: '/b', query: { name: 'å¼ ä¸‰', age: '18', work: 'å‰ç«¯å¼€å‘' } }}>&lt;a>è·³è½¬&lt;/a>&lt;/Link> // router import { useRouter } from 'next/router'; const router = useRouter(); router.push('/first?name=å¼ æ€å­¦&amp;age=18&amp;work=å‰ç«¯å¼€å‘'); // é¡µé¢æ¥æ”¶å‚æ•° import { useRouter } from 'next/router'; const router = useRouter(); const { name, age, work }: any = router.query; console.log(name, age, work); æ¥æ”¶åç«¯æœåŠ¡å¯¹äºåç«¯æ•°æ®æ¥æ”¶ï¼Œè¦åœ¨pages/apiæ–‡ä»¶å¤¹ä¸‹è¿›è¡Œå¯¹åç«¯æ¥å£çš„æ•°æ®è·å–ï¼ˆä½œä¸ºnodeä¸­é—´ä»¶ï¼‰ å®˜æ–¹ï¼špages/api ç›®å½•ä¸‹çš„ä»»ä½•æ–‡ä»¶éƒ½å°†ä½œä¸º API ç«¯ç‚¹æ˜ å°„åˆ° /api/*ï¼Œè€Œä¸æ˜¯ pageã€‚è¿™äº›æ–‡ä»¶åªä¼šå¢åŠ æœåŠ¡ç«¯æ–‡ä»¶åŒ…çš„ä½“ç§¯ï¼Œè€Œä¸ä¼šå¢åŠ å®¢æˆ·ç«¯æ–‡ä»¶åŒ…çš„å¤§å°ã€‚ æ­¤æ—¶æœ€å¥½è®¾å®šä¸pagesé¡µé¢ä¸€ä¸€å¯¹åº”çš„æ–‡ä»¶å‘½åæ ¼å¼è¿›è¡Œè·å–ï¼Œæ¯”å¦‚å¯¹äº detail/[id].jsé¡µé¢å¯¹åº”çš„å°±æ˜¯ apiæ–‡ä»¶å¤¹ä¸‹ detail/[id].jsçš„api //api/detail/[id].js const fn = (req, res) => { res.status(200).json({ name: \"Allen\" }); }; export default fn; //detail/[id].js import React, { useEffect } from \"react\"; import { useRouter } from \"next/router\"; export default function Detial() { const router = useRouter(); const { id } = router.query; useEffect(() => { id &amp;&amp; fetch(`/api/detail/${id}`) .then((res) => res.json()) .then((json) => { console.log(json); }); }, [id]); return &lt;div>Detialid: {id}&lt;/div>; } å½“ç„¶ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥å°è¯•åœ¨http://localhost:3000/api/helloè®¿é—®å®ƒã€‚ä½ åº”è¯¥çœ‹åˆ°`{&quot;text&quot;:&quot;Hello&quot;}`ã€‚æ³¨æ„ï¼š reqæ˜¯http.IncomingMessageçš„ä¸€ä¸ªå®ä¾‹ï¼Œä»¥åŠä¸€äº›æ‚¨å¯ä»¥åœ¨æ­¤å¤„çœ‹åˆ°çš„é¢„æ„å»ºä¸­é—´ä»¶ã€‚ resæ˜¯http.ServerResponseçš„ä¸€ä¸ªå®ä¾‹ï¼Œä»¥åŠä¸€äº›æ‚¨å¯ä»¥åœ¨æ­¤å¤„çœ‹åˆ°çš„å¸®åŠ©å‡½æ•°ã€‚ æ•è·æ‰€æœ‰åç«¯æœåŠ¡API çš„è·¯ç”±é€šè¿‡åœ¨æ–¹æ‹¬å·å†…æ·»åŠ ä¸‰ä¸ªè‹±æ–‡å¥ç‚¹ (...) å³å¯å°† API è·¯ç”±æ‰©å±•ä¸ºèƒ½å¤Ÿæ•è·æ‰€æœ‰è·¯å¾„çš„è·¯ç”±ã€‚ä¾‹å¦‚ï¼š pages/api/post/[...slug].js åŒ¹é… /api/post/aï¼Œä¹ŸåŒ¹é… /api/post/a/bã€/api/post/a/b/c ç­‰ã€‚ æ³¨æ„ï¼šslug å¹¶ä¸æ˜¯å¿…é¡»ä½¿ç”¨çš„ï¼Œä½ ä¹Ÿå¯ä»¥ä½¿ç”¨ [...param] è·¯ç”±æ•è·é¡ºåºå’Œè§„åˆ™ é¢„å®šä¹‰çš„ API è·¯ç”±ä¼˜å…ˆäºåŠ¨æ€ API è·¯ç”±ï¼Œè€ŒåŠ¨æ€ API è·¯ç”±ä¼˜å…ˆäºæ•è·æ‰€æœ‰ API çš„è·¯ç”±ã€‚çœ‹ä¸‹é¢çš„ä¾‹å­ï¼š pages/api/post/create.js - å°†åŒ¹é… /api/post/create pages/api/post/[pid].js - å°†åŒ¹é… /api/post/1, /api/post/abc ç­‰ï¼Œä½†ä¸åŒ¹é… /api/post/create pages/api/post/[...slug].js - å°†åŒ¹é… /api/post/1/2, /api/post/a/b/c ç­‰ï¼Œä½†ä¸åŒ¹é… /api/post/createã€/api/post/abc æµ…è·¯ç”±æµ…è·¯ç”±å…è®¸æ‚¨æ›´æ”¹ URL è€Œæ— éœ€å†æ¬¡è¿è¡Œæ•°æ®è·å–æ–¹æ³•ï¼ŒåŒ…æ‹¬getServerSidePropsã€getStaticPropså’ŒgetInitialProps. æ‚¨å°†æ”¶åˆ°æ›´æ–°pathnameçš„å’Œqueryé€šè¿‡routerå¯¹è±¡ï¼ˆç”±useRouteroræ·»åŠ withRouterï¼‰ï¼Œè€Œä¸ä¼šä¸¢å¤±çŠ¶æ€ã€‚ è¦å¯ç”¨æµ…å±‚è·¯ç”±ï¼Œè¯·å°†shallowé€‰é¡¹è®¾ç½®ä¸ºtrueã€‚ å¯ä»¥çœ‹å®˜æ–¹æ–‡æ¡£ï¼Œå†™çš„å¤Ÿæ˜ç™½äº†ï¼šhttps://www.nextjs.cn/docs/routing/shallow-routing è·¯ç”±äº‹ä»¶å¯ä»¥çœ‹æˆvueçš„è·¯ç”±å®ˆå«ï¼ˆè·¯ç”±ç”Ÿå‘½å‘¨æœŸå‡½æ•°ï¼‰ routeChangeStart è·¯ç”±å¼€å§‹å‘ç”Ÿå˜åŒ– routeChangeComplete è·¯ç”±å‘ç”Ÿå˜åŒ–ä¹‹å beforeHistoryChange historyæ¨¡å¼ä¸‹è·¯ç”±å‘ç”Ÿå˜åŒ– routeChangeError è·¯æœ‰å˜åŒ–å‘ç”Ÿé”™è¯¯çš„æ—¶å€™ hashChangeStart hashå¼€å§‹å‘ç”Ÿå˜åŒ– hashChangeStart hashå¼€å§‹å‘ç”Ÿå˜åŒ– æ³¨æ„ï¼šè¿™é‡Œéœ€è¦æŠŠè·¯ç”±äº‹ä»¶ç›‘å¬æ”¾åœ¨useEffecté‡Œï¼Œæ¯æ¬¡å¸è½½é¡µé¢çš„æ—¶å€™æŠŠç›‘å¬ä¹Ÿå¸è½½æ‰ï¼Œå¦åˆ™æ¯æ¬¡é¡µé¢è·³è½¬éƒ½ä¼šåˆ›å»ºæ–°çš„äº‹ä»¶ç›‘å¬ï¼Œä¼šè¶Šæ¥è¶Šå¤š import React, { useEffect } from \"react\"; import { Router } from \"next/dist/client/router\"; useEffect(() => { Router.events.on(\"routeChangeStart\", (...args) => { console.log(\"routeChangeStartå‚æ•°\", ...args); }); }, []); return &lt;div>DEtial&lt;/div>; } 3.æœåŠ¡ç«¯æ¸²æŸ“getInitialPropsgetInitialPropsåœ¨é¡µé¢ä¸­å¯ç”¨æœåŠ¡å™¨ç«¯æ¸²æŸ“å¹¶å…è®¸æ‚¨è¿›è¡Œåˆå§‹æ•°æ®å¡«å……ï¼Œè¿™æ„å‘³ç€å‘é€é¡µé¢æ—¶å·²ä»æœåŠ¡å™¨å¡«å……äº†æ•°æ®ã€‚è¿™å¯¹SEOå°¤å…¶æœ‰ç”¨ï¼›æ‰€ä»¥getInitialPropsç”¨äºå¼‚æ­¥è·å–ä¸€äº›æ•°æ®ï¼Œç„¶åå¡«å……props. ä¸ªäººæ„Ÿè§‰æœ‰ç‚¹react-reduxä¸­ä½¿ç”¨connectæ–¹æ³•ä¼ å…¥uiç»„ä»¶ç¬¬ä¸€ä¸ªå‚æ•°mapDispatchToPropsçš„å‘³é“åœ¨é‡Œé¢ æ¨èï¼š getStaticProps æˆ– getServerSidePropsã€‚ å¦‚æœä½ ä½¿ç”¨çš„æ˜¯ Next.js 9.3 æˆ–æ›´é«˜ç‰ˆæœ¬ï¼Œæˆ‘ä»¬å»ºè®®ä½ ä½¿ç”¨ getStaticProps æˆ– getServerSideProps æ¥æ›¿ä»£ getInitialPropsã€‚ function Page({ stars }) { return &lt;div>Next stars: {stars}&lt;/div> } Page.getInitialProps = async (ctx) => { const res = await fetch('https://api.github.com/repos/vercel/next.js') const json = await res.json() return { stars: json.stargazers_count } } export default Page SSGï¼ˆgetStaticPropsï¼‰å¯¹äºæ¯ä¸ªç”¨æˆ·åŸºæœ¬ä¸€è‡´çš„é™æ€é¡µé¢ï¼Œå¯ä»¥ä½¿ç”¨SSGï¼ˆæ„å»ºbuildæ—¶æ¸²æŸ“é¡µé¢ï¼‰ ä¼˜ç‚¹ï¼šè¿™ç§æ–¹å¼å¯ä»¥è§£å†³ç™½å±é—®é¢˜ã€SEO é—®é¢˜ ç¼ºç‚¹ï¼šæ‰€æœ‰ç”¨æˆ·çœ‹åˆ°çš„éƒ½æ˜¯åŒä¸€ä¸ªé¡µé¢ï¼Œæ— æ³•ç”Ÿæˆç”¨æˆ·ç›¸å…³å†…å®¹ æ•ˆæœï¼šå¦‚æœåŠ¨æ€å†…å®¹ä¸ç”¨æˆ·æ— å…³ï¼Œé‚£ä¹ˆå¯ä»¥æå‰é™æ€åŒ–ï¼Œé€šè¿‡ getStaticProps å¯ä»¥è·å–æ•°æ®é™æ€å†…å®¹+æ•°æ®(æœ¬åœ°è·å–) å°±å¾—åˆ°äº†å®Œæ•´çš„é¡µé¢ï¼Œä»£æ›¿äº†ä¹‹å‰çš„ é™æ€å†…å®¹+åŠ¨æ€å†…å®¹(AJAX è·å–) å®é™…ç”¨ä¾‹ï¼š è¥é”€é¡µé¢ åšå®¢æ–‡ç« å’Œä¸ªäººç®€å† ç”µå•†äº§å“åˆ—è¡¨ å¸®åŠ©å’Œæ–‡æ¡£ å®ç°ï¼šé€šè¿‡getStaticProps è·å– æ•°æ® import {getPosts} from '../../lib/posts'; export default function Home(props) { console.log(props); return ( &lt;div className={styles.container} /> ); } export const getStaticProps = async (context) => { const posts = await getPosts(); return { props: { posts: [{ name: \"allen\" }, { name: \"mikasa\" }, { name: \"armin\" }], }, }; }; /*typescript export const getStaticProps: GetStaticProps = async (context) => { // ... } */ é™æ€åŒ–çš„æ—¶æœº ç¯å¢ƒ åœ¨ å¼€å‘ç¯å¢ƒ ï¼Œæ¯æ¬¡è¯·æ±‚éƒ½ä¼šè¿è¡Œä¸€æ¬¡ getStaticProps è¿™æ˜¯ä¸ºäº†æ–¹ä¾¿ä½ ä¿®æ”¹ä»£ç é‡æ–°è¿è¡Œ åœ¨ ç”Ÿäº§ç¯å¢ƒï¼ŒgetStaticProps åªåœ¨ build æ˜¯è¿è¡Œä¸€æ¬¡ï¼Œè¿™æ ·å¯ä»¥æä¾›ä¸€ä»½ HTML ç»™æ‰€æœ‰çš„ç”¨æˆ·ä¸‹è½½ æ³¨æ„ï¼šæ‚¨ä¸åº”è¯¥ä½¿ç”¨fetch()åœ¨getStaticProps. ç›¸åï¼Œç›´æ¥å¯¼å…¥ API è·¯ç”±ä¸­ä½¿ç”¨çš„é€»è¾‘ã€‚æ‚¨å¯èƒ½éœ€è¦é’ˆå¯¹è¿™ç§æ–¹æ³•ç¨å¾®é‡æ„æ‚¨çš„ä»£ç ã€‚ ä»å¤–éƒ¨ API è·å–å¾ˆå¥½ï¼ getStaticPathsè¯¥æ–¹æ³•é€‚ç”¨äºï¼šæ¯ä¸ªé¡µé¢è·¯å¾„éƒ½ä¾èµ–äºå¤–éƒ¨æ•°æ®çš„æƒ…å†µ è€Œä¸”å¦‚æœé¡µé¢å…·æœ‰åŠ¨æ€è·¯ç”±ï¼ˆæ¯”å¦‚ [id].jsï¼‰ï¼ˆæ–‡æ¡£ï¼‰å¹¶ä½¿ç”¨getStaticPropså®ƒï¼Œåˆ™éœ€è¦å®šä¹‰å¿…é¡»åœ¨æ„å»ºæ—¶å‘ˆç°ä¸º HTML çš„è·¯å¾„åˆ—è¡¨ã€‚ å¦‚æœæ‚¨å¯¼å‡ºä»ä½¿ç”¨åŠ¨æ€è·¯ç”±çš„é¡µé¢asyncè°ƒç”¨çš„å‡½æ•°getStaticPathsï¼ŒNext.js å°†é™æ€é¢„æ¸²æŸ“æ‰€æœ‰ç”±getStaticPaths. import Layout from '../../components/layout' export default function Component() { return &lt;Layout>...&lt;/Layout> } export async function getStaticPaths() { return { paths: [ { params: { ... } } // è¿”å›çš„æ¯ä¸ªpathsæ•°ç»„ä¸­æ¯ä¸€ä¸ªå…ƒç´ éƒ½æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œä¸”å¿…é¡»æœ‰paramså±æ€§ ], fallback: true, false, or 'blocking' // See the \"fallback\" section below }; } export async function getStaticProps({ params }) { // Fetch necessary data for the blog post using params.id } ç„¶ågetStaticPathsçš„è¿”å›å€¼å°†ä½œä¸ºå‚æ•°ä¼ é€’ç»™getStaticProps è¯¦æƒ…å¯ä»¥çœ‹å®˜ç½‘å¯¹pathã€fallbackå±æ€§ï¼ˆä¸ºåŠ è½½å®Œæˆæ—¶å±•ç¤ºfallback pagesï¼‰çš„ä»‹ç»https://www.nextjs.cn/docs/basic-features/data-fetching#getstaticpaths-static-generation æ³¨æ„ï¼šä¸è¦åœ¨getStaticProps æˆ–è€… getStaticPathså¯¹åç«¯è·¯ç”±æœåŠ¡çš„apiï¼ˆä¹Ÿå°±æ˜¯ä¸Šæ–¹æåŠåˆ°çš„æ¥æ”¶åç«¯æœåŠ¡ï¼‰å‘è¯·æ±‚ï¼Œä½ åº”è¯¥æŠŠæœåŠ¡ç«¯å®šæ­»çš„ä»£ç ç›´æ¥å†™åˆ°getStaticProps æˆ–è€… getStaticPathsä¸­ï¼Œæ¯•ç«Ÿå®ƒä»¬ä¿©åªèƒ½åœ¨æœåŠ¡ç«¯è·‘ï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬å¯ä»¥ç¼–å†™è¯¸å¦‚ç›´æ¥æ•°æ®åº“æŸ¥è¯¢ä¹‹ç±»çš„ä»£ç  SSRï¼ˆgetServerSidePropsï¼‰é¦–å±æ¸²æŸ“å¿«ï¼Œä½†æ˜¯æ‹¿æ•°æ®çš„è¯è¿˜æ˜¯ç­‰åˆ°ç”¨æˆ·å‘é€è¯·æ±‚åå†å»åç«¯æ‹¿å»æ•°æ®ï¼ˆè¯·æ±‚æ—¶æ¸²æŸ“é¡µé¢ï¼‰ï¼Œç”Ÿæˆç›¸åº”htmlåœ¨è¿”å›ç»™å®¢æˆ·ç«¯ å®ç°ï¼šé€šè¿‡getSeverSideProps è·å– æ•°æ® //æœåŠ¡å™¨å“åº”è¯·æ±‚åè·å–æµè§ˆå™¨ä¿¡æ¯ï¼Œè¿”å›ç»™å‰ç«¯å±•ç¤º export const getServerSideProps: GetServerSideProps = async (context) => { const headers:IncomingHttpHeaders = context.req.headers; const browser = headers['user-agent']; return { props: { browser } }; }; å‚è€ƒæ–‡ç« https://zhuanlan.zhihu.com/p/341229054 nextjsä¼˜åŒ–(1)è‡ªèº«ä¼˜åŒ–å›¾ç‰‡ä¼˜åŒ–import Image from \"next/image\"; å¯¹å›¾ç‰‡çš„ä¼˜åŒ–ï¼š å°†å›¾ç‰‡è½¬æ¢ä¸º æ¸è¿›å¼å›¾ç‰‡ï¼ˆå…ˆæ˜¾ç¤ºä¸€ä¸ªæå°çš„èƒŒæ™¯å›¾ï¼Œä½¿ç”¨cssçš„filterå±æ€§æ¨¡ç³ŠåŒ–ï¼‰ï¼Œç­‰åˆ°å›¾ç‰‡åŠ è½½å®Œæˆå†æ›¿æ¢ä¸ºçœŸæ­£çš„å›¾ç‰‡ æœ¬åœ°å›¾ç‰‡æ²¡è®¾ç½®å®½é«˜ä¹Ÿä¸ä¼šæœ‰å¸ƒå±€åç§»é—®é¢˜ï¼ˆæœ¬èº«ä½¿ç”¨ä¸€ä¸ªSVGå¸¦æœ‰heightå’Œwidthè¿›è¡Œå ä½ï¼Œä½¿å¾—å‘¨è¾¹çš„å¸ƒå±€ä¸ä¼šå½“å›¾ç‰‡åŠ è½½å‡ºæ¥çš„æ—¶å€™å‘ç”Ÿä½ç½®åç§»ï¼‰ é»˜è®¤åŠ ä¸Šsrcsetå±æ€§æ¥é€‚é…ä¸åŒçš„ devicePixelRatio ï¼ˆåƒç´ æ¯”ï¼‰çš„å±å¹•ï¼Œæ˜¾ç¤ºå’ŒåŠ è½½1å€å›¾ or 2å€å›¾ é»˜è®¤è¿”å›å‹ç¼©åçš„å›¾ç‰‡ï¼ˆtypeï¼šwebpï¼‰ æ”¯æŒæ‡’åŠ è½½ æ”¯æŒç»™å›¾ç‰‡è®¾ç½®ä¼˜å…ˆçº§ å…·ä½“ç»†èŠ‚å¯ä»¥çœ‹https://github.com/findxc/blog/issues/68 (2)å¼€å‘è€…å®šä¹‰çš„ä¼˜åŒ–nextå¼‚æ­¥æ‡’åŠ è½½ä½¿ç”¨æ‡’åŠ è½½æ–¹æ³•ï¼šåŒ ã€ŠPC&amp;ç§»åŠ¨ç«¯ç½‘é¡µç‰¹æ•ˆ(JS)ã€‹ä¸­é˜è¿°åˆ°çš„ï¼Œç›´æ¥importå³å¯ ä½¿ç”¨æ‡’åŠ è½½ç»„ä»¶ï¼š import React, { useState } from \"react\"; import dynamic from 'next/dynamic' const More = dynamic(import('./more')) export default function Detial() { return ( &lt;div> &lt;More>&lt;/More> &lt;/div> ); } è‡ªå®šä¹‰headä¼˜åŒ–SEOå¦‚æœæˆ‘ä»¬æƒ³è¦ä¿®æ”¹ç½‘é¡µå…ƒæ•°æ®ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ Head ç»„ä»¶ title: ä¸€èˆ¬æœ‰ä¸¤ç§æ–¹æ³•ï¼šæ¯ä¸ªé¡µé¢éƒ½å®šä¹‰ä¸€ä¸ªtitleï¼Œæˆ–è€…å…¨å±€title import React from \"react\"; import Head from \"next/head\"; export default function Header() { return ( &lt;div> &lt;Head> &lt;title>æ’’æ’’ç»™ï¼ŒAllen&lt;/title> &lt;meta charSet=\"utf-8\">&lt;/meta> &lt;/Head> &lt;/div> ); } å…¨å±€çš„è¯å°±æ˜¯è‡ªå·±å°è£…MyHeadç»„ä»¶ï¼Œç„¶åå†æ¯ä¸ªç»„ä»¶å†…éƒ¨å¼•ç”¨å³å¯","categories":[{"name":"å‰ç«¯","slug":"å‰ç«¯","permalink":"https://taylor12138.github.io/categories/%E5%89%8D%E7%AB%AF/"}],"tags":[],"author":"Hello"},{"title":"HTML5çš„åŸºæœ¬å±æ€§","slug":"HTML5çš„åŸºæœ¬å±æ€§","date":"2022-06-26T08:39:45.813Z","updated":"2023-06-12T07:39:02.288Z","comments":true,"path":"2022/06/26/html5-de-ji-ben-shu-xing/","link":"","permalink":"https://taylor12138.github.io/2022/06/26/html5-de-ji-ben-shu-xing/","excerpt":"","text":"1.åŸºæœ¬æ ‡ç­¾ä»‹ç»&lt;html&gt;&lt;/html&gt;æ ¹æ ‡ç­¾ &lt;head&gt; &lt;/head&gt; æ–‡æ¡£å¤´éƒ¨ &lt;title&gt; &lt;/title&gt; æ–‡æ¡£æ ‡é¢˜ &lt;body&gt;&lt;/body&gt; æ–‡æ¡£ä¸»ä½“ é¡µé¢è§£æé¡ºåºï¼š ï¼ˆ1ï¼‰å…ˆè§£æheadæ ‡ç­¾ä¸­çš„ä»£ç ï¼Œheadæ ‡ç­¾ä¸­ä¼šåŒ…å«ä¸€äº›å¼•ç”¨å¤–éƒ¨æ–‡ä»¶çš„ä»£ç ï¼Œå°±ä¼šå¼€å§‹ä¸‹è½½è¿™äº›è¢«å¼•ç”¨çš„å¤–éƒ¨æ–‡ä»¶ å½“é‡åˆ°scriptæ ‡ç­¾çš„æ—¶å€™æµè§ˆå™¨æš‚åœè§£æï¼ˆç›¸å…³è„šæœ¬ä¼šç«‹å³ä¸‹è½½å¹¶æ‰§è¡Œï¼‰ï¼Œå°†æ§åˆ¶æƒäº¤ç»™JavaScriptå¼•æ“ï¼ˆè§£é‡Šå™¨ï¼‰å¦‚æœscriptæ ‡ç­¾å¼•ç”¨äº†å¤–éƒ¨è„šæœ¬ï¼Œå°±ä¸‹è½½è¯¥è„šæœ¬ï¼Œå¦åˆ™å°±ç›´æ¥æ‰§è¡Œï¼Œæ‰§è¡Œå®Œæ¯•åå°†æ§åˆ¶æƒäº¤ç»™æµè§ˆå™¨ å½“é‡åˆ°ä¸€ä¸ªCSSæ–‡ä»¶æ—¶ï¼Œè§£æä¹Ÿå¯ä»¥ç»§ç»­è¿›è¡Œ ï¼ˆ2ï¼‰ç„¶åè§£æbodyä¸­çš„ä»£ç ï¼ˆå¦‚æœæ­¤æ—¶headä¸­å¼•ç”¨çš„å¤–éƒ¨æ–‡ä»¶æ²¡æœ‰ä¸‹è½½å®Œï¼Œå°†ä¼šç»§ç»­ä¸‹è½½ï¼‰ å¦‚æœæ­¤æ—¶é‡åˆ°bodyæ ‡ç­¾ä¸­çš„scriptï¼ŒåŒæ ·ä¼šå°†æ§åˆ¶æƒäº¤ç»™JavaScriptå¼•æ“æ¥è§£æJavaScriptï¼Œè§£æå®Œæ¯•åå°†æ§åˆ¶æƒäº¤è¿˜ç»™æµè§ˆå™¨æ¸²æŸ“å¼•æ“ã€‚ ï¼ˆ3ï¼‰å½“bodyä¸­çš„ä»£ç å…¨éƒ¨æ‰§è¡Œå®Œæ¯•ã€å¹¶ä¸”æ•´ä¸ªé¡µé¢çš„cssæ ·å¼åŠ è½½å®Œæ¯•åï¼Œcssä¼šé‡æ–°æ¸²æŸ“æ•´ä¸ªé¡µé¢çš„htmlå…ƒç´ ã€‚reflow å› æ­¤ï¼Œscriptæ ‡ç­¾æ”¾é åæ¯”è¾ƒå¥½ï¼Œæ­¤æ—¶æ“ä½œdomå…ƒç´ æ‰èƒ½æ­£å¸¸æ“ä½œï¼Œè¿˜èƒ½ä¿è¯é¡µé¢æ­£å¸¸åŠ è½½å‡ºæ¥ï¼Œå¦‚æœä½ æƒ³æ”¾åœ¨å¼€å¤´ï¼Œå¯ä»¥é…åˆ window.onloadå°±å¯ä»¥æ”¾åœ¨ä»»æ„ä½ç½® é¡µé¢å…·ä½“æ¸²æŸ“è¿‡ç¨‹å¯ä»¥çœ‹MDNçš„å®˜æ–¹æ–‡æ¡£https://developer.mozilla.org/zh-CN/docs/Web/Performance/How_browsers_work è¿™ä¸ªé“¾æ¥è¯´æ˜ä¹Ÿæ˜¯æˆ‘ä»¬é¢è¯•å¸¸è§é—®é¢˜ï¼ï¼ˆè¾“å…¥urlåˆ°ç½‘é¡µæ¸²æŸ“å®Œæ¯•å‘ç”Ÿäº†ä»€ä¹ˆï¼‰ 2.åœ¨vscodeé‡Œä½¿ç”¨è‹±æ–‡â€œï¼â€å¯ä»¥ç›´æ¥ç”ŸæˆåŸºæœ¬ç»“æ„ctrl+â€œ+â€å¯ä»¥æ”¾å¤§ï¼ˆå†™ä»£ç ï¼‰é¡µé¢ &lt;!DOCTYPE html&gt; è¿™æ˜¯æˆ‘ä»¬ä¸€ç›´æ”¾åœ¨ HTML æ–‡ä»¶ç¬¬ä¸€è¡Œçš„æ–‡æ¡£ç±»å‹ï¼ˆdoc-typeï¼‰å£°æ˜ã€‚ä½ å¯èƒ½è®¤ä¸ºè¿™ä¸ªä¿¡æ¯æ˜¯å¤šä½™çš„ï¼Œå› ä¸ºæµè§ˆå™¨å·²ç»çŸ¥é“å“åº”çš„ MIME ç±»å‹æ˜¯text/html; ä½†åœ¨ Netscape/Internet Explorer æ—¶ä»£ï¼Œæµè§ˆå™¨æœ‰ä¸€é¡¹è‰°å·¨çš„ä»»åŠ¡æ˜¯ç¡®å®šä½¿ç”¨å“ªç§ HTML æ ‡å‡†æ¥å‘ˆç°æ¥è‡ªå¤šä¸ªç«äº‰ç‰ˆæœ¬çš„é¡µé¢ã€‚ï¼ˆä¹Ÿå°±æ˜¯è¯´è¿™æ˜¯ç”¨äºç¡®ç«‹h5æ ‡å‡†çš„ï¼‰ &lt;html lang=&quot;zh-CN&quot;&gt; (ä¸­æ–‡) &lt;meta charset=&quot;UTF-8&quot;&gt; &lt;h1&gt;&lt;/h1&gt;---&lt;h6&gt;&lt;/h6&gt;&lt;p&gt;&lt;/p&gt; &lt;br /&gt;&lt;strong&gt;&lt;/strong&gt;(å­—ä½“åŠ ç²—)&lt;del&gt;&lt;/del&gt;ï¼ˆå­—ä½“åˆ é™¤çº¿ï¼‰ &lt;em&gt;&lt;/em&gt; æ ‡ç­¾å‘Šè¯‰æµè§ˆå™¨æŠŠå…¶ä¸­çš„æ–‡æœ¬è¡¨ç¤ºä¸ºå¼ºè°ƒçš„å†…å®¹ metaæ ‡ç­¾metaæ ‡ç­¾æ°¸è¿œåœ¨headå…ƒç´ å†…éƒ¨ï¼Œç”¨äºæä¾›æœ‰å…³é¡µé¢çš„å…ƒä¿¡æ¯ï¼ˆmeta-informationï¼‰ï¼Œæ¯”å¦‚é’ˆå¯¹æœç´¢å¼•æ“å’Œæ›´æ–°é¢‘åº¦çš„æè¿°å’Œå…³é”®è¯ã€‚ 3.ç›’å­ç±»ä¼¼äºå¾®ä¿¡å°ç¨‹åºçš„viewï¼Œç”¨äºå¸ƒå±€ &lt;div&gt;&lt;/div&gt; //å¤§ç›’å­ï¼Œç‹¬å ä¸€æ•´è¡Œ &lt;span&gt;&lt;/span&gt; //å°ç›’å­ æ— æ³•è®¾ç½®é«˜åº¦å’Œå®½åº¦ 4.img&lt;img src=&quot;&quot; alt=&quot;&quot; title=&quot;&quot; height=&quot;&quot; width=&quot;&quot;&gt; srcsetå±æ€§ï¼šæ ¹æ®è®¾å¤‡dprè®¾ç½®xå€å›¾ç‰‡ &lt;img width=\"320\" src=\"bg@2x.png\" srcset=\"bg.png 1x;bg@2x.png 2x\"/> å¾®ä¿¡å°ç¨‹åºæ˜¯image altä¸ºå›¾ç‰‡æ— æ³•åŠ è½½æ—¶æ˜¾ç¤ºçš„æ–‡å­—ï¼Œtitleä¸ºé¼ æ ‡ç§»åˆ°å›¾ç‰‡ä¸Šæ˜¾ç¤ºçš„æ–‡å­—æç¤º, ä½†æ˜¯å¯¹äºheightå’Œwidth,ä¸€èˆ¬åªä¿®æ”¹å…¶ä¸­ä¸€ä¸ªï¼Œå¦å¤–ä¸€ä¸ªå°±ä¼šè·Ÿç€æ”¹å˜ srcç§ç»å¯¹è·¯å¾„ \\ ç›¸å¯¹è·¯å¾„ / ï¼ˆå›¾ç‰‡è®¾ç½®å®½é«˜ä¸€èˆ¬è®¾ç½®ä¸ºwidthï¼š100%ï¼Œheighï¼š100%ï¼Œå¯ä»¥è‡ªåŠ¨é€‚åº”ç›’å­ï¼‰ åœ¨nextjsä¸­ Regardless of the layout mode used, the Image component will have a consistent DOM structure of one &lt;img&gt; tag wrapped by exactly one &lt;span&gt;. For some modes, it may also have a sibling &lt;span&gt; for spacing. These additional &lt;span&gt; elements are critical to allow the component to prevent layout shifts. ä¹Ÿå°±æ˜¯è¯´ä¸€èˆ¬ä¸€ä¸ªimgæ ‡ç­¾ä»–éƒ½ç”¨spanåŒ…è£¹ å›¾ç‰‡ç¦æ­¢æ‹–æ‹½&lt;img src=\"https://picsum.photos/360/460?random=1\" draggable=\"false\"> 5.è¶…é“¾æ¥&lt; a&gt;&lt;a href=&quot;&quot; target=&quot;&quot; &gt;æ–‡æœ¬æˆ–è€…å›¾åƒ&lt;/a&gt; ç±»ä¼¼äºå¾®ä¿¡å°ç¨‹åºä¸­çš„navigator, hrefç”¨äºæŒ‡å®šç›®æ ‡çš„urlï¼Œå¯æ‰“å¼€å†…éƒ¨ï¼Œå¤–éƒ¨é“¾æ¥ targetç”¨äºæ¥é“¾æ¥æ‰“å¼€æ–¹å¼ï¼Œé»˜è®¤_self _blankä¸ºåœ¨æ–°çª—å£æ‰“å¼€ é”šç‚¹é“¾æ¥ï¼šè®¾ç½®href=#åå­—ï¼Œå¦‚&lt;a href=&quot;#two&quot;&gt;ç¬¬äºŒé›†&lt;/a&gt;å¯ä»¥å¿«é€Ÿè·³è½¬åˆ°ç¬¬äºŒé›†çš„é¡µé¢ä½ç½® â€‹ åœ¨äºç›®æ ‡ä½ç½®æ ‡ç­¾é‡Œæ·»åŠ id=â€twoâ€ åƒå¯¹äºvueï¼ˆrouter-linkï¼‰ã€reactï¼ˆLinkï¼‰è¿™ç±»çš„æ¡†æ¶ï¼Œä»–ä»¬å®ç°çš„å£°æ˜å¼è·¯ç”±å…¶å®å·®ä¸å¤šæ˜¯è¿™ç§æ–¹å¼ï¼ˆhashï¼‰ï¼š &lt;a href=\"#home\">é¦–é¡µ&lt;/a> &lt;a href=\"#about\">å…³äº&lt;/a> åªä¸è¿‡å¯¹äºvueã€reactä»–ä»¬è¿˜å¤„ç†äº†é€šè¿‡urlå®ç°è·³è½¬æ—¶è¿™ä¸ªaé“¾æ¥è‡ªåŠ¨é«˜äº®ï¼ˆreactçš„ NavLink ï¼‰ï¼Œå®ç°çš„è·¯å¾„å’Œè·³è½¬æ ‡ç­¾çš„ç»‘å®šï¼ˆåŸç†ï¼šwindow.onhashChangeäº‹ä»¶ï¼Œ window.addEventListener(&quot;hashchange&quot;, fn)ç›‘å¬å›è°ƒ ï¼‰ &lt;a href=&quot;&quot; title=&quot;&quot;&gt;ç§»åŠ¨åˆ°é“¾æ¥æ—¶ä¼šå‡ºç°æç¤ºæ¡† ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œaå¦‚æœåŒ…å«æœ‰å®½åº¦çš„ç›’å­ï¼Œaéœ€è¦è½¬æ¢ä¸ºå—çº§å…ƒç´  &lt;a href=&#39;javascript:;&#39;&gt;xx&lt;/a&gt; ç›´æ¥æ·»åŠ javascript:; å¯ä»¥é˜»æ­¢é“¾æ¥è·³è½¬ 6.ç‰¹æ®Šå­—ç¬¦ç©ºæ ¼ï¼š&amp;nbsp (å› æ— æ³•è¯†åˆ«å¤§äºå·å’Œå°äºå·) å°äºå·ï¼š&amp;lt å¤§äºå·ï¼š&amp;gt 7.è¡¨æ ¼ï¼ˆç”¨äºæ•°æ®ï¼‰&lt;table&gt; â€‹ &lt;tr&gt; â€‹ &lt;td&gt;å•å…ƒæ ¼æ–‡å­—&lt;/td&gt;æˆ–è€…&lt;th&gt;&lt;/th&gt; â€‹ &lt;/tr&gt; &lt;/table&gt; tableæ˜¯è¡¨æ ¼ï¼Œtræ˜¯è¡Œï¼Œtdæ˜¯å•å…ƒæ ¼ï¼ˆthå¯å……å½“è¡¨å¤´å•å…ƒæ ¼ï¼‰ã€‚è¿˜å¯ä»¥åŠ å…¥&lt;thead&gt;å’Œ &lt;tbody&gt;æ¥å¸®åŠ©CSSåŒºåˆ†è¡¨æ ¼ç»“æ„ å•å…ƒæ ¼åˆå¹¶ä½¿ç”¨colspan=â€ï¼ˆåˆ—ï¼‰æƒ³è¦åˆå¹¶çš„å•å…ƒä¸ªæ•°â€æˆ–è€…rowspan=â€ï¼ˆè¡Œï¼‰æƒ³è¦åˆå¹¶çš„å•å…ƒä¸ªæ•°â€ï¼Œå†åˆ é™¤å¤šä½™çš„tdï¼ˆæˆ–thï¼‰ 8.åˆ—è¡¨ï¼ˆç”¨äºå¸ƒå±€ï¼‰æ— åºåˆ—è¡¨ulé‡Œåªèƒ½æ”¾liæ ‡ç­¾ï¼Œæ‰€ä»¥å…¶ä»–å®¹å™¨æ”¾lié‡Œé¢å°±å¯ä»¥ &lt;ul&gt; â€‹ &lt;li&gt;åˆ—è¡¨é¡¹1&lt;/li&gt; â€‹ &lt;li&gt;åˆ—è¡¨é¡¹2&lt;/li&gt; &lt;/ul&gt; æœ‰åºåˆ—è¡¨(è§„åˆ™åŒæ— åº)&lt;ol&gt; â€‹ &lt;li&gt;åˆ—è¡¨é¡¹1&lt;/li&gt; â€‹ &lt;li&gt;åˆ—è¡¨é¡¹2&lt;/li&gt; &lt;/ol&gt; è‡ªå®šä¹‰åˆ—è¡¨(åŒä¸Š)&lt;dl&gt; â€‹ &lt;dt&gt;åè¯1&lt;/dt&gt; â€‹ &lt;dd&gt;åè¯1è§£é‡Š1&lt;/dd â€‹ &lt;dd&gt;åè¯1è§£é‡Š2&lt;/dd&gt; &lt;/dl&gt; æ³¨æ„ï¼ˆlié»˜è®¤æœ¬èº«æ²¡æœ‰marginï¼‰ list-style-type ç”¨äºè®¾ç½®ä¸åŒåˆ—è¡¨åˆ—è¡¨é¡¹çš„æ ·å¼ã€‚ æ— åºåˆ—è¡¨å¸¸ä½¿ç”¨ï¼š ul { list-style-type:circle; /* æ¯ä¸€é¡¹å‰éƒ½æ˜¯åœ†åœˆ */ } ul { list-style-type:square; /* æ¯ä¸€é¡¹å‰éƒ½æ˜¯æ­£æ–¹å½¢ */ } ul { list-style-type:none; /* å»é™¤åœ†ç‚¹ */ } æœ‰åºåˆ—è¡¨ä¹Ÿå¯ä»¥ç”¨ list-style-type æ¥è®¾ç½®åˆ—è¡¨é¡¹ ol { list-style-type:upper-roman; /* æ¯ä¸€é¡¹å‰é¢éƒ½æ˜¯å¤§å†™ç½—é©¬æ•°å­— */ } ol { list-style-type:lower-alpha; /* æ¯ä¸€é¡¹å‰éƒ½æ˜¯å°å†™å­—æ¯ */ } liæ ‡ç­¾åŒ…å«aæ ‡ç­¾å®é™…å¼€å‘ä¸­å¯¼èˆªæ ä¸ä¼šç›´æ¥ç”¨aæ ‡ç­¾ï¼Œè€Œæ˜¯ç”¨liï¼ˆåˆ—è¡¨ï¼‰åŒ…å«aæ ‡ç­¾çš„åšæ³•ï¼Œ1.è¯­ä¹‰æ›´åŠ æ¸…æ™° 2.æ•…æ„å¯¹å…¶å…³é”®å­—æœ‰è¢«æœç´¢å¼•æ“é™æƒçš„é£é™© å¯¼èˆªæ ä¸ç»™å®½åº¦æ˜¯ä¸æƒ³å®šæ­»ï¼Œè®©å…¶è‡ªåŠ¨é€‚åº” 9.è¡¨å•ï¼ˆç”¨äºå¡«å†™ä¿¡æ¯ï¼Œç”¨æˆ·æ³¨å†Œï¼‰&lt;form action=&quot;urlåœ°å€&quot; method=&quot;æäº¤æ–¹å¼&quot; name=&quot;è¡¨å•åŸŸåç§°&quot; maxlength=&quot;&quot;&gt;&lt;/form&gt;è¡¨å•åŸŸ urlåœ°å€ä¸ºå¤„ç†è¡¨å•æ•°æ®çš„åœ°å€ï¼Œmethodæœ‰getï¼Œpost è¡¨å•å…·æœ‰é»˜è®¤çš„æäº¤è¡Œä¸ºï¼Œé»˜è®¤æ˜¯åŒæ­¥çš„ï¼ŒåŒæ­¥è¡¨å•æäº¤ï¼Œæµè§ˆå™¨ä¼šé”æ­»ï¼ˆè½¬åœˆå„¿ï¼‰ç­‰å¾…æœåŠ¡ç«¯çš„å“åº”ç»“æœã€‚ è¡¨å•çš„åŒæ­¥æäº¤ä¹‹åï¼Œæ— è®ºæœåŠ¡ç«¯å“åº”çš„æ˜¯ä»€ä¹ˆï¼Œéƒ½ä¼šç›´æ¥æŠŠå“åº”çš„ç»“æœè¦†ç›–æ‰å½“å‰é¡µé¢ã€‚ è¡¨å•ä¸­éœ€è¦æäº¤çš„è¡¨å•æ§ä»¶å…ƒç´ å¿…é¡»æœ‰nameå±æ€§ è¡¨å•å…ƒç´ &lt;input&gt;&lt;!-- é€šç”¨æäº¤æŒ‰é’® --> &lt;input type=\"submit\" value=\"Submit Form\" > &lt;!-- è‡ªå®šä¹‰æäº¤æŒ‰é’® --> &lt;button type=\"submit\">Sunbmit Form &lt;/button> &lt;!-- å›¾ç‰‡æäº¤æŒ‰é’® --> &lt;input type=\"image\" src=\"graphic.gif\" > typeå¯ä»¥ä¸ºtextï¼Œnumberï¼Œpasswordï¼Œbuttonï¼Œresetï¼ˆé‡ç½®ï¼‰submitï¼ˆç”¨äºæäº¤ï¼‰ï¼Œradioï¼ˆå•é€‰æ¡†ï¼Œå¿…é¡»æ·»åŠ nameæ‰èƒ½ä½¿ç”¨ï¼‰ï¼Œcheckboxï¼ˆå¤é€‰æ¡†ï¼‰ç­‰ ç§‘æ™®ï¼šsubmitæ˜¯buttonçš„ä¸€ä¸ªç‰¹ä¾‹ï¼Œç”¨äºå¤„ç†å¤§é‡è¡¨å•æ•°æ®ï¼Œè€Œæ­¤æ—¶inputé‡Œçš„nameæ˜¯è¡¨å•çš„åç§°ï¼Œéœ€è¦å¡«å†™nameæ‰èƒ½æäº¤è¡¨å•æ•°æ®ï¼›äº¦æˆ–è€…inputæ”¾åœ¨formæ ‡ç­¾é‡Œé¢ valueä¸ºè¾“å…¥æ¡†å†…çš„æç¤ºè¯­||å……å½“æäº¤ç»™åå°çš„æ•°æ®||æ˜¾ç¤ºçš„æ–‡å­— placeholder=&quot;Search...&quot; æ˜¾ç¤ºæç¤ºçš„æ–‡å­— ç”¨äºå•é€‰å’Œå¤é€‰çš„é»˜è®¤å±æ€§ checked checked=&quot;checked&quot;é€‰ä¸­ checked=&quot;çœŸå€¼&quot; maxlength=â€œæœ€å¤§å€¼â€ æ ‡ç­¾å…ƒç´ &lt;Label&gt;&lt;label for=&quot;sex&quot;&gt;ç”· &lt;/label&gt; labelç”¨äºå¢åŠ ç”¨æˆ·ä½“éªŒï¼Œç‚¹å‡»èŒƒå›´å†…å³å¯é€‰ä¸­æŸinputï¼ˆä¸€èˆ¬ä¸€ä¸ªlabelç»‘å®šä¸€ä¸ªinputï¼‰ &lt;input type=&quot;radio&quot; name=&quot;sex&quot; id=&quot;sex&quot; /&gt; labelä¸­çš„forå¯¹åº”inputé‡Œçš„id æˆ–è€…æŠŠinputæ ‡ç­¾æ”¾åœ¨labelé‡Œé¢ä¹Ÿèƒ½è¾¾åˆ°åŒæ ·çš„æ•ˆæœï¼Œæ­¤æ—¶ä»ç„¶éœ€è¦forå’Œidï¼ˆéšå¼çš„è”ç³»ï¼‰ &lt;!-- å¯ä»¥ä»ä½“éªŒæ„Ÿæ„Ÿè§‰åˆ°ä¸¤è€…çš„ä¸åŒ --> &lt;form> &lt;label for=\"male\">Male&lt;/label> &lt;input type=\"radio\" name=\"sex\" id=\"male\" /> &lt;br /> &lt;input type=\"radio\" name=\"sex\" id=\"female\" /> &lt;/form> å…¶å®è¿˜æœ‰ defaultCheckï¼š defaultCheck åªåœ¨åˆæ¬¡æ¸²æŸ“æ—¶ç”Ÿæ•ˆï¼Œæ›´æ–°æ•°æ®æ—¶ä¸å—æ§åˆ¶ï¼Œä½†æ˜¯å…è®¸åç»­ä½ é€šè¿‡ç‚¹å‡»æ‰‹åŠ¨æ›´æ”¹å®ƒçš„é€‰å®š checked å§‹ç»ˆå—åˆ°æ§åˆ¶ï¼Œå¿…é¡»é€šè¿‡ç»‘å®š onchange äº‹ä»¶æ¥æ§åˆ¶é€‰ä¸­æƒ…å†µ æ€»ç»“defaultCheckedã€defaultValue åªåœ¨åˆå§‹æ¸²æŸ“æ—¶ç”±çŠ¶æ€æ§åˆ¶ï¼Œä¹‹åæ›´æ–°ä¸å†è·ŸçŠ¶æ€æœ‰å…³ç³»ï¼Œè€Œcheckedã€valueåœ¨å…¨è¿‡ç¨‹ä¸­éƒ½å—çŠ¶æ€æ§åˆ¶ å¼€å‘ä¸­æ›´å¤šçš„æ˜¯ä½¿ç”¨checked + onchange ç»„åˆ è¡¨å•å…ƒç´ &lt;select&gt; ä¸‹æ‹‰åˆ—è¡¨&lt;select> &lt;option value=\"1\">é€‰é¡¹1&lt;/option> &lt;option value=\"2\">é€‰é¡¹2&lt;/option> &lt;!-- é»˜è®¤é€‰ä¸­é€‰é¡¹3 --> &lt;option selected=\"selected\">é€‰é¡¹3&lt;/option> ... &lt;select> è¡¨å•å…ƒç´ &lt;textarea&gt; æ–‡æœ¬åŸŸtextarea å¯ä»¥å†™å¤§é‡æ–‡å­—ï¼ˆä¸ªäººä»‹ç»ï¼Œè¯„è®ºï¼‰ è¾“å…¥çš„è¯„è®ºä½œä¸ºelement.value &lt;textarea> æ–‡å­— &lt;/textarea> //å¦‚æœæ²¡æ–‡å­—textareaå¿…é¡»å†™åˆ°åŒä¸€è¡Œ æŒ‰é’® buttontypeå±æ€§ï¼šbuttonçš„ç±»å‹ã€‚å¯é€‰å€¼ï¼š submit: æ­¤æŒ‰é’®å°†è¡¨å•æ•°æ®æäº¤ç»™æœåŠ¡å™¨ã€‚å¦‚æœæœªæŒ‡å®šå±æ€§ï¼Œæˆ–è€…å±æ€§åŠ¨æ€æ›´æ”¹ä¸ºç©ºå€¼æˆ–æ— æ•ˆå€¼ï¼Œåˆ™æ­¤å€¼ä¸ºé»˜è®¤å€¼ã€‚ reset: æ­¤æŒ‰é’®é‡ç½®æ‰€æœ‰ç»„ä»¶ä¸ºåˆå§‹å€¼ã€‚ button: æ­¤æŒ‰é’®æ²¡æœ‰é»˜è®¤è¡Œä¸ºã€‚å®ƒå¯ä»¥æœ‰ä¸å…ƒç´ äº‹ä»¶ç›¸å…³çš„å®¢æˆ·ç«¯è„šæœ¬ï¼Œå½“äº‹ä»¶å‡ºç°æ—¶å¯è§¦å‘ã€‚ menu: æ­¤æŒ‰é’®æ‰“å¼€ä¸€ä¸ªç”±æŒ‡å®š``å…ƒç´ è¿›è¡Œå®šä¹‰çš„å¼¹å‡ºèœå•ã€‚ 10 å…ƒç´ åˆ†ç±»å—å…ƒç´ ï¼Œç‹¬å ä¸€è¡Œï¼Œæ˜¯ä¸€ä¸ªå®¹å™¨æˆ–è€…ç›’å­å¦‚ &lt;div&gt; &lt;ul&gt; &lt;ol&gt; &lt;li&gt; &lt;h1&gt; &lt;h2&gt;ç­‰ ä½†&lt;p&gt; &lt;h&gt; ä¸èƒ½å†…ç½®å—çº§å…ƒç´ ï¼Œåªèƒ½æ”¾æ–‡å­—è¡Œå…ƒç´ ï¼Œä¸èƒ½è®¾ç½®å®½é«˜ï¼Œåªèƒ½å®¹çº³æ–‡æœ¬æˆ–è€…å…¶ä»–è¡Œå†…å…ƒç´  &lt;a&gt; &lt;strong&gt; &lt;b&gt; &lt;em&gt; &lt;span&gt; ç­‰ ä½†æ˜¯&lt;a&gt;ä¸èƒ½å†æ”¾&lt;a&gt; ç‰¹æ®Šæƒ…å†µ&lt;a&gt;å¯ä»¥è½¬å—çº§ &lt;b&gt;æ˜¯ç²—æ–‡æœ¬è¡Œå†…å—å…ƒç´ ï¼Œèƒ½åœ¨åŒä¸€è¡Œï¼Œä¹Ÿèƒ½è®¾ç½®å®½é«˜ï¼Œä½†æ˜¯è¡Œå†…å—ä¹‹é—´æœ‰ç¼éš™ &lt;input/&gt; &lt;img/&gt; &lt;td&gt; &lt;button&gt;è¡Œå†…å…ƒç´ å’Œå—çº§å…ƒç´ çš„åŒºåˆ«å—çº§å…ƒç´ ï¼š ä¼šç‹¬å ä¸€è¡Œ,é»˜è®¤æƒ…å†µä¸‹,å…¶å®½åº¦è‡ªåŠ¨å¡«æ»¡å…¶çˆ¶å…ƒç´ å®½åº¦ å—çº§å…ƒç´ å¯ä»¥è®¾ç½®width,heightå±æ€§. å—çº§å…ƒç´ å³ä½¿è®¾ç½®äº†å®½åº¦,ä»ç„¶æ˜¯ç‹¬å ä¸€è¡Œ. å—çº§å…ƒç´ å¯ä»¥è®¾ç½®marginå’Œpaddingå±æ€§. å—çº§å…ƒç´ å¯¹åº”äºdisplay:block. è¡Œå†…å…ƒç´  ä¸ä¼šç‹¬å ä¸€è¡Œ,ç›¸é‚»çš„è¡Œå†…å…ƒç´ ä¼šæ’åˆ—åœ¨åŒä¸€è¡Œé‡Œ,ç›´åˆ°ä¸€è¡Œæ’ä¸ä¸‹,æ‰ä¼šæ¢è¡Œ è¡Œå†…å…ƒç´ è®¾ç½®width,heightå±æ€§æ— æ•ˆï¼Œå®ƒçš„é•¿åº¦é«˜åº¦ä¸»è¦æ ¹æ®å†…å®¹å†³å®š. è¡Œå†…å…ƒç´ çš„marginå’Œpaddingå±æ€§,æ°´å¹³æ–¹å‘çš„padding-left,padding-right,margin-left,margin- rightéƒ½äº§ç”Ÿè¾¹è·æ•ˆæœ,ä½†ç«–ç›´æ–¹å‘çš„padding-top,padding-bottom,margin-top,margin-bottomå´ä¸ ä¼šäº§ç”Ÿè¾¹è·æ•ˆæœï¼Œå³æ°´å¹³æœ‰æ•ˆï¼Œå‚ç›´æ— æ•ˆ è¡Œå—çš„è½¬æ¢è¯¦æƒ…è¯·çœ‹CSSé‡Œçš„ã€Šè¡Œå—è½¬æ¢ã€‹ h5æ ‡ç­¾æ¨èç½‘å€ï¼š http://www.w3school.com.cn/ http://developer.mozilla.org/zh-CN/ 11.HTML5æ–°ç‰¹æ€§æ–°å¢æ ‡ç­¾i9ä»¥ä¸Šç‰ˆæœ¬æµè§ˆå™¨æ‰æ”¯æŒ &lt;header>: å¤´éƒ¨æ ‡ç­¾ &lt;nav>: å¯¼èˆªæ ‡ç­¾ &lt;article>: å†…å®¹æ ‡ç­¾ &lt;section>: å®šä¹‰æ–‡æ¡£æŸä¸ªåŒºåŸŸ &lt;aside>: ä¾§è¾¹æ æ ‡ç­¾ &lt;footer>: å°¾éƒ¨æ ‡ç­¾ &lt;!-- å®è´¨ä¸Šéƒ½å’Œdivå·®ä¸å¤šï¼Œåªæ˜¯è¯­ä¹‰åŒ–äº†è€Œå·²ï¼Œä¸»è¦é’ˆå¯¹æœç´¢å¼•æ“ ä½†æ˜¯åœ¨i9ä¸­ï¼Œéœ€è¦æŠŠè¿™äº›å…ƒç´ è½¬æ¢æˆå—çº§å…ƒç´ ï¼Œæ‰€ä»¥ç§»åŠ¨ç«¯æ›´å–œæ¬¢ä½¿ç”¨è¿™äº›æ ‡ç­¾--> æ–°å¢&lt;audio&gt;ï¼Œ&lt;video&gt;æ–°å¢&lt;audio&gt;éŸ³é¢‘ï¼Œ&lt;video&gt;è§†é¢‘ï¼ŒæŠ›å¼ƒflashç­‰æ’ä»¶åŠŸèƒ½ videoå°½é‡ä½¿ç”¨mp4æ ¼å¼ï¼Œè°·æ­ŒæŠŠéŸ³é¢‘ï¼Œè§†é¢‘è‡ªåŠ¨æ’­æ”¾ç¦æ­¢äº†ï¼Œaudioå’Œvideoå±æ€§ç”¨æ³•å·®ä¸å¤š &lt;video src=\"æ–‡ä»¶åœ°å€\" autoplay=\"autoplay\"è‡ªåŠ¨æ’­æ”¾ è°·æ­Œéœ€è¦æ·»åŠ muted=\"muted\"ï¼ˆé™éŸ³æ’­æ”¾ï¼‰,æ‰èƒ½å®ç°è‡ªåŠ¨æ’­æ”¾ controls=\"controls\"æ·»åŠ æ’­æ”¾ç»„ä»¶ loop=\"loop\"å¾ªç¯æ’­æ”¾ poster=\"å›¾ç‰‡åœ°å€\" è§†é¢‘å°é¢æ˜¾ç¤ºå›¾ç‰‡ >&lt;/video> é‡åˆ°ä¸å…¼å®¹çš„æƒ…å†µå¯ä»¥å†™æˆ &lt;video width=\"320\" height=\"240\"> &lt;source src=\"\" type=\"video/mp4\"> &lt;source src=\"\" type=\"video/ogg\"> &lt;/video> const video = document.createElement('video'); video.crossOrigin = 'anonymous'; //è‡ªåŠ¨æ’­æ”¾ video.autoplay = false; //æ˜¯å¦é™éŸ³ video.muted = true; height è§†é¢‘æ˜¾ç¤ºåŒºåŸŸçš„é«˜åº¦ï¼Œå•ä½æ˜¯ CSS åƒç´ ï¼ˆä»…é™ç»å¯¹å€¼ï¼›ä¸æ”¯æŒç™¾åˆ†æ¯”ï¼‰ã€‚ loop å¸ƒå°”å±æ€§ï¼›æŒ‡å®šåï¼Œä¼šåœ¨è§†é¢‘æ’­æ”¾ç»“æŸçš„æ—¶å€™ï¼Œè‡ªåŠ¨è¿”å›è§†é¢‘å¼€å§‹çš„åœ°æ–¹ï¼Œç»§ç»­æ’­æ”¾ã€‚ muted å¸ƒå°”å±æ€§ï¼ŒæŒ‡æ˜åœ¨è§†é¢‘ä¸­éŸ³é¢‘çš„é»˜è®¤è®¾ç½®ã€‚è®¾ç½®åï¼ŒéŸ³é¢‘ä¼šåˆå§‹åŒ–ä¸ºé™éŸ³ã€‚é»˜è®¤å€¼æ˜¯ false, æ„å‘³ç€è§†é¢‘æ’­æ”¾çš„æ—¶å€™éŸ³é¢‘ä¹Ÿä¼šæ’­æ”¾ã€‚ playsinline å¸ƒå°”å±æ€§ï¼ŒæŒ‡æ˜è§†é¢‘å°†å†…è”ï¼ˆinlineï¼‰æ’­æ”¾ï¼Œå³åœ¨å…ƒç´ çš„æ’­æ”¾åŒºåŸŸå†…ã€‚è¯·æ³¨æ„ï¼Œæ²¡æœ‰æ­¤å±æ€§å¹¶ä¸æ„å‘³ç€è§†é¢‘å§‹ç»ˆæ˜¯å…¨å±æ’­æ”¾çš„ã€‚ poster æµ·æŠ¥å¸§å›¾ç‰‡ URLï¼Œç”¨äºåœ¨è§†é¢‘å¤„äºä¸‹è½½ä¸­çš„çŠ¶æ€æ—¶æ˜¾ç¤ºã€‚å¦‚æœæœªæŒ‡å®šè¯¥å±æ€§ï¼Œåˆ™åœ¨è§†é¢‘ç¬¬ä¸€å¸§å¯ç”¨ä¹‹å‰ä¸ä¼šæ˜¾ç¤ºä»»ä½•å†…å®¹ï¼Œç„¶åå°†è§†é¢‘çš„ç¬¬ä¸€å¸§ä¼šä½œä¸ºæµ·æŠ¥ï¼ˆposterï¼‰å¸§æ¥æ˜¾ç¤ºã€‚ preload è¯¥æšä¸¾å±æ€§æ—¨åœ¨æç¤ºæµè§ˆå™¨ï¼Œä½œè€…è®¤ä¸ºåœ¨æ’­æ”¾è§†é¢‘ä¹‹å‰ï¼ŒåŠ è½½å“ªäº›å†…å®¹ä¼šè¾¾åˆ°æœ€ä½³çš„ç”¨æˆ·ä½“éªŒã€‚å¯èƒ½æ˜¯ä¸‹åˆ—å€¼ä¹‹ä¸€ï¼š none: è¡¨ç¤ºä¸åº”è¯¥é¢„åŠ è½½è§†é¢‘ã€‚ metadata: è¡¨ç¤ºä»…é¢„å…ˆè·å–è§†é¢‘çš„å…ƒæ•°æ®ï¼ˆä¾‹å¦‚é•¿åº¦ï¼‰ã€‚ auto: è¡¨ç¤ºå¯ä»¥ä¸‹è½½æ•´ä¸ªè§†é¢‘æ–‡ä»¶ï¼Œå³ä½¿ç”¨æˆ·ä¸å¸Œæœ›ä½¿ç”¨å®ƒã€‚ ç©ºå­—ç¬¦ä¸²: å’Œå€¼ä¸º auto ä¸€è‡´ã€‚æ¯ä¸ªæµè§ˆå™¨çš„é»˜è®¤å€¼éƒ½ä¸ç›¸åŒï¼Œå³ä½¿è§„èŒƒå»ºè®®è®¾ç½®ä¸º metadataã€‚ é€æ˜è§†é¢‘ä½¿ç”¨videoå¹¶ä¸èƒ½ç›´æ¥æ’­æ”¾å‡ºé€æ˜è§†é¢‘ éœ€è¦ç”¨åˆ°åŠ¨ç”»ï¼ˆcanvasï¼ˆ2ä¸ªcanvasï¼‰ã€webglï¼‰æ¥ååŒå¸®åŠ© å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œæºç´ æå‘å³æ‰©å……äº†ä¸€å€çš„åƒç´ ï¼Œç”¨æ¥å­˜å‚¨Alphaé€šé“çš„æ•°å€¼ï¼Œåœ¨å®¢æˆ·ç«¯æ¸²æŸ“çš„æ—¶å€™ï¼Œç›´æ¥ä½¿ç”¨å³ä¾§åƒç´ ç‚¹çš„Rå€¼ï¼Œé™¤ä»¥255ï¼Œå°±å¾—åˆ°äº†0-1ä¹‹é—´çš„alphaå–å€¼ ä¾‹å¦‚ç¬¬ä¸€ä¸ªåƒç´ ç‚¹ï¼Œ çº¢è‰²ï¼šå³ä¾§çš„RGBå€¼ä¸º(255,0,0) + å·¦ä¾§çš„Rå€¼(128) ï¼Œæ··åˆä¹‹åçš„ RGBA = (255,0,0,128/255) ~= (255,0,0,0.5) å®¢æˆ·ç«¯æ¸²æŸ“ å®¢æˆ·ç«¯æ‹¿åˆ°è§†é¢‘è½¨é“æ•°æ®åï¼Œè§£ç å‡ºæ¯ä¸€å¸§å›¾ç‰‡ï¼Œç„¶åé€šè¿‡å·¦è¾¹yuv+å³è¾¹çš„yuvæ··åˆåå†ä¸Šå±ï¼Œglå…¬å¼å¯ç†è§£ä¸º gl_FragColor = vec4( texture2D(texture, vec2(vUv.x/2, vUv.y)).rgb, texture2D(texture, vec2(0.5 + vUv.x/2, vUv.y)).r ); æ–°å¢inputçš„ç±»å‹type=&quot;email&quot; type=&quot;url&quot; type=&quot;date&quot; type=&quot;number&quot; type=&quot;search&quot; type=&quot;tel&quot;(æ‰‹æœºå·ç ) é™åˆ¶ç”¨æˆ·åªèƒ½ä½¿ç”¨&quot;X&quot;ç±»å‹ /*è¡¨å•å±æ€§*/ &lt;input type=&quot;search&quot; required=&quot;required&quot; å¡«å†™å­—æ®µä¸èƒ½ä¸ºç©º placeholder=&quot;XX&quot; è¡¨å•çš„æç¤ºä¿¡æ¯ autofocus=&quot;autofocus&quot; é¡µé¢å®Œæˆæ—¶è‡ªåŠ¨èšç„¦åˆ°æŒ‡å®šè¡¨å• autocomplete=&quot;on&quot; æ‰“å¼€å†å²è®°å½•åŠŸèƒ½ï¼Œéœ€è¦åŠ ä¸Šnameå±æ€§ï¼Œæ”¾åœ¨è¡¨å•å†…ï¼ŒæˆåŠŸæäº¤è¿‡ï¼Œå¯ä»¥å¯é€‰æ‹©&quot;off&quot; mutiple=&quot;multiple&quot; é€‰æ‹©å¤šä¸ªæ–‡ä»¶ä¸Šä¼  &gt;æ­¤å¤–è¿˜æœ‰å¿…å¡«å±æ€§ &lt;input type=\"text\" required> é™¤æ­¤ä¹‹å¤–è¿˜æœ‰canvasã€SVGã€WebSocketï¼Œæˆ‘åˆ†åˆ«åœ¨cssé«˜çº§ã€è®¡ç½‘personnelçš„ç¯‡ç« ä¸­æåŠåˆ°ï¼Œè¿™é‡Œå°±ä¸ä¸€ä¸€ç»§ç»­è§£é‡Šäº†ã€‚ 12.ç½‘ç«™çš„ç¼©ç•¥å›¾æ ‡ä¸€èˆ¬ä½¿ç”¨favicon.icoä½œä¸ºå›¾æ ‡ï¼Œä¸»è¦çš„æµè§ˆå™¨éƒ½æ”¯æŒã€‚ é€šè¿‡ç¬¬ä¸‰æ–¹ç½‘ç«™å°†pngå›¾ç‰‡è½¬åŒ–æˆicoå›¾æ ‡ï¼Œå¦‚http://www.bitbug.net/ è½¬åŒ–æˆåŠŸåï¼Œåœ¨&lt;head&gt; &lt;/head&gt;ä¹‹é—´å¼•å…¥ä»£ç ï¼š &lt;link rel=&quot;shortcut icon&quot; href=&quot;favicon.ico type=&quot;XX&quot;&gt;(ç½‘é¡µé‚£é‡Œæœ‰ä»£ç ç›´æ¥copy) åœ¨æŸç½‘é¡µçš„é¡µé¢ï¼Œåœ¨å®ƒçš„ç½‘å€åè¾“å…¥â€/favicon.icoâ€ å¯ä»¥ç›´æ¥è·å–å®ƒçš„ico 13.ç½‘ç«™TDKä¸‰å¤§æ ‡ç­¾ä¼˜åŒ–SEOSEOæ˜¯æœç´¢å¼•æ“ä¼˜åŒ–ï¼Œç›®çš„ä¸ºå¯¹ç½‘ç«™æ·±åº¦ä¼˜åŒ–ï¼Œä½¿å¾—ç½‘ç«™æ’åä½äºæœç´¢å¼•æ“ä½¿ç”¨åè¾ƒå‰çš„ä½ç½®ã€‚ 1.titleç½‘ç«™å-ç½‘ç«™ä»‹ç»ï¼ˆä¸è¶…è¿‡30å­—ï¼‰ 2.descriptionç®€è¦æ¦‚è¿°ç½‘ç«™å†…å®¹ 3.keywordsé¡µé¢å…³é”®å­—ï¼Œæœç´¢å¼•æ“çš„å…³æ³¨ç‚¹ logoçš„SEOä¼˜åŒ–logoé‡Œé¦–å…ˆæ”¾ä¸€ä¸ªh1æ ‡ç­¾æ¥ææƒï¼Œh1é‡Œå†æ”¾ä¸€ä¸ªé“¾æ¥ï¼Œç”¨äºè¿”å›è‡³é¦–é¡µï¼Œä¸ºäº†è®©æœç´¢å¼•æ“æ”¶å½•æˆ‘ä»¬ï¼Œæˆ‘ä»¬è¦åœ¨é“¾æ¥é‡Œæ”¾æ–‡å­—ï¼ˆç½‘ç«™åç§°ï¼‰ï¼Œä½†æ˜¯æ–‡å­—ä¸è¦æ˜¾ç¤ºå‡ºæ¥ï¼ˆæ–‡å­—å¤§å°è®¾ç½®ä¸º0ï¼Œfont-size: 0ï¼‰ï¼Œæœ€åç»™é“¾æ¥ä¸€ä¸ªtitleå±æ€§ 14.iframeæ ‡ç­¾iframe å…ƒç´ ä¼šåˆ›å»ºåŒ…å«å¦å¤–ä¸€ä¸ªæ–‡æ¡£çš„å†…è”æ¡†æ¶ å¬è¯´iframeæ ‡ç­¾èƒ½è€—é«˜ï¼Ÿå®‰å…¨æ€§å·®ï¼Ÿè¿˜å¾ˆlowï¼Ÿæˆ‘çœ‹é¢è¯•æœ‰é—®åˆ°ï¼Œï¼ˆæˆ‘è¿˜æ²¡ç”¨è¿‡ï¼‰æ‰€ä»¥ä»¥ä¸‹æ˜¯é€‰å–ç½‘ä¸Šæˆ‘ä¸ªäººè§‰å¾—æ¯”è¾ƒæœ‰ç”¨çš„å…³äº iframeçš„çŸ¥è¯†ç‚¹ å¬è¯´ä½ é•¿è¿™æ ·ï¼Ÿ &lt;iframe src=\"demo.html\" height=\"300\" width=\"500\" name=\"demo\" scrolling=\"auto\" sandbox=\"allow-same-origin\">&lt;/iframe> &lt;iframe src=\"åœ°å€\" frameborder=\"0\">&lt;/iframe> è¿˜å¯ä»¥ä»¿é€ åˆ«äººçš„é¡µé¢ï¼ˆå‡è£…è‡ªå·±åšçš„ï¼Œæ‰‹åŠ¨ç‹—å¤´ï¼‰ å±€é™1ã€åˆ›å»ºæ¯”ä¸€èˆ¬çš„ DOM å…ƒç´ æ…¢äº† 1-2 ä¸ªæ•°é‡çº§ iframe çš„åˆ›å»ºæ¯”å…¶å®ƒåŒ…æ‹¬ scripts å’Œ css çš„ DOM å…ƒç´ çš„åˆ›å»ºæ…¢äº† 1-2 ä¸ªæ•°é‡çº§ï¼Œä½¿ç”¨ iframe çš„é¡µé¢ä¸€èˆ¬ä¸ä¼šåŒ…å«å¤ªå¤š iframeï¼Œæ‰€ä»¥åˆ›å»º DOM èŠ‚ç‚¹æ‰€èŠ±è´¹çš„æ—¶é—´ä¸ä¼šå å¾ˆå¤§çš„æ¯”é‡ã€‚ä½†å¸¦æ¥ä¸€äº›å…¶å®ƒçš„é—®é¢˜ï¼šonload äº‹ä»¶ä»¥åŠè¿æ¥æ± ï¼ˆconnection poolï¼‰ 2ã€é˜»å¡é¡µé¢åŠ è½½ åŠæ—¶è§¦å‘ window çš„ onload äº‹ä»¶æ˜¯éå¸¸é‡è¦çš„ã€‚onload äº‹ä»¶è§¦å‘ä½¿æµè§ˆå™¨çš„ â€œå¿™â€ æŒ‡ç¤ºå™¨åœæ­¢ï¼Œå‘Šè¯‰ç”¨æˆ·å½“å‰ç½‘é¡µå·²ç»åŠ è½½å®Œæ¯•ã€‚å½“ onload äº‹ä»¶åŠ è½½å»¶è¿Ÿåï¼Œå®ƒç»™ç”¨æˆ·çš„æ„Ÿè§‰å°±æ˜¯è¿™ä¸ªç½‘é¡µéå¸¸æ…¢ã€‚ window çš„ onload äº‹ä»¶éœ€è¦åœ¨æ‰€æœ‰ iframe åŠ è½½å®Œæ¯•åï¼ˆåŒ…å«é‡Œé¢çš„å…ƒç´ ï¼‰æ‰ä¼šè§¦å‘ã€‚åœ¨ Safari å’Œ Chrome é‡Œï¼Œé€šè¿‡ JavaScript åŠ¨æ€è®¾ç½® iframe çš„ SRC å¯ä»¥é¿å…è¿™ç§é˜»å¡æƒ…å†µ 3ã€å”¯ä¸€çš„è¿æ¥æ±  æµè§ˆå™¨åªèƒ½å¼€å°‘é‡çš„è¿æ¥åˆ° web æœåŠ¡å™¨ã€‚æ¯”è¾ƒè€çš„æµè§ˆå™¨ï¼ŒåŒ…å« Internet Explorer 6 &amp; 7 å’Œ Firefox 2ï¼Œåªèƒ½å¯¹ä¸€ä¸ªåŸŸåï¼ˆhostnameï¼‰åŒæ—¶æ‰“å¼€ä¸¤ä¸ªè¿æ¥ã€‚è¿™ä¸ªæ•°é‡çš„é™åˆ¶åœ¨æ–°ç‰ˆæœ¬çš„æµè§ˆå™¨ä¸­æœ‰æ‰€æé«˜ã€‚Safari 3+ å’Œ Opera 9+ å¯åŒæ—¶å¯¹ä¸€ä¸ªåŸŸåæ‰“å¼€ 4 ä¸ªè¿æ¥ï¼ŒChrome 1+, IE 8 ä»¥åŠ Firefox 3 å¯ä»¥åŒæ—¶æ‰“å¼€ 6 ä¸ª ç»å¤§éƒ¨åˆ†æµè§ˆå™¨ï¼Œä¸»é¡µé¢å’Œå…¶ä¸­çš„ iframe æ˜¯å…±äº«è¿™äº›è¿æ¥çš„ã€‚è¿™æ„å‘³ç€ iframe åœ¨åŠ è½½èµ„æºæ—¶å¯èƒ½ç”¨å…‰äº†æ‰€æœ‰çš„å¯ç”¨è¿æ¥ï¼Œä»è€Œé˜»å¡äº†ä¸»é¡µé¢èµ„æºçš„åŠ è½½ã€‚å¦‚æœ iframe ä¸­çš„å†…å®¹æ¯”ä¸»é¡µé¢çš„å†…å®¹æ›´é‡è¦ï¼Œè¿™å½“ç„¶æ˜¯å¾ˆå¥½çš„ã€‚ä½†é€šå¸¸æƒ…å†µä¸‹ï¼Œiframe é‡Œçš„å†…å®¹æ˜¯æ²¡æœ‰ä¸»é¡µé¢çš„å†…å®¹é‡è¦çš„ã€‚è¿™æ—¶ iframe ä¸­ç”¨å…‰äº†å¯ç”¨çš„è¿æ¥å°±æ˜¯ä¸å€¼å¾—çš„äº†ã€‚ä¸€ç§è§£å†³åŠæ³•æ˜¯ï¼Œåœ¨ä¸»é¡µé¢ä¸Šé‡è¦çš„å…ƒç´ åŠ è½½å®Œæ¯•åï¼Œå†åŠ¨æ€è®¾ç½® iframe çš„ SRCã€‚ 4ã€ä¸åˆ©äº SEO æœç´¢å¼•æ“çš„æ£€ç´¢ç¨‹åºæ— æ³•è§£è¯» iframeã€‚å¦å¤–ï¼Œiframe æœ¬èº«ä¸æ˜¯åŠ¨æ€è¯­è¨€ï¼Œæ ·å¼å’Œè„šæœ¬éƒ½éœ€è¦é¢å¤–å¯¼å…¥ã€‚ ç»¼ä¸Šï¼Œiframe åº”è°¨æ…ä½¿ç”¨ã€‚ contentWindowcontentWindow å±æ€§è¿”å›å½“å‰HTMLIFrameElementçš„Windowå¯¹è±¡. ä½ å¯ä»¥ä½¿ç”¨è¿™ä¸ªWindow å¯¹è±¡å»è®¿é—®è¿™ä¸ªiframeçš„æ–‡æ¡£å’Œå®ƒå†…éƒ¨çš„DOM. è¿™ä¸ªæ˜¯å¯è¯»å±æ€§, ä½†æ˜¯å®ƒçš„å±æ€§åƒå…¨å±€Window ä¸€æ ·æ˜¯å¯ä»¥æ“ä½œçš„. (æ³¨æ„å¿…é¡»åŒæºè®¿é—®) å…³äºcontentWindowçš„ç¤ºä¾‹ var x = document.getElementsByTagName(\"iframe\")[0].contentWindow; //x = window.frames[0]; x.document.getElementsByTagName(\"body\")[0].style.backgroundColor = \"blue\"; // this would turn the 1st iframe in document blue. iframeä¼˜åŒ–æ–¹æ¡ˆiframeé˜»å¡é—®é¢˜ï¼šhttps://www.cnblogs.com/sharpxiajun/p/4077515.html åŠ è½½ä¼˜åŒ–é˜…è¯»ï¼šhttps://www.open-open.com/bbs/view/1319458447249 iframeé€šä¿¡å’Œä¸€äº›å¾ˆå®ç”¨çš„åŠŸèƒ½ï¼šhttps://afantasy.ninja/2018/07/15/dive-into-iframe/ postMessageéœ€è¦å­åº”ç”¨é…åˆï¼Œä¸Šé¢é‚£ä¸ªç½‘å€è¿˜è®²è¿°äº†iframeåœ¨çº¿ç¼–è¾‘å™¨æ˜¯æ€ä¹ˆäº¤äº’çš„ï¼šæ¯æ¬¡ä¿®æ”¹jsä»£ç ï¼Œåˆ™å‘é€ä¸€ä¸ªpostè¯·æ±‚ï¼ŒPOST è¯·æ±‚ä¸­è¿˜å¸¦æœ‰ä¸€ä¸ªéšæœºç”Ÿæˆçš„ keyï¼Œæ­¤æ—¶iframeçš„srcæŒ‡å‘å¯¹åº”keyçš„ä¸€ä¸ªurlåœ°å€ iframeçš„è®¨è®ºï¼šhttps://www.stevesouders.com/blog/2009/06/03/using-iframes-sparingly/","categories":[{"name":"å‰ç«¯","slug":"å‰ç«¯","permalink":"https://taylor12138.github.io/categories/%E5%89%8D%E7%AB%AF/"}],"tags":[],"author":"Hello"},{"title":"DOM","slug":"DOM","date":"2022-06-19T08:53:13.862Z","updated":"2023-04-09T09:00:33.161Z","comments":true,"path":"2022/06/19/dom/","link":"","permalink":"https://taylor12138.github.io/2022/06/19/dom/","excerpt":"","text":"DOMåŸºç¡€DOMï¼šæ–‡æ¡£å¯¹è±¡æ¨¡å‹ï¼Œæ˜¯ä¸€ä¸ªåº”ç”¨ç¼–ç¨‹æ¥å£API W3Cå·²ç»å®šä¹‰äº†ä¸€ç³»åˆ—çš„domæ¥å£ï¼Œå¯ä»¥æ”¹å˜ç½‘é¡µå†…å®¹ã€ç»“æ„ã€æ ·å¼ æ–‡æ¡£ï¼šä¸€ä¸ªé¡µé¢å°±æ˜¯ä¸€ä¸ªæ–‡æ¡£ï¼Œç”¨documentè¡¨ç¤º å…ƒç´ ï¼šé¡µé¢å†…çš„æ‰€æœ‰æ ‡ç­¾éƒ½æ˜¯å…ƒç´ ï¼Œç”¨elementè¡¨ç¤º èŠ‚ç‚¹ï¼šç½‘é¡µä¸­æ‰€æœ‰å†…å®¹éƒ½æ˜¯ä¸€ä¸ªèŠ‚ç‚¹ï¼ˆæ³¨é‡Šï¼Œæ–‡æœ¬ï¼Œå±æ€§ç­‰ï¼‰ï¼Œç”¨nodeè¡¨ç¤º é¡¶çº§å¯¹è±¡æ˜¯document æ³¨æ„ï¼šå› ä¸ºæ–‡æ¡£æ˜¯ä»ä¸Šå¾€ä¸‹åŠ è½½ï¼Œæ‰€ä»¥scriptè¦å†™åˆ°æ–‡æ¡£æ ‡ç­¾çš„ä¸‹é¢ ï¼ˆ1ï¼‰è·å–é¡µé¢å…ƒç´ å‰æƒ…æè¦ï¼š HTMLCollectionæ˜¯å…ƒç´ é›†åˆè€ŒNodeListæ˜¯èŠ‚ç‚¹é›†åˆï¼ˆå³å¯ä»¥åŒ…å«å…ƒç´ ï¼Œä¹Ÿå¯ä»¥åŒ…å«æ–‡æœ¬èŠ‚ç‚¹ï¼‰ã€‚æ‰€ä»¥ node.childNodes è¿”å› NodeListï¼Œè€Œ node.children å’Œ node.getElementsByXXX è¿”å› HTMLCollection ã€‚ idè·å–ï¼ˆidæ˜¯å¤§å°å†™æ•æ„Ÿçš„å­—ç¬¦ä¸²ç»„æˆï¼‰ &lt;div id=\"time\">2019&lt;/div> &lt;script> var timer = document.getElementById('time'); /*è¿”å›çš„æ˜¯ä¸€ä¸ªå…ƒç´ å¯¹è±¡*/ console.dir(timer); /*diræ˜¯æ‰“å°è¿”å›çš„å…ƒç´ å¯¹è±¡ï¼Œæ›´å¥½çš„æŸ¥çœ‹é‡Œé¢çš„å±æ€§æ–¹æ³•*/ &lt;/script> &lt;/body> æ ¹æ®æ ‡ç­¾åè·å– &lt;script> // è¿”å›çš„æ˜¯è·å–è¿‡æ¥çš„å…ƒç´ å¯¹è±¡çš„é›†åˆï¼Œï¼ˆæ— è®ºå¤šå°‘ä¸ªï¼‰ä»¥ä¼ªæ•°ç»„çš„å½¢å¼å‚¨å­˜ var lis = document.getElementsByTagName('li'); console.log(lis); console.log(lis[0]); // å¯ä»¥ä½¿ç”¨element.getElementsByTagName('æ ‡ç­¾å')è·å–ï¼Œä½†æ˜¯çˆ¶å…ƒç´ å¿…é¡»æ˜¯å•ä¸ªå¯¹è±¡ï¼Œä¸èƒ½æ˜¯ä¼ªæ•°ç»„ä¹‹ç±»çš„ var oll = document.getElementsByTagName('ol'); console.log(oll[0].getElementsByTagName('li')); &lt;/script> H5æ–°å¢è·å–å…ƒç´ æ–¹æ³•ï¼Œæ ¹æ®ç±»åè·å– document.getElementsByClassName(&#39;ç±»å&#39;); H5æ–°å¢çš„ä¸‡èƒ½é€‰æ‹©å™¨ï¼ŒquerySelectorè¿”å›é€‰æ‹©å™¨çš„ç¬¬ä¸€ä¸ªå…ƒç´ å¯¹è±¡ï¼Œåˆ‡è®°é‡Œé¢é€‰æ‹©å™¨éœ€è¦åŠ ç¬¦å· querySelectorAll è¿”å›æŒ‡å®šé€‰æ‹©å™¨çš„æ‰€æœ‰å¯¹è±¡é›†åˆï¼ˆä¼ªæ•°ç»„ï¼‰ querySelectorAllå’Œ getElementsByTagNameå¯¹æ¯” é€šè¿‡querySelectorAllè·å–çš„æ˜¯è¿”å›çš„æ˜¯NodeListOf&lt;HTMLElementTagNameMap[K]&gt;ï¼Œç»è¿‡äº†ä¸€æ¬¡åŒ…è£…ï¼ˆæœ‰äº†ä¸€ä¸ªåŒ…è£…å¯¹è±¡ï¼ï¼‰ï¼Œä¿å­˜çš„æ˜¯å½“æ—¶çŠ¶æ€çš„å¿«ç…§ï¼Œæ‰€ä»¥æ˜¯é™æ€çš„ï¼Œæ˜¯æ­»çš„ï¼Œä¸ä¼šéšç€æ•°æ®æ›´æ–°è€Œæ”¹å˜ï¼Œæœ€å¥½ä½¿ç”¨ getElementsByTagName ï¼ˆè¿”å›çš„æ˜¯HTMLCollectionï¼‰è¿™äº›è¿›è¡Œæ›¿ä»£ å®ƒè¿™æ ·åšçš„çš„åŸå› æ˜¯é¿å…äº†ä½¿ç”¨NodeListå¯¹è±¡å¯èƒ½é€ æˆçš„æ€§èƒ½é—®é¢˜ é‡Œé¢çš„åŸç†æˆ‘ä»¬å¯ä»¥ä»typescriptè§’åº¦æ¥è§‚çœ‹ https://blog.csdn.net/HermitSun/article/details/95780715 ä¼ªæ•°ç»„å¯ä»¥ä½¿ç”¨es6çš„æ‰©å±•è¿ç®—ç¬¦è½¬åŒ–ä¸ºæ•°ç»„ï¼šlet lis2 = [...lis] // é€‰æ‹©ç±»å var firstbox = document.querySelector('.box'); // é€‰æ‹©id var secondbox = document.querySelector('#nav'); // é€‰æ‹©æ ‡ç­¾å var thirdbox = document.querySelector('li'); //é€‰æ‹©å…¨éƒ¨ var fourth = document.querySelectorAll('li'); å¤šé‡åµŒå¥—è¿›è¡Œé€‰æ‹© var firstbox = document.querySelector('.box').quertSelector(li); var firstbox = document.querySelectorAll('.box .item') è·å–bodyæ ‡ç­¾å’Œhtmlæ ‡ç­¾æ¯”è¾ƒç®€å•ç‰¹æ®Š //è·å–html var htmlEle = document.documentElement; // è·å–bodyå…ƒç´  var bodyEle = document.body; æ³¨æ„ï¼šè·å–åˆ°çš„æ¯ä¸ªDOMå…ƒç´ éƒ½ä½œä¸ºä¸€ä¸ªå¯¹è±¡æ¥ä½¿ç”¨ï¼ ï¼ˆ2ï¼‰äº‹ä»¶åŸºç¡€äº‹ä»¶æ˜¯å¯ä»¥è¢«jsä¾¦æµ‹åˆ°çš„è¡Œä¸ºï¼Œè§¦å‘â€“å“åº”æœºåˆ¶ äº‹ä»¶ç”±ä¸‰éƒ¨åˆ†ç»„æˆï¼šäº‹ä»¶æºï¼ˆè¢«è§¦å‘å¯¹è±¡ï¼‰ äº‹ä»¶ç±»å‹ï¼ˆè§¦å‘ç±»å‹ï¼‰ äº‹ä»¶å¤„ç†ç¨‹åº ä¸€ä¸ªç®€å•çš„äº‹ä»¶ä¾‹å­ï¼š &lt;button id=\"btn\">å“ˆå“ˆå“ˆ&lt;/button> &lt;script> var btn = document.getElementById('btn'); btn.onclick = function() { alert('å“ˆå“ˆå“ˆ'); } &lt;/script> ï¼ˆ3ï¼‰æ“ä½œå…ƒç´ æˆ‘ä»¬å¯ä»¥åˆ©ç”¨domæ“ä½œå…ƒç´ æ¥æ”¹å˜å…ƒç´ é‡Œé¢çš„å†…å®¹ element.innerText ä»èµ·å§‹ä½ç½®åˆ°ç»ˆæ­¢ä½ç½®çš„å†…å®¹ï¼Œä½†å®ƒé™¤å»htmlæ ‡ç­¾ï¼Œç©ºæ ¼æ¢è¡Œä¹Ÿä¼šå»æ‰ï¼ˆéæ ‡å‡†ï¼‰ element.innerHTML ä»èµ·å§‹ä½ç½®åˆ°ç»ˆæ­¢ä½ç½®çš„å†…å®¹ï¼Œä¿ç•™ï¼ˆè¯†åˆ«ï¼‰htmlæ ‡ç­¾å’Œç©ºæ ¼ï¼Œæ¢è¡Œï¼ˆW3Cæ ‡å‡†ï¼‰ ï¼ˆelement.textContent ç›¸å½“äºinnerTextï¼Œåªä¸è¿‡ textContent ä¼šè·å–style= â€œdisplay:noneâ€ ä¸­çš„æ–‡æœ¬ï¼Œè€ŒinnerTextä¸ä¼š textContent ä¼šè·å–styleæ ‡ç­¾é‡Œé¢çš„æ–‡æœ¬ã€scriptæ ‡ç­¾é‡Œçš„æ–‡æœ¬ï¼Œè€ŒinnerText ä¸ä¼š ï¼‰ åŒæ—¶ï¼Œè¿™ä¸¤ä¸ªæ ‡ç­¾æ˜¯å¯è¯»å†™çš„ï¼Œå¯ä»¥è·å–å…ƒç´ é‡Œé¢çš„å†…å®¹ btn.onclick = function() { div.innerText = '2020'; /*ç‚¹å‡»åä¿®æ”¹å®ƒçš„æ–‡å­—*/ img.src = 'xxxx'; /*æ”¹å˜å›¾ç‰‡çš„src*/ img.title = 'xxxx'; /*æ”¹å˜å›¾ç‰‡çš„æ–‡å­—æç¤º*/ input.value = 'xxx' /*æ”¹å˜è¡¨å•çš„å€¼*/ this.disabled = true; /*ç‚¹å‡»åæ­¤æŒ‰é’®åï¼Œæ­¤æŒ‰é’®è¢«ç¦ç”¨ï¼ŒthisæŒ‡å‘çš„æ˜¯äº‹ä»¶å‡½æ•°çš„è°ƒç”¨è€…*/ } p.innerText = 'pp'; /*åˆ·æ–°é¡µé¢ç›´æ¥ä¿®æ”¹å®ƒçš„æ–‡å­—*/ console.log(p.innerText); ä¿®æ”¹æ ·å¼ï¼ˆé€šè¿‡JSä¿®æ”¹åï¼Œå˜æˆè¡Œå†…æ ·å¼ï¼Œæƒé‡æ¯”è¾ƒé«˜ï¼‰ div.onclick = function() { //1.æ ·å¼æ¯”è¾ƒå°‘çš„è¯ä½¿ç”¨æ­¤æ–¹æ³• //é‡‡ç”¨é©¼å³°å‘½åï¼ŒåŸæ¥çš„ background-color -> backgroundColor this.style.backgroundColor = 'purple'; //2.å¦ä¸€ä¸ªæ–¹æ³•å°±æ˜¯å†å†™ä¸€ä¸ªç±»ï¼Œé‡Œé¢åŒ…å«äº†æ‰€æœ‰ä½ æƒ³è¦æ”¹å˜çš„æ ·å¼ï¼Œä½†æ˜¯æ³¨æ„ï¼Œå®ƒä¼šè¦†ç›–åŸå…ˆçš„ç±»å this.className = 'æ ·å¼å'; //3.ä¿ç•™åŸå…ˆå¾—ç±» this.className = 'åŸå…ˆæ ·å¼å æ–°æ ·å¼å' } è¡¨å•çš„è·å–ç„¦ç‚¹ var text = document.querySelector('input'); text.onfocus = function () { //è·å¾—ç„¦ç‚¹ if (this.value) { this.value = ''; } this.style.color = '#333' } text.onblur = function () { //å¤±å»ç„¦ç‚¹ if (this.value === '') { this.value = 'æ‰‹æœº'; } this.style.color = '#999' } è¡¨å•ç»è¿‡äº‹ä»¶ï¼ˆç±»ä¼¼äºâ€œ :hover â€ï¼‰ // 1.è·å–å…ƒç´  è·å–çš„æ˜¯ tbody é‡Œé¢æ‰€æœ‰çš„è¡Œ var trs = document.querySelector('tbody').querySelectorAll('tr'); // 2. åˆ©ç”¨å¾ªç¯ç»‘å®šæ³¨å†Œäº‹ä»¶ for (var i = 0; i &lt; trs.length; i++) { // 3. é¼ æ ‡ç»è¿‡äº‹ä»¶ onmouseover trs[i].onmouseover = function() { this.className = 'bg'; } // 4. é¼ æ ‡ç¦»å¼€äº‹ä»¶ onmouseout trs[i].onmouseout = function() { this.className = ''; } } å…¨é€‰æ¡†å°æ¡ˆä¾‹ï¼š // è·å–å…ƒç´  var Btn_All = document.getElementById('Btn_All'); // å…¨é€‰æŒ‰é’® var Btns = document.getElementById('Btns').getElementsByTagName('input'); // ä¸‹é¢æ‰€æœ‰çš„å¤é€‰æ¡† //1.è®©ä¸‹é¢æ‰€æœ‰å¤é€‰æ¡†çš„checkedå±æ€§ï¼ˆé€‰ä¸­çŠ¶æ€ï¼‰ è·Ÿéš å…¨é€‰æŒ‰é’®å³å¯ Btn_All.onclick = function () { for (var i = 0; i &lt; Btns.length; i++) { Btns[i].checked = this.checked; } } // 2. æ¯æ¬¡ç‚¹å‡»ï¼Œéƒ½è¦å¾ªç¯æŸ¥çœ‹ä¸‹é¢æ‰€æœ‰çš„å¤é€‰æ¡†æ˜¯å¦æœ‰æ²¡é€‰ä¸­çš„ï¼Œå¦‚æœæœ‰ä¸€ä¸ªæ²¡é€‰ä¸­çš„ï¼Œ ä¸Šé¢å…¨é€‰å°±ä¸é€‰ä¸­ã€‚ for (var i = 0; i &lt; Btns.length; i++) { Btns[i].onclick = function () { var flag = true; for (var i = 0; i &lt; Btns.length; i++) { if (!Btns[i].checked) { flag = false; break; } } Btn_All.checked = flag; } } ï¼ˆ4ï¼‰è‡ªå®šä¹‰å±æ€§jsçš„ä¸¤ç§å…ƒç´ å±æ€§è·å–æ–¹æ³•ï¼š element.å±æ€§è·å–å±æ€§ element.getAttribute(&#39;å±æ€§&#39;)ä¹Ÿæ˜¯è·å–å±æ€§ï¼Œä¸è¿‡è¿™ä¸ªå¯ä»¥è·å–è‡ªå®šä¹‰å±æ€§ è‡ªå®šä¹‰å±æ€§ï¼š&lt;div id=&quot;demo&quot; index=&quot;1&quot;&gt;&lt;/div&gt; ä¸­çš„index è®¾å®šå±æ€§å€¼ï¼š element.å±æ€§ = å€¼ è®¾ç½®å†…ç½®å±æ€§ element.setAttribute(&#39;å±æ€§&#39;,&#39;å€¼&#39;) åŒä¸Šï¼Œä¸»è¦è®¾ç½®è‡ªå®šä¹‰å±æ€§ï¼Œå®ƒçš„classæ¯”è¾ƒç‰¹æ®Šï¼Œä¸ä½¿ç”¨classNameï¼Œä½¿ç”¨classï¼Œå¦‚ div.setAttribute(â€˜classâ€™, â€˜footerâ€™); name è¡¨ç¤ºå±æ€§åç§°çš„å­—ç¬¦ä¸²ã€‚DOMStringæŒ‡å®šè¦è®¾ç½®å…¶å€¼çš„å±æ€§çš„åç§°ã€‚setAttribute()åœ¨ HTML æ–‡æ¡£ä¸­çš„ HTML å…ƒç´ ä¸Šè°ƒç”¨æ—¶ï¼Œå±æ€§åç§°ä¼šè‡ªåŠ¨è½¬æ¢ä¸ºå…¨éƒ¨å°å†™ã€‚ value å±æ€§çš„å€¼/æ–°å€¼ã€‚ä¸€ä¸ªDOMStringåŒ…å«äº†åˆ†é…ç»™è¿™ä¸ªå±æ€§çš„å€¼ã€‚ä»»ä½•éå­—ç¬¦ä¸²çš„å€¼éƒ½ä¼šè¢«è‡ªåŠ¨è½¬æ¢ä¸ºå­—ç¬¦ä¸²ã€‚ ç§»é™¤å±æ€§ï¼šelement.removeAttribute(&#39;å±æ€§å&#39;) æ˜¯å¦æ‹¥æœ‰è¯¥å±æ€§ï¼šelement.hasAttribute(&#39;å±æ€§å&#39;) H5è§„èŒƒï¼šH5è§„å®šè‡ªå®šä¹‰å±æ€§ä»¥â€œdata-â€ä½œä¸ºå¼€å¤´ï¼Œå¹¶ä¸”èµ‹å€¼ï¼Œæ¯”å¦‚ &lt;div data-index=&quot;1&quot;&gt;&lt;/div&gt; H5æ–°å¢è·å–è‡ªå®šä¹‰å±æ€§çš„æ–¹æ³•ï¼šdiv.dataset.indexï¼ˆå±æ€§åä¸ºdata-indexï¼‰ï¼Œ div.dataset.listName(å±æ€§åä¸ºdata-list-name) ï¼Œdatasetæ˜¯ä¸€ä¸ªé›†åˆé‡Œé¢å­˜æ”¾äº†æ‰€æœ‰ä»¥dataå¼€å¤´çš„è‡ªå®šä¹‰å±æ€§ ï¼ˆ5ï¼‰èŠ‚ç‚¹æ“ä½œdomæä¾›çš„è·å–å…ƒç´ æ–¹æ³•æ¯”è¾ƒç¹çï¼Œåˆ©ç”¨èŠ‚ç‚¹çˆ¶å­å…„å¼Ÿå…³ç³»è·å–å…ƒç´ æ¯”è¾ƒæ–¹ä¾¿ï¼Œä½†æ˜¯å…¼å®¹æ€§å·® åœ¨DOMçš„æ‰€æœ‰èŠ‚ç‚¹ä¸­éƒ½å®ç°äº†Nodeè¿™ä¸ªæ¥å£ ä¸€èˆ¬çš„ï¼ŒèŠ‚ç‚¹è‡³å°‘æ‹¥æœ‰èŠ‚ç‚¹ç±»å‹ï¼ˆnodeTypeï¼‰ã€èŠ‚ç‚¹åç§°ï¼ˆnodeNameï¼‰ã€èŠ‚ç‚¹å€¼ï¼ˆnodeValueï¼‰ å…ƒç´ èŠ‚ç‚¹ nodeType = 1 èŠ‚ç‚¹æ“ä½œä¸€èˆ¬éƒ½æ˜¯æ“ä½œå…ƒç´ èŠ‚ç‚¹ï¼Œå”¯ä¸€ä½¿ç”¨attributeså±æ€§çš„DOMèŠ‚ç‚¹ç±»å‹ å±æ€§èŠ‚ç‚¹ nodeType = 2 æ–‡æœ¬èŠ‚ç‚¹ nodeType = 3 ï¼ˆæ€»å…±æœ‰12ç§èŠ‚ç‚¹ï¼Œä»¥ä¸‹å±•ç¤ºéƒ¨åˆ†èŠ‚ç‚¹ï¼‰ çˆ¶äº²èŠ‚ç‚¹ï¼š node.parentNode (å¾—åˆ°çš„æ˜¯ç¦»å…ƒç´ æœ€è¿‘çš„çˆ¶èŠ‚ç‚¹ï¼Œæ‰¾ä¸åˆ°çˆ¶èŠ‚ç‚¹è¿”å›ç©ºå€¼) å­©å­èŠ‚ç‚¹ï¼š node.childNodes è¿”å›åŒ…å«èŠ‚ç‚¹çš„å­èŠ‚ç‚¹çš„é›†åˆ(NodeListï¼Œå› ä¸ºç¹çï¼Œæ‰€ä»¥å®é™…å¼€å‘ä¸æå€¡ä½¿ç”¨childNodes) var ul = document.querySelect(&#39;ul&#39;); for (var i = 0; i &lt; ul.childNodes.length; i++) { if(ul.childNodes[i].nodeType == 1) { console.log(lu.childNodes[i]); } }(new) å­©å­èŠ‚ç‚¹ï¼š parentNode.children è¿”å›æ‰€æœ‰å­å…ƒç´ èŠ‚ç‚¹ ï¼ˆå¸¸ç”¨,HTMLCollectionï¼‰ parentNode.firsElementtChild è¿”å›ç¬¬ä¸€ä¸ªå…ƒç´ å­èŠ‚ç‚¹ï¼Œæ‰¾ä¸åˆ°è¿”å›null parentNode.firstChild è¿”å›ç¬¬ä¸€ä¸ªå…ƒç´ å­èŠ‚ç‚¹ï¼Œæ‰¾ä¸åˆ°è¿”å›null parentNode.lastChild è¿”å›æœ€åä¸€ä¸ªå…ƒç´ å­èŠ‚ç‚¹ï¼Œæ‰¾ä¸åˆ°è¿”å›null è¿™ä¸¤ä¸ªæ–¹æ³•æœ‰å…¼å®¹é—®é¢˜ie9ä»¥ä¸Šæ‰èƒ½ä½¿ç”¨ æ‰€ä»¥æ¨èå†™æ³•ï¼š parentNode.children[0] parentNode.children[parentNode.children.lenth-1] ä¸‹ä¸€ä¸ªå…„å¼Ÿå…ƒç´ èŠ‚ç‚¹ï¼šnode.nextElementSibling æ‰¾ä¸åˆ°è¿”å›null ä¸Šä¸€ä¸ªå…„å¼Ÿå…ƒç´ èŠ‚ç‚¹ï¼šnode.previousElementSibling æ‰¾ä¸åˆ°è¿”å›null è¿™ä¸¤ä¸ªæ–¹æ³•æœ‰å…¼å®¹é—®é¢˜ie9ä»¥ä¸Šæ‰èƒ½ä½¿ç”¨ åˆ›å»ºèŠ‚ç‚¹ document.createElement(&#39;targetName&#39;) åŠ¨æ€åˆ›å»ºèŠ‚ç‚¹ åˆ›å»ºæ–‡æœ¬èŠ‚ç‚¹ document.createTextNode(vNode) æ·»åŠ èŠ‚ç‚¹ node.appendChild(child) åˆ›å»ºå®Œåéœ€è¦æ·»åŠ èŠ‚ç‚¹ï¼Œæ­¤æ–¹æ³•æ˜¯å°†ä¸€ä¸ªèŠ‚ç‚¹æ·»åŠ åˆ°æŒ‡å®šçˆ¶èŠ‚ç‚¹çš„å­èŠ‚ç‚¹åˆ—è¡¨æœ«å°¾ï¼Œç±»ä¼¼äºCSSä¸­çš„afterä¼ªå…ƒç´  ,childå†™åç§°ä¸ç”¨åŠ  â€˜ â€™ï¼ˆä¸æ”¯æŒè¿½åŠ å­—ç¬¦ä¸²å­å…ƒç´ ï¼‰ è·å–çˆ¶èŠ‚ç‚¹ parentElement = node.parentElement orï¼š node.insertBefore(child, æŒ‡å®šå…ƒç´ ï¼ˆå­èŠ‚ç‚¹ï¼‰) å°†ä¸€ä¸ªèŠ‚ç‚¹æ·»åŠ åˆ°çˆ¶èŠ‚ç‚¹æŒ‡å®šçš„å­èŠ‚ç‚¹å‰é¢ var li = document.createElement('li'); var ul = document.querySelector('ul'); ul.appendChild(li); var li_2 = document.createElement('li'); ul.insertBefore(li_2, ul.children[0]); /*æ·»åŠ è‡³å¼€å¤´*/ var h=document.createElement(\"H1\") var t=document.createTextNode(\"Hello World\"); h.appendChild(t); /*åˆ›å»ºä¸€ä¸ªæ ‡é¢˜ (H1), ä½ å¿…é¡»åˆ›å»º \"H1\" å…ƒç´ å’Œæ–‡æœ¬èŠ‚ç‚¹:*/ å‘è¡¨è¯„è®ºæ¡ˆä¾‹ï¼š &lt;textarea name=\"\" id=\"\">&lt;/textarea> &lt;button>å‘å¸ƒ&lt;/button> &lt;ul>&lt;/ul> &lt;script> var btn = document.querySelector('button'); var text = document.querySelector('textarea'); var ul = document.querySelector('ul'); btn.onclick = function() { if (text.value == '') { alert('æ‚¨æ²¡æœ‰è¾“å…¥å†…å®¹'); return false; } else { var li = document.createElement('li'); //å¹¶ä¸”æ·»åŠ åˆ é™¤åŠŸèƒ½ li.innerHTML = text.value + \"&lt;a href='javascript:;'>åˆ é™¤&lt;/a>\"; //javascript:;æ„æ€æ˜¯é¡µé¢ä¸å‘ç”Ÿè·³è½¬ ul.insertBefore(li, ul.children[0]); //åˆ é™¤å…ƒç´  var as = document.querySelectorAll('a'); for(var i = 0; i &lt; as.length; i++) { as[i].onclick = funciton() { ul.removeChild(this.parentNode) } } } } &lt;/script> åˆ é™¤èŠ‚ç‚¹ï¼šnode.removeChild(child) è¿”å›åˆ é™¤çš„èŠ‚ç‚¹ node.remove() è¿”å›åˆ é™¤çš„èŠ‚ç‚¹ï¼ˆï¼‰åˆ é™¤æœ¬èº« å¤åˆ¶èŠ‚ç‚¹ï¼š node.cloneNode() å…‹éš†å®ŒèŠ‚ç‚¹ä¹‹åï¼Œå’Œåˆ›å»ºèŠ‚ç‚¹ä¸€æ ·ä¹Ÿå¿…é¡»è¦æ·»åŠ èŠ‚ç‚¹æ‰èƒ½æ˜¾ç¤ºå‡ºæ¥ 1.å¦‚æœæ‹¬å·å‚æ•°ä¸ºç©ºï¼Œæ˜¯æµ…æ‹·è´ï¼Œåªå…‹éš†è¯¥èŠ‚ç‚¹æœ¬èº«ï¼Œä¸å…‹éš†å…¶å­èŠ‚ç‚¹ï¼Œå³æ²¡æœ‰ä»»ä½•å†…å®¹ node.cloneNode(true) æ·±æ‹·è´ å¤åˆ¶æ ‡ç­¾å¹¶ä¸”å¤åˆ¶é‡Œé¢çš„å†…å®¹ ï¼ˆ6ï¼‰åˆ›å»ºæ ‡ç­¾çš„å››ç§æ–¹æ³•ï¼š1.element.write() å†™å…¥å†…å®¹ï¼ˆæ ‡ç­¾ï¼‰ï¼Œä½†æ˜¯é¡µé¢æ–‡æ¡£æµåŠ è½½å®Œæ¯•ï¼Œå¦‚æœåœ¨é¡µé¢åŠ è½½å®Œæˆåå†è°ƒç”¨ document.write()ï¼Œåˆ™ä¼šé‡å†™æ•´ä¸ªé¡µé¢ &lt;script type=\"text/javascript\"> window.onload = function() { document.write(\"hello, world\"); //hello world é‡å†™æ•´ä¸ªé¡µé¢ } &lt;/script> 2.element.innerHTML ä»èµ·å§‹ä½ç½®åˆ°ç»ˆæ­¢ä½ç½®çš„å†…å®¹ï¼Œä¿ç•™ï¼ˆè¯†åˆ«ï¼‰htmlæ ‡ç­¾å’Œç©ºæ ¼ï¼Œæ¢è¡Œï¼ˆW3Cæ ‡å‡†ï¼‰ åŒæ—¶ï¼Œè¿™ä¸¤ä¸ªæ ‡ç­¾æ˜¯å¯è¯»å†™çš„ï¼Œå¯ä»¥è·å–å…ƒç´ é‡Œé¢çš„å†…å®¹ 3.document.createElement(&#39;targetName&#39;) åŠ¨æ€åˆ›å»ºèŠ‚ç‚¹ document.createElement(&#39;targetName&#39;)å¯¹æ¯”ä½¿ç”¨element.innerHTML å†™å¤šä¸ªæ ‡ç­¾ä¼šæ›´çœæ—¶ï¼Œçœç©ºé—´ï¼Œå› ä¸ºä»–åˆ›å»ºå¤šä¸ªæ ‡ç­¾æ—¶ä¸ç”¨å¼€è¾Ÿæ–°çš„ç©ºé—´ï¼Œè€ŒinnerHTMLä½¿ç”¨æ‹¼æ¥çš„åŸç†ï¼Œæ‰€ä»¥æ¯æ¬¡éƒ½è¦è¦å¼€è¾Ÿæ–°çš„ç©ºé—´ ä½†æ˜¯ï¼Œå¦‚æœelement.innerHTML ä¸ç”¨æ‹¼æ¥å­—ç¬¦ä¸²çš„æ–¹æ³•æ¥å®ç°åˆ›å»ºå¤šä¸ªæ ‡ç­¾ï¼Œè€Œæ˜¯é‡‡ç”¨æ•°ç»„çš„å½¢å¼æ‹¼æ¥ï¼Œç»“æ„å†™éº»çƒ¦ä¸€ç‚¹ï¼š var arr[]; for(var i = 0; i &lt; 100; i++) { arr.push('&lt;a href=\"#\">ç™¾åº¦&lt;/a>'); } //ä»¥''è¿›è¡Œæ‹¼æ¥ï¼Œå¹¶ä¸”è½¬åŒ–ä¸ºå­—ç¬¦ä¸² xx.innerHTML = arr.join(''); æ‰§è¡Œèµ·æ¥ä¼šæ¯” document.createElement(&#39;targetName&#39;) æ›´å¿«ï¼Œä½†æ˜¯ç»“æ„ä¸å¤ªæ¸…æ™° element.insertAdjacentHTML(æ’å…¥çš„ä½ç½®, æ’å…¥çš„å­—ç¬¦ä¸²)å¯ä»¥ç›´æ¥æŠŠå­—ç¬¦ä¸²æ ¼å¼å…ƒç´ æ·»åŠ åˆ°çˆ¶å…ƒç´ ä¸­ element.insertAdjacentHTML(\"beforebegin\", \"&lt;a href=\"#\">ç™¾åº¦&lt;/a>\"); æ’å…¥ä½ç½®ï¼šbeforebegin å…ƒç´ è‡ªèº«å‰é¢ afterbegin æ’å…¥å…ƒç´ å†…éƒ¨ç¬¬ä¸€ä¸ªå­èŠ‚ç‚¹ä¹‹å‰ â€‹ beforeend æ’å…¥å…ƒç´ å†…éƒ¨çš„æœ€åä¸€ä¸ªå­èŠ‚ç‚¹ä¹‹å afterend å…ƒç´ è‡ªèº«çš„åé¢ ï¼ˆæ³¨æ„ï¼šappendChildä¸æ”¯æŒè¿½åŠ å­—ç¬¦ä¸²å­å…ƒç´ ï¼ŒinsertAdjacentHTMLæ”¯æŒè¿½åŠ å­—ç¬¦ä¸²å­å…ƒç´ ï¼‰ document.createDocumentFragment() æœ‰ç‚¹ç±»ä¼¼ document.createElement(&#39;targetName&#39;) ï¼ŒåŒºåˆ«åœ¨äºï¼š ï¼ˆ1ï¼‰éœ€è¦å¾ˆå¤šçš„æ’å…¥æ“ä½œå’Œæ”¹åŠ¨ï¼Œä½¿ç”¨createElementæ•ˆç‡æ˜¯æ¯”è¾ƒä½çš„ï¼Œè€ŒinnerHTMLæ‹¼æ¥æ–¹æ³•çµæ´»æ€§æ¯”è¾ƒå·®ï¼Œåˆ©ç”¨DocumentFragmentï¼Œå¯ä»¥å¼¥è¡¥è¿™ä¸¤ä¸ªæ–¹æ³•çš„ä¸è¶³ ï¼ˆ2ï¼‰createDocumentFragmentåˆ›å»ºçš„å…ƒç´ ä½¿ç”¨innerHTMLå¹¶ä¸èƒ½è¾¾åˆ°é¢„æœŸä¿®æ”¹æ–‡æ¡£å†…å®¹çš„æ•ˆæœ ï¼ˆ3ï¼‰createDocumentFragmentåˆ›å»ºçš„å…ƒç´ æ˜¯ä¸€æ¬¡æ€§çš„ï¼Œæ·»åŠ ä¹‹åå†å°±ä¸èƒ½æ“ä½œäº† ï¼ˆ4ï¼‰ é€šè¿‡createElementæ–°å»ºå…ƒç´ å¿…é¡»æŒ‡å®šå…ƒç´ tagName,å› ä¸ºå…¶å¯ç”¨innerHTMLæ·»åŠ å­å…ƒç´ ã€‚é€šè¿‡createDocumentFragmentåˆ™ä¸å¿…ã€‚ ï¼ˆ5ï¼‰é€šè¿‡createElementåˆ›å»ºçš„å…ƒç´ æ’å…¥æ–‡æ¡£åï¼Œè¿˜å¯ä»¥å–åˆ°åˆ›å»ºæ—¶çš„è¿”å›å€¼ element.outerHTMLç±»ä¼¼äº innerHTMLçš„æ•ˆæœï¼Œåªä¸è¿‡æ˜¯èµ·åˆ°äº†replaceçš„æ•ˆæœ ï¼ˆ7ï¼‰Shadow DOMæˆ‘ä»¬æ­£å¸¸çš„domç»“æ„å°±æ˜¯ä¸€é¢—domæ ‘ Shadow DOM å…è®¸å°†éšè—çš„ DOM æ ‘é™„åŠ åˆ°å¸¸è§„çš„ DOM æ ‘ä¸­â€”â€”å®ƒä»¥ shadow root èŠ‚ç‚¹ä¸ºèµ·å§‹æ ¹èŠ‚ç‚¹ï¼Œåœ¨è¿™ä¸ªæ ¹èŠ‚ç‚¹çš„ä¸‹æ–¹ï¼Œå¯ä»¥æ˜¯ä»»æ„å…ƒç´ ï¼Œå’Œæ™®é€šçš„ DOM å…ƒç´ ä¸€æ ·ã€‚ ä½ ä¹Ÿå¯ä»¥ç†è§£ä¸ºï¼š ä¸€ä¸ª DOM å…ƒç´ å¯ä»¥æœ‰ä»¥ä¸‹ä¸¤ç±» DOM å­æ ‘ï¼š Light treeï¼ˆå…‰æ˜æ ‘ï¼‰ â€”â€” ä¸€ä¸ªå¸¸è§„ DOM å­æ ‘ï¼Œç”± HTML å­å…ƒç´ ç»„æˆã€‚æˆ‘ä»¬åœ¨ä¹‹å‰ç« èŠ‚çœ‹åˆ°çš„æ‰€æœ‰å­æ ‘éƒ½æ˜¯ã€Œå…‰æ˜çš„ã€ã€‚ Shadow treeï¼ˆå½±å­æ ‘ï¼‰ â€”â€” ä¸€ä¸ªéšè—çš„ DOM å­æ ‘ï¼Œä¸åœ¨ HTML ä¸­åæ˜ ï¼Œæ— æ³•è¢«å¯Ÿè§‰ã€‚ è¿™é‡Œä¸¾äº†ä¸€ä¸ªå¾ˆå¥½çš„ä¾‹å­ï¼Œshadow dom å°±åƒä¸€ä¸ªvideoï¼šhttps://www.cnblogs.com/coco1s/p/5711795.html åˆ›å»ºæ–¹å¼ï¼š elem.attachShadow({mode: â€¦}) mode é€‰é¡¹å¯ä»¥è®¾å®šå°è£…å±‚çº§ã€‚ä»–å¿…é¡»æ˜¯ä»¥ä¸‹ä¸¤ä¸ªå€¼ä¹‹ä¸€ï¼š ã€Œopenã€ â€”â€” shadow root å¯ä»¥é€šè¿‡ elem.shadowRoot è®¿é—®ã€‚ ä»»ä½•ä»£ç éƒ½å¯ä»¥è®¿é—® elem çš„ shadow treeã€‚ ã€Œclosedã€ â€”â€” elem.shadowRoot æ°¸è¿œæ˜¯ nullã€‚ æˆ‘ä»¬åªèƒ½é€šè¿‡ attachShadow è¿”å›çš„æŒ‡é’ˆæ¥è®¿é—® shadow DOMï¼ˆå¹¶ä¸”å¯èƒ½éšè—åœ¨ä¸€ä¸ª class ä¸­ï¼‰ã€‚æµè§ˆå™¨åŸç”Ÿçš„ shadow treeï¼Œæ¯”å¦‚ &lt;input type=&quot;range&quot;&gt;ï¼Œæ˜¯å°é—­çš„ã€‚æ²¡æœ‰ä»»ä½•æ–¹æ³•å¯ä»¥è®¿é—®å®ƒä»¬ã€‚ ä½ å¯ä»¥ä½¿ç”¨åŒæ ·çš„æ–¹å¼æ¥æ“ä½œ Shadow DOMï¼Œå°±å’Œæ“ä½œå¸¸è§„ DOM ä¸€æ ·â€”â€”ä¾‹å¦‚æ·»åŠ å­èŠ‚ç‚¹ã€è®¾ç½®å±æ€§ï¼Œä»¥åŠä¸ºèŠ‚ç‚¹æ·»åŠ è‡ªå·±çš„æ ·å¼ï¼ˆä¾‹å¦‚é€šè¿‡ element.style å±æ€§ï¼‰ï¼Œæˆ–è€…ä¸ºæ•´ä¸ª Shadow DOM æ·»åŠ æ ·å¼ï¼ˆä¾‹å¦‚åœ¨ `` å…ƒç´ å†…æ·»åŠ æ ·å¼ï¼‰ã€‚ä¸åŒçš„æ˜¯ï¼ŒShadow DOM å†…éƒ¨çš„å…ƒç´ å§‹ç»ˆä¸ä¼šå½±å“åˆ°å®ƒå¤–éƒ¨çš„å…ƒç´ ï¼ˆé™¤äº† :focus-withinï¼‰ï¼Œè¿™ä¸ºå°è£…æä¾›äº†ä¾¿åˆ©ã€‚ äº‹ä»¶éƒ¨åˆ†1.æ³¨å†Œäº‹ä»¶ä¼ ç»Ÿæ–¹å¼ï¼š btn.onclick = function() {} æ³¨å†Œäº‹ä»¶å”¯ä¸€æ€§ï¼Œæœ€åæ³¨å†Œå¤„ç†çš„å‡½æ•°ä¼šè¦†ç›–æ‰å‰é¢æ³¨å†Œå¤„ç†çš„å‡½æ•°ï¼Œå³ä¸€ä¸ªå…ƒç´ åªèƒ½è®¾ç½®ä¸€ä¸ªå¤„ç†å‡½æ•° w3cæ ‡å‡†çš„æ¨èæ–¹å¼ï¼šï¼ˆie9ä»¥å‰ä¸æ”¯æŒæ­¤æ–¹æ³•ï¼Œå³ie8ç­‰ä¸æ”¯æŒï¼‰ target.addEventListener(type, listener, options); target.addEventListener(type, listener, useCapture); ï¼ˆie9ä»¥å‰ä½¿ç”¨çš„æ˜¯eventTarget.attachEvent(type, listener[, useCapture]);ï¼‰ typeï¼šäº‹ä»¶ç±»å‹ï¼Œå¦‚clickï¼Œmouseoverï¼Œä¸å¸¦on listenerï¼šäº‹ä»¶å¤„ç†ï¼Œäº‹ä»¶å‘ç”Ÿæ—¶ä¼šè°ƒç”¨å…¶ç›‘å¬å‡½æ•° useCaptureï¼šå¯é€‰å‚æ•°ï¼Œé»˜è®¤falseï¼Œä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤º listener ä¼šåœ¨è¯¥ç±»å‹çš„äº‹ä»¶æ•è·é˜¶æ®µä¼ æ’­åˆ°è¯¥ EventTarget æ—¶è§¦å‘ã€‚ optionï¼šä¸€ä¸ªæŒ‡å®šæœ‰å…³ listenerå±æ€§çš„å¯é€‰å‚æ•°å¯¹è±¡ã€‚ capture: Booleanï¼Œè¡¨ç¤º listener ä¼šåœ¨è¯¥ç±»å‹çš„äº‹ä»¶æ•è·é˜¶æ®µä¼ æ’­åˆ°è¯¥ EventTarget æ—¶è§¦å‘ã€‚ once: Booleanï¼Œè¡¨ç¤º listener åœ¨æ·»åŠ ä¹‹åæœ€å¤šåªè°ƒç”¨ä¸€æ¬¡ã€‚å¦‚æœæ˜¯ trueï¼Œ listener ä¼šåœ¨å…¶è¢«è°ƒç”¨ä¹‹åè‡ªåŠ¨ç§»é™¤ã€‚ passive: Booleanï¼Œè®¾ç½®ä¸º true æ—¶ï¼Œè¡¨ç¤º listener æ°¸è¿œä¸ä¼šè°ƒç”¨ preventDefault()ã€‚å¦‚æœ listener ä»ç„¶è°ƒç”¨äº†è¿™ä¸ªå‡½æ•°ï¼Œå®¢æˆ·ç«¯å°†ä¼šå¿½ç•¥å®ƒå¹¶æŠ›å‡ºä¸€ä¸ªæ§åˆ¶å°è­¦å‘Šã€‚æŸ¥çœ‹ ä½¿ç”¨ passive æ”¹å–„çš„æ»šå±æ€§èƒ½ äº†è§£æ›´å¤šã€‚ signalï¼šAbortSignalï¼Œè¯¥ AbortSignal çš„ abort() æ–¹æ³•è¢«è°ƒç”¨æ—¶ï¼Œç›‘å¬å™¨ä¼šè¢«ç§»é™¤ã€‚ btn.addEventListener('click', function() { //å¿…é¡»è¦å­—ç¬¦ä¸² alert(xxx); }) btn.addEventListener('click', function() { //å¿…é¡»è¦å­—ç¬¦ä¸² alert(yyy); }) åŒä¸€ä¸ªå…ƒç´ åŒä¸€ä¸ªäº‹ä»¶å¯ä»¥æ·»åŠ å¤šä¸ªç›‘å¬å™¨ï¼Œä¸ä¼šè¦†ç›–æ‰ 2.è§£ç»‘äº‹ä»¶ä¼ ç»Ÿæ–¹å¼ï¼š eventTarget.onclick = null å¦‚ div.onclick = function() {alert(); div.onclick = null;} åœ¨ç‚¹å‡»ä¸€æ¬¡ä¹‹ååˆ é™¤è¯¥äº‹ä»¶ æ–¹æ³•ç›‘å¬æ–¹å¼ï¼ševentTarget.removeEventListener(type, listener[, useCapture]); ï¼ˆie9ä»¥å‰ä½¿ç”¨çš„æ˜¯eventTarget.detach(type, listener[, useCapture]);ï¼‰ æ–¹æ³•ç›‘å¬æ–¹å¼æ¥è§£ç»‘äº‹ä»¶ä¸èƒ½ç”¨åŒ¿åå‡½æ•°çš„æ–¹æ³•ï¼Œå³ var fun=function(){} æ‰€ä»¥ä½¿ç”¨ä»¥ä¸‹ç­–ç•¥ div.addEventListener('click', fn); function fn() { alert(xx); div.removeEventListener('click', fn); } ä½¿å¾—ç›®æ ‡divåœ¨ç‚¹å‡»ä¸€æ¬¡ä¹‹åè§£ç»‘äº‹ä»¶ 3.domäº‹ä»¶æµäº‹ä»¶å‘ç”Ÿæ—¶ä¼šåœ¨å…ƒç´ èŠ‚ç‚¹ä¹‹é—´æŒ‰ç…§ç‰¹å®šçš„é¡ºåºä¼ æ’­ï¼ˆdocument-&gt;Element gtml-&gt;Element body-&gt;Element divï¼‰ï¼Œè¿™ä¸ªä¼ æ’­è¿‡ç¨‹å³DOMäº‹ä»¶æµ DOMäº‹ä»¶æµåˆ†ä¸ºä¸‰ä¸ªé˜¶æ®µ ï¼šï¼ˆæ‰§è¡Œé¡ºåºä¹Ÿæ˜¯å¦‚æ­¤ æ•è· - &gt; å½“å‰ -&gt; å†’æ³¡ï¼‰(è®°ä½æ˜¯ä¸‰ä¸ªï¼Œè¿˜æœ‰ä¸€ä¸ªç›®æ ‡é˜¶æ®µï¼ï¼ï¼) 1.æ•è·é˜¶æ®µï¼ˆä»å¤§å¾€å°ä¼ æ’­ï¼Œä»æœ€é¡¶å±‚å¼€å§‹ï¼Œç„¶åé€çº§å‘ä¸‹ä¼ æ’­åˆ°å…·ä½“å…ƒç´ æ¥æ”¶çš„è¿‡ç¨‹ï¼‰ 2.å½“å‰ç›®æ ‡é˜¶æ®µ 3.å†’æ³¡é˜¶æ®µï¼ˆä»å°åˆ°å¤§ï¼Œä»é‡Œåˆ°å¤–çš„ä¼ æ’­ï¼Œç”±æœ€å…·ä½“çš„å…ƒç´ æ¥æ”¶ï¼Œç„¶åé€çº§å‘ä¸Šä¼ æ’­åˆ°DOMæœ€é¡¶å±‚èŠ‚ç‚¹çš„è¿‡ç¨‹ï¼‰ æ³¨æ„ï¼š JSä»£ç åªèƒ½æ‰§è¡Œæ•è·æˆ–è€…å†’æ³¡å…¶ä¸­ä¸€ä¸ªé˜¶æ®µï¼ˆé™¤éä½ è®¾ç½®ä¸¤ä¸ªç›‘å¬å‡½æ•°ï¼Œä¸€ä¸ªæ‰§è¡Œæ•è·ï¼Œä¸€ä¸ªæ‰§è¡Œå†’æ³¡ï¼‰ï¼› ä¼ ç»Ÿæ³¨å†Œäº‹ä»¶æ–¹å¼ï¼ˆonclickã€attachEventï¼‰åªèƒ½å¾—åˆ°å†’æ³¡é˜¶æ®µï¼ŒeventTarget.addEventListener(type, listerner[, useCapture])ç¬¬ä¸‰ä¸ªå‚æ•°å¦‚æœæ˜¯trueï¼Œåˆ™åœ¨äº‹ä»¶æ•è·é˜¶æ®µè°ƒç”¨ç¨‹åºï¼Œå¦‚æœæ˜¯falseï¼ˆé»˜è®¤ï¼‰ï¼Œåˆ™åœ¨å†’æ³¡é˜¶æ®µè°ƒç”¨äº‹ä»¶ å¦‚æœäº‹ä»¶è§¦å‘åœ¨â€œå½“å‰ç›®æ ‡é˜¶æ®µâ€ï¼Œåˆ™å½“å‰ç›®æ ‡ä¼šæ ¹æ®äº‹ä»¶æ³¨å†Œçš„å…ˆåé¡ºåºæ‰§è¡Œï¼Œè€Œä¸æ˜¯ä¸Šé¢æåŠåˆ°çš„ æ•è· - &gt; å½“å‰ -&gt; å†’æ³¡ï¼Œæ¯”å¦‚ï¼šçˆ·èŠ‚ç‚¹ï¼Œçˆ¶èŠ‚ç‚¹ï¼Œå­èŠ‚ç‚¹éƒ½ç»‘å®šäº† æ•è·äº‹ä»¶å’Œç›‘å¬äº‹ä»¶ï¼Œè€Œè§¦å‘å­èŠ‚ç‚¹çš„äº‹ä»¶ï¼Œæ‰§è¡Œçˆ·ã€çˆ¶çš„äº‹ä»¶æ‰§è¡Œé¡ºåºä¸€å®šæ˜¯ æ•è· - &gt; å½“å‰ -&gt; å†’æ³¡ï¼›è€Œå­èŠ‚ç‚¹æ˜¯æ ¹æ®äº‹ä»¶æ³¨å†Œçš„å…ˆåé¡ºåºæ¥æ‰§è¡Œæ•è· or å†’æ³¡äº‹ä»¶ï¼Œè¯´ç™½äº†å°±æ˜¯æ— å…³äº†ã€‚ ä»¥ä¸‹ä»£ç ï¼ŒsonåŒ…å«äºfatherå†…ï¼Œä½¿ç”¨æ•è·é˜¶æ®µï¼ˆtrueï¼‰ï¼Œåˆ™ç‚¹å‡»sonåå…ˆæ‰§è¡Œfatherå†æ‰§è¡Œsonï¼Œå†’æ³¡é˜¶æ®µåˆ™ç›¸å &lt;div class=\"father\"> &lt;div class=\"son\">sonç›’å­&lt;/div> &lt;/div> &lt;script> var son = document.querySelector('.son'); son.addEventListener('click', function() { alert('son'); }, true); var father = document.querySelector('.father'); father.addEventListener('click', function() { alert('father'); }, true); &lt;/script> ä½†æ˜¯å®é™…å¼€å‘ä¸­æˆ‘ä»¬æ›´å…³æ³¨çš„æ˜¯å†’æ³¡ï¼Œä¸”æœ‰äº›äº‹ä»¶æ˜¯æ²¡æœ‰å†’æ³¡çš„ï¼Œå¦‚onblurï¼Œonfocusï¼Œonmouseenterï¼Œonmouseleave äº‹ä»¶å§”æ‰˜å°±æ˜¯åˆ©ç”¨äº‹ä»¶å†’æ³¡ï¼ŒåªæŒ‡å®šä¸€ä¸ªäº‹ä»¶å¤„ç†ç¨‹åºï¼Œå°±å¯ä»¥ç®¡ç†æŸä¸€ç±»å‹çš„æ‰€æœ‰äº‹ä»¶ï¼šæ¯”å¦‚é€šè¿‡å†’æ³¡çˆ¶å…ƒç´ ç®¡ç†å¤šä¸ªå­å…ƒç´ çš„äº‹ä»¶ 4.äº‹ä»¶å¯¹è±¡div.addEventListener(&#39;click&#39;, funciton(event){} ) ä¸­çš„eventä¸ºäº‹ä»¶å¯¹è±¡ï¼Œå†™åˆ°æˆ‘ä»¬ç›‘å¬å‡½æ•°çš„å°æ‹¬å·é‡Œï¼Œå½“å½¢å‚çœ‹ äº‹ä»¶å¯¹è±¡åªæœ‰æœ‰äº†äº‹ä»¶æ‰ä¼šå­˜åœ¨ï¼Œå®ƒæ˜¯ç³»ç»Ÿè‡ªåŠ¨ä¸ºæˆ‘ä»¬åˆ›å»ºçš„ï¼Œä¸éœ€è¦æˆ‘ä»¬ä¼ é€’å‚æ•° äº‹ä»¶å¯¹è±¡æ˜¯æˆ‘ä»¬äº‹ä»¶ä¸€äº›åˆ—ç›¸å…³æ•°æ®çš„é›†åˆ äº‹ä»¶å¯¹è±¡ä¹Ÿæœ‰å…¼å®¹æ€§é—®é¢˜ï¼Œæ¯”å¦‚ie6ã€7ã€8ï¼Œé€šè¿‡window.eventè·å– å¸¸è§äº‹ä»¶å¯¹è±¡å±æ€§ï¼ˆå¯¹ä½ç‰ˆæœ¬æµè§ˆå™¨æœ‰å…¼å®¹æ€§é—®é¢˜ï¼‰ï¼š div.addEventListener('click', function(e) { console.log(e.target); console.log(this); /*ä¸¤è€…æœ‰äº›è®¸ç›¸ä¼¼ï¼Œä½†æ˜¯e.targetè¿”å›çš„æ˜¯è§¦å‘äº‹ä»¶çš„å…ƒç´ ï¼Œthisè¿”å›çš„æ˜¯ç»‘å®šäº‹ä»¶çš„å¯¹è±¡ï¼ˆå…ƒç´ ï¼‰*/ console.log(e.type); //è¿”å›äº‹ä»¶ç±»å‹ e.preventDefault(); //é˜»æ­¢é»˜è®¤äº‹ä»¶ï¼Œè®©å®ƒæˆä¸ºä¸€ä¸ªæ™®é€šç›’å­ï¼Œæ¯”å¦‚è®©é“¾æ¥ä¸è·³è½¬ï¼Œè®©inputä¸æäº¤ç­‰ e.stopPropagation(); //é˜»æ­¢äº‹ä»¶å†’æ³¡ï¼Œä½¿å¾—è§¦å‘å­äº‹ä»¶åï¼Œä¸ä¼šç›¸åº”è§¦å‘çˆ¶äº‹ä»¶ï¼Œä¸ä¼šå‘å¤–ä¼ æ’­ }) ie6\\7\\8 div.onclick = function() { console.log(e.srcElement); //è¿”å›çš„æ˜¯è§¦å‘äº‹ä»¶å¾—å…ƒç´  e.returnValue; // é˜»æ­¢é»˜è®¤äº‹ä»¶ /*æˆ‘ä»¬å¯ä»¥åˆ©ç”¨return false ä¹Ÿèƒ½é˜»æ­¢é»˜è®¤è¡Œä¸º æ²¡æœ‰å…¼å®¹æ€§é—®é¢˜ ç‰¹ç‚¹ï¼š return åé¢çš„ä»£ç ä¸æ‰§è¡Œäº†ï¼Œ è€Œä¸”åªé™äºä¼ ç»Ÿçš„æ³¨å†Œæ–¹å¼*/ return false; window.e.cancelBubble = true; //é˜»æ­¢å†’æ³¡ } 5.äº‹ä»¶å§”æ‰˜äº‹ä»¶å§”æ‰˜ä¹Ÿç§°ä¸ºäº‹ä»¶ä»£ç†ï¼Œåœ¨JQueryç§°ä¸ºäº‹ä»¶å§”æ´¾ï¼Œå®ƒæé«˜äº†ç¨‹åºæ€§èƒ½ è‹¥å¤šä¸ªå­èŠ‚ç‚¹åŒæ—¶æœ‰äº‹ä»¶ï¼Œä¸éœ€è¦å°†æ¯ä¸ªå­ç»“ç‚¹å•ç‹¬è®¾ç½®äº‹ä»¶ç›‘å¬å™¨ï¼Œè€Œæ˜¯å°†äº‹ä»¶ç›‘å¬å™¨è®¾ç½®åœ¨çˆ¶èŠ‚ç‚¹ä¸Šï¼Œç„¶ååˆ©ç”¨å†’æ³¡åŸç†å½±å“æ¯ä¸ªå­èŠ‚ç‚¹ï¼Œä½¿å¾—æ¯ä¸ªå­èŠ‚ç‚¹åé¦ˆåˆ°çˆ¶èŠ‚ç‚¹ï¼Œè§¦å‘çˆ¶èŠ‚ç‚¹çš„äº‹ä»¶ 6.å¸¸ç”¨çš„é¼ æ ‡äº‹ä»¶é¼ æ ‡å³é”®èœå•ï¼š contextmenu é¼ æ ‡é€‰ä¸­ï¼šselectstart dblclick é¼ æ ‡åŒå‡»äº‹ä»¶ mousedown é¼ æ ‡æŒ‰ä¸‹ mousemove é¼ æ ‡ç§»åŠ¨ ï¼Œmousemoveæ˜¯é¼ æ ‡æŒ‡é’ˆåœ¨å…ƒç´ å†…éƒ¨ç§»åŠ¨å¼é‡å¤è§¦å‘çš„äº‹ä»¶ï¼Œå¯ç”¨äºé¼ æ ‡æŒ‡é’ˆå®šä½å®æ—¶å˜åŒ–çš„æ¡ˆä¾‹ mouseup é¼ æ ‡æ¾å¼€ mouseover é¼ æ ‡ç»è¿‡ï¼Œ ç±»ä¼¼äºâ€œ :hover â€ å®ƒä¸ä»…ç»è¿‡è‡ªèº«ç›’å­ä¼šè§¦å‘ï¼Œç»è¿‡å­ç›’å­è¿˜ä¼šå†è§¦å‘ä¸€æ¬¡ mouseout é¼ æ ‡ç¦»å¼€å…ƒç´ ï¼Œå’Œmouseoverç›¸äº’æ­é… mouseenter é¼ æ ‡ç§»åŠ¨åˆ°å…ƒç´ ä¸Šï¼Œåªä¼šç»è¿‡è‡ªèº«ç›’å­æ‰è§¦å‘ä¸€æ¬¡ï¼Œä¹‹æ‰€ä»¥ä¼šè¿™æ ·ï¼Œæ˜¯å› ä¸ºmouseenterä¸ä¼šå†’æ³¡ mouseleave é¼ æ ‡ç¦»å¼€å…ƒç´ ï¼Œå’Œmouseenterç›¸äº’æ­é…ï¼ŒåŒæ ·ä¸ä¼šå†’æ³¡ wheelé¼ æ ‡æ»šè½®äº‹ä»¶ scrolläº‹ä»¶åœ¨æ»šåŠ¨æ¡æ»šåŠ¨çš„æ—¶å€™è¢«è§¦å‘ wheelåœ¨é¼ æ ‡æ»šè½®æ»šåŠ¨çš„æ—¶å€™è¢«è§¦å‘ ç”±äºé¼ æ ‡æ»šè½®æ»šåŠ¨æ—¶å¤§éƒ¨åˆ†ä¼šè§¦å‘scrolläº‹ä»¶ æ‰€ä»¥æ—¶wheeläº‹ä»¶å…ˆè§¦å‘ focus è·å¾—ç„¦ç‚¹ blurå¤±å»ç„¦ç‚¹ //ç¦ç”¨é¼ æ ‡å³é”® document.addEventListener('contextmenu', function(e) { e.preventDefault(); }) //ç¦æ­¢é€‰ä¸­æ–‡å­— document.addEventListener('selectstart', function(e) { e.preventDefault(); }) ï¼ˆeä»£è¡¨äº‹ä»¶å¯¹è±¡ï¼Œå¯è§†åŒºåŸŸä¸ºé™¤å»æ”¶è—å¤¹ã€ç½‘å€ç­‰éƒ¨åˆ†ï¼‰ e.clientX è¿”å›é¼ æ ‡å¯¹äºæµè§ˆå™¨çª—å£å¯è§†åŒºåŸŸçš„Xåæ ‡ e.clientY è¿”å›é¼ æ ‡å¯¹äºæµè§ˆå™¨çª—å£å¯è§†åŒºåŸŸçš„Yåæ ‡ e.pageX è¿”å›é¼ æ ‡ç›¸å¯¹äºæ–‡æ¡£é¡µé¢çš„Xåæ ‡ï¼Œie9+æ”¯æŒ ï¼ˆæ— æ»šåŠ¨æ—¶åŒclientXï¼‰ e.pageY è¿”å›é¼ æ ‡ç›¸å¯¹äºæ–‡æ¡£é¡µé¢çš„Yåæ ‡ï¼Œie9+æ”¯æŒ ï¼ˆæ— æ»šåŠ¨æ—¶åŒclientYï¼‰ e.screenX è¿”å›é¼ æ ‡ç›¸å¯¹äºç”µè„‘å±å¹•çš„Xè½´åæ ‡ e.screenY è¿”å›é¼ æ ‡ç›¸å¯¹äºç”µè„‘å±å¹•çš„Yè½´åæ ‡ pinkè€å¸ˆå¤©ä½¿è·Ÿéšé¼ æ ‡æ¡ˆä¾‹ &lt;style> img { position: absolute; } &lt;/style> &lt;body> &lt;img src=\"images/angel.gif\" alt=\"\"> &lt;script> var pic = document.querySelector('img'); document.addEventListener('mousemove', function(e) { /*æ ¸å¿ƒåŸç†ï¼š æ¯æ¬¡é¼ æ ‡ç§»åŠ¨ï¼Œæˆ‘ä»¬éƒ½ä¼šè·å¾—æœ€æ–°çš„é¼ æ ‡åæ ‡ï¼Œ æŠŠè¿™ä¸ªxå’Œyåæ ‡åšä¸ºå›¾ç‰‡çš„topå’Œleft å€¼å°±å¯ä»¥ç§»åŠ¨å›¾ç‰‡*/ var x = e.pageX; var y = e.pageY; //åƒä¸‡ä¸è¦å¿˜è®°ç»™left å’Œtop æ·»åŠ px å•ä½ pic.style.left = x - 50 + 'px'; pic.style.top = y - 40 + 'px'; }); &lt;/script> &lt;/body> 7.å¸¸ç”¨é”®ç›˜äº‹ä»¶onkeyup æŸä¸ªæŒ‰é”®æ¾å¼€æ—¶è¢«è§¦å‘ ï¼ˆæ¾å¼€ç¬é—´ï¼‰ onkeydown æŸä¸ªæŒ‰é”®è¢«æŒ‰ä¸‹æ—¶è¢«è§¦å‘ ï¼ˆæŒ‰ä¸‹ç¬é—´ï¼‰ï¼ŒæŒ‰ä½ä¼šæŒç»­è§¦å‘ onkeypress åŒonkeydown ä½†æ˜¯å®ƒä¸è¯†åˆ«åŠŸèƒ½é”®å¦‚ctrl shiftç­‰ï¼ŒæŒ‰ä½ä¼šæŒç»­è§¦å‘ æ‰§è¡Œé¡ºåºdown&gt;press&gt;up ä½¿ç”¨addEventListenerä¸éœ€è¦åŠ on keyonå’Œkeydownä¸èƒ½åŒºåˆ†å¤§å°å†™ keyonå’Œkeydownä¸èƒ½åŒºåˆ†å¤§å°å†™ ï¼ˆaå’ŒAå¾—åˆ°çš„ASCIIç å€¼å¾—åˆ°çš„éƒ½æ˜¯65ï¼‰ é”®ç›˜äº‹ä»¶ ï¼ˆeä»£è¡¨äº‹ä»¶å¯¹è±¡ï¼‰ e.keyCode è¿”å›è¯¥é”®ASCIIç å€¼ e.keyè¿”å›æŒ‰ä¸‹çš„é”®ä½å€¼ï¼ˆå­—ç¬¦ä¸²ï¼‰ æ³¨æ„ï¼škeydown å’Œ keypress åœ¨æ–‡æœ¬æ¡†ï¼ˆinputï¼‰æ¯”è¾ƒç‰¹æ®Šï¼Œå½“å®ƒä»¬ä¸¤ä¸ªäº‹ä»¶è§¦å‘çš„æ—¶å€™ï¼Œæ–‡å­—è¿˜æ²¡è½å…¥æ–‡æœ¬æ¡†ä¸­ è€Œkeyupäº‹ä»¶è§¦å‘çš„æ—¶å€™ï¼Œæ–‡å­—å·²ç»è½å…¥æ–‡æœ¬æ¡†ï¼Œ 8.inputäº‹ä»¶onchange å½“inputå¤±å»ç„¦ç‚¹å¹¶ä¸”å®ƒçš„valueå€¼å‘ç”Ÿå˜åŒ–æ—¶è§¦å‘ï¼Œå®ƒä¹Ÿå¯ç”¨äºå•é€‰æ¡†ä¸å¤é€‰æ¡†æ”¹å˜åè§¦å‘çš„äº‹ä»¶ã€‚ æ¯”å¦‚å¤é€‰æ¡†å‘ç”Ÿæ”¹å˜ï¼ˆå•å‡»é¼ æ ‡åˆ‡æ¢â€œæ‰“å‹¾â€/â€œä¸æ‰“å‹¾â€çŠ¶æ€ï¼‰ oninput å½“inputçš„valueå€¼å‘ç”Ÿå˜åŒ–æ—¶å°±ä¼šè§¦å‘ï¼Œï¼ˆä¸onchangeçš„åŒºåˆ«æ˜¯ä¸ç”¨ç­‰åˆ°å¤±å»ç„¦ç‚¹å°±å¯ä»¥è§¦å‘äº†ï¼‰ æ­¤æ—¶é€šè¿‡ event.target.value;äº‹ä»¶å¯¹è±¡ä¸­çš„targetçš„valueå¯ä»¥è·å–inputè¾“å…¥çš„å€¼ onfocus è·å¾—ç„¦ç‚¹äº‹ä»¶ onblur å¤±å»ç„¦ç‚¹äº‹ä»¶ input.select() è®©æ–‡æœ¬æ¡†é‡Œçš„æ–‡å­—å¤„äºé€‰å®šçŠ¶æ€ remember.addEventListener('change', function () { // å‹¾é€‰ä¸Š if (this.checked) { localStorage.setItem('username', username.value); } else { localStorage.removeItem('username') } }) 9.æ‹–æ‹½äº‹ä»¶HTML çš„ drag &amp; drop ä½¿ç”¨äº† DOM event model ä»¥åŠä» mouse events ç»§æ‰¿è€Œæ¥çš„ drag events ã€‚ä¸€ä¸ªå…¸å‹çš„æ‹–æ‹½æ“ä½œæ˜¯è¿™æ ·çš„ï¼šç”¨æˆ·é€‰ä¸­ä¸€ä¸ªå¯æ‹–æ‹½çš„ï¼ˆdraggableï¼‰å…ƒç´ ï¼Œå¹¶å°†å…¶æ‹–æ‹½ï¼ˆé¼ æ ‡ä¸æ”¾å¼€ï¼‰åˆ°ä¸€ä¸ªå¯æ”¾ç½®çš„ï¼ˆdroppableï¼‰å…ƒç´ ï¼Œç„¶åé‡Šæ”¾é¼ æ ‡ã€‚ åœ¨æ“ä½œæœŸé—´ï¼Œä¼šè§¦å‘ä¸€äº›äº‹ä»¶ç±»å‹ï¼Œæœ‰ä¸€äº›äº‹ä»¶ç±»å‹å¯èƒ½ä¼šè¢«å¤šæ¬¡è§¦å‘ï¼ˆæ¯”å¦‚drag (en-US) å’Œ dragover (en-US) äº‹ä»¶ç±»å‹ï¼‰ã€‚ æ‰€æœ‰çš„ æ‹–æ‹½äº‹ä»¶ç±»å‹ æœ‰ä¸€ä¸ªå¯¹åº”çš„ æ‹–æ‹½å…¨å±€å±æ€§ã€‚æ¯ä¸ªæ‹–æ‹½äº‹ä»¶ç±»å‹å’Œæ‹–æ‹½å…¨å±€å±æ€§éƒ½æœ‰å¯¹åº”çš„æè¿°æ–‡æ¡£ã€‚ä¸‹é¢çš„è¡¨æ ¼æä¾›äº†ä¸€ä¸ªç®€çŸ­çš„äº‹ä»¶ç±»å‹æè¿°ï¼Œä»¥åŠä¸€ä¸ªç›¸å…³æ–‡æ¡£çš„é“¾æ¥ã€‚ äº‹ä»¶ On å‹äº‹ä»¶å¤„ç†ç¨‹åº è§¦å‘æ—¶åˆ» drag (en-US) ondrag å½“æ‹–æ‹½å…ƒç´ æˆ–é€‰ä¸­çš„æ–‡æœ¬æ—¶è§¦å‘ã€‚ dragend (en-US) ondragend (en-US) å½“æ‹–æ‹½æ“ä½œç»“æŸæ—¶è§¦å‘ (æ¯”å¦‚æ¾å¼€é¼ æ ‡æŒ‰é”®æˆ–æ•²â€œEscâ€é”®). (è§ç»“æŸæ‹–æ‹½ (en-US)) dragenter (en-US) ondragenter (en-US) å½“æ‹–æ‹½å…ƒç´ æˆ–é€‰ä¸­çš„æ–‡æœ¬åˆ°ä¸€ä¸ªå¯é‡Šæ”¾ç›®æ ‡æ—¶è§¦å‘ï¼ˆè§ æŒ‡å®šé‡Šæ”¾ç›®æ ‡ (en-US)ï¼‰ã€‚ dragexit ondragexit (en-US) å½“å…ƒç´ å˜å¾—ä¸å†æ˜¯æ‹–æ‹½æ“ä½œçš„é€‰ä¸­ç›®æ ‡æ—¶è§¦å‘ã€‚ dragleave (en-US) ondragleave å½“æ‹–æ‹½å…ƒç´ æˆ–é€‰ä¸­çš„æ–‡æœ¬ç¦»å¼€ä¸€ä¸ªå¯é‡Šæ”¾ç›®æ ‡æ—¶è§¦å‘ã€‚ dragover (en-US) ondragover (en-US) å½“å…ƒç´ æˆ–é€‰ä¸­çš„æ–‡æœ¬è¢«æ‹–åˆ°ä¸€ä¸ªå¯é‡Šæ”¾ç›®æ ‡ä¸Šæ—¶è§¦å‘ï¼ˆæ¯ 100 æ¯«ç§’è§¦å‘ä¸€æ¬¡ï¼‰ã€‚ dragstart (en-US) ondragstart (en-US) å½“ç”¨æˆ·å¼€å§‹æ‹–æ‹½ä¸€ä¸ªå…ƒç´ æˆ–é€‰ä¸­çš„æ–‡æœ¬æ—¶è§¦å‘ï¼ˆè§å¼€å§‹æ‹–æ‹½æ“ä½œ (en-US)ï¼‰ã€‚ drop (en-US) ondrop å½“å…ƒç´ æˆ–é€‰ä¸­çš„æ–‡æœ¬åœ¨å¯é‡Šæ”¾ç›®æ ‡ä¸Šè¢«é‡Šæ”¾æ—¶è§¦å‘ï¼ˆè§æ‰§è¡Œé‡Šæ”¾ (en-US)ï¼‰ã€‚ æ³¨æ„ï¼šå½“ä»æ“ä½œç³»ç»Ÿå‘æµè§ˆå™¨ä¸­æ‹–æ‹½æ–‡ä»¶æ—¶ï¼Œä¸ä¼šè§¦å‘ dragstart å’Œdragend äº‹ä»¶ã€‚ åœ¨æµè§ˆå™¨æ‰æœ‰è¿™ä¸ªäº‹ä»¶ï¼Œç§»åŠ¨ç«¯å¥½åƒæ²¡æœ‰ï¼ˆè‡³å°‘æˆ‘è¯•äº†å¥½åƒä¸å¤ªè¡Œï¼‰ &lt;div key={component.type} draggable onDragStart={() => handleDragStart(component)} className=\"editor-left-item\"> &lt;span>{component.label}&lt;/span> &lt;div>{component.preview()}&lt;/div> &lt;/div> 10.åŠ¨ç”»ç»“æŸäº‹ä»¶onAnimationEnd: è¯¥äº‹ä»¶åœ¨CSS åŠ¨ç”»å®Œæˆanimationendæ—¶è§¦å‘ã€‚å¦‚æœåŠ¨ç”»åœ¨å®Œæˆä¹‹å‰ä¸­æ­¢ï¼Œä¾‹å¦‚å…ƒç´ ä» DOM ä¸­ç§»é™¤æˆ–åŠ¨ç”»ä»å…ƒç´ ä¸­ç§»é™¤ï¼Œåˆ™ä¸ä¼šè§¦å‘è¯¥äº‹ä»¶ã€‚animationend å¥æ³• åœ¨è¯¸å¦‚ ä¹‹ç±»çš„æ–¹æ³•ä¸­ä½¿ç”¨äº‹ä»¶åç§°addEventListener()ï¼Œæˆ–è®¾ç½®äº‹ä»¶å¤„ç†ç¨‹åºå±æ€§ã€‚ addEventListener(&#39;animationend&#39;, (event) =&gt; {}); onanimationend = (event) =&gt; { };","categories":[{"name":"å‰ç«¯","slug":"å‰ç«¯","permalink":"https://taylor12138.github.io/categories/%E5%89%8D%E7%AB%AF/"}],"tags":[],"author":"Hello"},{"title":"åŠ¨ç”»åº“è¾…åŠ©å·¥å…·","slug":"åŠ¨ç”»åº“è¾…åŠ©å·¥å…·","date":"2022-06-11T11:39:22.951Z","updated":"2023-04-18T12:25:32.949Z","comments":true,"path":"2022/06/11/dong-hua-ku-fu-zhu-gong-ju/","link":"","permalink":"https://taylor12138.github.io/2022/06/11/dong-hua-ku-fu-zhu-gong-ju/","excerpt":"","text":"dat.GUIç”±äºåœ¨2dã€3dåŠ¨ç”»ä¸­ï¼Œæˆ‘ä»¬å¤±å»äº†domç»“æ„ï¼ˆcanvasï¼‰ï¼Œæ‰€ä»¥æˆ‘éœ€è¦ç‰¹æ®Šçš„debugå·¥å…·ã€‚ æ¨èdat.GUIï¼Œå®ƒåŒæ ·å¯ä»¥é€‚ç”¨äºpixijs ï¼Œå®ƒå¯ä»¥æ§åˆ¶æ¯ä¸€ä¸ªåŒºå—æ¥debugï¼Œé€šè¿‡ä¸€ä¸ªuiç•Œé¢ï¼Œæ…¢æ…¢è°ƒèŠ‚æˆæˆ‘ä»¬æƒ³è¦çš„å‚æ•° githubåœ°å€ï¼šhttps://github.com/dataarts/dat.gui apiæ–‡æ¡£ï¼šhttps://github.com/dataarts/dat.gui/blob/master/API.md npm i dat.gui import * as dat from 'dat.gui' const gui = new dat.GUI() ç„¶åæˆ‘ä»¬åœ¨å³ä¸Šæ–¹å°±å¯ä»¥çœ‹åˆ°è¿™ä¸ª ç„¶åç»™æˆ‘ä»¬çš„guiæ·»åŠ æˆ‘ä»¬è¦è°ƒèŠ‚çš„ç‰©ä½“å’Œå±æ€§ gui.add(object, property, [min], [max], [step]) â‡’ Controller ç»™guiå¢åŠ ä¸€ä¸ªæ§åˆ¶å™¨ï¼Œç”¨æ¥è°ƒèŠ‚å¯¹è±¡çš„å±æ€§ï¼Œå¦‚æœå¡«å…¥æœ€åä¸‰ä¸ªå‚æ•°ï¼ŒUIå°±ä¼šå˜æˆä¸€ä¸ªè¿›åº¦æ¡ï¼Œæ–¹ä¾¿è°ƒèŠ‚ Kind: instance method of GUIReturns: Controller - The controller that was added to the GUI. Param Type Description object Object è°ƒèŠ‚çš„å¯¹è±¡ property String æƒ³è¦æ”¹å˜çš„å±æ€§åç§° [min]ï¼ˆå¯é€‰ï¼‰ Number æœ€å°å€¼ [max]ï¼ˆå¯é€‰ï¼‰ Number æœ€å¤§å€¼ [step]ï¼ˆå¯é€‰ï¼‰ Number é—´éš” APIadd gui.add(object, property, [min], [max], [step]) â‡’ Controller ç»™guiå¢åŠ ä¸€ä¸ªæ§åˆ¶å™¨ï¼Œç”¨æ¥è°ƒèŠ‚å¯¹è±¡çš„å±æ€§ï¼Œå¦‚æœå¡«å…¥æœ€åä¸‰ä¸ªå‚æ•°ï¼ŒUIå°±ä¼šå˜æˆä¸€ä¸ªè¿›åº¦æ¡ï¼Œæ–¹ä¾¿è°ƒèŠ‚ Kind: instance method of GUIReturns: Controller - The controller that was added to the GUI. Param Type Description object Object è°ƒèŠ‚çš„å¯¹è±¡ property String æƒ³è¦æ”¹å˜çš„å±æ€§åç§° [min]ï¼ˆå¯é€‰ï¼‰ Number æœ€å°å€¼ [max]ï¼ˆå¯é€‰ï¼‰ Number æœ€å¤§å€¼ [step]ï¼ˆå¯é€‰ï¼‰ Number é—´éš” ä»¥ä¸‹ä¾‹å­ï¼Œå°±æ˜¯æˆ‘å¾€guiæ·»åŠ ä¸€ä¸ªthreejsçš„meshï¼Œå¯¹å…¶å±æ€§è¿›è¡Œä¿®æ”¹ //åˆ›å»ºæ­£æ–¹ä½“ const geometry = new THREE.BoxGeometry(1, 1, 1); const material = new THREE.MeshBasicMaterial({ color: \"red\" }); const cube = new THREE.Mesh(geometry, material); cube.position.set(1, 0, 0); scene.add(cube); obj = { action: () => { console.log('action') } } //guiä¼šè‡ªåŠ¨æ ¹æ®ä½ æ·»åŠ çš„å±æ€§ç±»å‹ï¼Œç»™ä½ è½¬æ¢æˆç›¸å¯¹çš„è°ƒèŠ‚æ–¹å¼ï¼Œæ¯”å¦‚numberä¸ºè¿›åº¦æ¡ã€booleanä¸ºcheckbox gui.add(cube.position, \"y\", -3, 3, 0.1); gui.add(cube, 'visible'); gui.add(cube.position, \"x\", -3, 3, 0.1); gui.add(cube.position, \"z\", -3, 3, 0.1); ä½ ç”šè‡³å¯ä»¥æ·»åŠ ä¸€ä¸ªæ–¹æ³•ï¼Œæ­¤æ—¶guiå°±ä¼šç”Ÿæˆä¸€ä¸ªç‚¹å‡»é€‰é¡¹ï¼Œç‚¹å‡»åå°±ä¼šè°ƒç”¨objçš„actionæ–¹æ³• gui.add(obj, \"action\"); //å½“ç„¶ä¹Ÿå¯ä»¥ç”¨é“¾å¼è°ƒç”¨çš„å½¢å¼ gui .add(cube.position, \"y\") .min(-3) .max(3) .step(0.01) .name('cubeçš„yè½´ä½ç½®') addColorä½†æ˜¯å°½ç®¡å¦‚æ­¤æ™ºèƒ½ï¼Œä½†GUIæ— æ³•è¯†åˆ«ä½ çš„colorå±æ€§æ˜¯ä¸€ä¸ªcolorï¼Œæ‰€ä»¥æœ‰ä¸€ä¸ªaddColor API gui.addColor(object, property) â‡’ Controller Kind: instance method of GUIReturns: Controller - The controller that was added to the GUI. Param object property æ¡ˆä¾‹ï¼š var palette = { color1: '#FF0000', // CSS string color2: [ 0, 128, 255 ], // RGB array color3: [ 0, 128, 255, 0.3 ], // RGB with alpha color4: { h: 350, s: 0.9, v: 0.3 } // Hue, saturation, value }; gui.addColor(palette, 'color1'); gui.addColor(palette, 'color2'); gui.addColor(palette, 'color3'); gui.addColor(palette, 'color4'); //ç¯å¢ƒå…‰ const lightParams = { color: 0xffffff }; const intensity = 1; const light = new THREE.AmbientLight(lightParams.color, intensity); scene.add(light); console.log(light.color, \"color\"); //ç”±äºthreejsé‡Œçš„colorä¸èƒ½ç›´æ¥é€šè¿‡å±æ€§èµ‹å€¼æ›´æ”¹ï¼Œå¿…é¡»é€šè¿‡setæ–¹æ³•ï¼Œæ‰€ä»¥è¿™é‡Œç”¨onchangeæ¥ç›‘å¬æ›´æ”¹lightçš„color gui.addColor(lightParams, \"color\").onChange(() => { light.color.set(lightParams.color); }); å½“ç„¶æˆ‘ä»¬ä¹Ÿå¯ä»¥å†™ä¸€ä¸ªcolor guiç±»æ¥å¸®æˆ‘ä»¬è®¾ç½®é¢œè‰² class ColorGUIHelper { constructor(object, prop) { this.object = object; this.prop = prop; } get value() { return `#${this.object[this.prop].getHexString()}`; } set value(hexString) { this.object[this.prop].set(hexString); } } const intensity = 1; const color = 0xFFFFFF; const light = new THREE.AmbientLight(color, intensity); const gui = new GUI(); gui.addColor(new ColorGUIHelper(light, 'color'), 'value').name('color'); gui.add(light, 'intensity', 0, 2, 0.01); addFolderæ·»åŠ guiä¸€ä¸ªæ–‡ä»¶å¤¹ï¼Œæ–¹ä¾¿åˆ†ç±»å’Œç®¡ç†ä¸åŒçš„å±æ€§ï¼Œæ¯”å¦‚ä½ æƒ³è¦æ§åˆ¶çƒä½“Açš„xã€yã€zè½´ï¼Œä¹Ÿæƒ³è¦æ§åˆ¶çƒä½“Bçš„xã€yã€zè½´ï¼Œæ­¤æ—¶æˆ‘ä»¬å¯ä»¥æ–°å»ºä¸€ä¸ªFolderï¼Œæ­¤æ—¶æˆ‘ä»¬åœ¨folderä¸‹æ·»åŠ å¯¹åº”çš„å±æ€§å³å¯ function makeXYZGUI(gui, vector3, name, onChangeFn) { const folder = gui.addFolder(name); folder.add(vector3, 'x', -10, 10).onChange(onChangeFn); folder.add(vector3, 'y', 0, 10).onChange(onChangeFn); folder.add(vector3, 'z', -10, 10).onChange(onChangeFn); folder.open(); }","categories":[{"name":"å‰ç«¯","slug":"å‰ç«¯","permalink":"https://taylor12138.github.io/categories/%E5%89%8D%E7%AB%AF/"}],"tags":[],"author":"Hello"},{"title":"ç¼–è¯‘ç›¸å…³","slug":"ç¼–è¯‘ç›¸å…³","date":"2022-06-11T11:39:22.951Z","updated":"2022-06-11T11:39:22.951Z","comments":true,"path":"2022/06/11/bian-yi-xiang-guan/","link":"","permalink":"https://taylor12138.github.io/2022/06/11/bian-yi-xiang-guan/","excerpt":"","text":"Monaco EditorMonaco Editor æ˜¯ä¸€æ¬¾å¼€æºçš„åœ¨çº¿ä»£ç ç¼–è¾‘å™¨ã€‚å®ƒæ˜¯ VSCode çš„æµè§ˆå™¨ç‰ˆæœ¬ ä½¿ç”¨npm install monaco-editor æ–°å»ºä¸€ä¸ªbaseæ–‡ä»¶å¤¹ï¼Œé‡Œé¢è£…ç€ä¸‰ä»¶å¥— html + js + cssä¸‰ä»¶å¥—çš„ä»£ç  &lt;!DOCTYPE html> &lt;html> &lt;head> &lt;title>Monaco Editor Demo&lt;/title> &lt;link rel=\"stylesheet\" href=\"./style.css\"> &lt;script src=\"../node_modules/monaco-editor/min/vs/loader.js\">&lt;/script> &lt;script src=\"./app.js\">&lt;/script> &lt;/head> &lt;body> &lt;div id=\"header\">åŸºç¡€ç‰ˆ Monaco Editor&lt;/div> &lt;div id=\"root\">&lt;/div> &lt;/body> &lt;/html> body { font-family: \"Source Han Sans\", \"San Francisco\", \"PingFang SC\", \"Hiragino Sans GB\", \"Droid Sans Fallback\", \"Microsoft YaHei\", sans-serif; transition: background-color .2s; } #header { position: fixed; top: 0; left: 0; height: 50px; right: 0; background-color: #333; color: #fff; font-size: 20px; line-height: 50px; display: inline-block; vertical-align: middle; padding-left: 15px; overflow: hidden; z-index: 0; } .container { position: fixed; top: 50px; left: 0; height: calc(100vh - 50px); right: 0; margin: 0 auto; display: block; transition: 0.2s; overflow: hidden; z-index: 0; } require.config({ paths: { vs: \"../node_modules/monaco-editor/min/vs\" } }); require([\"vs/editor/editor.main\"], function () { // åˆå§‹åŒ–å˜é‡ var fileCounter = 0; var editorArray = []; var defaultCode = [ \"function helloWorld() {\", ' console.log(\"Hello world!\");', \"}\", ].join(\"\\n\"); // æ–°å»ºä¸€ä¸ªç¼–è¾‘å™¨ function newEditor(container_id, code, language) { var model = monaco.editor.createModel(code, language); var editor = monaco.editor.create(document.getElementById(container_id), { model: model, }); editorArray.push(editor); return editor; } // æ–°å»ºä¸€ä¸ª div function addNewEditor(code, language) { var new_container = document.createElement(\"DIV\"); new_container.id = \"container-\" + fileCounter.toString(10); new_container.className = \"container\"; document.getElementById(\"root\").appendChild(new_container); newEditor(new_container.id, code, language); fileCounter += 1; } addNewEditor(defaultCode, \"javascript\"); }); å‚è€ƒï¼šhttps://zhuanlan.zhihu.com/p/88828576 æ¨èé˜…è¯»ï¼šhttps://zhuanlan.zhihu.com/p/496562929 vscodeä¸»é¢˜åœ¨monacoä¸­çš„åº”ç”¨ï¼šhttps://segmentfault.com/a/1190000040746839 monaco-editor/reactå®ƒæ˜¯ä¸€ä¸ªMonacoç¼–è¾‘å™¨åŒ…è£…å™¨ï¼Œä½¿å¾—æˆ‘ä»¬å¯ä»¥åœ¨Reactä¸­ç›´æ¥é…ç½®monaco-editorã€‚Reactæ— éœ€ä½¿ç”¨webpackï¼ˆæˆ–ä»»ä½•å…¶ä»–æ¨¡å—æ†ç»‘å™¨ï¼‰é…ç½®æ–‡ä»¶/æ’ä»¶ã€‚å®ƒå¯ä»¥ä¸ç”±create-react-appã€create-snowpack-appã€viteæˆ–Next.jsä»»ä½•å…¶ä»–åº”ç”¨ç¨‹åºç”Ÿæˆå™¨ç”Ÿæˆçš„åº”ç”¨ç¨‹åºä¸€èµ·ä½¿ç”¨ -æ‚¨æ— éœ€å¼¹å‡ºæˆ–é‡æ–°è¿æ¥å®ƒä»¬ã€‚ ä½¿ç”¨npm install @monaco-editor/react åœ¨reactè„šæ‰‹æ¶ä¸­é…ç½®Editorç»„ä»¶å³å¯ import React from \"react\"; import ReactDOM from \"react-dom\"; import Editor from \"@monaco-editor/react\"; function App() { return ( &lt;Editor height=\"90vh\" defaultLanguage=\"javascript\" defaultValue=\"// some comment\" /> ); } const rootElement = document.getElementById(\"root\"); ReactDOM.render(&lt;App />, rootElement); è·å–å†…å®¹ æœ‰ä¸¤ç§æ–¹æ³•ï¼Œååˆ«æ˜¯é€šè¿‡useRefè·å–Editorå®¹å™¨ï¼Œç„¶åå®¹å™¨ref.current.getValue()å°±æ˜¯å½“å‰çš„å€¼ å¦ä¸€ç§æ˜¯ç›´æ¥ç»‘å®šEditorçš„ onChangeæ–¹æ³• function App() { const editorRef = useRef(null); function handleEditorDidMount(editor, monaco) { editorRef.current = editor; } function handleEditorChange(value, event) { console.log(\"here is the current model value:\", value); } function showValue() { alert(editorRef.current.getValue()); } return ( &lt;> &lt;button onClick={showValue}>Show value&lt;/button> &lt;Editor height=\"90vh\" defaultLanguage=\"javascript\" defaultValue=\"// some comment\" onMount={handleEditorDidMount} onChange={handleEditorChange} /> &lt;/> ); } æ›´å¤šï¼šhttps://github.com/suren-atoyan/monaco-react ç¼–è¯‘å™¨demo200è¡Œçš„jså°ç¼–è¯‘å™¨ï¼ˆLisp -&gt; JSï¼‰ https://juejin.cn/post/6844904105937207304 å®ƒçš„githubåœ°å€ï¼šhttps://github.com/QianYin-Zhou/The-super-tiny-complier","categories":[{"name":"å‰ç«¯","slug":"å‰ç«¯","permalink":"https://taylor12138.github.io/categories/%E5%89%8D%E7%AB%AF/"}],"tags":[],"author":"Hello"},{"title":"JavaScriptåŸºç¡€","slug":"JavaScriptåŸºç¡€","date":"2022-06-06T16:16:11.669Z","updated":"2022-10-18T02:02:10.868Z","comments":true,"path":"2022/06/07/javascript-ji-chu/","link":"","permalink":"https://taylor12138.github.io/2022/06/07/javascript-ji-chu/","excerpt":"","text":"1.JSçš„ä»‹ç»JSæ˜¯è„šæœ¬è¯­è¨€ï¼Œä¸éœ€è¦ç¼–è¯‘ï¼Œç›´æ¥ç”±jsè§£é‡Šå™¨é€è¡Œè¿›è¡Œè§£é‡Šå¹¶æ‰§è¡Œï¼ˆç¼–è¯‘ä¸€è¡Œï¼Œæ‰§è¡Œä¸€è¡Œï¼‰ï¼Œï¼ˆè§£é‡Šå‹çš„ç¼–ç¨‹è¯­è¨€ï¼‰ç°åœ¨ä¹Ÿå¯ä»¥åŸºäºnode.jsæŠ€æœ¯ï¼ˆåå°ï¼‰è¿›è¡ŒæœåŠ¡å™¨ç¼–ç¨‹ ä¸€èˆ¬ç¼–è¯‘æµç¨‹ï¼šè¯æ³•åˆ†æï¼ˆæºç¨‹åº-&gt;å•è¯ç¬¦å·ï¼‰ï¼Œè¯­æ³•åˆ†æï¼ˆå•è¯ç¬¦å·-&gt;è¯­æ³•å•ä½ï¼‰ï¼Œä¸­é—´ä»£ç ç”Ÿæˆï¼ˆè¯­æ³•å•ä½-&gt;ä¸­é—´ä»£ç ï¼‰ï¼Œä»£ç ä¼˜åŒ–å’Œç›®æ ‡ä»£ç çš„ç”Ÿæˆï¼ˆä¸­é—´ä»£ç -&gt;ç›®æ ‡ä»£ç ï¼‰ å®ç°ä¸šåŠ¡é€»è¾‘å’Œé¡µé¢æ§åˆ¶åŠŸèƒ½ï¼Œæµè§ˆå™¨çš„JSå¼•æ“ï¼Œä¹Ÿå°±æ˜¯JSè§£é‡Šå™¨ï¼Œç”¨æ¥è¯»å–JSä»£ç  JSæ‰§è¡Œæ ·å¼è¡¨ï¼ˆStyle sheetsï¼‰ æ ·å¼è¡¨é‡‡ç”¨å¦ä¸€ç§ä¸åŒçš„æ¨¡å¼ã€‚ç†è®ºä¸Šï¼Œæ—¢ç„¶æ ·å¼è¡¨ä¸æ”¹å˜Domæ ‘ï¼Œä¹Ÿå°±æ²¡æœ‰å¿…è¦åœä¸‹æ–‡æ¡£çš„è§£æç­‰å¾…å®ƒä»¬ï¼Œç„¶è€Œï¼Œå­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼Œè„šæœ¬å¯èƒ½åœ¨æ–‡æ¡£çš„è§£æè¿‡ç¨‹ä¸­è¯·æ±‚æ ·å¼ä¿¡æ¯ï¼Œå¦‚æœæ ·å¼è¿˜æ²¡æœ‰åŠ è½½å’Œè§£æï¼Œè„šæœ¬å°†å¾—åˆ°é”™è¯¯çš„å€¼ï¼Œæ˜¾ç„¶è¿™å°†ä¼šå¯¼è‡´å¾ˆå¤šé—®é¢˜ï¼Œè¿™çœ‹èµ·æ¥æ˜¯ä¸ªè¾¹ç¼˜æƒ…å†µï¼Œä½†ç¡®å®å¾ˆå¸¸è§ã€‚Firefoxåœ¨å­˜åœ¨æ ·å¼è¡¨è¿˜åœ¨åŠ è½½å’Œè§£ææ—¶é˜»å¡æ‰€æœ‰çš„è„šæœ¬ï¼Œè€ŒChromeåªåœ¨å½“è„šæœ¬è¯•å›¾è®¿é—®æŸäº›å¯èƒ½è¢«æœªåŠ è½½çš„æ ·å¼è¡¨æ‰€å½±å“çš„ç‰¹å®šçš„æ ·å¼å±æ€§æ—¶æ‰é˜»å¡è¿™äº›è„šæœ¬ã€‚ JSæœ¬èº«æ˜¯æ²¡æœ‰é¢„ç¼–è¯‘çš„ ç¼–è¯‘å™¨ç¼–è¯‘ï¼ˆimportantï¼‰ï¼š å°†æ‰€æœ‰å£°æ˜è¯­å¥ï¼ŒåŒ…æ‹¬å˜é‡å£°æ˜ï¼ˆä»¥varå¼€å¤´ï¼‰å’Œå‡½æ•°å£°æ˜ï¼ˆä»¥functionå¼€å¤´ï¼‰é‡Œé¢çš„æ ‡è¯†ç¬¦ï¼ˆå³å˜é‡åaå’Œå‡½æ•°åfooï¼‰æ·»åŠ åˆ°å½“å‰ä½œç”¨åŸŸä¸­ï¼ˆæ·»åŠ è§„åˆ™æ˜¯ï¼šå¯¹varå£°æ˜çš„å˜é‡æ¥è¯´ï¼Œå¦‚aå·²å­˜åœ¨åˆ™å¿½ç•¥è¯¥å£°æ˜ï¼Œç»§ç»­ç¼–è¯‘åé¢è¯­å¥;å¦åˆ™å°±è¦æ±‚åœ¨å½“å‰ä½œç”¨åŸŸå£°æ˜ä¸€ä¸ªæ–°çš„å˜é‡å‘½åä¸ºaï¼Œæ­¤æ—¶açš„å€¼æ˜¯undefinedï¼›å¯¹äºfunctionå¼€å¤´å£°æ˜çš„å‡½æ•°æ¥è¯´ï¼Œå‡½æ•°åfooçš„å£°æ˜è¿‡ç¨‹ä¸å˜é‡å£°æ˜ä¸€æ ·ï¼Œä¸è¿‡å¦‚æœé‡åˆ°æœ‰functionå£°æ˜ 2ä¸ªä»¥ä¸ŠåŒåå‡½æ•°foo,åˆ™åé¢çš„å‡½æ•°ä½“ä¼šè¦†ç›–å‰é¢çš„ ï¼‰ ä¸€åˆ‡å£°æ˜çš„å…¨å±€å˜é‡å’Œæœªç»å£°æ˜çš„å˜é‡ï¼Œå…¨å½’windowæ‰€æœ‰ã€‚ é¢„è§£æ jså¼•æ“è¿è¡Œjsï¼Œåˆ†ä¸ºä¸¤æ­¥ï¼š1.é¢„è§£æ 2.ä»£ç æ‰§è¡Œ é¢„è§£æï¼šjsä¼šæŠŠé‡Œé¢æ‰€æœ‰varè¿˜æœ‰functionæå‡åˆ°å½“å‰ä½œç”¨åŸŸçš„æœ€å‰é¢ï¼ˆåˆ†åˆ«ä¸ºå˜é‡æå‡å’Œå‡½æ•°æå‡ï¼‰ å˜é‡æå‡ï¼šæŠŠæ‰€æœ‰å˜é‡å£°æ˜æå‡è‡³å½“å‰ä½œç”¨åŸŸäºæœ€å‰ï¼Œä½†æ˜¯ä¸æå‡èµ‹å€¼æ“ä½œ å‡½æ•°æå‡ï¼šæŠŠæ‰€æœ‰å‡½æ•°æå‡è‡³å½“å‰ä½œç”¨åŸŸæœ€å‰ ç¼–è¯‘å™¨æŸ¥è¯¢LHSä»£è¡¨å·¦ä¾§æŸ¥è¯¢ï¼ˆæ‰¾åˆ°å˜é‡å®¹å™¨æœ¬èº«ï¼‰ï¼Œè¯¢é—®ä½œç”¨åŸŸæœ‰æ²¡æœ‰è¯¥å®¹å™¨ RHSä»£è¡¨å³ä¾§æŸ¥è¯¢ï¼ˆä½†å®ƒå¹¶éçœŸæ­£æ„ä¹‰ä¸Šçš„èµ‹å€¼æ“ä½œå³ä¾§ï¼Œè€Œæ˜¯â€œéå·¦ä¾§â€ï¼‰ LHSã€RHSæ˜¯ â€œèµ‹å€¼æ“ä½œçš„å·¦ä¾§å’Œå³ä¾§â€ï¼Œä½†æ˜¯ä¸ä»£è¡¨æ˜¯ â€œ=èµ‹å€¼æ“ä½œç¬¦çš„å·¦ä¾§å’Œå³ä¾§â€ console.log(a) // ä¸€ä¸ªRHSå¼•ç”¨ a = 2; // ä¸€ä¸ªLHSå¼•ç”¨ å¦‚æœRHSæŸ¥è¯¢åœ¨æ‰€æœ‰åµŒå¥—çš„ä½œç”¨åŸŸä¸­æ‰¾åˆ°ä¸åˆ°è¯¥å˜é‡ï¼Œåˆ™ä¼šæŠ›å‡ºä¸€ä¸ªReferenceErrorå¼‚å¸¸ å£°æ˜ + èµ‹å€¼æ“ä½œæ˜¯LHSæŸ¥æ‰¾ï¼ŒLHSæ‰¾ä¸åˆ°å¼•æ“ä¼šå¸®ä½ åœ¨é¡¶å±‚ä½œç”¨åŸŸå£°æ˜ä¸€ä¸ªå…·æœ‰è¯¥åç§°çš„å˜é‡ï¼ˆä¸¥æ ¼æ¨¡å¼é™¤å¤–ï¼Œä¸¥æ ¼æ¨¡å¼åˆ™æŠ›å‡ºä¸€ä¸ªReferenceErrorï¼‰ æ¬ºéª—è¯æ³•ä½œç”¨åŸŸå¦‚æœè¯æ³•ä½œç”¨åŸŸå®Œå…¨ç”±å†™ä»£ç æœŸé—´å‡½æ•°æ‰€å£°æ˜çš„ä½ç½®æ¥å®šä¹‰ï¼Œé‚£å¦‚ä½•æ¬ºéª—è¯æ³•ä½œç”¨åŸŸå‘¢ï¼Ÿ JavaScriptæœ‰ä¸¤ç§æœºåˆ¶ evalï¼šæ¥å—ä¸€ä¸ªå­—ç¬¦ä¸²ä½œä¸ºå‚æ•°ï¼Œå°†å…¶ä¸­çš„å†…å®¹æ˜¯ä¸ºå¥½åƒåœ¨ä¹¦å†™æ—¶å°±å­˜åœ¨äºç¨‹åºä¸­è¿™ä¸ªä½ç½®çš„ä»£ç ï¼ˆã€Šçº¢å®ä¹¦çš„å•ƒè¯»note(ä¸Š)ã€‹æœ‰è§£é‡Ševalæ–¹æ³•ï¼‰ withï¼šwithé€šå¸¸è¢«å½“ä½œé‡å¤å¼•ç”¨åŒä¸€ä¸ªå¯¹è±¡ä¸­çš„å¤šä¸ªå±æ€§çš„å¿«æ·æ–¹å¼ï¼Œå¯ä»¥ä¸éœ€è¦é‡å¤å¼•ç”¨å¯¹è±¡æœ¬èº«ï¼›å°½ç®¡withå—å¯ä»¥å°†ä¸€ä¸ªå¯¹è±¡å¤„ç†ä¸ºè¯æ³•ä½œç”¨åŸŸï¼Œä½†æ˜¯è¿™ä¸ªå—å†…éƒ¨æ­£å¸¸çš„varå£°æ˜å¹¶ä¸ä¼šè¢«é™åˆ¶åœ¨è¿™ä¸ªå—çš„ä½œç”¨åŸŸä¸­ï¼Œè€Œæ˜¯è¢«æ·»åŠ åˆ°withæ‰€å¤„çš„å‡½æ•°ä½œç”¨åŸŸä¸­ function foo(obj) { with(obj) { a = 2; } } var o1 = { a: 1 }; var o2 = {}; foo(o1); console.log(o1.a); //2 foo(o2); console.log(o2.a) //undefined console.log(a); // 2,aè¢«æ³„éœ²åˆ°å…¨å±€ä½œç”¨åŸŸäº† å¯ä»¥ç†è§£ä¸ºæŠŠo1ä¼ é€’ç»™withï¼Œwithæ‰€å£°æ˜çš„ä½œç”¨åŸŸæ˜¯o1ï¼›è€Œæˆ‘ä»¬å°†o2è®¾ä¸ºä½œç”¨åŸŸæ—¶ï¼Œå…¶ä¸­å¹¶æ²¡æœ‰aæ ‡è¯†ç¬¦ï¼Œæ­¤æ—¶ï¼ˆéä¸¥æ ¼æ¨¡å¼ä¸‹ï¼‰è¿›è¡Œäº†LHSæŸ¥è¯¢ evalå’Œnew funcitonæ€§èƒ½å¯¹æ¯” ï¼šhttps://weblogs.asp.net/yuanjian/json-performance-comparison-of-eval-new-function-and-json JSçš„ç»„æˆJavaScriptè¯­æ³•ï¼šECMAScript é¡µé¢æ–‡æ¡£å¯¹è±¡æ¨¡å‹ï¼šDOM æµè§ˆå™¨å¯¹è±¡æ¨¡å‹ï¼šBOM ECMAScript å®ƒå¾€å¾€è¢«ç§°ä¸ºJavaScriptæˆ–JScriptï¼Œä½†å®é™…ä¸Šåä¸¤è€…æ˜¯ECMAScriptè¯­è¨€çš„å®ç°å’Œæ‹“å±• DOM å®ƒæ˜¯æ ‡å‡†ç¼–ç¨‹æ¥å£ï¼Œé€šè¿‡DOMæä¾›çš„æ¥å£å¯ä»¥å¯¹é¡µé¢ä¸Šå„ç§å…ƒç´ è¿›è¡Œæ“ä½œï¼ˆå¤§å°ä½ç½®é¢œè‰²ï¼‰ BOM å®ƒæä¾›äº†ç‹¬ç«‹äºå†…å®¹ï¼Œå¯ä»¥ä¸æµè§ˆå™¨çª—å£è¿›è¡Œäº’åŠ¨çš„å¯¹è±¡ï¼Œæ“ä½œæµè§ˆå™¨çª—å£æ¯”å¦‚å¼¹å‡ºçª—ï¼Œæ§åˆ¶æµè§ˆå™¨è·³è½¬ï¼Œè·å–åˆ†è¾¨ç‡ç­‰ JSçš„æ’å…¥æ–¹å¼ ç±»ä¼¼äºCSSï¼Œæœ‰è¡Œå†…å¼ï¼Œå†…åµŒå¼&lt;script&gt;xxxx&lt;/script&gt; è¿˜æœ‰ä»å¤–éƒ¨å¼•å…¥ï¼š(scriptæ ‡ç­¾ä¸­é—´åˆ«å†™ä»£ç ) &lt;script src=\"xx.js\">&lt;/script> 2.JSåŸºæœ¬åŠŸèƒ½ä»‹ç»è¾“å…¥è¾“å‡ºalert(msg); //å¼¹å‡ºè­¦ç¤ºæ¡† console.log(msg) //æ‰“å°è¾“å‡ºä¿¡æ¯ï¼Œæ˜¯æ§åˆ¶å°è¾“å‡ºï¼Œç»™ç¨‹åºçŒ¿æµ‹è¯•ç”¨çš„ prompt(info) //å¼¹å‡ºè¾“å…¥æ¡†ï¼Œæä¾›ç”¨æˆ·è¾“å…¥ ä½†æ˜¯éƒ½æ˜¯ä»¥å­—ç¬¦çš„å½¢å¼è¾“å…¥ console.log()ä¼šåœ¨æµè§ˆå™¨æ§åˆ¶å°æ‰“å°å‡ºä¿¡æ¯ console.dir()å¯ä»¥æ˜¾ç¤ºä¸€ä¸ªå¯¹è±¡çš„æ‰€æœ‰å±æ€§å’Œæ–¹æ³• å®šä¹‰ä½¿ç”¨varï¼Œè‡ªåŠ¨ç¡®å®šç±»å‹ï¼ˆJSæ‹¥æœ‰åŠ¨æ€ç±»å‹ï¼‰ var å¦‚æœæ²¡æœ‰äº‹å…ˆå£°æ˜varï¼Œç›´æ¥ä½¿ç”¨ï¼Œä¼šåˆ›å»ºä¸€ä¸ªå…¨å±€å˜é‡ varå­˜åœ¨å£°æ˜æå‡ åŠŸèƒ½isNaN() åˆ¤æ–­æ˜¯å¦éæ•°å­— typeof å˜é‡å æŸ¥çœ‹æ•°æ®ç±»å‹ è½¬æ¢è½¬å­—ç¬¦ä¸²ï¼š â€‹ å˜é‡å.toString() numberç±»å‹æ—¶ï¼Œå˜é‡å.toString(16) è½¬æ¢æˆ16è¿›åˆ¶å­—ç¬¦ä¸² â€‹ å¼ºåˆ¶è½¬æ¢ï¼šString(å˜é‡å) â€‹ éšå¼è½¬æ¢ï¼šå˜é‡å+â€xxxxâ€(æ‹¼æ¥å­—ç¬¦ä¸²) Stringè½¬æ•°å­—ç±»å‹ï¼š ï¼ˆ1ï¼‰String-&gt;intï¼š parseInt(String)ï¼›parseInt()å‡½æ•°å°†ç»™å®šçš„å­—ç¬¦ä¸²ä»¥æŒ‡å®šçš„åŸºæ•°è§£æä¸ºæ•´æ•°ã€‚ ï¼ˆ2ï¼‰ String-&gt;float: parseFloat(String)ï¼› ï¼ˆ3ï¼‰Numberå¼ºåˆ¶è½¬æ¢ï¼ˆStringè½¬æ•°å€¼ï¼‰ï¼šNumber(String) ä½†æ˜¯Numberè½¬æ¢å­—ç¬¦ä¸²æ˜¯ç›¸å¯¹å¤æ‚ä¸”æœ‰ç‚¹åå¸¸è§„ï¼Œå»ºè®®ä½¿ç”¨parseIntï¼Œæ¯”å¦‚ï¼šNumber()åœ¨ä¸ç”¨newæ“ä½œç¬¦æ—¶ï¼Œå¯ä»¥ç”¨æ¥æ‰§è¡Œç±»å‹è½¬æ¢ã€‚å¦‚æœæ— æ³•è½¬æ¢ä¸ºæ•°å­—ï¼Œå°±è¿”å›NaNã€‚åƒâ€œ123aâ€ï¼ŒparseInt()è¿”å›æ˜¯123ï¼ŒNumber()è¿”å›æ˜¯NaNã€‚ ï¼ˆ4ï¼‰åˆ©ç”¨å‡ä¹˜é™¤ï¼ˆæ²¡æœ‰+ï¼‰ï¼šString-Stringæˆ–String-intä¹‹ç±»çš„ Stringè½¬asciiç  var str = \"A\"; str.charCodeAt(); // 65 var str1 = 'a'; str1.charCodeAt(); // 97 Asciiç è½¬String //å°†å¯¹åº”çš„ç¼–ç å€¼è½¬ä¸ºå­—ç¬¦ var charValue = String.fromCharCode(codeValue); è¿ç®—ç¬¦18==â€˜18â€™ æˆç«‹trueï¼Œé»˜è®¤è½¬æ¢æ•°æ®ç±»å‹ ===ä¸ºå…¨ç­‰éœ€è¦å®Œå…¨ä¸€è‡´ï¼Œ 18===â€˜18â€™ä¸ºfalse é€»è¾‘ä¸çŸ­è·¯è¿ç®—ï¼š123&amp;&amp;456ï¼Œè¿”å›456ï¼Œå·¦å¼ä¸ºçœŸè¿”å›å³å¼å­ï¼Œä¸ºå‡è¿”å›å·¦å¼ é€»è¾‘æˆ–çŸ­è·¯è¿ç®—ï¼š123||456ï¼Œè¿”å›123ï¼Œå·¦å¼ä¸ºçœŸè¿”å›å·¦å¼å­ï¼Œä¸ºå‡è¿”å›å³å¼ ä¸‰å…ƒè¡¨è¾¾å¼ï¼š æ¡ä»¶è¡¨è¾¾å¼ï¼Ÿè¡¨è¾¾å¼1ï¼šè¡¨è¾¾å¼2ï¼Œæ¡ä»¶ä¸ºçœŸè¿”å›è¡¨è¾¾å¼1ï¼Œä¸ºå‡è¿”å›è¡¨è¾¾å¼2 æ•°ç»„æ•°ç»„å.lengthä¸ºæ•°ç»„çš„é•¿åº¦ æ•°ç»„å¢åŠ å…ƒç´  ï¼ˆ1ï¼‰ç›´æ¥è®¾å®šæ•°ç»„é•¿åº¦arr.length=xx,å¤šå‡ºæ¥çš„å˜æˆç©º ï¼ˆ2ï¼‰arræ•°ç»„æœ‰ä¸‰ä¸ªå…ƒç´ ï¼Œç›´æ¥arr[3]=xxï¼Œè¿›è¡Œæ–°å¢å…ƒç´  æ•°æ®ç±»å‹ï¼šåŸºæœ¬æ•°æ®ç±»å‹ï¼ˆç®€å•æ•°æ®ç±»å‹ï¼‰ Boolean Null Undefined Number BigIntï¼šBigIntæ•°æ®ç±»å‹çš„ç›®çš„æ˜¯æ¯”Numberæ•°æ®ç±»å‹æ”¯æŒçš„èŒƒå›´æ›´å¤§çš„æ•´æ•°å€¼ã€‚åœ¨å¯¹å¤§æ•´æ•°æ‰§è¡Œæ•°å­¦è¿ç®—æ—¶ï¼Œä»¥ä»»æ„ç²¾åº¦è¡¨ç¤ºæ•´æ•°çš„èƒ½åŠ›å°¤ä¸ºé‡è¦ã€‚ä½¿ç”¨BigIntï¼Œæ•´æ•°æº¢å‡ºå°†ä¸å†æ˜¯é—®é¢˜ã€‚ String Symbol æ”¶å½•äº https://tc39.es/ecma262/#sec-primitive-value A primitive value is a member of one of the following built-in types: Undefined, Null, Boolean, Number, BigInt, String, and Symbol; å¤æ‚æ•°æ®ç±»å‹ Object æ€»ç»“ï¼šUSONB ï¼ˆyou are so niubiï¼‰ uï¼šundefined sï¼šstringã€symbol oï¼šobject nï¼šnullã€number bï¼šbooleanï¼Œbigint 3.åˆ¤æ–­JSæ•°æ®ç±»å‹çš„å››ç§æ–¹æ³•typeoftypeof æ˜¯ä¸€ä¸ªä¸€å…ƒè¿ç®—ï¼Œæ”¾åœ¨ä¸€ä¸ªè¿ç®—æ•°ä¹‹å‰ï¼Œè¿ç®—æ•°å¯ä»¥æ˜¯ä»»æ„ç±»å‹ã€‚ è¿”å›å€¼æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè¯¥å­—ç¬¦ä¸²è¯´æ˜è¿ç®—æ•°çš„ç±»å‹ã€‚ æ‰€ä»¥ç»å¸¸æ­é…ä½¿ç”¨ï¼šif(typeof target === &#39;object&#39; &amp;&amp; target !== null){} æ³¨æ„ï¼š typeof null è¿”å› object typeof å‡½æ•° è¿”å› function ä»¥åˆ›å»ºå¯¹è±¡çš„æ–¹å¼ï¼ˆæ˜¾ç¤ºåˆ›å»ºåŸå§‹å€¼åŒ…è£…ç±»å‹å®ä¾‹ï¼‰ï¼Œç”¨typeofåˆ¤æ–­æ˜¯å¦ä¸ºobjectéƒ½ä¼šä¸ºtrueï¼Œå®ƒä¸èƒ½ç²¾ç¡®åˆ°å…·ä½“çš„object let s = new String('abc'); typeof s === 'object'// true s instanceof String // true js åœ¨åº•å±‚å­˜å‚¨å˜é‡çš„æ—¶å€™ï¼Œä¼šåœ¨å˜é‡çš„æœºå™¨ç çš„ä½ä½1-3ä½å­˜å‚¨å…¶ç±»å‹ä¿¡æ¯ 000ï¼šå¯¹è±¡ 010ï¼šæµ®ç‚¹æ•° 100ï¼šå­—ç¬¦ä¸² 110ï¼šå¸ƒå°” 1ï¼šæ•´æ•° nullï¼šæ‰€æœ‰æœºå™¨ç å‡ä¸º0ï¼ˆè¿™å°±æ˜¯type null è¿”å› objectçš„åŸå› ï¼‰ undefinedï¼šç”¨ âˆ’2^30 æ•´æ•°æ¥è¡¨ç¤º çº¢å®ä¹¦é˜è¿°ï¼štypeofè™½ç„¶å¯¹åŸå§‹å€¼å¾ˆæœ‰ç”¨ï¼Œä½†æ˜¯å¯¹å¼•ç”¨å€¼ç”¨å¤„ä¸å¤§ã€‚ã€‚ instanceof instanceof ç”¨äºåˆ¤æ–­ä¸€ä¸ªå˜é‡æ˜¯å¦æŸä¸ªå¯¹è±¡çš„å®ä¾‹ï¼Œå¦‚ var a=new Array();alert(a instanceof Array); ä¼šè¿”å› true å½“ç„¶ï¼Œinstanceof ä¹Ÿå¯ä»¥åˆ¤æ–­ä¸€ä¸ªå®ä¾‹æ˜¯å¦æ˜¯å…¶çˆ¶ç±»å‹æˆ–è€…ç¥–å…ˆç±»å‹çš„å®ä¾‹ã€‚ å®˜æ–¹è§£é‡Šï¼šinstanceof è¿ç®—ç¬¦ç”¨äºæ£€æµ‹æ„é€ å‡½æ•°çš„ prototype å±æ€§æ˜¯å¦å‡ºç°åœ¨æŸä¸ªå®ä¾‹å¯¹è±¡çš„åŸå‹é“¾ä¸Šã€‚ æ³¨æ„ï¼š æ•°ç»„å¯ä»¥è¢« instanceof åˆ¤æ–­ä¸º Object åªèƒ½åˆ¤æ–­å¯¹è±¡ï¼Œå¯¹åŸå§‹ç±»å‹(ç®€å•æ•°æ®ç±»å‹)ä¸èƒ½åˆ¤æ–­ å¯¹äº value instanceof Arrayï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨ Array.isArray(value)ï¼Œåè€…æ˜¯ECMAScriptæä¾›ä¸ºäº†è§£å†³å¤šæ¡†æ¶æ¶‰åŠå¤šç‰ˆæœ¬Arrayçš„instancofå‡çº§ç‰ˆæ–¹æ³• æ‰‹å†™instanceOf function myInstanceof(left, right) { let proto = left.__proto__; while (true) { if (proto == null) return false; if (proto == right.prototype) return true; proto = proto.__proto__; } } constructor constructor [].constructor.name; //Array ''.constructor.name; //String alert(c.constructor === Array) ----------> true alert(d.constructor === Date) -----------> true alert(e.constructor === Function) -------> true æ³¨æ„ï¼š constructor åœ¨ç±»ç»§æ‰¿æ—¶ä¼šå‡ºé”™ï¼Œ null å’Œ undefined æ˜¯æ— æ•ˆçš„å¯¹è±¡ï¼Œå› æ­¤æ˜¯ä¸ä¼šæœ‰ constructor å­˜åœ¨çš„ toString toStringï¼Œåˆ©ç”¨toStringæ‰“å°å‡ºåŸå‹å¯¹è±¡ Object.prototype.toString.call('') ; // [object String] Object.prototype.toString.call(1) ; // [object Number] Object.prototype.toString.call(true) ;// [object Boolean] //ä½¿ç”¨Reflectæ›´æ£’ï¼ console.log(Reflect.toString.call('')); // [object String] console.log(Reflect.toString.call(1)); // [object Number] console.log(Reflect.toString.call(true));// [object Boolean] 4.å‡½æ•°//1.åˆ©ç”¨å‡½æ•°å…³é”®å­—è‡ªå®šä¹‰å‡½æ•° function å‡½æ•°å(å‚æ•°) { å‡½æ•°ä½“ } //å¦‚ä¸‹ï¼š function sort(arr){ } //2.åŒ¿åå‡½æ•° var fun=function(){ } //è°ƒç”¨ fun(); å‡½æ•°æ²¡æœ‰returnï¼Œåˆ™è¿”å›çš„æ˜¯undefined æ³¨æ„åœ¨å‡½æ•°å†…éƒ¨æ²¡æœ‰å£°æ˜ç›´æ¥èµ‹å€¼çš„å˜é‡ï¼Œä¹Ÿå±äºå…¨å±€å˜é‡ 5.å¯¹è±¡å¯¹è±¡ä¸€å®šæ˜¯ä¸€ä¸ªå…·ä½“çš„å¯¹è±¡ï¼Œè€Œä¸æ˜¯æ³›æŒ‡çš„ä¸œè¥¿ å±æ€§ï¼šäº‹ç‰©çš„ç‰¹å¾ï¼Œç”¨å¯¹è±¡çš„å±æ€§è¡¨ç¤º å‡½æ•°æ°¸è¿œä¸ä¼šå±äºä¸€ä¸ªå¯¹è±¡ï¼Œæ‰€ä»¥æŠŠå¯¹è±¡å†…éƒ¨å¼•ç”¨çš„å‡½æ•°ç§°ä¹‹ä¸ºâ€œæ–¹æ³•â€ä¸å¤ªå¦¥ï¼Œä¸¥æ ¼æ„ä¹‰ä¸Šæ¥è¯´åªæ˜¯å¯¹è¯¥å‡½æ•°çš„å¼•ç”¨ åˆ©ç”¨å¯¹è±¡å­—é¢é‡åˆ›å»ºå¯¹è±¡var obj ={ uname:'xx', age:18, sex:'man', say:function(){ console.log('good'); } } //è°ƒç”¨å¯¹è±¡å±æ€§(2ç§) obj.uname obj['uname'] (1)é”® å±æ€§å: å€¼ å±æ€§å€¼ (2)ç”¨é€—å·éš”å¼€ (3)æ–¹æ³•å†’å·åé¢è·Ÿçš„ä¸€ä¸ªåŒ¿åå‡½æ•° åˆ©ç”¨new Objectåˆ›å»ºå¯¹è±¡å†èµ‹å€¼çš„æ—¶å€™åˆ›å»ºå±æ€§ï¼Œå› æ­¤æ­¤æ–¹æ³•æ•ˆç‡ä¸é«˜ var obj = new Object obj.uname='xx'; obj.age=18; obj.say=funciton(){} ï¼ˆ1ï¼‰åˆ©ç”¨ç­‰å·èµ‹å€¼æ·»åŠ å¯¹è±¡çš„å±æ€§å’Œæ–¹æ³• ï¼ˆ2ï¼‰æ¯ä¸ªå±æ€§å’Œæ–¹æ³•ç”¨åˆ†å· åˆ©ç”¨æ„é€ å‡½æ•°åˆ›å»ºå¯¹è±¡å…¶è¿‡ç¨‹ä¹Ÿç§°ä¸ºå¯¹è±¡çš„å®ä¾‹åŒ–,æ„é€ å‡½æ•°æ˜¯æ³›æŒ‡çš„æŸä¸€å¤§ç±»ï¼Œå¯¹è±¡æ˜¯å…·ä½“çš„äº‹ç‰© function æ„é€ å‡½æ•°å(){ this.å±æ€§=å€¼; this.æ–¹æ³•=functionï¼ˆï¼‰{} } 1.ä½¿ç”¨æ„é€ å‡½æ•°ï¼Œæ„é€ å‡½æ•°åå­—é¦–å­—æ¯æœ€å¥½å¤§å†™å¦‚ function Star()2.æ„é€ å‡½æ•°ä¸éœ€è¦return3.ä½¿ç”¨å‡½æ•°new æ„é€ å‡½æ•°å();å³æ„é€ ä¸€ä¸ªå¯¹è±¡ï¼Œå¦‚new Array()ï¼Œåˆ›å»ºä¸€ä¸ªæ•°ç»„å¯¹è±¡4.å±æ€§æ–¹æ³•å‰å¿…é¡»åŠ thiså¦‚this.name=ä¼ å‚name this.song = functionï¼ˆä¼ å‚ï¼‰{} éå†å¯¹è±¡for (const k in obj){ //objä¸ºå¯¹è±¡ console.log(k); //kè¾“å‡ºçš„æ˜¯å±æ€§å console.log(obj[k]);//å¾—åˆ°çš„æ˜¯å±æ€§å€¼ } //æˆ‘ä»¬ä½¿ç”¨for in å–œæ¬¢var kæˆ–è€…key //æˆ–è€…ä½¿ç”¨ for (const item of è¿­ä»£å¯¹è±¡) { console.log(item); //æ¯ä¸ªå±æ€§çš„å±æ€§å€¼ï¼Œä¸è¿‡ä»…é€‚ç”¨äºå¯éå†å¯¹è±¡ï¼Œæ¯”å¦‚mapã€setã€æ•°ç»„ä¹‹ç±»çš„ï¼Œ //æ™®é€šå¯¹è±¡ä¸è¡Œï¼Œéå†æ™®é€šå¯¹è±¡æ¨èä½¿ç”¨Object.keys } å¯¹è±¡åˆ é™¤é”®å€¼å¯¹var json = { name:'å¼ ä¸‰', age:'23' }; delete json.age; 6.ç®€å•ç±»å‹å’Œå¤æ‚ç±»å‹å¦‚æœæœ‰ä¸ªæ•°æ®ç±»å‹æ‰“ç®—ä½œä¸ºå­˜å‚¨å¯¹è±¡ï¼Œæš‚æ—¶æ²¡æƒ³å¥½æ”¾ä»€ä¹ˆï¼Œå¯ä»¥å…ˆæ”¾null ç®€å•æ•°æ®ç±»å‹ï¼ˆå€¼ç±»å‹ï¼‰ï¼šstringï¼ˆä½†æ˜¯stringæ•°å€¼ä¸å¯å˜ï¼‰ã€numberã€booleanã€undefinedã€nullã€symbolã€bigint ç®€å•æ•°æ®ç±»å‹æ”¾å…¥æ ˆé‡Œé¢ï¼ˆæ“ä½œç³»ç»Ÿï¼‰ï¼Œæ ˆé‡Œå¼€è¾Ÿçš„ç©ºé—´å­˜æ”¾çš„æ˜¯å€¼ ï¼ˆç”¨å‡½æ•°ä¼ å‚æ˜¯ä¸ä¼šå½±å“å˜é‡çš„å€¼ï¼‰ å¤æ‚æ•°æ®ç±»å‹ï¼ˆå¼•ç”¨ç±»å‹ï¼‰ï¼šObjectã€ Arrayã€ Date å¤æ‚æ•°æ®ç±»å‹æ”¾å…¥å †é‡Œé¢ï¼ˆæ“ä½œç³»ç»Ÿï¼‰ï¼Œäºæ ˆé‡Œå­˜æ”¾åœ°å€ï¼Œåå…­è¿›åˆ¶è¡¨ç¤ºï¼Œç„¶åè¿™ä¸ªåœ°å€æŒ‡å‘å †é‡Œçš„æ•°å€¼ï¼›ä¸€èˆ¬ç”±ç¨‹åºå‘˜åˆ†é…é‡Šæ”¾ï¼Œè‹¥ç¨‹åºå‘˜ä¸é‡Šæ”¾ï¼Œç”±åƒåœ¾å›æ”¶æœºåˆ¶é‡Šæ”¾ ï¼ˆç”¨å‡½æ•°ä¼ å‚æ˜¯ä¼šå½±å“å¯¹è±¡çš„å€¼ï¼‰ ä½†æ˜¯å¤æ‚æ•°æ®ç±»å‹nullèµ‹å€¼æ—¶æ–­äº†åœ°å€è”ç³» var obj = new Object(); obj.name = 'allen'; var obj2 = obj; console.log(obj2.name); //allen obj.name = 'bllen'; //æ”¹å¯¹è±¡ console.log(obj2.name); //bllen obj = null; //æ”¹å˜é‡ console.log(obj2.name); //bllen ä½†æ˜¯JSé‡Œæ²¡æœ‰å †æ ˆçš„æ¦‚å¿µï¼Œåªæ˜¯é€šè¿‡å †æ ˆçš„æ–¹å¼ç†è§£ä»£ç çš„æ‰§è¡Œæ–¹å¼ 7.å…¶ä»–swiperæ’ä»¶çš„ä½¿ç”¨å®˜ç½‘åœ°å€ï¼šhttps://www.swiper.com.cn ï¼ˆ1ï¼‰ä¸‹è½½å¹¶è§£å‹åŒ…åï¼ŒæŠŠå…¶ä¸­çš„swiper.min.jså’Œswiper.min.cssæ”¾å…¥ç½‘é¡µæ–‡ä»¶å¤¹çš„jså’Œcssä¸­ ï¼ˆ2ï¼‰å®˜ç½‘æ‰¾åˆ°ç±»ä¼¼çš„æ¡ˆä¾‹ï¼Œå¤åˆ¶htmlï¼Œcsså’Œjsï¼ˆè¿›å…¥å®˜ç½‘swiperæ¼”ç¤ºä¸­ï¼Œç„¶åæ–°çª—å£æ‰“å¼€ï¼ŒæŸ¥çœ‹ç½‘é¡µæºä»£ç ï¼‰ ï¼ˆ3ï¼‰æ ¹æ®éœ€æ±‚ä¿®æ”¹æ¨¡å— æµ…æ‹·è´å’Œæ·±æ‹·è´æ·±æ‹·è´å’Œæµ…æ‹·è´æ˜¯åªé’ˆå¯¹objectå’ŒArrayè¿™æ ·çš„å¼•ç”¨æ•°æ®ç±»å‹çš„ 1.èµ‹å€¼å½“æˆ‘ä»¬æŠŠä¸€ä¸ªå¯¹è±¡èµ‹å€¼ç»™ä¸€ä¸ªæ–°çš„å˜é‡æ—¶ï¼Œèµ‹çš„å…¶å®æ˜¯è¯¥å¯¹è±¡åœ¨æ ˆä¸­çš„åœ°å€ï¼Œè€Œä¸æ˜¯å †ä¸­çš„æ•°æ®ï¼Œåªè¦ä¿®æ”¹äº†é‡Œé¢çš„çš„å€¼ï¼ŒåŸæ¥éƒ½éƒ½ä¼šå—åˆ°å½±å“ 2.æµ…æ‹·è´ä»–ä¼šåˆ›å»ºä¸€ä¸ªæ–°å¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡æœ‰ç€åŸå§‹å¯¹è±¡å±æ€§å€¼çš„ä¸€ä»½ç²¾ç¡®æ‹·è´ã€‚å¦‚æœå±æ€§åŸºæœ¬ç±»å‹ï¼Œæ‹·è´çš„åŸºæœ¬ç±»å‹çš„å€¼ï¼ˆä¿®æ”¹ååŸæ¥çš„å˜é‡çš„å€¼ä¸ä¼šå—åˆ°å½±å“ï¼‰ï¼›å¦‚æœå±æ€§æ˜¯å†…å­˜åœ°å€ï¼ˆå¼•ç”¨ç±»å‹ï¼Œæ¯”å¦‚æ•°ç»„ã€å¯¹è±¡ï¼‰ï¼Œæ‹·è´çš„å°±æ˜¯å†…å­˜åœ°å€ï¼Œå³å…¶ä¸­ä¸€ä¸ªå˜é‡ä¿®æ”¹äº†è¿™ä¸ªåœ°å€å­˜æ”¾çš„å¯¹è±¡ï¼Œåˆ™å¦å¤–ä¸€ä¸ªä¼šå—åˆ°å½±å“ æ•°ç»„çš„æµ…æ‹·è´å¯ä»¥ä½¿ç”¨ï¼šArray.prototype.concat()ã€Array.prototype.slice()ã€Array.from(arr)ï¼Œä»–ä»¬ä¸ä¼šä¿®æ”¹åŸæ•°ç»„ï¼Œåªæ˜¯è¿”å›äº†ä¸€ä¸ªæµ…æ‹·è´çš„æ–°æ•°ç»„ let arraylike = { 0: 'a', 1; 'b', length: 2 }; let arr2 = Array.from(arraylike); //[a, b] å¯¹è±¡å¯ä»¥ä½¿ç”¨ ï¼šObject.assgin()æˆ–è€… let obj2 = {...obj1} (ï¼ˆECMAScript 2018è§„èŒƒæ–°å¢ç‰¹æ€§ï¼‰) 3.æ·±æ‹·è´æ‰€è°“â€æ·±æ‹·è´â€ï¼Œå°±æ˜¯èƒ½å¤Ÿå®ç°çœŸæ­£æ„ä¹‰ä¸Šçš„æ•°ç»„å’Œå¯¹è±¡çš„æ‹·è´ï¼Œä½¿å¾—ä¸¤ä¸ªå¯¹è±¡ä¸ä¼šç›¸äº’å½±å“ å…·ä½“æ·±æ‹·è´çš„æ‰‹å†™æˆ‘åœ¨ â€œJavaScriptè¿›é˜¶ES5+é¢å‘å¯¹è±¡â€ç¯‡ç« ä¸­å†™è¿‡ æ¯ç§forçš„å·®å¼‚ä»åŸºæœ¬çš„forå¾ªç¯ï¼Œåˆ°for inã€ for ofå’Œæ•°ç»„çš„forEachï¼Œå·®å¼‚æ€§åœ¨é¢è¯•çš„æ—¶å€™æœ‰è¢«é—®åˆ°ï¼Œåœ¨è¿™é‡Œè®°å½•ä¸€ä¸‹ ç½‘ç»œä¸Šé€šè¿‡é«˜æ•°é‡çº§æ•°ç»„çš„éå†æµ‹è¯•ï¼ˆåœ°å€ï¼šhttps://blog.csdn.net/qq_24357165/article/details/82748976ï¼‰ï¼Œå¾—å‡ºï¼š æ—¶é—´ä¸Šï¼šforå¾ªç¯éå† &lt; forâ€¦oféå† &lt; forEachéå† &lt; forâ€¦inéå† &lt; mapéå† for â€¦ inè¯­æ³•æ˜¯ç¬¬ä¸€ä¸ªèƒ½å¤Ÿè¿­ä»£å¯¹è±¡é”®çš„JavaScriptè¯­å¥ï¼Œå¾ªç¯å¯¹è±¡é”®ï¼ˆ{}ï¼‰ä¸åœ¨æ•°ç»„ï¼ˆ[]ï¼‰ä¸Šè¿›è¡Œå¾ªç¯ä¸åŒï¼Œå¼•æ“ä¼šæ‰§è¡Œä¸€äº›é¢å¤–çš„å·¥ä½œæ¥è·Ÿè¸ªå·²ç»è¿­ä»£çš„å±æ€§ã€‚ è€Œfor of å®ç°çš„æ˜¯è¿­ä»£å™¨ [Symbol.iterator]æ–¹æ³•å®é™…ä¸Šä¹Ÿæ˜¯èµ°çš„åŸç”Ÿçš„foréå†ï¼Œé€šè¿‡ç´¢å¼•è·å–æ•°ç»„çš„æ•°å€¼ï¼Œåªæ˜¯åœ¨å‡½æ•°é‡Œå¤šå¢åŠ äº†nextã€doneåˆ¤æ–­éå†çš„ç»“æŸä¸å¦ ï¼ˆå®é™…ä¸Šæˆ‘ä¸ªäººè®¤ä¸ºï¼Œå†…éƒ¨å…¨éƒ½æ˜¯ä»¥ä¼ ç»Ÿforä¸ºåŸºå‡†å®ç°çš„éå†ï¼Œæ—¶é—´å’Œç©ºé—´çš„é¢å¤–èŠ±è´¹å–å†³äºè¯¥éå†æ–¹æ³•çš„è°ƒç”¨å ç”¨ï¼‰ é€’å½’çŸ¥è¯†å°¾é€’å½’ï¼šhttps://zhuanlan.zhihu.com/p/36587160 é€’å½’çš„ç®€åŒ–æ¨¡å‹https://zhuanlan.zhihu.com/p/136511316 å…¶ä»–ä¸­çš„å…¶ä»–å°ç¨‹åºä¸­ä½¿ç”¨eval / new Functionï¼šhttps://zhuanlan.zhihu.com/p/34191831?utm_source=wechat_session&amp;utm_medium=social&amp;utm_oi=757127387623206912&amp;utm_campaign=shareopn 8.JSæ•°å€¼ç²¾åº¦JavaScript å†…éƒ¨ï¼Œæ‰€æœ‰æ•°å­—éƒ½æ˜¯ä»¥64ä½æµ®ç‚¹æ•°å½¢å¼å‚¨å­˜ï¼Œå³ä½¿æ•´æ•°ä¹Ÿæ˜¯å¦‚æ­¤ã€‚æ‰€ä»¥ï¼Œ1ä¸1.0æ˜¯ç›¸åŒçš„ï¼Œæ˜¯åŒä¸€ä¸ªæ•° è€Œä½æ“ä½œå¹¶ä¸ç›´æ¥åº”ç”¨åˆ°64ä½ï¼Œè€Œæ˜¯å…ˆæŠŠå€¼è½¬æ¢ä¸º32ä½æ•´æ•°ï¼Œåœ¨è¿›è¡Œä½æ“ä½œï¼Œæœ€åå†æŠŠ32ä½è½¬æ¢ä¸º34ä½å­˜å‚¨èµ·æ¥ NaNæ˜¯ JavaScript çš„ç‰¹æ®Šå€¼ï¼Œè¡¨ç¤ºâ€œéæ•°å­—â€ï¼ˆNot a Numberï¼‰ï¼Œä¸»è¦å‡ºç°åœ¨å°†å­—ç¬¦ä¸²è§£ææˆæ•°å­—å‡ºé”™çš„åœºåˆã€‚ typeof NaN // 'number' NaN === NaN // falseï¼ŒNaNä¸ç­‰äºä»»ä½•å€¼ Boolean(NaN) // false JavaScript å†…æ‰€æœ‰æ•°å­—éƒ½æ˜¯æµ®ç‚¹æ•°ï¼Œè‹¥é‡åˆ°éœ€è¦æ•´æ•°æ‰èƒ½è¿ç®—çš„æƒ…å†µï¼ŒJavaScript ä¼šè‡ªè¡Œå°†64ä½æµ®ç‚¹æ•°è½¬æˆ32ä½æ•´æ•°ï¼Œå†è¿›è¡Œè¿ç®—ï¼Œè€Œè¿™ä¸ªè½¬æ¢è¿‡ç¨‹ï¼Œä¾¿å¯¼è‡´äº†ç²¾åº¦ä¸¢å¤±ã€‚ æ¯”å¦‚ï¼š 0.1 + 0.2 // 0.30000000000000004 0.1 + 0.7 // 0.7999999999999999 0.3 / 0.1 // 2.9999999999999996 (0.3 - 0.2) === (0.2 - 0.1) // false ä¸ºä»€ä¹ˆ0.1+0.2===0.3 //false ï¼Ÿï¼Ÿï¼Ÿï¼Ÿ åœ¨è®¡ç®—æœºé‡Œçš„æ•°è¡¨ç¤ºæ–¹å¼éƒ½æ˜¯äºŒè¿›åˆ¶ï¼Œso 0.01 = 1/4 = 0.25 ,å¤ªå¤§ 0.001 =1/8 = 0.125 , åˆå¤ªå° 0.0011 = 1/8 + 1/16 = 0.1875 , é€¼è¿‘0.2äº† 0.00111 = 1/8 + 1/16 + 1/32 = 0.21875 , åˆå¤§äº† 0.001101 = 1/8+ 1/16 + 1/64 = 0.203125 è¿˜æ˜¯å¤§ 0.0011001 = 1/8 + 1/16 + 1/128 = 0.1953125 è¿™ç»“æœä¸é”™ 0.00110011 = 1/8+1/16+1/128+1/256 = 0.19921875 æ•´æ•°ç²¾åº¦è€Œæ•´æ•°çš„ç²¾åº¦æœ€å¤šåªèƒ½åˆ°53ä¸ªäºŒè¿›åˆ¶ä½ï¼Œè¿™æ„å‘³ç€ï¼Œç»å¯¹å€¼ å°äº 2^53 çš„æ•´æ•°ï¼Œå³ (-2^53, 2^53) Math.pow(2, 53) // 9007199254740992ã€æœªä¸¢å¤±ã€‘ Math.pow(2, 53) + 1 // 9007199254740992ã€ä¸¢å¤±ã€‘ Math.pow(2, 53) + 2 // 9007199254740994ã€æœªä¸¢å¤±ã€‘ Math.pow(2, 53) + 3 // 9007199254740996ã€ä¸¢å¤±ã€‘ Math.pow(2, 53) + 4 // 9007199254740996ã€æœªä¸¢å¤±ã€‘ å¯ä»¥ä½¿ç”¨Number.isSafeInteger(å˜é‡) æ–¹æ³•æ¥åˆ¤æ–­ä¸€ä¸ªå€¼æ˜¯å¦ä¸ºå®‰å…¨æ•´æ•°ï¼Œå³è¯¥æ•´æ•°æ˜¯å¦åœ¨ (-2^53, 2^53) èŒƒå›´å†… æŒ‡æ•°èŒƒå›´æ ¹æ® IEEE 754 æ ‡å‡†ï¼Œ64ä½æµ®ç‚¹æ•°çš„æŒ‡æ•°éƒ¨åˆ†çš„é•¿åº¦æ˜¯11ä¸ªäºŒè¿›åˆ¶ä½ï¼Œæ„å‘³ç€æŒ‡æ•°éƒ¨åˆ†çš„æœ€å¤§å€¼æ˜¯2047ï¼ˆ211-1 = 2047ï¼‰ã€‚åˆ†å‡ºä¸€åŠè¡¨ç¤ºæ­£æ•°ï¼Œä¸€åŠè¡¨ç¤ºè´Ÿæ•°ï¼Œåˆ™ JavaScript èƒ½å¤Ÿè¡¨ç¤ºçš„æ•°å€¼èŒƒå›´ä¸º (2^1024, 2^-1023) ã€å¼€åŒºé—´ã€‘ï¼Œè¶…å‡ºè¿™ä¸ªèŒƒå›´çš„æ•°æ— æ³•è¡¨ç¤ºã€‚ æ­£å‘æº¢å‡ºä¸è´Ÿå‘æº¢å‡º ã€æ­£å‘æº¢å‡ºã€‘å¦‚æœä¸€ä¸ªæ•°å¤§äºç­‰äº 2^1024ï¼Œé‚£ä¹ˆå°±ä¼šå‘ç”Ÿ â€œæ­£å‘æº¢å‡ºâ€ï¼Œå³ JavaScript æ— æ³•è¡¨ç¤ºè¿™ä¹ˆå¤§çš„æ•°ï¼Œè¿™æ—¶å°±ä¼šè¿”å›Infinity ã€è´Ÿå‘æº¢å‡ºã€‘å¦‚æœä¸€ä¸ªæ•°å°äºç­‰äº 2^-1075ï¼ˆæŒ‡æ•°éƒ¨åˆ†æœ€å°å€¼-1023ï¼Œå†åŠ ä¸Šå°æ•°éƒ¨åˆ†çš„52ä½ï¼‰ï¼Œé‚£ä¹ˆå°±ä¼šå‘ç”Ÿä¸º â€œè´Ÿå‘æº¢å‡ºâ€ï¼Œå³ JavaScript æ— æ³•è¡¨ç¤ºè¿™ä¹ˆå°çš„æ•°ï¼Œè¿™æ—¶ä¼šç›´æ¥è¿”å›0ã€‚ // æ­£å‘æº¢å‡º Math.pow(2, 1024) // Infinityã€æ­£æ•°æ•°å€¼éå¸¸å¤§ï¼Œæ— æ³•è¡¨ç¤ºï¼Œæ­£å‘æº¢å‡ºï¼Œåªèƒ½è¿”å›æ­£æ— ç©·ã€‘ // è´Ÿå‘æº¢å‡º Math.pow(2, -1075) // 0ã€æ­£æ•°æ•°å€¼éå¸¸å°ï¼Œæ— æ³•è¡¨ç¤ºï¼Œè´Ÿå‘æº¢å‡ºï¼Œè¿”å› 0ã€‘ æ‰€ä»¥æ— ç©·å¤§ã€æ— ç©·å°ç”±æ­¤å¾—æ¥ æ— ç©·å¤§ï¼šNumber.MAX_VALUEï¼ŒJavaScripté‡Œæœ€æ¥è¿‘infinityçš„æ­£å€¼ æ— ç©·å°ï¼šNumber.MIN_VALUEï¼ŒJavaScript é‡Œæœ€æ¥è¿‘ 0 çš„æ­£å€¼ï¼Œè€Œä¸æ˜¯æœ€å°çš„è´Ÿå€¼ã€‚ æµ®ç‚¹æ•°ç²¾åº¦ä¿®å¤ä¸ºäº†é¿å…æ­¤ç±»äº‹æƒ…çš„å‘ç”Ÿ (0.3 - 0.2) === (0.2 - 0.1) // false ECMA ç»™å‡ºçš„è§£å†³æ–¹æ³•æ˜¯ï¼šå°†æµ®ç‚¹æ•°åˆ†åˆ«ä¹˜ 10n è½¬ä¸ºæ•´æ•°ï¼Œå†é™¤ä»¥ 10nã€‚((0.01 * 100) + (0.02 * 100)) / 100 === 0.03; // æ¥æºï¼šhttps://www.iteye.com/blog/talentluke-1767138 // ä¸¤ä¸ªæµ®ç‚¹æ•°æ±‚å’Œ function accAdd(num1, num2) { var r1, r2, m; try { r1 = num1.toString().split('.')[1].length; } catch(e) { r1 = 0; } try { r2 = num2.toString().split(\".\")[1].length; } catch(e) { r2 = 0; } m = Math.pow(10,Math.max(r1,r2)); // return (num1*m+num2*m)/m; return Math.round(num1*m+num2*m)/m; } è¿˜æœ‰ä¸€ä¸ªåŠæ³•å°±æ˜¯ï¼ŒæŠŠå°æ•°éƒ¨åˆ†é€ä¸ªè½¬æ¢æˆå­—ç¬¦ï¼Œç„¶åä¸€ä¸ªä¸€ä¸ªä½œä¸ºå•ä¸ªæ•°å­—å»åšåŠ å‡ä¹˜é™¤ï¼Œå®ç°å¤§æ•°åŠ å‡ä¹˜é™¤ï¼Œå®ç°æ–¹æ³•å¯èƒ½æ¯”è¾ƒç¹çã€‚ ä½¿ç”¨BigIntè¦åˆ›å»ºBigIntï¼Œåªéœ€è¦åœ¨æ•°å­—æœ«å°¾è¿½åŠ nå³å¯ã€‚ console.log( 9007199254740995n ); // â†’ 9007199254740995n console.log( 9007199254740995 ); // â†’ 9007199254740996 å¤åˆ¶ä»£ç  å¦ä¸€ç§åˆ›å»ºBigIntçš„æ–¹æ³•æ˜¯ç”¨BigInt()æ„é€ å‡½æ•°ã€ BigInt(\"9007199254740995\"); // â†’ 9007199254740995n æ³¨æ„ï¼š BigIntä¸æ”¯æŒä¸€å…ƒåŠ å·è¿ç®—ç¬¦ï¼Œè¿™å¯èƒ½æ˜¯æŸäº›ç¨‹åºå¯èƒ½ä¾èµ–äº + å§‹ç»ˆç”Ÿæˆ Number çš„ä¸å˜é‡ï¼Œæˆ–è€…æŠ›å‡ºå¼‚å¸¸ã€‚å¦å¤–ï¼Œæ›´æ”¹ + çš„è¡Œä¸ºä¹Ÿä¼šç ´å asm.jsä»£ç  +10n; // â†’ TypeError: Cannot convert a BigInt value to a number å› ä¸ºéšå¼ç±»å‹è½¬æ¢å¯èƒ½ä¸¢å¤±ä¿¡æ¯ï¼Œæ‰€ä»¥ä¸å…è®¸åœ¨bigintå’Œ Number ä¹‹é—´è¿›è¡Œæ··åˆæ“ä½œ 9.æ•è·å¼‚å¸¸try catchæ— æ³•æ•è·å¼‚æ­¥ä»»åŠ¡çš„é”™è¯¯ï¼Œè¿™è·Ÿæµè§ˆå™¨çš„æ‰§è¡Œæœºåˆ¶æœ‰å…³ã€‚å¼‚æ­¥ä»»åŠ¡ç”± eventloop åŠ å…¥ä»»åŠ¡é˜Ÿåˆ—ï¼Œå¹¶å–å‡ºå…¥æ ˆ(js ä¸»è¿›ç¨‹)æ‰§è¡Œï¼Œè€Œå½“ task å–å‡ºæ‰§è¡Œçš„æ—¶å€™ï¼Œ main çš„æ ˆå·²ç»é€€å‡ºäº†ï¼Œä¹Ÿå°±æ˜¯ä¸Šä¸‹æ–‡ç¯å¢ƒå·²ç»æ”¹å˜ï¼Œæ‰€ä»¥ main æ— æ³•æ•è· task çš„é”™è¯¯ã€‚ // å¼‚æ­¥ä»»åŠ¡ // æ•è·ä¸åˆ° const task = () => { setTimeout(() => { throw new Error('async error') }, 1000) } // ä¸»ä»»åŠ¡ function main() { try { task(); } catch(e) { console.log(e, 'err') console.log('continue...') } } è€Œå¾®ä»»åŠ¡promiseä¸­ï¼Œ promise.catch æ‰å¯ä»¥æ•è·ï¼Œæ‰€ä»¥ç”¨ Promise ä¸€å®šè¦å†™ catch å•Š ç„¶è€Œé€šè¿‡ async await çš„æ–¹å¼ï¼Œæ˜¯å¯ä»¥åœ¨try catchä¸­æ•è·å¼‚å¸¸çš„ async function main () { try { const res = await fetchFailure(); console.log(res, 'res'); } catch(e) { console.log(e, 'e.message'); } } console.error(&quot;æœåŠ¡ç«¯æ•°æ®æ ¼å¼è¿”å›å¼‚å¸¸ï¼Œä½¿ç”¨æœ¬åœ°ç¼“å­˜æ•°æ®&quot;, erorr); è¾“å‡ºå°æ‰“å°çº¢è‰²å­—ä½“ è¿è¡Œæ—¶å¼‚å¸¸ä»£ç ä¹Ÿæ•è·ä¸åˆ° 2.â€è¿è¡Œæ—¶å¼‚å¸¸â€æ˜¯æŒ‡éSyntaxErrorï¼Œä¹Ÿå°±æ˜¯è¯­æ³•é”™è¯¯æ˜¯æ— æ³•æ•è·çš„ï¼Œå› ä¸ºåœ¨è§£æJavaScriptæºç æ—¶å°±æŠ¥é”™äº†ï¼Œè¿˜æ€ä¹ˆæ•è·å‘¢ï½ï½ // éæ³•æ ‡è¯†ç¬¦a->bï¼ŒçœŸå¿ƒæ•è·ä¸åˆ°å•Šäº²ï½ï¼ try{ a->b = 1 } catch(e){ console.log(e) }","categories":[{"name":"å‰ç«¯","slug":"å‰ç«¯","permalink":"https://taylor12138.github.io/categories/%E5%89%8D%E7%AB%AF/"}],"tags":[],"author":"Hello"},{"title":"Docker","slug":"Docker","date":"2022-06-04T16:00:00.000Z","updated":"2022-06-05T16:11:22.731Z","comments":true,"path":"2022/06/05/docker/","link":"","permalink":"https://taylor12138.github.io/2022/06/05/docker/","excerpt":"","text":"Dockeræ¦‚è¿°ç®€è¦æ¦‚è¿°IT è½¯ä»¶ä¸­æ‰€è¯´çš„ â€œDockerâ€ ï¼Œæ˜¯æŒ‡å®¹å™¨åŒ–æŠ€æœ¯ï¼Œç”¨äºæ”¯æŒåˆ›å»ºå’Œä½¿ç”¨ LinuxÂ® å®¹å™¨ã€‚ å¼€æº Docker ç¤¾åŒºè‡´åŠ›äºæ”¹è¿›è¿™ç±»æŠ€æœ¯ï¼Œå¹¶å…è´¹æä¾›ç»™æ‰€æœ‰ç”¨æˆ·ï¼Œä½¿ä¹‹è·ç›Šã€‚ ä¸€èˆ¬æ¥è¯´ï¼Œæ¯”å¦‚æˆ‘ä»¬å†™äº†ä¸€ä¸ªwebåº”ç”¨ï¼Œå¦‚æœæœ‹å‹ä»¬è¦çœ‹/éƒ¨ç½²åˆ°è¿œç¨‹æœåŠ¡å™¨ï¼Œï¼Œé‚£ä¹ˆé¦–å…ˆéƒ½éœ€è¦é…ç½®ç›¸åŒçš„ä¾èµ–ï¼ˆæ•°æ®åº“å•Šä¹‹ç±»çš„ï¼Œç”šè‡³è¦ä¿è¯æ“ä½œç³»ç»Ÿçš„ä¸€è‡´æ€§ï¼‰ï¼Œä¸ºäº†æ¨¡æ‹Ÿå®Œå…¨ç›¸åŒçš„æœ¬åœ°å¼€å‘ç¯å¢ƒï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨è™šæ‹Ÿæœºï¼Œä½†æ˜¯è™šæ‹Ÿæœºçš„ç¼ºç‚¹ï¼š è™šæ‹Ÿæœºéœ€è¦æ¨¡æ‹Ÿç¡¬ä»¶ï¼Œè¿è¡Œæ•´ä¸ªæ“ä½œç³»ç»Ÿï¼Œä¸ä½†ä½“ç§¯è‡ƒè‚¿å†…å­˜å é«˜ï¼Œç¨‹åºæ€§èƒ½ä¹Ÿä¼šå—åˆ°å½±å“ Dockeråœ¨æ¦‚å¿µä¸Šå’Œè™šæ‹Ÿæœºååˆ†ç›¸ä¼¼ï¼Œä½†æ˜¯è½»é‡å¾ˆå¤šï¼Œå®ƒä¸ä¼šå»æ¨¡æ‹Ÿåº•å±‚ç¡¬ä»¶ï¼Œåªæ˜¯ä¸ºæ¯ä¸ªåº”ç”¨æä¾›ä¸€ä¸ªå®Œå…¨éš”ç¦»çš„è¿è¡Œç¯å¢ƒï¼ˆç±»ä¼¼äºsandboxï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æ¯ä¸ªä¸åŒçš„ç¯å¢ƒé…ç½®ä¸åŒçš„å·¥å…· Image/é•œåƒ ç±»ä¼¼äºä¸€ä¸ªè™šæ‹Ÿæœºå¿«ç…§ï¼Œé‡Œé¢åŒ…å«äº†ä½ è¦éƒ¨ç½²çš„åº”ç”¨ç¨‹åºä»¥åŠä»–å…³è”çš„æ‰€æœ‰åº“ é€šè¿‡é•œåƒï¼Œæˆ‘ä»¬å¯ä»¥åˆ›å»ºè®¸å¤šä¸åŒçš„containerå®¹å™¨ï¼Œè¿™é‡Œçš„å®¹å™¨å°±åƒä¸€å°å°è™šæ‹Ÿæœºï¼Œæ¯ä¸ªcontainerç‹¬ç«‹è¿è¡Œ Dockerfile ç±»ä¼¼äºä¸€ä¸ªè‡ªåŠ¨åŒ–è„šæœ¬ï¼Œä¸»è¦ç”¨æ¥åˆ›å»ºé•œåƒï¼ˆç±»æ¯”åœ¨è™šæ‹Ÿæœºä¸­å®‰è£…æ“ä½œç³»ç»Ÿå’Œè½¯ä»¶ï¼‰ ç‰¹ç‚¹ æ¨¡å—åŒ– å±‚å’Œé•œåƒç‰ˆæœ¬æ§åˆ¶ å›æ»š å¿«é€Ÿéƒ¨ç½² åº”ç”¨å€ŸåŠ© Dockerï¼Œæ‚¨å¯å°†å®¹å™¨å½“åšè½»å·§ã€æ¨¡å—åŒ–çš„è™šæ‹Ÿæœºä½¿ç”¨ã€‚åŒæ—¶ï¼Œæ‚¨è¿˜å°†è·å¾—é«˜åº¦çš„çµæ´»æ€§ï¼Œä»è€Œå®ç°å¯¹å®¹å™¨çš„é«˜æ•ˆåˆ›å»ºã€éƒ¨ç½²åŠå¤åˆ¶ï¼Œå¹¶èƒ½å°†å…¶ä»ä¸€ä¸ªç¯å¢ƒé¡ºåˆ©è¿ç§»è‡³å¦ä¸€ä¸ªç¯å¢ƒï¼Œä»è€Œæœ‰åŠ©äºæ‚¨é’ˆå¯¹äº‘æ¥ä¼˜åŒ–æ‚¨çš„åº”ç”¨ã€‚ åŸç†Docker ä½¿ç”¨ Google å…¬å¸æ¨å‡ºçš„ Go è¯­è¨€ è¿›è¡Œå¼€å‘å®ç° Docker æŠ€æœ¯ä½¿ç”¨ Linux å†…æ ¸å’Œå†…æ ¸åŠŸèƒ½ï¼ˆä¾‹å¦‚ Cgroups å’Œ namespacesï¼‰æ¥åˆ†éš”è¿›ç¨‹ï¼Œä»¥ä¾¿å„è¿›ç¨‹ç›¸äº’ç‹¬ç«‹è¿è¡Œã€‚è¿™ç§ç‹¬ç«‹æ€§æ­£æ˜¯é‡‡ç”¨å®¹å™¨çš„ç›®çš„æ‰€åœ¨ï¼›å®ƒå¯ä»¥ç‹¬ç«‹è¿è¡Œå¤šç§è¿›ç¨‹ã€å¤šä¸ªåº”ç”¨ï¼Œæ›´åŠ å……åˆ†åœ°å‘æŒ¥åŸºç¡€è®¾æ–½çš„ä½œç”¨ï¼ŒåŒæ—¶ä¿æŒå„ä¸ªç‹¬ç«‹ç³»ç»Ÿçš„å®‰å…¨æ€§ã€‚ å‚è€ƒï¼šhttps://www.bilibili.com/video/BV1s54y1n7Ev?from=search&amp;seid=15719185628407439607&amp;spm_id_from=333.337.0.0","categories":[{"name":"å‰ç«¯","slug":"å‰ç«¯","permalink":"https://taylor12138.github.io/categories/%E5%89%8D%E7%AB%AF/"}],"tags":[],"author":"Hello"},{"title":"WebAssembly","slug":"WebAssembly","date":"2022-06-04T16:00:00.000Z","updated":"2023-06-01T17:37:32.620Z","comments":true,"path":"2022/06/05/webassembly/","link":"","permalink":"https://taylor12138.github.io/2022/06/05/webassembly/","excerpt":"","text":"WebAssemblywebasemblyæ˜¯ä¸€ç§æ–°å‹ä»£ç ï¼Œå®ƒæä¾›äº†ä¸€ç§ä»¥æ¥è¿‘æœ¬æœºçš„é€Ÿåº¦åœ¨ Web ä¸Šè¿è¡Œä»¥å¤šç§è¯­è¨€ç¼–å†™çš„ä»£ç çš„æ–¹æ³•ï¼Œå®¢æˆ·ç«¯åº”ç”¨ç¨‹åºå¯ä»¥åœ¨ Web ä¸Šè¿è¡Œï¼Œæ¯”å¦‚å¯ä»¥åœ¨æµè§ˆå™¨è·‘C/C++ä»£ç  asm.js2012å¹´ï¼ŒMozilla çš„å·¥ç¨‹å¸ˆ Alon Zakaiåšäº†ä¸€ä¸ªç¼–è¯‘å™¨é¡¹ç›® Emscriptenã€‚è¿™ä¸ªç¼–è¯‘å™¨å¯ä»¥å°† C / C++ ä»£ç ç¼–è¯‘æˆ JS ä»£ç ï¼Œä½†ä¸æ˜¯æ™®é€šçš„ JSï¼Œè€Œæ˜¯ä¸€ç§å«åš asm.js çš„ JavaScript å˜ä½“ã€‚ é—®é¢˜C / C++ ç¼–è¯‘æˆ JS æœ‰ä¸¤ä¸ªæœ€å¤§çš„å›°éš¾ã€‚ C / C++ æ˜¯é™æ€ç±»å‹è¯­è¨€ï¼Œè€Œ JS æ˜¯åŠ¨æ€ç±»å‹è¯­è¨€ã€‚ C / C++ æ˜¯æ‰‹åŠ¨å†…å­˜ç®¡ç†ï¼Œè€Œ JS ä¾é åƒåœ¾å›æ”¶æœºåˆ¶ã€‚ asm.js å°±æ˜¯ä¸ºäº†è§£å†³è¿™ä¸¤ä¸ªé—®é¢˜è€Œè®¾è®¡çš„ï¼šå®ƒçš„å˜é‡ä¸€å¾‹éƒ½æ˜¯é™æ€ç±»å‹ï¼Œå¹¶ä¸”å–æ¶ˆåƒåœ¾å›æ”¶æœºåˆ¶ã€‚é™¤äº†è¿™ä¸¤ç‚¹ï¼Œå®ƒä¸ JavaScript å¹¶æ— å·®å¼‚ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œasm.js æ˜¯ JavaScript çš„ä¸€ä¸ªä¸¥æ ¼çš„å­é›†ï¼Œåªèƒ½ä½¿ç”¨åè€…çš„ä¸€éƒ¨åˆ†è¯­æ³•ã€‚ æ‰€ä»¥å¯ä»¥çœ‹åˆ° ts æ˜¯ jsçš„è¶…é›†ï¼Œasm.jsæ˜¯jsçš„å­é›† é€Ÿåº¦å¿«å¹¶ä¸”ä¸€æ—¦ JS å¼•æ“å‘ç°è¿è¡Œçš„æ˜¯ asm.jsï¼Œå°±çŸ¥é“è¿™æ˜¯ç»è¿‡ä¼˜åŒ–çš„ä»£ç ï¼Œå¯ä»¥è·³è¿‡è¯­æ³•åˆ†æè¿™ä¸€æ­¥ï¼Œç›´æ¥è½¬æˆæ±‡ç¼–è¯­è¨€ã€‚å¦å¤–ï¼Œæµè§ˆå™¨è¿˜ä¼šè°ƒç”¨ WebGL é€šè¿‡ GPU æ‰§è¡Œ asm.jsï¼Œå³ asm.js çš„æ‰§è¡Œå¼•æ“ä¸æ™®é€šçš„ JavaScript è„šæœ¬ä¸åŒã€‚è¿™äº›éƒ½æ˜¯ asm.js è¿è¡Œè¾ƒå¿«çš„åŸå› ã€‚æ®ç§°ï¼Œasm.js åœ¨æµè§ˆå™¨é‡Œçš„è¿è¡Œé€Ÿåº¦ï¼Œå¤§çº¦æ˜¯åŸç”Ÿä»£ç çš„50%å·¦å³ã€‚ Emscriptenè™½ç„¶ asm.js å¯ä»¥æ‰‹å†™ï¼Œä½†æ˜¯å®ƒä»æ¥å°±æ˜¯ç¼–è¯‘å™¨çš„ç›®æ ‡è¯­è¨€ï¼Œè¦é€šè¿‡ç¼–è¯‘äº§ç”Ÿã€‚ç›®å‰ï¼Œç”Ÿæˆ asm.js çš„ä¸»è¦å·¥å…·æ˜¯ Emscriptenã€‚ å¦‚æœè¦è·å¾—asm.jsçš„æ–‡ä»¶ï¼Œå¯ä»¥é€šè¿‡å­¦ä¹ Emscriptenï¼Œå¹¶ç”¨Emscriptenä¾¿è¡£ä½ è¦è½¬æ¢çš„C/C++æ–‡ä»¶å³å¯ å®‰è£…Emscripten çœ‹è¿™é‡Œ ä½¿ç”¨ åˆ›å»ºä¸€ä¸ªcæ–‡ä»¶ #include &lt;stdio.h> int main(){ printf(\"hello world\"); return 0; } emcc hello.c -s WASM=1 -o hello.html æ­¤æ—¶å¯ä»¥çœ‹åˆ°hello.htmlã€hello.cssã€hello.jsæ–‡ä»¶ emcc hello.c -s WASM=1 -o hello.wasm æ­¤æ—¶å¯ä»¥çœ‹åˆ°hello.wasmæ–‡ä»¶ ç¼–è¯‘ç›¸å…³ä»¥asm.jsä¸ºç¼–è¯‘ç›®æ ‡æ—¶ï¼ŒC/Cä»£ç è¢«ç¼–è¯‘ä¸º.jsæ–‡ä»¶ï¼›ä»¥WebAssemblyä¸ºç¼–è¯‘ç›®æ ‡æ—¶ï¼ŒC/Cä»£ç è¢«ç¼–è¯‘ä¸º.wasmæ–‡ä»¶åŠå¯¹åº”çš„.jsèƒ¶æ°´ä»£ç æ–‡ä»¶ã€‚ä¸¤ç§ç¼–è¯‘ç›®æ ‡ä»åº”ç”¨è§’åº¦æ¥è¯´å·®åˆ«ä¸å¤§â€”â€”å®ƒä»¬ä½¿ç”¨çš„å†…å­˜æ¨¡å‹ã€å‡½æ•°å¯¼å‡ºè§„åˆ™ã€JavaScriptä¸Cç›¸äº’è°ƒç”¨çš„æ–¹æ³•ç­‰éƒ½æ˜¯ä¸€è‡´çš„ã€‚æˆ‘ä»¬åœ¨å®é™…ä½¿ç”¨ä¸­é‡åˆ°çš„ä¸»è¦åŒºåˆ«åœ¨äºæ¨¡å—åŠ è½½çš„åŒæ­¥å’Œå¼‚æ­¥ï¼šå½“ç¼–è¯‘ç›®æ ‡ä¸ºasm.jsæ—¶ï¼Œç”±äºC/C++ä»£ç è¢«å®Œå…¨è½¬æ¢æˆäº†asm.jsï¼ˆJavaScriptå­é›†ï¼‰ï¼Œå› æ­¤å¯ä»¥è®¤ä¸ºæ¨¡å—æ˜¯åŒæ­¥åŠ è½½çš„ï¼›è€Œä»¥WebAssemblyä¸ºç¼–è¯‘ç›®æ ‡æ—¶ï¼Œç”±äºWebAssemblyçš„å®ä¾‹åŒ–æ–¹æ³•æœ¬èº«æ˜¯å¼‚æ­¥æŒ‡ä»¤ï¼Œå› æ­¤æ¨¡å—åŠ è½½ä¸ºå¼‚æ­¥åŠ è½½ã€‚ä»¥asm.jsä¸ºç›®æ ‡çš„å·¥ç¨‹åˆ‡æ¢è‡³WebAssemblyæ—¶ï¼Œå®¹æ˜“å‘ç”ŸEmscritpenè¿è¡Œæ—¶æœªå°±ç»ªæ—¶è°ƒç”¨äº†ModuleåŠŸèƒ½çš„é—®é¢˜ï¼Œéœ€è¦æŒ‰ç…§1.3.3çš„æ–¹æ³•äºˆä»¥è§„é¿ã€‚ è‡ª1.38.1èµ·ï¼ŒEmscriptené»˜è®¤çš„ç¼–è¯‘ç›®æ ‡åˆ‡æ¢ä¸ºWebAssemblyã€‚å¦‚æœä»ç„¶éœ€è¦ä»¥asm.jsä¸ºç¼–è¯‘ç›®æ ‡ï¼Œåªéœ€è¦åœ¨è°ƒç”¨emccæ—¶æ·»åŠ -s WASM=0å‚æ•°ï¼Œä¾‹å¦‚ï¼š &gt; emcc hello.cc -s WASM=0 -o hello_asm.jsWebAssemblyæ˜¯äºŒè¿›åˆ¶æ ¼å¼ï¼Œä½“ç§¯å°ã€æ‰§è¡Œæ•ˆç‡é«˜æ˜¯å…¶å…ˆå¤©ä¼˜åŠ¿ã€‚ä½œä¸ºæ¯”è¾ƒï¼Œä¸Šè¿°å‘½ä»¤ç”Ÿæˆçš„hello_asm.jsçº¦300KBï¼Œè€ŒWebAssemblyç‰ˆæœ¬çš„hello.jsä¸hello.wasmåŠ åœ¨ä¸€èµ·è¿˜ä¸åˆ°150KBã€‚åœ¨å…¼å®¹æ€§å…è®¸çš„æƒ…å†µä¸‹ï¼Œåº”å°½é‡ä½¿ç”¨WebAssemblyä½œä¸ºç¼–è¯‘ç›®æ ‡ã€‚ -oï¼šç¼–è¯‘åçš„æ–‡ä»¶ -O1ã€-O2ã€-O3ã€-Ozã€-Osã€-g ç­‰ï¼šç¼–è¯‘ä¼˜åŒ–ï¼Œå…·ä½“å¯å‚è€ƒ Emscripten å®˜ç½‘ç›¸å…³ç« èŠ‚ï¼›ï¼ˆå‹ç¼©ä»£ç ï¼‰ ç¼–è¯‘å‚æ•°-s WASM=1 (0/1/2) WASM=0ç”Ÿæˆasm.jsæ ¼å¼(é€‚ç”¨äºWebAssemblyä¸æ”¯æŒçš„æƒ…å†µ) WASM=1ç”ŸæˆåŒ…å«wasmæ ¼å¼ WASM=2 asm.jsä¸wasmæ ¼å¼å‡ç”Ÿæˆï¼Œæ·»åŠ æ”¯æŒåˆ¤å®šï¼Œä¼˜å…ˆä½¿ç”¨wasmæ ¼å¼ã€‚ æ›´å¤šå‚æ•°çœ‹ï¼š csdnæ–‡ç« ï¼šEmscripten ç¼–è¯‘å™¨(emcc) å‘½ä»¤æ€»ç»“ çŸ¥ä¹æ–‡ç« ï¼šemscripten ç¼–è¯‘å‚æ•° é‡æ–‡ç« (å‚æ•°åœ¨ç½‘é¡µä¸‹æ–¹)ï¼šä» 0 å¼€å§‹å¿«é€Ÿä¸Šæ‰‹ WebAssemblyï¼šEmscripten ä½¿ç”¨å…¥é—¨ å®˜ç½‘ï¼šç¼–è¯‘ä¸ºWebAssemblyã€ä»£ç ä¼˜åŒ– å’Œwasmçš„å¯¹æ¯”å¦‚æœä½ å¯¹ JS æ¯”è¾ƒäº†è§£ï¼Œå¯èƒ½çŸ¥é“è¿˜æœ‰ä¸€ç§å«åš WebAssembly çš„æŠ€æœ¯ï¼Œä¹Ÿèƒ½å°† C / C++ è½¬æˆ JS å¼•æ“å¯ä»¥è¿è¡Œçš„ä»£ç ã€‚é‚£ä¹ˆå®ƒä¸ asm.js æœ‰ä½•åŒºåˆ«å‘¢ï¼Ÿ å›ç­”æ˜¯ï¼Œä¸¤è€…çš„åŠŸèƒ½åŸºæœ¬ä¸€è‡´ï¼Œå°±æ˜¯è½¬å‡ºæ¥çš„ä»£ç ä¸ä¸€æ ·ï¼šasm.js æ˜¯æ–‡æœ¬ï¼ŒWebAssembly æ˜¯äºŒè¿›åˆ¶å­—èŠ‚ç ï¼Œå› æ­¤è¿è¡Œé€Ÿåº¦æ›´å¿«ã€ä½“ç§¯æ›´å°ã€‚ä»é•¿è¿œæ¥çœ‹ï¼ŒWebAssembly çš„å‰æ™¯æ›´å…‰æ˜ã€‚ ä½†æ˜¯ï¼Œè¿™å¹¶ä¸æ„å‘³ç€ asm.js è‚¯å®šä¼šè¢«æ·˜æ±°ï¼Œå› ä¸ºå®ƒæœ‰ä¸¤ä¸ªä¼˜ç‚¹ï¼šé¦–å…ˆï¼Œå®ƒæ˜¯æ–‡æœ¬ï¼Œäººç±»å¯è¯»ï¼Œæ¯”è¾ƒç›´è§‚ï¼›å…¶æ¬¡ï¼Œæ‰€æœ‰æµè§ˆå™¨éƒ½æ”¯æŒ asm.jsï¼Œä¸ä¼šæœ‰å…¼å®¹æ€§é—®é¢˜ã€‚ å‚è€ƒé˜…è¯»æ¨èï¼šå¾ˆæ£’çš„ WebAssembly åº”ç”¨ç¨‹åºçš„ç²¾é€‰åˆ—è¡¨ asm.js å’Œ Emscripten å…¥é—¨æ•™ç¨‹ C/C++é¢å‘WebAssemblyç¼–ç¨‹","categories":[{"name":"å‰ç«¯","slug":"å‰ç«¯","permalink":"https://taylor12138.github.io/categories/%E5%89%8D%E7%AB%AF/"}],"tags":[],"author":"Hello"},{"title":"Chromeæ’ä»¶å°æŒ‡å—","slug":"Chromeæ’ä»¶å°æŒ‡å—","date":"2022-05-27T16:00:00.000Z","updated":"2022-05-29T05:05:54.247Z","comments":true,"path":"2022/05/28/chrome-cha-jian-xiao-zhi-nan/","link":"","permalink":"https://taylor12138.github.io/2022/05/28/chrome-cha-jian-xiao-zhi-nan/","excerpt":"","text":"1.å¼€å§‹ é‡è¦æç¤ºï¼š Chrome å°†åœ¨æ‰€æœ‰å¹³å°ä¸Šç§»é™¤å¯¹ Chrome åº”ç”¨ç¨‹åºçš„æ”¯æŒã€‚Chrome æµè§ˆå™¨å’Œ Chrome ç½‘ä¸Šåº”ç”¨åº—å°†ç»§ç»­æ”¯æŒæ‰©å±•ã€‚é˜…è¯»å…¬å‘Šå¹¶äº†è§£æœ‰å…³è¿ç§»åº”ç”¨ç¨‹åºçš„æ›´å¤šä¿¡æ¯ã€‚ ä¹Ÿå°±æ˜¯è¯´ç°åœ¨æ›´åŠ æ¨å´‡æ’ä»¶ï¼Œè€Œä¸æ˜¯chromeåº”ç”¨ç¨‹åºï¼Œè®©æˆ‘ä»¬å¼€å§‹å­¦ä¹ æ’ä»¶å§ ä»‹ç»æ‰©å±•ç”±ä¸åŒä½†æœ‰å‡èšåŠ›çš„ç»„ä»¶ç»„æˆã€‚ç»„ä»¶å¯ä»¥åŒ…æ‹¬èƒŒæ™¯è„šæœ¬ã€å†…å®¹è„šæœ¬ã€é€‰é¡¹é¡µé¢ã€UI å…ƒç´ å’Œå„ç§é€»è¾‘æ–‡ä»¶ã€‚æ‰©å±•ç»„ä»¶æ˜¯ä½¿ç”¨ Web å¼€å‘æŠ€æœ¯åˆ›å»ºçš„ï¼šHTMLã€CSS å’Œ JavaScriptã€‚æ‰©å±•çš„ç»„ä»¶å°†å–å†³äºå…¶åŠŸèƒ½ï¼Œå¹¶ä¸”å¯èƒ½ä¸éœ€è¦æ¯ä¸ªé€‰é¡¹ã€‚ åˆ›å»ºä¸€ä¸ªæ–°ç›®å½•æ¥ä¿å­˜æ‰©å±•çš„æ–‡ä»¶å¤¹ã€‚ åˆ›å»ºä¸€ä¸ªåä¸ºmanifest.jsonå¹¶åŒ…å«ä»¥ä¸‹ä»£ç çš„æ–‡ä»¶ã€‚ { // æ’ä»¶åç§° \"name\": \"Hello Extensions\", // æ’ä»¶çš„æè¿° \"description\" : \"Base Level Extension\", // æ’ä»¶çš„ç‰ˆæœ¬ \"version\": \"1.0\", // é…ç½®æ’ä»¶ç¨‹åºçš„ç‰ˆæœ¬å·ï¼Œä¸»æµç‰ˆæœ¬æ˜¯2ï¼Œæœ€æ–°æ˜¯3 \"manifest_version\": 3 } åœ¨chromeçš„æ‹“å±•é¡µé¢æ‰“å¼€å¼€å‘è€…æ¨¡å¼ï¼šchrome://extensions/ ç„¶åé€‰æ‹© â€œLoad unpackedâ€ï¼ˆåŠ è½½å·²è§£å‹çš„æ‹“å±•ç¨‹åºï¼‰ï¼Œå¯¼å…¥åˆšæ‰æˆ‘ä»¬æ–°åˆ›å»ºçš„æ–‡ä»¶å¤¹ï¼Œç°åœ¨å°±å¯ä»¥çœ‹åˆ°æˆ‘ä»¬çš„æ–‡ä»¶äº†ï¼ï¼ ä½†æ˜¯ç°åœ¨å•¥ä¹Ÿæ²¡ç”¨ã€‚ã€‚æ­¤æ—¶æˆ‘ä»¬å¯ä»¥æ·»åŠ åå°è„šæœ¬ï¼Œè®©æˆ‘ä»¬é€šè¿‡æ·»åŠ ä¸€äº›ä»£ç æ¥å­˜å‚¨èƒŒæ™¯é¢œè‰²å€¼ã€‚ æ³¨å†Œè„šæœ¬ + æ·»åŠ å­˜å‚¨æƒé™ä¸è®¸å¤šå…¶ä»–é‡è¦ç»„ä»¶ä¸€æ ·ï¼Œåå°è„šæœ¬å¿…é¡»åœ¨æ¸…å•ä¸­æ³¨å†Œã€‚åœ¨æ¸…å•ä¸­æ³¨å†Œä¸€ä¸ªåå°è„šæœ¬ä¼šå‘Šè¯‰æ‰©å±•ç¨‹åºå¼•ç”¨å“ªä¸ªæ–‡ä»¶ï¼Œä»¥åŠè¯¥æ–‡ä»¶åº”è¯¥å¦‚ä½•è¿è¡Œã€‚ å¤§å¤šæ•° APIï¼ŒåŒ…æ‹¬å­˜å‚¨APIï¼Œå¿…é¡»&quot;permissions&quot;åœ¨æ¸…å•ä¸­çš„å­—æ®µä¸‹æ³¨å†Œï¼Œä»¥ä¾¿æ‰©å±•ä½¿ç”¨å®ƒä»¬ã€‚ { \"name\": \"Getting Started Example\", \"description\": \"Build an Extension!\", \"version\": \"1.0\", \"manifest_version\": 3, \"background\": { \"service_worker\": \"background.js\" }, \"permissions\": [ \"storage\" ] } å¥½äº†ï¼Œç°åœ¨æˆ‘ä»¬æœ‰ä¸€ä¸ªservice_workeräº†ï¼ŒChrome å°†æ‰«ææŒ‡å®šæ–‡ä»¶ä»¥è·å–å…¶ä»–è¯´æ˜ï¼Œä¾‹å¦‚å®ƒéœ€è¦ä¾¦å¬çš„é‡è¦äº‹ä»¶ã€‚ æ­¤æ—¶æˆ‘ä»¬åœ¨æ ¹ç›®å½•ä¸‹æ–°åˆ›å»ºä¸€ä¸ª background.js æ–‡ä»¶ï¼Œå¹¶ä¸”è´´ä¸Šä»£ç  // background.js let color = '#3aa757'; chrome.runtime.onInstalled.addListener(() => { chrome.storage.sync.set({ color }); console.log('Default background color set to %cgreen', `color: ${color}`); }); æ­¤æ—¶æˆ‘ä»¬åœ¨chromeæ‹“å±•é¡µé¢é‡æ–°åŠ è½½æ’ä»¶ï¼Œç„¶åè¿˜å¯ä»¥æŸ¥çœ‹åå°æ—¥å¿—ï¼ˆæŸ¥çœ‹console.logçš„ä¿¡æ¯ï¼‰ å£°æ˜ç”¨æˆ·ç•Œé¢ç±»ä¼¼äºå‰ç«¯çš„htmlæ–‡ä»¶ é¦–å…ˆåœ¨é…ç½®æ–‡ä»¶ manifest.json ä¸­å£°æ˜ actionå¯¹è±¡å¹¶è®¾ç½®popup.htmlä¸ºæ“ä½œçš„default_popup. { \"name\": \"Getting Started Example\", \"description\": \"Build an Extension!\", \"version\": \"1.0\", \"manifest_version\": 3, \"background\": { \"service_worker\": \"background.js\" }, \"permissions\": [\"storage\"], \"action\": { \"default_popup\": \"popup.html\" } } ç„¶åå†æ ¹ç›®å½•ä¸‹åˆ›å»º popup.html å¹¶ä¸”åˆ›å»º button.cssã€popup.jsåœ¨htmlä¸­å¼•å…¥ &lt;!DOCTYPE html> &lt;html> &lt;head> &lt;link rel=\"stylesheet\" href=\"button.css\"> &lt;/head> &lt;body> &lt;button id=\"changeColor\">&lt;/button> &lt;script src=\"popup.js\">&lt;/script> &lt;/body> &lt;/html> //popup.js // Initialize button with user's preferred color let changeColor = document.getElementById(\"changeColor\"); chrome.storage.sync.get(\"color\", ({ color }) => { changeColor.style.backgroundColor = color; }); /*button.css*/ button { height: 30px; width: 30px; outline: none; margin: 10px; border: none; border-radius: 2px; } button.current { box-shadow: 0 0 0 2px white, 0 0 0 4px black; } é‡æ–°åŠ è½½æ’ä»¶ æ­¤æ—¶æ’ä»¶çš„å¼¹çª—å°±ä¼šæ˜¾ç¤ºhtmlå†…å®¹ï¼ˆæˆ‘é€šè¿‡äº†jsæ–‡ä»¶ä¿®æ”¹äº†buttonçš„é¢œè‰²ï¼‰ æ·»åŠ æ‹“å±•ç¨‹åºçš„iconå·¥å…·æ å›¾æ ‡çš„åç§°ä¹ŸåŒ…å«actionåœ¨è¯¥default_iconå­—æ®µä¸­ã€‚åœ¨æ­¤å¤„ä¸‹è½½ images æ–‡ä»¶å¤¹ï¼Œè§£å‹ç¼©ï¼Œå¹¶å°†å…¶æ”¾åœ¨æ‰©å±•ç¨‹åºçš„ç›®å½•ä¸­ã€‚æ›´æ–°æ¸…å•ï¼Œä»¥ä¾¿æ‰©å±•çŸ¥é“å¦‚ä½•ä½¿ç”¨å›¾åƒã€‚ { \"name\": \"Getting Started Example\", \"description\": \"Build an Extension!\", \"version\": \"1.0\", \"manifest_version\": 3, \"background\": { \"service_worker\": \"background.js\" }, \"permissions\": [\"storage\"], \"action\": { \"default_popup\": \"popup.html\", \"default_icon\": { \"16\": \"/images/get_started16.png\", \"32\": \"/images/get_started32.png\", \"48\": \"/images/get_started48.png\", \"128\": \"/images/get_started128.png\" } } } æ‰©å±•ç¨‹åºè¿˜ä¼šåœ¨æ‰©å±•ç¨‹åºç®¡ç†é¡µé¢ã€æƒé™è­¦å‘Šå’Œç½‘ç«™å›¾æ ‡ä¸Šæ˜¾ç¤ºå›¾åƒã€‚è¿™äº›å›¾åƒåœ¨æ¸…å•ä¸­æŒ‡å®šiconsã€‚ ï¼ˆåˆ†åˆ«å¯¹åº”16ä½ã€32ä½ã€48ä½ã€128ä½çš„å›¾ï¼‰ { \"name\": \"Getting Started Example\", \"description\": \"Build an Extension!\", \"version\": \"1.0\", \"manifest_version\": 3, \"background\": { \"service_worker\": \"background.js\" }, \"permissions\": [\"storage\"], \"action\": { \"default_popup\": \"popup.html\", \"default_icon\": { \"16\": \"/images/get_started16.png\", \"32\": \"/images/get_started32.png\", \"48\": \"/images/get_started48.png\", \"128\": \"/images/get_started128.png\" } }, \"icons\": { \"16\": \"/images/get_started16.png\", \"32\": \"/images/get_started32.png\", \"48\": \"/images/get_started48.png\", \"128\": \"/images/get_started128.png\" } } é‡æ–°åŠ è½½æ’ä»¶ æ•ˆæœå±•ç¤ºï¼š æ·»åŠ äº¤äº’é€»è¾‘å°†ä»¥ä¸‹ä»£ç æ·»åŠ è‡³ popup.js ä¸­ // When the button is clicked, inject setPageBackgroundColor into current page changeColor.addEventListener(\"click\", async () => { let [tab] = await chrome.tabs.query({ active: true, currentWindow: true }); chrome.scripting.executeScript({ target: { tabId: tab.id }, function: setPageBackgroundColor, }); }); // The body of this function will be executed as a content script inside the // current page function setPageBackgroundColor() { chrome.storage.sync.get(\"color\", ({ color }) => { document.body.style.backgroundColor = color; }); } åœ¨é…ç½®æ–‡ä»¶ manifest.json ä¸­æ·»åŠ äº¤äº’çš„æƒé™ ï¼ˆæ¸…å•å°†éœ€è¦activeTabå…è®¸æ‰©å±•ä¸´æ—¶è®¿é—®å½“å‰é¡µé¢çš„scriptingæƒé™ï¼Œä»¥åŠä½¿ç”¨è„šæœ¬ APIexecuteScriptæ–¹æ³•çš„æƒé™ã€‚ï¼‰ { \"name\": \"Getting Started Example\", ... \"permissions\": [\"storage\", \"activeTab\", \"scripting\"], ... } é‡æ–°åŠ è½½æ’ä»¶ ç‚¹å‡»ç»¿è‰²buttonæ§ä»¶å°±å¯ä»¥çœ‹åˆ°ï¼š æ³¨æ„ï¼šæ‰©å±•ç¨‹åºä¸èƒ½åœ¨â€œchrome://extensionsâ€ç­‰å†…éƒ¨ Chrome é¡µé¢ä¸Šæ³¨å…¥å†…å®¹è„šæœ¬ã€‚è¯·åŠ¡å¿…åœ¨https://google.comç­‰çœŸå®ç½‘é¡µä¸Šè¯•ç”¨è¯¥æ‰©å±•ç¨‹åºã€‚ ä»¥ä¸Šå°demoçš„æ‹“å±•ç›®å‰é€šè¿‡æˆ‘ä»¬è‡ªåˆ¶çš„chromeæ’ä»¶ï¼Œåªèƒ½æŠŠå½“å‰é¡µé¢çš„æ”¹ä¸ºç»¿è‰²çš„ï¼Œç°åœ¨æˆ‘ä»¬æ·»åŠ é€‰é¡¹åˆ—è¡¨ï¼Œè®©ç”¨æˆ·å¯ä»¥ å°†èƒŒæ™¯æ”¹ä¸ºä¸åŒçš„é¢œè‰² ç»™æ’ä»¶æ·»åŠ é€‰é¡¹é¡µé¢ï¼š é¦–å…ˆåœ¨é…ç½®æ–‡ä»¶ manifest.json ä¸­æ·»åŠ  { \"name\": \"Getting Started Example\", //... \"options_page\": \"options.html\" } æ–°å»ºoptions.html å’Œ options.js &lt;!DOCTYPE html> &lt;html> &lt;head> &lt;link rel=\"stylesheet\" href=\"button.css\"> &lt;/head> &lt;body> &lt;div id=\"buttonDiv\"> &lt;/div> &lt;div> &lt;p>Choose a different background color!&lt;/p> &lt;/div> &lt;script src=\"options.js\">&lt;/script> &lt;/body> &lt;/html> let page = document.getElementById(\"buttonDiv\"); let selectedClassName = \"current\"; const presetButtonColors = [\"#3aa757\", \"#e8453c\", \"#f9bb2d\", \"#4688f1\"]; // Reacts to a button click by marking the selected button and saving // the selection function handleButtonClick(event) { // Remove styling from the previously selected color let current = event.target.parentElement.querySelector( `.${selectedClassName}` ); if (current &amp;&amp; current !== event.target) { current.classList.remove(selectedClassName); } // Mark the button as selected let color = event.target.dataset.color; event.target.classList.add(selectedClassName); chrome.storage.sync.set({ color }); } // Add a button to the page for each supplied color function constructOptions(buttonColors) { chrome.storage.sync.get(\"color\", (data) => { let currentColor = data.color; // For each color we were providedâ€¦ for (let buttonColor of buttonColors) { // â€¦create a button with that colorâ€¦ let button = document.createElement(\"button\"); button.dataset.color = buttonColor; button.style.backgroundColor = buttonColor; // â€¦mark the currently selected colorâ€¦ if (buttonColor === currentColor) { button.classList.add(selectedClassName); } // â€¦and register a listener for when that button is clicked button.addEventListener(\"click\", handleButtonClick); page.appendChild(button); } }); } // Initialize the page by constructing the color options constructOptions(presetButtonColors); æ­¤æ—¶é‡æ–°åŠ è½½chromeæ’ä»¶ï¼Œå³å¯åœ¨æ’ä»¶ä½ç½®çš„æ‹“å±•é€‰é¡¹ä¸­æ‰¾åˆ°optionsï¼Œç‚¹å‡»è¿›å…¥ï¼Œç„¶åè¿›å…¥é€‰é¡¹é¡µé¢ å‚è€ƒï¼šhttps://developer.chrome.com/docs/extensions/mv3/getstarted/ï¼ˆchromeæ’ä»¶å®˜æ–¹æ–‡æ¡£ï¼‰ å…³äºä¸€äº›æ’ä»¶çš„å¼€å‘ç»†èŠ‚ï¼Œæ¨èä¸€ç¯‡è¯¦ç»†çš„æ–‡ç« ï¼šhttps://xieyufei.com/2021/11/09/Chrome-Plugin.htmlï¼ˆå¯æƒœçš„æ˜¯è¯¥æ–‡ç« è®²çš„æ˜¯v2ç‰ˆæœ¬çš„ã€‚ã€‚ï¼‰ 2.manifest.jsonæ ¹æ®ä¸Šæ–‡å¯ä»¥çŸ¥é“ï¼Œmanifest.jsonæ˜¯ç”¨æ¥é…ç½®æˆ‘ä»¬çš„æ’ä»¶çš„é…ç½®æ–‡ä»¶ï¼Œè®©æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹ä¸€äº›é…ç½®è¯¦æƒ… åŸºç¡€é™¤äº†ä¸Šé¢æåˆ°çš„ { // æ’ä»¶åç§° \"name\": \"Hello Extensions\", // æ’ä»¶çš„æè¿° \"description\" : \"Base Level Extension\", // æ’ä»¶çš„ç‰ˆæœ¬ \"version\": \"1.0\", // é…ç½®æ’ä»¶ç¨‹åºçš„ç‰ˆæœ¬å· \"manifest_version\": 3 } ä½¿ç”¨ Manifest V3 çš„æ‰©å±•æœ‰è®¸å¤šæ–°ç‰¹æ€§å’ŒåŠŸèƒ½æ›´æ”¹ï¼š æœåŠ¡å·¥ä½œè€…æ›¿æ¢èƒŒæ™¯é¡µé¢ã€‚ ç°åœ¨ä½¿ç”¨æ–°çš„declarativeNetRequest APIå¤„ç†ç½‘ç»œè¯·æ±‚ä¿®æ”¹ã€‚ ä¸å†å…è®¸è¿œç¨‹æ‰˜ç®¡ä»£ç ï¼›æ‰©å±•åªèƒ½æ‰§è¡ŒåŒ…å«åœ¨å…¶åŒ…ä¸­çš„ JavaScriptã€‚ è®¸å¤šæ–¹æ³•éƒ½æ·»åŠ äº†Promiseæ”¯æŒï¼Œä½†ä»æ”¯æŒå›è°ƒä½œä¸ºæ›¿ä»£æ–¹æ¡ˆã€‚ï¼ˆæˆ‘ä»¬æœ€ç»ˆå°†æ”¯æŒæ‰€æœ‰é€‚å½“æ–¹æ³•çš„æ‰¿è¯ºã€‚ï¼‰ Manifest V3 ä¸­è¿˜å¼•å…¥äº†è®¸å¤šå…¶ä»–ç›¸å¯¹è¾ƒå°çš„åŠŸèƒ½æ›´æ”¹ã€‚ 2023å¹´1æœˆä»½ä¸å†æ›´æ–°v2ç‰ˆæœ¬ å¼¹çª—å¯¹äºä½¿ç”¨æ’ä»¶æ—¶ï¼Œå¼¹å‡ºçš„åƒå°çª—å£é¡µé¢ï¼Œæˆ‘ä»¬è¦è®¾ç½® å¼¹çª—æ˜¾ç¤ºçš„é¡µé¢å’Œæ’ä»¶å¼¹çª—çš„icon \"action\": { \"default_popup\": \"popup.html\", \"default_icon\": \"popup.png\" } åå°backgroundï¼ˆåå°ï¼‰å±æ€§ï¼Œç”¨äºé…ç½®chromeæ’ä»¶çš„åå°ï¼Œå®ƒæ˜¯ä¸€ä¸ªå¸¸é©»çš„é¡µé¢ï¼Œå®ƒçš„ç”Ÿå‘½å‘¨æœŸæ˜¯æ’ä»¶ä¸­æ‰€æœ‰ç±»å‹é¡µé¢ä¸­æœ€é•¿çš„ï¼›å®ƒéšç€æµè§ˆå™¨çš„æ‰“å¼€è€Œæ‰“å¼€ï¼Œéšç€æµè§ˆå™¨çš„å…³é—­è€Œå…³é—­ï¼Œæ‰€ä»¥é€šå¸¸æŠŠéœ€è¦ä¸€ç›´è¿è¡Œçš„ã€å¯åŠ¨å°±è¿è¡Œçš„ã€å…¨å±€çš„ä»£ç æ”¾åœ¨backgroundé‡Œé¢ã€‚ æ³¨æ„ï¼šManifest V3 å°†åå°é¡µé¢æ›¿æ¢ä¸º Service Workerã€‚ \"background\": { \"service_worker\": \"background.js\" } //background.js chrome.runtime.onInstalled.addListener(() => { console.log(\"æ’ä»¶å·²è¢«å®‰è£…\") }); æƒé™{ \"name\": \"My extension\", ... \"permissions\": [ \"storage\" ], ... } å­˜å‚¨æ–¹æ³•ï¼šchrome.storageå¯ä»¥ç§»æ­¥åˆ°4ç« èŠ‚è§‚çœ‹ CSPé…ç½®\"content_security_policy\": { \"extension_pages\": \"...\", \"sandbox\": \"...\" } extension_pagesæ­¤æ”¿ç­–æ¶µç›–æ‚¨çš„æ‰©å±•ç¨‹åºä¸­çš„é¡µé¢ï¼ŒåŒ…æ‹¬ html æ–‡ä»¶å’ŒæœåŠ¡äººå‘˜ã€‚ è¿™äº›é¡µé¢ç±»å‹ç”±chrome-extension://åè®®æä¾›ã€‚ä¾‹å¦‚ï¼Œæ‚¨çš„æ‰©å±•ç¨‹åºä¸­çš„ä¸€ä¸ªé¡µé¢æ˜¯chrome-extension://EXTENSION_ID/foo.html. sandboxï¼šæ­¤æ”¿ç­–æ¶µç›–æ‚¨çš„æ‰©å±•ç¨‹åºä½¿ç”¨çš„ä»»ä½•æ²™ç›’æ‰©å±•ç¨‹åºé¡µé¢ã€‚ 3.ç½‘ç»œè¯·æ±‚æ‰©å±•å¯ä»¥ä¿®æ”¹ç½‘ç»œè¯·æ±‚çš„æ–¹å¼åœ¨ Manifest V3 ä¸­å‘ç”Ÿäº†å˜åŒ–ã€‚ Manifest V3 ä¸º Promise æä¾›ä¸€æµçš„æ”¯æŒï¼šè®¸å¤šæµè¡Œçš„ API ç°åœ¨éƒ½æ”¯æŒ Promiseï¼Œæˆ‘ä»¬æœ€ç»ˆå°†åœ¨æ‰€æœ‰é€‚å½“çš„æ–¹æ³•ä¸Šæ”¯æŒ Promiseã€‚ declarativeNetRequestæ¦‚è¿°declarativeNetRequest APIï¼Œå®ƒå…è®¸æ‰©å±•ä»¥ä¿æŠ¤éšç§å’Œé«˜æ€§èƒ½çš„æ–¹å¼ä¿®æ”¹å’Œé˜»æ­¢ç½‘ç»œè¯·æ±‚ã€‚è¿™ä¸ªAPIçš„æœ¬è´¨æ˜¯ï¼š è¯¥æ‰©å±•ç¨‹åºä¸æ˜¯æ‹¦æˆªè¯·æ±‚å¹¶æŒ‰ç¨‹åºä¿®æ”¹å®ƒï¼Œè€Œæ˜¯è¦æ±‚ Chrome ä»£è¡¨å®ƒè¯„ä¼°å’Œä¿®æ”¹è¯·æ±‚ã€‚ è¯¥æ‰©å±•å£°æ˜äº†ä¸€ç»„è§„åˆ™ï¼šåŒ¹é…è¯·æ±‚çš„æ¨¡å¼å’ŒåŒ¹é…æ—¶æ‰§è¡Œçš„æ“ä½œã€‚ç„¶åæµè§ˆå™¨ä¿®æ”¹è¿™äº›è§„åˆ™å®šä¹‰çš„ç½‘ç»œè¯·æ±‚ã€‚ ä½¿ç”¨è¿™ç§å£°æ˜æ€§æ–¹æ³•å¯ä»¥æ˜¾ç€å‡å°‘å¯¹æŒä¹…ä¸»æœºæƒé™çš„éœ€æ±‚ã€‚ å¯¹äºæŸäº›ç”¨ä¾‹ï¼ˆä¾‹å¦‚é‡å®šå‘è¯·æ±‚ï¼‰ï¼ŒæŸäº›æ‰©å±•å¯èƒ½ä»éœ€è¦å¹¿æ³›çš„ä¸»æœºæƒé™ã€‚æœ‰å…³æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…æ¡ä»¶æƒé™å’Œ declarativeNetRequestã€‚ ä¸ä¹‹å‰ç‰ˆæœ¬çš„ webRequestAPI ï¼ˆv3ä¹‹å‰æ¯”å¦‚v2ï¼‰ ä¸webRequestAPIçš„æ¯”è¾ƒ declarativeNetRequest API å…è®¸åœ¨æµè§ˆå™¨æœ¬èº«ä¸­è¯„ä¼°ç½‘ç»œè¯·æ±‚ã€‚è¿™ä½¿å¾—å®ƒæ¯” webRequest API æ›´é«˜æ•ˆï¼Œåœ¨æ‰©å±•è¿‡ç¨‹ä¸­æ¯ä¸ªç½‘ç»œè¯·æ±‚éƒ½åœ¨ JavaScript ä¸­è¿›è¡Œè¯„ä¼°ã€‚ å› ä¸ºè¯·æ±‚ä¸ä¼šè¢«æ‰©å±•è¿›ç¨‹æˆªè·ï¼Œæ‰€ä»¥ declarativeNetRequest ä¸éœ€è¦æ‰©å±•æœ‰åå°é¡µé¢ï¼›ä»è€Œå‡å°‘å†…å­˜æ¶ˆè€—ã€‚ ä¸ webRequest API ä¸åŒï¼Œä½¿ç”¨ declarativeNetRequest API é˜»æ­¢æˆ–å‡çº§è¯·æ±‚åœ¨ä¸æƒé™ä¸€èµ·ä½¿ç”¨æ—¶ä¸éœ€è¦ä¸»æœºdeclarativeNetRequestæƒé™ã€‚ declarativeNetRequest API ä¸ºç”¨æˆ·æä¾›äº†æ›´å¥½çš„éšç§ï¼Œå› ä¸ºæ‰©å±•å®é™…ä¸Šæ— æ³•è¯»å–ä»£è¡¨ç”¨æˆ·å‘å‡ºçš„ç½‘ç»œè¯·æ±‚ã€‚ ä¸ webRequest API ä¸åŒï¼Œä½¿ç”¨ declarativeNetRequest API é˜»æ­¢çš„ä»»ä½•å›¾åƒæˆ– iframe éƒ½ä¼šåœ¨ DOM ä¸­è‡ªåŠ¨æŠ˜å ã€‚ åœ¨å†³å®šè¯·æ±‚æ˜¯è¢«é˜»æ­¢è¿˜æ˜¯é‡å®šå‘æ—¶ï¼ŒdeclarativeNetRequest API çš„ä¼˜å…ˆçº§é«˜äº webRequest APIï¼Œå› ä¸ºå®ƒå…è®¸åŒæ­¥æ‹¦æˆªã€‚åŒæ ·ï¼Œé€šè¿‡ declarativeNetRequest API åˆ é™¤çš„ä»»ä½•æ ‡å¤´å¯¹äº Web è¯·æ±‚æ‰©å±•éƒ½æ˜¯ä¸å¯è§çš„ã€‚ ä¸ declarativeNetRequest API ç›¸æ¯”ï¼ŒwebRequest API æ›´çµæ´»ï¼Œå› ä¸ºå®ƒå…è®¸æ‰©å±•ç¨‹åºä»¥ç¼–ç¨‹æ–¹å¼è¯„ä¼°è¯·æ±‚ã€‚ 4.å­˜å‚¨chrome.storage æè¿° ä½¿ç”¨chrome.storageAPI å­˜å‚¨ã€æ£€ç´¢å’Œè·Ÿè¸ªå¯¹ç”¨æˆ·æ•°æ®çš„æ›´æ”¹ã€‚ æƒé™ storage æ¦‚è¿°è¯¥ API å·²ç»è¿‡ä¼˜åŒ–ä»¥æ»¡è¶³æ‰©å±•çš„ç‰¹å®šå­˜å‚¨éœ€æ±‚ã€‚å®ƒæä¾›ä¸localStorage APIç›¸åŒçš„å­˜å‚¨åŠŸèƒ½ï¼Œä½†ä¸»è¦åŒºåˆ«å¦‚ä¸‹ï¼š ç”¨æˆ·æ•°æ®å¯ä»¥ä¸ Chrome åŒæ­¥ï¼ˆä½¿ç”¨storage.syncï¼‰è‡ªåŠ¨åŒæ­¥ã€‚ æ‚¨çš„æ‰©å±•ç¨‹åºçš„å†…å®¹è„šæœ¬å¯ä»¥ç›´æ¥è®¿é—®ç”¨æˆ·æ•°æ®ï¼Œè€Œæ— éœ€åå°é¡µé¢ã€‚ å³ä½¿ä½¿ç”¨æ‹†åˆ†éšèº«è¡Œä¸ºï¼Œç”¨æˆ·çš„æ‰©å±•è®¾ç½®ä¹Ÿå¯ä»¥ä¿ç•™ã€‚ å®ƒä¸æ‰¹é‡è¯»å†™æ“ä½œæ˜¯å¼‚æ­¥çš„ï¼Œå› æ­¤æ¯”é˜»å¡å’Œä¸²è¡Œæ›´å¿«localStorage APIã€‚ ç”¨æˆ·æ•°æ®å¯ä»¥å­˜å‚¨ä¸ºå¯¹è±¡ï¼ˆlocalStorage APIå°†æ•°æ®å­˜å‚¨åœ¨å­—ç¬¦ä¸²ä¸­ï¼‰ã€‚ å¯ä»¥è¯»å–ç®¡ç†å‘˜ä¸ºæ‰©å±•é…ç½®çš„ä¼ä¸šç­–ç•¥ï¼ˆä½¿ç”¨storage.managedæ¨¡å¼ï¼‰ã€‚ ä½¿ç”¨é¦–å…ˆè¦åœ¨manifest.json ä¸­å£°æ˜æƒé™ chrome.storage.sync.set({key: value}, function() { console.log('Value is set to ' + value); }); chrome.storage.sync.get(['key'], function(result) { console.log('Value currently is ' + result.key); }); æˆ–storage.localï¼š chrome.storage.local.set({key: value}, function() { console.log('Value is set to ' + value); }); chrome.storage.local.get(['key'], function(result) { console.log('Value currently is ' + result.key); }); ä½¿ç”¨æ—¶storage.syncï¼Œå¦‚æœç”¨æˆ·å¯ç”¨äº†åŒæ­¥ï¼Œå­˜å‚¨çš„æ•°æ®å°†è‡ªåŠ¨åŒæ­¥åˆ°ç”¨æˆ·ç™»å½•çš„ä»»ä½• Chrome æµè§ˆå™¨ã€‚ å½“ Chrome ç¦»çº¿æ—¶ï¼ŒChrome ä¼šåœ¨æœ¬åœ°å­˜å‚¨æ•°æ®ã€‚ä¸‹æ¬¡æµè§ˆå™¨åœ¨çº¿æ—¶ï¼ŒChrome ä¼šåŒæ­¥æ•°æ®ã€‚å³ä½¿ç”¨æˆ·ç¦ç”¨åŒæ­¥ï¼Œstorage.syncä»ç„¶å¯ä»¥å·¥ä½œã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå®ƒçš„è¡Œä¸ºå°†ä¸ ç›¸åŒstorage.localã€‚ è­¦å‘Š ä¸åº”å­˜å‚¨æœºå¯†çš„ç”¨æˆ·ä¿¡æ¯ï¼å­˜å‚¨åŒºåŸŸæœªåŠ å¯†ã€‚ å­˜å‚¨é™åˆ¶chrome.storageä¸æ˜¯ä¸€è¾†å¤§å¡è½¦ã€‚è¿™æ˜¯ä¸€ç³»åˆ—çš„ç®¡å­ã€‚å¦‚æœä½ ä¸æ˜ç™½ï¼Œé‚£äº›ç®¡å­æ˜¯å¯ä»¥è£…æ»¡çš„ï¼Œå¦‚æœä½ æŠŠä½ çš„ä¿¡æ¯å¡«æ»¡äº†ï¼Œå®ƒå°±ä¼šæ’æˆä¸€è¡Œï¼Œä»»ä½•äººæŠŠå¤§é‡çš„ææ–™æ”¾è¿›é‚£ä¸ªç®¡å­é‡Œéƒ½ä¼šå»¶è¿Ÿã€‚ localï¼šQUOTA_BYTESï¼š5242880 syncï¼šMAX_ITEMSï¼š512ï¼›QUOTA_BYTESï¼š102400 5.background -&gt; Server workeræ¦‚è¿°Manifest V2 ä¸­çš„åå°é¡µé¢è¢« Manifest V3 ä¸­çš„æœåŠ¡å·¥ä½œäººå‘˜å–ä»£ï¼šè¿™æ˜¯å½±å“å¤§å¤šæ•°æ‰©å±•çš„åŸºæœ¬æ›´æ”¹ã€‚ Service Workeræ˜¯åŸºäºäº‹ä»¶çš„ï¼Œå¹¶ä¸”ä¸äº‹ä»¶é¡µé¢ä¸€æ ·ï¼Œå®ƒä»¬ä¸ä¼šåœ¨è°ƒç”¨ä¹‹é—´æŒç»­å­˜åœ¨ã€‚æ­¤æ›´æ”¹é€šå¸¸éœ€è¦é‡æ–°è®¾è®¡ï¼Œéœ€è¦è€ƒè™‘è®¸å¤šå› ç´ ï¼šæœ‰å…³æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…ä»åå°é¡µé¢è¿ç§»åˆ°æœåŠ¡å·¥ä½œè€…ã€‚ å¯¹æ¯”v2ç‰ˆæœ¬ï¼š åœ¨ manifest.json ä¸­æ›¿æ¢background.pageæˆ–background.scriptsæ›¿æ¢ä¸ºã€‚background.service_workerè¯·æ³¨æ„ï¼Œè¯¥service_workerå­—æ®µé‡‡ç”¨å­—ç¬¦ä¸²ï¼Œè€Œä¸æ˜¯å­—ç¬¦ä¸²æ•°ç»„ã€‚ background.persistentä» manifest.json ä¸­åˆ é™¤ã€‚ æ›´æ–°åå°è„šæœ¬ä»¥é€‚åº”æœåŠ¡å·¥ä½œè€…æ‰§è¡Œä¸Šä¸‹æ–‡ã€‚ é…ç½®ï¼š { \"background\": { \"service_worker\": \"background.js\" }, } å®šæ—¶å™¨setTimeoutWeb å¼€å‘äººå‘˜ä½¿ç”¨orsetIntervalæ–¹æ³•æ‰§è¡Œå»¶è¿Ÿæˆ–å®šæœŸæ“ä½œæ˜¯å¾ˆå¸¸è§çš„ã€‚ä½†æ˜¯ï¼Œè¿™äº› API åœ¨Server workerä¸­å¯èƒ½ä¼šå¤±è´¥ï¼Œå› ä¸ºè°ƒåº¦ç¨‹åºå°†åœ¨æœåŠ¡å·¥ä½œäººå‘˜ç»ˆæ­¢æ—¶å–æ¶ˆè®¡æ—¶å™¨ã€‚ // background.js // This worked in Manifest V2. const TIMEOUT = 3 * 60 * 1000; // 3 minutes in milliseconds setTimeout(() => { chrome.action.setIcon({ path: getRandomIconPath(), }); }, TIMEOUT); ç›¸åï¼Œæˆ‘ä»¬è¦ç”¨è­¦æŠ¥API // background.js chrome.alarms.create({ delayInMinutes: 3 }); chrome.alarms.onAlarm.addListener(() => { chrome.action.setIcon({ path: getRandomIconPath(), }); }); 6.æ‰§è¡Œä»£ç åœ¨v3ä¹‹å‰ï¼ˆv2ï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥æ‰§è¡Œå¤–éƒ¨ä»£ç æˆ–ç«‹å³æ‰§è¡ŒæŸé¢„å®šä¹‰çš„ä»£ç ï¼š chrome.scripting.executeScript({code: &#39;...&#39;})ã€eval()ã€new Function() åœ¨v3ä¹‹åæˆ‘ä»¬ä¸èƒ½å†æ˜¯ä½¿ç”¨äº† åœ¨ Manifest V3 ä¸­ï¼Œæœ‰å‡ ä¸ªæ–¹æ³•ä»APIchrome.tabsè½¬ç§»ã€‚chrome.scripting æ›´æ”¹ä»¥ä¸‹ä»»ä½• Manifest V2 è°ƒç”¨ä»¥ä½¿ç”¨æ­£ç¡®çš„ Manifest V3 APIï¼š æ¸…å• V2 æ¸…å• V3 tabs.executeScript() scripting.executeScript() tabs.insertCSS() scripting.insertCSS() tabs.removeCSS() scripting.removeCSS() chromeæ’ä»¶APIæ¸…å•https://developer.chrome.com/docs/extensions/reference/","categories":[{"name":"å‰ç«¯","slug":"å‰ç«¯","permalink":"https://taylor12138.github.io/categories/%E5%89%8D%E7%AB%AF/"}],"tags":[],"author":"Hello"},{"title":"TypeScript","slug":"TypeScript","date":"2022-05-14T15:04:34.116Z","updated":"2022-05-14T15:04:34.116Z","comments":true,"path":"2022/05/14/typescript/","link":"","permalink":"https://taylor12138.github.io/2022/05/14/typescript/","excerpt":"","text":"1.ç»“è¯†TypeScriptä¼ ç»Ÿä¸Šï¼ŒJSæ—¨åœ¨ç”¨äºç®€çŸ­ï¼Œå¿«é€Ÿè¿è¡Œçš„ä»£ç ç‰‡æ®µï¼Œä½œä¸ºæµè§ˆå™¨è„šæœ¬è¯­è¨€ï¼Œä¸»è¦ç”¨é€”æ˜¯ä¸ç”¨æˆ·äº’åŠ¨ï¼Œä»¥åŠæ“ä½œDOMï¼Œæ‰€ä»¥JSæ¯”è¾ƒé€‚åˆå•çº¿ç¨‹ã€‚ ä½†æ˜¯ç”±æ­¤å¯¼è‡´åæœŸç»´æŠ¤æ€§æ¯”è¾ƒå·® é¢å‘å¯¹è±¡æ’°å†™éº»çƒ¦ æ²¡æœ‰ç±»å‹è§„èŒƒ å¾®è½¯äº2014å¹´æ¨å‡ºçš„TypeScriptä»¥JavaScriptä¸ºåŸºç¡€æ„å»ºçš„è¯­è¨€ï¼ŒJavaScriptçš„è¶…é›†ï¼ˆæ‹“å±•ï¼‰å¼•å…¥äº†ç±»å‹çš„æ¦‚å¿µï¼Œå®ƒå¯ä»¥åœ¨ä»»ä½•æ”¯æŒJSçš„å¹³å°ä¸­è¿è¡Œï¼Œä½†æ˜¯ä¸èƒ½è¢«JSè§£æå™¨ç›´æ¥æ‰§è¡Œï¼Œæ‰€ä»¥éœ€è¦æˆ‘ä»¬è¿›è¡Œç¼–è¯‘ TS -&gt; JS å¯¹æ¯”ï¼š 1.å¼•å…¥ç±»å‹ï¼Œå¯ä»¥ç†è§£ä¸ºTypeScriptä¸ºJavaScriptçš„é™æ€è¯­è¨€æ¨¡å¼ï¼Œ 2.å¢åŠ äº†ESä¸å…·å¤‡çš„æ–°ç‰¹æ€§ï¼Œæ¯”å¦‚æŠ½è±¡ç±»ã€å·¥å…·ç­‰ 3.ä¸°å¯Œçš„é…ç½®é€‰é¡¹ï¼Œå¯ä»¥é€šè¿‡é…ç½®è½¬åŒ–ä¸ºå…¼å®¹æ€§å¼ºçš„es5ã€es3è¯­æ³• TSå®˜ç½‘æ–‡æ¡£doc https://www.typescriptlang.org/ ç¯å¢ƒæ­é…1.ä¸‹è½½ and å®‰è£…Node.js 2.ä½¿ç”¨npmå®‰è£…å…¨å±€TypeScript npm i -g typescript 3.åˆ›å»ºä¸€ä¸ªtsæ–‡ä»¶ 4.ä½¿ç”¨tscå¯¹tsæ–‡ä»¶è¿›è¡Œç¼–è¯‘ è¿›å…¥tsæ–‡ä»¶ç›®å½• æ‰§è¡Œtsc xxx.ts (æ­¤æ—¶å°±ä¼šè½¬æ¢æˆjsæ–‡ä»¶ï¼Œæ„Ÿè§‰æœ‰ç‚¹lessè½¬csså†…å‘³äº†) 5.åœ¨é¡¹ç›®ä¸­ï¼Œå¯ä»¥ä½¿ç”¨webpack / ts-nodeè‡ªåŠ¨ç¼–è¯‘è½¬æ¢ ts-nodeæœ‰ç‚¹åƒnodeï¼Œæ–¹ä¾¿æˆ‘ä»¬ç›´æ¥æµ‹è¯•ä»£ç  npm i ts-node -g npm i tslib @types/node -g æ­¤æ—¶ç›´æ¥ts-node tsæ–‡ä»¶å å³å¯è¿è¡Œtsæ–‡ä»¶ 2.TypeScriptåŸºç¡€ç±»å‹é€‰æ‹© ç±»å‹ ä¾‹å­ æè¿° number 1, 2, -22 ä»»æ„æ•°å­—ï¼Œ string â€œhere we goâ€ ä»»æ„å­—ç¬¦ä¸² boolean trueã€false å¸ƒå°”å€¼trueæˆ–false å­—é¢é‡ å…¶æœ¬èº« é™åˆ¶å˜é‡çš„å€¼å°±æ˜¯è¯¥å­—é¢é‡çš„å€¼ any * ä»»æ„ç±»å‹ unknown * ç±»å‹å®‰å…¨çš„any void ç©ºå€¼ï¼ˆundefinedï¼‰ æ²¡æœ‰å€¼ï¼ˆæˆ–undefinedï¼‰ never æ²¡æœ‰å€¼ ä¸èƒ½æ˜¯ä»»ä½•å€¼ object {name:â€™Allenâ€™} ä»»æ„çš„JSå¯¹è±¡ array [1,2,3] ä»»æ„JSæ•°ç»„ tuple [4,5] å…ƒç´ ï¼ŒTSæ–°å¢ç±»å‹ï¼Œå›ºå®šé•¿åº¦æ•°ç»„ enum enum{A, B} æšä¸¾ï¼ŒTSä¸­æ–°å¢ç±»å‹ å­—é¢é‡ï¼šç›¸å½“äºå®šæ­»ä¸€ä¸ªå›ºå®šçš„å¸¸é‡ï¼Œlet a: 10ï¼Œæ­¤æ—¶aåªèƒ½èµ‹å€¼ä¸º10ã€‚ åœ¨è®¡ç®—æœºç§‘å­¦ä¸­ï¼Œå­—é¢é‡ï¼ˆliteralï¼‰æ˜¯ç”¨äºè¡¨è¾¾æºä»£ç ä¸­ä¸€ä¸ªå›ºå®šå€¼çš„è¡¨ç¤ºæ³•ï¼ˆnotationï¼‰ã€‚ anyï¼šç±»ä¼¼äºè®©TSå›å½’JSåŸç”Ÿï¼Œå¯ä»¥èµ‹å€¼ç»™ä»»æ„å˜é‡ï¼Œåº”ç”¨åœ¨ä¸€äº›ç±»å‹æ–­è¨€ä¸Šï¼ˆas anyï¼‰ï¼Œå‡½æ•°çš„å‚æ•°æœªå£°æ˜ç±»å‹ä¹Ÿæ˜¯any unknownï¼šè¡¨ç¤ºæœªçŸ¥ç±»å‹çš„å€¼ï¼Œæœ‰ç‚¹ç±»ä¼¼anyï¼Œåªèƒ½èµ‹å€¼ç»™anyå’Œunknownç±»å‹ï¼ˆä¸è®©ä½ ä¹±ä¼ äººï¼‰ã€‚å°½é‡ç”¨unknownï¼Œä¸è¦ç”¨any let a: any; a = true; //aå¯ä»¥è¡¨ä»»æ„ç±»å‹ let b: unknown; b = \"hello\" //bå¯ä»¥è¡¨ä»»æ„ç±»å‹ let s: string; s = a //é€šè¿‡ s = b //æŠ¥é”™ if(typeof b === \"string\"){ s = b //é€šè¿‡ } ç±»å‹å£°æ˜let a: number; //å£°æ˜ä¸€ä¸ªå˜é‡aï¼ŒåŒæ—¶æŒ‡å®šå®ƒçš„ç±»å‹ä¸ºnumber let b: number | string //å£°æ˜ä¸€ä¸ªå˜é‡bï¼ŒåŒæ—¶æŒ‡å®šå®ƒçš„ç±»å‹ä¸ºnumberæˆ–è€…string ç”±æ­¤ï¼Œåœ¨ä»¥åçš„ä½¿ç”¨è¿‡ç¨‹ä¸­ï¼Œaåªèƒ½ä¸ºnumberç±»å‹ // a = 'hello'; //æŠ¥é”™ï¼Œä¸èƒ½å°†ç±»å‹stringåˆ†é…ç»™ç±»å‹number a = 1; ä¸è¿‡è¿˜æ˜¯TS -&gt; JS ç¼–è¯‘æˆåŠŸï¼Œå› ä¸ºæ˜¯ä¸ºäº†è®©JSå¼€å‘äººå‘˜æ…¢æ…¢ç†Ÿæ‚‰ æœ€å¸¸ç”¨çš„ç±»å‹å£°æ˜æ–¹å¼è¿˜æ˜¯ï¼š ï¼ˆè®°ä½numberæ˜¯å°å†™ï¼‰ let a: number = 2; //å¦‚æœå˜é‡çš„å£°æ˜å’Œèµ‹å€¼æ˜¯åŒæ—¶è¿›è¡Œï¼ŒTSå¯ä»¥è‡ªåŠ¨å¯¹å˜é‡è¿›è¡Œç±»å‹æ£€æµ‹ï¼Œæœ€åå¯ä»¥ç®€åŒ–ä¸º //å› ä¸ºtypescriptä¼šå¸®æˆ‘ä»¬æ¨å¯¼å‡ºæ¥ let a = 2; å‡½æ•° è™½ç„¶åœ¨å˜é‡å£°æ˜çœ‹ä¸å‡ºæœ‰å¤šå¤§ç”¨å¤„ï¼Œä½†æ˜¯åº”ç”¨äºå‡½æ•°ä¸Šï¼Œå¤§æœ‰æ–‡ç«  JSä¸­çš„å‡½æ•°ä¸è€ƒè™‘å‚æ•°çš„ç±»å‹å’Œä¸ªæ•°ï¼Œå¾ˆå®¹æ˜“å‡ºç°é”™è¯¯ function sum(a, b) { return a + b; } console.log(sum(123, \"456\")); //123456ï¼Œä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„ç»“æœ // tsè¯­æ³• function Sum(a: number, b: number): number{ //è®¾ç½®è¿”å›å€¼ç±»å‹ä¸ºnumberï¼Œä¹Ÿå¯ä»¥ç”±TSè‡ªåŠ¨æ¨å¯¼ return a + b; } console.log(Sum(123, \"456\")); //æŠ¥é”™ // ä¼ å…¥å¤šä¸ªä¸å®šæ•°é‡çš„å‚æ•° function other(...data: number[]){ console.log(...data); } other(1, 2, 3, 5); å½“å‡½æ•°ä½œä¸ºå‚æ•°ä¼ å…¥æ—¶ï¼Œå‡½æ•°çš„ç±»å‹æ³¨è§£ä¹Ÿè¦å†™ä¸Š function bar(fn: () => void) { fn(); } å½“å‡½æ•°è¿”å›å€¼æ˜¯voidæ—¶ï¼Œå®é™…ä¸Šè¿”å›å•¥ç±»å‹éƒ½å¯ä»¥ï¼ŒTSç¼–è¯‘éƒ½é€šè¿‡ æœ‰æ—¶TSç±»å‹æ¨æ–­å¹¶ä¸èƒ½ç¡®å®šå½“å‰å‡½æ•°çš„thisæ˜¯å¦æœ‰æŒ‡å®šçš„å±æ€§ï¼Œæ­¤æ—¶æˆ‘ä»¬ç»™å’ŒTSè¯´æ˜æˆ‘ä»¬ç»™çš„thisæŒ‡å®šç±»å‹ type ThisType = { name: string }; function eating(this: ThisType) { console.log(this.name); } const info = { name: \"allen\", eating } info.eating(); voidï¼šç©ºå€¼ï¼Œå¸¸ç”¨äºè¡¨ç¤ºè¡¨ç¤ºå‡½æ•°æ²¡æœ‰è¿”å›å€¼ | è¿”å›undefined | è¿”å› null function fn(): void{}ï¼Œå¦‚æœä¸è®¾ç½®è¿”å›å€¼ä¹Ÿæ˜¯void neverï¼šç©ºå€¼ï¼Œå¸¸ç”¨äºè¡¨ç¤ºè¡¨ç¤ºå‡½æ•°æ²¡æœ‰è¿”å›ç»“æœ function fn(): never{}ï¼Œå¯ç”¨äºæ­»å¾ªç¯æˆ–è€…å‡½æ•°æŠ›å‡ºå¼‚å¸¸ï¼Œå®é™…åº”ç”¨åœ¨æ£€æµ‹ä»£ç å¯¹å‡½æ•°çš„é”™è¯¯ä¿®æ”¹ï¼Œè€Œå¯¹neverç±»å‹çš„å˜é‡èµ‹å€¼ å®˜æ–¹æ–‡æ¡£ï¼š function fn(x: string | number) { if (typeof x === \"string\") { // do something } else if (typeof x === \"number\") { // do something else } else { x; // has type 'never'! } } objectï¼š //å£°æ˜ä¸€ä¸ªå˜é‡dï¼ŒåŒæ—¶æŒ‡å®šå®ƒæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œä¸”ä¸€å®šæœ‰ä¸€ä¸ªstringç±»å‹çš„nameå±æ€§ï¼Œå¯ä»¥æœ‰å…¶ä»–æ–°çš„å¯é€‰å±æ€§ let d: { name:string, [propName: string]: any }; //æˆ–è€…ç›´æ¥ä½¿ç”¨typescriptçš„ç±»å‹æ¨æ–­ï¼Œå’Œç¬¬ä¸€ä¸ªä¸€æ · let e = { name: \"allen\", age: 18 } arrayï¼š let e: string[]; //å£°æ˜ä¸€ä¸ªå­—ç¬¦ä¸²æ•°ç»„ï¼ˆå­˜å‚¨å­—ç¬¦ä¸²ï¼‰ let arr: number[]; let arr2 = Array&lt;number> //å£°æ˜æ•°å€¼æ•°ç»„ï¼Œä¸¤ç§éƒ½å¯ä»¥ï¼Œæ¨èä¸Šä¸€ç§ï¼Œå› ä¸ºArray&lt;number>è¿™ç§å†™æ³•jsxä¼šæœ‰å†²çª tupleï¼šå…ƒç»„ï¼Œä¹Ÿå°±æ˜¯å›ºå®šé•¿åº¦çš„æ•°ç»„ï¼Œæ•ˆç‡ç›¸å¯¹æ•°ç»„å¥½ä¸€ç‚¹ ã€‚å¯ä»¥å¹¶è¡Œå¤šç§ç±»å‹ //ä¸¤ä¸ªå…ƒç´ çš„æ•°ç»„ï¼Œåˆ†åˆ«æ˜¯stringã€numberç±»å‹ let h: [string, number] = ['allen', 18]; enumï¼šæšä¸¾çš„ä½¿ç”¨ // å¹³æ—¶æˆ‘ä»¬å­˜å‚¨ç”·ã€å¥³è¿™äº›å­—ç¬¦ä¸²ï¼Œæ•°æ®åº“å ç”¨ç©ºé—´å¤§ï¼Œåƒè¿™ç§åœ¨å‡ ä¸ªå€¼ä¹‹é—´é€‰æ‹©çš„æƒ…å†µï¼Œå¯ä»¥ç”¨æšä¸¾æ›¿ä»£å­—ç¬¦ä¸² // å½“ç„¶ï¼Œæˆ‘ä»¬å¯ä»¥ä¸å†™å€¼ï¼Œæ­¤æ—¶Maleã€Femaleé»˜è®¤0ã€1 enum Gender { Male = 1, Female = 0 } let i: { name: string, gender: Gender } = { name: 'Allen', gender: Gender.Male } console.log(i.gender === Gender.Male); //true console.log(Gender['Male']); //1 console.log(Gender[1]); //Male å®šæ—¶å™¨ï¼š ç±»å‹ä¸ºNodeJS.Timeout è‡ªå®šä¹‰ç±»å‹ä¹Ÿå¯ä»¥ç§°ä¹‹ä¸ºç±»å‹åˆ«å type myType = 1 | 2 | 3 | string; let a: myType; a = 4 //æŠ¥é”™ ç±»å‹æ–­è¨€ç”¨æ¥å‘Šè¯‰è§£æå™¨å˜é‡å®é™…ç±»å‹ï¼Œç¼–è¯‘å™¨ä¸çŸ¥é“ï¼ˆæ‰€ä»¥æŠ¥é”™ï¼‰ï¼Œæˆ‘ä»¬è‡ªå·±æ˜¯çŸ¥é“çš„ï¼Œè®©å®ƒæ”¾å¿ƒä½¿ç”¨ åœ¨ tsx è¯­æ³•ï¼ˆReact çš„ jsx è¯­æ³•çš„ ts ç‰ˆï¼‰ä¸­å¿…é¡»ä½¿ç”¨å‰è€…ï¼Œå³ å€¼ as ç±»å‹ã€‚ s = b as string //é€šè¿‡ s = &lt;string>b //é€šè¿‡ åº”ç”¨ï¼š // &lt;img id=\"img\" /> const el = document.querySelector('#img') as HTMLImageElement; el.src = 'urlåœ°å€' class Person { } class Student extends Person { study() { console.log(\"studying!\"); } } const foo = (p: Person) => { (p as Student).study() } const s = new Student(); foo(s); constæ–­è¨€ å½“æˆ‘ä»¬ä½¿ç”¨å…³é”®å­— const å£°æ˜ä¸€ä¸ªå­—é¢é‡æ—¶ï¼Œç±»å‹æ˜¯ç­‰å·å³è¾¹çš„æ–‡å­—ï¼Œä¾‹å¦‚ï¼š const x = 'x'; // x has the type 'x' const å…³é”®å­—ç¡®ä¿ä¸ä¼šå‘ç”Ÿå¯¹å˜é‡è¿›è¡Œé‡æ–°åˆ†é…ï¼Œå¹¶ä¸”åªä¿è¯è¯¥å­—é¢é‡çš„ä¸¥æ ¼ç±»å‹ã€‚ ä½†æ˜¯å¦‚æœæˆ‘ä»¬ç”¨ let è€Œä¸æ˜¯ constï¼Œ é‚£ä¹ˆè¯¥å˜é‡ä¼šè¢«é‡æ–°åˆ†é…ï¼Œå¹¶ä¸”ç±»å‹ä¼šè¢«æ‰©å±•ä¸ºå­—ç¬¦ä¸²ç±»å‹ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š let x = 'x'; // x has the type string; ä½†æ˜¯letå®è´¨ä¸Šä¹Ÿå¯ä»¥ä½¿ç”¨å­—é¢é‡ç±»å‹ï¼Œè€Œå­—é¢é‡ç±»å‹çš„æ„ä¹‰åœ¨åœ¨äºç»“åˆè”åˆç±»å‹ï¼ˆæœ‰ç‚¹åƒæšä¸¾ç±»å‹ï¼‰ let x: 'left' | 'right' | 'center' = 'left'; x = 'inner'; //Ã—é”™è¯¯ constæ–­è¨€å‘Šè¯‰ç¼–è¯‘å™¨ä¸ºè¡¨è¾¾å¼æ¨æ–­å‡ºå®ƒèƒ½æ¨æ–­å‡ºçš„æœ€çª„æˆ–æœ€ç‰¹å®šçš„ç±»å‹ã€‚ æ¯”å¦‚ const option = { url: 'xxx', methods: \"POST\" } as const ä¼šè¢«æ¨æ–­ä¸ºï¼ˆæ¯ä¸ªå±æ€§éƒ½è¢«è½¬å˜ä¸ºå­—é¢é‡ç±»å‹ï¼‰ const option: { readonly url: \"xxx\"; readonly methods: \"POST\"; } å¦‚æœä¸ä½¿ç”¨å®ƒï¼Œç¼–è¯‘å™¨å°†ä½¿ç”¨å…¶é»˜è®¤ç±»å‹æ¨æ–­è¡Œä¸ºï¼ˆæ¯”å¦‚ç›´æ¥è¿›è¡Œèµ‹å€¼ let x = &quot;hello&quot;ï¼Œxè‡ªåŠ¨æ¨æ–­ä¸ºstringç±»å‹ï¼‰ï¼Œè¿™å¯èƒ½ä¼šå¯¼è‡´æ›´å¹¿æ³›æˆ–æ›´ä¸€èˆ¬çš„ç±»å‹ã€‚ const option = { url: 'xxx', methods: \"POST\" } ä¹Ÿå°±æ˜¯ä¼šè¢«æ¨æ–­ä¸º const option: { url: string; methods: string; } ç½‘ç»œä¸Šè¿˜æœ‰ä¸€ä¸ªæ¯”è¾ƒå½¢è±¡å…·ä½“çš„ä¾‹å­ï¼š const args = [8, 5]; // const args: number[] const angle = Math.atan2(...args); // error! Expected 2 arguments, but got 0 or more. console.log(angle); ä¹Ÿå¯ä»¥è§£é‡Šä¸ºï¼Œå½“å‰ç±»å‹ä¸ºnumber[]ï¼Œæ•°ç»„æ•°é‡å¯ä»¥è¢«ä¿®æ”¹ï¼Œæ‰€ä»¥æ—¶æ˜¾ç¤º â€0æˆ–æ›´å¤šâ€œ é€šè¿‡constæ–­è¨€è¿›è¡Œæ”¹åŠ¨å const args = [8, 5] as const; // const args: readonly [8, 5] const angle = Math.atan2(...args); // okay console.log(angle); ç°åœ¨ç¼–è¯‘å™¨æ¨æ–­argså±äºreadonly [8, 5]ç±»å‹ã€‚ã€‚ã€‚ä¸€ä¸ªreadonlyå…ƒç»„ï¼Œå…¶å€¼æ­£å¥½æ˜¯æŒ‰æ­¤é¡ºåºæ’åˆ—çš„æ•°å­—8å’Œ5ã€‚å…·ä½“æ¥è¯´ï¼Œargs.lengthè¢«ç¼–è¯‘å™¨ç²¾ç¡®åœ°ç§°ä¸º2ã€‚ï¼ˆçœ‹ä¸æ‡‚ readonlyå¯ä»¥æ‹†è§£ä¸º read onlyï¼Œåªè¯»çš„ï¼Œå®ƒä»…å…è®¸å¯¹æ•°ç»„ã€å…ƒç»„ä½¿ç”¨ ï¼‰ ä¹Ÿå¯ä»¥è§£é‡Šä¸ºï¼Œå½“å‰ç±»å‹ä¸º[8, 5]ï¼Œæ•°ç»„æ•°é‡å›ºå®šæ­»äº†ï¼Œä¸º2ï¼Œå‚æ•°æ•°é‡å¯ä»¥æ¥æ”¶ + é€šè¿‡ æ ‡ç¬¦å°è¯­æ³• å¯é€‰å±æ€§ å¯é€‰å±æ€§åé¢åŠ ä¸€ä¸ª ?ï¼ˆå®è´¨ä¸Šå¯é€‰å°±æ˜¯ xxç±»å‹ | undefined çš„è”åˆç±»å‹ï¼‰ //å£°æ˜ä¸€ä¸ªå˜é‡cï¼ŒåŒæ—¶æŒ‡å®šå®ƒæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œä¸”ä¸€å®šæœ‰ä¸€ä¸ªstringç±»å‹çš„nameå±æ€§ï¼Œå¯é€‰å±æ€§ageç±»å‹ä¸ºnumberï¼Œä¸èƒ½æœ‰å…¶ä»–æ–°çš„å±æ€§ //å¯é€‰å±æ€§ä¸€èˆ¬è¦æ”¾åœ¨åé¢ let c: { name: string, age?: number }; function foo(x: number, y?: number){} éç©ºç±»å‹æ–­è¨€ å½“å‰å±æ€§ä¸€å®šæœ‰å€¼ï¼Œåˆ™åŠ ä¸€ä¸ª !ï¼Œæ­¤æ—¶åœ¨å‡½æ•°é‡Œå®šä¹‰æ—¶ä¸ç”¨åšnull / undefined åˆ¤æ–­ ï¼ˆ æ¯”å¦‚messageä¸€å®šæœ‰å€¼ï¼Œåˆ™è®¾ç½®message!.length ï¼‰ï¼Œå¯ä»¥ç§°ä¹‹ä¸ºéç©ºç±»å‹æ–­è¨€ æ­¤æ—¶è·³è¿‡tsåœ¨ç¼–è¯‘é˜¶æ®µå¯¹å®ƒçš„æ£€æµ‹ å¯é€‰é“¾ å½“å¯¹è±¡å±æ€§ä¸å­˜åœ¨æ—¶ï¼Œä¼šçŸ­è·¯ï¼Œç›´æ¥è¿”å›undefined ä½¿ç”¨ï¼š a.b?.cï¼Œå¦‚æœbå±æ€§ä¸ä¸ºundefinedï¼Œç»§ç»­æŸ¥æ‰¾ c !!ï¼Œè½¬å¸ƒå°”å€¼ï¼Œç±»ä¼¼äºBoolean()ç›´æ¥è½¬ ??ï¼ŒES11æ–°å¢çš„ç‰¹æ€§ å®ƒæ˜¯ç©ºå€¼åˆå¹¶æ“ä½œç¬¦ï¼Œå½“æ“ä½œç¬¦çš„å·¦ä¾§ä¸ºnull æˆ–è€… undefinedçš„æ—¶å€™ï¼Œè¿”å›å…¶å³ä¾§æ“ä½œæ•°ï¼Œå¦åˆ™è¿”å›å·¦ä¾§æ“ä½œæ•° const message: string|null = null const content = message ?? \"hello world\" // åŒ content = message ? message : \"hello world\" // åŒ content = message || \"hello world\" TSå‡½æ•°é‡è½½å‡½æ•°çš„é‡è½½ä¸€èˆ¬æŒ‡å‡½æ•°åç§°ç›¸åŒï¼Œé€šè¿‡ä¸åŒçš„å‚æ•°è°ƒç”¨ä¸åŒçš„å‡½æ•°çš„å½¢å¼ /* *å‡½æ•°å£°æ˜å’Œå‡½æ•°å®ç°åˆ†å¼€ */ function add(num1: number, num2: number): number; //æ²¡æœ‰å‡½æ•°ä½“ function add(num1: string, num2: string): string; // æ²¡æœ‰å‡½æ•°ä½“åˆ™ä¼šæ‰§è¡Œä»¥ä¸‹å‡½æ•°ä½“çš„å®ç° // æ­¤æ—¶è¦åŒ¹é…åˆ°ä¸Šæ–¹çš„é‡è½½å‡½æ•°æ‰ä¼šæ‰§è¡Œï¼Œä¹Ÿå°±æ˜¯è¯´ä½¿ç”¨å‡½æ•°é‡è½½åï¼Œè¿™ä¸ªå®ç°å‡½æ•°ä¸èƒ½ç›´æ¥è¢«è°ƒç”¨çš„ function add(num1: any, num2: any): any { return num1 + num2 } const res = add(1, 2); const res2 = add('1', '2'); ç¼–è¯‘é€‰é¡¹æ¯ä¸€æ¬¡å¯¹TSæ–‡ä»¶è¿›è¡Œæ”¹åŠ¨ï¼Œæˆ‘ä»¬éƒ½ä¸å¾—ä¸ä½¿ç”¨ tsc xxx.tsè¿›è¡Œé‡æ–°ç¼–è¯‘ tsc xxx.ts -w -wåŠ ä¸Šåï¼Œä¼šè‡ªåŠ¨ç›‘è§†TSæ–‡ä»¶å˜åŒ–ã€‚ä½†æ˜¯ä¸€ä¸ªæ–‡ä»¶å°±å¾—å¼€ä¸€ä¸ªçª—å£è¿›è¡Œç›‘è§† å¦‚æœå½“å‰é¡¹ç›®æœ‰TSçš„é…ç½®æ–‡ä»¶ï¼ˆtsconfig.jsonï¼‰ï¼Œå¯ä»¥åœ¨å½“å‰ç›®å½•ä¸‹ç›´æ¥æ‰§è¡Œå‘½ä»¤ï¼ˆæ²¡æœ‰é…ç½®æ–‡ä»¶ç›´æ¥æ‰§è¡Œå‘½ä»¤ tsc --initå³å¯ ï¼‰ tsc #ç¼–è¯‘æ‰€æœ‰tsæ–‡ä»¶ tsc -w #ç¼–è¯‘æ‰€æœ‰TSæ–‡ä»¶ + ç›‘è§†æ‰€æœ‰TSæ–‡ä»¶çš„å˜åŒ– tsconfig.jsonæ˜¯tsç¼–è¯‘å™¨çš„é…ç½®æ–‡ä»¶ { \"include\": [ //é…ç½®äº›TSæ–‡ä»¶éœ€è¦è¢«ç¼–è¯‘ï¼Œè¿™é‡Œæ˜¯æ ¹ç›®å½•/src/ä»»æ„ç›®å½•/ä»»æ„æ–‡ä»¶ \"./src/**/*\" ], \"exclude\": [\"ndoe_modules\"], //ä¸åŒ…å«å“ªäº›æ–‡ä»¶ \"files\": [], //å’Œincludeå¾ˆåƒï¼Œåªä¸è¿‡includeåˆ—å‡ºè·¯å¾„ï¼Œfilesç›´æ¥ä¸€ä¸€åˆ—å‡ºæ–‡ä»¶ \"compilerOptions\":{ //ç¼–è¯‘å™¨é…ç½®é€‰é¡¹ \"target\": \"es5\", //targetç”¨æ¥æŒ‡å®štsè¢«ç¼–è¯‘ä¸ºESç‰ˆæœ¬ï¼Œé»˜è®¤ES3 \"module\": \"commonjs\", //moduleæŒ‡å®šæ¨¡å—åŒ–çš„è§„èŒƒ \"lib\": [], //libç”¨æ¥æŒ‡å®šé¡¹ç›®ä¸­è¦ä½¿ç”¨çš„åº“ï¼Œä½¿ç”¨åœºæ™¯ä¸€èˆ¬åœ¨éæµè§ˆå™¨ç¯å¢ƒä¸‹è¿è¡Œï¼Œæ¯”å¦‚åœ¨nodejsä¸‹æˆ‘è¦ä½¿ç”¨domï¼Œ\"lib\": [\"dom\"] \"outDir\": \"./\", //outDiræŒ‡å®šç¼–è¯‘åæ–‡ä»¶æ‰€åœ¨çš„ç›®å½• \"outDir\": \"./dist\", å­˜äºä¸ªç›®å½•ä¸‹distæ–‡ä»¶å¤¹ \"outFile\":\"./dist/app.js\", //outFile å°†ä»£ç åˆå¹¶ä¸ºä¸€ä¸ªæ–‡ä»¶ï¼Œä½†å…¶å®é¡¹ç›®å¼€å‘æ›´å¤šè®©æ‰“åŒ…å·¥å…·å»åšè¿™ä¸ªäº‹ \"allowJs\": false, //æ˜¯å¦å¯¹jsæ–‡ä»¶è¿›è¡Œç¼–è¯‘ï¼Œé»˜è®¤false \"checkJs\": false, //æ£€æŸ¥jsæ–‡ä»¶ç¬¦åˆè¯­æ³•è§„èŒƒï¼Œä¸€èˆ¬å’ŒallowJsé…å¥—ä½¿ç”¨ \"removeComments\": false, //æ˜¯å¦ç§»é™¤å¤‡æ³¨ \"noEmitOnError\": false, //å½“æœ‰é”™è¯¯æ—¶ä¸ç”Ÿæˆç¼–è¯‘åçš„æ–‡ä»¶ \"strict\":false, //æ‰€æœ‰ä¸¥æ ¼æ£€æŸ¥æ€»å¼€å…³ \"alwaysStrict\": true, //è®¾ç½®ç¼–è¯‘åJSæ–‡ä»¶æ˜¯å¦ä½¿ç”¨ä¸¥æ ¼æ¨¡å¼ï¼Œé»˜è®¤false \"noImplicitAny\": false, //ä¸å…è®¸éšå¼anyç±»å‹ \"noImplicitThis\": false, //ä¸å…è®¸ä¸æ˜ç¡®ç±»å‹this \"strictNullChecks\": false, //ä¸¥æ ¼æ£€æŸ¥ç©ºå€¼ï¼ˆæˆ–è€…å¯èƒ½æˆä¸ºç©ºå€¼çš„å˜é‡ï¼‰ \"moduleResolution\": \"node\",//æŒ‰ç…§nodeçš„æ–¹å¼å»è§£ææ¨¡å— \"skipLibCheck\": true, //è·³è¿‡ä¸€äº›åº“çš„ç±»å‹æ£€æµ‹ï¼ˆaxios->ç±»å‹ / lodash -> types/lodash / å…¶ä»–ç¬¬ä¸‰æ–¹åº“ï¼‰ //é¿å…æ‰æ— æ„ä¹‰çš„æ£€æµ‹å’Œæ€§èƒ½çš„æµªè´¹ï¼Œäº¦æˆ–è€…ä¸åŒåº“å®šä¹‰åŒåç±»å‹å¯¼è‡´çš„é”™è¯¯ \"paths\": { \"@/*\": [\"src/*\"] //è·¯å¾„è§£æ }, \"lib\": [\"esnext\", \"dom\", \"dom.iterable\", \"scripthost\"], //å¯ä»¥æŒ‡å®šåœ¨é¡¹ç›®ä¸­å¯ä»¥ä½¿ç”¨å“ªé‡Œåº“çš„ç±»å‹ } } å¤‡æ³¨ï¼š è·¯å¾„ **ï¼šä»»æ„ç›®å½• *ï¼šä»»æ„æ–‡ä»¶ exclude æœ‰é»˜è®¤å€¼ï¼Œ[â€œnode_modulesâ€, â€œbower_componentsâ€, â€œjspm_packagesâ€]ï¼Œå¦‚æœåªæƒ³æ’é™¤ä»¥ä¸Šé»˜è®¤å€¼ï¼Œå…¶å®æˆ‘ä»¬å¯ä»¥ä¸ç”¨å†™è¿™ä¸ªé…ç½® ä½¿ç”¨webpackæ‰“åŒ…TSä»£ç åˆå§‹åŒ–ç”Ÿæˆpack.jsonæ–‡ä»¶ npm init --yes å®‰è£…ç›¸å…³loaderï¼Œwebpackç­‰ npm i -D webpack webpack-cli typescript ts-loader æ–°å»ºwebpack.config.jsæ–‡ä»¶ï¼Œå¹¶ä¸”è¿›è¡Œé…ç½® const path = require('path') module.exports = { entry: \"./src/index.ts\", output: { path: path.join(__dirname, 'dist'), filename: 'bundle.js' }, module: { // æŒ‡å®šåŠ è½½è§„åˆ™ rules: [ { test: /\\.ts$/,// testæŒ‡å®šè§„åˆ™ç”Ÿæ•ˆçš„æ–‡ä»¶,ä»¥tsç»“å°¾çš„æ–‡ä»¶ use: 'ts-loader', exclude: /node_modules/ } ] } } æ–°å»º + é…ç½® TSç¼–è¯‘çš„é…ç½®æ–‡ä»¶ï¼ˆtsconfig.jsonï¼‰ äº¦æˆ–è€…æ˜¯é€šè¿‡å‘½ä»¤ tsc --init ç›´æ¥ç”Ÿæˆé»˜è®¤tsé…ç½®æ–‡ä»¶ { \"compilerOptions\": { \"module\": \"ES2015\", \"target\": \"ES2015\", \"strict\": true } } è¿™æ—¶åœ¨å‘½ä»¤çª—å£ç›´æ¥è¾“å…¥ webpackï¼Œå³å¯æˆåŠŸæ‰“åŒ… TSæ–‡ä»¶æ¨¡å—çš„è®¸å¯é…ç½®ï¼ˆwebpack.config.jsï¼‰ // ç”¨æ¥è®¾ç½®æ¨¡å—ï¼Œåªè¦jsã€tsç»“å°¾éƒ½å¯ä»¥ä½œä¸ºæ¨¡å—æ¥ä½¿ç”¨ module.exports = { //... // ç”¨æ¥è®¾ç½®æ¨¡å—ï¼Œåªè¦jsã€tsç»“å°¾éƒ½å¯ä»¥ä½œä¸ºæ¨¡å—æ¥ä½¿ç”¨ resolve:{ extensions:['.ts', '.js'] } } 3.TypeScriptå¯¹é¢å‘å¯¹è±¡çš„å»¶ä¼¸å±æ€§å°è£…å±æ€§ä¿®é¥°ç¬¦ å¦‚æœå±æ€§æ˜¯åœ¨å¯¹è±¡ä¸­è®¾ç½®ï¼Œåˆ™å±æ€§å¯ä»¥éšæ„è¢«ä¿®æ”¹ï¼Œå¯¼è‡´æ•°æ®ä¸å®‰å…¨ class Person { name: string; age: number; constructor(name: string, age: number) { this.name = name; this.age = age; } } const SpiderMan = new Person(\"SpiderMan\", 18); SpiderMan.age = -30; //è¢«éšæ„ä¿®æ”¹ TSå¯ä»¥åœ¨å±æ€§å‰æ·»åŠ ä¿®é¥°ç¬¦ publicï¼Œå¯ä»¥åœ¨ä»»æ„ä½ç½®è®¿é—® / ä¿®æ”¹ï¼Œé»˜è®¤å€¼ privateï¼Œç§æœ‰å±æ€§ï¼Œç§æœ‰å±æ€§åªèƒ½åœ¨ç±»å†…éƒ¨è¿›è¡Œè®¿é—® / ä¿®æ”¹ï¼Œå­ç±»ä¹Ÿä¸èƒ½è®¿é—® / ä¿®æ”¹ é€šè¿‡åœ¨ç±»ä¸­æ·»åŠ æ–¹æ³•ä½¿å¾—ç§æœ‰å±æ€§å¯ä»¥è¢«å¤–éƒ¨è®¿é—® ï¼ˆä½†æ˜¯å´å¯ä»¥é€šè¿‡ (å®ä¾‹as any).ç§æœ‰å±æ€§è¿›è¡Œè®¿é—®ã€‚ã€‚ä¸è¿‡æœ‰å¦å¤–ä¸€ç§è®¾ç½®ç§æœ‰çš„æ–¹å¼ï¼Œå°±æ˜¯ #å˜é‡ï¼Œå¹¶ä¸”è¿˜è¦åœ¨tsconfig.jsonå¯¹ lib ã€target è¿›è¡Œé…ç½®ï¼‰ protectedï¼Œå—ä¿æŠ¤å±æ€§ï¼Œä»…èƒ½åœ¨å½“å‰ç±» or å½“å‰ç±»çš„å­ç±»ä¸­è®¿é—® / ä¿®æ”¹ class Person { private _name: string; private _age: number; constructor(name: string, age: number) { this._name = name; this._age = age; } // ç°åœ¨æ•°æ®çš„è¯»å†™è®¿é—®æƒåœ¨æˆ‘ä»¬ç¼–ç äººå‘˜ä¸Šäº† getAge() { return this._age; } setAge(age: number) { if (age > 0) this._age = age; } // getterå’Œsetterè¢«ç§°ä¸ºå±æ€§å­˜å–å™¨ } const Bruce = new Person(\"Bruce\", 18); //console.log(Bruce._age); //æŠ¥é”™ console.log(Bruce.getAge()) è¯»å†™è¯­æ³•ç³– ä½†æ˜¯TSå†…å¸®æˆ‘ä»¬æä¾›äº†è¯»å†™å±æ€§çš„æ–¹æ³•ï¼ˆè¯­æ³•ç³–ï¼‰ å®é™…ä¸Šæ˜¯åº”ç”¨äº†Object.defineProperty()çš„getå’Œset ï¼ˆåœ¨ä½¿ç”¨getå‡½æ•°åï¼Œgetåé¢çš„å˜é‡å°†è‡ªåŠ¨ä¿å­˜ä¸ºè¯¥å®ä¾‹çš„å˜é‡ï¼Œæ¯”å¦‚ get Name()ï¼Œç„¶åç±»ä¼¼äºåœ¨ç±»é‡Œæ·»åŠ äº† this.Name,ï¼‰ TSè®¾ç½®getterã€setterçš„æ–¹å¼ä»¥ä¸‹æ‰€ç¤º class Person { private _name: string; private _age: number; constructor(name: string, age: number) { this._name = name; this._age = age; } get name() { console.log(\"æˆ‘è¢«æ‰§è¡Œäº†\"); return this._name //æ­¤æ—¶åœ¨ç±»å¤–é¢ï¼Œé€šè¿‡å®ä¾‹å¯¹è±¡.nameä¾ç„¶å¯ä»¥è·å–ï¼Œå³ä½¿è·å–æ ¼å¼çœ‹ä¼¼åƒæ˜¯å’Œä»¥å‰ç›¸åŒ // ä½†æ˜¯è·å–æ–¹å¼å·²ç»å’Œä»¥å¾€å®Œå…¨ä¸ä¸€æ ·äº†ï¼Œæ˜¯é€šè¿‡å‡½æ•°è·å–çš„ } get age() { return this._age } set age(age: number) { if (age > 0) this._age = age; } } const Bruce = new Person(\"Bruce\", 18); //å¯ä»¥ï¼Œæ­¤æ—¶.nameå¹¶ä¸æ˜¯æ‰¾å±æ€§ï¼Œè€Œæ˜¯æ‰¾æ˜¯å¦æœ‰get nameæ–¹æ³• console.log(Bruce.name); //æˆ‘è¢«æ‰§è¡Œäº† //æ•°å€¼å¤§äº0ï¼Œå¯ä»¥æ‰§è¡Œ Bruce.age = 20; å…³äºç±»å®šä¹‰å±æ€§ç®€ä¾¿å†™æ³•ï¼ˆè¯­æ³•ç³–ï¼‰ æ—§çš„ï¼š class Person { private _name: string; private _age: number; constructor(name: string, age: number) { this._name = name; this._age = age; } } æ–°çš„ï¼š class Person { constructor(private _name: string, private _age: number) {} } åªè¯»å±æ€§ åªè¯»å±æ€§åªéœ€åœ¨å‰ç¼€å¢åŠ  readonlyå³å¯ï¼Œæ­¤æ—¶æ— æ³•ç›´æ¥é€šè¿‡ å®ä¾‹.å±æ€§ è¿›è¡Œä¿®æ”¹çš„å½¢å¼è¿›è¡Œä¿®æ”¹ï¼Œä½†æ˜¯æœºåˆ¶æœ‰ç‚¹åƒconstï¼Œå´å¯ä»¥æ›´æ”¹å¼•ç”¨åœ°å€ä¸­åµŒå¥—çš„å±æ€§ ä»¥ä¸‹é˜è¿°çš„æŠ½è±¡ç±»ã€æ¥å£å‡ä¸ºTypeScriptæ–°å¢çš„ æŠ½è±¡ç±»æœ‰æ—¶å€™ï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªç±»ï¼Œä¸»è¦æ˜¯ä¸ºäº†ä½œä¸ºå¤šä¸ªç±»çš„çˆ¶ç±»ï¼Œè®©å­ç±»é€šè¿‡ç»§æ‰¿å¾—åˆ°å…±æœ‰çš„å±æ€§å’Œæ–¹æ³•ï¼Œæ¯”å¦‚åˆ›å»ºä¸€ä¸ªAnimalç±»ï¼Œç„¶åè®©Catã€Dogç±»ç»§æ‰¿Animalç±» ä»¥abstractå¼€å¤´çš„ä¸ºæŠ½è±¡ç±»ï¼ŒæŠ½è±¡ç±»å…¶å®å’Œå…¶ä»–ç±»å·®åˆ«ä¸å¤§ï¼Œåªæ˜¯ä¸èƒ½ç”¨æ¥åˆ›å»ºå¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯ä¸“é—¨ç”¨äºç»§æ‰¿çš„ç±» æŠ½è±¡ç±»ä¸­å¯ä»¥æ·»åŠ æŠ½è±¡æ–¹æ³• æŠ½è±¡æ–¹æ³•ï¼Œä½¿ç”¨abstractå¼€å¤´ï¼Œæ²¡æœ‰æ–¹æ³•ä½“ æŠ½è±¡æ–¹æ³•åªèƒ½å®šä¹‰åœ¨æŠ½è±¡ç±»ä¸­ï¼Œå­ç±»å¿…é¡»å¯¹æŠ½è±¡æ–¹æ³•è¿›è¡Œé‡å†™ abstract class Animal { name: string; constructor(name: string) { this.name = name; } abstract say(): void; } class Dog extends Animal { say() { console.log(\"gogogo\"); } } æ¥å£åœ¨typescriptåŸºç¡€ä¸­ï¼Œæˆ‘ä»¬å­¦ä¹ åˆ°äº†è‡ªå®šä¹‰ç±»å‹çš„å†™æ³•ï¼› è€Œæ¥å£å°±æ˜¯ç”¨æ¥å®šä¹‰ä¸€ä¸ªç±»çš„ç»“æ„å³ç±»ä¸­åº”è¯¥åŒ…å«å“ªäº›å±æ€§å’Œæ–¹æ³•ï¼ˆæˆ‘ä¸ªäººç†è§£ä¸ºï¼Œå®é™…ä¸Šæ¥å£ä¹Ÿå¯èƒ½çœ‹æˆä¸€ç§è‡ªå®šä¹‰ç±»å‹ï¼Œè¯¥ç±»å‹ä¸€å®šè¦åŒ…å«æ¥å£çš„è§„èŒƒï¼‰ å®é™…ä¸Šåˆä¸ä¸€å®šä»…é™äºå®šä¹‰ç±»çš„ç»“æ„ï¼Œä¹Ÿå¯ä»¥ä½œä¸ºä¸€ç§ç±»å‹å»ä½¿ç”¨ï¼Œæ¯”å¦‚ç”¨ :myInterfaceè§„èŒƒç±»å‹ï¼Œ æ‰€ä»¥æ‰å¯¼è‡´å‡ºç°type å’Œ interfaceéƒ½å¯ä»¥ä½¿ç”¨çš„åœºæ™¯ï¼Œæ‰€ä»¥æ¥å£ä¹Ÿå¯ä»¥å½“æˆç±»å‹å£°æ˜å»ä½¿ç”¨ è‡ªå®šä¹‰ç±»å‹ type myType = { name: string, age: number } const obj: myType = { name:\"allen\", age:18 } æ¥å£ // è¯¥æ¥å£è§„å®šäº†æˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªç±»ï¼Œè¯¥ç±»ä¸€å®šæœ‰ä¸¤ä¸ªå±æ€§ï¼Œä¸€ä¸ªæ˜¯nameï¼Œä¸€ä¸ªæ˜¯age interface myInterface { name: string; age:number } const obj: myInterface = { name: 'allen', age: 18 } ï¼ˆ1ï¼‰æ¥å£ VS è‡ªå®šä¹‰ç±»å‹ VSæŠ½è±¡ç±»1.æ¥å£å¯ä»¥åŒåè¿›è¡Œé‡å¤å£°æ˜ï¼šæ¯”å¦‚ä¹‹å‰å®šä¹‰äº† type myTypeï¼Œåé¢ä¸èƒ½é‡å¤å®šä¹‰è¯¥ç±»å‹ï¼›è€Œå‰é¢ä¸ªå®šä¹‰äº† interface myInterfaceï¼Œåé¢ä¾æ—§å¯ä»¥å†æ¬¡å®šä¹‰ interface myInterfaceï¼ˆè¿™ä¸¤ä¸ª myInterfaceä¼šè¿›è¡Œåˆå¹¶ï¼‰ interface myInterface{ name: string; age:number } interface myInterface{ gender:string } //ä¸¤ä¸ªä¼šå‘ç”Ÿåˆå¹¶ï¼Œè¿™ç§è¯­æ³•åœ¨TSé‡Œæ˜¯åˆç†çš„ 2.æ¥å£å¯ä»¥åœ¨å®šä¹‰ç±»çš„æ—¶å€™ï¼Œé™åˆ¶ç±»çš„ç»“æ„ï¼ˆè¿™ä¸€ç‚¹æœ‰ç‚¹åƒåœ¨ç»§æ‰¿æŠ½è±¡ç±»ï¼‰ æ¥å£ä¸­æ‰€æœ‰å±æ€§éƒ½ä¸èƒ½æœ‰å®é™…çš„å€¼ï¼ˆä½†æ˜¯æŠ½è±¡ç±»å¯ä»¥å®šä¹‰å®é™…çš„å€¼ï¼‰ æ¥å£ä¸­çš„æ–¹æ³•éƒ½æ˜¯æŠ½è±¡æ–¹æ³•ï¼ˆä½†æ˜¯æŠ½è±¡ç±»å¯ä»¥æœ‰éæŠ½è±¡æ–¹æ³•ï¼‰ å®šä¹‰ç±»æ—¶è®©ç±»å»å®ç°ï¼ˆimplementï¼‰è¿™ä¸ªæ¥å£ interface myInterface{ name: string; saySomething(): void; //æŠ½è±¡æ–¹æ³•å•Š } // å®ç°æ¥å£ï¼Œå®ç°æ¥å£å°±æ˜¯ä½¿ç±»æ»¡è¶³æ¥å£è¦æ±‚ class MyClass implements myInterface{ name: string; constructor(name:string) { this.name = name; } saySomething(): void { throw new Error(\"Method not implemented.\"); } } 3.æ¥å£å¯ä»¥å®ç°å¤šä¸ª,äº’ç›¸å®ç°,æŠ½è±¡ç±»çš„å­ç±»å´åªèƒ½ç»§æ‰¿ä¸€ä¸ªæŠ½è±¡ç±»ï¼›æŠ½è±¡ç±»åªé’ˆå¯¹ç±»ï¼Œæ¥å£å…¶å®ä¹Ÿå¯ä»¥åº”ç”¨äºå‡½æ•°ã€å±æ€§ç­‰ æ€»è€Œè¨€ä¹‹ï¼Œæ¥å£å°±ç›¸å½“äºä¸€ä¸ªè§„èŒƒï¼Œå®ç°äº†æ¥å£ï¼Œå³æ»¡è¶³äº†è§„èŒƒï¼Œå°±å¯ä»¥åœ¨æŒ‡å®šåœºæ™¯ä¸­è¿›è¡Œä½¿ç”¨ æ¨èåŠ ç‚¹ï¼š å¦‚æœæ˜¯å®šä¹‰éå¯¹è±¡ç±»å‹ï¼Œæ¨èä½¿ç”¨type å¯¹è±¡ç±»å‹æ¨èä½¿ç”¨ interface æ¥å£çš„åº”ç”¨åœºæ™¯ï¼ˆå¾ˆæ„¿æ„ä»¥æ¥å£çš„æ–¹å¼æ¥å®ç°ï¼‰ï¼š åå°æ¥å£ ç¬¬ä¸‰æ–¹å’Œå¼€å‘çš„SDKï¼Œæ¯”å¦‚Vue å‰ç«¯çš„åº“ æ­£å¸¸çš„å¼€å‘ä»»åŠ¡æ¥è¯´ï¼Œinterfaceã€typeéƒ½å·®ä¸å¤šï¼Œtypeæ›´ç›´æ¥æ›´æ–¹ä¾¿ ï¼ˆ2ï¼‰å±æ€§æ¥å£ä½¿ç”¨åœºæ™¯ï¼šæˆ‘ä»¬å¦‚æœå‘çº¦æŸä¼ å…¥å‚æ•°æ˜¯ä½œä¸ºä¸€ä¸ª stringç±»å‹ï¼Œå¯ä»¥ç›´æ¥ function fn(params: string){} ä½†å¦‚æœæˆ‘ä»¬éœ€è¦ä¼ å…¥ä¸€ä¸ªå‚æ•°ï¼Œå®ƒæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œä½†æ˜¯æˆ‘ä»¬è¦æ±‚è¿™ä¸ªå¯¹è±¡é‡Œçš„æŸä¸ªå±æ€§ï¼ˆæˆ–è€…å¤šä¸ªå±æ€§ï¼‰ï¼Œå¿…é¡»ä¸º stringç±»å‹ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å±æ€§æ¥å£ //å¯¹ä¼ å…¥å¯¹è±¡é‡Œé¢çš„å±æ€§è¿›è¡Œçº¦æŸ interface FullName{ firstName:string; lastName:string } function printName(name: FullName){} freshnessæ“¦é™¤ é€šå¸¸æƒ…å†µä¸‹ï¼Œå±æ€§æ¥å£çš„å®ç°åœ¨TSæ£€æµ‹æ—¶è¿›è¡Œç±»å‹æ¨æ–­ï¼Œå¦‚æœæœ‰å¤šå‡ºæ¥çš„å±æ€§ï¼Œåˆ™ä¸èƒ½é€šè¿‡ interface IPerson { name: string age: number } const p: IPerson = { name: 'allen', age: 18 sex: 'male' //æŠ¥é”™ } ä½†æ˜¯å¦‚æœé€šè¿‡å¼•ç”¨åœ°å€çš„æ–¹å¼è¿›è¡Œèµ‹å€¼æ—¶ï¼ŒTSæ£€æµ‹ä¼šæŠŠå¤šå‡ºæ¥çš„å±æ€§è¿›è¡Œfreshnessæ“¦é™¤æ‰ï¼Œæ­¤æ—¶è¾¾åˆ°äº†æ»¡è¶³æ¡ä»¶ï¼Œåˆ™ä¸ä¼šæŠ¥é”™ interface IPerson { name: string age: number } const info = { name: 'allen', age: 18, sex: 'male' } const p: IPerson = info å› æ­¤ä»¥ååœ¨é€šè¿‡å‡½æ•°ä¼ å…¥å‚æ•°æ—¶ï¼Œå‚æ•°æŒ‡å®šå±æ€§æ¥å£ï¼Œå¯ä»¥ç”¨å¼•ç”¨çš„æ–¹å¼ï¼Œä¼ é€’ç›¸å¯¹æ¥å£è§„å®šçš„å±æ€§çš„æœ‰å¤šä½™å±æ€§çš„å¯¹è±¡ function fn(p: IPerson) { console.log(p); } fn(info); ï¼ˆ3ï¼‰å‡½æ•°ç±»å‹æ¥å£å¯¹å‡½æ•°æ–¹æ³•è¿›è¡Œçº¦æŸ / æ‰¹é‡çº¦æŸ interface myInterface{ //å‚æ•°ä¸ºä¸¤ä¸ªstringç±»å‹ï¼Œè¿”å›å‚æ•°ä¸ºstringç±»å‹ (key:string, value:string):string } const fn: myInterface = (a: string, b: string) => a + b; ï¼ˆ4ï¼‰å¯ç´¢å¼•æ¥å£ä¹Ÿå¯ä»¥çœ‹æˆé’ˆå¯¹æ•°ç»„ã€å¯¹è±¡ç´¢å¼•çš„æ¥å£ //é’ˆå¯¹æ•°ç»„ç´¢å¼• interface myArr{ [index:number]:string } let arr:myArr = ['allen', 'bruce'] //é’ˆå¯¹å¯¹è±¡ç´¢å¼•å€¼çš„çº¦æŸ interface myObj{ [index:string]:string } let obj:myObj = {name:'allen'} ï¼ˆ5ï¼‰ç±»ç±»å‹æ¥å£//ç±»ç±»å‹æ¥å£ï¼Œä¹Ÿå°±æ˜¯æœ€ä¸Šæ–¹ç±»å¯¹æ¥å£çš„å®ç°ï¼Œå’ŒæŠ½è±¡ç±»ç±»ä¼¼ interface myClass{ name: string; action(params:String):void } interface myClass2{ //... } class Me implements myClass, myClass2{ name = 'Allen'; action() {} } ï¼ˆ6ï¼‰æ¥å£ç»§æ‰¿ä½¿ç”¨extendsï¼Œæ¥å£å¯ä»¥å®ç°å¯¹å…¶ä»–æ¥å£çš„ç»§æ‰¿ï¼Œå¯ä»¥å¯¹æ¥å£è¿›è¡Œæ‹“å±• æ³¨æ„ï¼šç±»çš„ç»§æ‰¿åªèƒ½å®ç°å•ç»§æ‰¿ï¼Œä½†æ˜¯æ¥å£å¯ä»¥å®ç°å¤šä¸ªæ¥å£ interface Animals{ eat(): void; } interface Person extends Animals{ work(): void; } //è¿™é‡Œå†å¥—ä¸€ä¸ªbabyç±»è¿›è¡Œç±»çš„ç»§æ‰¿ class baby{} class People extends baby implements Person{ eat() { } work(){} } æ³›å‹å½“å‡ºç°ç±»å‹ä¸æ˜ç¡®çš„æƒ…å†µï¼Œå¯ä»¥ä½¿ç”¨æ³›å‹ï¼ˆä¹‹å‰ä¹Ÿæåˆ°è¿‡ä½¿ç”¨anyä¸å¤ªå¥½ï¼‰ ä¹‹å‰è¿˜æåŠè¿‡unknownï¼Œè€Œæ³›å‹é’ˆå¯¹å®šä¹‰å‡½æ•°æˆ–è€…ç±»æ—¶ï¼Œå®šä¹‰çš„æ—¶å€™ç±»å‹ä¸æ˜ç¡®ï¼Œè€Œåœ¨ä½¿ç”¨çš„æ—¶å€™å†æŒ‡å®šç±»å‹çš„ä¸€ç§ç‰¹æ€§ï¼ˆä¹Ÿå¯ä»¥ç†è§£ä¸ºç±»å‹çš„å‚æ•°åŒ–ï¼‰ã€‚ æ³›å‹æ¯”anyçš„å¥½å¤„ 1.é¿å…è·³è¿‡äº†ç±»å‹æ£€æŸ¥éƒ¨åˆ† 2.åœ¨è¿™é‡Œä¹Ÿèƒ½ä½“ç°å‡ºè¿”å›å€¼ç±»å‹å’Œä¼ å…¥å‚æ•°ç±»å‹ç›¸åŒ å‡½æ•° + æ³›å‹åŸºæœ¬ä½¿ç”¨ï¼š // æŒ‡å®šäº†è‡ªå®šä¹‰çš„æ³›å‹ï¼šTï¼Œæœ‰ç‚¹åƒä¸€ä¸ªå˜é‡çš„æ„Ÿè§‰ï¼Œå³ç±»å‹çš„å˜é‡ function fn&lt;T>(a: T): T { return a; } console.log(fn(10)); //æ­¤æ—¶Tä¸ºnumberï¼Œæ­¤æ—¶æ˜¯è‡ªåŠ¨æ¨æ–­ console.log(fn&lt;string>(\"string\")); //æ­¤æ—¶Tä¸ºstringï¼Œæ­¤æ—¶æ—¶æŒ‡å®šæ¨æ–­ï¼Œè¿™ç§æ–¹å¼åº”è¯¥ç”¨çš„æ¯”è¾ƒå¤š // æŒ‡å®šå¤šä¸ªæ³›å‹ function fn2&lt;T, K>(a: T, b: K): T { console.log(`I am ${b}!`); return a; } console.log(fn2(10, \"bruce\")); // åœ¨ç±»ä¸­ä½¿ç”¨æ³›å‹ class MyClass&lt;T>{ constructor(public name: T) { }; fn(params:T) { return params; } } let c = new MyClass&lt;number>(123); let c2 = new MyClass&lt;string>('str'); å±æ€§æ¥å£ï¼ˆ + æ³›å‹ï¼‰interface IPerson&lt;T1, T2> { name: T1 age: T2 } const p: IPerson&lt;string, number> = { name:'allen', age:12 } é™åˆ¶æ³›å‹å‡å¦‚æˆ‘åªæƒ³ä¼ å…¥æŸç§æŒ‡å®šè§„æ ¼çš„æ•°æ®ï¼Œä½†æ˜¯ç”±äºæ³›å‹æ²¡æœ‰å¯¹ä¼ å…¥çš„å‚æ•°è¿›è¡Œè§„èŒƒæ ¡éªŒï¼Œå°±å¯èƒ½å¯ä»¥ä¹±ä¼ å‚æ•°è¿›å»è€Œæ²¡æœ‰è¢«ç¼–è¯‘å™¨å‘ç° æˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ¥å£å¯¹æ³›å‹ä¼ å…¥çš„å‚æ•°åŠ ä»¥è§„èŒƒ æ³›å‹ + æ¥å£è”åŠ¨å®ç°ï¼šåº”ç”¨åœºæ™¯ï¼šé™åˆ¶æ³›å‹çš„èŒƒå›´ interface myInterface { length: number } function fn3&lt;T extends myInterface>(a: T) { return a.length; } fn3(\"123\"); //å¯ä»¥é€šè¿‡ // fn3(123); //æŠ¥é”™ï¼Œå› ä¸ºè¿™ä¸ªå‚æ•°æ²¡æœ‰lengthå±æ€§ æ³›ç±»æŠŠç±»å½“ä½œå‚æ•°çš„æ³›å‹ç±» class MysqlDB&lt;T>{ add(info: T) { console.log(info); } } class User { name: string | undefined; password: string | undefined; } let u = new User(); u.name = \"Allen\"; u.password = \"123\"; æ­¤æ—¶æˆ‘åªæƒ³è®©Userä½œä¸ºä¼ å…¥addçš„å‚æ•°ï¼Œä½†æ˜¯ let db = new MysqlDB(); db.add(u); db.add(123) //ä¹Ÿå¯ä»¥,å¯¹ä¼ å…¥çš„å‚æ•°æ²¡èƒ½è¿›è¡Œé™åˆ¶ æ‰€ä»¥æˆ‘ä»¬è¦å¯¹æ­¤è¿›è¡Œçº¦æŸ let db = new MysqlDB&lt;User>(); db.add(u); db.add(123) //æŠ¥é”™ promiseåœ¨tsä¸­ä½¿ç”¨pormiseå¿…é¡»å£°æ˜å®ƒçš„è¿”å›å€¼ç±»å‹ï¼Œè€Œå®ƒçš„è¿”å›å€¼ç±»å‹é€šå¸¸å¯ä»¥ä½¿ç”¨æ³›å‹çš„å½¢å¼æ¥å£°æ˜ ä»¥Promise&lt;ç±»å‹&gt; çš„å½¢å¼ function request&lt;T>(config: AxiosRequestConfig): Promise&lt;T> { return new Promise((resolve, reject) => { this.instance .request(config) .then((res) => { console.log(res, 'requestæ–¹æ³•') resolve(res) }) .catch((err) => { reject(err) }) }) } é€šè¿‡æ³›å‹+æ³›å‹åµŒå¥—ï¼Œå®ç°çœŸæ­£çº¦æŸè¿”å›å€¼ interface IUser { account: string password: string } interface ILoginType { id: number name: string token: string } interface IDataType&lt;T = any> { code: number data: T } export function accountRequest(user: IUser) { return myRequest.request&lt;IDataType&lt;ILoginType>>({ method: 'POST' , url: loginAPI.accountAPI, data: { //... } }) } 4.TypeScriptå…¶ä»–TSæ”¯æŒä¸¤ç§æ–¹æ³•æ¥æ§åˆ¶æˆ‘ä»¬çš„ä½œç”¨åŸŸ æ¨¡å—åŒ–å¼€å‘ï¼šæ¯ä¸ªæ–‡ä»¶å¯ä»¥æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„æ¨¡å—ï¼Œæ”¯æŒES moduleï¼Œä¹Ÿæ”¯æŒCommonJS å‘½åç©ºé—´ï¼šé€šè¿‡namespaceæ¥å£°æ˜ä¸€ä¸ªå‘½åç©ºé—´ å‘½åç©ºé—´æœ‰æ—¶åœ¨åŒä¸€æ¨¡å—ä¸­æ¥å£ã€ç±»çš„åç§°æˆ–è®¸ä¼šå‘ç”Ÿå†²çªï¼ˆä¸åŒç±»ã€æ¥å£å‘½åä¸€è‡´ï¼‰æ­¤æ—¶ä¸€ä¸ªæ¨¡å—é‡Œéœ€è¦æœ‰å¤šä¸ªå‘½åç©ºé—´ import { MySQL } from './database'; //æŠ¥é”™ï¼Œå‘ç”Ÿå†²çª class MySQL{ //... } æ­¤æ—¶æˆ‘ä»¬å¯ä»¥åœ¨tsæ–‡ä»¶æœ€ä¸Šæ–¹é€šè¿‡ namespace è‡ªå®šä¹‰ç©ºé—´å ä½¿ç”¨å‘½åç©ºé—´ namespace A{ //ä»£ç å— } æ­¤æ—¶å±äºAå‘½åç©ºé—´çš„ç§æœ‰è¯¥ä»£ç å—å®šä¹‰çš„æ¥å£ã€ç±»ç­‰ å¦‚æœæˆ‘ä»¬è¦åœ¨å¤–éƒ¨ä½¿ç”¨è¯¥å‘½åç©ºé—´çš„ä¸œè¥¿ï¼Œéœ€è¦ä½¿ç”¨exportå¯¹å¤–éƒ¨è¿›è¡Œæš´éœ² namespace A{ interface Animal{ name: string eat(): void; } export class Dog implements Animal{ constructor(public name: string) { } eat(){} } } // åªèƒ½ä½¿ç”¨Dogç±»ï¼Œå› ä¸ºå…¶ä»–æ¯”å¦‚Animalæ¥å£æ²¡æœ‰æš´éœ²ï¼Œæ‰€ä»¥åœ¨å¤–é¢ä¹Ÿä¸èƒ½ä½¿ç”¨ let temp = new A.Dog('è¾¹ç‰§'); å¯¹å¤–éƒ¨æ¨¡å—ï¼ˆæ¯”å¦‚å…¶ä»–æ–‡ä»¶ä¸­ï¼‰å¯¼å‡ºè¯¥å‘½åç©ºé—´ï¼Œç›´æ¥ export namespace A{}å³å¯ ç„¶åå¤–éƒ¨æ¨¡å—è¿›è¡Œå¯¼å…¥æ—¶ import { A } from &#39;./untils/format&#39; TSå…³äºå£°æ˜çš„é—®é¢˜åœ¨TSä¸­ï¼Œå¿…é¡»åœ¨ç¼–å†™è¿‡ç¨‹ä¸­æœ‰å£°æ˜è¿‡çš„ç±»å‹ï¼Œæ‰å¯ä»¥ç›´æ¥ä½¿ç”¨ï¼ˆä¸ç„¶é€šä¸è¿‡TSç¼–è¯‘ï¼‰ï¼Œä½†æ˜¯ä¹Ÿæœ‰ä¸€äº›å…¶ä»–çš„ç±»å‹ï¼š æ¯”å¦‚documentã€axios typescriptå¯¹ç±»å‹çš„ç®¡ç†å’ŒæŸ¥æ‰¾ å†…ç½®ç±»å‹å£°æ˜ï¼ˆTSè‡ªå¸¦çš„ï¼Œæ¯”å¦‚documentï¼‰ å¤–éƒ¨å®šä¹‰ç±»å‹å£°æ˜ï¼ˆaxiosç¬¬ä¸‰æ–¹åº“å·²ç»å¸®æˆ‘ä»¬åšäº†è¿™ä¸ªç±»å‹å£°æ˜æ–‡ä»¶ï¼Œå®‰è£…axiosä¹‹åå¯ä»¥çœ‹åˆ°node_moduleæ–‡ä»¶å¤¹çš„ axios ä¸­æœ‰ index.d.ts æ–‡ä»¶ï¼‰ è‡ªå®šä¹‰ç±»å‹å£°æ˜ï¼ˆæ¯”å¦‚lodashåº“å°±æ²¡æœ‰è‡ªå¸¦çš„å¤–éƒ¨å®šä¹‰ç±»å‹å£°æ˜ï¼Œéœ€è¦è‡ªå·±è‡ªå®šä¹‰ï¼‰ å¯ä»¥å»ç¤¾åŒºæœ‰æ²¡æœ‰äººç¼–å†™å¥½å¯¹åº”çš„ç±»å‹å£°æ˜ é€šè¿‡è¿™ä¸ªç½‘å€å¾—åˆ°typeï¼Œç„¶åæ ¹æ®ç½‘å€åé¢çš„æŒ‡ç¤ºè¿›è¡Œ npm å®‰è£… å®Œå…¨è‡ªå·±ç¼–å†™ï¼Œæ–°å»ºä¸€ä¸ª xxx.d.ts æ–‡ä»¶ï¼Œé€šè¿‡declareå…³é”®å­—è¿›è¡Œå£°æ˜ //å£°æ˜æ¨¡å— declare module 'lodash' { //..ç¼–å†™éœ€è¦å£°æ˜çš„å˜é‡ã€æ–¹æ³• } //å£°æ˜å˜é‡ã€å‡½æ•° declare let Myname: string // å£°æ˜æœ‰Mynameè¿™ä¸ªå˜é‡ declare function myFn(): void // å£°æ˜æ–‡ä»¶ï¼ŒæŠŠ.jpgç»“å°¾çš„æ–‡ä»¶éƒ½å½“æˆæ¨¡å—ï¼Œå¯ä»¥é€šè¿‡ç¼–è¯‘ declare module '*.jpg' é™¤äº†.tsä»¶ï¼Œè¿˜æœ‰ .d.ts æ–‡ä»¶ï¼ˆdeclareï¼‰ï¼Œè¿™ä¸ªæ–‡ä»¶æ˜¯ç”¨æ¥åšç±»å‹å£°æ˜çš„æ–‡ä»¶ï¼Œä»–ä»…ä»…ç”¨æ¥åšç±»å‹æ£€æµ‹ï¼Œå‘ŠçŸ¥typescriptæˆ‘ä»¬æœ‰å“ªäº›ç±»å‹ï¼Œè€Œä¸ç”¨æŠ¥é”™ InstanceType&lt;Type&gt;æ„é€ ä¸€ä¸ªç”± Type ä¸­æ„é€ å‡½æ•°çš„å®ä¾‹ç±»å‹ç»„æˆçš„ç±»å‹ã€‚ ä¾‹å­ // @errors: 2344 2344 // @strict: false class C { x = 0; y = 0; } type T0 = InstanceType&lt;typeof C>; //ç›¸å½“äº type T0 = C type T1 = InstanceType&lt;any>; //ç›¸å½“äº type T1 = any type T2 = InstanceType&lt;never>; //ç›¸å½“äº type T2 = never type T3 = InstanceType&lt;string>; //æŠ¥é”™ //Type 'string' does not satisfy the constraint 'abstract new (...args: any) => any'. type T4 = InstanceType&lt;Function>; //æŠ¥é”™ //Type 'Function' does not satisfy the constraint 'abstract new (...args: any) => any'. //Type 'Function' provides no match for the signature 'new (...args: any): any'. è€Œå¯¹äºåœ¨vue3 + tsç»„ä»¶ä½¿ç”¨ä¸­ï¼Œå¯¹ç»„ä»¶å®šä¹‰å¼•ç”¨æ—¶ï¼Œåˆ™è¦ä½¿ç”¨åˆ° InstanceType&lt;Type&gt; è­¬å¦‚ const accountForm = ref&lt;InstanceType&lt;typeof ElForm>>() è¿™æ˜¯å› ä¸ºï¼Œvue3ç»„ä»¶å¯¼å‡ºæ˜¯æ˜¯ä½œä¸ºä¸€ä¸ªå¯¹è±¡ï¼ˆç»„ä»¶çš„æè¿°ï¼Œå¯ä»¥è¯´å’Œä¸€ä¸ªç±»å¾ˆåƒï¼‰ è€Œæˆ‘ä»¬æ­¤æ—¶åœ¨å¦å¤–ä¸€ä¸ªç»„ä»¶ä¸­ä½¿ç”¨è¿™ä¸ªç»„ä»¶ï¼Œæˆ‘ä»¬æ˜¯æ ¹æ®å¯¼å‡ºçš„å¯¹è±¡æ¥åˆ›å»ºä¸€ä¸ªç»„ä»¶å®ä¾‹ æ­¤æ—¶æˆ‘ä»¬ä¸å¯ä»¥ç›´æ¥ const accountForm = ref&lt;ElForm>() //x é”™è¯¯ å› ä¸ºæ­¤æ—¶ElFormæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªç±»å‹ or ç±» ä¹‹ç±»çš„ ï¼Œè€Œ InstanceType&lt;Type&gt; å¯ä»¥å¸®åŠ©æˆ‘ä»¬å°†è¿™ä¸ªå•ä¸€çš„ å¯¹è±¡ è½¬åŒ–ä¸ºä¸€ä¸ªæ‹¥æœ‰æ„é€ å‡½æ•°çš„å®ä¾‹ ä¹Ÿå¯ä»¥ç†è§£ä¸º å¯¹è±¡ç±»å‹ -&gt; è¢«å®ä¾‹åŒ–çš„å¯¹è±¡ç±»å‹ 5.è£…é¥°å™¨è£…é¥°å™¨æ˜¯ä¸€ç§ç‰¹æ®Šçš„ç±»å‹å£°æ˜ï¼Œå®ƒèƒ½å¤Ÿè¢«é™„åŠ åˆ°ç±»å£°æ˜ã€æ–¹æ³•ã€å±æ€§æˆ–å‚æ•°ä¸Šï¼Œå¯ä»¥ä¿®æ”¹ç±»çš„è¡Œä¸º é€šä¿—æ¥è®²è£…é¥°å™¨å°±æ˜¯ä¸€ä¸ªæ–¹æ³•ï¼Œå¯ä»¥æ³¨å…¥åˆ°ç±»ã€æ–¹æ³•ã€å±æ€§å‚æ•°ä¸Šæ¥æ‹“å±•ç±»ã€å±æ€§ã€æ–¹æ³•ã€å‚æ•°çš„åŠŸèƒ½ã€‚ï¼ˆæŠŠè¿™äº›ä¸œè¥¿ä¼ è¿›å»ï¼Œç„¶ååå‡ºä¸€ä¸ªæ›´å¼ºå¤§çš„å€¼ï¼‰ è£…é¥°å™¨æ˜¯è¿‡å»å‡ å¹´JSæœ€å¤§æˆå°±ä¹‹ä¸€ï¼Œå·²ç»æ˜¯ES7çš„æ ‡å‡†ç‰¹æ€§ä¹‹ä¸€ å¸¸è§çš„è£…é¥°å™¨æœ‰ç±»è£…é¥°å™¨ã€å±æ€§è£…é¥°å™¨ã€æ–¹æ³•è£…é¥°å™¨ã€å‚æ•°è£…é¥°å™¨ è£…é¥°å™¨çš„å†™æ³•ï¼š æ™®é€šè£…é¥°å™¨ï¼ˆæ— æ³•ä¼ å‚ï¼‰ è£…é¥°å™¨å·¥å‚ï¼ˆå¯ä¼ å‚ï¼‰ æ³¨æ„ è£…é¥°å™¨æ˜¯ä¸€é¡¹å®éªŒæ€§ç‰¹æ€§ï¼Œåœ¨æœªæ¥çš„ç‰ˆæœ¬ä¸­å¯èƒ½ä¼šå‘ç”Ÿæ”¹å˜ã€‚ è‹¥è¦å¯ç”¨å®éªŒæ€§çš„è£…é¥°å™¨ç‰¹æ€§ï¼Œä½ å¿…é¡»åœ¨å‘½ä»¤è¡Œæˆ–tsconfig.jsoné‡Œå¯ç”¨experimentalDecoratorsç¼–è¯‘å™¨é€‰é¡¹ï¼š tsc --target ES5 --experimentalDecorators { \"compilerOptions\": { \"target\": \"ES5\", \"experimentalDecorators\": true } } ä¸è¿‡è£…é¥°å™¨ä¹Ÿç±»ä¼¼äºå……å½“ä¸­é—´å±‚ï¼Œ@withScope.å…¶å®æœ€ç»ˆexport default çš„æ˜¯withScope(KeepAlive) åŸºæœ¬ä½¿ç”¨ ï¼ˆ1ï¼‰ç±»è£…é¥°å™¨@è£…é¥°å™¨ä¸‹ä¸€è¡Œæ¥ç±» //å®ƒåœ¨ä¸ä¿®æ”¹ç±» MyClassçš„æƒ…å†µä¸‹ï¼Œå¯¹ç±»çš„åŠŸèƒ½è¿›è¡Œäº†æ‹“å±• function logClass(target: any) { // paramså°±æ˜¯å½“å‰ç±» console.log(target); // ç°åœ¨æˆ‘ä»¬å¯ä»¥é€šè¿‡paramsæ¥æ“ä½œç±»äº† //æ‹“å±•ä¸€ä¸ªå±æ€§ params.prototype.apiURL = 'xxx'; // æ‹“å±•ä¸€ä¸ªæ–¹æ³• params.prototype.fn = () => { console.log(\"I am function!\"); } } @logClass class MyClass { constructor(public name: string) { } } ä½†æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œé€šè¿‡ @logClassçš„æ–¹å¼è¿›è¡Œè£…é¥°ï¼Œæ— æ³•ä¼ å…¥å‚æ•°ï¼ˆparamsæ˜¯é»˜è®¤ä¼ å…¥ï¼Œä¸ç®—ï¼‰ ç±»è£…é¥°å™¨ï¼ˆè£…é¥°å™¨å·¥å‚ï¼‰ï¼š å®é™…ä¸Šè¯´çš„é‚£ä¹ˆç„ä¹ï¼Œä¸è¿‡å°±æ˜¯è¿ç”¨äº†æŸ¯é‡ŒåŒ–æ–¹å¼è¿›è¡Œä¼ å‚ï¼Œç±»ä¼¼äºReactçš„å‡½æ•°ä¼ å‚æ–¹å¼ function logClass(params: string) { return function (target: any) { //è¿™é‡Œçš„targetå°±æ˜¯å½“å‰ç±»MyClassï¼Œä¹Ÿå°±æ˜¯ä¸Šæ–¹æ™®é€šè£…é¥°å™¨çš„params //ä½¿ç”¨ä¼ å…¥å‚æ•°æ¥æ‹“å±•å±æ€§ target.prototype.apiURL = params; } } @logClass('something') class MyClass { constructor(public name: string) { } } é™¤æ­¤ä¹‹å¤–ï¼Œè£…é¥°å™¨è¿˜èƒ½ä¿®æ”¹å½“å‰ç±»çš„æ„é€ å‡½æ•°ä¸‹é¢æ˜¯ä¸€ä¸ªé‡è½½æ„é€ å‡½æ•°çš„ä¾‹å­ï¼š ç±»è£…é¥°å™¨è¡¨è¾¾å¼ä¼šåœ¨è¿è¡Œæ—¶è¢«è°ƒç”¨ï¼Œç±»çš„æ„é€ å‡½æ•°ä½œä¸ºå…¶å”¯ä¸€çš„å‚æ•° å¦‚æœç±»è£…é¥°å™¨è¿”å›ä¸€ä¸ªå€¼ï¼Œå®ƒä¼šä½¿ç”¨æä¾›çš„æ„é€ å‡½æ•°æ¥æ›¿æ¢ç±»çš„å£°æ˜ function logClass(params: any) { return class extends params { name = 'I am another name'; //getDataä¹Ÿè¦è®°å¾—ä¸€èµ·é‡è½½ getData() { console.log(this.name); } //æˆ–è€…getData() { super.getData() } } } @logClass class MyClass { constructor(public name: string) { console.log('æˆ‘åœ¨æ‰§è¡Œconstructor'); console.log(name); } getData() { console.log(this.name); } } let a = new MyClass('Kobe'); a.getData(); //æˆ‘åœ¨æ‰§è¡Œconstructor //Kobe //I am another name ï¼ˆ2ï¼‰å±æ€§è£…é¥°å™¨å±æ€§è£…é¥°å™¨è¡¨è¾¾å¼ä¼šåœ¨è¿è¡Œæ—¶å½“ä½œå‡½æ•°è¢«è°ƒç”¨ï¼Œä¼ å…¥ä¸‹åˆ—ä¸¤ä¸ªå‚æ•°ï¼š å¯¹äºé™æ€æˆå‘˜æ¥è¯´æ˜¯ç±»çš„æ„é€ å‡½æ•°ï¼ˆconstructorï¼‰ï¼Œå¯¹å®ä¾‹æˆå‘˜æ¥è¯´æ˜¯ç±»çš„åŸå‹å¯¹è±¡ï¼ˆprototypeï¼‰ æˆå‘˜åå­— @è£…é¥°å™¨ä¸‹ä¸€è¡Œæ¥å±æ€§ // å±æ€§è£…é¥°å™¨ + è£…é¥°å™¨å·¥å‚ä¼ å‚ function logProperty(params: any) { return (target: any, attr: any) => { console.log(target); //MyClass {} console.log(attr); //name //ä¿®æ”¹targetï¼ˆMyClassï¼‰ç±»çš„attrï¼ˆnameï¼‰å±æ€§ //ä¸­æ‹¬å·çš„ä¸»è¦ä¼˜åŠ¿åœ¨äºå¯ä»¥é€šè¿‡å˜é‡è®¿é—®å±æ€§ target[attr] = params; } } class MyClass { // å½“å‰æœ‰ä¸€ä¸ªnameçš„å±æ€§ @logProperty('something') name: string; constructor(name: string) { this.name = name } } let a = new MyClass('Kobe'); ï¼ˆ3ï¼‰æ–¹æ³•è£…é¥°å™¨å®ƒä¼šè¢«åº”ç”¨åˆ°æ–¹æ³•çš„å±æ€§æè¿°ç¬¦ä¸Šï¼Œå¯ä»¥ç”¨æ¥ç›‘è§†ã€ä¿®æ”¹ã€æ›¿æ¢æ–¹æ³•å®šä¹‰ æ–¹æ³•è£…é¥°ä¼šåœ¨è¿è¡Œæ—¶ä¼ å…¥ä¸‹åˆ—3ä¸ªå‚æ•° å¯¹äºé™æ€æˆå‘˜æ¥è¯´æ˜¯ç±»çš„æ„é€ å‡½æ•°ï¼Œå¯¹äºå®ä¾‹æˆå‘˜æ¥è¯´æ˜¯ç±»çš„åŸå‹å¯¹è±¡ æˆå‘˜åå­— æˆå‘˜çš„å±æ€§æè¿°ç¬¦ @è£…é¥°å™¨ä¸‹ä¸€è¡Œæ¥å‡½æ•° // æ–¹æ³•è£…é¥°å™¨ function logMethod(params: any) { return (target: any, methodName: any, desc: any) => { console.log(target); //MyClass{} console.log(methodName); //fn console.log(desc); //å…³äºè¯¥å‡½æ•°çš„æè¿°ï¼ˆç‰¹æ€§ï¼‰ï¼Œæ¯”å¦‚writableã€enumerableã€configurableã€value // ä¿®æ”¹æ–¹æ³•å®ç°ï¼š æŠŠå‚æ•°è½¬ä¸ºå­—ç¬¦ä¸²å†ä¼ å…¥ //1.ä¿å­˜ä¹‹å‰æ–¹æ³• let fn = desc.value; desc.value = function(...args: any[]){ //å…ˆæŠŠå‚æ•°å…¨éƒ¨è½¬ä¸ºå­—ç¬¦ä¸² let newArgs = args.map(item => String(item)); console.log(newArgs, params); //å¤ç”¨ä¹‹å‰çš„æ–¹æ³• + ä¼ å…¥å‚æ•°ï¼Œä¿ç•™ä¹‹å‰å‡½æ•°å®šä¹‰çš„å†…å®¹ fn.apply(this,newArgs); } } } class MyClass { @logMethod('Something') fn(...args: any[]) { } } let a = new MyClass(); a.fn('123', 12345) ï¼ˆ4ï¼‰æ–¹æ³•å‚æ•°è£…é¥°å™¨å‚æ•°è£…é¥°å™¨è¡¨è¾¾å¼ä¼šåœ¨è¿è¡Œæ—¶è¢«å½“ä½œå‡½æ•°è¢«è°ƒç”¨ï¼Œå¯ä»¥ä½¿ç”¨å‚æ•°è£…é¥°å™¨ä¸ºç±»çš„åŸå‹å¢åŠ ä¸€äº›å…ƒç´ æ•°æ®ï¼Œä¼ å…¥ä¸‹åˆ—ä¸‰ä¸ªå‚æ•° å¯¹äºé™æ€æˆå‘˜æ¥è¯´æ˜¯ç±»çš„æ„é€ å‡½æ•°ï¼Œå¯¹äºå®ä¾‹æˆå‘˜æ¥è¯´æ˜¯ç±»çš„åŸå‹å¯¹è±¡ ä¼ å…¥å‚æ•°çš„æ–¹æ³•åå­— å‚æ•°åœ¨å‡½æ•°å‚æ•°åˆ—è¡¨ä¸­çš„ç´¢å¼• // å‚æ•°è£…é¥°å™¨ + è£…é¥°å™¨å·¥å‚ä¼ å‚ function logParams(params: any) { return (target: any, methodName: any, paramsIndex: any) => { console.log(target); //MyClass{} console.log(methodName); //fn console.log(paramsIndex);//0 } } class MyClass { fn(@logParams(123) id: number) { } } let a = new MyClass(); è£…é¥°å™¨æ‰§è¡Œé¡ºåºï¼šåœ¨TypeScriptä¸­ï¼Œè£…é¥°å™¨çš„æ‰§è¡Œé¡ºåºä¸ºï¼šé¦–å…ˆæ‰§è¡Œå±æ€§è£…é¥°å™¨ï¼Œç„¶åæ‰§è¡Œæ–¹æ³•è£…é¥°å™¨ï¼Œå…¶æ¬¡æ˜¯æ–¹æ³•å‚æ•°è£…é¥°å™¨ï¼Œæœ€åæ˜¯ç±»è£…é¥°å™¨ã€‚å¦‚æœåŒä¸€ä¸ªç±»å‹çš„è£…é¥°å™¨æœ‰å¤šä¸ªï¼Œæ€»æ˜¯å…ˆæ‰§è¡Œåé¢çš„è£…é¥°å™¨ã€‚","categories":[{"name":"å‰ç«¯","slug":"å‰ç«¯","permalink":"https://taylor12138.github.io/categories/%E5%89%8D%E7%AB%AF/"}],"tags":[],"author":"Hello"},{"title":"å¾®æœåŠ¡","slug":"å¾®æœåŠ¡","date":"2022-05-09T16:00:00.000Z","updated":"2023-04-13T08:09:13.144Z","comments":true,"path":"2022/05/10/wei-fu-wu/","link":"","permalink":"https://taylor12138.github.io/2022/05/10/wei-fu-wu/","excerpt":"","text":"1.å¾®æœåŠ¡æ¦‚å¿µå¾®æœåŠ¡ï¼šå¾®æœåŠ¡æ¶æ„ï¼ˆé€šå¸¸ç®€ç§°ä¸ºå¾®æœåŠ¡ï¼‰æ˜¯æŒ‡å¼€å‘åº”ç”¨æ‰€ç”¨çš„ä¸€ç§æ¶æ„å½¢å¼ã€‚é€šè¿‡å¾®æœåŠ¡ï¼Œå¯å°†å¤§å‹åº”ç”¨åˆ†è§£æˆå¤šä¸ªç‹¬ç«‹çš„ç»„ä»¶ï¼Œå…¶ä¸­æ¯ä¸ªç»„ä»¶éƒ½æœ‰å„è‡ªçš„è´£ä»»é¢†åŸŸã€‚åœ¨å¤„ç†ä¸€ä¸ªç”¨æˆ·è¯·æ±‚æ—¶ï¼ŒåŸºäºå¾®æœåŠ¡çš„åº”ç”¨å¯èƒ½ä¼šè°ƒç”¨è®¸å¤šå†…éƒ¨å¾®æœåŠ¡æ¥å…±åŒç”Ÿæˆå…¶å“åº”ã€‚ é€šå¸¸è·Ÿå¾®æœåŠ¡ç›¸å¯¹çš„æ˜¯å•ä½“åº”ç”¨ï¼Œå³å°†æ‰€æœ‰åŠŸèƒ½éƒ½æ‰“åŒ…æˆåœ¨ä¸€ä¸ªç‹¬ç«‹å•å…ƒçš„åº”ç”¨ç¨‹åºã€‚ä»å•ä½“åº”ç”¨åˆ°å¾®æœåŠ¡å¹¶ä¸æ˜¯ä¸€è¹´è€Œå°±çš„ï¼Œè¿™æ˜¯ä¸€ä¸ªé€æ¸æ¼”å˜çš„è¿‡ç¨‹ çŸ¥ä¹ä¸Šä¸€ä¸ªå°æ¡ˆä¾‹åŠ æ·±å°è±¡ï¼šhttps://www.zhiimportmaphu.com/question/65502802 ä¸ªäººçš„ç†è§£æ˜¯å°†æ‹†åˆ†çš„æ€æƒ³è´¯å½»åˆ°åº•ï¼ˆæ¨¡å—ä¹Ÿæ˜¯æ‹†ï¼æ•°æ®åº“ä¹Ÿæ˜¯æ‹†ï¼ï¼‰ï¼Œåˆ†å·¥æ˜ç¡®ï¼Œå°†æ¯ä¸ªåŠŸèƒ½ç»†è‡´åŒ–åˆ†é…ä»»åŠ¡ã€‚å†åŠ ä¸Šå…¼å®¹ä¸€ä¸‹è€åº”ç”¨çš„é€»è¾‘ï¼Œå’Œæ–°æ¡†æ¶å¼€å‘çš„ä»£ç çš„ä¸€å¥—æ¶æ„ç†å¿µ ä½†æ˜¯ç¼ºç‚¹å°±æ˜¯ï¼šåœ¨å¾®æœåŠ¡æ¶æ„ä¸­ï¼Œä¸€ä¸ªæœåŠ¡æ•…éšœå¯èƒ½ä¼šäº§ç”Ÿé›ªå´©æ•ˆç”¨ï¼Œå¯¼è‡´æ•´ä¸ªç³»ç»Ÿæ•…éšœ å¾®æœåŠ¡æ¶æ„æ•´ä¸ªåº”ç”¨åˆ†æ•£æˆå¤šä¸ªæœåŠ¡ï¼Œå®šä½æ•…éšœç‚¹éå¸¸å›°éš¾ã€‚ ç¨³å®šæ€§ä¸‹é™ã€‚æœåŠ¡æ•°é‡å˜å¤šå¯¼è‡´å…¶ä¸­ä¸€ä¸ªæœåŠ¡å‡ºç°æ•…éšœçš„æ¦‚ç‡å¢å¤§ï¼Œå¹¶ä¸”ä¸€ä¸ªæœåŠ¡æ•…éšœå¯èƒ½å¯¼è‡´æ•´ä¸ªç³»ç»ŸæŒ‚æ‰ã€‚äº‹å®ä¸Šï¼Œåœ¨å¤§è®¿é—®é‡çš„ç”Ÿäº§åœºæ™¯ä¸‹ï¼Œæ•…éšœæ€»æ˜¯ä¼šå‡ºç°çš„ã€‚ æœåŠ¡æ•°é‡éå¸¸å¤šï¼Œéƒ¨ç½²ã€ç®¡ç†çš„å·¥ä½œé‡å¾ˆå¤§ã€‚ å¼€å‘æ–¹é¢ï¼šå¦‚ä½•ä¿è¯å„ä¸ªæœåŠ¡åœ¨æŒç»­å¼€å‘çš„æƒ…å†µä¸‹ä»ç„¶ä¿æŒååŒåˆä½œã€‚ æµ‹è¯•æ–¹é¢ï¼šæœåŠ¡æ‹†åˆ†åï¼Œå‡ ä¹æ‰€æœ‰åŠŸèƒ½éƒ½ä¼šæ¶‰åŠå¤šä¸ªæœåŠ¡ã€‚åŸæœ¬å•ä¸ªç¨‹åºçš„æµ‹è¯•å˜ä¸ºæœåŠ¡é—´è°ƒç”¨çš„æµ‹è¯•ã€‚æµ‹è¯•å˜å¾—æ›´åŠ å¤æ‚ã€‚ æ‰€ä»¥ä½¿ç”¨å¾®æœåŠ¡çš„æ¶æ„è¦æœ‰è¦æœ‰å¼ºå¤§çš„ç›‘æ§ä½“ç³» 2.æ²™ç®±(sand box)ä¼ ç»Ÿæ„ä¹‰ä¸Šï¼šSandboxï¼ˆæ²™ç®±ï¼‰æ˜¯æŒ‡ä¸€ç§æŠ€æœ¯ï¼Œåœ¨è¿™ç§æŠ€æœ¯ä¸­ï¼Œè½¯ä»¶è¿è¡Œåœ¨æ“ä½œç³»ç»Ÿå—é™åˆ¶çš„ç¯å¢ƒä¸­ã€‚ç”±äºè¯¥è½¯ä»¶åœ¨å—é™åˆ¶çš„ç¯å¢ƒä¸­è¿è¡Œï¼Œå³ä½¿ä¸€ä¸ªé—¯å…¥è¯¥è½¯ä»¶çš„å…¥ä¾µè€…ä¹Ÿä¸èƒ½æ— é™åˆ¶è®¿é—®æ“ä½œç³»ç»Ÿæä¾›è®¾æ–½ï¼›è·å¾—è¯¥è½¯ä»¶æ§åˆ¶æƒçš„é»‘å®¢é€ æˆçš„æŸå¤±ä¹Ÿæ˜¯æœ‰é™çš„ ç„¶è€Œï¼Œåœ¨è®¡ç®—æœºå®‰å…¨ä¸­ï¼Œæ²™ç®±ï¼ˆSandboxï¼‰æ˜¯ä¸€ç§ç”¨äºéš”ç¦»æ­£åœ¨è¿è¡Œç¨‹åºçš„å®‰å…¨æœºåˆ¶ï¼Œé€šå¸¸ç”¨äºæ‰§è¡Œæœªç»æµ‹è¯•æˆ–ä¸å—ä¿¡ä»»çš„ç¨‹åºæˆ–ä»£ç ï¼Œå®ƒä¼šä¸ºå¾…æ‰§è¡Œçš„ç¨‹åºåˆ›å»ºä¸€ä¸ªç‹¬ç«‹çš„æ‰§è¡Œç¯å¢ƒï¼Œå†…éƒ¨ç¨‹åºçš„æ‰§è¡Œä¸ä¼šå½±å“åˆ°å¤–éƒ¨ç¨‹åºçš„è¿è¡Œ æŠ½è±¡åŒ–ï¼šå¯¹äºæ“ä½œç³»ç»Ÿæ¥è¯´ï¼Œæµè§ˆå™¨å°±æ˜¯ä¸€ä¸ªæ²™ç®±ï¼Œå¯¹äºæµè§ˆå™¨æ¥è¯´ï¼Œæ¯ä¸ªé¡µé¢å°±æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„æ²™ç®± å®é™…è¿ç”¨ï¼š Vue æ¨¡æ¿è¡¨è¾¾å¼çš„è®¡ç®—æ˜¯è¿è¡Œåœ¨ä¸€ä¸ªæ²™ç›’ä¹‹ä¸­çš„ï¼Œåœ¨æ¨¡æ¿å­—ç¬¦ä¸²ä¸­çš„è¡¨è¾¾å¼åªèƒ½è·å–éƒ¨åˆ†å…¨å±€å¯¹è±¡ï¼Œè¿™ä¸€ç‚¹å®˜æ–¹æ–‡æ¡£æœ‰æåˆ°ï¼Œè¯¦æƒ…å¯å‚é˜…æºç ã€‚ CodeSanbox ï¼Œåœ¨çº¿ç¼–è¾‘å™¨ è®¸å¤šåº”ç”¨ç¨‹åºå¸¦çš„æ’ä»¶ï¼Œæœ‰å¾ˆå¤šçš„é™åˆ¶æ¡ä»¶ï¼Œè¿™äº›åº”ç”¨ç¨‹åºåœ¨è¿è¡Œæ’ä»¶æ—¶éœ€è¦éµå¾ªå®¿ä¸»ç¨‹åºåˆ¶å®šçš„è¿è¡Œè§„åˆ™ï¼Œæ’ä»¶çš„è¿è¡Œç¯å¢ƒå’Œè§„åˆ™å°±æ˜¯ä¸€ä¸ªæ²™ç®± â€¦. ä»çŸ¥ä¹è¿™ç¯‡æ–‡ç« å¯ä»¥çœ‹åˆ°æ²™ç®±çš„åŸºæœ¬ä»‹ç»https://zhuanlan.zhihu.com/p/428039764 é‡Œé¢çš„ã€Šç®€é™‹æ²™ç®±ã€‹ã€ã€Šéå¸¸ç®€é™‹çš„æ²™ç®±ï¼ˆWithï¼‰ã€‹ã€ã€Šæ²¡é‚£ä¹ˆç®€é™‹çš„æ²™ç®±ï¼ˆWith+Proxyï¼‰ã€‹å¾ªåºæ¸è¿›ï¼Œéƒ½å¯ä»¥å¸®åŠ©è¯»è€…åŠ æ·±å°è±¡ é‡Œé¢ä¸»è¦é€šè¿‡new Functionã€evalã€withä¿®æ”¹ä¸Šä¸‹æ–‡ä½œç”¨åŸŸ ç„¶åå°±æ˜¯å¤©ç„¶æ²™ç®±ï¼šiframeã€å’Œ ifame+with+proxyçš„ç»“åˆï¼Œä½†æ˜¯ç°åœ¨ç®€å•çš„æ²™ç®±éƒ½æœ‰å¯èƒ½è¢«ä½¿ç”¨è€…ä½¿ç”¨æŸç§ä»£ç æ¼æ´ï¼Œè¿›è¡Œ â€œæ²™ç®±é€ƒé€¸â€ï¼Œä»è€Œè·å–æ²™ç®±ä¹‹å¤–ç¯å¢ƒçš„å†…å®¹è¿›è¡Œè¯»å–ã€ä¿®æ”¹ç­‰ï¼Œè¿™æ—¶å€™å°±è¦å»æ‰¾å¼€æºåº“äº† JSéš”ç¦»Js æ²™ç®±åšçš„äº‹æƒ…å¯ä»¥ç”¨ä¸¤å¥è¯æ¦‚æ‹¬ï¼š ä¸ºæ¯ä¸€ä¸ªå­åº”ç”¨åˆ›å»ºä¸€ä¸ªä¸“å±çš„ â€œwindow å¯¹è±¡â€ï¼ˆè™šå‡çš„ï¼‰ï¼› æ‰§è¡Œå­åº”ç”¨æ—¶ï¼Œå°†æ–°å»ºçš„ â€œwindow å¯¹è±¡â€ ä½œä¸ºå­åº”ç”¨è„šæœ¬çš„å…¨å±€å˜é‡ï¼Œå­åº”ç”¨å¯¹å…¨å±€å˜é‡çš„è¯»å†™æ“ä½œéƒ½ä½œç”¨åˆ°è¿™ä¸ª â€œwindow å¯¹è±¡â€ä¸­ã€‚ æ²™ç®±ç±»å‹ï¼š LegacySandboxï¼ˆä¾èµ– Proxy)ï¼Œçˆ¶å­çŠ¶æ€éš”ç¦»ï¼Œä½†æ˜¯windowä¸éš”ç¦» ProxySandbox ï¼ˆä¾èµ– Proxyï¼‰ç¨³å®šåä¼šå–ä»£ LegacySandboxã€‚ SnapshotSandboxï¼ˆä¸ä¾èµ–Proxyï¼‰ å‚è€ƒå­—èŠ‚è·³åŠ¨çš„æŠ€æœ¯æ–‡ç« ï¼šhttps://juejin.cn/post/7099339595233361934#heading-24 3.å¾®å‰ç«¯å¾®å‰ç«¯ï¼ˆMicro-Frontendsï¼‰åŒæ ·æ˜¯ä¸€å¥—ä½“ç³»æ¶æ„ï¼Œæ˜¯ä¸€ç§ç±»ä¼¼äºå¾®æœåŠ¡çš„æ¶æ„ï¼Œå®ƒå°†å¾®æœåŠ¡çš„ç†å¿µåº”ç”¨äºæµè§ˆå™¨ç«¯ï¼Œå³å°† Web åº”ç”¨ç”±å•ä¸€çš„å•ä½“åº”ç”¨è½¬å˜ä¸ºå¤šä¸ªå°å‹å‰ç«¯åº”ç”¨èšåˆä¸ºä¸€çš„åº”ç”¨ã€‚å„ä¸ªå‰ç«¯åº”ç”¨è¿˜å¯ä»¥æ— å…³æŠ€æœ¯æ ˆåœ°ç‹¬ç«‹è¿è¡Œã€ç‹¬ç«‹å¼€å‘ã€ç‹¬ç«‹éƒ¨ç½²ã€‚ åœ¨å¦‚ä»Šè¶Šæ¥è¶Šæ³¨é‡æ‹†åˆ†å’Œç»†åŒ–çš„æ—¶ä»£ï¼Œå¾®å‰ç«¯çš„åˆ°æ¥å¹¶æ²¡æœ‰åœ¨æ„æ–™ä¹‹å¤–ï¼Œè€Œå¾®å‰ç«¯çš„æ„ä¹‰å°±ï¼š å°†è¿™äº›åºå¤§åº”ç”¨è¿›è¡Œæ‹†åˆ†ï¼Œå¹¶éšä¹‹è§£è€¦ï¼Œæ¯ä¸ªéƒ¨åˆ†å¯ä»¥å•ç‹¬è¿›è¡Œç»´æŠ¤å’Œéƒ¨ç½²ï¼Œæå‡æ•ˆç‡ã€‚ æ•´åˆå†å²ç³»ç»Ÿï¼Œå°†è€æ¶æ„æ¡†æ¶é¡¹ç›®å…¼å®¹æ€§æ”¾åœ¨æ–°çš„æ¶æ„ä½“ç³»ä¸­ å½“ç„¶ï¼Œæ²¡æœ‰å…è´¹çš„åˆé¤â€”â€”ä¸€åˆ‡éƒ½æ˜¯æœ‰ä»£ä»·çš„ï¼Œä¸€äº›å¾®å‰ç«¯å®ç°å¯èƒ½ä¼šå¯¼è‡´ä¾èµ–é¡¹é‡å¤ï¼Œä½†æ˜¯æˆ‘ä»¬ç›¸ä¿¡è¿™äº›é£é™©æ˜¯å¯ä»¥æ§åˆ¶çš„ï¼Œè€Œä¸”å¾®å‰ç«¯çš„å¥½å¤„å¾€å¾€è¶…è¿‡æˆæœ¬ã€‚ â€”â€”â€“Cam Jackson å¾®å‰ç«¯è§£å†³çš„é—®é¢˜ï¼š å®é™…ä¸Šï¼Œä¸€ä¸ªå…¸å‹çš„åŸºäºvue-routerçš„Vueåº”ç”¨ä¸è¿™ç§æ¶æ„å­˜åœ¨ç€å¾ˆå¤§çš„ç›¸ä¼¼æ€§ å¾®å‰ç«¯æ–¹æ¡ˆçš„æ ¸å¿ƒæ˜¯â€œä¸»ä»â€æ€æƒ³ï¼Œå³åŒ…æ‹¬ä¸€ä¸ªåŸºåº§ï¼ˆMainAppï¼‰åº”ç”¨å’Œè‹¥å¹²ä¸ªå¾®ï¼ˆMicroAppï¼‰åº”ç”¨ï¼ŒåŸºåº§åº”ç”¨å¤§å¤šæ•°æ˜¯ä¸€ä¸ªå‰ç«¯SPAé¡¹ç›®ï¼Œä¸»è¦è´Ÿè´£åº”ç”¨æ³¨å†Œï¼Œè·¯ç”±æ˜ å°„ï¼Œæ¶ˆæ¯ä¸‹å‘ç­‰ï¼Œè€Œå¾®åº”ç”¨æ˜¯ç‹¬ç«‹å‰ç«¯é¡¹ç›®ï¼Œè¿™äº›é¡¹ç›®ä¸é™äºé‡‡ç”¨Reactï¼ŒVueï¼ŒAngularæˆ–è€…JQueryå¼€å‘ï¼Œæ¯ä¸ªå¾®åº”ç”¨æ³¨å†Œåˆ°åŸºåº§åº”ç”¨ä¸­ï¼Œç”±åŸºåº§è¿›è¡Œç®¡ç†ï¼Œä½†æ˜¯å¦‚æœè„±ç¦»åŸºåº§ä¹Ÿæ˜¯å¯ä»¥å•ç‹¬è®¿é—® æ–¹æ¡ˆ æè¿° NPMå¼ å­å·¥ç¨‹ä»¥NPMåŒ…çš„å½¢å¼å‘å¸ƒæºç ï¼›æ‰“åŒ…æ„å»ºå‘å¸ƒè¿˜æ˜¯ç”±åŸºåº§å·¥ç¨‹ç®¡ç†ï¼Œæ‰“åŒ…æ—¶é›†æˆã€‚ iframeå¼ å­å·¥ç¨‹å¯ä»¥ä½¿ç”¨ä¸åŒæŠ€æœ¯æ ˆï¼›å­å·¥ç¨‹ä¹‹é—´å®Œå…¨ç‹¬ç«‹ï¼Œæ— ä»»ä½•ä¾èµ–ï¼›åŸºåº§å·¥ç¨‹å’Œå­å·¥ç¨‹éœ€è¦å»ºç«‹é€šä¿¡æœºåˆ¶ï¼›æ— å•é¡µåº”ç”¨ä½“éªŒï¼›è·¯ç”±åœ°å€ç®¡ç†å›°éš¾ã€‚ é€šç”¨ä¸­å¿ƒè·¯ç”±åŸºåº§å¼ å­å·¥ç¨‹å¯ä»¥ä½¿ç”¨ä¸åŒæŠ€æœ¯æ ˆï¼›å­å·¥ç¨‹ä¹‹é—´å®Œå…¨ç‹¬ç«‹ï¼Œæ— ä»»ä½•ä¾èµ–ï¼›ç»Ÿä¸€ç”±åŸºåº§å·¥ç¨‹è¿›è¡Œç®¡ç†ï¼ŒæŒ‰ç…§DOMèŠ‚ç‚¹çš„æ³¨å†Œã€æŒ‚è½½ã€å¸è½½æ¥å®Œæˆã€‚æ¯”å¦‚qiankunä¹‹ç±»çš„ï¼Œqiankunç”šè‡³èƒ½åŠ è½½jQueryç¼–å†™çš„é¡µé¢ ç‰¹å®šä¸­å¿ƒè·¯ç”±åŸºåº§å¼ å­ä¸šåŠ¡çº¿ä¹‹é—´ä½¿ç”¨ç›¸åŒæŠ€æœ¯æ ˆï¼›åŸºåº§å·¥ç¨‹å’Œå­å·¥ç¨‹å¯ä»¥å•ç‹¬å¼€å‘å•ç‹¬éƒ¨ç½²ï¼›å­å·¥ç¨‹æœ‰èƒ½åŠ›å¤ç”¨åŸºåº§å·¥ç¨‹çš„å…¬å…±åŸºå»ºã€‚æ¯”å¦‚React-routerã€Vue-router ï¼ˆå›¾ç‰‡æºè‡ªç¾å›¢æŠ€æœ¯å›¢é˜Ÿçš„æ–‡ç« ï¼Œè€Œç¾å›¢ç”¨çš„æ˜¯åŸºäºReactçš„ä¸­å¿ƒè·¯ç”±åŸºåº§å¼å¾®å‰ç«¯ï¼‰ ä½†æ˜¯å¾®å‰ç«¯ä»éœ€è§£å†³ï¼š è·¯ç”±åˆ‡æ¢çš„åˆ†å‘é—®é¢˜ã€‚ ä¸»å¾®åº”ç”¨çš„éš”ç¦»é—®é¢˜ã€‚ é€šä¿¡é—®é¢˜ã€‚ è·¯ç”±è½¬å‘ï¼š é€šè¿‡httpè¯·æ±‚è·å–æ‰€éœ€çš„å¾®åº”ç”¨htmlã€cssã€jsï¼Œç„¶åå¯ä»¥é‡‡ç”¨evalçš„å½¢å¼è¿è¡Œä»£ç ï¼Œè€Œåˆ†å‘è¿‡ç¨‹ä½¿ç”¨routerå¯¹urlè¿›è¡Œç›‘å¬ï¼Œç„¶åé‡‡ç”¨ä¸€äº›è·¯ç”±æ–¹æ³•ï¼ˆhashæ–¹æ³•æˆ–è€…pushStateæ–¹æ³•ç­‰ï¼‰å‘é€è·¯ç”±ä¿¡æ¯ç»™å¾®åº”ç”¨ï¼Œè®©å¾®åº”ç”¨é€šè¿‡å®ƒè‡ªå·±çš„è·¯ç”±è¿›è¡Œæ¥æ”¶ Single-Spaè™½ç„¶å®ç°äº†è‡ªå·±çš„ä¸€å¥—è·¯ç”±æ¥ç›‘å¬å­å·¥ç¨‹çš„åˆ‡æ¢ï¼Œä½†æ˜¯è¿˜éœ€è¦ç‰¹å®šçš„æ¨¡å—ç®¡ç†ç³»ç»Ÿï¼Œæ¯”å¦‚ systemjsæ¥è¾…åŠ©ï¼Œè¿™å¯¼è‡´äº†æ”¹é€ æˆæœ¬å’Œæ·»åŠ ä¸€äº›é¢å¤–çš„åº“ï¼Œæ‰€ä»¥ç¾å›¢ç›´æ¥ç”¨çš„æ˜¯ React-Router (react-router-dom) éš”ç¦»é—®é¢˜ï¼š å¯¹äºcssæ±¡æŸ“ï¼Œå¯ä»¥é‡‡ç”¨CSS Moduleæˆ–è€…webpackçš„postcssæ’ä»¶ï¼Œåœ¨æ‰“åŒ…æ—¶æ·»åŠ ç‰¹å®šçš„å‰ç¼€ å¯¹äºJsä»£ç ï¼Œæˆ‘ä»¬å®³æ€•ä¸€äº›å…¨å±€å¯¹è±¡åœ¨ä¸åŒå¾®åº”ç”¨çš„ä¸åŒè¡¨ç°ï¼Œæˆ‘ä»¬å¯ä»¥é‡‡ç”¨æ²™ç®±éš”ç¦»æœºåˆ¶ï¼Œæ¶ˆé™¤å†²çªå’Œå½±å“ é€šä¿¡é—®é¢˜ï¼š æˆ‘ä»¬å¯ä»¥ç”¨å‘å¸ƒè®¢é˜…é€šä¿¡æœºåˆ¶ï¼Œäº‹ä»¶ç”±å®è·µä¸­å¿ƒç»Ÿä¸€åˆ†å‘ å­åº”ç”¨æ‰“åŒ…çš„æ–¹å¼å¾®å‰ç«¯æ¶æ„æ¨¡å¼ä¸‹ï¼Œå­åº”ç”¨æ‰“åŒ…çš„æ–¹å¼ï¼ŒåŸºæœ¬åˆ†ä¸ºä¸¤ç§ï¼š ä¸¤è€…çš„ä¼˜ç¼ºç‚¹ä¹Ÿå¾ˆæ˜æ˜¾ï¼š å¾ˆæ˜¾ç„¶ï¼Œè¦å®ç°çœŸæ­£çš„æŠ€æœ¯æ ˆæ— å…³è·Ÿç‹¬ç«‹éƒ¨ç½²ä¸¤ä¸ªæ ¸å¿ƒç›®æ ‡ï¼Œå¤§éƒ¨åˆ†åœºæ™¯ä¸‹æˆ‘ä»¬éœ€è¦ä½¿ç”¨è¿è¡Œæ—¶åŠ è½½å­åº”ç”¨è¿™ç§æ–¹æ¡ˆã€‚ JS Entry vs HTML Entry å¦‚æœæ˜¯ JS Entry æ–¹æ¡ˆï¼Œä¸»æ¡†æ¶éœ€è¦åœ¨å­åº”ç”¨åŠ è½½ä¹‹å‰æ„å»ºå¥½ç›¸åº”çš„å®¹å™¨èŠ‚ç‚¹(æ¯”å¦‚è¿™é‡Œçš„ â€œ#rootâ€ èŠ‚ç‚¹)ï¼Œä¸ç„¶å­åº”ç”¨åŠ è½½æ—¶ä¼šå› ä¸ºæ‰¾ä¸åˆ° container æŠ¥é”™ &lt;!-- å­åº”ç”¨ index.html --> &lt;script src=\"//unpkg/antd.min.js\">&lt;/script> &lt;body> &lt;main id=\"root\">&lt;/main> &lt;/body> // å­åº”ç”¨å…¥å£ ReactDOM.render(&lt;App/>, document.getElementById('root')) JS entryæ‰“åŒ…é—®é¢˜ï¼ˆå¯ä»¥çœ‹ why SystemJS éƒ¨åˆ†ï¼‰ HTML entryæ— æ³•æŠ½å–å…¬å…±ä¾èµ–ï¼ˆå¾ˆéº»çƒ¦ï¼‰ å…¶ä»–ï¼š ï¼ˆwebpack5æœ‰ä¸€ä¸ªè”é‚¦æ¨¡å—åŠŸèƒ½ï¼ˆmfï¼‰ï¼Œå¯¹äºå¾®å‰ç«¯çš„å…¬å…±ä¾èµ–åŠ è½½æ˜¯æ¯”è¾ƒå¥½çš„è§£å†³æ–¹æ¡ˆã€‚ï¼‰ ä¸€äº›å¾®å‰ç«¯çš„æ¡†æ¶ Mooaï¼šåŸºäºAngularçš„å¾®å‰ç«¯æœåŠ¡æ¡†æ¶ Single-Spaï¼šæœ€æ—©çš„å¾®å‰ç«¯æ¡†æ¶ï¼Œå…¼å®¹å¤šç§å‰ç«¯æŠ€æœ¯æ ˆã€‚ Qiankunï¼šåŸºäºSingle-Spaï¼Œé˜¿é‡Œç³»å¼€æºå¾®å‰ç«¯æ¡†æ¶ã€‚ Icestarkï¼šé˜¿é‡Œé£å†°å¾®å‰ç«¯æ¡†æ¶ï¼Œå…¼å®¹å¤šç§å‰ç«¯æŠ€æœ¯æ ˆã€‚ Ara Frameworkï¼šç”±æœåŠ¡ç«¯æ¸²æŸ“å»¶ä¼¸å‡ºçš„å¾®å‰ç«¯æ¡†æ¶ã€‚ micro-appï¼šäº¬ä¸œå¾®å‰ç«¯æ¡†æ¶ï¼Œå€Ÿé‰´äº†WebComponentçš„æ€æƒ³ï¼Œé€šè¿‡CustomElementç»“åˆè‡ªå®šä¹‰çš„ShadowDomï¼Œå°†å¾®å‰ç«¯å°è£…æˆä¸€ä¸ªç±»WebComponentç»„ä»¶ï¼Œä»è€Œå®ç°å¾®å‰ç«¯çš„ç»„ä»¶åŒ–æ¸²æŸ“ ä½ å¯èƒ½å°±ä¸éœ€è¦å¾®å‰ç«¯å­˜åœ¨ä»¥ä¸‹åœºæ™¯æ—¶ï¼Œä½ å¯èƒ½å°±ä¸éœ€è¦å¾®å‰ç«¯ï¼š ä½ /ä½ çš„å›¢é˜Ÿ å…·å¤‡ç³»ç»Ÿå†…æ‰€æœ‰æ¶æ„ç»„ä»¶çš„è¯è¯­æƒç®€å•æ¥è¯´å°±æ˜¯ï¼Œç³»ç»Ÿé‡Œçš„æ‰€æœ‰ç»„ä»¶éƒ½æ˜¯ç”±ä¸€ä¸ªå°çš„å›¢é˜Ÿå¼€å‘çš„ã€‚ ä½ /ä½ çš„å›¢é˜Ÿ æœ‰è¶³å¤ŸåŠ¨åŠ›å»æ²»ç†ã€æ”¹é€ è¿™ä¸ªç³»ç»Ÿä¸­çš„æ‰€æœ‰ç»„ä»¶ç›´æ¥æ”¹é€ å­˜é‡ç³»ç»Ÿçš„æ”¶ç›Šå¤§äºæ–°è€ç³»ç»Ÿæ··æ‚å¸¦æ¥çš„é—®é¢˜ã€‚ ç³»ç»ŸåŠç»„ç»‡æ¶æ„ä¸Šï¼Œå„éƒ¨ä»¶ä¹‹é—´æœ¬èº«å°±æ˜¯å¼ºè€¦åˆã€è‡ªæ´½ã€ä¸å¯åˆ†ç¦»çš„ç³»ç»Ÿæœ¬èº«å°±æ˜¯ä¸€ä¸ªæœ€å°å•å…ƒçš„ã€Œæ¶æ„é‡å­ã€ï¼Œæ‹†åˆ†çš„æˆæœ¬é«˜äºæ²»ç†çš„æˆæœ¬ã€‚ æé«˜çš„äº§å“ä½“éªŒè¦æ±‚ï¼Œå¯¹ä»»ä½•äº§å“äº¤äº’ä¸Šçš„ä¸ä¸€è‡´é›¶å®¹å¿ä¸å…è®¸äº¤äº’ä¸Šä¸ä¸€è‡´çš„æƒ…å†µå‡ºç°ï¼Œè¿™åŸºæœ¬ä¸Šä»äº§å“ä¸Šå¦å†³äº†æ¸è¿›å¼å‡çº§çš„æŠ€æœ¯ç­–ç•¥ æ»¡è¶³ä»¥ä¸‹å‡ ç‚¹ï¼Œä½ æ‰ç¡®å®å¯èƒ½éœ€è¦å¾®å‰ç«¯ ç³»ç»Ÿæœ¬èº«æ˜¯éœ€è¦é›†æˆå’Œè¢«é›†æˆçš„ ä¸€èˆ¬æœ‰ä¸¤ç§æƒ…å†µï¼š æ—§çš„ç³»ç»Ÿä¸èƒ½ä¸‹ï¼Œæ–°çš„éœ€æ±‚è¿˜åœ¨æ¥ã€‚æ²¡æœ‰ä¸€å®¶å•†ä¸šå…¬å¸ä¼šåŒæ„å·¥ç¨‹å¸ˆä»¥å•çº¯çš„æŠ€æœ¯å‡çº§çš„ç†ç”±ï¼Œç›´æ¥ä¸‹çº¿ä¸€ä¸ªæœ‰ç€ä¸€å®šç”¨æˆ·çš„å­˜é‡ç³»ç»Ÿçš„ã€‚è€Œä½ å¤§æ¦‚åˆä¸èƒ½ç®€å•é€šè¿‡ iframe è¿™ç§ã€Œé è°±çš„ã€æ‰‹æ®µå®Œæˆæ–°åŠŸèƒ½çš„æ¥å…¥ï¼Œå› ä¸ºäº§å“è¯´éœ€è¦ã€Œå¼¹ä¸ªæ¡†å¼¹åˆ°ä¸­é—´ã€ ä½ çš„ç³»ç»Ÿéœ€è¦æœ‰ä¸€å¥—æ”¯æŒåŠ¨æ€æ’æ‹”çš„æœºåˆ¶ã€‚è¿™ä¸ªæœºåˆ¶å¯ä»¥æ˜¯ä¸€å¥—ç²¾å¿ƒè®¾è®¡çš„æ’ä»¶ä½“ç³»ï¼Œä½†ä¸€æ—¦å‡ºç°æ¥å…¥åº”ç”¨æˆ–è¢«æ¥å…¥åº”ç”¨å¹´ä»£å¤Ÿä¹…è¿œã€æ”¹é€ æˆæœ¬è¿‡é«˜çš„åœºæ™¯ï¼Œå¯èƒ½åé¢è¿˜æ˜¯ä¼šè¿‡æ¸¡åˆ°å„ç§å¾®å‰ç«¯çš„ç©æ³•ã€‚ ç³»ç»Ÿä¸­çš„éƒ¨ä»¶å…·å¤‡è¶³å¤Ÿæ¸…æ™°çš„æœåŠ¡è¾¹ç•Œé€šè¿‡å¾®å‰ç«¯æ‰‹æ®µåˆ’åˆ†æœåŠ¡è¾¹ç•Œï¼Œå°†å¤æ‚åº¦éš”ç¦»åœ¨ä¸åŒçš„ç³»ç»Ÿå•å…ƒä¸­ï¼Œä»è€Œé¿å…å› ç†µå¢é€Ÿåº¦ä¸ä¸€è‡´å¸¦æ¥çš„ä»£ç è…åŒ–çš„ä¼ æŸ“ï¼Œä»¥åŠç ”å‘èŠ‚å¥å·®å¼‚å¸¦æ¥çš„å·¥ç¨‹ååŒä¸Šçš„é—®é¢˜ã€‚ 4.iframeiframeæ˜¯ä¸€ä¸ªå¤©ç„¶çš„æ²™ç®± ä¼˜ç‚¹ï¼š éå¸¸ç®€å•ï¼Œä½¿ç”¨æ²¡æœ‰ä»»ä½•å¿ƒæ™ºè´Ÿæ‹… éš”ç¦»å®Œç¾ï¼Œæ— è®ºæ˜¯ jsã€cssã€dom éƒ½å®Œå…¨éš”ç¦»å¼€æ¥ å¤šåº”ç”¨æ¿€æ´»ï¼Œé¡µé¢ä¸Šå¯ä»¥æ‘†æ”¾å¤šä¸ªiframeæ¥ç»„åˆä¸šåŠ¡ï¼ˆé€‚åˆå•é¡µé¢å¤šåº”ç”¨ï¼‰ å¦‚æœé¡µé¢é‡Œæœ‰iframeçš„è¯ï¼Œå†…éƒ¨çš„iframeï¼Œå¦‚æœiframeæ˜¯å’Œæ ‡ç­¾é¡µå±äºåŒä¸€åŸŸï¼Œé‚£å°±å…±ç”¨æ¸²æŸ“è¿›ç¨‹ï¼Œå¦åˆ™ä¼šç»™è¿™ä¸ªiframeä¸€ä¸ªå•ç‹¬çš„æ¸²æŸ“è¿›ç¨‹,æ‰€ä»¥å•é¡µé¢ä¸‹ï¼ˆæ²¡æœ‰è·¯ç”±ç®¡ç†ï¼‰ï¼Œå¯èƒ½æ¯”qiankunç­‰é€šè¿‡æ‹‰å–ä»£ç å•çº¿ç¨‹è¿è¡Œè¦å¿« ä½†æ˜¯å®ƒæœ‰å¾ˆå¤šå¼Šç«¯ï¼š url ä¸åŒæ­¥ï¼Œæ¯æ¬¡è¿›æ¥éƒ½è¦åŠ è½½ï¼ŒurlçŠ¶æ€ä¸èƒ½ä¿ç•™ DOM ç»“æ„ä¸å…±äº«ã€‚æ¯”å¦‚å­åº”ç”¨é‡Œæœ‰ä¸€ä¸ª Modalï¼ˆå¼¹çª—ï¼‰ï¼Œæ˜¾ç¤ºçš„æ—¶å€™åªèƒ½åœ¨é‚£ä¸€å°å—åœ°æ–¹å±•ç¤ºï¼Œä¸èƒ½å…¨å±å±•ç¤º æ— æ³•è·Ÿéšæµè§ˆå™¨å‰è¿›åé€€ å¤©ç”Ÿçš„ç¡¬éš”ç¦»ï¼Œæ— æ³•ä¸ä¸»åº”ç”¨è¿›è¡Œèµ„æºå…±äº«ï¼Œå†…å­˜å˜é‡ä¸å…±äº«ï¼Œäº¤æµä¹Ÿå¾ˆå›°éš¾ æ…¢ã€‚æ¯æ¬¡å­åº”ç”¨è¿›å…¥éƒ½æ˜¯ä¸€æ¬¡æµè§ˆå™¨ä¸Šä¸‹æ–‡é‡å»ºã€èµ„æºé‡æ–°åŠ è½½çš„è¿‡ç¨‹ï¼Œç™½å±æ—¶é—´å¤ªé•¿ï¼Œå¯¹äºSPA åº”ç”¨åº”ç”¨æ¥è¯´æ— æ³•æ¥å— å½“ç„¶ï¼Œè…¾è®¯æå‡ºäº†ä¸€ä¸ªâ€œå®Œç¾â€çš„iframeå¾®å‰ç«¯æ–¹æ¡ˆï¼Œå¯ä»¥çœ‹ä¸€çœ‹åŸºäº iframe çš„å…¨æ–°å¾®å‰ç«¯æ–¹æ¡ˆ(è…¾è®¯PCG) ä¸»è¦æ˜¯ åˆ©ç”¨shadow domæ’æ‹”htmlã€cssæ¥è§£å†³domå‰²è£‚é—®é¢˜ï¼ˆæ¯”å¦‚toastï¼‰ åœ¨iframeä¸­æ‰§è¡Œjsï¼Œç„¶åè®©iframeçš„è·¯ç”±çŠ¶æ€åŒæ­¥åˆ°æµè§ˆå™¨çš„è·¯ç”±è§£å†³è·¯ç”±é—®é¢˜å’Œé€šä¿¡é—®é¢˜ï¼ˆåŒåŸŸä¸‹é€šä¿¡æ¯”è¾ƒç®€å•ï¼‰ ç„¶åå†…éƒ¨åšäº†ä¸€äº›ç¼“å­˜ï¼ˆå®ä¾‹åŒ–å­åº”ç”¨ï¼‰ï¼Œé™ä½å­åº”ç”¨èµ„æºåŠ è½½çš„æˆæœ¬ è€Œå®˜æ–¹ä¹Ÿè°ˆåŠäº†wujieçš„ä¸è¶³ä¹‹å¤„ï¼š å†…å­˜å ç”¨è¾ƒé«˜ï¼Œä¸ºäº†é™ä½å­åº”ç”¨çš„ç™½å±æ—¶é—´ï¼Œå°†æœªæ¿€æ´»å­åº”ç”¨çš„shadowRootå’Œiframeå¸¸é©»å†…å­˜å¹¶ä¸”ä¿æ´»æ¨¡å¼ä¸‹æ¯å¼ é¡µé¢éƒ½éœ€è¦ç‹¬å ä¸€ä¸ªwujieå®ä¾‹ï¼Œå†…å­˜å¼€é”€è¾ƒå¤§ å…¼å®¹æ€§ä¸€èˆ¬ï¼Œç›®å‰ç”¨åˆ°äº†æµè§ˆå™¨çš„shadowRootå’Œproxyèƒ½åŠ›ï¼Œå¹¶ä¸”æ²¡æœ‰åšé™çº§æ–¹æ¡ˆ iframeåŠ«æŒdocumentåˆ°shadowRootæ—¶ï¼ŒæŸäº›ç¬¬ä¸‰æ–¹åº“å¯èƒ½æ— æ³•å…¼å®¹å¯¼è‡´ç©¿é€ 5.single-spaSingle SPA å°†è‡ªå·±å®šä¹‰ä¸ºä¸€ç§â€œå‰ç«¯å¾®æœåŠ¡ Javascript æ¡†æ¶â€ï¼Œå®ƒå°†ç”Ÿå‘½å‘¨æœŸåº”ç”¨äºæ¯ä¸ªåº”ç”¨ç¨‹åºã€‚æ¯ä¸ªåº”ç”¨ç¨‹åºéƒ½å¯ä»¥å“åº” url è·¯ç”±äº‹ä»¶ï¼Œå¹¶ä¸”çŸ¥é“å¦‚ä½•ä» DOM å¼•å¯¼ï¼ŒåŠ è½½å’Œå¸è½½è‡ªèº« single-spa ä»…ä»…æ˜¯ä¸€ä¸ªå­åº”ç”¨ç”Ÿå‘½å‘¨æœŸçš„è°ƒåº¦è€…ã€‚single-spa ä¸ºåº”ç”¨å®šä¹‰äº† boostrap, load, mount, unmount å››ä¸ªç”Ÿå‘½å‘¨æœŸå›è°ƒï¼š å€¼å¾—æ³¨æ„çš„æ˜¯ Register ä¸æ˜¯ç”Ÿå‘½å‘¨æœŸï¼ŒæŒ‡çš„æ˜¯è°ƒç”¨ registerApplication å‡½æ•°è¿™ä¸€æ­¥ Load æ˜¯å¼€å§‹åŠ è½½å­åº”ç”¨ï¼Œæ€ä¹ˆåŠ è½½ç”±å¼€å‘è€…è‡ªå·±å®ç°ï¼ˆç­‰ä¼šä¼šè¯´åˆ°ï¼‰ Unload é’©å­åªèƒ½é€šè¿‡è°ƒç”¨ unloadApplication å‡½æ•°æ‰ä¼šè¢«è°ƒç”¨ å½“è§¦å‘åˆ° window.location.href åŒ¹é…åˆ° url æ—¶ï¼Œå¼€å§‹èµ°å¯¹åº”å­ App çš„è¿™ä¸€å¥—ç”Ÿå‘½å‘¨æœŸå˜›ã€‚æ‰€ä»¥ï¼Œsingle-spa è¿˜è¦ç›‘å¬ url çš„å˜åŒ–ï¼Œç„¶åæ‰§è¡Œå­ app çš„ç”Ÿå‘½å‘¨æœŸæµç¨‹ã€‚ åˆ°æ­¤ï¼Œæˆ‘ä»¬å°±æœ‰äº† single-spa çš„å¤§è‡´æ¡†æ¶äº†ï¼Œæ— éå°±ä¸¤ä»¶äº‹ï¼š å®ç°ä¸€å¥—ç”Ÿå‘½å‘¨æœŸï¼Œåœ¨ load æ—¶åŠ è½½å­ appï¼Œç”±å¼€å‘è€…è‡ªå·±ç©ï¼Œåˆ«çš„ç”Ÿå‘½å‘¨æœŸé‡Œè¦å¹²å˜›çš„ï¼Œè¿˜æ˜¯ç”±å¼€å‘è€…é€ çš„å­åº”ç”¨è‡ªå·±ç© ç›‘å¬ url çš„å˜åŒ–ï¼Œurl å˜åŒ–æ—¶ï¼Œä¼šä½¿å¾—æŸä¸ªå­ app å˜æˆ active çŠ¶æ€ï¼Œç„¶åèµ°æ•´å¥—ç”Ÿå‘½å‘¨æœŸ æ ¹æ®ä¼ å…¥çš„å‚æ•°activeWhenåˆ¤æ–­å“ªä¸ªåº”ç”¨éœ€è¦åŠ è½½ï¼Œå“ªä¸ªåº”ç”¨éœ€è¦å¸è½½æˆ–æ¸…é™¤ï¼Œå¹¶å°†å…¶pushåˆ°å¯¹åº”çš„æ•°ç»„ å¦‚æœåº”ç”¨å·²ç»å¯åŠ¨ï¼Œåˆ™è¿›è¡Œåº”ç”¨åŠ è½½æˆ–åˆ‡æ¢ã€‚é’ˆå¯¹åº”ç”¨çš„ä¸åŒçŠ¶æ€ï¼Œç›´æ¥æ‰§è¡Œåº”ç”¨è‡ªèº«æš´éœ²å‡ºçš„ç”Ÿå‘½å‘¨æœŸé’©å­å‡½æ•°å³å¯ã€‚ å¦‚æœåº”ç”¨æœªå¯åŠ¨ï¼Œåˆ™åªå»ä¸‹è½½appsToLoadä¸­çš„åº”ç”¨ã€‚ è¯¥å›¾ä½œè€…çš„è¯„ä»·ï¼š ä¼ ç»Ÿ SPA å’Œ Single SPA åº”ç”¨ç¨‹åºä¹‹é—´çš„ä¸»è¦åŒºåˆ«åœ¨äºå®ƒä»¬èƒ½å¤Ÿä¸å…¶ä»–åº”ç”¨ç¨‹åºå…±å­˜ï¼Œå¹¶ä¸”å®ƒä»¬å„è‡ªæ²¡æœ‰è‡ªå·±çš„ HTML é¡µé¢ã€‚ single-spa çš„ç†å¿µæ˜¯å¸Œæœ›ä¸»åº”ç”¨å¯ä»¥åšåˆ°éå¸¸éå¸¸ç®€å•çš„å’Œè½»é‡ï¼Œç®€å•åˆ°åªè¦ä¸€ä¸ª index.html + ä¸€ä¸ª main.js å°±å¯ä»¥å®Œæˆå¾®å‰ç«¯å·¥ç¨‹ï¼Œè¿ Webpack éƒ½ä¸éœ€è¦ï¼Œç›´æ¥åœ¨æµè§ˆå™¨é‡Œæ‰§è¡Œ åœ¨single-spaçš„è§’åº¦ï¼Œå¾®å‰ç«¯å°±æ˜¯â€œå¾®æ¨¡å—åŠ è½½å™¨â€ï¼Œå®ƒä¸»è¦è§£å†³çš„æ˜¯ï¼šå¦‚ä½•å®ç°å‰ç«¯çš„â€œå¾®æœåŠ¡åŒ–â€ï¼Œä»è€Œè®©åº”ç”¨ã€ç»„ä»¶ã€é€»è¾‘éƒ½æˆä¸ºå¯å…±äº«çš„å¾®æœåŠ¡ï¼Œè¿™ä»single-spaå…³äºå¾®å‰ç«¯çš„æ¦‚è¿°ä¸­å¯ä»¥çœ‹å‡ºï¼š ç¿»è¯‘è¿‡æ¥ååˆ«æ˜¯å¾®åº”ç”¨ã€å¾®ç»„ä»¶ã€å¾®æ¨¡å—ï¼Œè€Œsingle-spaè¦æ±‚å®ƒä»¬éƒ½ä»¥SystemJSçš„å½¢å¼æ‰“åŒ…ï¼Œæ‰€ä»¥æœ¬è´¨ä¸Šéƒ½æ˜¯å¾®æ¨¡å— å…³äºsingle-spaä¸€éƒ¨åˆ†å®è·µå¯ä»¥çœ‹è¿™ä¸ªï¼Œä½†æ˜¯ç”±äºè¿™é‡Œçš„ä»£ç çš„å¾ˆå¤šåŒ…éƒ½æ¯”è¾ƒä¹…è¿œï¼Œæœ€å¥½ä¸‹è½½å’Œå®ƒä¸€è‡´çš„åŒ…å†è¿›è¡Œå®è·µ github SystemJS1.æµè§ˆå™¨é‡Œç”¨import/exportã€‚SystemJS çš„å¥½å¤„å’Œä¼˜åŠ¿æœ‰ä¸”ä»…æœ‰ä¸€ç‚¹ï¼šé‚£å°±æ˜¯é‚£å°±æ˜¯ä¸éœ€è¦æ‰“åŒ…å·¥å…·ï¼Œç›´æ¥åœ¨æµè§ˆå™¨é‡Œä½¿ç”¨ ES6 çš„ import/exportï¼Œä¹Ÿå°±æ˜¯è¯´å®ƒæ˜¯ä¸€ä¸ªå…è®¸ES moduleæ¨¡å—è¿è¡Œåœ¨æ—§ç‰ˆæœ¬ESç¯å¢ƒçš„åº“ã€‚ Single SPA ä¸­ä½¿ç”¨åˆ°äº†SystemJSï¼ŒSystemJSæ˜¯ä¸€ä¸ªè¿è¡Œæ—¶åŠ è½½æ¨¡å—çš„å·¥å…·ï¼ˆåŠ¨æ€å¯¼å…¥å’Œå¯¼å…¥æ˜ å°„ï¼‰ï¼Œæ˜¯ç°é˜¶æ®µä¸‹(æµè§ˆå™¨å°šæœªæ­£å¼æ”¯æŒimportMap)åŸç”ŸES Moduleçš„å®Œå…¨æ›¿ä»£å“ï¼Œå¯¹æ¯”Webpack ä¹‹ç±»çš„ï¼Œ å…¶å®ä½ ä¹Ÿå¯ä»¥ç†è§£ä¸ºSystemJSæ˜¯ä¸ºäº†è§£å†³è½»é‡çº§ï¼Œä¸ç”¨æ‰“åŒ…ï¼Œå³å¯åšåˆ° import Vue from &#39;vue&#39; å½¢å¼å»å¯¼åŒ… importmapçš„å½¢å¼ï¼Œå…¼å®¹æ€§å·® &lt;script type=\"importmap\"> { \"imports\": { \"dayjs\": \"https://cdn.skypack.dev/dayjs@1.10.7\", } } &lt;/script> systemjså½¢å¼ &lt;script type=\"systemjs-importmap\"> { \"imports\": { \"@react-mf/root-config\": \"//localhost:9000/react-mf-root-config.js\" } } &lt;/script> SystemJSåŠ¨æ€åŠ è½½çš„æ¨¡å—å¿…é¡»æ˜¯SystemJSæ¨¡å—æˆ–è€…UMDæ¨¡å—ã€‚ 2.å¼•å…¥å…¬å…±ä¾èµ–SystemJS å¦ä¸€ä¸ªå¥½å¤„å°±æ˜¯å¯ä»¥é€šè¿‡ importmap å¼•å…¥å…¬å…±ä¾èµ–ã€‚ å‡å¦‚ï¼Œæˆ‘ä»¬æœ‰ä¸‰ä¸ªå­åº”ç”¨ï¼Œå®ƒä»¬éƒ½æœ‰å…¬å…±ä¾èµ–é¡¹ antdï¼Œé‚£æ¯ä¸ªå­åº”ç”¨æ‰“åŒ…å‡ºæ¥éƒ½ä¼šæœ‰ä¸€ä»½ antd çš„ä»£ç ï¼Œå°±æ˜¾ç¤ºå¾ˆå†—ä½™ã€‚ï¼ˆqiankunå°±æœ‰è¿™ç§å†—ä½™ï¼‰ ä¸€ä¸ªè§£å†³æ–¹æ³•å°±æ˜¯åœ¨ä¸»åº”ç”¨é‡Œï¼Œé€šè¿‡ importmap ç›´æ¥æŠŠ antd ä»£ç å¼•å…¥è¿›æ¥ï¼Œå­åº”ç”¨åœ¨ Webpack è®¾ç½® external æŠŠ antd æ‰“åŒ…æ—¶æ’é™¤æ‰ã€‚å­åº”ç”¨æ‰“åŒ…å°±ä¸ä¼šæŠŠ antd æ‰“åŒ…è¿›å»äº†ï¼Œä½“ç§¯ä¹Ÿå˜å°äº†ã€‚ å¯¹äºå…¬å…±æ ·å¼çš„å¤„ç†ï¼› å°†å…¬å…±çš„ CSS æ”¾åˆ° importmap é‡Œï¼Œä¹Ÿå¯ä»¥ç†è§£ä¸ºåœ¨ index.html é‡Œç›´æ¥åŠ ä¸ª link è·å– antd çš„ CSS å®Œäº‹ å°†æ‰€æœ‰çš„å…¬å…±çš„ UI åº“éƒ½ import åˆ° utility é‡Œï¼Œå°† antd æ‰€æœ‰å†…å®¹éƒ½ exportï¼Œå†æŠŠ utility åŒ…æ”¾åˆ° importmap é‡Œï¼Œç„¶å import { Button } from &#39;@your-org-name/utility&#39;; å»å¼•å…¥é‡Œé¢çš„ç»„ä»¶ å…¶å®ä¸Šé¢ä¸¤ä¸ªæ–¹æ³•éƒ½å¤§åŒå°å¼‚ï¼Œæ€è·¯éƒ½æ˜¯åœ¨ä¸»åº”ç”¨ä¸€æ³¢å¼•å…¥ï¼Œåªæ˜¯ä¸€ä¸ªç»Ÿä¸€å¼•å…¥CSSï¼Œå¦ä¸€ä¸ªç»Ÿä¸€å¼•å…¥ UI åº“ã€‚ JSéš”ç¦»åœ¨single-spaä½¿ç”¨ import singleSpaLeakedGlobals from 'single-spa-leaked-globals'; const leakedGlobalsLifecycles = singleSpaLeakedGlobals({ globalVariableNames: ['$', 'jQuery', '_'], // æ–°æ·»åŠ çš„å…¨å±€å˜é‡ }) åœ¨ mount A å­åº”ç”¨æ—¶ï¼Œæ­£å¸¸æ·»åŠ å…¨å±€å˜é‡ï¼Œæ¯”å¦‚ jQuery çš„ $, lodash çš„ _ã€‚åœ¨ unmount A å­åº”ç”¨æ—¶ï¼Œç”¨ä¸€ä¸ªå¯¹è±¡è®°å½•ä¹‹å‰ç»™ window æ·»åŠ çš„å…¨å±€å˜é‡ï¼Œå¹¶æŠŠ A åº”ç”¨é‡Œæ·»åŠ  window çš„å˜é‡éƒ½åˆ æ‰ã€‚ä¸‹ä¸€æ¬¡å† mount A åº”ç”¨æ—¶ï¼ŒæŠŠè®°å½•çš„å…¨å±€å˜é‡é‡æ–°åŠ å›æ¥å°±å¥½äº†ã€‚ ä½†æ˜¯ï¼Œè¿™ä¸ªåº“çš„å±€é™æ€§åœ¨äºï¼šæ¯ä¸ª url åªèƒ½åŠ ä¸€ä¸ªå­ appï¼Œå¦‚æœå¤šä¸ªå­ app ä¹‹é—´è¿˜æ˜¯ä¼šè®¿é—®åŒä¸€ä¸ª window å¯¹è±¡ï¼Œä¹Ÿå› æ­¤ä¼šäº’ç›¸å¹²æ‰°ï¼Œå¹¶ä¸èƒ½åšåˆ°å®Œç¾çš„ JS æ²™ç®±ã€‚ CSSéš”ç¦»è€Œå…³äºcssçš„æ ·å¼éš”ç¦»ï¼Œå®˜æ–¹çš„å»ºè®®æ˜¯ ä½¿ç”¨ Scoped CSS è¦æ˜¯å«Œéº»çƒ¦ï¼Œå¯ä»¥åœ¨å­åº”ç”¨ Webpack ä½¿ç”¨ PostCSS Prefix Selector ç»™æ ·å¼è‡ªåŠ¨åŠ å‰ç¼€ äº¦æˆ–è€…å¼€å‘è€…è‡ªå·±ç”¨shadow-domæ¥å¤„ç†â€¦ why SystemJSéƒ½2022å¹´äº†ï¼Œæ€ä¹ˆè¿˜è¦åœ¨æµè§ˆå™¨ç¯å¢ƒå†™ JS å‘¢ï¼Ÿä¸ä¸Šä¸ª Webpack éƒ½ä¸å¥½æ„æ€è¯´è‡ªå·±æ˜¯å‰ç«¯å¼€å‘äº†â€¦ é‚£ä¸ºä»€ä¹ˆ single-spa è¿˜è¦æ¨è SystemJS å‘¢ï¼Ÿä½†æ˜¯æ ¹æ®çŸ¥ä¹ä¸Šä¼˜è´¨ç­”ä¸»å†™ä»£ç çš„æµ·æ€ªçŒœæµ‹æ˜¯å› ä¸º single-spa å¸Œæœ›ä¸»åº”ç”¨åº”è¯¥å°±ä¸€ä¸ªç©ºå£³å­ï¼Œåªéœ€è¦ç®¡å†…å®¹è¦æ”¾åœ¨å“ªä¸ªåœ°æ–¹ï¼Œæ‰€æœ‰çš„åŠŸèƒ½ã€äº¤äº’éƒ½åº”è¯¥äº¤ç”± index.html æ¥ç»Ÿä¸€ç®¡ç†ã€‚ï¼ˆç›´æ¥åœ¨htmlé‡Œå†™æ»¡scriptæƒ³æƒ³å°±å¯æ€•ï¼‰ è¿™ä¹Ÿè¡¨æ˜äº†ï¼š èµ„æºç½—åˆ—ï¼šåœ¨systemjsä¸­ï¼Œæˆ‘ä»¬å¿…é¡»æ‰‹åŠ¨å®ç°åº”ç”¨åŠ è½½é€»è¾‘ï¼ŒæŒ¨ä¸ªç½—åˆ—å­åº”ç”¨éœ€è¦åŠ è½½çš„èµ„æºï¼Œè¿™åœ¨å¤§å‹é¡¹ç›®é‡Œæ˜¯ååˆ†å›°éš¾çš„ï¼ˆç‰¹åˆ«æ˜¯ä½¿ç”¨äº†æ–‡ä»¶åhashæ—¶ï¼‰ï¼›å¦å¤–å®ƒåªèƒ½ä»¥jsæ–‡ä»¶ä¸ºå…¥å£ï¼Œæ— æ³•ç›´æ¥ä»¥htmlä¸ºå…¥å£ï¼Œè¿™ä½¿å¾—åµŒå…¥å­åº”ç”¨å˜å¾—å¾ˆå›°éš¾ï¼Œä¹Ÿæ­£å› æ­¤ï¼Œsingle-spaä¸èƒ½ç›´æ¥åŠ è½½jQueryåº”ç”¨ã€‚ èµ„æºåŠ è½½ä¼˜åŒ–ï¼šå°†æ•´ä¸ªå¾®åº”ç”¨æ‰“åŒ…æˆä¸€ä¸ª JS æ–‡ä»¶ï¼Œå¸¸è§çš„æ‰“åŒ…ä¼˜åŒ–åŸºæœ¬ä¸Šéƒ½æ²¡äº†ï¼Œæ¯”å¦‚ï¼šæŒ‰éœ€åŠ è½½ã€é¦–å±èµ„æºåŠ è½½ä¼˜åŒ–ã€css ç‹¬ç«‹æ‰“åŒ…ç­‰ä¼˜åŒ–æªæ–½ã€‚ jsåç§°ï¼šé¡¹ç›®å‘å¸ƒä»¥åå‡ºç°äº† bug ï¼Œä¿®å¤ä¹‹åéœ€è¦æ›´æ–°ä¸Šçº¿ï¼Œä¸ºäº†æ¸…é™¤æµè§ˆå™¨ç¼“å­˜å¸¦æ¥çš„å½±å“ï¼Œä¸€èˆ¬æ–‡ä»¶åä¼šå¸¦ä¸Š chunkcontentï¼Œå¾®åº”ç”¨å‘å¸ƒä¹‹åæ–‡ä»¶åï¼ˆjs bundle ï¼‰éƒ½ä¼šå‘ç”Ÿå˜åŒ–ï¼Œè¿™æ—¶å€™è¿˜éœ€è¦æ›´æ–°ä¸»åº”ç”¨ä¸­å¾®åº”ç”¨é…ç½®ï¼Œç„¶åé‡æ–°ç¼–è¯‘ä¸»åº”ç”¨ç„¶åå‘å¸ƒï¼Œè¿™æ˜¯ä¸èƒ½å®¹å¿çš„ã€‚ ä½ å¯ä»¥ç†è§£ä¸ºæ¯æ¬¡æ–‡ä»¶åä¸€å˜åŒ–ï¼šjlkasjfdlkj.jalkjdsflk.jsï¼Œè¿™æ ·ä¸€æ¥ï¼Œæ¯æ¬¡å­åº”ç”¨ä¸€å‘å¸ƒï¼Œå…¥å£ JS æ–‡ä»¶åè‚¯å®šåˆè¦æ”¹äº†ï¼Œå¯¼è‡´ä¸»åº”ç”¨å¼•å…¥çš„ JS url åˆå¾—æ”¹äº† æ‰€ä»¥ï¼Œä¸ºäº†å¡«å¹³ single-spa é—ç•™ä¸‹æ¥çš„å‘ï¼Œé˜¿é‡ŒåŸºäº single-spa é€ å‡ºäº† qiankun å¾®å‰ç«¯æ¡†æ¶ï¼ŒçœŸæ­£å®ç°äº†å¾®å‰ç«¯çš„æ‰€æœ‰ç‰¹æ€§. 6.Qiankunqiankunæ˜¯åŸºäºsingle-spaå¼€å‘çš„ Single-spaæ§åˆ¶è·¯ç”±å’Œåº”ç”¨å…¥å£ + qiankun JSã€CSSéš”ç¦»å’Œåº”ç”¨é€šä¿¡ + import-html-entryæ§åˆ¶åº”ç”¨åŠ è½½(single-spaç”¨çš„æ˜¯system.js) qiankunåŸºäºsingle-spaï¼ŒåŠ å¼ºäº†å¾®åº”ç”¨é›†æˆèƒ½åŠ›ï¼Œå´æŠ›å¼ƒäº†å¾®æ¨¡å—çš„èƒ½åŠ›ã€‚æ‰€ä»¥ï¼Œå®ƒä»¬çš„åŒºåˆ«å°±æ˜¯å¾®æœåŠ¡çš„ç²’åº¦ï¼Œqiankunçš„æ‰€èƒ½æœåŠ¡çš„ç²’åº¦æ˜¯åº”ç”¨çº§åˆ«ï¼Œè€Œsingle-spaåˆ™æ˜¯æ¨¡å—çº§åˆ«ã€‚å®ƒä»¬éƒ½èƒ½å°†å‰ç«¯è¿›è¡Œæ‹†åˆ†ï¼Œåªæ˜¯æ‹†åˆ†çš„ç²’åº¦ä¸åŒç½¢äº†ã€‚ å¾®åº”ç”¨åŠ è½½å™¨ï¼šâ€œå¾®â€çš„ç²’åº¦æ˜¯åº”ç”¨ï¼Œä¹Ÿå°±æ˜¯HTMLï¼Œå®ƒåªèƒ½åšåˆ°åº”ç”¨çº§åˆ«çš„åˆ†äº« å¾®æ¨¡å—åŠ è½½å™¨ï¼šâ€œå¾®â€çš„ç²’åº¦æ˜¯æ¨¡å—ï¼Œä¹Ÿå°±æ˜¯JSæ¨¡å—ï¼Œå®ƒèƒ½åšåˆ°æ¨¡å—çº§åˆ«çš„åˆ†äº« ä¸¤ä¸ªæ¡†æ¶å‡ºç°çš„èƒŒæ™¯ï¼š qiankunï¼šé˜¿é‡Œå†…éƒ¨æœ‰å¤§é‡å¹´ä¹…å¤±ä¿®çš„é¡¹ç›®ï¼Œä¸šåŠ¡ä¾§æ€¥éœ€å·¥å…·å»æŠŠä»–ä»¬å¿«é€Ÿã€å®‰å…¨çš„é›†æˆåˆ°ä¸€èµ·ã€‚åœ¨è¿™ä¸ªè§’åº¦ï¼Œä¹¾å¤æ ¹æœ¬æ²¡æœ‰åšæ¨¡å—è”é‚¦çš„éœ€æ±‚ï¼Œå®ƒçš„éœ€æ±‚ä»…ä»…æ˜¯å¦‚ä½•å¿«é€Ÿã€å®‰å…¨çš„æŠŠé¡¹ç›®é›†æˆèµ·æ¥ã€‚æ‰€ä»¥ä¹¾å¤æ˜¯æƒ³åšä¸€ä¸ªå¾®å‰ç«¯å·¥å…·ã€‚ single-spaï¼šå­¦ä¹ åç«¯çš„å¾®æœåŠ¡ï¼Œå®ç°å‰ç«¯çš„å¾®æœåŠ¡åŒ–ï¼Œè®©åº”ç”¨ã€ç»„ä»¶ä»¥åŠé€»è¾‘éƒ½æˆä¸ºå¯å…±äº«çš„å¾®æœåŠ¡ï¼Œå®ç°çœŸæ­£æ„ä¹‰ä¸Šçš„å¾®å‰ç«¯ã€‚æ‰€ä»¥single-spaæ˜¯æƒ³åšä¸€ä¸ªgame-changerã€‚ csséš”ç¦»ç›®å‰qiankunä¸»è¦æä¾›äº†ä¸¤ç§æ ·å¼éš”ç¦»æ–¹æ¡ˆ ä¸€ç§æ˜¯åŸºäºshadowDomçš„ï¼› åœ¨é…ç½®çš„æ—¶å€™å½“å¯ç”¨strictStyleIsolationæ—¶ï¼Œqiankunå°†é‡‡ç”¨shadowDomçš„æ–¹å¼è¿›è¡Œæ ·å¼éš”ç¦»ï¼Œå³ä¸ºå­åº”ç”¨çš„æ ¹èŠ‚ç‚¹åˆ›å»ºä¸€ä¸ªshadow rootï¼Œæ•´ä¸ªåº”ç”¨çš„æ‰€æœ‰DOMå°†å½¢æˆä¸€æ£µshadow treeï¼Œå®ƒå†…éƒ¨æ‰€æœ‰èŠ‚ç‚¹çš„æ ·å¼å¯¹æ ‘å¤–é¢çš„èŠ‚ç‚¹æ— æ•ˆï¼Œæ‰€æœ‰å°±å®ç°äº†æ ·å¼éš”ç¦»ã€‚ const supportShadowDOM = !!document.head.attachShadow || !!(document.head as any).createShadowRoot; if (strictStyleIsolation) { if (!supportShadowDOM) { // æŠ¥é”™ // ... } else { // æ¸…é™¤åŸæœ‰çš„å†…å®¹ const { innerHTML } = appElement; appElement.innerHTML = ''; let shadow: ShadowRoot; if (appElement.attachShadow) { // æ·»åŠ  shadow DOM èŠ‚ç‚¹ shadow = appElement.attachShadow({ mode: 'open' }); } else { // deprecated çš„æ“ä½œ // ... } // åœ¨ shadow DOM èŠ‚ç‚¹æ·»åŠ å†…å®¹ shadow.innerHTML = innerHTML; } } ä½†æ˜¯è¿™ç§æ–¹æ¡ˆæ˜¯å­˜åœ¨ç¼ºé™·çš„ã€‚å› ä¸ºæŸäº›UIæ¡†æ¶å¯èƒ½ä¼šç”Ÿæˆä¸€äº›å¼¹å‡ºæ¡†ç›´æ¥æŒ‚è½½åˆ°document.bodyä¸‹ï¼Œæ­¤æ—¶ç”±äºè„±ç¦»äº†shadow treeï¼Œæ‰€ä»¥å®ƒçš„æ ·å¼ä»ç„¶ä¼šå¯¹å…¨å±€é€ æˆæ±¡æŸ“ã€‚ åŸºäº ShadowDOM çš„ä¸¥æ ¼æ ·å¼éš”ç¦»å¹¶ä¸æ˜¯ä¸€ä¸ªå¯ä»¥æ— è„‘ä½¿ç”¨çš„æ–¹æ¡ˆï¼Œå¤§éƒ¨åˆ†æƒ…å†µä¸‹éƒ½éœ€è¦æ¥å…¥åº”ç”¨åšä¸€äº›é€‚é…åæ‰èƒ½æ­£å¸¸åœ¨ ShadowDOM ä¸­è¿è¡Œèµ·æ¥ï¼ˆæ¯”å¦‚ react åœºæ™¯ä¸‹éœ€è¦è§£å†³è¿™äº› é—®é¢˜ï¼Œä½¿ç”¨è€…éœ€è¦æ¸…æ¥šå¼€å¯äº† strictStyleIsolation æ„å‘³ç€ä»€ä¹ˆã€‚åç»­ qiankun ä¼šæä¾›æ›´å¤šå®˜æ–¹å®è·µæ–‡æ¡£å¸®åŠ©ç”¨æˆ·èƒ½å¿«é€Ÿçš„å°†åº”ç”¨æ”¹é€ æˆå¯ä»¥è¿è¡Œåœ¨ ShadowDOM ç¯å¢ƒçš„å¾®åº”ç”¨ å¦ä¸€ç§åˆ™æ˜¯å®éªŒæ€§çš„ï¼Œæ€è·¯ç±»ä¼¼äºVueä¸­çš„scopedå±æ€§ï¼Œç»™æ¯ä¸ªå­åº”ç”¨çš„æ ¹èŠ‚ç‚¹æ·»åŠ ä¸€ä¸ªç‰¹æ®Šå±æ€§ï¼Œç”¨ä½œå¯¹æ‰€æœ‰cssé€‰æ‹©å™¨çš„çº¦æŸã€‚ qiankuné¦–å…ˆåˆ¤æ–­å½“å‰sandboxæ˜¯å¦æ”¯æŒscope cssï¼Œæ”¯æŒçš„è¯æ‰æ·»åŠ  export function isEnableScopedCSS(sandbox: FrameworkConfiguration['sandbox']) { if (typeof sandbox !== 'object') { return false; } if (sandbox.strictStyleIsolation) { return false; } return !!sandbox.experimentalStyleIsolation; } åœ¨é…ç½®çš„æ—¶å€™å½“å¯ç”¨experimentalStyleIsolationã€‚è¿™ç§æ–¹æ¡ˆçš„ç­–ç•¥æ˜¯ä¸ºå­åº”ç”¨çš„æ ¹èŠ‚ç‚¹æ·»åŠ ä¸€ä¸ªç‰¹å®šçš„éšæœºå±æ€§ // å‡å¦‚å­åº”ç”¨åå­—å« child // è½¬æ¢å‰ .app-main { font-size: 14px; } // è½¬æ¢å div[data-qiankun=\"child\"] .app-main { font-size: 14px; } shadowdomçš„csséš”ç¦»å¼€å¯æ–¹å¼ï¼šstartçš„æ—¶å€™æˆ–è€…æ‰‹åŠ¨åŠ è½½å­åº”ç”¨çš„æ—¶å€™ä¼ å…¥optionï¼ŒoptionåŒ…å«sanboxå±æ€§ï¼Œsanboxçš„strictStyleIsolationä¸ºtrue scopeå¼€å¯æ–¹å¼ï¼šstartçš„æ—¶å€™æˆ–è€…æ‰‹åŠ¨åŠ è½½å­åº”ç”¨çš„æ—¶å€™ä¼ å…¥optionï¼ŒoptionåŒ…å«sanboxå±æ€§ï¼Œsanboxçš„experimentalStyleIsolationä¸ºtrue start({ sandbox: { strictStyleIsolation?: boolean, experimentalStyleIsolation?: true } }) loadMicroApp(app, { sandbox: { strictStyleIsolation?: boolean, experimentalStyleIsolation?: true } }) æ³¨æ„äº‹é¡¹: å¯¹äºscopeçš„csséš”ç¦»æ–¹æ¡ˆï¼Œç›®å‰ @keyframes, @font-face, @import, @page ç­‰è§„åˆ™ä¸ä¼šæ”¯æŒ (i.e. ä¸ä¼šè¢«æ”¹å†™) jséš”ç¦»qiankuné€šè¿‡import-html-entryï¼Œå¯ä»¥å¯¹htmlå…¥å£è¿›è¡Œè§£æï¼Œå¹¶è·å¾—ä¸€ä¸ªå¯ä»¥æ‰§è¡Œè„šæœ¬çš„æ–¹æ³•execScriptsï¼ˆä¸Šé¢æåŠåˆ°çš„ execScript ï¼‰ã€‚ qiankuné»˜è®¤å¯ç”¨æ²™ç®±ï¼Œä¹Ÿå°±æ˜¯ä¸Šé¢csséš”ç¦»ä¸­ starté‡Œçš„é‚£ä¸ªsanboxé€‰é¡¹ï¼Œæ­¤æ—¶ä¼šå¼€å¯jséš”ç¦»ä¸¥æ ¼æ¨¡å¼ strictGlobal ç¬¬ä¸€æ­¥åˆ›å»ºä¸€ä¸ªæ²™ç®±å®¹å™¨ sandboxContainer ä¸‰ç§æ²™ç®±ï¼š é¦–å…ˆåˆå§‹åŒ–ä¸€ä¸ªæ²™ç®±ProxySandboxï¼Œé‡Œé¢åˆ›é€ ä¸€ä¸ªfakeWindowï¼Œå®ƒæ‹¥æœ‰windowçš„æ‰€æœ‰å±æ€§ï¼Œå¹¶ä¸”é€šè¿‡new Proxyè¿”å›ä¸€ä¸ªfakeWindowçš„ä»£ç†å¯¹è±¡ SnapshotSandboxï¼š é’ˆå¯¹IE11ä¸æ”¯æŒproxyï¼Œæ‰€ä»¥qiankuné€šè¿‡å¿«ç…§ç­–ç•¥æ¥éš”ç¦»jsï¼Œç¼ºç‚¹æ˜¯æ— æ³•æ”¯æŒå¤šå®ä¾‹åœºæ™¯ã€‚(å¯ä»¥ç†è§£ä¸ºä½¿ç”¨single-spaçš„jséš”ç¦»æ–¹æ³•) if (window.Proxy) { sandbox = useLooseSandbox ? new LegacySandbox(appName, globalContext) : new ProxySandbox(appName, globalContext); } else { sandbox = new SnapshotSandbox(appName); } class SnapshotSandbox { ... active() { // è®°å½•å½“å‰å¿«ç…§ this.windowSnapshot = {} as Window; getKeys(window).forEach(key => { this.windowSnapshot[key] = window[key]; }) // æ¢å¤ä¹‹å‰çš„å˜æ›´ getKeys(this.modifyPropsMap).forEach((key) => { window[key] = this.modifyPropsMap[key]; }); this.sandboxRunning = true; } inactive() { this.modifyPropsMap = {}; // è®°å½•å˜æ›´ï¼Œæ¢å¤ç¯å¢ƒ getKeys(window).forEach((key) => { if (window[key] !== this.windowSnapshot[key]) { this.modifyPropsMap[key] = window[key]; window[key] = this.windowSnapshot[key]; } }); this.sandboxRunning = false; } } LegacySandbox: å…¶å®çœ‹åˆ°æºç è¿˜æœ‰ä¸ªLegacySandboxï¼Œä¸è¿‡åé¢åºŸå¼ƒäº†ï¼Œå› ä¸ºæ²¡æœ‰äº†sanboxé…ç½®æ²¡æœ‰äº†looseè¿™ä¸ªé…ç½® const useLooseSandbox = typeof sandbox === 'object' &amp;&amp; !!sandbox.loose; const sandbox = useLooseSandbox ? new LegacySandbox(appName, globalContext) : new ProxySandbox(appName, globalContext); æ‰§è¡Œjsä»£ç ï¼š é€šè¿‡html-import-entryå¾—åˆ°jsæ‰§è¡Œå‡½æ•°ï¼š execScripts æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä»–é€šè¿‡ä¼ å…¥proxyï¼Œæ‰§è¡Œ getExecutableScriptå¾—åˆ°js codeï¼Œå…¶ä¸­ä½¿ç”¨ function(){}(with(window){fn.bind(window.proxy)(window.proxy, window.proxy, window.proxy)}) var code = getExecutableScript(scriptSrc, rawCode, proxy, strictGlobal); evalCode(scriptSrc, code); function getExecutableScript(scriptSrc, scriptText, proxy, strictGlobal) { var sourceUrl = isInlineCode(scriptSrc) ? '' : \"//# sourceURL=\".concat(scriptSrc, \"\\n\"); // é€šè¿‡è¿™ç§æ–¹å¼è·å–å…¨å±€ windowï¼Œå› ä¸º script ä¹Ÿæ˜¯åœ¨å…¨å±€ä½œç”¨åŸŸä¸‹è¿è¡Œçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬é€šè¿‡ window.proxy ç»‘å®šæ—¶ä¹Ÿå¿…é¡»ç¡®ä¿ç»‘å®šåˆ°å…¨å±€ window ä¸Š // å¦åˆ™åœ¨åµŒå¥—åœºæ™¯ä¸‹ï¼Œ window.proxy è®¾ç½®çš„æ˜¯å†…å±‚åº”ç”¨çš„ windowï¼Œè€Œä»£ç å…¶å®æ˜¯åœ¨å…¨å±€ä½œç”¨åŸŸè¿è¡Œçš„ï¼Œä¼šå¯¼è‡´é—­åŒ…é‡Œçš„ window.proxy å–çš„æ˜¯æœ€å¤–å±‚çš„å¾®åº”ç”¨çš„ proxy var globalWindow = (0, eval)('window'); globalWindow.proxy = proxy; // TODO é€šè¿‡ strictGlobal æ–¹å¼åˆ‡æ¢ with é—­åŒ…ï¼Œå¾… with æ–¹å¼å‘è¶Ÿå¹³åå†åˆå¹¶ return strictGlobal ? \";(function(window, self, globalThis){with(window){;\".concat(scriptText, \"\\n\").concat(sourceUrl, \"}}).bind(window.proxy)(window.proxy, window.proxy, window.proxy);\") : \";(function(window, self, globalThis){;\".concat(scriptText, \"\\n\").concat(sourceUrl, \"}).bind(window.proxy)(window.proxy, window.proxy, window.proxy);\"); } // for prefetch æ­¤æ—¶withè¯­æ³•å†…çš„windowå°±æ˜¯proxyï¼šæŠŠè§£æå‡ºçš„scriptTextï¼ˆå³è„šæœ¬å­—ç¬¦ä¸²ï¼‰ç”¨with(window){}åŒ…è£¹èµ·æ¥ï¼Œç„¶åæŠŠwindow.proxyä½œä¸ºå‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°ä¼ è¿›æ¥ï¼Œæ‰€ä»¥withè¯­æ³•å†…çš„windowå®é™…ä¸Šæ˜¯window.proxyã€‚æ­¤æ—¶æˆ‘ä»¬çš„jsä»£ç æ‰§è¡Œæ—¶ï¼Œå…¨å±€å˜é‡éƒ½ä¼šè¢«æŒ‚è½½åˆ°æ²™ç®±çš„proxyå½“ä¸­å»ã€‚ ç„¶åå†é€šè¿‡ evalCodeå‡½æ•°å…¨å±€æ‰§è¡Œjsä»£ç  export function evalCode(scriptSrc, code) { var key = scriptSrc; if (!evalCache[key]) { var functionWrappedCode = \"window.__TEMP_EVAL_FUNC__ = function(){\".concat(code, \"}\"); (0, eval)(functionWrappedCode); evalCache[key] = window.__TEMP_EVAL_FUNC__; delete window.__TEMP_EVAL_FUNC__; } var evalFunc = evalCache[key]; evalFunc.call(window); } åº”ç”¨é€šä¿¡ä¸€èˆ¬æ¥è¯´ï¼Œå¾®å‰ç«¯ä¸­å„ä¸ªåº”ç”¨ä¹‹å‰çš„é€šä¿¡éƒ½æ˜¯æ¯”è¾ƒå°‘çš„ã€‚å½“ç„¶éƒ¨åˆ†å‘¢å°‘é‡çš„é€šä¿¡æ˜¯åœ¨æ‰€éš¾å…çš„ï¼Œqiankunå®˜æ–¹æä¾›äº†ä¸€ä¸ªç®€è¦çš„æ–¹æ¡ˆï¼Œæ€è·¯æ˜¯åŸºäºä¸€ä¸ªå…¨å±€çš„globalStateå¯¹è±¡ã€‚è¿™ä¸ªå¯¹è±¡ç”±åŸºåº§åº”ç”¨è´Ÿè´£åˆ›å»ºï¼Œå†…éƒ¨åŒ…å«ä¸€ç»„ç”¨äºé€šä¿¡çš„å˜é‡ï¼Œä»¥åŠä¸¤ä¸ªåˆ†åˆ«ç”¨äºä¿®æ”¹å˜é‡å€¼å’Œç›‘å¬å˜é‡å˜åŒ–çš„æ–¹æ³•ï¼šsetGlobalStateå’ŒonGlobalStateChangeã€‚ é£å†°JSéš”ç¦»é£å†°ä¹Ÿæ˜¯ä¸€æ¬¾é˜¿é‡Œçš„å¾®å‰ç«¯æ–¹æ¡ˆï¼šå¯¹äºcssæ±¡æŸ“ï¼ˆcsséš”ç¦»ï¼‰ï¼Œç”±äºå¾®åº”ç”¨æ˜¯ä¸åŒçš„è·¯ç”±ï¼Œæ‰€ä»¥æš‚æ—¶æ²¡æœ‰è€ƒè™‘ï¼ˆå®éªŒæ€§çš„shadow domæ–¹æ¡ˆï¼‰ jséš”ç¦» è§„èŒƒ å¾®åº”ç”¨é¿å…æ”¹å˜å…¨å±€çŠ¶æ€ åŸºäº Proxy çš„è¿è¡Œæ²™ç®± å‚è€ƒäºï¼š å¾®å‰ç«¯æŠ€æœ¯åŸç† â€”â€” é£ä¹¦å›¢é˜Ÿ æœ€å®¹æ˜“çœ‹æ‡‚çš„å¾®å‰ç«¯çŸ¥è¯† åŸºäº iframe çš„å…¨æ–°å¾®å‰ç«¯æ–¹æ¡ˆ(è…¾è®¯PCG) å°†å¾®å‰ç«¯åšåˆ°æè‡´-æ— ç•Œå¾®å‰ç«¯æ–¹æ¡ˆ vivoåŸºäº iframe çš„å¾®å‰ç«¯æ¡†æ¶ â€”â€” æ“å¤© å¾®å‰ç«¯è§£å†³æ–¹æ¡ˆ å¾®å‰ç«¯åœ¨ç¾å›¢å¤–å–çš„å®è·µ ã€å¾®å‰ç«¯ã€‘single-spa åˆ°åº•æ˜¯ä¸ªä»€ä¹ˆé¬¼ å¾®å‰ç«¯æ¡†æ¶qiankunä¹‹åŸç†ä¸å®æˆ˜ æ­å¼€ import-html-entry é¢çº± å¾®å‰ç«¯æ¡†æ¶ ä¹‹ qiankun ä»å…¥é—¨åˆ°æºç åˆ†æ å¯èƒ½æ˜¯ä½ è§è¿‡æœ€å®Œå–„çš„å¾®å‰ç«¯è§£å†³æ–¹æ¡ˆ ã€å¾®å‰ç«¯ã€‘qiankun åˆ°åº•æ˜¯ä¸ªä»€ä¹ˆé¬¼ æ›´å¤šå…³äºå¾®å‰ç«¯çš„ç›¸å…³ä»‹ç»ï¼Œæ¨èå¤§å®¶å¯ä»¥å»çœ‹è¿™å‡ ç¯‡æ–‡ç« ï¼šï¼ˆqiankunå®˜ç½‘çš„æ¨èï¼‰ Micro Frontends Micro Frontends from martinfowler.com å¯èƒ½æ˜¯ä½ è§è¿‡æœ€å®Œå–„çš„å¾®å‰ç«¯è§£å†³æ–¹æ¡ˆ å¾®å‰ç«¯çš„æ ¸å¿ƒä»·å€¼ ä¸ºä»€ä¹ˆä¸ä½¿ç”¨iframeï¼šhttps://www.yuque.com/kuitos/gky7yw/gesexv","categories":[{"name":"å‰ç«¯","slug":"å‰ç«¯","permalink":"https://taylor12138.github.io/categories/%E5%89%8D%E7%AB%AF/"}],"tags":[],"author":"Hello"},{"title":"Hexoçš„éƒ¨åˆ†é—®é¢˜","slug":"Hexoçš„éƒ¨åˆ†é—®é¢˜","date":"2022-05-08T07:16:32.890Z","updated":"2022-05-08T07:16:32.890Z","comments":true,"path":"2022/05/08/hexo-de-bu-fen-wen-ti/","link":"","permalink":"https://taylor12138.github.io/2022/05/08/hexo-de-bu-fen-wen-ti/","excerpt":"","text":"Quick Startæ‰“å¼€win+Rè¿›å…¥cmdï¼Œç„¶ååœ¨æ­£ç¡®ç›®å½•ä¸‹è¿›å…¥ï¼šcd source_post(æŒ‡å®šblogä¸‹) åŸºæœ¬æ“ä½œç”¨typoraä¿®æ”¹å®Œæ¯•åï¼Œ1.ä½¿ç”¨â€œhexo cleanâ€è¿›è¡Œæ¸…ç†ï¼ˆ1.5.è‹¥æ˜¯å‘ç”Ÿä¸»é¢˜ç­‰ä¿®æ”¹åï¼Œè¦æ¥ä¸Šhexo g æ¥å»ºç«‹ï¼‰2.æ¥ä¸Šâ€œhexo sâ€å³å¯è¿›å…¥ç½‘ç«™æŸ¥çœ‹ï¼ˆé€€å‡ºé”®ä½ï¼šcontrol+Cï¼Œyï¼‰ï¼ˆæœ¬åœ°æµè§ˆï¼‰3.å†æ¬¡éƒ¨ç½²åˆ°è¿œç«¯ï¼šhexo d å…³äºä¸»é¢˜1.å¯ä»¥ä½¿ç”¨git clone ç½‘å€.git themes\\æ–°å»ºç›®å½•åï¼ˆæˆ–è€…ä½¿ç”¨ç äº‘giteeè¿›è¡Œä¸‹è½½ï¼Œç„¶åå¤åˆ¶åˆ°themesç›®å½•ä¸‹ï¼‰2.cd.. (å›åˆ°blogç›®å½•ä¸‹)notepad _config.ymlæŠŠè®°äº‹æœ¬é‡Œé¢çš„themeï¼šxxä¿®æ”¹æˆthemeï¼šä¸»é¢˜ç›®å½•å3.é‡æ–°æ‰§è¡Œâ€åŸºæœ¬æ“ä½œâ€ å…³äºå›¾ç‰‡å†_postç›®å½•ä¸‹å®‰è£… (å¿…é¡»å¾—æ˜¯è¿™ä¸ª) npm i https://github.com/CodeFalling/hexo-asset-image ç„¶åå†_postä¸‹æ–°å»ºå’Œmdæ–‡ä»¶åŒåçš„æ–‡ä»¶å¤¹ï¼Œæ”¾å…¥å›¾ç‰‡ï¼Œå†mdä¸­å¼•å…¥å³å¯ å¦‚æœè¿˜æ˜¯å‡ºç°ä¸Šä¼ åæ²¡æœ‰å›¾ç‰‡ï¼Œå¯èƒ½æ˜¯å› ä¸ºå›¾ç‰‡å‘½ä¸º â€˜ httpxxx â€˜ã€ç”šè‡³æ˜¯æ–‡ä»¶åä¸ºhttpä¹Ÿæ˜¯ä¸èƒ½è¢«å…è®¸çš„ï¼Œè¿™ç§æ ¼å¼ä¹Ÿæ˜¯ä¸èƒ½è¢«å…è®¸çš„ï¼ï¼ï¼ˆå› æ­¤æˆ‘ä¸å¾—ä¸æŠŠæ–‡ç« åæ”¹ä¸ºè¶…æ–‡æœ¬ä¼ è¾“åè®®ã€‚ã€‚ã€‚ï¼‰ å‚è€ƒæ–‡çŒ® https://hexo.io/docs/one-command-deployment.html) å‰ç«¯è§£æmarkdownæ–‡ä»¶å®ç° getStaticProps é¦–å…ˆï¼Œå®‰è£…gray-matterï¼Œå®ƒå¯ä»¥è®©æˆ‘ä»¬è§£ææ¯ä¸ª markdown æ–‡ä»¶ä¸­çš„å…ƒæ•°æ®ã€‚ npm install gray-matter ä¸ºäº†å‘ˆç° markdown å†…å®¹ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨è¯¥remarkåº“ã€‚é¦–å…ˆï¼Œè®©æˆ‘ä»¬å®‰è£…å®ƒï¼š npm install remark remark-htmlå¯ä»¥æ•ˆä»¿nextå®˜ç½‘åˆ¶ä½œçš„ï¼Œå†™ä¸€ä¸ªSSGçš„åšå®¢ç½‘ç«™ï¼šhttps://www.nextjs.cn/learn/basics/data-fetching/implement-getstaticprops","categories":[],"tags":[],"author":"Hello"},{"title":"è®¡ç®—æœºåŸºç¡€çŸ¥è¯†åˆé›†","slug":"è®¡ç®—æœºåŸºç¡€çŸ¥è¯†åˆé›†","date":"2022-05-05T07:30:01.196Z","updated":"2023-05-29T09:33:35.813Z","comments":true,"path":"2022/05/05/ji-suan-ji-ji-chu-zhi-shi-he-ji/","link":"","permalink":"https://taylor12138.github.io/2022/05/05/ji-suan-ji-ji-chu-zhi-shi-he-ji/","excerpt":"","text":"å­—ç¬¦ç¼–ç ASCIIæ¯ä¸€ä½2è¿›åˆ¶æœ‰0ã€1ä¸¤ç§çŠ¶æ€ï¼Œ1å­—èŠ‚ = 256ç§çŠ¶æ€ ä¸Šä¸ªä¸–çºª60å¹´ä»£ï¼Œç¾å›½åˆ¶å®šäº†ä¸€å¥—å­—ç¬¦ç¼–ç ï¼Œå¯¹è‹±è¯­å­—ç¬¦ä¸äºŒè¿›åˆ¶ä½ä¹‹é—´çš„å…³ç³»ï¼Œåšäº†ç»Ÿä¸€è§„å®šã€‚è¿™è¢«ç§°ä¸º ASCII ç ï¼Œä¸€ç›´æ²¿ç”¨è‡³ä»Šã€‚ ASCII ç ä¸€å…±è§„å®šäº†128ä¸ªå­—ç¬¦çš„ç¼–ç  ä½†æ˜¯è‹±è¯­ç”¨128ä¸ªç¬¦å·ç¼–ç å°±å¤Ÿäº†ï¼Œä½†æ˜¯ç”¨æ¥è¡¨ç¤ºå…¶ä»–è¯­è¨€ï¼Œ128ä¸ªç¬¦å·æ˜¯ä¸å¤Ÿçš„ï¼ˆç‰¹åˆ«æ˜¯äºšæ´²å›½å®¶ï¼Œæˆ‘ä»¬æ±‰å­—å°±æ›´åŠ éš¾é¡¶äº†ï¼‰ UnicodeUnicodeï¼Œç»Ÿä¸€ç ï¼ˆUnicodeï¼‰ï¼Œä¹Ÿå«ä¸‡å›½ç ã€‚å°±åƒå®ƒçš„åå­—éƒ½è¡¨ç¤ºçš„ï¼Œè¿™æ˜¯ä¸€ç§æ‰€æœ‰ç¬¦å·çš„ç¼–ç ã€‚ å®ƒæ˜¯ä¸€ä¸ªå¾ˆå¤§çš„é›†åˆï¼Œç°åœ¨çš„è§„æ¨¡å¯ä»¥å®¹çº³100å¤šä¸‡ä¸ªç¬¦å· ç½‘ç»œä¸Šæµä¼ æ¯”è¾ƒå¹¿çš„è¯´æ³•æ˜¯ï¼š ASCIIç¼–ç æ˜¯1ä¸ªå­—èŠ‚ï¼Œè€ŒUnicodeç¼–ç é€šå¸¸æ˜¯å¤šä¸ªå­—èŠ‚ã€‚ ç”¨Unicodeç¼–ç æ¯”ASCIIç¼–ç éœ€è¦å¤šå¾ˆå¤šçš„çš„å­˜å‚¨ç©ºé—´ é˜®ä¸€å³°è€å¸ˆï¼šUnicodeæœ‰ä¸¤ä¸ªé—®é¢˜ ç¬¬ä¸€ä¸ªé—®é¢˜æ˜¯ï¼Œå¦‚ä½•æ‰èƒ½åŒºåˆ« Unicode å’Œ ASCII ï¼Ÿè®¡ç®—æœºæ€ä¹ˆçŸ¥é“ä¸‰ä¸ªå­—èŠ‚è¡¨ç¤ºä¸€ä¸ªç¬¦å·ï¼Œè€Œä¸æ˜¯åˆ†åˆ«è¡¨ç¤ºä¸‰ä¸ªç¬¦å·å‘¢ï¼Ÿ ç¬¬äºŒä¸ªé—®é¢˜æ˜¯ï¼Œæˆ‘ä»¬å·²ç»çŸ¥é“ï¼Œè‹±æ–‡å­—æ¯åªç”¨ä¸€ä¸ªå­—èŠ‚è¡¨ç¤ºå°±å¤Ÿäº†ï¼Œå¦‚æœ Unicode ç»Ÿä¸€è§„å®šï¼Œæ¯ä¸ªç¬¦å·ç”¨ä¸‰ä¸ªæˆ–å››ä¸ªå­—èŠ‚è¡¨ç¤ºï¼Œé‚£ä¹ˆæ¯ä¸ªè‹±æ–‡å­—æ¯å‰éƒ½å¿…ç„¶æœ‰äºŒåˆ°ä¸‰ä¸ªå­—èŠ‚æ˜¯0ï¼Œè¿™å¯¹äºå­˜å‚¨æ¥è¯´æ˜¯æå¤§çš„æµªè´¹ï¼Œæ–‡æœ¬æ–‡ä»¶çš„å¤§å°ä¼šå› æ­¤å¤§å‡ºäºŒä¸‰å€ï¼Œè¿™æ˜¯æ— æ³•æ¥å—çš„ã€‚ UTF-8UTF-8 å°±æ˜¯åœ¨äº’è”ç½‘ä¸Šä½¿ç”¨æœ€å¹¿çš„ä¸€ç§ Unicode çš„å®ç°æ–¹å¼ å…¶ä»–å®ç°æ–¹å¼è¿˜åŒ…æ‹¬ UTF-16ï¼ˆå­—ç¬¦ç”¨ä¸¤ä¸ªå­—èŠ‚æˆ–å››ä¸ªå­—èŠ‚è¡¨ç¤ºï¼‰å’Œ UTF-32ï¼ˆå­—ç¬¦ç”¨å››ä¸ªå­—èŠ‚è¡¨ç¤ºï¼‰ï¼Œä¸è¿‡åœ¨äº’è”ç½‘ä¸ŠåŸºæœ¬ä¸ç”¨ UTF-8 æœ€å¤§çš„ä¸€ä¸ªç‰¹ç‚¹ï¼Œå°±æ˜¯å®ƒæ˜¯ä¸€ç§å˜é•¿çš„ç¼–ç æ–¹å¼ã€‚å®ƒå¯ä»¥ä½¿ç”¨1~4ä¸ªå­—èŠ‚è¡¨ç¤ºä¸€ä¸ªç¬¦å·ï¼Œæ ¹æ®ä¸åŒçš„ç¬¦å·è€Œå˜åŒ–å­—èŠ‚é•¿åº¦ã€‚ è§„åˆ™ï¼ï¼ï¼ 1ï¼‰å¯¹äºå•å­—èŠ‚çš„ç¬¦å·ï¼Œå­—èŠ‚çš„ç¬¬ä¸€ä½è®¾ä¸º0ï¼Œåé¢7ä½ä¸ºè¿™ä¸ªç¬¦å·çš„ Unicode ç ã€‚å› æ­¤å¯¹äºè‹±è¯­å­—æ¯ï¼ŒUTF-8 ç¼–ç å’Œ ASCII ç æ˜¯ç›¸åŒçš„ã€‚ 2ï¼‰å¯¹äºnå­—èŠ‚çš„ç¬¦å·ï¼ˆn &gt; 1ï¼‰ï¼Œç¬¬ä¸€ä¸ªå­—èŠ‚çš„å‰nä½éƒ½è®¾ä¸º1ï¼Œç¬¬n + 1ä½è®¾ä¸º0ï¼Œåé¢å­—èŠ‚çš„å‰ä¸¤ä½ä¸€å¾‹è®¾ä¸º10ã€‚å‰©ä¸‹çš„æ²¡æœ‰æåŠçš„äºŒè¿›åˆ¶ä½ï¼Œå…¨éƒ¨ä¸ºè¿™ä¸ªç¬¦å·çš„ Unicode ç ã€‚ ä¸‹è¡¨æ€»ç»“äº†ç¼–ç è§„åˆ™ï¼Œå­—æ¯xè¡¨ç¤ºå¯ç”¨ç¼–ç çš„ä½ã€‚ Unicodeç¬¦å·èŒƒå›´ | UTF-8ç¼–ç æ–¹å¼ (åå…­è¿›åˆ¶) | ï¼ˆäºŒè¿›åˆ¶ï¼‰ --------------------+--------------------------------------------- 0000 0000-0000 007F | 0xxxxxxx 0000 0080-0000 07FF | 110xxxxx 10xxxxxx 0000 0800-0000 FFFF | 1110xxxx 10xxxxxx 10xxxxxx 0001 0000-0010 FFFF | 11110xxx 10xxxxxx 10xxxxxx 10xxxxxxUTF-8å’ŒUnicode ä¸¥çš„ Unicodeç  æ˜¯4E25ï¼ŒUTF-8 ç¼–ç æ˜¯E4B8A5 å‚è€ƒï¼šhttps://www.ruanyifeng.com/blog/2007/10/ascii_unicode_and_utf-8.htmlã€Šé˜®ä¸€å³°çš„ç½‘ç»œæ—¥å¿—ã€‹ ArrayBufferç±»å‹åŒ–æ•°ç»„ArrayBufferç±»å‹åŒ–æ•°ç»„çš„æ ¸å¿ƒæ˜¯ä¸€ä¸ªåä¸ºArrayBufferçš„ç±»å‹ æ¯ä¸ªArrayBufferå¯¹è±¡è¡¨ç¤ºçš„åªæ˜¯å†…å­˜ä¸­æŒ‡å®šçš„å­—èŠ‚æ•°;ä½†ä¸ä¼šæŒ‡å®šè¿™äº›å­—èŠ‚ç”¨äºä¿å­˜ä»€ä¹ˆç±»å‹çš„æ•°æ®ï¼›é€šè¿‡ArrayBufferèƒ½åšçš„ï¼Œå°±æ˜¯ä¸ºäº†å°†æ¥ä½¿ç”¨è€Œåˆ†é…ä¸€å®šæ•°é‡çš„å­—èŠ‚. // åˆ›å»ºä¸€ä¸ª8-byteçš„ArrayBuffer var b = new ArrayBuffer(8); // åˆ›å»ºä¸€ä¸ªbçš„å¼•ç”¨ï¼Œç±»å‹æ˜¯Int32ï¼Œèµ·å§‹ä½ç½®åœ¨0ï¼Œç»“æŸä½ç½®ä¸ºç¼“å†²åŒºå°¾éƒ¨ var v1 = new Int32Array(b); // åˆ›å»ºä¸€ä¸ªbçš„å¼•ç”¨ï¼Œç±»å‹æ˜¯Uint8ï¼Œèµ·å§‹ä½ç½®åœ¨2ï¼Œç»“æŸä½ç½®ä¸ºç¼“å†²åŒºå°¾éƒ¨ var v2 = new Uint8Array(b, 2); // åˆ›å»ºä¸€ä¸ªbçš„å¼•ç”¨ï¼Œç±»å‹æ˜¯Int16ï¼Œèµ·å§‹ä½ç½®åœ¨2ï¼Œæ€»é•¿åº¦ä¸º2 var v3 = new Int16Array(b, 2, 2); (æ¯”å¦‚threejså¸¸ä½¿ç”¨çš„Float32Array) Uint8uint8æ˜¯8ä½æ— ç¬¦å·æ•´å‹ï¼Œuint16æ˜¯16ä½æ— ç¬¦å·æ•´å‹ æ•´å‹æœ‰æ— ç¬¦å·ï¼ˆunsignedï¼‰å’Œæœ‰ç¬¦å·ï¼ˆsignedï¼‰ä¸¤ç§ç±»å‹ï¼Œåœ¨é»˜è®¤æƒ…å†µä¸‹å£°æ˜çš„æ•´å‹å˜é‡éƒ½æ˜¯æœ‰ç¬¦å·çš„ç±»å‹ï¼ˆcharæœ‰ç‚¹ç‰¹åˆ«ï¼‰ï¼Œå¦‚æœéœ€å£°æ˜æ— ç¬¦å·ç±»å‹çš„è¯å°±éœ€è¦åœ¨ç±»å‹å‰åŠ ä¸Šunsignedã€‚åœ¨ä¸€äº›ä¸å¯èƒ½å–å€¼ä¸ºè´Ÿæ•°çš„æ—¶å€™ï¼Œå¯ä»¥å®šä¹‰ä¸ºunsigned\\ï¼Œåœ¨ä¸€äº›åº•å±‚çš„åµŒå…¥å¼ç¼–ç¨‹çš„æ•°æ®ä¸€èˆ¬éƒ½æ˜¯æ— ç¬¦å·ã€‚ å‘½ä»¤çª—å£æœ‰æ—¶å€™æˆ‘ä»¬æ‰§è¡Œä¸€äº›å‘½ä»¤å¤±è´¥ï¼Œä½†æ˜¯å¾€ä¸Šæœ‰äººæ˜¯æˆåŠŸçš„ï¼Œå¯èƒ½æ˜¯å½“å‰ç»ˆç«¯ä¸æ”¯æŒ windowsç”¨æˆ·ï¼špowershellæ˜¯å¾®è½¯ç”¨æ¥æ›¿ä»£cmdçš„ï¼Œæˆ‘ä»¬å¯ä»¥cmdå’Œpowershellè½®æµè¯•ä¸€è¯•å‘½ä»¤çš„æ‰§è¡Œï¼Œæœç´¢å¼•æ“ä¸Šä¹Ÿæœ‰vscodeä¸­é»˜è®¤ç»ˆç«¯åˆ‡æ¢çš„æ–¹æ¡ˆï¼›é™¤æ­¤ä¹‹å¤–ï¼Œcoderwhyè€å¸ˆè¿˜æ¨èwindowsç”¨æˆ·ä½¿ç”¨git bashæ•²å‘½ä»¤ï¼Œæ¯•ç«Ÿwindowsçš„ç»ˆç«¯æ²¡æœ‰linuxã€macosåšå¾—å¥½ï¼Œå’Œæ“ä½œç³»ç»Ÿçš„è¿æ¥ã€å†…æ ¸å¥½ç”¨ å›¾å½¢Base64Base64ï¼ˆåŸºåº•64ï¼‰æ˜¯ä¸€ç§åŸºäº64ä¸ªå¯æ‰“å°å­—ç¬¦æ¥è¡¨ç¤ºäºŒè¿›åˆ¶æ•°æ®çš„è¡¨ç¤ºæ–¹æ³•ï¼Œå®ƒæ˜¯ä¸€ç§ç¼–ç æ–¹å¼çš„åç§°ã€‚ ç”±äº log2 64 = 6 æ‰€ä»¥æ¯6ä¸ªæ¯”ç‰¹ä¸ºä¸€ä¸ªå•å…ƒï¼Œå¯¹åº”æŸä¸ªå¯æ‰“å°å­—ç¬¦ã€‚3ä¸ªå­—èŠ‚ç›¸å½“äº24ä¸ªæ¯”ç‰¹ï¼Œå¯¹åº”äº4ä¸ªBase64å•å…ƒ å½“éœ€è¦å¯¹äºŒè¿›åˆ¶æ•°æ®è¿›è¡Œç¼–ç æ—¶ï¼Œé€šå¸¸ä¼šä½¿ç”¨ Base64 ç¼–ç æ–¹æ¡ˆï¼Œå°¤å…¶æ˜¯å½“æ•°æ®éœ€è¦é€šè¿‡æ—¨åœ¨å¤„ç†æ–‡æœ¬çš„åª’ä½“è¿›è¡Œå­˜å‚¨å’Œä¼ è¾“æ—¶ã€‚è¿™ç§ç¼–ç æœ‰åŠ©äºç¡®ä¿æ•°æ®åœ¨ä¼ è¾“è¿‡ç¨‹ä¸­ä¿æŒå®Œæ•´è€Œä¸è¢«ä¿®æ”¹ã€‚Base64 å¸¸ç”¨äºè®¸å¤šåº”ç”¨ç¨‹åºï¼ŒåŒ…æ‹¬é€šè¿‡ MIME å‘é€ç”µå­é‚®ä»¶ï¼Œä»¥åŠä»¥ XML æˆ– JSON æ ¼å¼å­˜å‚¨å¤æ‚æ•°æ®ã€‚ Base64Urlåœ¨ç¼–å†™ HTML ç½‘é¡µæ—¶ï¼Œå¯¹äºä¸€äº›ç®€å•å›¾ç‰‡ï¼Œé€šå¸¸ä¼šé€‰æ‹©å°†å›¾ç‰‡å†…å®¹ç›´æ¥å†…åµŒåœ¨ç½‘é¡µä¸­ï¼Œä»è€Œå‡å°‘ä¸å¿…è¦çš„ç½‘ç»œè¯·æ±‚ï¼Œä½†æ˜¯å›¾ç‰‡æ•°æ®æ˜¯äºŒè¿›åˆ¶æ•°æ®ï¼Œè¯¥æ€ä¹ˆåµŒå…¥å‘¢ï¼Ÿç»å¤§å¤šæ•°ç°ä»£æµè§ˆå™¨éƒ½æ”¯æŒä¸€ç§åä¸º Data URLs çš„ç‰¹æ€§ï¼Œå…è®¸ä½¿ç”¨ base64 å¯¹å›¾ç‰‡æˆ–å…¶ä»–æ–‡ä»¶çš„äºŒè¿›åˆ¶æ•°æ®è¿›è¡Œç¼–ç ï¼Œå°†å…¶ä½œä¸ºæ–‡æœ¬å­—ç¬¦ä¸²åµŒå…¥ç½‘é¡µä¸­ã€‚ ç»„æˆ å‰ç¼€ï¼ˆdata:ï¼‰ã€æŒ‡ç¤ºæ•°æ®ç±»å‹çš„ MIME ç±»å‹ã€å¦‚æœéæ–‡æœ¬åˆ™ä¸ºå¯é€‰çš„ base64 æ ‡è®°ã€æ•°æ®æœ¬èº«ï¼š data:[&lt;mediatype>][;base64],&lt;data> mediatype æ˜¯ä¸ª MIME ç±»å‹çš„å­—ç¬¦ä¸²ï¼Œä¾‹å¦‚ â€œimage/jpegâ€œ è¡¨ç¤º JPEG å›¾åƒæ–‡ä»¶ã€‚å¦‚æœè¢«çœç•¥ï¼Œåˆ™é»˜è®¤å€¼ä¸º text/plain;charset=US-ASCIIã€‚å¦‚æœæ•°æ®æ˜¯æ–‡æœ¬ç±»å‹ï¼Œä½ å¯ä»¥ç›´æ¥å°†æ–‡æœ¬åµŒå…¥ï¼ˆæ ¹æ®æ–‡æ¡£ç±»å‹ï¼Œä½¿ç”¨åˆé€‚çš„å®ä½“å­—ç¬¦æˆ–è½¬ä¹‰å­—ç¬¦ï¼‰ã€‚å¦‚æœæ˜¯äºŒè¿›åˆ¶æ•°æ®ï¼Œä½ å¯ä»¥å°†æ•°æ®è¿›è¡Œ base64 ç¼–ç ä¹‹åå†è¿›è¡ŒåµŒå…¥ã€‚æ¯”å¦‚åµŒå…¥ä¸€å¼ å›¾ç‰‡ï¼š &lt;img alt=\"logo\" src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUg...\"> HTMLä¸­ï¼Œimgçš„srcå’Œcssæ ·å¼çš„background-imageéƒ½å¯ä»¥æ¥å—base64å­—ç¬¦ä¸²ï¼Œä»è€Œåœ¨é¡µé¢ä¸Šæ¸²æŸ“å‡ºå¯¹åº”çš„å›¾ç‰‡ å†æ¬¡æˆ‘ä»¬å…ˆäº†è§£ä¸‹base64çš„ç¼ºç‚¹ å¦‚æœå›¾ç‰‡è¾ƒå¤§ï¼Œå›¾ç‰‡çš„è‰²å½©å±‚æ¬¡æ¯”è¾ƒä¸°å¯Œï¼Œåˆ™ä¸é€‚åˆä½¿ç”¨è¿™ç§æ–¹å¼ï¼Œå› ä¸ºè¯¥å›¾ç‰‡ç»è¿‡ base64 ç¼–ç åçš„å­—ç¬¦ä¸²éå¸¸å¤§ï¼Œä¼šæ˜æ˜¾å¢å¤§ HTML é¡µé¢çš„å¤§å°ï¼Œä»è€Œå½±å“åŠ è½½é€Ÿåº¦ base64Urlå¯èƒ½ä¼šè¢«ä½ çš„åº”ç”¨å¤šæ¬¡å¤ç”¨ï¼Œæœ¬æ¥æµè§ˆå™¨å¯ä»¥ç›´æ¥ä»æœ¬åœ°ç¼“å­˜å–å‡ºçš„å›¾ç‰‡ï¼Œæ¢æˆbase64Urlï¼Œå°†é€ æˆåº”ç”¨ä¸­å¤šä¸ªé¡µé¢é‡å¤ä¸‹è½½1.3å€å¤§å°çš„æ–‡æœ¬ çº¦ç­‰äº æµé‡æ¶ˆè€— * 13å€ ä½ç‰ˆæœ¬æµè§ˆå™¨å…¼å®¹é—®é¢˜ ä¸åˆ©äºå¼€å‘è€…å·¥å…·è°ƒè¯• ä¼˜ç‚¹å‘¢ï¼Ÿï¼ˆå‡å°‘äº†httpè¯·æ±‚ï¼‰ åœ¨http2.0çš„åŠ æŒä¸‹ï¼ˆäºŒè¿›åˆ¶å¸§ä¼ è¾“ï¼‰ï¼Œä¿ç•™äº†http1.1çš„é•¿è¿æ¥ï¼Œè¯·æ±‚å’Œå“åº”å¯ä»¥äº¤é”™ç”šè‡³å¯ä»¥å¤ç”¨ï¼Œå¤šä¸ªå¹¶è¡Œè¯·æ±‚çš„å¼€é”€å·²ç»å¤§å¤§é™ä½ï¼Œæˆ‘å·²ç»ä¸çŸ¥é“è¿˜æœ‰ä»€ä¹ˆç†ç”±ç»§ç»­åšæŒbase64Urlçš„ä½¿ç”¨äº†ã€‚ JPG vs PNGè¿™å’Œæ™®é€šçš„HTMLå·®ä¸å¤šï¼ŒJPGæœ‰æŸå‹ç¼©ï¼ŒPNGæœ‰æ— æŸå‹ç¼©ï¼Œæ‰€ä»¥PNGçš„ä¸‹è½½é€Ÿåº¦ä¸€èˆ¬æ¯”è¾ƒæ…¢ã€‚ä½†æ˜¯ï¼ŒPNGæ”¯æŒé€æ˜åº¦ã€‚PNGå¯èƒ½ä¹Ÿé€‚åˆä½œä¸ºéå›¾åƒæ•°æ®ï¼ˆnon-image dataï¼‰çš„æ ¼å¼ï¼Œæ¯”å¦‚æ³•çº¿å›¾ï¼Œä»¥åŠå…¶ä»–ç§ç±»çš„éå›¾åƒå›¾ï¼Œæˆ‘ä»¬åé¢ä¼šä»‹ç»ã€‚ è¯·è®°ä½ï¼Œåœ¨WebGLä¸­JPGä½¿ç”¨çš„å†…å­˜å¹¶ä¸æ¯”PNGå°‘ã€‚å‚è§ä¸Šæ–‡ã€‚ BMPBMPæ˜¯è‹±æ–‡å…¨ç§°ä¸ºä½å›¾ï¼ˆBitmapï¼‰çš„ç¼©å†™ï¼Œå®ƒæ˜¯ä¸€ç§å¸¸è§çš„å›¾åƒæ–‡ä»¶æ ¼å¼ã€‚BMPæ ¼å¼æ˜¯ä¸€ç§æ— æŸçš„å›¾åƒæ–‡ä»¶æ ¼å¼ï¼Œå®ƒä»¥åƒç´ é˜µåˆ—çš„å½¢å¼å­˜å‚¨å›¾åƒæ•°æ®ï¼Œæ¯ä¸ªåƒç´ éƒ½æœ‰è‡ªå·±çš„é¢œè‰²ä¿¡æ¯ã€‚BMPæ–‡ä»¶å¯ä»¥åŒ…å«å½©è‰²å›¾åƒã€ç°åº¦å›¾åƒæˆ–é»‘ç™½å›¾åƒã€‚ BMPæ ¼å¼çš„æ–‡ä»¶å¤§å°ç›¸å¯¹è¾ƒå¤§ï¼Œç°åœ¨å¸¸ç”¨çš„å›¾ç‰‡æ ¼å¼å¾€å¾€é‡‡ç”¨å‹ç¼©ç®—æ³•ï¼Œå¦‚JPEGã€PNGç­‰ï¼Œä»¥å‡å°æ–‡ä»¶å¤§å°å¹¶ä¿æŒè¾ƒå¥½çš„å›¾åƒè´¨é‡ã€‚ç„¶è€Œï¼ŒBMPæ ¼å¼ä»ç„¶åœ¨æŸäº›ç‰¹å®šçš„åº”ç”¨é¢†åŸŸä¸­å¾—åˆ°å¹¿æ³›ä½¿ç”¨ï¼Œæ¯”å¦‚åœ¨ä¸€äº›å›¾åƒå¤„ç†è½¯ä»¶ã€æ‰“å°æœºå’ŒæŸäº›è€æ—§çš„æ“ä½œç³»ç»Ÿä¸­ã€‚ PAGPAGï¼ˆPortable Animated Graphicsï¼‰æ˜¯è…¾è®¯è‡ªä¸»ç ”å‘çš„ä¸€å¥—å®Œæ•´çš„åŠ¨ç”»å·¥ä½œæµè§£å†³æ–¹æ¡ˆï¼ŒåŠ©åŠ›äºå°† AE åŠ¨ç”»æ–¹ä¾¿å¿«æ·çš„åº”ç”¨äºå„å¹³å°ç»ˆç«¯ã€‚ æ®å®˜æ–¹çš„ä»‹ç»ï¼Œå’Œlottieã€SVGAç­‰è¿›è¡Œå¯¹æ¯” æ–‡ä»¶æ›´å° AEç‰¹æ€§å…¨é¢æ”¯æŒ çŸ¢é‡åŠ¨ç”»æ¸²æŸ“æ€§èƒ½æ›´å¥½ä¸€ç‚¹ï¼Œä½†æ˜¯å†…å­˜å½“ç„¶ä¹Ÿä¼šå ç”¨æ›´å¤šä¸€ç‚¹ è¿˜æœ‰(æˆªæ­¢2023ä¸ŠåŠå¹´) ç¼ºç‚¹ï¼šSDKæ¥å…¥ä½“ç§¯å¤§ï¼Œå…¼å®¹æ€§è¾ƒå·®ï¼Œéœ€è¦wasmæˆ–asm.jsçš„æ”¯æŒï¼Œåœ¨appç«¯çš„SDK éƒ¨åˆ†ä¸»è¦åˆ†ä¸ºä¸¤ä¸ªç‰ˆæœ¬ï¼Œä¸€ä¸ªæ˜¯ç¤¾åŒºç‰ˆï¼Œå…è´¹ï¼Œä¸€ä¸ªæ˜¯ä¼ä¸šç‰ˆï¼Œè¦æ”¶è´¹ï¼Œå·®å¼‚æ€§æŒºå¤§çš„ï¼Œç¤¾åŒºç‰ˆä¸æ”¯æŒéŸ³é¢‘æ’­æ”¾ç­‰ï¼Œå…·ä½“å¯ä»¥çœ‹è¿™é‡Œ æ¼”ç¤ºpag-webçš„å®˜æ–¹demo githubåœ°å€ æ•°æ®æ ¼å¼json5json5æ˜¯jsonæ–‡ä»¶çš„ä¸€ç§å‡çº§ ä»–æ”¯æŒï¼š åŠ æ³¨é‡Š keyåä¸ä¸€å®šè¦ä½¿ç”¨åŒå¼•å· æ”¯æŒä½¿ç”¨è½¬ä¹‰å­—ç¬¦ Linuxä¸€äº›å¸¸ç”¨å‘½ä»¤viç¼–è¾‘å‘½ä»¤ï¼šé¦–å…ˆ vim æ–‡ä»¶å è¿›å…¥ wqï¼šè¡¨ç¤ºä¿å­˜é€€å‡º wq!ï¼šè¡¨ç¤ºå¼ºåˆ¶ä¿å­˜é€€å‡º qï¼šè¡¨ç¤ºé€€å‡º q!ï¼šè¡¨ç¤ºå¼ºåˆ¶é€€å‡º é—®é¢˜è®°å½• VIMç¼–è¾‘æ–‡ä»¶æƒé™é—®é¢˜:â€E45: â€˜readonlyâ€™ option is set (add ! to override)â€ ä½¿ç”¨ :w/:wq ä¿å­˜çš„æ—¶å€™æç¤º â€œE45: â€˜readonlyâ€™ option isset (add ! to override)â€ï¼Œè€Œç”¨ :w! æç¤º â€œE212: Canâ€™t open file forwritingâ€ã€‚ è§£å†³æ–¹æ¡ˆï¼Œ :q! å¼ºåˆ¶å…³é—­æ–‡ä»¶åï¼Œåœ¨å‘½ä»¤è¡Œé‡Œè¾“å…¥ï¼šsudo !! åå›è½¦å†æ¬¡vimæ‰“å¼€æ–‡ä»¶ç¼–è¾‘å°±æ­£å¸¸äº† æ–¹æ³•æ¥æœç½—è‡ªç½‘ç»œï¼Œviç¼–è¾‘æ­£å¸¸ï¼Œvimç¼–è¾‘é‡åˆ°ä¸Šé¢çš„é—®é¢˜ï¼Œå…·ä½“åŸå› ä¸è¯¦ã€‚ pwdï¼šæŸ¥çœ‹å½“å‰ç›®å½•ä½ç½® ifconfigï¼šæŸ¥çœ‹ç½‘ç»œä¿¡æ¯ free -hï¼šæŸ¥çœ‹æœåŠ¡å†…å­˜çŠ¶å†µ df -lhï¼šæŸ¥çœ‹ç£ç›˜ç©ºé—´ mkdir ç›®å½•åï¼šæ–°å»ºç›®å½• which åŒ…åï¼šå‡å¦‚åŒ…å®‰è£…åœ¨å…¨å±€ï¼Œé€šè¿‡è¿™ä¸ªå‘½ä»¤å¯ä»¥æŸ¥çœ‹åŒ…å…·ä½“å®‰è£…åœ¨å“ªä¸ªç›®å½•ä¸‹ whoï¼šæ˜¾ç¤ºå½“å‰ç™»å½•ç³»ç»Ÿçš„ç”¨æˆ· rm -f æ–‡ä»¶å åˆ é™¤â½‚ä»¶ rmdir dir1 åˆ é™¤â€™dir1â€™â½¬å½• rm -rf dir1 åˆ é™¤â€™dir1â€™â½¬å½•å’Œå…¶å†…å®¹ cat æ–‡ä»¶å æŸ¥çœ‹file1 å†…å®¹ zip xxx.zip æ–‡ä»¶å æŠŠå‹ç¼©æˆxxx.zipåŒ… Macä¸€äº›å‘½ä»¤è®¾ç½®åˆ«å open ~/.bash_profile è¿™é‡Œæ¯”å¦‚ç»™chromeè®¾ç½®åˆ«å alias chrome=\"/Applications/Google\\ Chrome.app/Contents/MacOS/Google\\ Chrome\" ä¿å­˜åæ‰§è¡Œ source ~/.bash_profile ä»€ä¹ˆæ˜¯bash bashæ˜¯ the Bourne again shell çš„ç¼©å†™ï¼Œè€ŒBourne shellæ˜¯ä¸€ç§æœ€å¸¸è§ã€UNIXæœ€åˆä½¿ç”¨çš„shellã€‚shellæ˜¯ç”¨æˆ·å’ŒLinuxå†…æ ¸ä¹‹é—´çš„æ¥å£ç¨‹åº ~/.bashrcæ˜¯ä»€ä¹ˆ ~/.bashrc:è¯¥æ–‡ä»¶åŒ…å«ä¸“ç”¨äºä½ çš„bash shellçš„bashä¿¡æ¯,å½“ç™»å½•æ—¶ä»¥åŠæ¯æ¬¡æ‰“å¼€æ–°çš„shellæ—¶,è¯¥æ–‡ä»¶è¢«è¯»å–.ï¼ˆæ¯ä¸ªç”¨æˆ·éƒ½æœ‰ä¸€ä¸ª.bashrcæ–‡ä»¶ï¼Œåœ¨ç”¨æˆ·ç›®å½•ä¸‹ï¼‰ ~/.bash_profileæ˜¯ä»€ä¹ˆï¼Ÿ ~/.bash_profile:æ¯ä¸ªç”¨æˆ·éƒ½å¯ä½¿ç”¨è¯¥æ–‡ä»¶è¾“å…¥ä¸“ç”¨äºè‡ªå·±ä½¿ç”¨çš„shellä¿¡æ¯,å½“ç”¨æˆ·ç™»å½•æ—¶,è¯¥æ–‡ä»¶ä»…ä»…æ‰§è¡Œä¸€æ¬¡!é»˜è®¤æƒ…å†µä¸‹,ä»–è®¾ç½®ä¸€äº›ç¯å¢ƒå˜é‡,æ‰§è¡Œç”¨æˆ·çš„.bashrcæ–‡ä»¶. zshrc: macé»˜è®¤çš„shellæ”¹äº†ï¼Œç°åœ¨æ˜¯zshäº†ï¼Œè£…äº†oh-my-zshä¹‹åï¼Œå¯åŠ¨æ—¶ä¼šè¿è¡Œzshrcè€Œä¸æ˜¯ä¸Šé¢ä¸¤ä¸ªæ–‡ä»¶ã€‚å¦å¤–å®ƒå’ŒLogin Shellä¸no-Login Shelléƒ½æ²¡æœ‰å…³ç³»ï¼Œä¸ç®¡ä»€ä¹ˆshelléƒ½ä¼šè¿è¡Œã€‚ Macå¯ä»¥é€šè¿‡ echo $0 æŸ¥çœ‹å½“å‰ç”¨çš„æ˜¯zshè¿˜æ˜¯bash","categories":[],"tags":[],"author":"Hello"},{"title":"Nodejs","slug":"Nodejs","date":"2022-05-05T06:07:51.528Z","updated":"2023-04-12T11:58:57.167Z","comments":true,"path":"2022/05/05/nodejs/","link":"","permalink":"https://taylor12138.github.io/2022/05/05/nodejs/","excerpt":"","text":"1.Nodeæ¦‚è¿°Node.jsæ˜¯ä¸€ä¸ªèƒ½å¤Ÿåœ¨æœåŠ¡å™¨ä¸Šè¿è¡ŒJavaScriptçš„ç¯å¢ƒ ä¸ºä»€ä¹ˆé€‰æ‹©nodeï¼š 1.nodeä½¿ç”¨JavaScriptè¯­æ³•å¼€å‘åç«¯åº”ç”¨ 2.ä¸€äº›å…¬å¸è¦æ±‚å‰ç«¯äººå‘˜æŒæ¡Nodeå¼€å‘ 3.ç”Ÿæ€ç³»ç»Ÿæ´»è·ƒï¼Œæœ‰å¤§é‡å¼€æºåº“ 4.ç°æœ‰å‰ç«¯å¼€å‘å·¥å…·å¤§å¤šå±…äºnodeå¼€å‘ nodeæ˜¯åŸºäºchrome V8å¼•æ“çš„JavaScriptä»£ç è¿è¡Œç¯å¢ƒï¼ˆæµè§ˆå™¨ä¹Ÿæ˜¯JavaScriptä»£ç è¿è¡Œç¯å¢ƒï¼‰ï¼Œæºä»£ç -â†’æŠ½è±¡è¯­æ³•æ ‘-â†’å­—èŠ‚ç -â†’JIT-â†’æœ¬åœ°ä»£ç (V8å¼•æ“æ²¡æœ‰ä¸­é—´å­—èŠ‚ç ) åœ¨å‘½ä»¤è¡Œå·¥å…·ä¸­è¾“å…¥ node -v å³å¯æŸ¥çœ‹nodejsæ˜¯å¦å®‰è£…æˆåŠŸ node.jså’ŒJavaScriptçš„å¯¹æ¯”JavaScriptç”±3éƒ¨åˆ†ç»„æˆï¼ŒECMAScript+DOM+BOMï¼Œå¯ä»¥åœ¨ä¸åŒæµè§ˆå™¨çš„JSå¼•æ“ä¸Šè¿è¡Œ Node.jsä»…åœ¨chromeä½¿ç”¨çš„V8å¼•æ“ä¸Šè¿è¡Œ ç”±ECMAScriptåŠNodeç¯å¢ƒæä¾›çš„ä¸€äº›é™„åŠ APIç»„æˆçš„ ECMAScript(è¯­è¨€åŸºç¡€ï¼Œå¦‚ï¼šè¯­æ³•ã€æ•°æ®ç±»å‹ç»“æ„ä»¥åŠä¸€äº›å†…ç½®å¯¹è±¡) os(æ“ä½œç³»ç»Ÿ) file(æ–‡ä»¶ç³»ç»Ÿ) net(ç½‘ç»œç³»ç»Ÿ) database(æ•°æ®åº“) ä»–ä»¬éƒ½ä½¿ç”¨äº†ECMAScriptè¯­æ³•ï¼Œåªæ˜¯åˆ†åˆ«å‘å‰åç«¯çš„æ–¹å‘æ‹“å±•äº† ä½¿ç”¨åœ¨cmdå‘½ä»¤ç¬¦çª—å£ä¸­ä½¿ç”¨ node xx.js å³å¯å®Œæˆï¼ˆåœ¨æ‰§è¡Œæ–‡ä»¶çš„ç›®å½•ä¸‹æŒ‰ä½shift+é¼ æ ‡å³é”®å¯å¿«é€Ÿè¿›å…¥å½“å‰ç›®å½•çš„å‘½ä»¤ç¬¦çª—å£ï¼Œç„¶åé…åˆtabé”®ä½å¿«é€Ÿæ‰“å¼€ï¼‰ ä¹Ÿå¯ä»¥ç›´æ¥ä½¿ç”¨ nodeè¿›è¡Œå›è½¦ï¼Œå¯ä»¥ç›´æ¥ä¾›æµ‹è¯•ä½¿ç”¨ï¼ˆæ ¸å¿ƒæ¨¡å—å¯ä»¥ç›´æ¥ç”¨ï¼Œä¸ç”¨requireï¼‰ï¼Œç±»ä¼¼äºæµè§ˆå™¨çš„consoleæ§åˆ¶å° 2.Bufferç¼“å†²åŒºæ•°ç»„ä¸èƒ½å­˜å‚¨äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œè€Œbufferå°±æ˜¯ä¸“é—¨æ¥å­˜å‚¨äºŒè¿›åˆ¶æ•°æ® ä»ç»“æ„ä¸Šbufferéå¸¸åƒä¸€ä¸ªæ•°ç»„ï¼Œä»–çš„å…ƒç´ ä¸º16è¿›åˆ¶çš„ä¸¤ä½æ•° var str = \"hello, è‰¾ä¼¦\"; var buf = Buffer.from(str); console.log(buf.length); //å ç”¨å†…å­˜å¤§å° console.log(str.length); //å­—ç¬¦ä¸²é•¿åº¦ var s = buf.toString(); //å°†ç¼“å†²åŒºçš„æ•°æ®è½¬æ¢å›å­—ç¬¦ä¸² var j = buf.toJSON(); //å°†ç¼“å†²åŒºçš„æ•°æ®è½¬æ¢å›jsonå¯¹è±¡ bufferå­˜å‚¨çš„æ•°æ®éƒ½æ˜¯äºŒè¿›åˆ¶æ•°æ®ï¼Œä½†æ˜¯æ˜¾ç¤ºçš„æ—¶å€™éƒ½æ˜¯ä»¥16è¿›åˆ¶æ˜¾ç¤ºï¼ŒèŒƒå›´æ˜¯00 - ffï¼ˆ00000000 - 11111111ï¼‰ï¼Œæ‰€ä»¥æ˜¯8 bit ï¼ˆä½ï¼‰ï¼Œ8 bit = 1 byte ï¼ˆå­—èŠ‚ï¼‰ï¼ˆä¸€ä¸ªè‹±æ–‡å ä¸€ä¸ªå­—èŠ‚ï¼Œä¸€ä¸ªæ±‰å­—å 3ä¸ªå­—èŠ‚ï¼‰ buffer æ„é€ å‡½æ•°ï¼ˆnew Bufferï¼‰ä¸æ¨èä½¿ç”¨ ä½†æ˜¯å¯ä»¥ï¼šä½¿ç”¨Buffer.alloc(size)åˆ†é…ä¸€ä¸ªå¤§å°ä¸ºsizeçš„æ–°å»ºBuffer è¿˜æœ‰ï¼šBuffer.allocUnsafe(size) åˆ›å»ºä¸€ä¸ªæŒ‡å®šå¤§å°çš„bufferï¼Œä½†æ˜¯bufferå¯èƒ½å«æœ‰æ•æ„Ÿæ•°æ®ï¼ˆåˆ†é…æ—¶æœªæ¸…ç©ºä¸Šä¸€æ¬¡ä½¿ç”¨å†…å­˜å­˜æ”¾çš„æ•°æ®ï¼Œä½†æ˜¯æ€§èƒ½å¤Ÿå¥½ï¼‰ Bufferçš„å¤§å°ä¸€æ—¦ç¡®å®šï¼Œåˆ™ä¸èƒ½ä¿®æ”¹ï¼ŒBufferå®é™…ä¸Šæ˜¯å¯¹åº•å±‚å†…å­˜çš„ç›´æ¥æ“ä½œ å¯ä»¥é€šè¿‡ç´¢å¼•æ“ä½œbufferä¸­çš„å…ƒç´  buf[0] = 88 è¿™é‡Œçš„88æ˜¯16è¿›åˆ¶ï¼Œç„¶åå†æ§åˆ¶å°console.logè¿›è¡Œè¾“å‡ºæ—¶ï¼Œæ˜¾ç¤ºçš„æ˜¯10è¿›åˆ¶ï¼ˆåªè¦æ•°å­—åœ¨æ§åˆ¶å°è¾“å‡ºä¸€å®šæ˜¯10è¿›åˆ¶ï¼‰ 3.æ–‡ä»¶ç³»ç»Ÿfsé€šè¿‡nodeæ“ä½œç³»ç»Ÿä¸­çš„æ–‡ä»¶ï¼Œåœ¨Nodeä¸­ï¼Œä¸æ–‡ä»¶ç³»ç»Ÿçš„äº¤äº’æ˜¯éå¸¸é‡è¦çš„ï¼ŒæœåŠ¡å™¨çš„æœ¬è´¨å°±å°†æœ¬åœ°æ–‡ä»¶å‘é€ç»™è¿œç¨‹å®¢æˆ·ç«¯ï¼Œè¯¥æ¨¡å—æä¾›äº†ä¸€äº›æ ‡å‡†æ–‡ä»¶è®¿é—®apiæ¥æ‰“å¼€ï¼Œè¯»å–ï¼Œå†™å…¥æ–‡ä»¶ï¼Œä»¥åŠä¸å…¶äº¤äº’ å¼•å…¥fsæ¨¡å—ï¼Œfsæ˜¯æ ¸å¿ƒæ¨¡å—ï¼Œç›´æ¥å¼•ç”¨ä¸ç”¨ä¸‹è½½ fsæ¨¡å—ä¸­æ‰€æœ‰çš„æ“ä½œéƒ½æœ‰ä¸¤ç§å½¢å¼å¯ä¾›é€‰æ‹©ï¼šåŒæ­¥å’Œå¼‚æ­¥ åŒæ­¥æ–‡ä»¶ç³»ç»Ÿä¼šé˜»å¡ç¨‹åºçš„æ‰§è¡Œï¼Œä¹Ÿå°±æ˜¯é™¤éæ“ä½œå®Œæ¯•ï¼Œå¦åˆ™ä¸ä¼šå‘ä¸‹æ‰§è¡Œä»£ç ï¼ˆé¡ºåºæ‰§è¡Œï¼‰ å¼‚æ­¥æ–‡ä»¶ç³»ç»Ÿä¸ä¼šé˜»å¡ç¨‹åºçš„æ‰§è¡Œï¼Œè€Œæ˜¯åœ¨æ“ä½œå®Œæˆæ—¶ï¼ˆå¼‚æ­¥éƒ½æœ‰callbackï¼‰ï¼ˆå¼‚æ­¥æ–¹æ³•ä¸å¯èƒ½æœ‰è¿”å›å€¼ï¼‰é€šè¿‡å›è°ƒå‡½æ•°ç»“æœè¿”å› fsä¸­å¸¦Syncçš„çš„æ–¹æ³•æ˜¯åŒæ­¥æ–¹æ³•ï¼Œä¸å¸¦Syncçš„æ–¹æ³•æ˜¯å¼‚æ­¥æ–¹æ³• æ–‡ä»¶æ‰“å¼€åŒæ­¥æ–‡ä»¶æ‰“å¼€ fs.openSync(path, flags[, mode]) â€‹ -path æ‰“å¼€çš„æ–‡ä»¶è·¯å¾„ â€‹ flags æ‰“å¼€æ–‡ä»¶æ“ä½œç±»å‹ æ¯”å¦‚ r åªè¯»çš„ã€ w å¯å†™çš„ â€‹ mode æ“ä½œæƒé™ ï¼Œä¸€èˆ¬çœç•¥ è¯¥æ–¹æ³•ä¼šè¿”å›ä¸€ä¸ªæ–‡ä»¶æè¿°ç¬¦ä½œä¸ºç»“æœï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è¯¥æè¿°ç¬¦æ¥å¯¹æ–‡ä»¶è¿›è¡Œå„ç§æ“ä½œ å¼‚æ­¥æ–‡ä»¶æ‰“å¼€ fs.open(path, flags[, mode], callback) â€‹ callbackä¸èƒ½çœç•¥ â€‹ å›è°ƒå‡½æ•°ä¸­æœ‰ä¸¤ä¸ªå‚æ•° â€‹ err é”™è¯¯å¯¹è±¡ æ²¡æœ‰é”™è¯¯åˆ™ä¸ºnull â€‹ fd æ–‡ä»¶æè¿°ç¬¦ æ— è¿”å›å€¼ æ–‡ä»¶å†™å…¥åŒæ­¥æ–‡ä»¶å†™å…¥ fs.writeSync(fd, string[, position[, encoding]]) â€‹ fdæ–‡ä»¶æè¿°ç¬¦ï¼Œéœ€è¦ä¼ é€’è¦å†™å…¥çš„æ–‡ä»¶çš„æè¿°ç¬¦ â€‹ stringå†™å…¥å†…å®¹ â€‹ positionèµ·å§‹ä½ç½®ï¼Œä¸€èˆ¬çœç•¥ â€‹ encoding é»˜è®¤utf-8 å¼‚æ­¥æ–‡ä»¶å†™å…¥ï¼ˆå†™åœ¨fs.opençš„å›è°ƒå‡½æ•°é‡Œï¼‰ fs.write(fd, string[, position[, encoding]], callback) â€‹ å½“å‰å›è°ƒæœ‰ä¸‰ä¸ªå‚æ•° â€‹ err â€‹ written â€‹ string å…³é—­æ–‡ä»¶æœåŠ¡å™¨æ˜¯æŒç»­è¿è¡Œçš„ï¼Œä¸æƒ³æˆ‘ä»¬å¹³æ—¶è¿è¡Œçš„æ–‡ä»¶ï¼Œç»“æŸåè‡ªåŠ¨é‡Šæ”¾ç©ºé—´ fs.closeSync(fd) â€‹ fdæ–‡ä»¶æè¿°ç¬¦ï¼Œéœ€è¦ä¼ é€’è¦å†™å…¥çš„æ–‡ä»¶çš„æè¿°ç¬¦ fs.close(fd, callback) â€‹ å¼‚æ­¥ï¼Œå®Œæˆå›è°ƒåªæœ‰ä¸€ä¸ªå¯èƒ½çš„å¼‚å¸¸å‚æ•° ç®€å•æ–‡ä»¶å†™å…¥ï¼ˆå¸¸ç”¨ï¼‰ä¸€æ­¥æå®šï¼Œçœç•¥æ‰“å¼€ï¼Œå…³é—­ fs.writeFile(file, data[, options], callback) fs.writeFileSync(file, data[, options]) â€‹ file è¦æ“ä½œæ–‡ä»¶çš„è·¯å¾„ â€‹ data è¦å†™å…¥çš„æ•°æ® â€‹ option é€‰é¡¹ï¼Œå¯é€‰ï¼Œå¯¹å†™å…¥è¿›è¡Œé…ç½®ï¼šæœ‰encodingï¼ˆé»˜è®¤utf-8ï¼‰ã€modeï¼ˆæƒé™ï¼‰ã€flagï¼ˆæ–‡ä»¶æ“ä½œå½¢å¼ï¼Œé»˜è®¤wï¼Œå¦‚æœå†…å®¹ä¸å­˜åœ¨åˆ™åˆ›å»ºï¼Œå­˜åœ¨åˆ™æˆªæ–­ï¼‰ â€‹ callback å½“å†™å…¥å®Œæˆä»¥åæ‰§è¡Œçš„å‡½æ•° var fs = require(\"fs\"); fs.writeFile(\"index.txt\", \"aaa\", function (err) { if (!err) { console.log(\"å†™å…¥æˆåŠŸï¼\"); } else { console.log(\"error!\"); } }); StreamæµStreamæµæ˜¯ä¸€ä¸ªæŠ½è±¡çš„æ¥å£ï¼Œåœ¨nodejså½“ä¸­ï¼Œå¾ˆå¤šæ–¹æ³•ï¼Œå¯¹è±¡ï¼Œä»–ä»¬éƒ½å®ç°äº†è¿™ä¸ªæ¥å£ï¼Œä¾‹å¦‚ä¹‹å‰åˆ›å»ºä¸€ä¸ªæœåŠ¡ï¼Œå‘æœåŠ¡å™¨å‘é€ä¸€ä¸ªè¯·æ±‚ï¼Œrequestå¯¹è±¡ï¼Œä»–å…¶å®å°±æ˜¯ä¸€ä¸ªæµï¼ˆæµç®€å•ç²—æš´çš„ç†è§£å°±æ˜¯åœ¨çº¿çœ‹ç”µè§†ï¼‰ åœ¨nodeJSä¸­ï¼ŒStreamæœ‰å››ç§æµç±»å‹ï¼š â€‹ Readable -å¯è¯»æ“ä½œ â€‹ Writable -å¯å†™æ“ä½œ â€‹ Duple -å¯è¯»å¯å†™æ“ä½œ â€‹ Transform -æ“ä½œè¢«å†™å…¥æ•°æ®ï¼Œç„¶åè¯»å‡ºç»“æœ æ‰€æœ‰çš„Streamå¯¹è±¡éƒ½æ˜¯EventEmitteï¼ˆeventsæ¨¡å—ï¼‰rçš„å®ä¾‹ å¸¸ç”¨äº‹ä»¶ï¼š â€‹ -data å½“æœ‰æ•°æ®å¯è¯»å–æ—¶è§¦å‘ â€‹ -end æ²¡æœ‰æ›´å¤šæ•°æ®å¯è¯»å–æ—¶è§¦å‘ â€‹ -error åœ¨æ¥æ”¶å’Œå†™å…¥è¿‡ç¨‹ä¸­ï¼Œå‘ç”Ÿé”™è¯¯æ—¶è§¦å‘ â€‹ -finish æ‰€æœ‰æ•°æ®å·²ç»è¢«å†™å…¥ä¹‹åè§¦å‘ æµå¼è¯»å–æ–‡ä»¶çš„æ–¹æ³•åœ¨ 5.æ–‡ä»¶ç³»ç»Ÿfsä¸­ æµå¼æ–‡ä»¶å†™å…¥åŒæ­¥ã€å¼‚æ­¥ã€ç®€å•æ–‡ä»¶çš„å†™å…¥ï¼Œéƒ½ä¸å¤§é€‚åˆå¤§æ–‡ä»¶çš„å†™å…¥ï¼ˆéƒ½æ˜¯ä¸€æ¬¡å†™å…¥ï¼‰ï¼Œæ€§èƒ½è¾ƒå·®ï¼Œå®¹æ˜“å¯¼è‡´å†…å­˜æº¢å‡º è€Œæµå¼æ–‡ä»¶çš„ä¼ è¾“ç›¸å½“äºä¸¤ä¸ªæ°´æ± ä¹‹é—´æ’å…¥ä¸€æ¡ç®¡é“ï¼ŒæŒç»­çš„å¤šæ¬¡çš„å†™å…¥ å®ƒæœ¬è´¨ä¸Šä¹Ÿæ˜¯ä¸€ä¸ªå¼‚æ­¥ åˆ›å»ºä¸€ä¸ªå¯å†™æµï¼Œå‚æ•°åŠŸèƒ½å’Œä¹‹å‰çš„æ–‡ä»¶è¯»å†™ç›¸åŒ var ws = fs.createWriteStream(path [, option]) var fs = require(\"fs\"); var ws = fs.createWriteStream(\"index.txt\"); // ç›‘å¬æ–‡ä»¶çš„æ‰“å¼€å’Œå…³é—­ ws.once(\"open\", function () { //onceä¸ºå¯¹è±¡ç»‘å®šä¸€ä¸ªä¸€æ¬¡æ€§çš„äº‹ä»¶ï¼ŒjQueryä¹Ÿæœ‰å‡ºç°è¿‡ç±»ä¼¼çš„one console.log(\"æµæ‰“å¼€äº†\"); }); ws.once(\"close\", function () { console.log(\"æµå…³é—­äº†\"); }); ws.write(\"é€šè¿‡å¯å†™æµå†™å…¥æ–‡ä»¶çš„å†…å®¹\"); ws.write(\"å•Šå¤§è‹æ‰“\"); ws.write(\"å¤§æ’’å¤§æ’’\"); //ä¸å†æœ‰æ•°æ®å†™å…¥ Writable ws.end(); //åœ¨è°ƒç”¨ stream.end() æ–¹æ³•ä¹‹åï¼Œå¹¶ä¸”æ‰€æœ‰æ•°æ®éƒ½å·²åˆ·æ–°åˆ°åº•å±‚ç³»ç»Ÿï¼Œåˆ™è§¦å‘ 'finish' äº‹ä»¶ï¼Œä¸€å®šåœ¨å‰é¢è¦æœ‰endäº‹ä»¶ã€‚ ws.on('finish' () => { console.log('å†™å…¥å®Œæˆ') }) // å…³é—­æµï¼Œå…³é—­æµå…¥å£ // ws.close(); å½“å‰ç‰ˆæœ¬ä¹Ÿå¯ä»¥äº†ï¼ˆå…³é—­æµå‡ºå£ï¼‰ æ–‡ä»¶è¯»å–ï¼ˆall kindsï¼‰è¿™é‡Œåªè®²è®²ç®€å•æ–‡ä»¶è¯»å–å’Œæµå¼æ–‡ä»¶è¯»å– ç®€å•æ–‡ä»¶è¯»å–ï¼ˆå‚æ•°åŠŸèƒ½åŒä¸Šï¼‰ fs.readFileSync(path [, options]) fs.readFile(path [, options], callback) â€‹ callbackå›è°ƒå‡½æ•°å‚æ•° ï¼ˆerr, dataï¼‰ â€‹ err é”™è¯¯å¯¹è±¡ â€‹ data è¯»å–åˆ°çš„æ•°æ®ï¼Œä¼šè¿”å›ä¸€ä¸ªBuffer æµå¼æ–‡ä»¶è¯»å– å®ƒä¹Ÿé€‚åˆä¸€äº›æ¯”è¾ƒå¤§çš„æ–‡ä»¶ï¼Œå¯ä»¥åˆ†å¤šæ¬¡å°†æ–‡ä»¶è¯»å–åˆ°å†…å­˜ä¸­ åˆ›å»ºä¸€ä¸ªå¯è¯»æµï¼š fs.createReadStream(path) å¦‚æœè¦è¯»å–ä¸€ä¸ªå¯è¯»æµçš„æ•°æ®ï¼Œå¿…é¡»è¦ä¸ºå¯è¯»æµç»‘å®šä¸€ä¸ªdataäº‹ä»¶ï¼Œdataäº‹ä»¶ç»‘å®šå®Œæ¯•ï¼Œå®ƒä¼šè‡ªåŠ¨å¼€å§‹è¯»å–æ•°æ®ï¼Œç„¶åè¯»å–åˆ°çš„æ•°æ®å­˜æ”¾åœ¨å‚æ•°ä¸­è¿”å›ï¼ˆå®ƒçš„å‚æ•°æ²¡æœ‰errï¼Œå› ä¸ºäº‹ä»¶è§¦å‘åå°±æ„å‘³ç€ä¸ä¼šå†å‡ºé”™äº†ï¼‰ var fs = require(\"fs\"); var rs = fs.createReadStream(\"cool.jpg\"); var ws = fs.createWriteStream(\"copy.jpg\") // ç›‘å¬ rs.once(\"open\", function () { console.log(\"å¯è¯»æµæ‰“å¼€äº†\"); }); rs.once(\"close\", function () { console.log(\"å¯è¯»æµå…³é—­äº†\"); // æ•°æ®è¯»å–å®Œæ¯•ï¼Œå…³é—­å¯å†™æµ ws.end(); }); ws.once(\"open\", function () { console.log(\"å¯å†™æµæ‰“å¼€äº†\"); }); ws.once(\"close\", function () { console.log(\"å¯å†™æµå…³é—­äº†\"); }); // å¼€å§‹è¯»å– rs.on(\"data\", function (data) { //å°†æ•°æ®è¯»åˆ°dataä¸­ // å°†è¯»å–çš„æ•°æ®å†™å…¥å¯å†™æµä¸­ ws.write(data); }) æµå¼æ–‡ä»¶åŸæœ¬éœ€è¦dataæ–¹æ³•è¿›è¡Œè¯»å–ï¼Œä½†æ˜¯æœ‰ä¸ªæ›´æ–¹ä¾¿çš„æ–¹æ³•ï¼š å°†å¯è¯»æµå’Œå¯å†™æµç®¡é“ç›¸é€šï¼Œå½¢æˆç®¡é“æµï¼Œç”¨äº† pipe() çš„æ–¹æ³• æ”¹ï¼š // å¼€å§‹è¯»å– /* rs.on(\"data\", function (data) { //å°†æ•°æ®è¯»åˆ°dataä¸­ // å°†è¯»å–çš„æ•°æ®å†™å…¥å¯å†™æµä¸­ ws.write(data); })*/ // å¼€å§‹è¯»å– rs.pipe(ws); æ–‡ä»¶è¯»å–é…åˆæ–‡ä»¶å†™å…¥ï¼Œå¯å®Œæˆæ–‡ä»¶çš„ä¼ è¾“ æœåŠ¡å™¨å°±æ˜¯æ¥æ”¶ç”¨æˆ·çš„è¯·æ±‚ï¼Œå¹¶è¿”å›å“åº”ï¼Œè€Œè¯·æ±‚å’Œå“åº”å°±æ˜¯æ•°æ®æµ fså…¶ä»–æ–¹æ³•fs.existsSync(path) æ˜¯å¦å­˜åœ¨ fs.stat(path, callback) æ–‡ä»¶çŠ¶æ€ï¼ˆé‡Œé¢åŒ…å«æ–‡ä»¶å¤§å°ç­‰ä¿¡æ¯ï¼‰ fs.readdir(path, [, option], callback) è¯»å–æ–‡ä»¶ç›®å½•åˆ—è¡¨ fs.readdir(path, [, option])è¯»å–ä¸€ä¸ªç›®å½•çš„ç›®å½•ç»“æ„ fs.truncateSync(path, size) æˆªæ–­æ–‡ä»¶ï¼Œå°†æ–‡ä»¶ä¿®æ”¹ä¸ºæŒ‡å®šå¤§å° é“¾å¼æµå°±æ˜¯ä»ä¸€ä¸ªè¾“å‡ºæµå½“ä¸­ï¼Œè¯»å–æ•°æ®ï¼Œåˆ›å»ºå¤šä¸ªæµæ¥æ“ä½œè¿™ä¸ªè¾“å‡ºæµæ•°æ®çš„æœºåˆ¶ é“¾å¼æµä¸€èˆ¬æ¥æ“ä½œç®¡é“æµ å¸¸è§çš„ä¾‹å­å°±æ˜¯å‹ç¼©å’Œè§£å‹ç¼©çš„ä¾‹å­ // é“¾å¼æµ var fs = require('fs'); var zlib = require('zlib'); // å‹ç¼©æ–‡ä»¶ fs.createReadStream('cool.jpg') .pipe(zlib.createGzip()) .pipe(fs.createWriteStream('cool.jpg.gz')); console.log(\"è§£å‹å®Œæ¯•ï¼ï¼ï¼\"); // é“¾å¼æµ var fs = require('fs'); var zlib = require('zlib'); // è§£å‹ç¼© fs.createReadStream('cool.jpg.gz') .pipe(zlib.createGunzip()) .pipe(fs.createWriteStream('copy2.jpg')); console.log(\"è§£å‹ç¼©å®Œæ¯•ï¼ï¼ï¼\"); 4.åˆ›å»ºæœåŠ¡1.å…ˆå¼•å…¥æ¨¡å—(Nodejsæœ¬èº«æä¾›äº†httpæ¨¡å—) var _http = require(&#39;http&#39;); åˆ›å»ºæœåŠ¡å™¨http.createServer([options][, requestListener]) requestç›‘å¬äº‹ä»¶éœ€è¦æ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼ŒRequestè¯·æ±‚å¯¹è±¡ï¼ˆè·å–å®¢æˆ·ç«¯è¯·æ±‚ä¿¡æ¯ï¼‰ï¼ŒResponseå“åº”å¯¹è±¡ï¼ˆç”¨æ¥ç»™å®¢æˆ·ç«¯å‘é€å“åº”æ¶ˆæ¯ï¼‰ å†åˆ›å»ºæœåŠ¡å™¨çš„å›è°ƒå‡½æ•°é‡Œæ·»åŠ httpå¤´éƒ¨ä¿¡æ¯ï¼Œç„¶åå‘å®¢æˆ·ç«¯å‘é€æ•°æ® å“åº”å¯¹è±¡1.å“åº”å¯¹è±¡responseæ·»åŠ ä¿¡æ¯ï¼šresponse.writeHead(statusCode[, statusMessage][, headers]) â€‹ statusCode ä¸ºçŠ¶æ€ç  â€‹ headersä¸ºå“åº”å¤´ text/plain:çº¯æ–‡æœ¬ text/html: å¯è¯†åˆ«ä¸ºhtmlæ ‡ç­¾çš„æ–‡æœ¬ â€‹ charset=utf-8:é˜²æ­¢ä¸­æ–‡ä¹±ç ï¼ˆæœåŠ¡å™¨é»˜è®¤å‘é€æ•°æ®æ—¶utf8ï¼Œä½†æ˜¯æµè§ˆå™¨ä¸çŸ¥é“ä½ æ˜¯utf8ï¼Œå®ƒä¼šé»˜è®¤æŒ‰ç…§å½“å‰æ“ä½œç³»ç»Ÿçš„ç¼–ç å»è§£æï¼‰ response.setHeader(name, value)ä¹Ÿå¯ä»¥å†™å“åº”å¤´ ï¼ˆwriteHeaderå¯ä»¥è®¾ç½®httpè¿”å›çŠ¶æ€ç ï¼Œå¤šä¸ªhttpå“åº”å¤´ã€‚ä½†æ˜¯setHeaderåªé’ˆå¯¹å•ä¸€å±æ€§çš„è®¾ç½®ã€‚ï¼‰ 2.å“åº”å¯¹è±¡responseå‘é€æ•°æ®ï¼Œå¹¶ä¸”ç»“æŸå“åº”ï¼ˆendï¼‰ï¼š response.end(&quot;ç¬¬ä¸€ä¸ªhttpæœåŠ¡&quot;); ï¼ˆå½“ç„¶ä¹Ÿå¯ä»¥response.write(&quot;xxx&quot;); response.end()ï¼‰ æ³¨æ„ï¼šå“åº”å†…å®¹åªèƒ½æ˜¯äºŒè¿›åˆ¶æ•°æ®æˆ–å­—ç¬¦ä¸²ï¼ˆBufferæˆ–Stringï¼‰ var _http = require('http'); // åˆ›å»ºæœåŠ¡å™¨ _http.createServer(function (request, response) { // httpå¤´éƒ¨ä¿¡æ¯ response.writeHead(200, { 'Content-type': 'text/plain;charset=utf-8' }); // å‘å®¢æˆ·ç«¯å‘é€æ•°æ®ï¼Œå¹¶ä¸”ç»“æŸå“åº”ï¼ˆendï¼‰ response.end(\"ç¬¬ä¸€ä¸ªhttpæœåŠ¡\"); }).listen(5205); //è‡ªå·±è®¾ç½®ç›‘å¬çš„ç«¯å£å·æœ€å¥½ä¸è¦ç”¨8888ï¼Œ8080ï¼Œå¯èƒ½ä¼šè¢«ç”µè„‘å…¶ä»–åº”ç”¨å ç”¨ï¼Œå®¹æ˜“æŠ¥é”™ console.log(\"5205å·²ç»åˆ›å»º!\"); ç»‘å®šç«¯å£å·ä¹Ÿå¯ä»¥ç›´æ¥ç»™å®ä¾‹ç»‘å®šï¼š â€‹ var server = http.createServer(){} â€‹ server.listen(ç«¯å£å·, callback) æ­¤æ—¶æ‰“å¼€æœ¬åœ°æµè§ˆå™¨ï¼Œlocal:host5205å³å¯æŸ¥çœ‹è®¿é—® responseçš„é‡å®šå‘é€šè¿‡æœåŠ¡å™¨è®©å®¢æˆ·ç«¯é‡å®šå‘ çŠ¶æ€ç è®¾ç½®302ä¸´æ—¶é‡å®šå‘ statusCode åœ¨å“åº”å¤´é€šè¿‡locationå‘Šè¯‰å®¢æˆ·å¾€å“ªé‡å®šå‘ setHeader å®¢æˆ·ç«¯å‘ç°æ”¶åˆ°æœåŠ¡å™¨çš„å“åº”çŠ¶æ€ç ä¸º302ï¼Œå°±ä¼šè‡ªåŠ¨å»å“åº”å¤´æ‰¾locationï¼Œç„¶åå¯¹è¯¥åœ°å€å‘èµ·æ–°çš„è¯·æ±‚ æ‰€ä»¥ä½ å°±èƒ½çœ‹åˆ°å®¢æˆ·ç«¯è‡ªåŠ¨è·³è½¬ï¼ˆè¿™é‡Œæ˜¯è·³è½¬è‡³é¦–é¡µï¼‰ //æ¥æ”¶è¡¨å•æ•°æ®åï¼ˆgetï¼‰ï¼Œè¿›è¡Œè·³è½¬ï¼Œè·³è½¬è‡³é¦–é¡µ var comment = url.parse(req.url, true).query; comments.unshift(comment); //ä»å¤´éƒ¨å¢åŠ æ•°ç»„å…ƒç´ ï¼Œcommentsä¸ºæ•°ç»„å˜é‡ res.statusCode = 302; res.setHeader('Location', '/'); //å“åº”å¤´çš„Loacationè·¯å¾„è®¾ç½®ä¸º '/' å³é¦–é¡µ res.end(); url.parse()(å¼ƒç”¨)url.parse(urlString , boolean , boolean) parseè¿™ä¸ªæ–¹æ³•å¯ä»¥å°†ä¸€ä¸ªurlçš„å­—ç¬¦ä¸²è§£æå¹¶è¿”å›ä¸€ä¸ªurlçš„å¯¹è±¡ã€‚ ç¬¬ä¸€ä¸ªå‚æ•°ä¼ å…¥ä¸€ä¸ªurlåœ°å€çš„å­—ç¬¦ä¸² ç¬¬äºŒä¸ªå‚æ•°ï¼ˆå¯çœï¼‰ä¼ å…¥ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œé»˜è®¤ä¸ºfalseï¼Œä¸ºtrueæ—¶ï¼Œè¿”å›çš„urlå¯¹è±¡ä¸­ï¼Œqueryçš„å±æ€§ä¸ºä¸€ä¸ªå¯¹è±¡ã€‚ // url.parse(\"http://user:pass@host.com:8080/p/a/t/h?query=string#hash\"); // returnï¼š { protocol: 'http:', slashes: true, auth: 'user:pass', host: 'host.com:8080', port: '8080', hostname: 'host.com', hash: '#hash', search: '?query=string', query: 'query=string', pathname: '/p/a/t/h', path: '/p/a/t/h?query=string', href: 'http://user:pass@host.com:8080/p/a/t/h?query=string#hash' } ç°åœ¨è¢«å¼ƒç”¨ä¹‹åï¼Œæ”¹ç”¨æ–°çš„API WHATWG URL APIï¼ˆæ— éœ€å¯¼åŒ…ï¼Œç›´æ¥ä½¿ç”¨ï¼‰ const myURL = new URL('http://user:pass@host.com:8080/p/a/t/h?query=string#hash'); console.log(myURL); ç›´æ¥è¿”å› URL { href: 'http://user:pass@host.com:8080/p/a/t/h?query=string#hash', origin: 'http://host.com:8080', protocol: 'http:', username: 'user', password: 'pass', host: 'host.com:8080', hostname: 'host.com', port: '8080', pathname: '/p/a/t/h', search: '?query=string', searchParams: URLSearchParams { 'query' => 'string' }, hash: '#hash' } è¯·æ±‚å¯¹è±¡ | æ•°æ®è·å–1.è¯·æ±‚è·¯å¾„ä¸ºï¼š request.url, urlï¼šç»Ÿä¸€èµ„æºå®šä½ç¬¦ è·¯å¾„ä¼˜åŒ–é—®é¢˜ï¼š var http = require('http'); const url = require('url') var fs = require('fs'); var wwwDir = 'C:/Users/ok-pc/blog/source/_posts'; //æ–‡ä»¶è·¯å¾„ http.createServer(function (req, res) { var url = = url.parse(req.url, true).pathname var filePath = '/index.html'; if (url !== '/') { filePath = url; } fs.readFile(wwwDir + filePath, function (err, data) { if (err) { return res.end('404'); } else { res.end(data); } }) }) getè¯·æ±‚æ•°æ®ï¼š http.createServer(function (req, res) { console.log(new URL(req.url, true).query) }) postè¯·æ±‚æ•°æ®ï¼š(å› ä¸ºpostæ˜¯ä»¥æµçš„æ–¹å¼ä¼ è¿‡æ¥çš„) function (request, response) { if (request.method == 'POST') { var body = ''; request.on('data', function (data) { body += data; // Too much POST data, kill the connection! // 1e6 === 1 * Math.pow(10, 6) === 1 * 1000000 ~~~ 1MB if (body.length > 1e6) request.connection.destroy(); }); request.on('end', function () { var post = qs.parse(body); // use post['blah'], etc. }); } } ipåœ°å€ä¸ç«¯å£æ‰€æœ‰è”ç½‘çš„ç¨‹åºéƒ½éœ€è¦ç½‘ç»œé€šä¿¡ï¼Œè®¡ç®—æœºåªæœ‰ä¸€ä¸ªç‰©ç†ç½‘å¡ï¼Œç½‘å¡çš„åœ°å€æ˜¯å”¯ä¸€çš„ï¼ˆipåœ°å€ï¼‰ ç«¯å£å·ç”¨æ¥å®šä½å…·ä½“åº”ç”¨ç¨‹åºï¼ˆç±»ä¼¼é“¶è¡Œçª—å£å·ï¼ŒæœåŠ¡å™¨ç±»ä¼¼äºé“¶è¡Œï¼‰ ä¸€åˆ‡éœ€è¦è”ç½‘é€šä¿¡çš„è½¯ä»¶éƒ½ä¼šå ç”¨ä¸€ä¸ªç«¯å£å· ç«¯å£å·åœ¨ 0 - 65536 ä¹‹é—´ åœ¨è®¡ç®—æœºä¸­æœ‰ä¸€äº›é»˜è®¤ç«¯å£å·ï¼Œæœ€å¥½ä¸è¦å»ä½¿ç”¨ ä¾‹å¦‚httpæœåŠ¡çš„80 å¯ä»¥åŒæ—¶å¼€å¯å¤šä¸ªæœåŠ¡ï¼Œä½†æ˜¯ä¸€å®šè¦ç¡®ä¿ä¸åŒæœåŠ¡å ç”¨ç«¯å£å·ä¸ä¸€è‡´ï¼ˆåœ¨ä¸€å°è®¡ç®—æœºä¸­ï¼ŒåŒä¸€ç«¯å£å·åŒä¸€æ—¶é—´åªèƒ½è¢«ä¸€ä¸ªç¨‹åºå ç”¨ï¼‰ å¤„ç†é™æ€èµ„æºæµè§ˆå™¨æ”¶åˆ°htmlå“åº”å†…å®¹ä¹‹åï¼Œå°±è¦å¼€å§‹ä»ä¸Šåˆ°ä¸‹è¿›è¡Œè§£æï¼Œå½“åœ¨è§£æè¿‡ç¨‹ä¸­ï¼Œå¦‚æœå‘ç°ï¼š link script img iframe video audio ç­‰å¸¦æœ‰src æˆ–è€… hrefï¼ˆlinkï¼‰å±æ€§æ ‡ç­¾çš„æ—¶å€™ï¼ˆå…·æœ‰å¤–é“¾èµ„æºçš„æ—¶å€™ï¼‰ï¼Œæµè§ˆå™¨ä¼šè‡ªåŠ¨å¯¹è¿™äº›èµ„æºå‘èµ·æ–°çš„è¯·æ±‚ æˆ‘ä»¬ä¸ºäº†æ–¹ä¾¿ç»Ÿä¸€å¤„ç†è¿™äº›é™æ€èµ„æºï¼Œæ‰€ä»¥çº¦å®šæŠŠæ‰€æœ‰é™æ€èµ„æºå­˜æ”¾åœ¨publicç›®å½•ä¸­ï¼Œå³å¦‚æœè¯·æ±‚è·¯å¾„ä»¥ /public/å¼€å¤´ï¼Œåˆ™è®¤ä¸ºä½ æ˜¯è¦è·å–publicçš„æŸä¸ªèµ„æºï¼Œæ‰€ä»¥æˆ‘ä»¬è¿™æ—¶å¯ä»¥ç›´æ¥æŠŠè¯·æ±‚è·¯å¾„å½“ä½œæ–‡ä»¶è·¯å¾„è¿›è¡Œè¯»å– è¿™æ—¶å“ªäº›èµ„æºèƒ½å¦è¢«ç”¨æˆ·è®¿é—®å¯ä»¥è¾¾åˆ°ä¸€ä¸ªå¯æ§çš„çŠ¶æ€ ï¼ˆæ³¨æ„ï¼šåœ¨æœåŠ¡ç«¯ä¸­ï¼Œæ–‡ä»¶çš„è·¯å¾„å°±è¦è¦å†™ç›¸å¯¹è·¯å¾„äº†ï¼Œå› ä¸ºè¿™ä¸ªæ—¶å€™æ‰€æœ‰èµ„æºéƒ½æ˜¯é€šè¿‡urlæ ‡è¯†æ¥è·å–ï¼Œè¿™é‡ŒæœåŠ¡å™¨å¼€æ”¾äº†/public/ç›®å½•ï¼Œæ‰€ä»¥è¿™é‡Œè¯·æ±‚è·¯å¾„å†™æˆ /public/xxxï¼‰ htmlä¸­çš„link ï¼š&lt;link rel=&quot;stylesheet&quot; href=&quot;/public/lib/bootstrap/dist/css/bootstrap.css&quot;&gt; nodeJsä»£ç ï¼š var http = require('http'); var fs = require('fs'); var rg = /^\\/public\\//; http.createServer(function (req, res) { var url = req.url; if (url === '/') { fs.readFile('./views/index.html', function (err, data) { if (err) { return res.end('404 Not Found.'); } res.end(data); }) } else if (rg.test(url)) { // å¦‚ ï¼š/public/lib/bootstrap/dist/css/bootstrap.css // url.indexOf('/public/') === 0ä¹Ÿå¯ä»¥ fs.readFile('.' + url, function (err, data) { if (err) { return res.end('404 Not Found.'); } res.end(data); }); } }).listen(5208, function () { console.log('running!!...'); }); 5.äº‹ä»¶nodeJså®ƒåŸºæœ¬ä¸Šï¼Œæ‰€æœ‰äº‹ä»¶æœºåˆ¶ï¼Œéƒ½æ˜¯åŸºäºè®¾è®¡æ¨¡å¼ç§â€œè§‚å¯Ÿè€…æ¨¡å¼â€æ¥å®ç°çš„ ç®€å•æ¥è¯´ï¼Œnodejsä½¿ç”¨äº‹ä»¶é©±åŠ¨çš„æ¨¡å‹ï¼Œæ¯å½“æ¥æ”¶åˆ°ä¸€ä¸ªè¯·æ±‚ï¼Œå°±æŠŠä»–å…³æ‰è¿›è¡Œå¤„ç†ï¼Œå½“è¿™ä¸ªè¯·æ±‚å®Œæˆï¼Œå°±æŠŠå®ƒæ”¾åˆ°å¤„ç†é˜Ÿåˆ—å½“ä¸­ï¼Œæœ€åæŠŠç»“æœè¿”å›ç»™ç”¨æˆ· å› ä¸ºå®ƒçš„æœåŠ¡ä¸€ç›´æ˜¯å¤„ç†æ¥æ”¶è¯·æ±‚ï¼Œä½†ä¸ç­‰å¾…ä»»ä½•è¯»å†™æ“ä½œï¼Œæ‰€ä»¥æ€§èƒ½å¾ˆé«˜ï¼Œè¿™ä¹Ÿå«åšâ€œéé˜»å¡å¼IOæˆ–æ˜¯äº‹ä»¶é©±åŠ¨IOâ€ nodeJSäº‹ä»¶ä½¿ç”¨eventsæ¨¡å—ï¼Œé€šè¿‡å®ä¾‹åŒ–å®ƒé‡Œé¢çš„EventEmitterç±»æ¥ç»‘å®šå’Œç›‘å¬äº‹ä»¶ï¼Œä¹Ÿæ˜¯åˆ©ç”¨äº†â€œå‘å¸ƒè®¢é˜…æ¨¡å¼â€ ä½¿ç”¨äº‹ä»¶æ¨¡å—ï¼švar eve = require(&#39;events&#39;) å®ä¾‹åŒ–EventEmitterç±»ï¼švar event = new eve.EventEmitter() â€‹ å®ä¾‹åŒ–å¯¹è±¡é‡Œæœ‰ä¸ª_eventsCountå±æ€§ï¼Œæ˜¾ç¤ºç»‘å®šäº‹ä»¶æ•°é‡ ï¼ˆä¹Ÿå¯ä»¥ï¼š var eventEmitter = require(&#39;events&#39;).EventEmitter; â€‹ var event = new eventEmitter(); ï¼‰ ç»‘å®šäº‹ä»¶ï¼ševent.on(äº‹ä»¶å, callback)ï¼ˆjqueryä¹Ÿç”¨onç»‘å®šäº‹ä»¶ï¼‰ â€‹ äº‹ä»¶åå¯ä»¥è‡ªå®šä¹‰ï¼Œå› ä¸ºè¿™é‡Œçš„äº‹ä»¶åå®Œå…¨ä¸åŒäºæµè§ˆå™¨ä¸Šçš„å„ç§äº‹ä»¶ï¼Œè¿™é‡Œçš„äº‹ä»¶åå°±æ˜¯ä¸€ä¸ªâ€œæ ‡è¯†â€ï¼Œå®é™…ä¸Šç»‘å®šäº†ä¸€ä¸ªå›è°ƒå‡½æ•° ç›‘å¬äº‹ä»¶çš„è§¦å‘ï¼ševent.emit(äº‹ä»¶å) // ç»‘å®šä¸€ä¸ªäº‹ä»¶ event.on('one', function () { console.log(\"no.1äº‹ä»¶è¢«è§¦å‘äº†\"); }); // è§¦å‘ä¸€ä¸ªäº‹ä»¶ event.emit('one'); æ‰€æœ‰nodejsé‡Œé¢çš„å¼‚æ­¥ioæ“ä½œï¼Œéƒ½ä¼šåœ¨å®Œæˆæ—¶ï¼Œå‘é€ä¸€ä¸ªäº‹ä»¶åˆ°äº‹ä»¶é˜Ÿåˆ— 6.æ¨¡æ¿å¼•æ“æœ€æ—©è¯ç”ŸäºæœåŠ¡å™¨é¢†åŸŸï¼Œåæ¥å‘å±•åˆ°å‰ç«¯ å®˜æ–¹æ–‡æ¡£ï¼šhttps://aui.github.io/art-template/ å®‰è£…npm install art-template æµè§ˆå™¨åº”ç”¨å¼•å…¥ &lt;script src=&quot;./node_modules/art-template/lib/template-web.js&quot;&gt;&lt;/script&gt; ç±»å‹æ”¹ä¸º type = &quot;text/template&quot; æ¨¡æ¿å¼•æ“ä¸å…³å¿ƒå­—ç¬¦ä¸²å†…å®¹ï¼Œåªå…³å¿ƒè‡ªå·±èƒ½è®¤è¯†çš„æ¨¡æ¿æ ‡è®°è¯­æ³•ï¼Œä¾‹å¦‚(åŒ…å«ifè¯­å¥åˆ¤æ–­) {{ å˜é‡å }} {{ if user }} {{ else }} {{ /if }}{{ each éå†æ•°ç»„ }} &lt;li&gt;{{ $index + 1 }}&lt;/li&gt; &lt;li&gt;{{ $value }}&lt;/li&gt; {{/each}}è¯¥è¯­æ³•è¢«ç§°ä¹‹ä¸ºmustacheè¯­æ³•ï¼Œå…«å­—èƒ¡ template(&#39;script æ ‡ç­¾ id&#39;, {å¯¹è±¡}) &lt;script src=\"./node_modules/art-template/lib/template-web.js\">&lt;/script> &lt;script type=\"text/template\" id=\"tql\"> hello{{ name }} ä»Šå¹´ {{ age }} å²äº† &lt;/script> &lt;script> var ret = template('tql', { name: 'jack', age: 18 }) console.log(ret); document.querySelector('#è¡¨å•idå·').innerHTML = ret; &lt;/script> nodejsåº”ç”¨æ ¸å¿ƒæ–¹æ³• å¼•å…¥ï¼š var template = require(&#39;art-template&#39;); åŸºäºæ¨¡æ¿åæ¸²æŸ“æ¨¡æ¿template(filename, data); å°†æ¨¡æ¿æºä»£ç ç¼–è¯‘æˆå‡½æ•°template.compile(source, options); å°†æ¨¡æ¿æºä»£ç ç¼–è¯‘æˆå‡½æ•°å¹¶ç«‹åˆ»æ‰§è¡Œtemplate.render(source, data, options); var ret = template.render('hello {{ name }}', { name: 'Jack' }) 7.PathPathæ˜¯ä¸€ä¸ªæ ¸å¿ƒæ¨¡å— var path = require(&#39;path&#39;) path.basename(path[,ext]) è·å–ç»™å®šè·¯å¾„å½“ä¸­æ–‡ä»¶åéƒ¨åˆ†ï¼Œç¬¬äºŒä¸ªå‚æ•°å¯ä»¥ç”¨æ¥å»é™¤æŒ‡å®šçš„åç¼€å console.log(path.basename('c:/a/b/c/index.js')); //index.js console.log(path.basename('c:/a/b/c/index.js', '.js')); //index console.log(path.basename('c:/a/b/c/index.js', '.html')); //index.js path.dirname(path) æ–¹æ³•ä¼šè¿”å› path çš„ç›®å½•å path.extname(path) è¿”å› path çš„æ‰©å±•å console.log(path.extname('c:/a/b/c/index.html');); //.html path.isAbsolute(path) æ£€æµ‹ path æ˜¯å¦ä¸ºç»å¯¹è·¯å¾„ã€‚(â€˜./c/index.jsâ€™æ˜¯ç›¸å¯¹è·¯å¾„ï¼Œ â€˜/c/index.jsâ€™æ˜¯ç»å¯¹è·¯å¾„) path.join([...paths]) æ–¹æ³•ä¼šå°†æ‰€æœ‰ç»™å®šçš„ path ç‰‡æ®µè¿æ¥åˆ°ä¸€èµ·ï¼Œç”Ÿæˆè§„èŒƒåŒ–è·¯å¾„ path.join('/ç›®å½•1', 'ç›®å½•2', 'ç›®å½•3/ç›®å½•4', 'ç›®å½•5'); // \\\\ç›®å½•1\\\\ç›®å½•2\\\\ç›®å½•3\\\\ç›®å½•4\\\\ç›®å½•5' path.resolve([from...],to) æŠŠä¸€ä¸ªè·¯å¾„æˆ–è·¯å¾„ç‰‡æ®µçš„åºåˆ—è§£æä¸ºä¸€ä¸ªç»å¯¹è·¯å¾„ï¼Œæœ‰ç‚¹åƒjoinï¼Œä½†æ˜¯è§£æç»“æœä¸€å®šæ˜¯ç»å¯¹è·¯å¾„ æ›´å¤šçŸ¥è¯†ç‚¹å¯æŸ¥çœ‹nodejså®˜æ–¹æ–‡æ¡£çš„Pathéƒ¨åˆ† åœ¨æ–‡ä»¶æ“ä½œè·¯å¾„ä¸­ï¼Œä½¿ç”¨ç›¸å¯¹è·¯å¾„æ˜¯ä¸å¯é çš„ï¼Œå› ä¸ºç›¸å¯¹è·¯å¾„è®¾è®¡å°±æ˜¯ç›¸å¯¹äºæ‰§è¡Œnode å‘½ä»¤æ‰€å¤„çš„è·¯å¾„ï¼Œ æ‰€ä»¥æˆ‘ä»¬è¦åˆ©ç”¨å¥½ï¼ˆä»¥ä¸‹åœ¨nodeä¸­ä¸ºå…¨å±€å˜é‡ï¼Œç›´æ¥ç”¨ï¼‰ __filename å½“å‰æ¨¡å—çš„å®Œæ•´è·¯å¾„ __dirname å½“å‰æ¨¡å—æ‰€åœ¨æ–‡ä»¶å¤¹å®Œæ•´è·¯å¾„ï¼ˆæ‰€å±ç›®å½•çš„ç»å¯¹è·¯å¾„ï¼‰ é…åˆPathè¿›è¡Œæ“ä½œï¼ˆæ¯”å¦‚æ‹¼æ¥è·¯å¾„è¿‡ç¨‹ä¸­ï¼Œé˜²æ­¢æ‰‹åŠ¨æ‹¼æ¥å¸¦æ¥ä½çº§é”™è¯¯ï¼Œå¯ä»¥ä½¿ç”¨path.joinï¼‰ï¼ŒæŠŠç›¸å¯¹è·¯åŠ²å˜æˆç»å¯¹è·¯å¾„ï¼ˆæ³¨æ„æ˜¯åŠ¨æ€ç»å¯¹è·¯å¾„ï¼‰å°±å¥½äº† //expressæ¡†æ¶å…¬å¼€æŒ‡å®šç›®å½• app.use('/node_modules/', express.static(path.join(__dirname, './node_modules/'))); ç‰¹æ®Š ï¼šæ¨¡å—ä¸­çš„è·¯å¾„æ ‡è¯†ï¼ˆæ¯”å¦‚ï¼šrequire(&#39;./a.js&#39;)ï¼‰æ˜¯ç›¸å¯¹äºå½“å‰æ–‡ä»¶æ¨¡å—ï¼Œä¸å—åˆ°nodeå‘½ä»¤æ‰€å¤„è·¯å¾„å½±å“ 8.å…¶ä»–è¿›ç¨‹ä¸ºæˆ‘ä»¬ç¨‹åºçš„è¿è¡Œæä¾›ä¸€ä¸ªå¿…å¤‡çš„ç¯å¢ƒï¼ˆè¿›ç¨‹æ˜¯èµ„æºåˆ†é…çš„æœ€å°å•ä½ï¼‰ çº¿ç¨‹æ˜¯è®¡ç®—æœºä¸­æœ€å°çš„è®¡ç®—å•ä½ï¼Œçº¿ç¨‹è´Ÿè´£æ‰§è¡Œä¿å­˜åˆ°è¿›ç¨‹ä¸­çš„ç¨‹åºï¼ˆçº¿ç¨‹æ˜¯CPUè°ƒåº¦çš„æœ€å°å•ä½ï¼‰ JSã€æµè§ˆå™¨ã€nodejsæ˜¯å•çº¿ç¨‹ ä¿®æ”¹å®Œè‡ªåŠ¨é‡å¯æœåŠ¡å™¨æˆ‘ä»¬è¿™é‡Œå¯ä»¥ä½¿ç”¨ä¸€ä¸ªç¬¬ä¸‰æ–¹å·¥å…·ï¼šnodemonæ¥å¸®æˆ‘ä»¬è§£å†³ä¿®æ”¹ä»£ç é‡å¯æœåŠ¡å™¨é—®é¢˜ #--global æ¥å®‰è£…åˆ™å¯ä»¥åœ¨ä»»æ„ç›®å½•æ‰§è¡Œ npm install --global nodemon åŸæ¥æˆ‘ä»¬åœ¨å‘½ä»¤è¡Œè¾“å…¥ï¼šnode xxx.js ç°åœ¨ï¼šnodemon xxx.jsï¼Œ ä»–ä¼šç›‘è§†ä½ çš„æ–‡ä»¶å˜åŒ–ï¼Œå½“æ–‡ä»¶å˜åŒ–æ—¶ï¼Œä¼šè‡ªåŠ¨å¸®ä½ é‡å¯æœåŠ¡å™¨ JSONæ–¹æ³•JSON.stringify() æ–¹æ³•å°†ä¸€ä¸ª JavaScript å¯¹è±¡æˆ–å€¼è½¬æ¢ä¸º JSON å­—ç¬¦ä¸²ï¼Œå¦‚æœæŒ‡å®šäº†ä¸€ä¸ª replacer å‡½æ•°ï¼Œåˆ™å¯ä»¥é€‰æ‹©æ€§åœ°æ›¿æ¢å€¼ï¼Œæˆ–è€…æŒ‡å®šçš„ replacer æ˜¯æ•°ç»„ï¼Œåˆ™å¯é€‰æ‹©æ€§åœ°ä»…åŒ…å«æ•°ç»„æŒ‡å®šçš„å±æ€§ã€‚ ä¸€èˆ¬ç”¨äºå­˜å‚¨æ•°æ®æ—¶ï¼Œå¯¹å¯¹è±¡ä¹‹ç±»æ•°æ®ä»¥å­—ç¬¦ä¸²çš„å½¢å¼è¿›è¡Œä¿å­˜ JSON.parse() æ–¹æ³•ç”¨æ¥è§£æJSONå­—ç¬¦ä¸²ï¼Œæ„é€ ç”±å­—ç¬¦ä¸²æè¿°çš„JavaScriptå€¼æˆ–å¯¹è±¡ã€‚æä¾›å¯é€‰çš„ reviver å‡½æ•°ç”¨ä»¥åœ¨è¿”å›ä¹‹å‰å¯¹æ‰€å¾—åˆ°çš„å¯¹è±¡æ‰§è¡Œå˜æ¢(æ“ä½œ)ã€‚ ä¸€èˆ¬ç”¨äºå°†æ•°æ®å–å‡ºæ—¶ï¼Œè½¬åŒ–æœªçœŸæ­£çš„ç±»å‹è°ƒç”¨çš„æ–¹æ³• è¿˜æœ‰æ‰‹å†™æ–¹æ³•å¯ä»¥å‚è€ƒä¸€æ³¢https://juejin.cn/post/6844903992871354375 ä½¿ç”¨node.jsè¿›è¡Œçˆ¬è™«åŸç†ï¼šå½“ç½‘é¡µæ—¶åç«¯æ¸²æŸ“æ—¶ï¼Œå¯¹ç½‘é¡µæºä»£ç è¿›è¡Œçˆ¬å–ï¼Œå¾—åˆ°å…¶htmlæºç  ç¬¬ä¸€æ­¥ï¼š ä½¿ç”¨ npm init --yesåˆå§‹åŒ–åˆ›å»ºçš„æ–‡ä»¶å¤¹ ä¸‹è½½ä¾èµ–åŒ… npm i superagent cheerio superagent: æ˜¯ä¸€ä¸ªè½»é‡çš„Ajax APIï¼Œå’Œaxioså·®ä¸å¤šï¼Œåªä¸è¿‡ä»–ä¸æ”¯æŒæµè§ˆå™¨ cheerioï¼šä¸ºæœåŠ¡å™¨ç‰¹åˆ«å®šåˆ¶çš„å¿«é€Ÿçµæ´»jQueryï¼Œå®ƒå¹¶ä¸ä¼šäº§ç”Ÿè§†è§‰å‘ˆç°ï¼Œåº”ç”¨CSSï¼ŒåŠ è½½å¤–éƒ¨èµ„æºï¼Œæˆ–è€…æ‰§è¡ŒJavaScriptï¼Œå¯ä»¥ç”¨æ¥ä»ç½‘é¡µcss selectorå–æ•°æ®ï¼Œä½¿ç”¨æ–¹æ³•å’ŒjQueryä¸€æ · å¦‚æœä½ ä¸æƒ³ç”¨cheerioï¼Œå°±è‡ªå·±ä¸€ä¸ªä¸€ä¸ªæ­£åˆ™åŒ¹é…å»å§ï¼ï¼ˆ= = ï¼‰ ç¬¬äºŒæ­¥ï¼š é€šè¿‡ superagent &amp; cheerioè·å–ç½‘é¡µæ•°æ®ï¼ˆåç«¯æ¸²æŸ“ï¼‰ æ•°æ®å¤„ç†ï¼Œå¯ä»¥ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼ï¼Œå­—ç¬¦ä¸²åˆ‡å‰²ï¼Œæˆ–è€…eval() å‡½æ•°ï¼ˆå¯è®¡ç®—æŸä¸ªå­—ç¬¦ä¸²ï¼Œå¹¶æ‰§è¡Œå…¶ä¸­çš„çš„ JavaScript ä»£ç ã€‚ï¼‰ ç¬¬ä¸‰æ­¥ï¼š å†™å…¥æœ¬åœ° superagent.get('https://ncov.dxy.cn/ncovh5/view/pneumonia').then(res => { // æµè§ˆå™¨å¯ä»¥è§£æä»£ç ï¼Œnodeç«¯ç›´æ¥è¿”å›æºç ,è€Œres.textæ˜¯æˆ‘ä»¬éœ€è¦çš„å“åº”æ•°æ® const $ = cheerio.load(res.text); //ç»æµ‹è¯•ï¼Œsuperagentçš„res.text = axiosçš„res.data const $getAreaStat = $('#getAreaStat').html(); // åŠ å…¥å…¨å›½ç–«æƒ…æ•°æ® let data = {}; eval($getAreaStat.replace(/window/g, 'data')); //æ‰§è¡Œé‡Œé¢çš„è¯­å¥ï¼Œä½¿å¾—dataæˆåŠŸè¢«èµ‹å€¼ console.log(data); // å­—ç¬¦ä¸²è½¬æ¢json fs.writeFile(path.join(__dirname, './data.json'), JSON.stringify(data), err => { if (err) throw err; console.log(\"å†™å…¥æˆåŠŸï¼ï¼ï¼\"); }) }).catch(err => { throw err; }) å¦‚æœæ˜¯çˆ¬å–åˆ°åŸç½‘é¡µåï¼Œå¯¹ç½‘é¡µæ ‡ç­¾é‡Œçš„æ•°æ®è¿›è¡Œè·å–ï¼Œå¯ä»¥ä½¿ç”¨ é‡Œé¢çš„ä½¿ç”¨å’ŒjQueryä½¿ç”¨ä¸€æ ·ï¼Œå¯ä»¥ä½¿ç”¨eachæ–¹æ³•éå† const $ = cheerio.load(res.text); const inner = $('#home .col a').text();//åœ¨å¤–å±‚æ˜¯idä¸ºhomeï¼Œé‡Œé¢ç±»åä¸ºcolæ ‡ç­¾å†…é‡Œçš„aæ ‡ç­¾ $('#home .col a').each((index, ele) => { console.log($(ele)) console.log($(ele).attr(\"å±æ€§å\")) console.log($(ele).text()) })","categories":[{"name":"å‰ç«¯","slug":"å‰ç«¯","permalink":"https://taylor12138.github.io/categories/%E5%89%8D%E7%AB%AF/"}],"tags":[],"author":"Hello"},{"title":"æ¨¡å—å¯¼å…¥","slug":"æ¨¡å—å¯¼å…¥","date":"2022-05-05T06:07:51.528Z","updated":"2023-04-13T09:18:55.301Z","comments":true,"path":"2022/05/05/mo-kuai-dao-ru/","link":"","permalink":"https://taylor12138.github.io/2022/05/05/mo-kuai-dao-ru/","excerpt":"","text":"æ¨¡å—åŒ–å¼€å‘JavaScriptå¼Šç«¯ï¼šæ–‡ä»¶ä¾èµ–ï¼ˆa.js-&gt;b.js-&gt;c.jsï¼Œç›¸äº’ä¾èµ–ï¼Œä½†æ˜¯å¾ˆéš¾ç›´æ¥çœ‹å‡ºæ¥ï¼Œåˆ†æå®Œåæ‰çŸ¥é“è¦ä¸€ä¸ªä¸€ä¸ªå¼•å…¥ï¼‰å’Œå‘½åå†²çªï¼ˆåœ¨ç›¸äº’ä¾èµ–çš„jsä¸­å£°æ˜åŒæ ·çš„å˜é‡åå¯¼è‡´çš„é”™è¯¯ï¼‰ æ¨¡å—åŒ–å¼€å‘ï¼šä¸€ä¸ªåŠŸèƒ½ä¸€ä¸ªæ¨¡å—ï¼Œå¤šæ¨¡å—ç»„åˆå®Œæ•´åº”ç”¨ï¼ŒæŠ½ç¦»ä¸€ä¸ªæ¨¡å—ä¸ä¼šå½±å“å…¶ä»–åŠŸèƒ½çš„è¿è¡Œï¼Œé™ä½ç¨‹åºçš„è€¦åˆæ€§ï¼Œæ–¹ä¾¿ä»£ç å¤ç”¨ï¼ˆè™½ç„¶å¼€å‘æ•ˆç‡ä½ä¸€ç‚¹ï¼‰ 1.CommonJScommonJSçš„æå‡ºï¼š ä¸ºäº†å¼¥è¡¥JavaScriptæ²¡æœ‰æ ‡å‡†çš„ç¼ºé™·ï¼Œå¸Œæœ›JSâ€™èƒ½åœ¨ä»»ä½•å’Œåœ°æ–¹è¿è¡Œï¼ŒCommonJSå¯¹æ¨¡å—çš„å®šä¹‰ååˆ†ç®€å• æ³¨æ„ï¼Œä¸€èˆ¬è®¤ä¸ºNode.jsçš„æ¨¡å—ç³»ç»Ÿä½¿ç”¨äº†CommonJSçš„è§„èŒƒï¼Œå®é™…ä¸Šå¹¶ä¸å®Œå…¨æ­£ç¡®ï¼ŒNode.jsä½¿ç”¨äº†è½»å¾®ä¿®æ”¹ç‰ˆæœ¬çš„CommonJSï¼Œå› ä¸ºNode.JSä¸»è¦åœ¨æœåŠ¡å™¨ç¯å¢ƒä¸‹ä½¿ç”¨ï¼Œæ‰€ä»¥ä¸éœ€è¦è€ƒè™‘ç½‘ç»œå»¶è¿Ÿé—®é¢˜ CommonJSç‰¹ç‚¹node.jsè§„å®šä¸€ä¸ªJavaScriptæ–‡ä»¶å°±æ˜¯ä¸€ä¸ªæ¨¡å—ï¼Œæ¨¡å—å†…éƒ¨å®šä¹‰çš„å˜é‡å’Œå‡½æ•°é»˜è®¤æƒ…å†µä¸‹åœ¨å¤–éƒ¨æ— æ³•å¾—åˆ°ï¼ˆé™¤äº†console.logçš„è¾“å‡ºå†…å®¹ï¼‰ï¼Œå› ä¸ºåœ¨nodeçš„å®šä¹‰ä¸­ï¼Œæ¯ä¸ªjsæ–‡ä»¶çš„jsä»£ç éƒ½æ˜¯ç‹¬ç«‹è¿è¡Œåœ¨ä¸€ä¸ªå‡½æ•°ä¸­ï¼Œè€Œä¸æ˜¯å…¨å±€ä½œç”¨åŸŸã€‚ å½“nodeæ‰§è¡Œæ¨¡å—ä¸­ä»£ç ï¼Œå®ƒé¦–å…ˆåœ¨ä»£ç é¡¶éƒ¨æ·»åŠ ï¼š function(exports, require, module, __filename, __dirname){} å°†ä»£ç åŒ…å«è¿›å»ï¼Œæ­¤æ—¶ç”±äºåœ¨å¤–éƒ¨åŒ…è£¹äº†ä¸€å±‚functionï¼Œå°±ä¼šå½¢æˆä¸€ä¸ªä½œç”¨åŸŸï¼Œé¿å…äº†å…¨å±€æ±¡æŸ“ æ¨¡å—å†…éƒ¨ä½¿ç”¨exports å¯¹è±¡è¿›è¡Œæˆå‘˜å¯¼å‡ºï¼Œä½¿ç”¨requireæ–¹æ³•å¯¼å…¥å…¶ä»–æ¨¡å—ï¼ˆæ³¨æ„ES6ä¸ä½¿ç”¨requireè€Œæ˜¯ä½¿ç”¨importï¼‰ CommonJS è§„èŒƒæ˜¯åœ¨ä»£ç è¿è¡Œæ—¶åŒæ­¥é˜»å¡æ€§åœ°åŠ è½½æ¨¡å—ï¼Œåœ¨æ‰§è¡Œä»£ç è¿‡ç¨‹ä¸­é‡åˆ° require(X) æ—¶ä¼šåœä¸‹æ¥ç­‰å¾…ï¼Œç›´åˆ°æ–°çš„æ¨¡å—åŠ è½½å®Œæˆä¹‹åå†ç»§ç»­æ‰§è¡Œæ¥ä¸‹å»çš„ä»£ç ã€‚ è™½è¯´æ˜¯åŒæ­¥é˜»å¡æ€§ï¼Œä½†è¿™ä¸€æ­¥å®é™…ä¸Šéå¸¸å¿«ï¼Œå’Œæµè§ˆå™¨ä¸Šé˜»å¡æ€§ä¸‹è½½ã€è§£æã€æ‰§è¡Œ js æ–‡ä»¶ä¸æ˜¯ä¸€ä¸ªçº§åˆ«ï¼Œç¡¬ç›˜ä¸Šè¯»æ–‡ä»¶æ¯”ç½‘ç»œè¯·æ±‚å¿«å¾—å¤šã€‚ ä½†æ˜¯ï¼šæ¨¡å—è¯·æ±‚ä»ç„¶ä¼šé€ æˆæµè§ˆå™¨ JS è§£æè¿‡ç¨‹çš„é˜»å¡ï¼Œå¯¼è‡´é¡µé¢åŠ è½½é€Ÿåº¦å˜æ…¢ åœ¨æ¨¡å—ä»£ç è¢«è¿è¡Œå‰å°±å·²ç»å†™å…¥äº† cacheï¼ŒåŒä¸€ä¸ªæ¨¡å—è¢«å¤šæ¬¡ require æ—¶åªä¼šæ‰§è¡Œä¸€æ¬¡ï¼Œé‡å¤çš„ require å¾—åˆ°çš„æ˜¯ç›¸åŒçš„ exports å¼•ç”¨ã€‚ const a1 = require('./moduleA'); const a2 = require('./moduleB'); console.log(a1 === a2); // true å‡ºç°æ–‡ä»¶äº’ç›¸å¼•ç”¨çš„æƒ…å†µä¸‹ï¼Œä¼šå»ç¼“å­˜æŸ¥çœ‹ä¹‹å‰æ˜¯å¦å†™å…¥è¿‡ï¼Œè‹¥å†™å…¥è¿‡ï¼Œè¢«å¼•ç”¨ä¸‹ä¸ªæ–‡ä»¶å½¢æˆå¾ªç¯å¼•ç”¨ä¹‹å‰çš„åˆ°å¤„å˜é‡å˜å¾—â€å¯è§†â€ï¼›å¦åˆ™è¢«ç»Ÿè®¡ä¸º â€œundefinedâ€ // main.js const a = require('./a'); console.log('in main, a.a1 = %j, a.a2 = %j', a.a1, a.a2); // a.js exports.a1 = true; const b = require('./b.js'); console.log('in a, b.done = %j', b.done); exports.a2 = true; // b.js const a = require('./a.js'); console.log('in b, a.a1 = %j, a.a2 = %j', a.a1, a.a2); in b, a.a1 = true, a.a2 = undefined in a, b.done = undefined in main, a.a1 = true, a.a2 = trueè¿›å…¥ b æ¨¡å—å‰ï¼Œ è¿™æ—¶å€™ a2 ä»£ç è¿˜æ²¡æ‰§è¡Œã€‚ è¿›å…¥ b æ¨¡å—ï¼Œrequire a.js æ—¶å‘ç°ç¼“å­˜ä¸Šå·²ç»å­˜åœ¨äº†ï¼Œè·å– a æ¨¡å—ä¸Šçš„ exports ã€‚æ‰“å° a1, a2 åˆ†åˆ«æ˜¯ trueï¼Œå’Œ undefinedã€‚ å®è·µï¼š exports //a.js let version = 1.0; const sayHi = name => `ä½ å¥½, ${name}`; //å‘æ¨¡å—å¤–å¯¼å‡ºæ•°æ® exports.version = version; exports.sayHi = sayHi; require,å¦‚æœç›´æ¥ä½¿ç”¨æ¨¡å—åæ¥å¼•å…¥ï¼Œæ²¡æœ‰æ·»åŠ è·¯å¾„ï¼Œå®ƒä¼šé¦–å…ˆåœ¨å½“å‰ç›®å½•çš„node_modulesä¸­å¯»æ‰¾æ˜¯å¦å«æœ‰è¯¥æ¨¡å—ï¼Œæ²¡æœ‰åˆ™ä¸€ç›´å¾€ä¸Šä¸€çº§å¯»æ‰¾var math = require(&quot;math&quot;) ï¼ˆrequireåŠ è½½è§„åˆ™ï¼šä¼˜å…ˆä»ç¼“å­˜åŠ è½½ï¼Œå³ä¹‹å‰åŠ è½½è¿‡çš„æ¨¡å—ï¼Œä¸å†åŠ è½½ï¼‰ æ¨¡å—ä¸­çš„è·¯å¾„æ ‡è¯†æ˜¯ç›¸å¯¹äºå½“å‰æ–‡ä»¶æ¨¡å—ï¼Œä¸å—åˆ°nodeå‘½ä»¤æ‰€å¤„è·¯å¾„å½±å“ï¼Œæƒ³æŸ¥çœ‹è·¯å¾„å½±å“å¯è·³è½¬é˜…è¯» 9. Path //b.js //b.jså¯¼å…¥a.js, ./b.jsæ˜¯b.jsçš„è·¯å¾„ï¼Œè·¯å¾„æ¨¡å—å¿…é¡»åŠ './', å¦‚æœåªåŠ äº†'/'ï¼Œå°±å½“ä½œæ­¤ç›˜æ ¹ç›®å½•ä¸‹è·¯å¾„ï¼Œä¹Ÿå°±æ˜¯ç»å¯¹è·¯å¾„å¤„ç† let a = require('./a.js'); console.log(a.version); console.log(a.sayHi('xx')); //ä½¿ç”¨a.jsçš„æ–¹æ³• æ¨¡å—å¯¼å‡ºçš„å¦ä¸€ç§æ–¹å¼(å’Œexportså·®ä¸å¤š)ï¼š //a.js module.exports.version = version; module.exports.sayHi = sayHi; //b.js let a = require('./a.js'); //b.jså¯¼å…¥a.js, ./b.jsæ˜¯b.jsçš„ç›®å½• console.log(a.version); console.log(a.sayHi('xx')); //ä½¿ç”¨a.jsçš„æ–¹æ³• moduleä»£è¡¨å½“å‰æ¨¡å—æœ¬èº« exportsæ˜¯module.exportsçš„åˆ«åï¼ˆåœ°å€å¼•ç”¨å…³ç³»ï¼‰ï¼Œå®ƒä»¬ä¿©æŒ‡å‘åŒä¸€å—å†…å­˜ç©ºé—´ï¼Œå¯¼å‡ºå¯¹è±¡ï¼ˆå½“exportså’Œmodule.exportså¯¹è±¡æŒ‡å‘çš„ä¸æ˜¯åŒä¸€ä¸ªå¯¹è±¡æ—¶ï¼‰æœ€ç»ˆä»¥module.exportsä¸ºå‡†ï¼Œå³æƒ³è¦ç›´æ¥ä»¥å¯¹è±¡çš„æ–¹å¼è¿›è¡Œå…¨éƒ¨ä¿®æ”¹ï¼Œåªèƒ½ä»¥module.exportsè¿›è¡Œå£°æ˜ï¼Œæ¯”å¦‚ module.exports = { name: &#39;allen&#39;,} ç”¨module.exportsæ¥æ”¹åŠ¨çš„è¯ï¼Œæ˜¯æ”¹å¯¹è±¡ï¼Œæ›´æ”¹å¯¹è±¡é‡Œçš„å€¼ ç”¨exportsä»¥å¯¹è±¡æ–¹å¼æ¥æ”¹åŠ¨çš„è¯ï¼Œæ˜¯æ”¹å˜é‡ï¼Œæ›´æ”¹äº†åœ°å€ æœ€åreturnçš„æ˜¯ module.exports ï¼Œæ‰€ä»¥ç»™exportsé‡æ–°èµ‹å€¼ä¸ç®¡ç”¨ __filename å½“å‰æ¨¡å—çš„å®Œæ•´è·¯å¾„ __dirname å½“å‰æ¨¡å—æ‰€åœ¨æ–‡ä»¶å¤¹å®Œæ•´è·¯å¾„ï¼ˆæ‰€å±ç›®å½•çš„ç»å¯¹è·¯å¾„ï¼‰ æ³¨æ„ï¼šå¦‚æœaåŠ è½½äº†b ï¼ŒbåˆåŠ è½½äº†aï¼Œï¼ˆå³a require bï¼Œb require aï¼‰è¯´æ˜æ€è·¯æœ‰é—®é¢˜ æ¨¡å—æŸ¥æ‰¾è¿‡ç¨‹ ä» Y è·¯å¾„è¿è¡Œ require(X) 1. å¦‚æœ X æ˜¯å†…ç½®æ¨¡å—ï¼ˆæ¯”å¦‚ require(&#39;http&#39;ï¼‰) a. è¿”å›è¯¥æ¨¡å—ã€‚ b. ä¸å†ç»§ç»­æ‰§è¡Œã€‚ 2. å¦‚æœ X æ˜¯ä»¥ &#39;/&#39; å¼€å¤´ã€ a. è®¾ç½® Y ä¸º &#39;/&#39; 3. å¦‚æœ X æ˜¯ä»¥ &#39;./&#39; æˆ– &#39;/&#39; æˆ– &#39;../&#39; å¼€å¤´ a. ä¾æ¬¡å°è¯•åŠ è½½æ–‡ä»¶ï¼Œå¦‚æœæ‰¾åˆ°åˆ™ä¸å†æ‰§è¡Œ - (Y + X) - (Y + X).js - (Y + X).json - (Y + X).node b. ä¾æ¬¡å°è¯•åŠ è½½ç›®å½•ï¼Œå¦‚æœæ‰¾åˆ°åˆ™ä¸å†æ‰§è¡Œ - (Y + X + package.json ä¸­çš„ main å­—æ®µ).js - (Y + X + package.json ä¸­çš„ main å­—æ®µ).json - (Y + X + package.json ä¸­çš„ main å­—æ®µ).node c. æŠ›å‡º &quot;not found&quot; 4. éå† module paths æŸ¥æ‰¾ï¼Œå¦‚æœæ‰¾åˆ°åˆ™ä¸å†æ‰§è¡Œ 5. æŠ›å‡º &quot;not found&quot;æ¨¡å—åˆ†ç±»æ ¸å¿ƒæ¨¡å— ç”±nodeå¼•æ“æä¾› æ ¸å¿ƒæ¨¡å—çš„æ ‡è¯†å°±æ˜¯æ¨¡å—çš„åå­—ï¼ˆå¦‚nodeæä¾›çš„æ–‡ä»¶æ¨¡å—fsï¼‰ æ–‡ä»¶æ¨¡å— ç”±ç”¨æˆ·è‡ªå·±å®šä¹‰ ç¬¬ä¸‰æ–¹æ¨¡å—ï¼ˆå¯ä»¥é€šè¿‡npmä¸‹è½½ï¼Œå®ƒçš„æŸ¥æ‰¾æ–¹å¼æ˜¯å…ˆæ‰¾åˆ°å½“å‰ç›®å½•ä¸‹node_modules/xx/package.jsonæ–‡ä»¶ï¼ŒæŸ¥çœ‹å…¶ä¸­mainå±æ€§ï¼Œè®°å½•äº†jsæ–‡ä»¶çš„å…¥å£ï¼Œå½“mainæ²¡æœ‰æŒ‡å®šï¼Œé»˜è®¤æ‰§è¡Œnode_modules/xx/ç›®å½•ä¸‹çš„index.jsï¼‰ï¼ˆæ¨¡å—æŸ¥æ‰¾æœºåˆ¶ï¼šå¦‚æœä»¥ä¸Šä»»ä½•æ¡ä»¶ä¸æˆç«‹ï¼Œåˆ™ä¼šè¿›å…¥ä¸Šä¸€çº§ç›®å½•ä¸­çš„node_modulesï¼‰ 2.ES6çš„æ¨¡å—åŒ–ESMå¸¸è§çš„æ¨¡å—åŒ–è§„èŒƒï¼šCommonJSã€AMDã€CMDã€ES6çš„Modules ES6æ¨¡å—åŒ– ï¼š exportå¯¼å‡º import å¯¼å…¥ åœ¨ style é‡Œå¯¼å…¥ä½¿ç”¨ @import é¦–å…ˆå°†æ¨¡å—åŒ–çš„jsæ–‡ä»¶å¼•å…¥æ—¶éœ€è¦æ·»åŠ ç±»å‹ module ï¼š&lt;script src=&quot;jsåœ°å€&quot; type=&quot;module&quot;&gt;&lt;/script&gt; ç„¶åå†æ‰€éœ€æ¨¡å—å†…è¿›è¡Œå¯¼å‡º / å¯¼å…¥ï¼ˆæœ‰æ¨¡å—ä»£ç è‡ªåŠ¨è¿›å…¥ä¸¥æ ¼æ¨¡å¼ï¼‰ //æ–¹å¼1ã€2çš„å¯¼å‡ºå®é™…ä¸Šæ˜¯ä¸€è‡´çš„ // å¯¼å‡ºæ–¹å¼1 let name = 'allen'; export { name } // å¯¼å‡ºæ–¹å¼2 // å®šä¹‰çš„æ—¶å€™å¯¼å‡ºï¼Œå…ˆå£°æ˜å†å¯¼å‡ºå¿…é¡»ä½¿ç”¨æ–¹å¼1 export var num = 1000; export function sum() { } // å¯¼å‡ºæ–¹å¼3,è¿™ç§æ–¹æ³•åªèƒ½å¯¼å‡ºä¸€ä¸ª,ä½¿ç”¨ä¸€æ¬¡defaultå¯¼å‡ºä¸€ä¸ª export default adress // å¯¼å‡ºæ–¹å¼4ï¼Œä»æœ¬æ–‡ä»¶å¯¼å‡ºtypesæ–‡ä»¶ä¸‹æ‰€å¯¼å‡ºçš„æ‰€æœ‰ä¸œè¥¿çš„ä¸œè¥¿ export * from './types' å› ä¸ºå‘½åå¯¼å‡ºå’Œé»˜è®¤å¯¼å‡ºä¸ä¼šå†²çªï¼Œæ‰€æœ‰ES6æ”¯æŒä¸€ä¸ªæ¨¡å—ä¸­åŒæ—¶å®šä¹‰è¿™ä¸¤ç§å¯¼å‡º const foo = 'foo'; const bar = 'bar'; export { bar }; export default foo; å››ç§å¯¼å…¥æ–¹æ³• // 1.å¯¼å…¥å•ä¸ªnumï¼ˆå¯¹åº”å¯¼å‡ºæ–¹å¼1ã€2ã€4ï¼‰ import { num } from \"./aaa.js\"; // 2.å¯¼å…¥é»˜è®¤çš„å€¼ï¼ˆdefaultï¼‰ï¼Œèƒ½å¤Ÿè‡ªå·±å‘½åï¼ˆå¯¹åº”å¯¼å‡ºæ–¹å¼3ï¼‰ import add from \"./aaa.js\"; // 3.ç»Ÿä¸€å…¨éƒ¨å¯¼å…¥ï¼ˆå¯¹åº”å¯¼å‡ºæ–¹å¼1ã€2ã€4ï¼‰ import * as aaa from \"./aaa\"; console.log(aaa.num); //1.ä¸‹è½½åmoduleçš„å¼•ç”¨æ¯”è¾ƒç‰¹æ®Š import Vue from 'vue' //å½“ç„¶ä¹Ÿå¯ä»¥å¯¼å…¥å›¾ç‰‡ï¼ˆåœ¨webpackä¸­ä½¿ç”¨asset/resourceä¹‹åï¼‰ import imgSrc from \"../asset/3.jpg\"; const img = document.createElement(\"img\"); img.src = imgSrc; document.body.appendChild(img); è¿˜å¯ä»¥åŠ¨æ€å¯¼å…¥ï¼š const { origin: originPath, path } = await import(`./path${assetId}.json`); //... ä¸æ„å»ºç›´æ¥å¼•ç”¨NPMåŒ…å½“ ES Module æœ€å¼€å§‹ä½œä¸ºä¸€ç§æ–°çš„ JS æ¨¡å—åŒ–æ–¹æ¡ˆè¢«å¼•å…¥çš„å€™ï¼Œimport è¯­å¥ä¸­éœ€è¦æŒ‡å®šç›¸å¯¹è·¯å¾„æˆ–ç»å¯¹è·¯å¾„ã€‚ import dayjs from \"https://cdn.skypack.dev/dayjs@1.10.7\"; // ES modules console.log(dayjs(\"2022-08-12\").format(\"YYYY-MM-DD\")); è€Œæˆ‘ä»¬ç°åœ¨æ‰€ç†Ÿæ‚‰çš„ç›´æ¥å¼•ç”¨åŒ…åå®é™…ä¸Šæ˜¯é€šè¿‡æ‰“åŒ…å·¥å…·çš„æ„å»ºå®Œæˆçš„ import dayjs from \"dayjs\" è€Œæˆ‘ä»¬å¦‚ä½•ä¸éœ€è¦é€šè¿‡æ‰“åŒ…å·¥å…·çš„æ„å»ºç›´æ¥ä½¿ç”¨è¿™ç§æ–¹å¼å‘¢ï¼Ÿ æˆ‘ä»¬å¯ä»¥é€šè¿‡ HTML ä¸­çš„ &lt;script type=&quot;importmap&quot;&gt; æ ‡ç­¾æ¥æŒ‡å®šä¸€ä¸ª Import mapsï¼ˆæˆ‘ä»¬å¯ä»¥æŠŠå®ƒå½“æˆä¸€ä¸ªæ˜ å°„è¡¨ï¼‰ &lt;script type=\"importmap\"> { \"imports\": { \"dayjs\": \"https://cdn.skypack.dev/dayjs@1.10.7\", } } &lt;/script> æˆ‘ä»¬å°†å†™å¥½çš„importmapæ”¾åœ¨æ–‡æ¡£ä¸­ç¬¬ä¸€ä¸ª &lt;script type=&quot;module&quot;&gt; æ ‡ç­¾ä¹‹å‰ ç„¶åå¯ä»¥ç›´æ¥å†™ &lt;script type=\"module\"> import dayjs from 'dayjs'; console.log(dayjs) &lt;/script> å¦å¤–ï¼Œimportmap ä¸­å£°æ˜çš„åŒ…å¹¶ä¸ä¸€å®šæ„å‘³ç€å®ƒä¸€å®šä¼šè¢«æµè§ˆå™¨åŠ è½½ã€‚é¡µé¢ä¸Šçš„è„šæœ¬æ²¡æœ‰ä½¿ç”¨åˆ°çš„ä»»ä½•æ¨¡å—éƒ½ä¸ä¼šè¢«æµè§ˆå™¨åŠ è½½ï¼Œå³ä¾¿ä½ åœ¨ importmap ä¸­å£°æ˜äº†å®ƒã€‚ æˆ‘ä»¬ç”šè‡³å¯ä»¥å†™ä¸€ä¸ªæ˜ å°„è¡¨ï¼Œåœ¨é‡Œé¢çš„importmapä¸­æŒ‡å®šæˆ‘ä»¬çš„æ˜ å°„è¡¨(ä¸è¿‡æ®è¯´æ€§èƒ½æ¯”è¾ƒå·®) &lt;script type=\"importmap\" src=\"importmap.json\">&lt;/script> è¿™é¡¹æŠ€æœ¯ç›®å‰åœ¨ Chrome å’Œ Edge æµè§ˆå™¨ 89 åŠæ›´é«˜ç‰ˆæœ¬æä¾›äº†å…¨é¢æ”¯æŒï¼Œä½† Firefoxã€Safari å’Œä¸€äº›ç§»åŠ¨æµè§ˆå™¨è¿˜æ²¡æœ‰æ”¯æŒã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸‹é¢çš„ä»£ç æ¥åˆ¤æ–­æµè§ˆå™¨çš„æ”¯æŒæƒ…å†µï¼š if (HTMLScriptElement.supports &amp;&amp; HTMLScriptElement.supports('importmap')) { // import maps is supported } ES6å¼•å…¥çš„ç‰¹ç‚¹1.é¦–å…ˆä¸‹è½½ã€æŸ¥æ‰¾ + æ„å»ºå…³ç³»å›¾ ES6 æ¨¡å—ä¼šåœ¨ç¨‹åºå¼€å§‹å‰å…ˆæ ¹æ®æ¨¡å—å…³ç³»æŸ¥æ‰¾åˆ°æ‰€æœ‰æ¨¡å—ï¼Œç”Ÿæˆä¸€ä¸ªæ— ç¯å…³ç³»å›¾ï¼Œå¹¶å°†æ‰€æœ‰æ¨¡å—å®ä¾‹éƒ½åˆ›å»ºå¥½ï¼Œè¿™ç§æ–¹å¼å¤©ç„¶åœ°é¿å…äº†å¾ªç¯å¼•ç”¨çš„é—®é¢˜ï¼Œå½“ç„¶ä¹Ÿæœ‰æ¨¡å—åŠ è½½ç¼“å­˜ï¼Œé‡å¤ import åŒä¸€ä¸ªæ¨¡å—ï¼Œåªä¼šæ‰§è¡Œä¸€æ¬¡ä»£ç ã€‚ 2.å†…å­˜è…¾å‡ºç©ºé—´ï¼Œç„¶åä½¿ import å’Œ export æŒ‡å‘å†…å­˜ä¸­çš„è¿™äº›ç©ºé—´ï¼Œè¿™ä¸ªè¿‡ç¨‹ä¹Ÿå«è¿æ¥ã€‚ 3.ES6å’ŒComonJS1.ES6 æ¨¡å—ä¸­ä¸å­˜åœ¨ require, module.exports, __filename ç­‰å˜é‡ï¼ŒCommonJS ä¸­ä¹Ÿä¸èƒ½ä½¿ç”¨ importã€‚ä¸¤ç§è§„èŒƒæ˜¯ä¸å…¼å®¹çš„ï¼Œä¸€èˆ¬æ¥è¯´å¹³æ—¥é‡Œå†™çš„ ES6 æ¨¡å—ä»£ç æœ€ç»ˆéƒ½ä¼šç»ç”± Babel, Typescript ç­‰å·¥å…·å¤„ç†æˆ CommonJS ä»£ç ã€‚ ES6 æ¨¡å—å’Œ CommonJS æ¨¡å—æœ‰å¾ˆå¤§å·®å¼‚ï¼Œä¸èƒ½ç›´æ¥æ··ç€å†™ï¼ˆå®é™…ä¸Šå¥½åƒæ˜¯å¯ä»¥ï¼Œåªæ˜¯ä¼šäº§ç”Ÿå¾ˆå¤šéº»çƒ¦ï¼‰ 2.é€šè¿‡å¯¹æ¨¡å—å†…å˜é‡çš„ä¿®æ”¹ï¼ˆéå¼•ç”¨å€¼çš„ä¿®æ”¹ï¼‰ï¼ŒCommonJSå¯¼å‡ºçš„å˜é‡ä¸å˜ï¼Œä½†æ˜¯ES6ä¼šæ”¹å˜ï¼ˆå…¶å®æˆ‘ä»¬ä¹Ÿå¯ä»¥è§£é‡Šä¸ºES6 æ¨¡å—è¾“å‡ºçš„æ˜¯å€¼çš„å¼•ç”¨ï¼ŒCommonJSæ¨¡å—è¾“å‡ºçš„æ˜¯å€¼çš„æ‹·è´ï¼‰ ä½†æ˜¯ï¼å€¼å¾—æ³¨æ„çš„æ˜¯å¯¼å‡ºå¯¹æ¨¡å—è€Œè¨€æ˜¯åªè¯»çš„ï¼Œåœ¨ä½¿ç”¨ * æ‰§è¡Œæ‰¹é‡å¯¼å‡ºæ—¶ï¼Œèµ‹å€¼ç»™åˆ«åçš„å‘½åå¯¼å‡ºå°±å¥½åƒä½¿ç”¨ Object.freeze() å†»ç»“è¿‡ä¸€æ ·ï¼Œç›´æ¥ä¿®æ”¹å¯¼å‡ºçš„å€¼æ˜¯ä¸å¯èƒ½çš„ï¼Œä½†æ˜¯å¯ä»¥ä¿®æ”¹å¯¼å‡ºçš„å¯¹è±¡çš„å±æ€§ // counter.js,Commonjs let count = 1; function increment () { count++; } module.exports = { count, increment } // main.js const counter = require('counter.cjs'); counter.increment(); console.log(counter.count); // 1 // counter.mjs,es6 export let count = 1; export function increment () { count++; } // main.mjs import { increment, count } from './counter.mjs' increment(); console.log(count); // 2 3.CommonJS å¯ä»¥åœ¨è¿è¡Œæ—¶ä½¿ç”¨å˜é‡è¿›è¡Œ require 4.require ä¼šå°†å®Œæ•´çš„ exports å¯¹è±¡å¼•å…¥ï¼Œimport å¯ä»¥åª import éƒ¨åˆ†å¿…è¦çš„å†…å®¹ï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆä½¿ç”¨ Tree Shaking æ—¶å¿…é¡»ä½¿ç”¨ ES6 æ¨¡å— çš„å†™æ³•ã€‚ 5.æ¨¡å—åŠ è½½æ–¹å¼ä¸åŒ ESMå’ŒCommonjsçš„è¶‹åŠ¿å…¶å®æœ‰ä¸€ä¸ªè®¨è®ºå¸–ï¼Œå…³äºpureEsm çš„æ¦‚å¿µï¼š github å…¶å®æ˜¯ä¸»å¼ ä»…æä¾›esmäº§ç‰©çš„npmåŒ…ï¼Œæ¨åŠ¨ç¤¾åŒºçš„å‘å±•ã€‚ä½†æ˜¯å®è´¨ä¸Šéœ€è¦é¢ä¸´ä¸€ä¸ªé—®é¢˜ï¼šnodejsæ‰§è¡Œesmæ²¡é—®é¢˜ï¼Œä½†æ˜¯CommonJSä¸­æ‰§è¡ŒesmåŒ…æ˜¯ä¸è¡Œçš„ï¼Œå…¶æ ¹æœ¬åŸå› åœ¨äº require æ˜¯åŒæ­¥åŠ è½½çš„ï¼Œè€Œ ES æ¨¡å—æœ¬èº«å…·æœ‰å¼‚æ­¥åŠ è½½çš„ç‰¹æ€§ï¼Œå› æ­¤ä¸¤è€…å¤©ç„¶äº’æ–¥ï¼Œå³æˆ‘ä»¬æ— æ³• require ä¸€ä¸ª ES æ¨¡å—ã€‚ æ‰€ä»¥å¯¹äºåº•å±‚çš„åº“æœ€å¥½åŒæ—¶å¸¦commonjsæ ¼å¼å’Œesmæ ¼å¼ è€Œä¸Šå±‚çš„åº“å¯ä»¥é€æ¸å¾€pureEsmæ–¹å‘èµ° 4.UMDåŸç†å®ç°ä¸€ä¸ª UMD æ¨¡å—ï¼Œå°±è¦è€ƒè™‘ç°æœ‰çš„ä¸»æµ javascript æ¨¡å—è§„èŒƒäº†ï¼Œå¦‚ CommonJS, AMD, CMD ç­‰ã€‚é‚£ä¹ˆå¦‚ä½•æ‰èƒ½åŒæ—¶æ»¡è¶³è¿™å‡ ç§è§„èŒƒå‘¢ é¦–å…ˆè¦æƒ³åˆ°ï¼Œæ¨¡å—æœ€ç»ˆæ˜¯è¦å¯¼å‡ºä¸€ä¸ªå¯¹è±¡ï¼Œå‡½æ•°ï¼Œæˆ–è€…å˜é‡ã€‚ è€Œä¸åŒçš„æ¨¡å—è§„èŒƒï¼Œå…³äºæ¨¡å—å¯¼å‡ºè¿™éƒ¨åˆ†çš„å®šä¹‰æ˜¯å®Œå…¨ä¸ä¸€æ ·çš„ã€‚ å› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ç§è¿‡æ¸¡æœºåˆ¶ã€‚ ï¼ˆå½“ç„¶ä½ ä¹Ÿå¯ä»¥ç†è§£ä¸ºumdæ˜¯ä½œä¸ºä¸€ä¸ªé€‚é…CommonJSã€amdã€cmdçš„ä¸€ä¸ªè¿‡æ¸¡çš„è‡ªåŠ¨é€‚é…å‡½æ•°ï¼‰ #å®ç°(function(root, factory) { if (typeof exports === \"object\" &amp;&amp; typeof module === \"object\") { // CommonJSè§„èŒƒ node ç¯å¢ƒ åˆ¤æ–­æ˜¯å¦æ”¯æŒ module.exports æ”¯æŒ require è¿™ç§æ–¹æ³• module.exports = factory(require); } else if (typeof define === \"function\" &amp;&amp; define.md) { // AMD å¦‚æœç¯å¢ƒä¸­æœ‰defineå‡½æ•°ï¼Œå¹¶ä¸”defineå‡½æ•°å…·å¤‡amdå±æ€§ï¼Œåˆ™å¯ä»¥åˆ¤æ–­å½“å‰ç¯å¢ƒæ»¡è¶³AMDè§„èŒƒ console.log(\"æ˜¯AMDæ¨¡å—è§„èŒƒï¼Œå¦‚require.js\"); define(factory()); } else if (typeof exports === \"object\") { // ä¸æ”¯æŒ module ä½†æ˜¯æ”¯æŒ exports çš„æƒ…å†µä¸‹ä½¿ç”¨ exportså¯¼å‡º æ˜¯CommonJS è§„èŒƒ exports[\"jiang-hooks\"] = factory(); } else { // ç›´æ¥æŒ‚è½½åœ¨å…¨å±€å¯¹è±¡ä¸Š root.umdModule = factory(); } })(this, function() { return { name: \"Umdæ¨¡å—\", }; }); å‚è€ƒé“¾æ¥ https://juejin.cn/post/6844904080955932680#heading-3 https://mp.weixin.qq.com/s/jyWJX_g-txIm0LIxPAuTDw","categories":[{"name":"å‰ç«¯","slug":"å‰ç«¯","permalink":"https://taylor12138.github.io/categories/%E5%89%8D%E7%AB%AF/"}],"tags":[],"author":"Hello"},{"title":"React(ä¸Š)","slug":"React(ä¸Š)","date":"2022-05-03T07:31:07.769Z","updated":"2023-04-17T09:30:32.783Z","comments":true,"path":"2022/05/03/react-shang/","link":"","permalink":"https://taylor12138.github.io/2022/05/03/react-shang/","excerpt":"","text":"1.Reactç®€ä»‹reactç”±Facebookå¼€å‘ &amp; å¼€æºçš„ä¸€ä¸ªç”¨äºæ„å»ºç”¨æˆ·ç•Œé¢ã€å°†æ•°æ®æ¸²æŸ“ä¸ºhtmlè§†å›¾çš„å¼€æºJavaScriptåº“ reactç›¸å¯¹äºåŸç”Ÿjsçš„ä¼˜ç‚¹ï¼š é‡‡ç”¨ç»„ä»¶åŒ–æ¨¡å¼ï¼Œå£°æ˜å¼ç¼–ç ï¼Œæé«˜ç»„ä»¶å¤ç”¨ç‡ React Nativeä¸­å¯ä»¥ä½¿ç”¨React è¯­æ³•è¿›è¡Œç§»åŠ¨ç«¯å¼€å‘ ä½¿ç”¨äº†è™šæ‹ŸDOMå’Œdiffç®—æ³•ï¼Œå‡å°‘å’ŒçœŸå®DOMçš„äº¤äº’ ä¸‹è½½reactçš„æ–‡ä»¶ï¼ˆå½“å‰é˜è¿°çš„æ˜¯16.8ç‰ˆæœ¬ï¼‰ babel.jsä¸ä»…é€‚ç”¨äºes6 -&gt; es5 è¯­æ³•çš„è½¬æ¢ï¼Œè¿˜é€‚ç”¨äº jsx -&gt; js çš„è½¬æ¢ react.development.js ä¸ºreactçš„æ ¸å¿ƒåº“ react-dom-developmentä¸ºreactçš„æ‹“å±•åº“ï¼Œå¯ç”¨äºæ“ä½œdomç­‰ å¼•å…¥é¡ºåº &lt;div id=\"container\">&lt;/div> &lt;script src=\"./js/react.development.js\">&lt;/script> &lt;script src=\"./js/react-dom.development.js\">&lt;/script> &lt;script src=\"./js/babel.min.js\">&lt;/script> &lt;!-- å‘Šè¯‰æµè§ˆå™¨ä½ å†™ä¸æ˜¯é»˜è®¤çš„jsï¼Œè€Œæ˜¯jsx --> &lt;script type=\"text/babel\"> // åˆ›å»ºè™šæ‹Ÿdom const VDOM = &lt;h1>hello react!&lt;/h1> // æ¸²æŸ“åˆ°é¡µé¢ ReactDOM.render(VDOM, document.querySelector('#container')) &lt;/script> JSXçš„ä½¿ç”¨ç›´æ¥ä½¿ç”¨åŸç”Ÿjsä¹Ÿèƒ½åˆ›å»ºè™šæ‹Ÿdom // document.createElementä¸ºåˆ›å»ºçœŸå®domï¼Œä»¥ä¸‹æ˜¯åˆ›å»ºè™šæ‹Ÿdom // ä¸ä½¿ç”¨jsxåˆ›å»ºè™šæ‹Ÿdomï¼ŒReact.createElement(æ ‡ç­¾å, æ ‡ç­¾å±æ€§, æ ‡ç­¾å†…å®¹) const VDOM = React.createElement('h1', { id: 'title', className: 'title' }, 'hello, world'); // æ¸²æŸ“åˆ°é¡µé¢ ReactDOM.render(VDOM, document.querySelector('#container')) ä½¿ç”¨jsxçš„åŸå› æ˜¯jsxå¯¹äºå¤šé‡åµŒå¥—çš„æ ‡ç­¾æ¯”è¾ƒå®¹æ˜“æ’°å†™ï¼Œè€ŒåŸç”Ÿjsæ¯”è¾ƒéš¾é¡¶ const VDOM = React.createElement('h1', { id: 'title' }, React.createElement('h2', {}, 'hahaha')); ç„¶è€Œä½¿ç”¨jsx const VDOM = ( &lt;h1 id=\"title\"> &lt;span>hello, react&lt;/span> &lt;/h1> ) ç»¼ä¸Šï¼Œè¿˜æ˜¯ä¹–ä¹–ä½¿ç”¨jsxæ¯”è¾ƒåƒé¦™ JSXè¯­æ³•1.å®šä¹‰è™šæ‹ŸDOMæ—¶ï¼Œä¸è¦å†™å¼•å· 2.åœ¨å¤§æ‹¬å·ä¸­å¯ä»¥å¡«å…¥jsçš„è¡¨è¾¾å¼ï¼Œä½†ä¸ä»£è¡¨æ‰€æœ‰jsè¯­å¥ã€jsä»£ç  è¡¨è¾¾å¼ï¼šä¸€ä¸ªè¡¨è¾¾å¼ä¼šäº§ç”Ÿä¸€ä¸ªå€¼ï¼Œå¯ä»¥æ”¾åœ¨ä»»æ„ä¸€ä¸ªéœ€è¦å€¼çš„åœ°æ–¹ï¼Œç®€å•æ¥è¯´ï¼Œå°±æ˜¯èƒ½ç”¨å˜é‡ const x = è¡¨è¾¾å¼æ¥æ”¶çš„ï¼Œå‡ä¸ºè¡¨è¾¾å¼ ä¸å¯ä»¥å¡«å…¥ifã€forç­‰jsè¯­å¥ï¼ˆä½†æ˜¯æˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ•°ç»„çš„mapã€ä¸‰å…ƒè¡¨è¾¾å¼ç­‰è¯­æ³•æ¥å¡«è¡¥ï¼‰ 3.æ ·å¼æŒ‡å®šç±»åæ—¶ä¸è¦ç”¨classï¼Œè€Œæ˜¯ä½¿ç”¨className 4.å†…è”è¡¨è¾¾å¼æ—¶ï¼Œstyleè¦æ³¨æ„é”®å€¼çš„å½¢å¼å»å†™ï¼Œè¿™é‡Œä½¿ç”¨åŒæ‹¬å·å¹¶ä¸æ˜¯ç±»ä¼¼äºvueçš„å…«å­—èƒ¡è¯­æ³•ï¼Œè€Œæ˜¯ä¸€ä¸ªå¤§æ‹¬å·å¡«å…¥jsè¡¨è¾¾å¼ï¼Œä¸€ä¸ªå¤§æ‹¬å·è¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ªå¯¹è±¡ const inner = 'hello, react' const VDOM = ( &lt;h1 className=\"title\"> &lt;span style={{ color: 'white', backgroundColor: 'red' }}>{inner}&lt;/span> &lt;/h1> ) // æ¸²æŸ“åˆ°é¡µé¢ ReactDOM.render(VDOM, document.querySelector('#container')) 5.åªèƒ½æœ‰ä¸€ä¸ªæ ¹æ ‡ç­¾ï¼Œæœ‰ç‚¹ç±»ä¼¼vueçš„templateæ¨¡æ¿ 6.æ ‡ç­¾å¿…é¡»é—­åˆï¼Œå³ä½¿é‡åˆ°åƒinputè¿™ç§å®è´¨ä¸Šå†htmlä¸­å•æ ‡ç­¾å°±å¯ä»¥çš„ï¼Œä¹Ÿå¿…é¡»è¿›è¡ŒåŒæ ‡ç­¾é—­åˆ const VDOM = ( &lt;div> &lt;input type=\"text\" /> &lt;/div> ) 7.æ ‡ç­¾é¦–å­—æ¯è‹¥æ˜¯å°å†™ï¼Œåˆ™è½¬æ¢ä¸ºhtmlåŒåæ ‡ç­¾å…ƒç´ ï¼Œè‹¥htmlæ— è¯¥æ ‡ç­¾å¯¹åº”çš„ï¼Œåˆ™æŠ¥é”™åŒåå…ƒç´ ï¼›è‹¥å¤§å†™å­—æ¯å¼€å¤´ï¼Œreactåˆ™å–æ¸²æŸ“å¯¹åº”çš„ç»„ä»¶ï¼Œè‹¥æ²¡å®šä¹‰è¯¥ç»„ä»¶ï¼Œåˆ™æŠ¥é”™ï¼ˆè¿™é‡Œå’Œvueä¸åŒï¼Œvueä¹Ÿæ˜¯ç›´æ¥å°å†™ï¼Œé‡åˆ°é©¼å³°åˆ™ç”¨ - è¿æ¥ï¼‰ 8.jsxå†™æ³¨é‡Šçš„æ—¶å€™ï¼Œè¦ {/*&lt;input type=&quot;text&quot; /&gt;*/}è¿™æ ·å†™ 2.Reactçš„ç»„ä»¶åŒ–å‡½æ•°å¼ç»„ä»¶å³ç”¨å‡½æ•°å®šä¹‰çš„ç»„ä»¶ å®ƒé€‚ç”¨äºç®€å•çš„ç»„ä»¶å®šä¹‰ &lt;div id=\"container\">&lt;/div> &lt;script src=\"./js/react.development.js\">&lt;/script> &lt;script src=\"./js/react-dom.development.js\">&lt;/script> &lt;script src=\"./js/babel.min.js\">&lt;/script> &lt;!-- å‘Šè¯‰æµè§ˆå™¨ä½ å†™ä¸æ˜¯é»˜è®¤çš„jsï¼Œè€Œæ˜¯jsx --> &lt;script type=\"text/babel\"> function MyComponent() { return &lt;h2>å‡½æ•°å®šä¹‰çš„ç»„ä»¶&lt;/h2> } // è®°ä½jsxé‡Œæ ‡ç­¾å¿…é¡»é—­åˆ ReactDOM.render(&lt;MyComponent />, document.querySelector('#container')); &lt;/script> è€Œæ­¤æ—¶åœ¨å‡½æ•°å†…éƒ¨æ‰“å°thisï¼Œå¾—åˆ°çš„ç»“æœä¸ºundefined function MyComponent() { console.log(this) //undefined return &lt;h2>å‡½æ•°å®šä¹‰çš„ç»„ä»¶&lt;/h2> } é‚£æ˜¯å› ä¸ºbabelç¼–è¯‘åå¼€å¯äº†ä¸¥æ ¼æ¨¡å¼ï¼Œä½¿å¾—æŒ‡å‘windowéƒ½æ”¹æˆæŒ‡å‘undefined æ­¤æ—¶å†…éƒ¨ï¼š Reactè§£æç»„ä»¶æ ‡ç­¾ -&gt; æ‰¾åˆ°ç»„ä»¶ -&gt; è°ƒç”¨å‡½æ•° -&gt; è™šæ‹ŸDOMè½¬ä¸ºçœŸå®DOMï¼Œéšåå‘ˆç°åœ¨é¡µé¢ä¸­ ç±»å¼ç»„ä»¶ç”¨ç±»å®šä¹‰çš„ç»„ä»¶ å®ƒé€‚ç”¨äºå¤æ‚çš„ç»„ä»¶å®šä¹‰ class MyComponent extends React.Component { render() { return &lt;h2>hello React&lt;/h2> } } //è¿™é‡Œçš„çš„renderå’Œä¸Šæ–¹ç±»å®šä¹‰çš„renderæ²¡æœ‰å…³ç³»ï¼Œåªæ˜¯åŒåç½¢äº† ReactDOM.render(&lt;MyComponent />, document.querySelector('#container')) åˆ›å»ºç±»å¼ç»„ä»¶å¿…é¡»1.ç»§æ‰¿reactå®šä¹‰çš„å†…ç½®ç±»2.å¿…é¡»å†™render3.renderå¿…é¡»æœ‰è¿”å›å€¼ è€Œæ­¤æ—¶åœ¨renderæ‰“å°thisï¼Œå¾—åˆ°çš„ç»“æœä¸ºMyComponentå®ä¾‹å¯¹è±¡ï¼ˆReactå†…éƒ¨å¸®ä½ newäº†ä¸€ä¸ªï¼‰ class MyComponent extends React.Component { render() { console.log(this) return &lt;h2>hello React&lt;/h2> } } æ­¤æ—¶å†…éƒ¨ï¼š Reactè§£æç»„ä»¶æ ‡ç­¾ -&gt; æ‰¾åˆ°ç»„ä»¶ -&gt; newå‡ºå®ä¾‹ï¼Œè°ƒç”¨åŸå‹ä¸Šrenderæ–¹æ³• -&gt; å°†renderè¿”å›çš„è™šæ‹ŸDOMè½¬ä¸ºçœŸå®DOMï¼Œéšåå‘ˆç°åœ¨é¡µé¢ä¸­ çœ‹åˆ°å…¶ä»–æ–‡ç« ä¸­çš„ç»„ä»¶å¯¹è±¡ï¼Œå…¶å®åŸºæœ¬ä¸Šå¯ä»¥é»˜è®¤ä»–ä»¬æ˜¯ç”¨ç±»å¼ç»„ä»¶å®šä¹‰çš„ã€‚ ï¼ˆ1ï¼‰ç»„ä»¶ä¸‰å¤§æ ¸å¿ƒå±æ€§ä¹‹stateå®é™…ä¸Šéš¶å±äºç±»å¼ç»„ä»¶ï¼Œæ¯•ç«Ÿæœ‰å®ä¾‹å¯¹è±¡ï¼Œæ‰æœ‰å¯¹åº”çš„å±æ€§ stateï¼ˆçŠ¶æ€ï¼‰ æœ‰ç‚¹åƒvueçš„data / vuexçš„stateï¼Œå­˜å‚¨æ•°æ®ï¼Œåœ¨ç»„ä»¶åŒ–çš„ä½¿ç”¨è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬æ—¶å¸¸æŠŠæ•°æ®å­˜å‚¨åœ¨ç»„ä»¶ä»¬å…±åŒçš„çˆ¶ç»„ä»¶çš„stateé‡Œï¼ˆå®˜æ–¹ç§°ä¹‹ä¸ºçŠ¶æ€æå‡ï¼‰ class MyComponent extends React.Component { constructor(props) { super(props); this.state = { isHot: true } } render() { return &lt;h2>today is {this.state.isHot ? 'hot' : 'cold'}&lt;/h2> } } ä¸è¿‡ä¸€èˆ¬éƒ½æ˜¯è¿™æ ·å†™çš„ class MyComponent extends React.Component { state = { isHot: true } //... } setState (çŠ¶æ€æ›´æ–°) ç„¶è€Œåœ¨Reactä¸­ï¼Œä¿®æ”¹å®ŒçŠ¶æ€ï¼Œä¸èƒ½å’ŒVueä¸€æ ·ç›´æ¥åšåˆ°å“åº”å¼ï¼Œéœ€è¦æˆ‘ä»¬å»ä½¿ç”¨setStateï¼ï¼ä»è€Œæ”¹åŠ¨é¡µé¢ä¸Šå‘ˆç°çš„æ•°æ®æ•ˆæœ è¿™é‡Œçš„setStateæ˜¯ä¸€ä¸ªåˆå¹¶çš„åŠ¨ä½œï¼Œå¦‚æœå…¶ä»–stateå±æ€§æ²¡æœ‰å‘ç”Ÿæ”¹å˜ï¼Œå¹¶ä¸ä¼šå‘ç”Ÿä¸¢å¤± setStateè¦æ±‚ä¼ å…¥ä¸€ä¸ªå¯¹è±¡ class MyComponent extends React.Component { constructor(props) { super(props); this.state = { isHot: true } this.changeWeathter = this.changeWeathter.bind(this); } render() { return &lt;h2 onClick={this.changeWeathter}>today is {this.state.isHot ? 'hot' : 'cold'}&lt;/h2> } changeWeathter() { const isHot = !this.state.isHot; //å®é™…ä¸Šä¹Ÿæ˜¯å› ä¸ºsetStateè¿™ä¸ªæ–¹æ³•ï¼Œæ‰èƒ½è®©stateç§°ä¸ºæ ¸å¿ƒå±æ€§ä¹‹ä¸€ï¼Œæ³ªç›®ã€‚ã€‚ this.setState({ isHot: isHot }) } } ReactDOM.render(&lt;MyComponent />, document.querySelector('#container')) ä»è¿™é‡Œæˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼Œæ¯æ¬¡setStateï¼Œrenderéƒ½ä¼šè°ƒç”¨ä¸€æ¬¡å¯¹é¡µé¢è¿›è¡Œæ¸²æŸ“ï¼ˆæœ‰ç‚¹æ§åˆ¶é¡µé¢å›æµé‡ç»˜çš„æ„Ÿè§‰ï¼Œæ‰€ä»¥ç»å¯¹ä¸èƒ½å†renderé‡Œè¿›è¡ŒsetStateï¼‰ï¼Œæ€»å…±è°ƒç”¨ 1 + næ¬¡ï¼Œè€Œconstrutoråªä¼šåœ¨åˆå§‹åŒ–çš„æ—¶å€™è°ƒç”¨ä¸€æ¬¡ ï¼ˆ2ï¼‰ç»„ä»¶ä¸‰å¤§æ ¸å¿ƒå±æ€§ä¹‹propsç±»å¼ç»„ä»¶propspropsç”¨äºç»„ä»¶é—´æ•°æ®ä¼ é€’ çˆ¶ä¼ å­ï¼Œå’Œvueçš„propsç±»ä¼¼ï¼Œéƒ½æ˜¯åœ¨ç»„ä»¶æ ‡ç­¾ä¸Šèµ‹å€¼ä¼ é€’ï¼›çˆ¶ç»„ä»¶ä¼ å…¥çš„propså¦‚æœæ˜¯stateï¼Œå‘ç”Ÿäº†setStateï¼Œé‡æ–°render()ä¸€æ¬¡ï¼Œä¼ å…¥çš„propsä¹Ÿä¼šéšä¹‹æ›´æ–° æ³¨æ„ï¼špropså±æ€§æ˜¯åªè¯»çš„ï¼Œä¸å¯ä»¥ä¿®æ”¹ class MyComponent extends React.Component { render() { return ( &lt;ul> &lt;li>æ€§åï¼š{this.props.name}&lt;/li> &lt;li>æ€§åˆ«ï¼š{this.props.sex}&lt;/li> &lt;li>å¹´é¾„ï¼š{this.props.age}&lt;/li> &lt;/ul> ) } } //age={18}æ‰èƒ½ä¼ å…¥numberç±»å‹ ReactDOM.render(&lt;MyComponent name=\"Allen\" age={18} sex=\"ç”·\" />, document.querySelector('#container')); åœ¨jsè¯­æ³•ä¸­ï¼Œä½¿ç”¨ let person1 = {...person2}å±•å¼€å¯¹è±¡ä¸­çš„å±æ€§ ä½†æ˜¯é€šè¿‡Reactå†…ç½® + babelè¯­æ³•åŠ æˆï¼Œå¯ä»¥ç›´æ¥ ...person2è¿›è¡Œå±•å¼€ï¼Œä½†æ˜¯ä»…ä»…é€‚ç”¨äºæ ‡ç­¾å±æ€§çš„ä¼ é€’ï¼Œä¹Ÿå°±æ˜¯é€šè¿‡propsä¼ é€’ è™½ç„¶ä½ å¯ä»¥åœ¨è¿™é‡Œçœ‹åˆ°ä¸€ä¸ªå¤§æ‹¬å·ï¼Œä½†æ˜¯è¿™åªæ˜¯è¡¨æ˜è¦åœ¨jsxä¸­æ’å…¥jsè¡¨è¾¾å¼çš„å«ä¹‰ const p = {name=\"Allen\",age=\"18\",sex=\"ç”·\"} ReactDOM.render(&lt;MyComponent {...p} />, document.querySelector('#container')); æ¥ç€å­ç»„ä»¶é€šè¿‡ this.props.xxè¿›è¡Œä½¿ç”¨ PropTypeså½“éœ€è¦å¯¹ä¼ å…¥çš„propsè¿›è¡Œæ•°æ®ç±»å‹ã€æ•°æ®é»˜è®¤å€¼ç­‰è¿›è¡Œé™åˆ¶æ—¶ï¼Œéœ€è¦å¼•å…¥å¦ä¸€ä¸ªåŒ… ï¼ˆåƒ Flow å’Œ TypeScript ç­‰è¿™äº›é™æ€ç±»å‹æ£€æŸ¥å™¨ï¼Œå¯ä»¥åœ¨è¿è¡Œå‰è¯†åˆ«æŸäº›ç±»å‹çš„é—®é¢˜ã€‚ä»–ä»¬è¿˜å¯ä»¥é€šè¿‡å¢åŠ è‡ªåŠ¨è¡¥å…¨ç­‰åŠŸèƒ½æ¥æ”¹å–„å¼€å‘è€…çš„å·¥ä½œæµç¨‹ã€‚å‡ºäºè¿™ä¸ªåŸå› ï¼Œæˆ‘ä»¬å»ºè®®åœ¨å¤§å‹ä»£ç åº“ä¸­ä½¿ç”¨ Flow æˆ– TypeScript æ¥ä»£æ›¿ PropTypesã€‚ï¼‰ ï¼ˆå¯¹äºVueï¼Œå¯ä»¥ç›´æ¥è®©å­ç»„ä»¶åœ¨propså±æ€§é‡Œå®šä¹‰propsä¼ å…¥çš„æ•°æ®æ ¼å¼å³å¯ï¼‰ &lt;!-- å¼•å…¥prop-typesåŒ… --> &lt;script src=\"./js/prop-types.js\">&lt;/script> å¦‚æœæ˜¯æ­å»ºè„šæ‰‹æ¶ï¼ŒReacté»˜è®¤æ²¡æœ‰å¸®ä½ ä¸‹è½½è¿™ä¸ªé™åˆ¶åŒ…ï¼Œéœ€è¦è‡ªå·±ä¸‹è½½ npm i prop-types import PropType from 'prop-types' // å¯¹æ ‡ç­¾å±æ€§è¿›è¡Œç±»å‹ã€å¿…è¦æ€§(required)çš„é™åˆ¶ // è®°ä½ä¸Šé¢çš„æ—¶å°å†™propsï¼Œä¸‹é¢çš„æ˜¯å¤§å†™Props MyComponent.propTypes = { name: PropTypes.string.isRequired, //é™åˆ¶nameé¡ºåºæ€§å¿…é¡»ä¼ å…¥ï¼Œä¸”ä¸ºstring age: PropTypes.number, //é™åˆ¶ageä¸ºnumber } // é»˜è®¤æ ‡ç­¾å±æ€§å€¼ MyComponent.defaultProps = { sex: 'ç”·', //ä¸ä¼ å…¥æ—¶ï¼Œsexé»˜è®¤å€¼ä¸º'ç”·' age: 18 //ä¸ä¼ å…¥æ—¶ï¼Œageé»˜è®¤å€¼ä¸º18 } ReactDOM.render(&lt;MyComponent name=\"Allen\" age={18} sex=\"ç”·\" />, document.querySelector('#container')); å¦‚æœä¼ å…¥çš„æ˜¯å‡½æ•° MyComponent.propTypes = { speak: PropTypes.func //é™åˆ¶speakä¸ºå‡½æ•° } ReactDOM.render(&lt;MyComponent name=\"Allen\" age={18} sex=\"ç”·\" speak={fn}/>, document.querySelector('#container')); function fn(){} ä¸è¿‡åœ¨æœ€å¥½è¿˜æ˜¯éƒ½å†™åœ¨Reactç±»çš„å†…éƒ¨ï¼Œä½†æ˜¯è¦æ·»åŠ åˆ°ç±»ä¸Šï¼Œè€Œä¸æ˜¯ç±»çš„å®ä¾‹çš„è¯ï¼Œä¸èƒ½ç›´æ¥å†™è¡¨è¾¾å¼ï¼Œè¦æ·»åŠ ä¸€ä¸ªstatic class MyComponent extends React.Component { static propTypes = { name: PropTypes.string.isRequired, age: PropTypes.number, speak: PropTypes.func } // é»˜è®¤æ ‡ç­¾å±æ€§å€¼ static defaultProps = { sex: 'ç”·', age: 18 } render() { //... } } propTypesç±»å‹ä¸€è§ˆ import PropTypes from 'prop-types'; MyComponent.propTypes = { optionalArray: PropTypes.array, optionalBool: PropTypes.bool, optionalFunc: PropTypes.func, optionalNumber: PropTypes.number, optionalObject: PropTypes.object, optionalString: PropTypes.string, optionalSymbol: PropTypes.symbol, // ä»»ä½•å¯è¢«æ¸²æŸ“çš„å…ƒç´ ï¼ˆåŒ…æ‹¬æ•°å­—ã€å­—ç¬¦ä¸²ã€å…ƒç´ æˆ–æ•°ç»„ï¼‰ // (æˆ– Fragment) ä¹ŸåŒ…å«è¿™äº›ç±»å‹ã€‚ optionalNode: PropTypes.node, // å¯ä»¥æŒ‡å®šä¸€ä¸ªå¯¹è±¡ç”±æŸä¸€ç±»å‹çš„å€¼ç»„æˆ optionalObjectOf: PropTypes.objectOf(PropTypes.number), // ä»»æ„ç±»å‹çš„å¿…éœ€æ•°æ® requiredAny: PropTypes.any.isRequired, } å‡½æ•°å¼ç»„ä»¶çš„propsä¸Šé¢è¯´é“å±æ€§éƒ½æ˜¯éš¶å±äºç±»å¼ç»„ä»¶ï¼Œæ¯•ç«Ÿæœ‰å®ä¾‹å¯¹è±¡æ‰æœ‰å±æ€§ï¼Œä½†æ˜¯propsæ¯”è¾ƒç‰¹æ®Šï¼Œå‡½æ•°ç»„ä»¶ä¹Ÿå¯ä»¥æœ‰ï¼Œå› ä¸ºå‡½æ•°ç»„ä»¶å¯ä»¥ä¼ å‚ï¼Œå³åœ¨ä¼ å‚éƒ¨åˆ†ä½¿ç”¨propsè¿›è¡Œæ¥æ”¶ã€‚ ï¼ˆå®é™…ä¸Šé™¤éä½¿ç”¨æœ€æ–°ç‰ˆæœ¬çš„hooksï¼Œä¸ç„¶å‡½æ•°å¼ç»„ä»¶ä¸èƒ½ä½¿ç”¨åˆ°state å’Œ refsï¼‰ function MyComponent(props) { const { name, sex, age } = props; return ( &lt;ul> &lt;li>æ€§åï¼š{name}&lt;/li> &lt;li>æ€§åˆ«ï¼š{sex}&lt;/li> &lt;li>å¹´é¾„ï¼š{age}&lt;/li> &lt;/ul> ) MyComponent.propTypes = { name: PropTypes.string.isRequired, age: PropTypes.number, speak: PropTypes.func } // é»˜è®¤æ ‡ç­¾å±æ€§å€¼ MyComponent.defaultProps = { sex: 'ç”·', age: 18 } } ReactDOM.render(&lt;MyComponent name=\"Allen\" />, document.querySelector('#container')); ï¼ˆ3ï¼‰ç»„ä»¶ä¸‰å¤§æ ¸å¿ƒå±æ€§ä¹‹refså®˜ç½‘æç¤ºï¼šè¯·å‹¿è¿‡åº¦ä½¿ç”¨refsï¼Œå¯ä»¥é€šè¿‡äº‹ä»¶å¯¹è±¡eventè§£å†³ï¼ˆå‘ç”Ÿäº‹ä»¶å…ƒç´  = æ“ä½œçš„å…ƒç´ ï¼‰ï¼Œåˆ™ç”¨eventè§£å†³ è€ç‰ˆå­—ç¬¦ä¸²refåŒæ ·çš„ï¼Œrefsä¹Ÿç±»ä¼¼äºvueçš„refsï¼ˆåªä¸è¿‡vueå±æ€§éƒ½ä¼šåŠ ä¸Š $ï¼‰ï¼Œé€‚ç”¨äºçˆ¶ç»„ä»¶æ“ä½œå­ç»„ä»¶æ—¶å¯¹å­ç»„ä»¶çš„è·å–ï¼Œä¹Ÿç”¨äºçˆ¶ç»„ä»¶è·å–å­ç»„ä»¶æ•°æ® class Demo extends React.Component { showData = () => { alert(this.refs.input1.value); } showData2 = () => { alert(this.refs.input2.value); } render() { return ( &lt;div> &lt;input ref=\"input1\" type=\"text\" placeholder=\"ç‚¹å‡»æŒ‰é’®æç¤ºæ•°æ®\" /> &lt;button onClick={this.showData}>click me&lt;/button> &lt;input onBlur={this.showData2} ref=\"input2\" type=\"text\" placeholder=\"å¤±å»ç„¦ç‚¹æç¤ºæ•°æ®\" /> &lt;/div> ) } } ReactDOM.render(&lt;Demo />, document.querySelector('#container')); ä»¥ä¸Šæˆ‘ä½¿ç”¨çš„æ˜¯å­—ç¬¦ä¸²ç±»å‹çš„refï¼ˆåŒVueï¼‰ï¼Œä½†å®ƒç›®å‰å·²ç»ä¸è¢«å®˜æ–¹æ‰€æ¨èä½¿ç”¨äº†ï¼Œç”šè‡³æœ‰å¯èƒ½åºŸå¼ƒæ‰ï¼Œä»¥ä¸‹æ˜¯å®˜ç½‘è§£é‡Šï¼ˆå¯èƒ½å¸¦æ•ˆç‡é—®é¢˜ï¼‰ã€‚ è¿‡æ—¶ APIï¼šString ç±»å‹çš„ Refs å¦‚æœä½ ä¹‹å‰ä½¿ç”¨è¿‡ Reactï¼Œä½ å¯èƒ½äº†è§£è¿‡ä¹‹å‰çš„ API ä¸­çš„ string ç±»å‹çš„ ref å±æ€§ï¼Œä¾‹å¦‚ &quot;textInput&quot;ã€‚ä½ å¯ä»¥é€šè¿‡ this.refs.textInput æ¥è®¿é—® DOM èŠ‚ç‚¹ã€‚æˆ‘ä»¬ä¸å»ºè®®ä½¿ç”¨å®ƒï¼Œå› ä¸º string ç±»å‹çš„ refs å­˜åœ¨ ä¸€äº›é—®é¢˜ã€‚å®ƒå·²è¿‡æ—¶å¹¶å¯èƒ½ä¼šåœ¨æœªæ¥çš„ç‰ˆæœ¬è¢«ç§»é™¤ã€‚ å›è°ƒå¼refså®ƒçš„å›è°ƒå‡½æ•°æ¥å— React ç»„ä»¶å®ä¾‹æˆ– HTML DOM å…ƒç´ ä½œä¸ºå‚æ•° ä»¥ ref = () =&gt; {}å½¢å¼è¿›è¡Œä¼ é€’ ä»¥ä¸‹ä»£ç æ˜¯å¯¹ä¸Šæ–¹å­—ç¬¦ä¸²å½¢å¼refçš„æ”¹è¿› class Demo extends React.Component { showData = () => { alert(this.input1.value); } showData2 = () => { alert(this.input2.value); } render() { return ( &lt;div> &lt;input ref={currentNode => { this.input1 = currentNode }} type=\"text\" placeholder=\"ç‚¹å‡»æŒ‰é’®æç¤ºæ•°æ®\" /> &lt;button onClick={this.showData}>click me&lt;/button> &lt;input onBlur={this.showData2} ref={currentNode => { this.input2 = currentNode }} type=\"text\" placeholder=\"å¤±å»ç„¦ç‚¹æç¤ºæ•°æ®\" /> &lt;/div> ) } } ReactDOM.render(&lt;Demo />, document.querySelector('#container')); å®˜ç½‘è¿˜æœ‰ä¸ªæç¤ºï¼šå…³äºå›è°ƒ refs çš„è¯´æ˜ å¦‚æœ ref å›è°ƒå‡½æ•°æ˜¯ä»¥å†…è”å‡½æ•°çš„æ–¹å¼å®šä¹‰ï¼ˆä¹Ÿå°±æ˜¯æŠŠå‡½æ•°ç›´æ¥å®šä¹‰åœ¨æ ‡ç­¾å†…ï¼‰çš„ï¼Œåœ¨æ›´æ–°è¿‡ç¨‹ï¼ˆrenderè°ƒç”¨ç¬¬äºŒã€ä¸‰æ¬¡çš„æ—¶å€™ï¼Œæ¯æ¬¡setStateï¼Œrenderä¹Ÿéƒ½ä¼šè¢«è°ƒç”¨ä¸€æ¬¡ï¼‰ä¸­å®ƒä¼šè¢«æ‰§è¡Œä¸¤æ¬¡ï¼Œç¬¬ä¸€æ¬¡ä¼ å…¥å‚æ•° nullï¼Œç„¶åç¬¬äºŒæ¬¡ä¼šä¼ å…¥å‚æ•° DOM å…ƒç´ ã€‚è¿™æ˜¯å› ä¸ºåœ¨æ¯æ¬¡æ¸²æŸ“æ—¶ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„å‡½æ•°å®ä¾‹ï¼Œæ‰€ä»¥ React æ¸…ç©ºæ—§çš„ ref å¹¶ä¸”è®¾ç½®æ–°çš„ã€‚é€šè¿‡å°† ref çš„å›è°ƒå‡½æ•°å®šä¹‰æˆ class çš„ç»‘å®šå‡½æ•°çš„æ–¹å¼å¯ä»¥é¿å…ä¸Šè¿°é—®é¢˜ï¼Œä½†æ˜¯å¤§å¤šæ•°æƒ…å†µä¸‹å®ƒæ˜¯æ— å…³ç´§è¦çš„ã€‚ é¿å…æ–¹å¼ä¹Ÿå°±æ˜¯åœ¨ç±»ç»„ä»¶é‡Œå†™ä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œè€Œä¸æ˜¯ä»¥å†…è”çš„å½¢å¼ï¼ˆä½†æ˜¯æˆ‘è§‰å¾—ä¸ºäº†å®šä¹‰ä¸€ä¸ªidï¼Œå†™ä¸€ä¸ªå‡½æ•°ï¼Œå¤ªéº»çƒ¦äº†å§0.0ï¼‰ createRefç›®å‰Reactæœ€æ–°ç‰ˆæœ¬çš„refä½¿ç”¨æ–¹æ³•å°±æ˜¯ç”¨ React.createRefæ–¹å¼ React.createRefè°ƒç”¨åä¼šåˆ›å»ºä¸€ä¸ªå®¹å™¨ï¼Œè¯¥å®¹å™¨å¯ä»¥å­˜å‚¨è¢«refæ‰€æ ‡è¯†çš„èŠ‚ç‚¹ï¼ˆä¿å­˜åœ¨currentå±æ€§é‡Œï¼‰ å¦‚æœä½ æƒ³è·å–å¤šä¸ªèŠ‚ç‚¹ï¼Œå°±è¦åˆ›å»ºå¤šä¸ªReact.createRef()ï¼Œå› ä¸ºå®ƒæ˜¯ä¸“æœ‰çš„ class Demo extends React.Component { //ä½†æ˜¯æ³¨æ„ï¼Œè¯¥å®¹å™¨æ˜¯ä¸“äººä¸“ç”¨çš„ï¼å¦‚æœå†æ¬¡åœ¨è¿™ä¸ªå®¹å™¨å­˜å‚¨çš„è¯ï¼Œä¼šè¦†ç›–æ‰åŸæ¥ç”¨refæ ‡è¯†çš„èŠ‚ç‚¹ //æ‰€ä»¥ä¸€ä¸ªå®¹å™¨å­˜ä¸€ä¸ªèŠ‚ç‚¹ myRef = React.createRef(); clickEvent = () => { //èŠ‚ç‚¹ä¿å­˜åœ¨å®¹å™¨é‡Œçš„currentä¸­ alert(this.myRef.current.value) } render() { return ( &lt;div> &lt;input type=\"text\" ref={this.myRef} /> &lt;button onClick={this.clickEvent}>click me&lt;/button> &lt;/div> ) } } refsçš„ä½¿ç”¨ åœ¨Hookä¸­ä½¿ç”¨useEffectæ—¶ï¼Œå¦‚æœä½ æƒ³å¾—åˆ°â€œæœ€æ–°â€çš„å€¼ï¼Œä½ å¯ä»¥ä½¿ç”¨ref otherï¼šåºŸç‰©æ„é€ å™¨ï¼ˆæˆ‘ä»¬åœ¨å¼€å‘çš„æ—¶å€™ï¼Œèƒ½çœå°±çœï¼Œå‡ ä¹ä¸å†™æ„é€ å™¨çš„åŸå› ï¼‰ åœ¨ä½¿ç”¨ç±»å¼ç»„ä»¶æ—¶ï¼Œä½¿ç”¨å…¶æ„é€ å™¨ï¼Œåˆ™ä¼šé»˜è®¤ä¼ å…¥propsï¼Œå¹¶ä¸”éœ€è¦ä½ ä½¿ç”¨super(props) å¦‚æœç›´æ¥ä¸ä¼ propsï¼Œç›´æ¥ super()ï¼ŒReactå®˜ç½‘å·²ç»æ˜ç¤ºä½ äº†ï¼Œä¼šï¼š åœ¨ React ç»„ä»¶æŒ‚è½½ä¹‹å‰ï¼Œä¼šè°ƒç”¨å®ƒçš„æ„é€ å‡½æ•°ã€‚åœ¨ä¸º React.Component å­ç±»å®ç°æ„é€ å‡½æ•°æ—¶ï¼Œåº”åœ¨å…¶ä»–è¯­å¥ä¹‹å‰å‰è°ƒç”¨ super(props)ã€‚å¦åˆ™ï¼Œthis.props åœ¨æ„é€ å‡½æ•°ä¸­å¯èƒ½ä¼šå‡ºç°æœªå®šä¹‰çš„ bugï¼ï¼ åœ¨Reactç±»å¼ç»„ä»¶é‡Œï¼Œæ„é€ å™¨çš„ä½œç”¨ï¼š é€šè¿‡ç»™ this.state èµ‹å€¼å¯¹è±¡æ¥åˆå§‹åŒ–å†…éƒ¨ stateã€‚ï¼ˆå¯ä»¥ç›´æ¥åœ¨ç±»ä¸­ä½¿ç”¨è¡¨è¾¾å¼æ›¿ä»£ï¼‰ ä¸ºäº‹ä»¶å¤„ç†å‡½æ•°ç»‘å®šå®ä¾‹ ï¼ˆå¯ä»¥ç›´æ¥åœ¨ç±»ä¸­ä½¿ç”¨è¡¨è¾¾å¼ + ç®­å¤´å‡½æ•°æ›¿ä»£ï¼‰ å®é™…ä¸Šä¹Ÿå°±æ˜¯ä¹‹å‰æˆ‘ä»¬çš„ç¹çä¸¤æ­¥èµ°ï¼Œæ²¡ä»€ä¹ˆå¿…è¦ã€‚ã€‚ã€‚so weak constructor(props) { super(props); this.state = { isHot: true } this.changeWeathter = this.changeWeathter.bind(this); } 3.Reactäº‹ä»¶ç›‘å¬Reactäº‹ä»¶ç›‘å¬ï¼ˆå‰ä¼ ï¼‰åŸç”Ÿjs onclick -&gt; React onClick (vueçš„æ˜¯ v-on:click=&quot;&quot; æˆ–è€…@click=&quot;&quot;) åŸç”Ÿjs onblur -&gt; React onBlur (vueçš„æ˜¯ v-on:blur=&quot;&quot; æˆ–è€…@blur=&quot;&quot;) åŸç”Ÿjs onkeyup -&gt; React onKeyUp (vueçš„æ˜¯ v-on:keyup=&quot;&quot; æˆ–è€…@keyup=&quot;&quot;) æ™®é€šå‡½æ•°çš„è°ƒç”¨ï¼ˆæ³¨æ„ä¸è¦åŠ æ‹¬å·ï¼ï¼‰ class MyComponent extends React.Component { render() { return &lt;h2 onClick={fn}>hello React&lt;/h2> } } ReactDOM.render(&lt;MyComponent />, document.querySelector('#container')) function fn(){ console.log('today is a good day'); } Reacté™¤äº†æŠŠå¤§å°å†™æ¢äº†ä¹‹å¤–ï¼Œå®è´¨ä¸Šå®ƒå†…éƒ¨é‡æ–°è‡ªå®šä¹‰äº†æ–¹æ³•ï¼Œæ‹¥æœ‰æ›´å¥½çš„å…¼å®¹æ€§ é™¤æ­¤ä¹‹å¤–ï¼ŒReactçš„äº‹ä»¶ï¼Œæ˜¯é€šè¿‡äº‹ä»¶å§”æ‰˜çš„æ–¹å¼å¤„ç†çš„ï¼ˆå§”æ‰˜ç»™ç»„ä»¶æœ€å¤–å±‚å…ƒç´ ï¼Œå³å°†äº‹ä»¶éƒ½åŠ ç»™äº†jsxé‡Œåœ¨å¤–å±‚çš„divï¼‰ å’ŒåŸç”Ÿjsä¸€æ ·ï¼ŒReactå¯¹äº‹ä»¶ç›‘å¬æ—¶ï¼Œä¼šä¼ å…¥äº‹ä»¶å¯¹è±¡eventï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹å½¢å¼å¾—åˆ°äº‹ä»¶å¯¹è±¡ï¼Œé¿å…ä½¿ç”¨äº†refs clickEvent = (e) => { alert(e.target.value) } render() { return ( &lt;div> &lt;input type=\"text\" onBlur={this.clickEvent} /> &lt;/div> ) } reactä¸­thisæŒ‡å‘è¦æ³¨æ„çš„æ˜¯ï¼š ä»¥ä¸‹ä»£ç ä¸­renderè¾“å‡ºthisçš„æ˜¯MyComponentç»„ä»¶å®ä¾‹ fnè¾“å‡ºçš„thisæ˜¯undefined constructorçš„thisæŒ‡å‘çš„ä¹Ÿæ˜¯MyComponentç»„ä»¶å®ä¾‹ å› ä¸ºåœ¨ä½¿ç”¨ç±»å¼ç»„ä»¶æ—¶ï¼Œæ˜¯newå‡ºç»„ä»¶å¯¹è±¡å®ä¾‹ï¼Œç„¶åéƒ½é€šè¿‡è¯¥å®ä¾‹è°ƒç”¨renderæ–¹æ³•ï¼Œæ‰€ä»¥åœ¨renderä¸­thisæŒ‡å‘çš„æ˜¯ç»„ä»¶å¯¹è±¡å®ä¾‹ è€Œconstructoræ„é€ å‡½æ•°ä¸­çš„thisä¸€å®šæ˜¯æŒ‡å‘å½“å‰å¯¹è±¡çš„å®ä¾‹ è€Œè¿™é‡Œçš„fnæ–¹æ³•ï¼Œæ˜¯åœ¨å…¨å±€ä¸‹è°ƒç”¨çš„ï¼Œæ²¡æœ‰åœ¨renderä¸‹å®Œæˆè°ƒç”¨ï¼Œthisåº”è¯¥æ˜¯æŒ‡å‘windowï¼Œä½†æ˜¯åœ¨ç±»å†…éƒ¨è‡ªåŠ¨å¸®ä½ å¼€å¯äº†å±€éƒ¨ä¸¥æ ¼æ¨¡å¼ï¼Œæ‰€ä»¥thisæŒ‡å‘äº†undefined ï¼ˆæˆ‘ä¸ªäººåœ¨es5ç¬”è®°ä¸­æ€»ç»“çš„åœ¨ç±»ä¸­çš„thisæŒ‡å‘çš„æ˜¯å…¶å®ä¾‹å¯¹è±¡ï¼Œå®è´¨ä¸Šæ˜¯å› ä¸ºæˆ‘ä»¬è°ƒç”¨å‡½æ•°æ—¶ï¼Œæ˜¯é€šè¿‡å®ä¾‹å¯¹è±¡æ¥è°ƒç”¨çš„ï¼Œæ¯”å¦‚p1.render()ï¼Œæ­¤æ—¶thiså½“ç„¶æŒ‡å‘çš„æ˜¯å®ä¾‹å¯¹è±¡ï¼Œè€Œè¿™é‡Œçš„ å‡½æ•°æ–¹æ³•ç±»ä¼¼äºå‘ç”Ÿäº† const x = p1.fn; x();çš„æ“ä½œï¼‰ class MyComponent extends React.Component { constructor(props){ super(props); } render() { console.log(this); //å®ä¾‹å¯¹è±¡ return &lt;h2 onClick={this.fn}>hello React&lt;/h2> } fn(){ console.log(this); //undefined } } ReactDOM.render(&lt;MyComponent />, document.querySelector('#container')) è§£å†³æ–¹æ³•ä¸€ï¼šåœ¨constructorä½¿ç”¨bindï¼ˆå³åˆ›é€ æ–°çš„å‡½æ•° const f = fn.bind(xx)ï¼Œæ‹·è´ï¼Œæ— è°ƒç”¨ï¼‰ constructor(props){ super(props); this.fn = this.fn.bind(this); } è§£å†³æ–¹æ³•äºŒï¼š ç®€åŒ–æ–¹æ¡ˆ åœ¨å®é™…å¼€å‘ä¸­ï¼Œä¸ä¼šä½¿ç”¨åˆ°å¦‚ä¸Šæ¯”è¾ƒéº»çƒ¦çš„å†™æ³•ï¼Œè€Œæ˜¯åˆ©ç”¨ç±»ä¸­ç›´æ¥å†™èµ‹å€¼è¯­å¥çš„æ“ä½œï¼Œå¾€å®ä¾‹è‡ªèº«é»˜è®¤è¿½åŠ ä¸€ä¸ªå±æ€§ æ­¤æ—¶å‡½æ•°æˆä¸ºäº†å®ä¾‹çš„è‡ªå®šä¹‰æ–¹æ³•ï¼Œä¸”thisçš„æŒ‡å‘èƒ½æ¯«ä¸åŠ¨æ‘‡æŒ‡å‘å®ä¾‹ class MyComponent extends React.Component { state = { isHot: true } render() { return &lt;h2 onClick={this.changeWeathter}>today is {this.state.isHot ? 'hot' : 'cold'}&lt;/h2> } //ç®­å¤´å‡½æ•°thisæŒ‡å‘å‡½æ•°å®šä¹‰ä¸Šä¸‹æ–‡çš„this //è¦å†™æˆ changeWeathter = function(){}çš„å½¢å¼æ‰èƒ½æ”¹ä¸ºç®­å¤´å‡½æ•°ï¼Œæ²¡æœ‰changeWeathter()=>{}çš„å†™æ³•ï¼Œæ‰€ä»¥åªèƒ½ï¼š changeWeathter = () =>{} changeWeathter = () => { const isHot = !this.state.isHot; this.setState({ isHot: isHot }) } } éå—æ§ç»„ä»¶ &amp; å—æ§ç»„ä»¶éå—æ§ç»„ä»¶ å¤–éƒ¨æ— æ³•å½±å“åˆ°ç»„ä»¶å†…éƒ¨ è¯´ç”±è¾“å…¥ç±»çš„DOMï¼Œæ¯”å¦‚ inputï¼Œå¦‚æœæ˜¯ç°ç”¨ç°å–ï¼Œåˆ™ä¸ºéå—æ§ç»„ä»¶ï¼Œæ¯”å¦‚ä¸‹æ–¹å°±æ˜¯ä¸€ä¸ªéå—æ§ç»„ä»¶ class Login extends React.Component { handle = (e) => { e.preventDefault(); const { userName, password } = this; alert(`ç”¨æˆ·åï¼š${userName.value}, å¯†ç ï¼š${password.value}`) } render() { return ( &lt;div> &lt;form action=\"https://www.baidu.com\" onSubmit={this.handle}> ç”¨æˆ·å&lt;input type=\"text\" ref={node => this.userName = node} name=\"username\" /> å¯†ç &lt;input type=\"password\" ref={node => this.password = node} name=\"password\" /> &lt;button>ç™»å½•&lt;/button> &lt;/form> &lt;/div> ) } } å—æ§ç»„ä»¶ï¼ˆå»ºè®®ï¼‰ ä¹Ÿå¯ä»¥è¯´æ˜¯åˆ©ç”¨è§¦å‘æœ¬èº«äº‹ä»¶ï¼Œä¸éœ€è¦ä½¿ç”¨åˆ°refï¼Œç„¶åä¿å­˜äºstate è¿™ä¸ªæ¡ˆä¾‹å®é™…ä¸Šå¯ä»¥ç†è§£ä¸ºVueçš„ v-modelè¯­æ³•ç³–ï¼Œåªä¸è¿‡è¿™é‡Œéœ€è¦æˆ‘ä»¬è‡ªå·±å†™ class Login extends React.Component { state = { userName: null, passWord: null } changeName = (e) => { this.setState({ userName: e.target.value }) } changePsw = (e) => { this.setState({ passWord: e.target.value }) } handle = (e) => { e.preventDefault(); const { userName, passWord } = this.state; alert(`ç”¨æˆ·åï¼š${userName}, å¯†ç ï¼š${passWord}`) } render() { return ( &lt;div> &lt;form action=\"https://www.baidu.com\" onSubmit={this.handle}> {/* onChangeäº‹ä»¶å’ŒDOMçš„onchangeä¸ä¸€æ ·ï¼Œè¿™é‡Œåªè¦è¡¨å•çš„valueå‘ç”Ÿæ”¹å˜ï¼Œå°±ä¼šå›è°ƒäº‹ä»¶*/} ç”¨æˆ·å&lt;input type=\"text\" onChange={this.changeName} name=\"username\" /> å¯†ç &lt;input type=\"password\" onChange={this.changePsw} name=\"password\" /> &lt;button>ç™»å½•&lt;/button> &lt;/form> &lt;/div> ) } } Reactå‡½æ•°ä¼ å‚åœ¨Vueä¸­ï¼Œå¦‚æœè¯¥æ–¹æ³•ä¸éœ€è¦ä¼ é€’å‚æ•°ï¼Œåˆ™æ–¹æ³•åé¢çš„()å¯ä»¥ä¸ç”¨æ·»åŠ ï¼Œ å¦‚æœéœ€è¦ä¼ å…¥å‚æ•°ï¼Œåˆ™ä½¿ç”¨ å‡½æ•°å(å‚æ•°)çš„å½¢å¼ ä½†æ˜¯åœ¨Reactä¸­ï¼Œå¦‚æœä½¿ç”¨ å‡½æ•°å()çš„å½¢å¼ï¼Œæ¯”å¦‚åœ¨æ ‡ç­¾é‡Œ &lt;h2 onClick={this.fn()}&gt;hello React&lt;/h2&gt;ï¼Œåˆ™åœ¨è§¦å‘äº‹ä»¶æ—¶ï¼Œå¹¶ä¸ä¼šå›è°ƒå‡½æ•°ï¼Œè€Œæ˜¯åœ¨ç½‘é¡µæ¸²æŸ“çš„æ—¶å€™è°ƒç”¨ä¸€æ¬¡ï¼Œæ­¤æ—¶ä¼ å…¥çš„å›è°ƒå‡½æ•°æ˜¯fné‡Œçš„è¿”å›å€¼ï¼Œè‹¥æ²¡å†™å…¥è¿”å›å€¼ï¼Œåˆ™ä¼ å…¥çš„æ˜¯undefined æ‰€ä»¥æˆ‘ä»¬éœ€è¦ç”¨ä¸€ä¸ªå·§å¦™çš„æ–¹æ³•ï¼Œæ–¹ä¾¿æˆ‘ä»¬ä¼ å…¥å‚æ•°ï¼Œå³åœ¨äº‹ä»¶å›è°ƒå‡½æ•°é‡Œï¼Œè¿”å›ä¸€ä¸ªå›è°ƒå‡½æ•°ï¼ï¼ï¼ˆå³ä½¿ç”¨å‡½æ•°æŸ¯é‡ŒåŒ–çš„æ–¹å¼ï¼‰ æ–¹æ³•ä¸€ï¼šæŸ¯é‡ŒåŒ–æ–¹å¼ ä»¥ä¸‹æ˜¯å¯¹ä¸Šæ–¹changäº‹ä»¶çš„ä¼˜åŒ–ï¼Œå®ç°ç”¨æˆ·å å’Œ å¯†ç éƒ½å¯ä»¥ä½¿ç”¨åŒä¸€ä¸ªå‡½æ•° cChange = (dataType) => { return (event) => { this.setState({ // ä½œä¸ºé”®åæ—¶ï¼Œå¦‚æœæ˜¯å˜é‡åç›´æ¥å†™ï¼Œå°±å¿…é¡»åŠ [] [dataType]: event.target.value }) } } ç„¶è€Œï¼Œé™¤æ­¤ä¹‹å¤–ï¼Œè¿˜æœ‰å…¶ä»–ä¸ç”¨æŸ¯é‡ŒåŒ–çš„æ–¹å¼ä¹Ÿèƒ½å®ç°Reactå‡½æ•°ä¼ å‚ æ–¹æ³•äºŒï¼šå†…è”çš„ç®­å¤´å‡½æ•°æˆ‘ä¸ªäººè®¤ä¸ºå®è´¨ä¸Šå’ŒæŸ¯é‡ŒåŒ–çš„æ„æ€å·®ä¸å¤šï¼Œåªæ˜¯åœ¨å†…è”éƒ¨åˆ†å®ç°ç½¢äº† cChange = (dataType, event) => { this.setState({ // ä½œä¸ºé”®åæ—¶ï¼Œå¦‚æœæ˜¯å˜é‡åç›´æ¥å†™ï¼Œå°±å¿…é¡»åŠ [] [dataType]: event.target.value }) } render() { return ( &lt;div> &lt;form action=\"https://www.baidu.com\" onSubmit={this.handle}> ç”¨æˆ·å&lt;input type=\"text\" onChange={event => this.cChange('userName', event)} name=\"username\" /> å¯†ç &lt;input type=\"password\" onChange={event => this.cChange('passWord', event)} name=\"password\" /> &lt;button>ç™»å½•&lt;/button> &lt;/form> &lt;/div> ) } Reactç”Ÿå‘½å‘¨æœŸå‡½æ•°ç”Ÿå‘½å‘¨æœŸå‡½æ•°å¯ä»¥ä¸ç”¨ç®­å¤´å‡½æ•°ï¼Œå› ä¸ºå®ƒä»¬å’Œrenderå±äºåŒä¸€æ€§è´¨ï¼Œåœ¨åˆ›å»ºé¡µé¢/é”€æ¯é¡µé¢çš„æ—¶å€™é€šè¿‡ç±»çš„å®ä¾‹è°ƒç”¨ä¸€æ¬¡ 1.æŒ‚è½½ç»„ä»¶mount å¸è½½ç»„ä»¶unmount componentDidMountï¼ˆå’ŒVueçš„mountedä¸€æ ·ï¼Œåªè°ƒç”¨ä¸€æ¬¡ï¼Œå³æŒ‚è½½ç»„ä»¶çš„æ—¶å€™è°ƒç”¨ä¸€æ¬¡ï¼Œç±»ä¼¼äºrenderçš„å…„å¼Ÿï¼Œåªä¸è¿‡setStateä¸èƒ½åœ¨ renderé‡Œè¿›è¡Œè°ƒç”¨ï¼Œç„¶è€ŒsetStateå¯ä»¥åœ¨ mountdé‡Œé¢è°ƒç”¨ ï¼‰ ä½¿ç”¨æ–¹å¼ï¼š componentWillMount(){}è°ƒç”¨ï¼šç»„ä»¶å³å°†æŒ‚è½½æ—¶ componentDidMount(){}è°ƒç”¨ï¼šç»„ä»¶æŒ‚è½½å®Œæ¯•ï¼ˆå¸¸ç”¨ï¼‰ componentWillUnmount() {}è°ƒç”¨ï¼šç»„ä»¶è¢«å¸è½½å‰æ‰§è¡Œï¼Œæœ‰ç‚¹åƒvueé‡Œçš„beforeDestoryï¼ˆå¸¸ç”¨ï¼Œä¸€èˆ¬ç”¨äºè§£å†³ä¸€äº›å†…å­˜æ³„æ¼çš„é—®é¢˜ï¼‰ å¸è½½èŠ‚ç‚¹(ç»„ä»¶)çš„æ–¹å¼ ReactDOM.unmountComponentAtNode(èŠ‚ç‚¹) 2.renderï¼šåˆå§‹åŒ–æ¸²æŸ“æˆ–è€…çŠ¶æ€æ›´æ–°ä¹‹åï¼ˆå¸¸ç”¨ï¼‰ æœ‰ç‚¹ç±»ä¼¼Vueçš„updatedï¼Œå› ä¸ºVueå®˜æ–¹è§£é‡Šå¯¹äºupdatedä¹Ÿæ˜¯é¿å…åœ¨é‡Œé¢æ“ä½œDOMï¼Œå¯èƒ½ä¼šå¼•èµ·æ­»å¾ªç¯ï¼Œè€Œåœ¨renderé‡Œè°ƒç”¨setStateï¼Œä¹Ÿä¼šå¼•èµ·æ­»å¾ªç¯ï¼ ä»¥ä¸‹ä¸ºç”Ÿå‘½å‘¨æœŸå‡½æ•°å°æ¡ˆä¾‹ class Life extends React.Component { state = { opacity: 1 } wind = () => { // å¸è½½èŠ‚ç‚¹ ReactDOM.unmountComponentAtNode(document.querySelector('#container')) } componentDidMount() { if (this.timer) this.timer = null; this.timer = setInterval(() => { console.log('gg'); let { opacity } = this.state; opacity -= 0.1; if (opacity &lt;= 0) opacity = 1; this.setState({ opacity }) }, 200) } componentWillUnmount() { //åœ¨å¸è½½èŠ‚ç‚¹ä¹‹å‰ï¼Œæ¸…é™¤å®šæ—¶å™¨ï¼Œé˜²æ­¢æŠ¥é”™ + å†…å­˜æ³„éœ² clearInterval(this.timer); } render() { return ( &lt;div> &lt;h1 style={{ opacity: this.state.opacity }}>åˆ®é£ä¹‹å‰&lt;/h1> &lt;button onClick={this.wind}>åˆ®é£ä¹‹å&lt;/button> &lt;/div> ) } } ReactDOM.render(&lt;Life />, document.querySelector('#container')) æ—§ç‰ˆReactç”Ÿå‘½å‘¨æœŸå›¾ æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼ˆç”±ReactDOM.render()è§¦å‘ï¼‰åˆå§‹åŒ–é˜¶æ®µï¼š constructor -&gt; componentWillMount -&gt; render -&gt; componentDidMount æ›´æ–°é˜¶æ®µï¼Œæœ‰ setStateã€ forceUpdateã€ çˆ¶ç»„ä»¶é‡æ–°render ä¸‰æ¡æ—¶é—´çº¿ å‘ç”Ÿäº†setState -&gt; shouldComponentUpdateï¼ˆæ˜¯å¦åº”è¯¥é‡æ–°æ›´æ–°é¡µé¢ï¼‰ï¼Œå¦‚æœè¿”å›falseï¼Œé˜€é—¨å…³é—­ï¼Œåˆ™åœä½ï¼›å¦‚æœè¿”å›trueï¼Œåˆ™è¿›è¡Œä¸‹ä¸€æ­¥ï¼ˆè¿™ä¸ªç”Ÿå‘½å‘¨æœŸé’©å­é»˜è®¤è¿”å›trueï¼‰ -&gt; componentWillUpdate-&gt; renderå‘ç”Ÿæ›´æ–° -&gt; componentDidUpdate ç¬¬äºŒæ¡çº¿ï¼Œå‘ç”Ÿäº† forceUpdate() -&gt; componentWillUpdate-&gt; renderå‘ç”Ÿæ›´æ–° -&gt; componentDidUpdate ç¬¬ä¸‰æ¡ï¼Œæ˜¯å½“å…¶çˆ¶ç»„ä»¶å‘ç”Ÿäº†renderæ—¶ï¼Œè·³è½¬åˆ° -&gt; componentWillReceiveProps(ç»„ä»¶å°†è¦æ¥æ”¶å‚æ•°) -&gt; shouldComponentUpdate -&gt; componentWillUpdate-&gt; renderå‘ç”Ÿæ›´æ–° -&gt; componentDidUpdate ä½†å®è´¨ä¸Š componentWillReceiveProps æœ‰ä¸ªå‘ï¼Œå°±æ˜¯ç¬¬ä¸€æ¬¡ä¼ å…¥æ—¶ä¸ç®—ï¼Œä¸ä¼šè°ƒç”¨è¿™ä¸ªç”Ÿå‘½å‘¨æœŸå‡½æ•°ï¼›ç„¶åå†ç¬¬äºŒã€ä¸‰æ¬¡æ—¶ï¼Œè®©çˆ¶ç»„ä»¶å‘ç”Ÿrenderï¼Œå­ç»„ä»¶å°±ä¼šè°ƒç”¨è¿™ä¸ªç”Ÿå‘½å‘¨æœŸå‡½æ•° ç”±æ­¤æˆ‘ä»¬å¾—åˆ°ä¸€äº›å…¶ä»–çš„ç”Ÿå‘½å‘¨æœŸå‡½æ•° 3.shouldComponentUpdate(){} æ§åˆ¶ç»„ä»¶æ˜¯å¦æ›´æ–°çš„é˜€é—¨æ—¶é’©å­ 4.componentWillUpdate(){} ç»„ä»¶å°†è¦å‘ç”Ÿæ›´æ–°æ—¶é’©å­ 5.componentDidUpdate(){}ç»„ä»¶æ›´æ–°å®Œæ¯•æ—¶é’©å­ï¼Œå®ƒå¯ä»¥æ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°prePropsæ˜¯å…ˆå‰æ¥æ”¶çš„propså€¼ï¼Œç¬¬äºŒä¸ªpreStateæ˜¯æ›´æ–°å‰çš„stateå€¼ 6.componentWillReceiveProps(){}çˆ¶ç»„ä»¶ render å†æ¬¡ä¼ å…¥æ–°çš„propsè°ƒç”¨ è¡¥å……ï¼š forceUpdate()æ˜¯å¼ºåˆ¶æ›´æ–°çš„æ–¹æ³•ã€æœ‰æ—¶å¹¶ä¸æƒ³ä½¿ç”¨setState()ï¼Œåªæ˜¯å•çº¯æƒ³è®©é¡µé¢å‘ç”Ÿæ›´æ–°ï¼Œå¯ä»¥ä½¿ç”¨è¿™ä¸ªå‡½æ•° æ–°ç”Ÿå‘½å‘¨æœŸå›¾ æ”¹åŠ¨ä¸€ï¼š åœ¨æ–°ç‰ˆæœ¬ï¼ˆ17.0ä»¥ä¸Šï¼‰ä½¿ç”¨æ—§çš„ç”Ÿå‘½å‘¨æœŸå‡½æ•° æ¯”å¦‚ä½¿ç”¨ componentWillMount ã€ componentWillUpdateã€ componentWillReceiveProps å°±ä¼šå‡ºç°é»„è‰²è­¦å‘Šï¼ˆè™½ç„¶ä¸Šå›¾æ²¡å‡ºç°ä»–ä»¬ä¸‰ä¸ªï¼Œä½†æ˜¯å¯ä»¥ä½¿ç”¨ï¼‰ï¼ˆç®€ç§° 3 Willç»„åˆï¼Œä½†æ˜¯ componentWillUnMount() æ²¡äº‹ ï¼‰ å®ƒæç¤ºä½ æ–°ç‰ˆæœ¬å·²ç»å¼€å§‹ä½¿ç”¨ UNSAFE_componentWillMountã€ UNSAFE_componentWillUpdateï¼Œå¹¶ä¸”æç¤ºä½ å¯èƒ½åœ¨18.0ç‰ˆæœ¬ä»¥åå°±ä¸èƒ½ä½¿ç”¨æ—§ç‰ˆæœ¬çš„ä»¥ä¸Šçš„ç”Ÿå‘½å‘¨æœŸå‡½æ•°äº† ç„¶è€Œä¸ºä»€ä¹ˆè¿™ä¸‰ä¸ªç”Ÿå‘½å‘¨æœŸè¦å‘ç”Ÿæ”¹åŠ¨ï¼ŸReactå®˜æ–¹è§£é‡Šé“ï¼š è¿™äº›ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ç»å¸¸è¢«è¯¯è§£å’Œæ»¥ç”¨ï¼ˆä¸å¸¸ç”¨ï¼Œå¯èƒ½å¯¼è‡´ç¼–ç¨‹äººå‘˜ç”¨é”™åœ°æ–¹ï¼‰ï¼›æ­¤å¤–ï¼Œæˆ‘ä»¬é¢„è®¡ï¼Œåœ¨å¼‚æ­¥æ¸²æŸ“ä¸­ï¼Œå®ƒä»¬æ½œåœ¨çš„è¯¯ç”¨é—®é¢˜å¯èƒ½æ›´å¤§ã€‚æˆ‘ä»¬å°†åœ¨å³å°†å‘å¸ƒçš„ç‰ˆæœ¬ä¸­ä¸ºè¿™äº›ç”Ÿå‘½å‘¨æœŸæ·»åŠ  â€œUNSAFE_â€ å‰ç¼€ã€‚ï¼ˆè¿™é‡Œçš„ â€œunsafeâ€ ä¸æ˜¯æŒ‡å®‰å…¨æ€§ï¼Œè€Œæ˜¯è¡¨ç¤ºä½¿ç”¨è¿™äº›ç”Ÿå‘½å‘¨æœŸçš„ä»£ç åœ¨ React çš„æœªæ¥ç‰ˆæœ¬ä¸­æ›´æœ‰å¯èƒ½å‡ºç° bugï¼Œå°¤å…¶æ˜¯åœ¨å¯ç”¨å¼‚æ­¥æ¸²æŸ“ä¹‹åã€‚ï¼‰ æˆ‘ä¸ªäººè®¤ä¸ºåˆ™æ˜¯fiberåˆ†ç‰‡è°ƒåº¦çš„å­˜åœ¨ï¼Œä½¿å¾—ç¬¬ä¸€é˜¶æ®µç›¸å…³çš„è¿™äº›ç”Ÿå‘½å‘¨æœŸå‡½æ•°å†…çš„ä»£ç å¯èƒ½è¢«å¤šæ¬¡æ‰§è¡Œï¼Œéå¸¸unstableï¼ æ”¹åŠ¨äºŒï¼š å‡ºç°æ–°çš„é’©å­ï¼š 1.getDerivedStateFromPropsï¼Œå®ƒæ¨ªè·¨åˆå§‹åŒ– &amp; æ›´æ–°éƒ¨åˆ†ï¼ˆè¿™éƒ¨åˆ†è‹±æ–‡æ„æ€å¯ä»¥ç†è§£ä¸ºï¼šä»Propså¾—åˆ°æ´¾ç”Ÿçš„çŠ¶æ€ï¼‰ å®ƒä½œä¸ºä¸€ä¸ªé™æ€æ–¹æ³•ï¼ˆstaticï¼‰ï¼Œåº”è¯¥æŒ‚è½½åˆ°ç±»ä¸Šï¼Œè€Œä¸æ˜¯æŒ‚è½½åˆ°å®ä¾‹ä¸Š å®ƒå¿…é¡»è¿”å›ä¸€ä¸ªçŠ¶æ€å¯¹è±¡ï¼Œä¸ç„¶ä¼šæŠ¥é”™ï¼ˆä¸ç„¶ä¹Ÿå¾—è¿”å›ä¸€ä¸ªnullï¼‰ å®ƒå¯ä»¥æ¥å—ä¸¤ä¸ªå‚æ•°ï¼Œå³æ¥æ”¶propsã€stateï¼Œæ­¤æ–¹æ³•é€‚ç”¨äºç½•è§çš„ç”¨ä¾‹ï¼Œå³ state çš„å€¼åœ¨ä»»ä½•æ—¶å€™éƒ½å–å†³äº propsï¼ˆæ¯”å¦‚stateçš„ æŸ key : value å–å†³äº props ä¼ å…¥çš„ key : valueï¼‰ static getDerivedStateFromProps(props, state){ } ä½†æ˜¯ï¼šï¼ï¼ï¼æ´¾ç”ŸçŠ¶æ€ä¼šå¯¼è‡´ä»£ç å†—ä½™ï¼Œå¹¶ä½¿ç»„ä»¶éš¾ä»¥ç»´æŠ¤ï¼Œæ‰€ä»¥äº†è§£å³å¯ 2.getSnapshotBeforeUpdateï¼Œå®ƒé’©åœ¨Reactæ›´æ–°DOM å’Œ refsä¹‹å‰ ï¼ˆè¿™éƒ¨åˆ†è‹±æ–‡æ„æ€å¯ä»¥ç†è§£ä¸ºï¼šåœ¨æ›´æ–°ä¹‹å‰ï¼Œè·å–å¿«ç…§ï¼‰ï¼ˆå¤§å®¶å›å®¶ä¹‹å‰ï¼Œé›†ä½“æ‹ä¸ªç…§ * .* ï¼‰ å®ƒå¿…é¡»è¿”å›ä¸€ä¸ªå¿«ç…§å€¼ï¼Œä¸ç„¶ä¼šæŠ¥é”™ï¼ˆä¸ç„¶ä¹Ÿå¾—è¿”å›ä¸€ä¸ªnullï¼‰ å¿«ç…§å€¼å¯ä»¥æ˜¯ä»»æ„ç±»å‹ ä¹‹å‰è®²è¿°åˆ°componentDidUpdate(){}ç”Ÿå‘½å‘¨æœŸå‡½æ•°ï¼Œå®è´¨ä¸Šå®ƒå¯ä»¥æ¥æ”¶ç¬¬ä¸‰ä¸ªå‚æ•°ï¼Œä¹Ÿå°±æ˜¯ snapshotValueï¼Œè€ŒsnapshotValueå°±æ˜¯ getSnapshotBeforeUpdateé’©å­å‡½æ•°è¿”å›çš„å€¼ componentDidUpdate(preProps, preState, snapshotValue){ //xxxx } è™½ç„¶è¿™ä¸¤ä¸ªæ–°çš„é’©å­åå­—å·¨é•¿ï¼Œå¾ˆæ¶å¿ƒï¼Œä½†æ˜¯å®˜æ–¹ä¹Ÿé˜è¿°äº†è¿™ä¸¤ä¸ªé’©å­çš„ä½¿ç”¨åœºæ™¯æå…¶ç½•è§ æ€»ç»“ï¼š åˆå§‹åŒ–é˜¶æ®µï¼š constructor -&gt; getDerivedStateFromProps -&gt; render -&gt; componentDidMount æ›´æ–°é˜¶æ®µï¼ŒåŒæ ·ä¹Ÿæœ‰æœ‰ setStateã€ forceUpdateã€ çˆ¶ç»„ä»¶é‡æ–°render ä¸‰æ¡æ—¶é—´çº¿ï¼Œå¦‚ä¸Šå›¾æ‰€ç¤º 4.Reactè„šæ‰‹æ¶ä½¿ç”¨è„šæ‰‹æ¶å¼€å‘é¡¹ç›®çš„ç‰¹ç‚¹ï¼šæ¨¡å—åŒ–ï¼Œç»„ä»¶åŒ–ï¼Œå·¥ç¨‹åŒ– é¡¹ç›®æ•´ä½“æŠ€æœ¯æ¶æ„ä¸ºï¼šreact + webpack + es6 + eslint å½“ç„¶åˆ›å»ºreactè„šæ‰‹æ¶å¿…é¡»åœ¨æœ¬åœ°ä¸»æœºä¸Šå®‰è£…reactçš„ä¸“ç”¨è„šæ‰‹æ¶åº“ npm i -g create-react-app åˆ‡æ¢åˆ°æˆ‘ä»¬æƒ³è¦çš„ç›®å½•ä¸‹è¿›è¡Œåˆå§‹åŒ– create-react-app é¡¹ç›®åç§° å¯åŠ¨é¡¹ç›®ï¼ˆé»˜è®¤æƒ…å†µä¸‹ï¼‰ npm start æ‰“åŒ…é¡¹ç›®ï¼ˆé»˜è®¤æƒ…å†µä¸‹ï¼‰ npm build å¯åŠ¨é¡¹ç›®ï¼ˆé»˜è®¤æƒ…å†µä¸‹ï¼‰ Reactè„šæ‰‹æ¶ä¸­é€šç”¨è·¯å¾„å†™æ³•ï¼š %PUBLIC_URL%/favicon.ico ï¼špublicç›®å½•ä¸‹çš„faviconå›¾æ ‡ åœ¨index.htmlä¸­å¯ä»¥çœ‹åˆ° &lt;!-- å¼€å¯ç†æƒ³çª—å£ã€åšç§»åŠ¨ç«¯é€‚é… --> &lt;meta name=\"viewport\" content=\"width=device-width, initial-scale=1\" /> &lt;!-- ç”¨äºé…ç½®æµè§ˆå™¨é¡µç­¾ + åœ°å€æ çš„é¢œè‰²ï¼ˆä»…æ”¯æŒå®‰å“æ‰‹æœºï¼‰ --> &lt;meta name=\"theme-color\" content=\"#000000\" /> &lt;!-- ç”¨äºé€‚é…è‹¹æœç³»ç»Ÿçš„å›¾æ ‡ --> &lt;link rel=\"apple-touch-icon\" href=\"%PUBLIC_URL%/logo192.png\" /> &lt;!-- åœ¨htmlä¸Šå¥—ä¸Šå®‰å“ / iosçš„ apkå£³ --> &lt;link rel=\"manifest\" href=\"%PUBLIC_URL%/manifest.json\" /> åœ¨srcæ–‡ä»¶å¤¹ä¸‹ äºindex.jsæˆ‘ä»¬å¯ä»¥çœ‹åˆ° import React from 'react' import ReactDOM from 'react-dom' import App from './App' ReactDOM.render( &lt;React.StrictMode> &lt;App /> &lt;/React.StrictMode>, document.getElementById('root') ); å…¶å®ä¹Ÿå°±æ˜¯å¹³æ—¶æˆ‘ä»¬æ¸²æŸ“çš„éƒ¨åˆ†ï¼Œåªæ˜¯ ä½¿ç”¨äº† &lt;React.StrictMode&gt;ï¼Œå®ƒä¼šè‡ªåŠ¨æ£€æŸ¥æ’å…¥ç»„ä»¶çš„æ’°å†™æ˜¯å¦åˆç†ï¼Œæ£€æŸ¥ä»£ç åˆç†æ€§ è€ŒreportWebVitals.js å’Œ setupTests.js åˆ†åˆ«ç”¨äºé¡µé¢æ€§èƒ½åˆ†æ å’Œ ç»„ä»¶å•å…ƒæµ‹è¯• tipï¼š åœ¨è„šæ‰‹æ¶é‡Œï¼Œå¼•å…¥æ–‡ä»¶æ—¶ï¼Œå¦‚æœæ–‡ä»¶åæ˜¯index.jsã€index.jsxï¼Œåˆ™å¼•åˆ°è¯¥æ–‡ä»¶æ‰€å¤„æ–‡ä»¶å¤¹å³å¯ åœ¨è„šæ‰‹æ¶é‡Œï¼Œå¼•å…¥æ–‡ä»¶æ—¶ï¼Œå¦‚æœæ–‡ä»¶æ˜¯js / jsxï¼Œå¯ä»¥ä¸å†™åç¼€å jsxæ¨¡æ¿ç”Ÿæˆçš„å¿«æ·é”®ï¼ˆç±»å¼ç»„ä»¶ï¼‰ï¼š rcc jsxæ¨¡æ¿ç”Ÿæˆçš„å¿«æ·é”®ï¼ˆå‡½æ•°å¼ç»„ä»¶ï¼‰ï¼š rfc è„šæ‰‹æ¶ä¸­CSSæ¨¡å—åŒ–æ­£å¸¸åœ¨jsxæ–‡ä»¶é‡Œå¼•å…¥cssï¼š import &#39;./index.css&#39; å®ç°cssæ¨¡å—åŒ–ï¼šæ–¹æ³•ä¸€ 1.index.css -&gt; index.module.css 2.å¼•å…¥æ ·å¼ï¼šimport xx from &#39;./index.module.css&#39; 3.ä½¿ç”¨æ ·å¼ :&lt;h2 className={xx.title}&gt; Hello, React &lt;/h2&gt; ä½†æ˜¯æ³¨æ„ï¼šå¦‚æœåœ¨cssæ¨¡å—ä¸­åªæ˜¯å•çº¯ä½¿ç”¨æ ‡ç­¾é€‰æ‹©å™¨ï¼Œåˆ™æ— æ³•æ¨¡å—åŒ–ï¼Œæœ‰å…¨å±€å½±å“æ€§ ul li {} æ¨èåŠ ä¸Š .home ul li {} åœ¨css moduleä¸­ä»è¦è®©æ ·å¼å…¨å±€åŒ– :global(.home){} æ–¹æ³•äºŒï¼šä½¿ç”¨lessè¿›è¡ŒåµŒå¥— ï¼ˆReactä¸­lessä½¿ç”¨æ•™ç¨‹ https://www.cnblogs.com/liangziaha/p/13632623.html ï¼‰ äº¦æˆ–è€…ä½¿ç”¨vscodeè‡ªå¸¦çš„lessè½¬åŒ–css ï¼ˆè¿˜æ˜¯Vueçš„scopeèˆ’æœå‘€ï¼‰ æ–¹æ³•ä¸‰ï¼šä½¿ç”¨sass npm i sass $width:300px ul { .item{ width:$width } } import style from './child.module.scss' &lt;li className={style.item}>&lt;/li> reactä¸­è®¾ç½®å…¨å±€è·¯å¾„npm run eject æš´éœ²å‡ºwebpackçš„é…ç½®æ–‡ä»¶webpack.config.js resolve: { //... alias: { //... // è·¯å¾„å¼•ç”¨ @ '@': path.resolve(__dirname, '../src') } } reactè„šæ‰‹æ¶prettierå’Œeslintcreate react appè‡ªå¸¦eslintï¼Œæˆ‘ä»¬éœ€è¦å®‰è£…prettier npm i prettier -D ç„¶åæˆ‘ä»¬éœ€è¦è®©eslintå’Œprettierå…¼å®¹ npm install eslint-config-prettier eslint-plugin-prettier --save-dev åœ¨æ ¹ç›®å½•ä¸‹æ–°å»ºæ–‡ä»¶ .eslintrc.json { \"extends\": [\"react-app\", \"plugin:prettier/recommended\"] } 5.Reactå¼€å‘ä¸­åº”ç”¨ç»„ä»¶æ•°æ®ä¼ é€’ï¼ˆå­ä¼ çˆ¶ï¼‰åˆ©ç”¨çš„æ˜¯å›è°ƒå‡½æ•°é—­åŒ…çš„ç‰¹æ€§ï¼Œå’ŒVueçš„å­ç»„ä»¶ä¼ é€’ç»™çˆ¶ç»„ä»¶çš„ $emit() æœ‰å¼‚æ›²åŒå·¥ä¹‹å¦™ çˆ¶ç»„ä»¶ï¼šè®¾ç½®å‡½æ•°ï¼Œå¹¶åœ¨å­ç»„ä»¶ä¸Šä½¿ç”¨propsä¼ é€’è¯¥å‡½æ•° export default class App extends Component { addTodo = (name) => { console.log(name); //å¾—åˆ°å­ç»„ä»¶çš„æ•°æ® } render() { return ( &lt;div> &lt;Header addTodo={this.addTodo}>&lt;/Header> &lt;/div> ) } } å­ç»„ä»¶ï¼Œä½¿ç”¨propsæ¥æ”¶ä¼ å…¥çš„å›è°ƒå‡½æ•°ï¼Œå¹¶ä¸”å°†æ•°æ®ä½œä¸ºå‚æ•°è¿›è¡Œè°ƒç”¨ export default class Header extends Component { addTodo = (e) => { if (e.keyCode !== 13) return; this.props.addTodo(e.target.value); //è¿›è¡Œå›è°ƒ } render() { return ( &lt;div className=\"todo-header\"> &lt;input type=\"text\" onKeyUp={this.addTodo} placeholder=\"è¯·è¾“å…¥ä½ çš„ä»»åŠ¡åç§°ï¼ŒæŒ‰å›è½¦ç¡®è®¤\" /> &lt;/div> ) } } idç”Ÿæˆåº“åœ¨æ ‡è¯†æ•°æ®å”¯ä¸€æ€§æˆ‘ä»¬éœ€è¦ç”¨åˆ°idï¼Œå½“ä½¿ç”¨randomã€date.now()ç”Ÿæˆidéƒ½æœ‰ä¸€å®šå¼Šç«¯ï¼Œå¯ä»¥å€Ÿç”¨uuidï¼Œä¸€ä¸ªidåº“å¸®åŠ©æˆ‘ä»¬ç”Ÿæˆid npm i uuid å¼€å‘å°é¡¹ç›®ï¼Œæˆ‘æ›´åŠ æ¨èçš„æ˜¯nanoid npm i nanoid nanoidæ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œæ¯æ¬¡è°ƒç”¨éƒ½ä¼šå¸®ä½ ç”Ÿæˆä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œä¿è¯å…¨çƒå”¯ä¸€ import {nanoid} from 'nanoid' const str = nanoid(); Reactå†…éƒ¨é…ç½®ä»£ç†è·¨åŸŸ(åå‘ä»£ç†) åœ¨srcç›®å½•ä¸‹æ–°å»ºä¸€ä¸ªsetupProxy.jsæ–‡ä»¶ åœ¨æ­¤æ–‡ä»¶ä¸­å¿…é¡»ä½¿ç”¨cjsçš„æ–¹å¼æ’°å†™ï¼ˆCommonJSï¼‰ï¼Œå› ä¸ºè¿™ä¸ªæ–‡ä»¶æ˜¯è¦åŠ åˆ°webpacké…ç½®é‡Œé¢çš„ï¼Œè€Œwebpackç”¨çš„æ˜¯nodeè¯­æ³• npm i http-proxy-middleware å®é™…ä¸Š http-proxy-middleware ä¹Ÿæ˜¯å¼€äº†ä¸€ä¸ªexporessæœåŠ¡å™¨ï¼Œå¸®ä½ åšåå‘ä»£ç† proxyå†…éƒ¨é€‰é¡¹ä»‹ç»ï¼š ç¬¬ä¸€ä¸ªå‚æ•°è®¾ç½®å‰ç¼€åï¼Œæ¯”å¦‚è®¾ç½®äº†å‰ç¼€åä¸º/api1ï¼Œä¹Ÿå°±æ˜¯ä»¥/apiå¼€å¤´ï¼Œ é‡åˆ°è¿™ä¸ªå‰ç¼€çš„è¯·æ±‚å°±ä¼šè§¦å‘è¯¥ä»£ç†é…ç½®ï¼Œæ¯”å¦‚çŒ«çœ¼ç”µå½±çš„è¯·æ±‚ç¤ºä¾‹ åŸæœ¬è¯·æ±‚åœ°å€ ï¼šhttps://i.maoyan.com/ajax/comingList?ci=91&amp;limit=10â€¦. -&gt; æ­¤æ—¶æˆ‘ä»¬éœ€è¦æ”¹æˆ /ajax/comingList?ci=91&amp;limit=10â€¦.ï¼Œå°±ä¼šè§¦å‘ä»£ç† axios.get('/ajax/mostExpected?limit=10&amp;offset=0&amp;token=&amp;optimus.........').then((res) => { //è‡ªåŠ¨æ‰¾æœ¬åœ°åŸŸå + /ajax console.log(res) }) ç¬¬äºŒä¸ªå‚æ•°æ˜¯é…ç½® targetï¼šæˆ‘ä»¬å‘é€çš„ç›®æ ‡è·¨åŸŸurl changOriginï¼šé»˜è®¤å€¼ä¸ºfalseï¼Œæ§åˆ¶æœåŠ¡å™¨æ”¶åˆ°è¯·æ±‚å¤´ä¸­Hostï¼ˆè¯·æ±‚èµ„æºæ‰€åœ¨æœåŠ¡å™¨ï¼Œä¹Ÿå°±æ˜¯å‘é€æºï¼‰å­—æ®µçš„å€¼ï¼›å½“changOrigin: true æ—¶ï¼Œèƒ½æ¬ºéª—æœåŠ¡å™¨ï¼Œè®©æœåŠ¡å™¨ä»¥ä¸ºæ˜¯åŒæºè¯·æ±‚ï¼Œè€Œä¸çŸ¥é“ä½ çš„çœŸå®hostå‘é€æºã€‚ï¼ˆå®é™…ä¸Šä¸åŠ å…¶å®ä¹Ÿæ²¡å…³ç³»ï¼Œä½†æ˜¯é˜²æ­¢æœåŠ¡å™¨çš„é™åˆ¶ï¼Œæ¯”è¾ƒå¥½ä¸€ç‚¹ï¼‰ pathRewriteï¼šé‡å†™è¯·æ±‚è·¯å¾„ï¼Œä¸€å®šè¦åŠ ä¸Šï¼Œä¸åŠ ä¸Šè™½ç„¶æœ‰èµ°ä»£ç†ï¼Œè¯·æ±‚è·¯å¾„åŠ ä¸Šäº† /api1ï¼Œä¸å­˜åœ¨è¯¥èµ„æºï¼Œä¸€èˆ¬ä¼šæŠ¥404 const proxy = require('http-proxy-middleware') ///ä½¿ç”¨proxyä¸­é—´ä»¶ module.exports = function (app) { //ä¸­é—´ä»¶æ—¢è§†æ„Ÿ app.use( proxy('/ajax', { target: 'https://i.maoyan.com', //ç›®æ ‡è¯·æ±‚åœ°å€ changOrigin: true, }), proxy('/api1', { target: 'http://localhost:5000', changOrigin: true, pathRewrite: { '^/api1': '' } //è‡ªåŠ¨å¸®æˆ‘ä»¬æŠŠapi1ç»™å»æ‰ }), proxy('/api2', { target: 'http://localhost:5001', changOrigin: true, pathRewrite: { '^/api2': '' } }) ) } æ¶ˆæ¯è®¢é˜…ä¸å‘å¸ƒæœºåˆ¶å·¥å…·åº“ ï¼š PubSubJS å¯ä»¥åœ¨githubä¸Šä¸‹è½½ï¼Œä¹Ÿå¯ä»¥ç›´æ¥npm npm i pubsub-js --s å¼•å…¥åï¼ˆimport PubSub from &#39;pubsub-js&#39; / const PubSub = require(&#39;pubsub-js&#39;);ï¼‰ å®˜ç½‘ä½¿ç”¨çš„æ¡ˆä¾‹ //å›è°ƒå‡½æ•° var mySubscriber = function (msg, data) { //åœ¨è°ƒç”¨æ—¶ä¼šä¼ å…¥ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªmsgå°±æ˜¯æ¶ˆæ¯åï¼Œç¬¬äºŒä¸ªdataå°±æ˜¯äº¤äº’çš„æ•°æ® }; //è®¢é˜…æ¶ˆæ¯ var token = PubSub.subscribe('MY TOPIC', mySubscriber); //ç¬¬ä¸€ä¸ªå‚æ•°æ¶ˆæ¯å //ç¬¬äºŒä¸ªå‚æ•°æ˜¯æ”¶åˆ°æ¶ˆæ¯åçš„å›è°ƒå‡½æ•°ï¼Œå³å¦‚æœæœ‰äººå‘å¸ƒäº†è¯¥æ¶ˆæ¯ååˆ™è¿›è¡Œå›è°ƒ //å‘å¸ƒæ¶ˆæ¯ PubSub.publish('MY TOPIC', 'hello world!'); //ç¬¬ä¸€ä¸ªå‚æ•°æ¶ˆæ¯å //ç¬¬äºŒä¸ªå‚æ•°æ˜¯ä¼ é€çš„æ•°æ® //tokenæ¥æ”¶åˆ°è®¢é˜…çš„è¿”å›å€¼ï¼Œåç»­å¯ä»¥ä½¿ç”¨ä¸‹åˆ—æ–¹å¼å–æ¶ˆè®¢é˜…ï¼Œé˜²æ­¢å†…å­˜æ³„æ¼ PubSub.unsubscribe(token); åˆ©ç”¨è¿™ä¸ªè®¢é˜…å‘å¸ƒæœºåˆ¶ï¼Œæˆ‘ä»¬å¯ä»¥å®ç°å…„å¼Ÿç»„ä»¶çš„é€šä¿¡ï¼ï¼ˆæœ‰ç‚¹åƒVueçš„eventBusï¼‰ å°æ —å­ï¼š // è®¢é˜…æ¶ˆæ¯åä¸ºSearchGitHhubçš„æ¶ˆæ¯ componentDidMount() { this.token = PubSub.subscribe('SearchGitHhub', (msg, stateObj) => { this.setState(stateObj) }); } componentWillUnmount() { // ä¸´èµ°å‰å–æ¶ˆè®¢é˜… PubSub.unsubscribe(this.token); } // å‘å¸ƒæ¶ˆæ¯åä¸ºSearchGitHhubçš„æ•°æ® PubSub.publish('SearchGitHhub', { isFirst: false, isLoading: true });","categories":[{"name":"å‰ç«¯","slug":"å‰ç«¯","permalink":"https://taylor12138.github.io/categories/%E5%89%8D%E7%AB%AF/"}],"tags":[],"author":"Hello"},{"title":"JavaScripté¢å‘å¯¹è±¡","slug":"JavaScripté¢å‘å¯¹è±¡","date":"2022-04-24T06:49:07.011Z","updated":"2022-09-19T11:11:14.289Z","comments":true,"path":"2022/04/24/javascript-mian-xiang-dui-xiang/","link":"","permalink":"https://taylor12138.github.io/2022/04/24/javascript-mian-xiang-dui-xiang/","excerpt":"","text":"1.ç¼–ç¨‹æ€æƒ³ä»‹ç»é¢å‘è¿‡ç¨‹ï¼ˆPOPï¼‰ï¼šåˆ†æè§£å†³é—®é¢˜æ‰€éœ€è¦çš„æ­¥éª¤ï¼Œç„¶åç”¨å‡½æ•°æŠŠè¿™äº›æ­¥éª¤ä¸€æ­¥ä¸€æ­¥å®ç°ï¼Œä½¿ç”¨çš„æ—¶å€™å†ä¸€æ­¥ä¸€æ­¥è°ƒç”¨å°±è¡Œäº† é¢å‘å¯¹è±¡ï¼ˆOOPï¼‰ï¼šæŠŠäº‹ç‰©åˆ†è§£æˆä¸€ä¸ªä¸ªå¯¹è±¡ï¼Œç„¶åç”±å¯¹è±¡ä¹‹é—´åˆ†å·¥åˆä½œï¼ˆæ‰¾å‡ºå¯¹è±¡å‡ºæ¥ï¼Œç„¶åå†™å‡ºè¿™äº›å¯¹è±¡çš„åŠŸèƒ½ï¼‰ é¢å‘è¿‡ç¨‹çš„æ€§èƒ½æ¯”è¾ƒé«˜ï¼Œé€‚åˆå’Œç¡¬ä»¶è”ç³»å¾ˆç´§å¯†çš„ä¸œè¥¿ï¼Œå¦‚å•ç‰‡æœºï¼Œç¼ºç‚¹æ˜¯éš¾ç»´æŠ¤ã€éš¾æ‹“å±•ã€éš¾å¤ç”¨ é¢å‘å¯¹è±¡çš„ä»£ç çµæ´»ï¼Œä»£ç å¯å¤ç”¨æ€§é«˜ï¼Œå®¹æ˜“ç»´æŠ¤å’Œå¼€å‘ï¼Œæ›´é€‚åˆå¤šäººåˆä½œçš„å¤§å‹è½¯ä»¶é¡¹ç›® é¢å‘å¯¹è±¡ï¼šå°è£…æ€§ï¼ˆç›´æ¥ä½¿ç”¨ï¼Œä¸éœ€è¦äº†è§£å†…éƒ¨ï¼‰ã€ç»§æ‰¿æ€§ã€å¤šæ€æ€§ï¼ˆé€šè¿‡ç»§æ‰¿ + ä¸åŒçš„æ‹“å±•ï¼‰ JSçš„ç±»JavaScriptåªæœ‰ä¸€äº›è¿‘ä¼¼ç±»çš„è¯­æ³•å…ƒç´ ï¼Œæ¯”å¦‚classå…³é”®å­— ä½†æ˜¯è¿™å¹¶ä¸æ„å‘³ç€JavaScriptå®é™…ä¸Šæœ‰ç±»ï¼Œä½†æ˜¯ç±»æ˜¯ä¸€ç§è®¾è®¡æ¨¡å¼ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç”¨ä¸€äº›æ–¹æ³•å®ç°è¿‘ä¼¼ç±»çš„åŠŸèƒ½ 2.é¢å‘å¯¹è±¡1.æŠ½å–å¯¹è±¡å…¬å…±å±æ€§å’Œè¡Œä¸ºç»„ç»‡å°è£…æˆä¸€ä¸ªç±»ï¼ˆclassï¼‰ class name { class body } 2.å¯¹è±¡å®ä¾‹åŒ–ï¼Œè·å–ç±»çš„å¯¹è±¡ï¼ˆå¯¹è±¡æ˜¯ç‰¹æŒ‡æŸä¸€ä¸ªï¼Œå®ä¾‹åŒ–çš„å…·ä½“å¯¹è±¡ï¼‰ var xx = new name() åˆ©ç”¨ç±»åˆ›å»ºå¯¹è±¡ å¯¹è±¡ç”±å±æ€§å’Œæ–¹æ³•æ„æˆ tipï¼š ï¼ˆ1ï¼‰classå…³é”®å­—åˆ›å»ºç±»ï¼Œç±»åä¹ æƒ¯å®šä¹‰é¦–å­—æ¯å¤§å†™ ï¼ˆ2ï¼‰constructor()æ˜¯ç±»çš„æ„é€ å‡½æ•°ï¼ˆé»˜è®¤æ–¹æ³•ï¼‰ï¼Œç”¨äºä¼ é€’å‚æ•°ï¼Œè¿”å›å®ä¾‹å¯¹è±¡ï¼Œé€šè¿‡newå‘½ä»¤ç”Ÿæˆå¯¹è±¡å®ä¾‹æ—¶ï¼Œè‡ªåŠ¨è°ƒç”¨è¯¥æ–¹æ³•ï¼Œå¦‚æœæ²¡æœ‰æ˜æ˜¾å®šä¹‰ï¼Œç±»å†…éƒ¨ä¼šè‡ªåŠ¨ç»™æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªconstructor()ï¼ˆæœ€å¥½è‡ªå·±å†™ä¸Šconstructorï¼‰ class Star { constructor(uname, age) { this.name = uname; this.age = age; } } var xxx = new Star('xxx', 20); å‡å¦‚ä¸€ä¸ªå‡½æ•°è¿›è¡Œå¤šæ¬¡ bindå‘¢ï¼Ÿ let a = {} let fn = function () { console.log(this) } fn.bind().bind(a)() // => ? ç±»é‡Œæ·»åŠ æ–¹æ³•1.åœ¨ç±»é‡Œé¢æ„é€ å‡½æ•°ï¼Œä¸éœ€è¦åŠ function 2.å¤šä¸ªæ–¹æ³•ã€å‡½æ•°ä¹‹é—´ä¸éœ€è¦æ·»åŠ é€—å·è¿›è¡Œåˆ†å‰² class Star { constructor(uname) { this.name = uname; } init() { //xxxx } } ç±»é‡Œæ·»åŠ å®ä¾‹å¯¹è±¡çš„é»˜è®¤å±æ€§åœ¨Reactï¼Œæˆ‘è¿˜å­¦åˆ°äº†å¾€ç±»é‡Œæ·»åŠ é»˜è®¤å±æ€§çš„éªšæ“ä½œï¼Œç›´æ¥å†™å…¥èµ‹å€¼è¯­å¥ å†™å…¥èµ‹å€¼è¯­å¥åï¼Œå®é™…ä¸Šå°±æ˜¯å¾€å®ä¾‹è‡ªèº«è¿½åŠ ä¸€ä¸ªå±æ€§ï¼Œå±æ€§åä¸ºaï¼Œå€¼ä¸º1ï¼Œé€‚ç”¨äºä¸€ä¸ªä¸éœ€è¦æ ¹æ®ä¼ å‚æ”¹å˜çš„å†™æ­»çš„å€¼ class Star { a = 1; } ç±»çš„ç»§æ‰¿ä½¿ç”¨extendsè¿›è¡Œç»§æ‰¿ æ³¨æ„ï¼šJavaScriptæœ¬èº«ä¸æä¾›â€œå¤šé‡ç»§æ‰¿â€åŠŸèƒ½ï¼Œæ¯•ç«Ÿæœ‰è¯¸å¤šç±»ä¼¼é’»çŸ³é—®é¢˜çš„å¤æ‚æƒ…å†µï¼Œä½†å¼€å‘è€…ä»¬è¿˜æ˜¯é€šè¿‡å…¶ä»–æ–¹æ³•å®ç°å¤šé‡ç»§æ‰¿ï¼Œæ¯”å¦‚æ··å…¥ superå…³é”®å­—ç”¨äºè®¿é—®å’Œè°ƒç”¨å¯¹è±¡çˆ¶ç±»ä¸Šçš„å‡½æ•°ï¼Œå¯ä»¥è°ƒç”¨çˆ¶ç±»çš„æ„é€ å‡½æ•°ï¼Œä¹Ÿå¯ä»¥è°ƒç”¨çˆ¶ç±»çš„æ™®é€šå‡½æ•° åœ¨constructorä¸­ï¼Œsuperå¿…é¡»åœ¨å­ç±»thisçš„ä¹‹å‰è¿›è¡Œè°ƒç”¨ï¼Œå³å¿…é¡»å…ˆè°ƒç”¨çˆ¶ç±»çš„æ„é€ å‡½æ•°ï¼Œå†ä½¿ç”¨å­ç±»çš„æ„é€ å‡½æ•° superåªèƒ½åœ¨æ´¾ç”Ÿç±»ï¼ˆå­ç±»ï¼‰çš„æ„é€ å‡½æ•°å’Œé™æ€æ–¹æ³•ä¸­ä½¿ç”¨ ä¸è¿‡è¦æ³¨æ„çš„æ˜¯ï¼šï¼ˆé”™è¯¯ç¤ºèŒƒâŒï¼‰ class Father { constructor(x, y){ this.x = x; this.y = y; } sum() { console.log(this.x + this.y); } } class Son extends Father { constructor(x, y) { this.x = x; //ä¼šæŠ¥é”™ this.y = y; //ä¼šæŠ¥é”™ } } var son = new Son(1, 2); son.sum(); //ä¼šæŠ¥é”™ ä»¥ä¸Šæœ‰ä¸¤ä¸ªé”™è¯¯ï¼š ç±»é‡Œé¢çš„è¯­æ³•ä¸­ï¼Œåªè¦ç¬¦åˆç±»ç»§æ‰¿ + å­ç±»æœ‰ä¸ªæ„é€ å‡½æ•°(constructor)åˆ™ä¸€å®šè¦è°ƒç”¨superï¼Œå¦åˆ™ä¹Ÿä¼šæŠ¥é”™ å¦‚æœåªéœ€è¦ç»§æ‰¿åˆ°xã€yçš„å±æ€§ï¼Œè‡ªèº«ä¸éœ€è¦æ–°çš„å±æ€§ï¼ˆç±»ä¼¼äºä¸‹æ–¹çš„idå±æ€§ï¼‰ï¼Œåˆ™ç”šè‡³å¯ä»¥ä¸ç”¨å†™æ„é€ å‡½æ•° æ­¤æ—¶å‚æ•°ä¼ é€’ç»™å­ç±»çš„constructorçš„xå’Œyï¼Œè€Œçˆ¶ç±»çš„sumå‡½æ•°ç”¨çš„æ˜¯çˆ¶ç±»çš„constructorçš„xå’Œy class Father { constructor(x, y){ this.x = x; this.y = y; } sum() { console.log(this.x + this.y); } } class Son extends Father { constructor(x, y, id) { //è°ƒç”¨çˆ¶ç±»çš„æ„é€ å‡½æ•° super(x, y); //å¹¶ä¸”ä¸€å®šè¦æ”¾åœ¨æœ€å¼€å¤´ï¼Œä¸èƒ½æŠŠthis.id = id æ”¾åœ¨å®ƒå‰é¢ this.id = id; } } var son = new Son(1, 2, 123); son.sum(); //success ç»§æ‰¿ä¸­å±æ€§æˆ–è€…æ–¹æ³•çš„æŸ¥æ‰¾åŸåˆ™ï¼šå°±è¿‘åŸåˆ™ åœ¨ç»§æ‰¿ä¸­ï¼Œå¦‚æœå®ä¾‹åŒ–å­ç±»è¾“å‡ºä¸€ä¸ªæ–¹æ³•ï¼Œå…ˆçœ‹å­ç±»æœ‰æ²¡æœ‰è¿™ä¸ªæ–¹æ³•ï¼Œå¦‚æœæœ‰å°±æ‰§è¡Œå­ç±»çš„ å¦‚æœæ²¡æœ‰ï¼Œå°±å»æŸ¥æ‰¾çˆ¶ç±»æœ‰æ²¡æœ‰æ­¤æ–¹æ³•ï¼Œå¦‚æœæœ‰å°±æ‰§è¡Œçˆ¶ç±»çš„ å¦‚æœå­ç±»æƒ³è¦ç›´æ¥è°ƒç”¨çˆ¶ç±»çš„æ–¹æ³•ï¼Œåˆ™ï¼š class Father { say() { //xxx } } class Son extends Father { say() { //è°ƒç”¨çˆ¶ç±»çš„æ™®é€šå‡½æ•° super.say(); } } var son = new Son(); son.say(); å¦‚æœåœ¨å­ç±»ä¸­æ·»åŠ äº†å’Œçˆ¶ç±»ç›¸åŒçš„æ–¹æ³•ï¼Œåˆ™å­ç±»çš„æ–¹æ³•ä¼šè¦†ç›–æ‰çˆ¶ç±»çš„æ–¹æ³•ï¼ˆåœ¨å½“å‰å±è”½æ‰çˆ¶ç±»çš„æ–¹æ³•ï¼‰ï¼Œæ­¤ä¸¾åŠ¨å¯ä»¥ç§°ä¸ºæ–¹æ³•çš„é‡å†™ éœ€è¦æ³¨æ„çš„ä¸‰ç‚¹1.ES6ä¸­ç±»æ²¡æœ‰å˜é‡æå‡ï¼Œæ‰€ä»¥å¿…é¡»å…ˆå®šä¹‰ç±»ï¼Œæ‰èƒ½é€šè¿‡å®ä¾‹åŒ–å¯¹è±¡ 2.ç±»é‡Œçš„å…±æœ‰å±æ€§å’Œæ–¹æ³•ä¸€å®šè¦åŠ thisè¿›è¡Œä½¿ç”¨ ï¼ˆthisæŒ‡å‘æˆ‘ä»¬åˆ›ç«‹çš„Â·å®ä¾‹åŒ–å¯¹è±¡ï¼‰ var that; class Father { constructor(uname, age) { //that = this; this.uname = uname; this.age = age; //this.sing(); åŠ å°æ‹¬å·ä¼šç«‹å³è°ƒç”¨ this.btn = document.querySelector('button'); this.btn.onclick = this.sing; this.init(); } init() {} sing() { //è¿™é‡Œçš„thisæŒ‡å‘çš„æ˜¯è°ƒç”¨è€…ï¼Œæ‰€ä»¥btnç‚¹å‡»äº‹ä»¶å‘ç”Ÿæ—¶ï¼Œthis.unameæŒ‡å‘çš„æ˜¯btnçš„uname console.log(this.uname); //æ‰€ä»¥å¯ä»¥å¤–é¢å®šä¹‰å˜é‡ï¼Œç„¶åè®©btnå›ºå®šæ‰“å°çš„æ˜¯è¯¥å¯¹è±¡çš„uname //console.log(that.uname) } } 3.ç±»æ„é€ å‡½æ•°å’Œæ„é€ å‡½æ•°æœ€ä¸»è¦çš„åŒºåˆ«æ˜¯ï¼Œç±»æ„é€ å‡½æ•°å¿…é¡»ä½¿ç”¨newï¼Œä¸ç„¶ä¼šæŠ¥é”™ï¼Œè€Œæ„é€ å‡½æ•°ä¸ç”¨newä¼šè¢«å½“ä½œæ™®é€šå‡½æ•°å»ä½¿ç”¨ staticç±»ï¼ˆclassï¼‰é€šè¿‡ static å…³é”®å­—å®šä¹‰é™æ€æ–¹æ³•ã€‚ä¸èƒ½åœ¨ç±»çš„å®ä¾‹ä¸Šè°ƒç”¨é™æ€æ–¹æ³•ï¼Œè€Œåº”è¯¥é€šè¿‡ç±»æœ¬èº«è°ƒç”¨ã€‚è¿™äº›é€šå¸¸æ˜¯å®ç”¨ç¨‹åºæ–¹æ³•ï¼Œä¾‹å¦‚åˆ›å»ºæˆ–å…‹éš†å¯¹è±¡çš„åŠŸèƒ½ã€‚ï¼ˆä¹Ÿå¯ä»¥è§£é‡Šä¸ºå®ä¾‹ä¸ŠåŠ ï¼Œè¦æƒ³ç”¨å¿…å…ˆnew , å¯¹è±¡ä¸ŠåŠ ï¼Œå¯ä»¥ ç›´æ¥ç”¨ï¼‰ class Father { static sing() { //... } } 3.æ„é€ å‡½æ•°å’ŒåŸå‹åœ¨ES6ï¼ˆECMAScript6.0ï¼‰ä¹‹å‰ï¼ŒJavaScriptæ²¡æœ‰ç±»çš„æ¦‚å¿µï¼Œåœ¨ES6ä¹‹å‰ï¼Œå¯¹è±¡ä¸æ˜¯åŸºäºç±»åˆ›å»ºçš„ï¼Œè€Œæ˜¯ç”¨ä¸€ç§ç§°ä¸ºæ„é€ å‡½æ•°çš„ç‰¹æ®Šå‡½æ•°æ¥å®šä¹‰å¯¹è±¡å’Œä»–ä»¬çš„ç‰¹å¾çš„ã€‚ åˆ›å»ºå¯¹è±¡ï¼š(JavaScriptåŸºç¡€ä¹Ÿæœ‰åšè¿‡ç¬”è®°) 1.å¯¹è±¡å­—é¢é‡ var obj = {} 2.new Object() var obj = new Object() 3.Object.create()æ–¹æ³•åˆ›å»ºä¸€ä¸ªæ–°å¯¹è±¡ï¼Œä½¿ç”¨ç°æœ‰çš„å¯¹è±¡æ¥æä¾›æ–°åˆ›å»ºçš„å¯¹è±¡çš„__proto__ è‡ªå®šä¹‰æ„é€ å‡½æ•°function æ„é€ å‡½æ•°å(){ this.å±æ€§=å€¼; this.æ–¹æ³•=function (){} } 1.ä½¿ç”¨æ„é€ å‡½æ•°ï¼Œæ„é€ å‡½æ•°åå­—é¦–å­—æ¯æœ€å¥½å¤§å†™å¦‚ function Star()2.æ„é€ å‡½æ•°ä¸éœ€è¦return3.ä½¿ç”¨å‡½æ•°new æ„é€ å‡½æ•°å();å³æ„é€ ä¸€ä¸ªå¯¹è±¡ï¼Œå¦‚new Array()ï¼Œåˆ›å»ºä¸€ä¸ªæ•°ç»„å¯¹è±¡4.å±æ€§æ–¹æ³•å‰å¿…é¡»åŠ thiså¦‚this.name=ä¼ å‚name this.song = functionï¼ˆä¼ å‚ï¼‰{} ä½†æ¯•ç«Ÿç»ˆç©¶æ˜¯å‡½æ•°ï¼Œå¦‚æœåœ¨å…¨å±€ä¸‹ç›´æ¥è°ƒç”¨è¯¥æ„é€ å‡½æ•°ï¼ˆå¹¶éä½¿ç”¨new åˆ›å»ºï¼‰ï¼Œåˆ™ä¼šå°†thisçš„å±æ€§æ·»åŠ åˆ°windowå¯¹è±¡ä¸Š å½“ç„¶ä¹Ÿå¯ä»¥ä½¿ç”¨callè°ƒç”¨ï¼Œå°†å±æ€§æ·»åŠ åˆ°å·²å°†åˆ›å»ºå¥½çš„å¯¹è±¡ä¸Š æ„é€ å‡½æ•°ä¸­å±æ€§å’Œæ–¹æ³•æˆ‘ä»¬ç§°ä¹‹ä¸ºæˆå‘˜ï¼Œæˆå‘˜å¯ä»¥æ·»åŠ  å®ä¾‹æˆå‘˜ï¼šå®ä¾‹æˆå‘˜å°±æ˜¯æ„é€ å‡½æ•°å†…éƒ¨é€šè¿‡ this æ·»åŠ çš„æˆå‘˜ ï¼Œå®ä¾‹æˆå‘˜åªèƒ½é€šè¿‡å®ä¾‹åŒ–çš„å¯¹è±¡æ¥è®¿é—®ï¼Œä¸å¯ä»¥é€šè¿‡æ„é€ å‡½æ•°è®¿é—®å®ä¾‹æˆå‘˜ï¼Œå¦‚ function Star(uname){ this.uname = uname; } let star = new Star('xxx'); console.log(star.uname); é™æ€æˆå‘˜ï¼šåœ¨æ„é€ å‡½æ•°æœ¬èº«ä¸Šæ·»åŠ çš„æˆå‘˜ï¼Œé™æ€æˆå‘˜åªèƒ½é€šè¿‡æ„é€ å‡½æ•°æ¥è®¿é—®ï¼Œä¸èƒ½é€šè¿‡å¯¹è±¡æ¥è®¿é—®ï¼Œå¦‚ function Star() {}; Star.sex = 'male'; console.log(Star.sex); æ„é€ å‡½æ•°è™½ç„¶å¥½ç”¨ï¼Œä½†æ˜¯å­˜åœ¨æµªè´¹å†…å­˜çš„é—®é¢˜ æ„é€ å‡½æ•°åŸå‹å¯¹è±¡prototypeæ„é€ å‡½æ•°é€šè¿‡åŸå‹åˆ†é…çš„å‡½æ•°æ˜¯æ‰€æœ‰å¯¹è±¡æ‰€å…±äº«çš„ JavaScriptè§„å®šï¼Œæ¯ä¸ªæ„é€ å‡½æ•°éƒ½æœ‰ä¸€ä¸ªprototypeå±æ€§ï¼ŒæŒ‡å‘å¦ä¸€ä¸ªå¯¹è±¡ï¼Œæ³¨æ„è¿™ä¸ªprototypeï¼ˆåŸå‹ï¼‰å°±æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡çš„æ‰€æœ‰å±æ€§å’Œæ–¹æ³•ï¼Œéƒ½ä¼šè¢«æ„é€ å‡½æ•°æ‰€æ‹¥æœ‰ å› æ­¤ï¼Œæˆ‘ä»¬æŠŠé‚£äº›ä¸å˜çš„æ–¹æ³•ï¼Œç›´æ¥å®šä¹‰åœ¨prototypeå¯¹è±¡ä¸Šï¼Œè¿™æ ·æ‰€æœ‰å¯¹è±¡çš„å®ä¾‹å°±å¯ä»¥å…±äº«è¿™ä¸ªæ–¹æ³• ä½¿ç”¨æ–¹æ³•ï¼š function Star(uname){ this.uname = uname; } //ç¬¬ä¸€ç§å†™æ³•ï¼š Star.prototype.sing = function() {} // Star.prototype.sex = 'male'; //ç¬¬äºŒç§å†™æ³•ï¼šï¼ˆä½†è¿™ç§æ–¹æ³•ä¸èƒ½é€‚ç”¨äºArrayã€Objectç­‰ï¼Œä¼šè¦†ç›–åŸæ¥çš„å®šå‹çš„æ–¹æ³•ï¼‰ Star.prototype = { constructor: Star, //ä¸å¯çœç•¥ï¼Œå› ä¸ºè¿™ç§å†™æ³•è¦†ç›–æ‰åŸæ¥çš„constructoræ–¹æ³• sing: function() {}, movie: function() {} } æ‰€ä»¥ä¸€èˆ¬æƒ…å†µï¼Œæˆ‘ä»¬çš„å…¬å…±å±æ€§å®šä¹‰åˆ°æ„é€ å‡½æ•°é‡Œé¢ï¼Œå…¬å…±çš„æ–¹æ³•æˆ‘ä»¬æ”¾åˆ°åŸå‹å¯¹è±¡çš„èº«ä¸Š æ³¨æ„ï¼šè™½ç„¶éšæ—¶èƒ½ç»™åœ†å½¢æ·»åŠ å±æ€§å’Œæ–¹æ³•ï¼Œå¹¶èƒ½ç«‹å³ååº”åœ¨æ‰€æœ‰å¯¹è±¡å®ä¾‹ä¸Šï¼Œä½†è¿™å’Œé‡å†™æ•´ä¸ªåŸå‹æ˜¯ä¸¤å›äº‹ï¼Œå¦‚æœåŸå‹çš„ä¿®æ”¹æ˜¯åœ¨åˆ›å»ºå®ä¾‹ä¹‹å‰ï¼Œåˆ™å®ä¾‹å¼•ç”¨çš„ä»æ˜¯æœ€åˆçš„åŸå‹ let friend1 = new Person(); Person.prototype = { constructor:Person, saySomething(){ console.log(\"yes!\"); } } let friend2 = new Person(); friend1.saySomething() //é”™è¯¯ friend2.saySomething() //é€šè¿‡ å¯¹è±¡ä¸­çš„prototypeä½¿ç”¨for in éå†å¯¹è±¡æ—¶åŸç†å’ŒæŸ¥æ‰¾ [[prototype]] é“¾ç±»ä¼¼ï¼Œä»»ä½•å¯ä»¥é€šè¿‡åŸå‹é“¾è®¿é—®åˆ°çš„å±æ€§ï¼ˆenumberableï¼‰éƒ½ä¼šè¢«æšä¸¾ï¼Œè€Œä½¿ç”¨ in æ“ä½œç¬¦æ¥æ£€æŸ¥å±æ€§åœ¨å¯¹è±¡ä¸­æ˜¯å¦å­˜åœ¨æ—¶ï¼ŒåŒæ ·ä¼šæŸ¥æ‰¾å¯¹è±¡çš„æ•´æ¡åŸå‹é“¾ const obj = { a: 2, }; const myobj = Object.create(obj); for (k in myobj) { console.log(k); } å±æ€§å±è”½ å¯¹äºä»¥ä¸Šä»£ç ï¼Œå¦‚æœæ·»åŠ  myobj.foo = \"bar\" ä¼šå‡ºç°ä»¥ä¸‹å‡ ç§æƒ…å†µ fooä¸å­˜åœ¨äºmyobjå’Œ [[prototype]]ä¸Šï¼Œç›´æ¥æŠŠfooæ·»åŠ åˆ°myobjèº«ä¸Šã€‚ fooä»…å­˜åœ¨äºåŸå‹é“¾ [[prototype]] ä¸Š å¦‚æœæ˜¯åªè¯»çš„ï¼Œè¿›è¡Œäº†èµ‹å€¼åˆ™å•¥ä¹Ÿä¸å¹²ï¼ˆä¸¥æ ¼æ¨¡å¼ä¸‹ä¼šæŠ¥é”™ï¼‰ å¦‚æœå­˜åœ¨ä¸€ä¸ªsetterï¼Œåˆ™æ‰§è¡Œsetter å…¶ä½™æƒ…å†µåˆ™åœ¨myobjæœ¬èº«æ·»åŠ ä¸€ä¸ªfooï¼Œè¿™ä¸ªfooä¸ºå±è”½å±æ€§ fooæ—¢å­˜åœ¨äº myobjä¸Šï¼Œä¹Ÿå­˜åœ¨ fooä¸Šï¼Œå‘ç”Ÿå±è”½ï¼Œmyobjä¸­åŒ…å«çš„fooå±æ€§ä¼šå±è”½ä¸Šå±‚åŸå‹é“¾çš„æ‰€æœ‰fooå±æ€§ ç›¸äº’å§”æ‰˜ ä½ æ— æ³•åœ¨ä¸¤ä¸ªæˆ–ä¸¤ä¸ªä»¥ä¸Šäº’ç›¸ï¼ˆåŒå‘ï¼‰å§”æ‰˜çš„å¯¹è±¡ä¹‹é—´åˆ›å»ºå¾ªç¯å§”æ‰˜ï¼Œè¿™ç§æ–¹æ³•æ˜¯è¢«ç¦æ­¢çš„ã€‚å°½ç®¡ç›¸äº’å§”æ‰˜ç†è®ºä¸Šå¯ä»¥æ­£å¸¸å·¥ä½œï¼Œå¹¶ä¸”åœ¨æŸäº›æƒ…å†µä¸‹éå¸¸æœ‰ç”¨ï¼Œä½†æ˜¯ä¹‹æ‰€ä»¥è¦ç¦æ­¢ç›¸äº’å§”æ‰˜ï¼Œæ˜¯ä¸ºäº†æ›´åŠ é«˜æ•ˆï¼Œä¹Ÿä¸ç”¨æ£€æŸ¥æ˜¯å¦ä¸ºæ— é™å¾ªç¯å¼•ç”¨ã€‚ å¯¹è±¡åŸå‹: __proto__å¯¹è±¡éƒ½ä¼šæœ‰ä¸€ä¸ªå±æ€§ __proto__ æŒ‡å‘æ„é€ å‡½æ•°çš„prototypeåŸå‹å¯¹è±¡ï¼Œä¹‹æ‰€ä»¥æˆ‘ä»¬å¯¹è±¡å¯ä»¥ä½¿ç”¨æ„é€ å‡½æ•°prototypeåŸå‹å¯¹è±¡çš„å±æ€§å’Œæ–¹æ³•ï¼Œå°±æ˜¯å› ä¸º __proto__ çš„å­˜åœ¨ å®ä¾‹åŒ–çš„å¯¹è±¡.__proto__ === æ„é€ å‡½æ•°å.prototype è¿”å›true åœ¨ç¤¾åŒºé‡Œå…¶å®ä¹Ÿå› ä¸ºåŒä¸‹åˆ’çº¿ï¼Œè¢«ç§°ä¸º â€œç¬¨è›‹protoâ€ constructoræ„é€ å‡½æ•°å¯¹è±¡åŸå‹ï¼ˆ__proto__ï¼‰å’Œæ„é€ å‡½æ•°åŸå‹å¯¹è±¡ï¼ˆprototypeï¼‰é‡Œé¢éƒ½æœ‰ä¸€ä¸ªconstructorå±æ€§ï¼Œconstructoræˆ‘ä»¬ç§°ä¸ºæ„é€ å‡½æ•°ï¼Œå› ä¸ºå®ƒæŒ‡å›æ„é€ å‡½æ•°æœ¬èº« æ³¨æ„ï¼Œå®é™…ä¸Š å®ä¾‹åŒ–å¯¹è±¡.constructoræ˜¯è¢«å§”æ‰˜ç»™äº† prototypeï¼Œæ˜¯åŸå‹é“¾è®¿é—®åˆ°çš„å±æ€§ï¼Œè€Œå®ä¾‹åŒ–å¯¹è±¡æœ¬èº«æ²¡æœ‰è¿™ä¸ªå±æ€§ ä¸»è¦ç›®çš„ï¼šç”¨äºè®°å½•è¯¥å¯¹è±¡å¼•ç”¨äºå“ªä¸ªæ„é€ å‡½æ•°ï¼ˆå¾ˆå¤šæƒ…å†µä¸‹æˆ‘ä»¬éœ€è¦ç”¨å®ƒæ¥æŒ‡å›åŸæ¥çš„æ„é€ å‡½æ•°ï¼‰ ä½†æ˜¯ã€Šä½ ä¸çŸ¥é“çš„JavaScriptã€‹å‘Šè¯«ï¼š constructor æ˜¯ä¸€ä¸ªä¸å¯é å¹¶ä¸”ä¸å®‰å…¨çš„å¼•ç”¨ï¼Œå®ƒä¸ä¸€å®šä¼šæŒ‡å‘é»˜è®¤çš„å‡½æ•°å¼•ç”¨ï¼Œé€šå¸¸æ¥è¯´å°½é‡é¿å…è¿™äº›å¼•ç”¨ åŸå‹é“¾ä»»ä½•æ„é€ å‡½æ•°åŸå‹å¯¹è±¡prototypeï¼Œå®ƒä½œä¸ºä¸€ä¸ªå¯¹è±¡ï¼Œä¹Ÿæœ‰å®ƒè‡ªå·±çš„å¯¹è±¡åŸå‹ __proto__ ï¼Œè€Œæ­¤æ—¶åŸå‹å¯¹è±¡çš„ __proto__ æŒ‡å‘çš„æ˜¯Object.prototypeï¼Œ å³æŸæ„é€ å‡½æ•°å.prototype.__proto__ === Object.prototype è€Œæˆ‘ä»¬Objectä¹Ÿæœ‰prototypeåŸå‹å¯¹è±¡ï¼Œè€Œå®ƒä½œä¸ºä¸€ä¸ªå¯¹è±¡ï¼Œä¹Ÿæœ‰å®ƒè‡ªå·±çš„å¯¹è±¡åŸå‹ __proto__ ï¼Œè€Œæ­¤æ—¶æŒ‡å‘nullï¼ˆåˆ°è¾¾äº†ç»ˆç‚¹ï¼‰ å³Object.prototype.__proto__ === null JavaScriptæˆå‘˜æŸ¥æ‰¾æœºåˆ¶ï¼š æ‰€ä»¥åœ¨æˆå‘˜æŸ¥æ‰¾æ—¶ï¼Œå…ˆæŸ¥æ‰¾æœ€åº•å±‚ï¼Œæ²¡æœ‰åˆ™æ ¹æ®å®ƒ çš„__proto__æŸ¥æ‰¾è‡³ä»–çš„åŸå‹å¯¹è±¡ï¼Œçœ‹çœ‹æœ‰æ²¡æœ‰è¯¥æˆå‘˜ï¼Œæ²¡æœ‰çš„è¯ç»§ç»­ä¸€å±‚ä¸€å±‚å¾€ä¸ŠæŸ¥æ‰¾ï¼Œå¦‚æœæ‰¾ä¸åˆ°è¯¥æˆå‘˜ ï¼Œæœ€åè¿”å›undefined (undefinedæ˜¯ç”±nullæ´¾ç”Ÿè€Œæ¥çš„) è€Œæ ¹æ®æŸ¥æ‰¾è§„åˆ™ï¼Œä½¿ç”¨å°±è¿‘åŸåˆ™æ¥å¤„ç†é‡å¤æˆå‘˜å®šä¹‰é—®é¢˜ï¼ˆå³å…ˆæ‰¾åˆ°ï¼Œå…ˆä½¿ç”¨ï¼‰ ï¼ˆè¿™é‡Œæœªæ ‡å‡ºå®ä¾‹å¯¹è±¡ constructor æŒ‡å‘ æ„é€ å‡½æ•°ï¼‰ åŒæ—¶è¦æ³¨æ„çš„æ˜¯ï¼š console.log(Object.__proto__); //Function.prototype console.log(Object.__proto__.__proto__); //Object.prototype console.log(Object.__proto__.__proto__.__proto__); //null æ‹“å±•å†…ç½®å¯¹è±¡å¯ä»¥é€šè¿‡åŸå‹å¯¹è±¡ï¼Œå¯¹åŸæ¥çš„å†…ç½®å¯¹è±¡è¿›è¡Œæ‹“å±•è‡ªå®šä¹‰çš„æ–¹æ³•ï¼Œæ¯”å¦‚ç»™æ•°ç»„å¢åŠ è‡ªå®šä¹‰æ±‚å¶æ•°å’Œçš„åŠŸèƒ½ //åœ¨ArrayåŸå‹å¯¹è±¡ä¸Šè¿½åŠ å‡½æ•°ï¼Œä¸èƒ½é‡‡å–Array.prototype = {}å½¢å¼ Array.prototype.sum = function() { let sum = 0; for(let i = 0; i &lt; this.length; i++){ sum+=this[i]; } return sum; } 4.ç»§æ‰¿åœ¨ES6ä¹‹å‰æ²¡æœ‰ç»™æˆ‘ä»¬æä¾›extendsï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æ„é€ å‡½æ•°+åŸå‹å¯¹è±¡æ¨¡æ‹Ÿå®ç°ç»§æ‰¿ï¼Œè¢«ç§°ä¸ºç»„åˆç»§æ‰¿ call()fun.call(thisArg, arg1, arg2....) ï¼ˆarg né‚£äº›æŒ‡çš„æ˜¯ä¼ é€’çš„å…¶ä»–å‚æ•°ï¼‰ åŠŸèƒ½ï¼šè°ƒç”¨è¿™ä¸ªå‡½æ•°ï¼Œå¹¶ä¸”ä¿®æ”¹å‡½æ•°è¿è¡Œæ—¶thisçš„æŒ‡å‘ thisArg: å½“å‰è°ƒç”¨å‡½æ•°çš„thisçš„æŒ‡å‘å¯¹è±¡ï¼ˆä¸€èˆ¬åœ¨JavaScriptä¸­ç›´æ¥è°ƒç”¨å‡½æ•°æ—¶ï¼Œå‡½æ•°çš„thisæŒ‡å‘windowï¼‰ ES5ç»§æ‰¿çš„ä¸¤å¤§æ­¥å€Ÿç”¨æ„é€ å‡½æ•°ç»§æ‰¿çˆ¶ç±»å‹çš„å±æ€§ æ ¸å¿ƒåŸç†ï¼šé€šè¿‡call() æŠŠçˆ¶ç±»å‹çš„thisæŒ‡å‘å­ç±»å‹çš„thisï¼Œè¿™æ ·å°±å®ç°äº†å­ç±»å‹ç»§æ‰¿çˆ¶ç±»å‹çš„å±æ€§ åˆ©ç”¨åŸå‹å¯¹è±¡ç»§æ‰¿çˆ¶ç±»å‹çš„æ–¹æ³• å®ç°å¦‚ä¸‹ï¼š function Father(uname, age) { this.uname = uname; this.age = age; } Father.prototype.teach = function () { console('father') } //å€Ÿç”¨çˆ¶æ„é€ å‡½æ•°ç»§æ‰¿å±æ€§ function Son(uname, age) { Father.call(this, uname, age); } // è¿™æ ·ç›´æ¥èµ‹å€¼ä¼šå‡ºé—®é¢˜ï¼Œå› ä¸ºæ˜¯èµ‹å€¼çˆ¶åŸå‹å¯¹è±¡çš„åœ°å€ï¼Œå¦‚æœä¿®æ”¹äº†å­åŸå‹å¯¹è±¡ï¼Œçˆ¶åŸå‹å¯¹è±¡ä¹Ÿä¼šéšä¹‹æ”¹å˜ // Son.prototype = Father.prototype; Ã— // æ­£ç¡®æ–¹æ³•ï¼š // å€Ÿç”¨çˆ¶æ„é€ å‡½æ•°ç»§æ‰¿æ–¹æ³• Son.prototype = new Father(); // å¦‚æœåˆ©ç”¨äº†å¯¹è±¡å½¢å¼ä¿®æ”¹äº†åŸå‹å¯¹è±¡ï¼Œåˆ«å¿˜äº†åˆ©ç”¨constructoræŒ‡å›åŸæ¥çš„æ„é€ å‡½æ•° Son.prototype.constructor = Son; Son.prototype.exam = function () { console('son') } let son = new Son('xxx', 18); console.log(son); ç»„åˆç»§æ‰¿=åŸå‹ç»§æ‰¿+æ„é€ å‡½æ•°ç»§æ‰¿ï¼ˆç»“åˆä¸¤è€…çš„ä¼˜ç‚¹ï¼‰ ç»„åˆç»§æ‰¿æ–¹å¼çš„ç¼ºç‚¹æ˜¯ï¼š åŸå‹ä¸­åŒ…å«çš„å¼•ç”¨å€¼ä¼šåœ¨æ‰€æœ‰å®ä¾‹ä¸­å…±äº«ï¼Œè€Œä½¿ç”¨ Son.prototype = new Father();çš„æ–¹å¼ç»§æ‰¿æ—¶ï¼ŒSon.prototype æ˜¯Fatherç±»çš„ä¸€ä¸ªå®ä¾‹ï¼ŒFatherçš„æ‰€æœ‰å±æ€§éƒ½ä¼šè¢«ç»§æ‰¿ä¸‹æ¥ï¼Œè€Œè¿™äº›å±æ€§éƒ½ä¼šè¢«å½“æˆå…±äº«å±æ€§ ç»„åˆç»§æ‰¿ä¼šæ„é€ å‡½æ•°å®ä¾‹åŒ–äº†ä¸¤æ¬¡ æ›´ä¼˜è§£æ³•ä¸ºå¯„ç”Ÿç»„åˆç»§æ‰¿ï¼š ä½¿ç”¨ Object.create()æ–¹æ³•æ¥å®ç°ï¼Œä»¥ä¸‹ä¸ºå¯„ç”Ÿç»„åˆç»§æ‰¿ â€” å®Œç¾æ–¹å¼ function Shape() { this.x = 0; this.y = 0; } Shape.prototype.move = function(x, y) { //... }; // Rectangle - å­ç±»(subclass) function Rectangle() { Shape.call(this); // call super constructor. } // å­ç±»ç»­æ‰¿çˆ¶ç±» Rectangle.prototype = Object.create(Shape.prototype); Rectangle.prototype.constructor = Rectangle; ä½†å®é™…ä¸Šä½¿ç”¨ Object.create() è¦æŠ›å¼ƒæ‰é»˜è®¤çš„ Rectangle.prototype ï¼Œè€ŒES6å¼€å§‹ä¹‹åï¼Œå¯ä»¥é€šè¿‡ Object.setPrototypeOf(Rectangle.prototype, Shape.prototype) ç›´æ¥ä¿®æ”¹åŸæ¥çš„åŸå‹å¯¹è±¡ï¼ˆã€Šä½ ä¸çŸ¥é“çš„JavaScriptã€‹æ¨èï¼‰ åˆåˆåˆä½†æ˜¯MDNå¯¹äº Object.setPrototypeOf æœ‰ä¸ªè­¦å‘Š è­¦å‘Š: ç”±äºç°ä»£ JavaScript å¼•æ“ä¼˜åŒ–å±æ€§è®¿é—®æ‰€å¸¦æ¥çš„ç‰¹æ€§çš„å…³ç³»ï¼Œæ›´æ”¹å¯¹è±¡çš„ [[Prototype]]åœ¨å„ä¸ªæµè§ˆå™¨å’Œ JavaScript å¼•æ“ä¸Šéƒ½æ˜¯ä¸€ä¸ªå¾ˆæ…¢çš„æ“ä½œã€‚å…¶åœ¨æ›´æ”¹ç»§æ‰¿çš„æ€§èƒ½ä¸Šçš„å½±å“æ˜¯å¾®å¦™è€Œåˆå¹¿æ³›çš„ï¼Œè¿™ä¸ä»…ä»…é™äº obj.__proto__ = ... è¯­å¥ä¸Šçš„æ—¶é—´èŠ±è´¹ï¼Œè€Œä¸”å¯èƒ½ä¼šå»¶ä¼¸åˆ°ä»»ä½•ä»£ç ï¼Œé‚£äº›å¯ä»¥è®¿é—®ä»»ä½•[[Prototype]]å·²è¢«æ›´æ”¹çš„å¯¹è±¡çš„ä»£ç ã€‚å¦‚æœä½ å…³å¿ƒæ€§èƒ½ï¼Œä½ åº”è¯¥é¿å…è®¾ç½®ä¸€ä¸ªå¯¹è±¡çš„ [[Prototype]]ã€‚ç›¸åï¼Œä½ åº”è¯¥ä½¿ç”¨ Object.create()æ¥åˆ›å»ºå¸¦æœ‰ä½ æƒ³è¦çš„[[Prototype]]çš„æ–°å¯¹è±¡ã€‚ æ‰€ä»¥è¿˜æ˜¯è€è€å®å®ç”¨ Object.create() å¯¹è±¡å…³è”æ¥å®ç°ç»§æ‰¿ä»¥ä¸Šä¸ºé¢å‹å¯¹è±¡çš„è®¾è®¡æ¨¡å¼ï¼ˆå¼ºè°ƒå®ä½“å’Œå®ä½“é—´çš„å…³ç³»ï¼‰ ä»¥ä¸‹ä¸ºã€Šä½ ä¸çŸ¥é“çš„JavaScriptã€‹ä¸­è°ˆåŠçš„å¯¹è±¡å…³è”çš„ç»§æ‰¿å®ç°æ–¹å¼ï¼Œä¹¦ä¸­è¯´åˆ°è¯¥æ€ç»´æ¨¡å¼æ›´åŠ ç®€æ´ï¼Œå› ä¸ºè¿™ç§ä»£ç åªå…³æ³¨ä¸€ä»¶äº‹ï¼šå¯¹è±¡ä¹‹é—´çš„å…³è”å…³ç³»ã€‚å¹¶ä¸”çœ‹ä¸Šå»è¿™ç§å¯¹è±¡å½¢å¼è®©æ„é€ å’Œåˆå§‹åŒ–åˆ†å¼€äº†ï¼Œä½†æ˜¯è®¸å¤šæƒ…å†µä¸‹è¿™ä¸¤æ­¥åˆ†æ¥çš„è¯æ›´åŠ çµæ´» è€Œå¯¹æ¯”é¢å‘å¯¹è±¡æ¨¡å¼ï¼Œæœ‰æ—¶å´ä¸å¾—ä¸ä½¿ç”¨æ˜¾å¼ä¼ªå¤šæ€çš„æ–¹æ³•è°ƒç”¨ï¼Œæ¯”å¦‚è¿™ç§ä»£ç ï¼ŒShape.prototype.move.call(xxx)ï¼ˆé™¤éç”¨ä¸Šes6æ–°å¢çš„ classï¼Œä½¿ç”¨superæ¥è°ƒç”¨ ï¼‰ï¼Œå¹¶ä¸”è¿˜è¦å¤¹æ‚ç€newä¹‹ç±»çš„ const Shape = { init(x, y){ this.x = x; this.y = y; }, move(x, y){ //... } } const Rectangle = Object.create(Shape); Rectangle.ohterFunction = function(){ //.. } // å¯¹è±¡å…³è”çš„â€œå®ä¾‹â€ const r1 = Object.create(Rectangle); r1.init(1, 2) ç±»çš„æœ¬è´¨ï¼ˆclassé™·é˜±ï¼‰classæœ¬è´¨è¿˜æ˜¯functionï¼ˆç”¨ typeof æŸ¥çœ‹ï¼‰ï¼Œå®ƒåªæ˜¯å§”æ‰˜ [[prototype]]æœºåˆ¶çš„ä¸€ç§è¯­æ³•ç³– ä½†æ˜¯æ–°çš„classå†™æ³•åªæ˜¯è®©å¯¹è±¡åŸå‹çš„å†™æ³•æ›´åŠ æ¸…æ™°ï¼Œæ›´åƒé¢å‘å¯¹è±¡ç¼–ç¨‹çš„è¯­æ³• å’Œæ„é€ å‡½æ•°ç›¸åŒç‚¹ï¼š 1.ç±»ä¹Ÿæœ‰åŸå‹å¯¹è±¡prototypeï¼Œè€Œprototypeé‡Œçš„constructorä¹Ÿæ˜¯æŒ‡å›ç±»çš„æœ¬èº« 2.ç±»ä¹Ÿå¯ä»¥åˆ©ç”¨åŸå‹å¯¹è±¡æ·»åŠ æ–¹æ³• 3.ç±»åˆ›å»ºçš„å®ä¾‹å¯¹è±¡ä¸­çš„ __proto__ åŸå‹æŒ‡å‘ç±»çš„åŸå‹å¯¹è±¡ classé™·é˜±ï¼š ä¹Ÿå°±æ˜¯è¯´ï¼Œclasså¹¶ä¸ä¼šåƒä¼ ç»Ÿçš„é¢å‘ç±»è¯­è¨€ä¸€èˆ¬ï¼Œåœ¨å£°æ˜æ—¶é™æ€å¤åˆ¶æ‰€æœ‰è¡Œä¸ºï¼Œå¦‚æœä½ æœ‰æ„æ— æ„ä¿®æ”¹äº†æŸä¸ªçˆ¶ç±»çš„æ–¹æ³•ï¼Œå®ƒçš„å­ç±»å’Œæ‰€æœ‰å®ä¾‹éƒ½ä¼šå—åˆ°å½±å“","categories":[{"name":"å‰ç«¯","slug":"å‰ç«¯","permalink":"https://taylor12138.github.io/categories/%E5%89%8D%E7%AB%AF/"}],"tags":[],"author":"Hello"},{"title":"JavaScriptè¿›é˜¶ES5","slug":"JavaScriptè¿›é˜¶ES5","date":"2022-04-24T06:47:00.674Z","updated":"2022-12-07T02:28:16.871Z","comments":true,"path":"2022/04/24/javascript-jin-jie-es5/","link":"","permalink":"https://taylor12138.github.io/2022/04/24/javascript-jin-jie-es5/","excerpt":"","text":"1.ES5éƒ¨åˆ†çš„æ–¹æ³•æ•°ç»„æ–¹æ³•1.forEach() ï¼š arr.forEach(function(vlaue, index, [array])) åˆ†åˆ«å¯¹åº”æ•°ç»„çš„valueï¼ˆå€¼ï¼‰ã€indexï¼ˆç´¢å¼•å·ï¼‰ã€æ•°ç»„æœ¬èº« ï¼ˆéå†æ•°ç»„çš„å…¨éƒ¨å…ƒç´ ï¼Œå³ä½¿return trueä¹Ÿä¸ä¼šç»ˆæ­¢è¿­ä»£ï¼‰ ï¼ˆå› ä¸ºforEachæœ¬è´¨æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œå‚æ•°æ˜¯ä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œå›è°ƒå‡½æ•°çš„returnåªæ˜¯ç»ˆæ­¢äº†å›è°ƒå‡½æ•°è€Œå·²ï¼Œä¸æ˜¯ç»ˆæ­¢forEachï¼Œè€ŒforEachå†…éƒ¨åº”è¯¥æ˜¯å¤šæ¬¡è°ƒç”¨äº†é‚£ä¸ªå‡½æ•°ï¼‰ åœ¨ forEachéå†ä¸­ï¼Œæ— æ³•æ”¹å˜itemï¼ˆåŸæ•°ç»„é‡Œçš„å…ƒç´ ï¼Œå¦‚æœå…ƒç´ æ˜¯æ•°ç»„ or å¯¹è±¡ï¼Œé‚£å¦å½“åˆ«è®º 0.0 ï¼‰ // æ•°ç»„æ”¹å€¼ let arr = [1,3,5,7,9]; arr.forEach(function(item){ item = 30; }) console.log(arr); //è¾“å‡º [1, 3, 5, 7, 9] let arr = [{ a: 1 }, { a: 2 }, { a: 3 }]; let arr2 = [[1], [1], [1]]; arr.forEach(function (item) { item.a = 2; }) arr2.forEach(item => { item.push(2) }) console.log(arr); //[ { a: 2 }, { a: 2 }, { a: 2 } ] console.log(arr2); //[ [ 1, 2 ], [ 1, 2 ], [ 1, 2 ] ] å¦‚æœä½ ç¡¬è¦æ”¹å˜itemï¼Œä¹Ÿä¸æ˜¯ä¸å¯ä»¥ï¼Œåªæ˜¯æ–¹æ³•è¦ç¨ç¨æ”¹åŠ¨ï¼Œä½¿ç”¨å¼•ç”¨çš„æ–¹å¼è¿›è¡Œä¿®æ”¹ // æ•°ç»„æ”¹å€¼ let arr = [1,3,5,7,9]; arr.forEach(function(item,index,arr){ arr[index] = 30; }) console.log(arr); //è¾“å‡º (5) [30, 30, 30, 30, 30] 2.filter(): filter() æ–¹æ³•åˆ›å»ºä¸€ä¸ªæ–°æ•°ç»„ï¼Œæ–°æ•°ç»„ä¸­çš„å…ƒç´ æ˜¯é€šè¿‡æ£€æŸ¥æŒ‡å®šæ•°ç»„ä¸­ç¬¦åˆæ¡ä»¶çš„æ‰€æœ‰å…ƒç´ ï¼Œä¸»è¦ç”¨äºç­›é€‰æ•°ç»„ ï¼ˆæ³¨æ„å®ƒç›´æ¥è¿”å›ä¸€ä¸ªæ–°æ•°ç»„ï¼‰ array.filter(function(currentValue, index, [arr])) åˆ†åˆ«å¯¹åº”currentValueï¼ˆæ•°ç»„å½“å‰é¡¹çš„å€¼ï¼‰ï¼Œindexï¼ˆç´¢å¼•å·ï¼‰ï¼Œarrï¼ˆæ•°ç»„æœ¬èº«ï¼‰ï¼Œå®ƒçš„å›è°ƒå‡½æ•°è¿”å›çš„å¿…é¡»æ˜¯ä¸€ä¸ªBooleanå€¼ï¼Œè¿”å›trueè‡ªåŠ¨å°†valueåŠ å…¥æ–°æ•°ç»„ä¸­ï¼Œfalseåˆ™è¿‡æ»¤æ‰ï¼Œæœ€åæ•´ä½“è¿”å›ä¸€ä¸ªæ–°æ•°ç»„ var newArr = arr.filter(function(value, index) { return value >= 20; }) find()æ–¹æ³•æœ‰ç‚¹ç±»ä¼¼filterï¼Œåªä¸è¿‡è¿”å›çš„ä¸æ˜¯æ–°æ•°ç»„ï¼Œè€Œæ˜¯è¿”å›ç¬¦åˆæµ‹è¯•æ¡ä»¶çš„ç¬¬ä¸€ä¸ªæ•°ç»„å…ƒç´ å€¼ è€Œå¯¹åº”çš„findIndex()æ–¹æ³•è¿”å›æ•°ç»„ä¸­æ»¡è¶³æä¾›çš„æµ‹è¯•å‡½æ•°çš„ç¬¬ä¸€ä¸ªå…ƒç´ çš„ç´¢å¼•ã€‚è‹¥æ²¡æœ‰æ‰¾åˆ°å¯¹åº”å…ƒç´ åˆ™è¿”å›-1ã€‚ 3.some() ï¼šsome()æ–¹æ³•ç”¨äºæ£€æµ‹æ•°ç»„ä¸­çš„å…ƒç´ æ˜¯å¦ å­˜åœ¨ æ»¡è¶³æŒ‡å®šæ¡ä»¶ï¼Œé€šä¿—ç‚¹å°±æ˜¯æŸ¥æ‰¾æ•°ç»„ä¸­æ˜¯å¦æœ‰æ»¡è¶³æ¡ä»¶çš„å…ƒç´ ï¼Œæ‰¾åˆ°ç¬¬ä¸€ä¸ªæ»¡è¶³æ¡ä»¶çš„å…ƒç´ åˆ™åœæ­¢ ï¼ˆæ³¨æ„å®ƒè¿”å›çš„æ˜¯å¸ƒå°”å€¼ï¼‰åœ¨someé‡Œè®¾ç½®return true ä»¥ç»ˆæ­¢éå† array.some(function(currentValue, index, [arr])) åˆ†åˆ«å¯¹åº”currentValueï¼ˆæ•°ç»„å½“å‰é¡¹çš„å€¼ï¼‰ï¼Œindexï¼ˆç´¢å¼•å·ï¼‰ï¼Œarrï¼ˆæ•°ç»„æœ¬èº«ï¼‰ 4.map() æ–¹æ³•è¿”å›ä¸€ä¸ªæ–°æ•°ç»„ï¼Œæ•°ç»„ä¸­çš„å…ƒç´ ä¸ºåŸå§‹æ•°ç»„å…ƒç´ è°ƒç”¨å‡½æ•°å¤„ç†åçš„å€¼ã€‚å’ŒforEachç›¸ä¼¼ï¼Œä¸åŒåœ¨äºï¼š â€‹ å¦‚æœæ›´æ”¹æ•°ç»„å†…çš„å€¼ï¼ŒforEach ä¸èƒ½ç¡®ä¿æ•°ç»„çš„ä¸å˜æ€§ã€‚è¿™ä¸ªæ–¹æ³•åªæœ‰åœ¨ä½ ä¸æ¥è§¦é‡Œé¢çš„ä»»ä½•å€¼æ—¶ï¼Œæ‰èƒ½ä¿è¯ä¸å˜æ€§ã€‚ â€‹ ç”±äºå®ƒä»¬ä¹‹é—´çš„ä¸»è¦åŒºåˆ«åœ¨äºæ˜¯å¦æœ‰è¿”å›å€¼ï¼Œæ‰€ä»¥ä½ ä¼šå¸Œæœ›ä½¿ç”¨ map æ¥åˆ¶ä½œä¸€ä¸ªæ–°çš„æ•°ç»„ï¼Œè€Œä½¿ç”¨ forEach åªæ˜¯ä¸ºäº†æ˜ å°„åˆ°æ•°ç»„ä¸Š(ä¿®æ”¹åŸæ¥çš„æ•°ç»„) è¿”å›å€¼åŠ å…¥æ–°æ•°ç»„ä¸­ let newarr = arr.map(function(value, index) { return value * 2; }) mapçš„ä¸å˜æ€§ï¼šå½“æ•°ç»„ä¸ºåŸºç¡€ç±»å‹æ—¶åŸæ•°ç»„ä¸å˜ let array=[1,2,3,4,5] let newArray=array.map((item) => item*2) console.log(array); // [1,2,3,4,5] console.log(newArray);//[2, 4, 6, 8, 10] å½“æ•°ç»„ä¸ºå¼•ç”¨ç±»å‹æ—¶åŸæ•°ç»„å‘ç”Ÿæ”¹å˜ï¼š let array = [{ name: 'Anna', age: 16 }, { name: 'James', age: 18 }] let newArray=array.map((item) => { item.like='eat'; return item; }) console.log(array); // [{ name: 'Anna', age: 16,like: \"eat\"},{ name: 'James', age: 18,like: \"eat\"}] console.log(newArray);//[{ name: 'Anna', age: 16,like: \"eat\"},{ name: 'James', age: 18,like: \"eat\"}] 5.every() æ–¹æ³•ç”¨äºæ£€æµ‹æ•°ç»„æ‰€æœ‰å…ƒç´ æ˜¯å¦éƒ½ç¬¦åˆæŒ‡å®šæ¡ä»¶ 6.arr.reduce(callback(accumulator, currentValue[, index[, array]])[, initialValue]) å‚æ•°åˆ†åˆ«å¯¹åº”å›è°ƒå‡½æ•°å’Œåˆå§‹å€¼ å¯¹æ•°ç»„ä¸­æ‰€æœ‰å†…å®¹è¿›è¡Œæ±‡æ€»ï¼Œç‚¹åƒé€’å½’ let total = a.reduce(function (preValue, currValue) { return preValue + currValue; }, 0); // éå†åˆ°ç¬¬ä¸€æ¬¡æ—¶ï¼ŒpreValueä¸ºåˆå§‹å€¼ï¼ŒcurrValueä¸ºæ•°ç»„é‡Œçš„ç¬¬ä¸€ä¸ªå€¼ // éå†åˆ°ç¬¬äºŒæ¬¡æ—¶ï¼ŒpreValueä¸ºç¬¬ä¸€æ¬¡è¿”å›çš„å€¼ï¼ŒcurrValueä¸ºæ•°ç»„é‡Œç¬¬äºŒä¸ªæ•° ä»¥ä¸ŠES5æ•°ç»„æ–¹æ³•æœ‰åŠ©äºé“¾å¼ç¼–ç¨‹ï¼ˆå‡½æ•°å¼ç¼–ç¨‹ï¼‰ï¼Œæ¯”å¦‚ï¼š //this.$store.state.cartList æ˜¯ä¸€ä¸ªæ•°ç»„ this.$store.state.cartList .filter((item) => item.checked === true) .reduce((preValue, item) => { return preValue + item.count * item.price; }, 0) .toFixed(2); æ•°ç»„æ‰å¹³åŒ–æ–¹æ³•applyï¼ˆä»…é™åŒå±‚ï¼‰ function Flat1(arr){ return [].concat.apply([],arr); } var arr1 = [[1, 2],[3, 4, 5], [6, 7, 8, 9]]; console.log(Flat1(arr1)); // [1, 2, 3, 4, 5, 6, 7, 8, 9] å±•å¼€è¿ç®—ç¬¦ï¼ˆä»…é™åŒå±‚ï¼‰ function Flat1(arr){ return [].concat(...arr); } å¤šå±‚éœ€è¦é€’å½’ function Flat5(arr){ var newArr =[]; for(var i= 0; i &lt; arr.length; i++){ if(arr[i] instanceof Array){ newArr = newArr.concat(Flat5(arr[i])); // newArr.push.apply(newArr, Flat5(arr[i])); }else{ newArr.push(arr[i]); } } return newArr; } es6æ–¹æ³• const Flat6 = arr => arr.reduce((a, b) => a.concat(Array.isArray(b) ? Flat6(b) : b), []); å¦‚æœæ•°ç»„çš„å…ƒç´ éƒ½æ˜¯æ•°å­—ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥è€ƒè™‘ä½¿ç”¨ toString æ–¹æ³• function flatten(arr) { return arr.toString().split(',').map(function(item){ return +item }) } å¯¹è±¡æ–¹æ³•Object.defineProperty() å®šä¹‰å¯¹è±¡ä¸­æ–°å±æ€§æˆ–ä¿®æ”¹åŸæœ‰çš„å±æ€§ï¼ˆåº”ç”¨äºvueå“åº”å¼åŒå‘ç»‘å®šï¼Œè¿˜æœ‰es5å®ç°constçš„åŸç†ï¼‰ Object.defineProperty(obj, prop, desciptor) objï¼šå¿…é¡»ï¼Œç›®æ ‡å¯¹è±¡ propï¼š å¿…éœ€ï¼Œéœ€å®šä¹‰æˆ–ä¿®æ”¹çš„å±æ€§å descriptorï¼š å¿…é¡»ï¼Œç›®æ ‡å±æ€§æ‰€æ‹¥æœ‰çš„ç‰¹æ€§ï¼Œä¸€å¯¹è±¡çš„å½¢å¼{ }è¿›è¡Œä¹¦å†™ï¼Œ valueè®¾ç½®å±æ€§çš„å€¼ï¼Œé»˜è®¤undefinedï¼› writableå€¼èƒ½å¦é‡å†™ï¼ˆä¿®æ”¹ï¼‰ï¼Œé»˜è®¤ä¸ºfalseï¼› enumerableï¼šç›®æ ‡å±æ€§æ˜¯å¦å¯ä»¥è¢«æšä¸¾(æ˜¯å¦å¯ä»¥è¢«éå†ï¼Œæ˜¾ç¤ºå‡ºæ¥)ï¼Œé»˜è®¤falseï¼› configurableç›®æ ‡å±æ€§æ˜¯å¦å¯ä»¥è¢«åˆ é™¤ï¼Œæˆ–è€…å†æ¬¡ä¿®æ”¹ç‰¹æ€§ï¼ˆæ˜¯å¦å¯ä»¥å†æ¬¡æ›´æ”¹è¿™ä¸ªdescriptorï¼‰ï¼Œé»˜è®¤falseï¼› ä¸ç®¡æ˜¯å¦ä¸ºä¸¥æ ¼æ¨¡å¼ï¼Œå°è¯•ä¿®æ”¹ä¸€ä¸ªä¸å¯é…ç½®çš„å±æ€§æè¿°ç¬¦éƒ½ä¼šå‡ºé”™ï¼Œä¹Ÿå°±æ˜¯è¯´configurableçš„ä¿®æ”¹ä¸ºfalseæ˜¯å•å‘æ“ä½œï¼ï¼ é™¤æ­¤å¤–è¿˜å…·æœ‰ä»¥ä¸‹å¯é€‰é”®å€¼ï¼š å½“å®šä¹‰getterã€setteræ—¶ï¼Œå±æ€§å°±ä¼šè¢«å®šä¹‰ä¸ºâ€œè®¿é—®æè¿°ç¬¦â€ï¼Œæ­¤æ—¶JavaScriptä¼šå¿½ç•¥ä»–ä»¬çš„valueå’Œwritable ç‰¹æ€§ é€šå¸¸æ¥è¯´getterå’Œ setteræ˜¯æˆå¯¹å‡ºç°çš„ï¼ˆåªå®šä¹‰ä¸€ä¸ªçš„è¯é€šå¸¸ä¼šäº§ç”Ÿæ„æ–™ä¹‹å¤–çš„è¡Œä¸ºï¼‰ getï¼šå½“è®¿é—®è¯¥å±æ€§æ—¶ï¼Œä¼šè°ƒç”¨æ­¤å‡½æ•°ã€‚æ‰§è¡Œæ—¶ä¸ä¼ å…¥ä»»ä½•å‚æ•°ï¼Œä½†æ˜¯ä¼šä¼ å…¥ this å¯¹è±¡ï¼ˆç”±äºç»§æ‰¿å…³ç³»ï¼Œè¿™é‡Œçš„thiså¹¶ä¸ä¸€å®šæ˜¯å®šä¹‰è¯¥å±æ€§çš„å¯¹è±¡ï¼‰ã€‚è¯¥å‡½æ•°çš„è¿”å›å€¼ä¼šè¢«ç”¨ä½œå±æ€§çš„å€¼ã€‚ setï¼šå½“å±æ€§å€¼è¢«ä¿®æ”¹æ—¶ï¼Œä¼šè°ƒç”¨æ­¤å‡½æ•°ã€‚è¯¥æ–¹æ³•æ¥å—ä¸€ä¸ªå‚æ•°ï¼ˆä¹Ÿå°±æ˜¯è¢«èµ‹äºˆçš„æ–°å€¼ï¼‰ï¼Œä¼šä¼ å…¥èµ‹å€¼æ—¶çš„ this å¯¹è±¡(ä¿®æ”¹åçš„å€¼)ã€‚ var obj = { id: 1, pname: 'å°ç±³', price: 1999 } //ä»¥å‰çš„å¯¹è±¡æ·»åŠ ä¿®æ”¹æ–¹å¼ //obj.num = 1000; //obj.price = 99; Object.defineProperty(obj, 'num', { value = 999, enumerable = true }) Object.keys(obj) æ–¹æ³•ä¼šè¿”å›ä¸€ä¸ªç”±ä¸€ä¸ªç»™å®šå¯¹è±¡çš„è‡ªèº«å¯æšä¸¾å±æ€§ç»„æˆçš„æ•°ç»„ï¼Œæ•°ç»„ä¸­å±æ€§åçš„æ’åˆ—é¡ºåºå’Œä½¿ç”¨ forâ€¦in å¾ªç¯éå†è¯¥å¯¹è±¡æ—¶è¿”å›çš„é¡ºåºä¸€è‡´ ã€‚å¦‚æœå¯¹è±¡çš„é”®-å€¼éƒ½ä¸å¯æšä¸¾ï¼Œé‚£ä¹ˆå°†è¿”å›ç”±é”®ç»„æˆçš„æ•°ç»„ã€‚ Object.keys(obj1).lengthå¾—åˆ°å½“å‰å¯¹è±¡å±æ€§ä¸ªæ•° Object.getOwnPropertyNames(obj1)è¿”å›å¯¹è±¡å®ä¾‹çš„å¸¸è§„å±æ€§æ•°ç»„ Object.getOwnPropertySymbols(obj1)è¿”å›å¯¹è±¡å®ä¾‹çš„ç¬¦å·å±æ€§æ•°ç»„ è¿™ä¸¤ç§æ–¹æ³•äº’æ–¥ 2.å‡½æ•°å®šä¹‰å’Œè°ƒç”¨å‡½æ•°å®šä¹‰ï¼š è‡ªå®šä¹‰å‡½æ•°ï¼šfunction fn() {}; åŒ¿åå‡½æ•°ï¼š var fun = function() {}; åŒ¿åå‡½æ•°ä¸‰å¤§ç¼ºç‚¹ï¼š 1.è°ƒç”¨æ ˆæ›´éš¾è¿½è¸ª 2.è‡ªæˆ‘å¼•ç”¨æ›´éš¾ï¼ˆé€’å½’ç­‰ï¼‰ 3.ä»£ç è¾ƒéš¾ç†è§£ const a = function b (){ console.log('woshib'); } b(); //b is not defined new Function(&#39;å‚æ•°1&#39;, &#39;å‚æ•°2&#39;, &#39;å‡½æ•°ä½“&#39;)å½¢å¼è°ƒç”¨ åƒæ„é€ å‡½æ•°, Functioné‡Œé¢çš„å‚æ•°éƒ½å¿…é¡»æ˜¯å­—ç¬¦ä¸²æ ¼å¼ var f = new Function('a', 'b', 'console.log(a + b)'); å®é™…ä¸Šæ‰€æœ‰çš„å‡½æ•°éƒ½æ˜¯Functionçš„å®ä¾‹ å‡½æ•°ä¹Ÿå±äºå¯¹è±¡ å‡½æ•°è°ƒç”¨ï¼š æ™®é€šå‡½æ•°è°ƒç”¨ function fn() { //something } fn(); å¯¹è±¡æ–¹æ³• var o = { say: function() { //something } } o.say(); æ„é€ å‡½æ•° function Star() {}; new Star(); ç»‘å®šäº‹ä»¶å‡½æ•°btn.onclick = function() {} å®šæ—¶å™¨å‡½æ•° setInterval(function() {}, 1000); ç«‹å³æ‰§è¡Œå‡½æ•°ï¼ˆè‡ªåŠ¨è°ƒç”¨ï¼‰ (function() {} )(); ç«‹å³æ‰§è¡Œå‡½æ•°å’Œæ™®é€šå‡½æ•°æœ‰å®é™…æ„ä¹‰ä¸Šéå¸¸é‡è¦çš„åŒºåˆ†ï¼Œæ­¤æ—¶å‡½æ•°ä¼šè¢«å½“ä½œå‡½æ•°è¡¨è¾¾å¼å’Œä¸æ˜¯ä¸€ä¸ªæ ‡å‡†çš„å‡½æ•°å£°æ˜æ¥å¤„ç†ã€‚æ­¤æ—¶å‡½æ•°åªèƒ½åœ¨å®ƒæ‰€ä»£è¡¨çš„ä½ç½®ä¸­è¢«è®¿é—®ï¼Œå¤–éƒ¨ä½œç”¨åŸŸä¸è¡Œï¼Œä¸ä¼šéå¿…è¦çš„æ±¡æŸ“å¤–éƒ¨ä½œç”¨åŸŸ 3.thisçš„æŒ‡å‘å‡½æ•°å†…thisçš„æŒ‡å‘æ˜¯å½“æˆ‘ä»¬è°ƒç”¨å‡½æ•°æ—¶ï¼Œæ ¹æ®è°ƒç”¨æ ˆç¡®å®šçš„ï¼ˆåŠ¨æ€ä½œç”¨åŸŸï¼‰ï¼Œè°ƒç”¨æ–¹å¼ä¸åŒå¯¼è‡´thisæŒ‡å‘ä¸åŒ 1.æ™®é€šå‡½æ•°è°ƒç”¨ï¼šwindow 2.æ„é€ å‡½æ•°è°ƒç”¨ï¼šå®ä¾‹å¯¹è±¡ï¼ŒåŸå‹å¯¹è±¡ä¹Ÿæ˜¯æŒ‡å‘å®ä¾‹å¯¹è±¡ï¼ˆåŒæ ·çš„ï¼Œç±»ä¸­thisä¹Ÿæ˜¯æŒ‡å‘å®ä¾‹å¯¹è±¡ï¼‰ 3.å¯¹è±¡æ–¹æ³•ï¼šè¯¥æ–¹æ³•æ‰€å±å¯¹è±¡ï¼ˆéšå¼ç»‘å®šï¼‰ å¯¹è±¡å±æ€§å¼•ç”¨é“¾åªæœ‰ä¸Šä¸€å±‚æˆ–è€…æœ€åä¸€å±‚åœ¨è°ƒç”¨ä½ç½®ä¸­èµ·ä½œç”¨ function foo(){ console.log(this.a); } const obj2 = { a:42, foo } const obj1 = { a:2, obj2 } obj1.obj2.foo(); //42 4.äº‹ä»¶ç»‘å®šï¼šç»‘å®šäº‹ä»¶å¯¹è±¡ï¼ˆå½“å‰æƒ…å†µæŒ‡çš„æ˜¯ä½äºå›è°ƒå‡½æ•°çš„å†…éƒ¨ä¸­thisæŒ‡å‘ï¼‰ 5.å®šæ—¶å™¨å‡½æ•°ï¼šwindow 6.ç«‹å³æ‰§è¡Œå‡½æ•°ï¼šwindow ï¼ˆ2ï¼‰ä½†æ˜¯ç«‹å³æ‰§è¡Œå‡½æ•°è¿˜å¾—çœ‹è¿™æ—¶thisæ˜¯å¦åœ¨å¯¹è±¡æ–¹æ³•æˆ–è€…æ„é€ å‡½æ•°ä¸­ï¼Œç¬¬äºŒä¸ªè™½ç„¶æ˜¯ç«‹å³æ‰§è¡Œå‡½æ•°ï¼Œä½†æ˜¯æ­¤æ—¶å®ƒçš„thiså’Œfooç»‘å®šäº†ï¼Œæ‰€ä»¥è¿˜æ˜¯è¾“å‡ºfooçš„a ï¼ˆ3ï¼‰fnæ˜¯å¯¹foo.barçš„ä¸€ä¸ªå¼•ç”¨ï¼Œå®è´¨ä¸Šï¼Œå®ƒå¼•ç”¨çš„æ˜¯barå‡½æ•°æœ¬èº«ï¼Œå› æ­¤æ­¤æ—¶çš„ fnæ˜¯ä¸€ä¸ªä¸å¸¦ä»»ä½•ä¿®é¥°çš„å‡½æ•°è°ƒç”¨ï¼Œ åº”ç”¨é»˜è®¤ç»‘å®šï¼ˆå‘ç”Ÿäº†éšå¼ä¸¢å¤±ï¼‰ ï¼ˆ4ï¼‰ç®­å¤´å‡½æ•°æŒ‰ç…§çš„æ˜¯è¯æ³•ä½œç”¨åŸŸï¼ŒæŒ‰ç…§è¯æ³•ä½œç”¨åŸŸæ‰¾å°±å¥½äº†ï¼ˆå¯¹è±¡æ²¡æœ‰è‡ªå·±çš„ä½œç”¨åŸŸï¼‰ ï¼ˆ5ï¼‰è€Œèµ‹å€¼æ“ä½œ ï¼Œä¼šåˆ›å»ºä¸€ä¸ªå‡½æ•°çš„é—´æ¥å¼•ç”¨ï¼Œæ­¤æ—¶è°ƒç”¨å‡½æ•°ä¼šåº”ç”¨é»˜è®¤ç»‘å®šï¼ˆthisæŒ‡å‘windowï¼Œä¸¥æ ¼æ¨¡å¼ä¸ºundefinedï¼‰ foo.bar = foo.barè¿”å›å€¼æ˜¯ç›®æ ‡å‡½æ•°çš„å¼•ç”¨ï¼Œæ­¤æ—¶ç›¸å½“äºç›´æ¥è°ƒç”¨ bar() ï¼ˆ6ï¼‰æœ€åä¸€ä¸ªå‚æ•°ä¼ é€’å…¶å®å°±æ˜¯ä¸€ç§éšå¼èµ‹å€¼ï¼Œä¼ å…¥ä¸€ä¸ªå¯¹foo.barçš„å¼•ç”¨ï¼Œä¸åŠ ä»»ä½•ä¿®é¥°ï¼Œå› æ­¤æ˜¯é»˜è®¤ç»‘å®šï¼ˆthisæŒ‡å‘windowï¼Œä¸¥æ ¼æ¨¡å¼ä¸ºundefinedï¼‰ var a = 1; var foo = { a: 2, bar: function () { return this.a; }, bad: () => { return this.a //ç®­å¤´å‡½æ•°å¯¼è‡´thisæ°¸è¿œç»‘å®šäº†çˆ¶çº§ä½œç”¨åŸŸwindow }, }; const fn = foo.bar; function doFoo(fn) { console.log('6.', fn()); } console.log('1.', foo.bar()); //1. 2 console.log('2.', (foo.bar)()); //2. 2 console.log('3.', fn()); //3. 1 console.log('4.', foo.bad()); //4. 1 console.log('5.', (foo.bar = foo.bar)());//5. 1 doFoo(foo.bar); //6. 1 â€œåŒ¿åå‡½æ•°çš„æ‰§è¡Œç¯å¢ƒå…·æœ‰å…¨å±€æ€§â€ï¼Œæ‰€ä»¥æœ€é‡Œå±‚é‚£ä¸ªå‡½æ•°ä¸­thisæŒ‡å‘å…¨å±€ç¯å¢ƒï¼ˆèµ°äº†é»˜è®¤ç»‘å®šï¼‰ï¼Œå…¨å±€ç¯å¢ƒæ²¡æœ‰å®šä¹‰fooå˜é‡æ‰€ä»¥è¾“å‡ºundefinedã€‚åœ¨åŒ¿åå‡½æ•°å¤–éƒ¨å°†thisä¿å­˜åˆ°ä¸€ä¸ªå†…éƒ¨å‡½æ•°å¯ä»¥è®¿é—®çš„å˜é‡selfä¸­ï¼Œå¯ä»¥é€šè¿‡selfè®¿é—®è¿™ä¸ªå¯¹è±¡ï¼Œæ‰€ä»¥self.fooä¸ºbar var myobject = { foo: \"bar\", func: function () { var self = this; console.log(this.foo); console.log(self.foo); (function () { console.log(this.foo);//undefined console.log(self.foo);//bar })(); } }; myobject.func(); ç±»çš„thisæŒ‡å‘ç±»çš„æ–¹æ³•å†…éƒ¨å¦‚æœå«æœ‰thisï¼Œå®ƒé»˜è®¤æŒ‡å‘ç±»çš„å®ä¾‹ã€‚ä½†æ˜¯ï¼Œå¿…é¡»éå¸¸å°å¿ƒï¼Œä¸€æ—¦å•ç‹¬ä½¿ç”¨è¯¥æ–¹æ³•ï¼Œå¾ˆå¯èƒ½æŠ¥é”™ã€‚ class Logger { printName(name = 'there') { this.print(`Hello ${name}`); } print(text) { console.log(text); } } const logger = new Logger(); const { printName } = logger; printName(); // TypeError: Cannot read property 'print' of undefined ä¸Šé¢ä»£ç ä¸­ï¼ŒprintNameæ–¹æ³•ä¸­çš„thisï¼Œé»˜è®¤æŒ‡å‘Loggerç±»çš„å®ä¾‹ã€‚ä½†æ˜¯ï¼Œå¦‚æœå°†è¿™ä¸ªæ–¹æ³•æå–å‡ºæ¥å•ç‹¬ä½¿ç”¨ï¼Œthisä¼šæŒ‡å‘è¯¥æ–¹æ³•è¿è¡Œæ—¶æ‰€åœ¨çš„ç¯å¢ƒï¼ˆç”±äº class å†…éƒ¨æ˜¯ä¸¥æ ¼æ¨¡å¼ï¼Œæ‰€ä»¥ this å®é™…æŒ‡å‘çš„æ˜¯undefinedï¼‰ï¼Œä»è€Œå¯¼è‡´æ‰¾ä¸åˆ°printæ–¹æ³•è€ŒæŠ¥é”™ã€‚ ï¼ˆ1ï¼‰ä¸€ä¸ªæ¯”è¾ƒç®€å•çš„è§£å†³æ–¹æ³•æ˜¯ï¼Œåœ¨æ„é€ æ–¹æ³•ï¼ˆconstructorï¼‰ä¸­ç»‘å®šthisï¼Œè¿™æ ·å°±ä¸ä¼šæ‰¾ä¸åˆ°printæ–¹æ³•äº†ã€‚ class Logger { constructor() { this.printName = this.printName.bind(this); } // ... } ï¼ˆ2ï¼‰å¦ä¸€ç§è§£å†³æ–¹æ³•æ˜¯ä½¿ç”¨ç®­å¤´å‡½æ•°ã€‚ class Obj { constructor() { this.getThis = () => this; } } const myObj = new Obj(); myObj.getThis() === myObj // true æ”¹å˜thisæŒ‡å‘JavaScriptä¸ºæˆ‘ä»¬ä¸“é—¨æä¾›äº†ä¸€äº›å‡½æ•°æ–¹æ³•æ¥å¸®åŠ©æˆ‘ä»¬å¤„ç†å‡½æ•°å†…éƒ¨thisæŒ‡å‘é—®é¢˜ï¼Œå¸¸ç”¨çš„æœ‰bind()ã€call()ã€apply()ä¸‰ç§æ–¹æ³• 1.call()å‰é¢è®²è¿‡ï¼Œcallçš„ä¸»è¦ä½œç”¨å¯ä»¥å®ç°ç»§æ‰¿ 2.apply()æ–¹æ³•è°ƒç”¨ä¸€ä¸ªå‡½æ•°ï¼Œç®€å•ç†è§£ä¸ºè°ƒç”¨å‡½æ•°çš„æ–¹å¼ï¼Œä½†æ˜¯å®ƒå¯ä»¥æ”¹å˜thisçš„æŒ‡å‘ fun.apply(thisArg, [argsArray]) thisArgï¼šåœ¨å‡½æ•°æ‰§è¡Œæ—¶æŒ‡å®šçš„thiså¯¹è±¡ ï¼Œä¸ä¼ ï¼Œæˆ–è€…ä¼ null,undefinedï¼Œ å‡½æ•°ä¸­çš„ this æŒ‡å‘ window å¯¹è±¡ argsArray: ä¼ é€’çš„å€¼ï¼Œå¿…é¡»åŒ…å«åœ¨æ•°ç»„ï¼ˆä¼ªæ•°ç»„ï¼‰é‡Œé¢ï¼ˆè¿™ä¸ªæ˜¯å’Œcallçš„ä¸åŒç‚¹ï¼‰ è¿”å›å€¼ä¸ºå‡½æ•°çš„è¿”å›å€¼ï¼Œå› ä¸ºå®ƒå°±æ˜¯è°ƒç”¨å‡½æ•° åº”ç”¨æ–¹é¢ï¼šapplyä¼ é€’æ•°ç»„å‚æ•°ï¼Œæ‰€ä»¥å¯ä»¥å€ŸåŠ©æ•°å­¦å†…ç½®å¯¹è±¡æ±‚æœ€å¤§å€¼ Math.max.apply(Math,arr) ï¼ˆes6æ‹“å±•è¿ç®—ç¬¦â€¦Math.max(...arr)ä¹Ÿå¯ä»¥ï¼Œä½†æ˜¯ä¸èƒ½ Math.max(arr)ï¼Œå› ä¸ºmaxä¸æ¥å—æ•°ç»„ï¼Œåªæ¥å—ä¸€ä¸ªä¸€ä¸ªçš„å‚æ•°ï¼‰ 3.bind()æ–¹æ³•ä¸ä¼šè°ƒç”¨å‡½æ•°ï¼Œä½†æ˜¯èƒ½æ”¹å˜å‡½æ•°å†…éƒ¨thisæŒ‡å‘ï¼Œå½“ä½¿ç”¨ new æ“ä½œç¬¦è°ƒç”¨ç»‘å®šå‡½æ•°æ—¶ï¼Œè¯¥å‚æ•°æ— æ•ˆã€‚ fun.bind(thisArg, arg1, arg2....) è¿”å›æŒ‡å®šthiså€¼å’Œåˆå§‹åŒ–å‚æ•°æ”¹é€ çš„åŸå‡½æ•°æ‹·è´ï¼ˆå³åˆ›é€ æ–°çš„å‡½æ•° var f = fn.bind(xx)ï¼‰ åº”ç”¨æ–¹é¢ï¼šå®šæ—¶å™¨ç­‰ä¸æƒ³ç«‹å³è°ƒç”¨çš„å‡½æ•°ï¼ˆæˆ–è€…å¤„ç†å…¶ä»–åªèƒ½ç”¨thatæ¥æš‚æ—¶å‚¨å­˜å¯¹è±¡çš„æƒ…å†µï¼‰ btn.onclick = function() { this.disabled = true; //var that = this; //old way: /*setTimeout(function() { //that.disabled = false; }, 3000)*/ //new way: setTimeout(function() { this.disabled = false; }.bind(this), 3000) //è¿™ä¸ªthisæŒ‡å‘btn } å·§å¦™è¿ç”¨ï¼š ä¼ å‚çš„æ—¶å€™å¯ä»¥ä¼ é€’å…¶ä»–å¯¹è±¡è¿‡æ¥ class Tab { constructor(id) { this.main = document.querySelector(id); //tabsbox this.lis = this.main.querySelectorAll('li'); } // åˆå§‹åŒ– init() { for (let i = 0; i &lt; this.lis.length; i++) { this.lis[i].onclick = this.toggleTab.bind(this.lis[i], this); } } // åˆ‡æ¢åŠŸèƒ½ toggleTab(that) { that.clearTab(); this.className = 'liactive' that.sections[this.index].className = 'conactive'; } } å¦‚æœä¸€ä¸ªå‡½æ•°è¿›è¡Œå¤šæ¬¡ bindçš„æƒ…å†µï¼šï¼ï¼ let a = {} let fn = function () { console.log(this) } fn.bind().bind(a)() ç­”æ¡ˆæ˜¯ç¬¬ä¸€ä¸‹çš„ç»“æœï¼Œå³thisæŒ‡å‘ç¬¬ä¸€ä¸ªbindä¼ å…¥çš„thisï¼Œè¿™é‡Œæ²¡æœ‰çš„è¯å°±æ˜¯window // fn.bind().bind(a) ç­‰äº let fn2 = function fn1() { return function() { return fn.apply() }.apply(a) } fn2() ä¹Ÿå¯ä»¥ç†è§£ä¸ºå˜æˆäº† a.window.fn() ä¸‰å¤§thisæŒ‡å‘æ‰‹å†™æ¨¡å¼å®è´¨ä¸ŠåŸç†ä¹Ÿæ˜¯åˆ©ç”¨éšå¼ç»‘å®šï¼Œé€šè¿‡ ä¸Šä¸‹æ–‡.å‡½æ•°()è°ƒç”¨æ”¹å†™thisï¼Œä»è€Œå˜æˆæ˜¾å¼ç»‘å®š è§£é‡Šä¸€ä¸‹ï¼Œåœ¨Function.prototypeé‡Œé€šè¿‡å±æ€§å®šä¹‰æ–¹æ³•ï¼Œæ­¤æ—¶thisæŒ‡å‘å‡½æ•°æœ¬èº«ï¼ˆå› ä¸ºæ˜¯å‡½æ•°åœ¨è°ƒç”¨ï¼‰ callæŒ‡å‘ Function.prototype.myCall = function(context) { if (typeof this !== 'function') { throw new TypeError('Error') } context = context || window context.fn = this const args = [...arguments].slice(1) const result = context.fn(...args) delete context.fn return result } bindçš„å®ç°ï¼ˆå€ŸåŠ©ä¸€æ³¢apply / callï¼‰ Function.prototype.myBind = function (context) { if (typeof this !== 'function') { throw new TypeError('Error') } const _this = this const args = [...arguments].slice(1) // è¿”å›ä¸€ä¸ªå‡½æ•° return function F() { // å› ä¸ºè¿”å›äº†ä¸€ä¸ªå‡½æ•°ï¼Œæˆ‘ä»¬å¯ä»¥ new F()ï¼Œæ‰€ä»¥éœ€è¦åˆ¤æ–­ if (this instanceof F) { return new _this(...args, ...arguments) } return _this.apply(context, args.concat(...arguments)) } } ä¸‰å¤§thisæŒ‡å‘ä¸å®‰å…¨ç‚¹å¦‚æœæŠŠnull æˆ–è€… undefined ä½œä¸ºthisç»‘å®šå¯¹è±¡ï¼Œä¼ å…¥callã€bindã€applyï¼Œåˆ™è°ƒç”¨æ—¶ä¼šè¢«å¿½ç•¥ï¼Œå¯èƒ½ç»™å…¨å±€windowæ·»åŠ å‰¯ä½œç”¨ï¼Œå°†è§„åˆ™ç»‘å®šåˆ°å…¨å±€å¯¹è±¡ï¼Œå¯èƒ½å¯¼è‡´ä¸å¯é¢„è®¡çš„åæœ ï¼ˆæŒ‡å‘å‚æ•°ä¼ å…¥nullçš„åº”ç”¨åœºæ™¯æ˜¯æŸ¯é‡ŒåŒ–ä¼ å‚ï¼‰ æ­¤æ—¶å¯ä»¥ä¼ å…¥ä¸€ä¸ªâ€œæ›´ç©ºâ€çš„ç©ºå¯¹è±¡ï¼ˆæ²¡æœ‰Object.prototypeè¿™ä¸ªå§”æ‰˜ï¼‰ï¼Œé¿å…è¿™ç§å±é™© const d = Object.create(null); foo.bind(d, ['a', 'b']); è½¯ç»‘å®šéšå¼ç»‘å®šï¼šå¯¹è±¡ç»‘å®š æ˜¾å¼ç»‘å®šï¼šapplyã€call ç¡¬ç»‘å®šï¼šbind ç¡¬ç»‘å®šå¯ä»¥æŠŠthiså¼ºåˆ¶ç»‘å®šåˆ°æŒ‡å®šå¯¹è±¡ã€‚ä½†æ˜¯ç¡¬ç»‘å®šä¼šå¤§å¤§é™ä½å‡½æ•°çš„çµæ´»æ€§ï¼Œä½¿ç”¨ç¡¬ç»‘å®šä¹‹ååˆ™æ— æ³•ä½¿ç”¨æ˜¾å¼ç»‘å®šæˆ–è€…éšå¼ç»‘å®šä¿®æ”¹this å¦‚æœå¯ä»¥ç»™é»˜è®¤ç»‘å®šæŒ‡å®šä¸€ä¸ªé™¤äº†å…¨å±€å¯¹è±¡å’Œundefinedä»¥å¤–çš„å€¼ï¼Œé‚£å°±å¯ä»¥å®ç°å’Œç¡¬ç»‘å®šç›¸åŒçš„æ•ˆæœï¼ŒåŒæ—¶ä¿ç•™éšå¼ç»‘å®šæˆ–è€…æ˜¾å¼ç»‘å®šä¿®æ”¹thisçš„èƒ½åŠ› if(!Function.prototype.softBind) { Function.prototype.softBind = function(obj) { var fn = this; var curried = [].slice.call(arguments, 1); var bound = function(){ // å¦‚æœthisä¸æ˜¯window || globalåˆ™ä¸ä½¿ç”¨ä¼ å…¥çš„objï¼Œå¦‚æœæ˜¯ï¼Œåˆ™å°†thisç»‘å®šobj return fn.apply( (!this || this === (window || global)) ? obj : this, curried.concat.apply(curried, arguments) ); }; bound.prototype = Object.create(fn.prototype); return bound; } } æ­¤æ—¶å®ç°äº†è½¯ç»‘å®š function foo() { console.log(`name: ${this.name}`); } var obj = { name: \"obj\" } var obj2 = { name: \"obj2\" } var obj3 = { name: \"obj3\" } obj2.foo = foo.softBind(obj); obj2.foo(); //name: obj2 foo.softBind(obj).call(obj3); //name: obj3 setTimeout(obj2.foo, 1000); //name: obj 4.ä¸¥æ ¼æ¨¡å¼ie10ä»¥ä¸Šç‰ˆæœ¬æ‰æ”¯æŒ å®ƒæ˜¯è®©JavaScriptä»¥ä¸¥æ ¼çš„æ¡ä»¶ä¸‹è¿è¡Œä»£ç  1.æ¶ˆé™¤äº†JavaScriptä¸€äº›è¯­æ³•ä¸ä¸¥è°¨çš„åœ°æ–¹ï¼Œå‡å°‘æ€ªå¼‚è¡Œä¸º 2.æ¶ˆé™¤ä»£ç ä¸€äº›ä¸å®‰å…¨ä¹‹å¤„ï¼Œä¿è¯ä»£ç è¿è¡Œçš„å®‰å…¨ 3.æé«˜ç¼–è¯‘å™¨æ•ˆç‡ï¼Œå¢åŠ è¿è¡Œé€Ÿåº¦ 4.ç¦ç”¨äº†ECMAscriptåœ¨æœªæ¥ç‰ˆæœ¬ä¸­å¯èƒ½ä¼šå®šä¹‰çš„ä¸€äº›è¯­æ³•ï¼Œä¸ºæœªæ¥JavaScriptåšå¥½é“ºå«ï¼Œæ¯”å¦‚classã€enumã€superç­‰ å¼€å¯ä¸¥æ ¼æ¨¡å¼åº”ç”¨åˆ°æ•´ä¸ªåˆ°æ•´ä¸ªè„šæœ¬æˆ–ä¸ªåˆ«å‡½æ•°ä¸­ï¼Œå› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥è®²ä¸¥æ ¼æ¨¡å¼åˆ†ä¸ºè„šæœ¬å¼€å¯ä¸¥æ ¼æ¨¡å¼å’Œä¸ºå‡½æ•°å¼€å¯ä¸¥æ ¼æ¨¡å¼ä¸¤ç§æƒ…å†µ ä¸ºè„šæœ¬å¼€å¯ä¸¥æ ¼æ¨¡å¼ï¼š &lt;script> \"use strict\"; //xxxx &lt;/script> æ–¹æ³•äºŒï¼šï¼ˆå†™åœ¨ç«‹å³æ‰§è¡Œå‡½æ•°é‡Œçš„éƒ½è¦æŒ‰ç…§ä¸¥æ ¼æ¨¡å¼ï¼‰ &lt;script> (function() { \"use strict\"; /xxxx })(); &lt;/script> ä¸ºå‡½æ•°å¼€å¯ä¸¥æ ¼æ¨¡å¼ï¼š(åªåœ¨æ­¤å‡½æ•°å†…éƒ¨æœ‰ä¸¥æ ¼æ¨¡å¼) &lt;script> function fn(){ \"use strict\"; /xxxx } &lt;/script> å˜åŒ–1.ä¸¥æ ¼æ¨¡å¼ç¦æ­¢å˜é‡ä¸ºå£°æ˜å°±èµ‹å€¼ 2.ä¸¥ç¦åˆ é™¤å·²å£°æ˜çš„å˜é‡ï¼Œæ¯”å¦‚delete x; æ˜¯é”™è¯¯çš„ 3.åœ¨ä¸¥æ ¼æ¨¡å¼ä¸‹ï¼Œå…¨å±€ä½œç”¨åŸŸä¸­å‡½æ•°ä¸­çš„thisä¸å†æ˜¯windowï¼Œè€Œæ˜¯undefinedï¼ˆä½†æ˜¯å®šæ—¶å™¨ä¹‹ç±»çš„è¿˜æ˜¯æŒ‡å‘windowï¼‰ 4.ä¸¥æ ¼æ¨¡å¼ä¸‹ï¼Œå¦‚æœæ„é€ å‡½æ•°ä¸é…åˆnewæ¥ä½¿ç”¨ï¼Œthiså°±ä¼šæŠ¥é”™ 5.å‡½æ•°ä¸èƒ½æœ‰é‡åå‚æ•° 6.å‡½æ•°å¿…é¡»å£°æ˜åœ¨é¡¶å±‚ï¼Œå› ä¸ºæ–°ç‰ˆæœ¬çš„JavaScriptå¼•å…¥äº†å—çº§ä½œç”¨åŸŸï¼Œæ‰€ä»¥ä¸å…è®¸åœ¨éå‡½æ•°ä»£ç å—å†…å£°æ˜å‡½æ•° 5.é—­åŒ…é—­åŒ…æŒ‡æœ‰æƒè®¿é—®å¦å¤–ä¸€ä¸ªå‡½æ•°ä½œç”¨åŸŸä¸­å˜é‡çš„å‡½æ•°ï¼Œç®€å•ç†è§£å°±æ˜¯ä¸€ä¸ªä½œç”¨åŸŸå¯ä»¥è®¿é—®å¦å¤–ä¸€ä¸ªå‡½æ•°å†…éƒ¨çš„å±€éƒ¨å˜é‡ ï¼ˆè¢«è®¿é—®ä½œç”¨åŸŸçš„å‡½æ•°å°±æ˜¯é—­åŒ…å‡½æ•°ï¼‰ //åœ¨æ­¤å¤„funå‡½æ•°ä½œç”¨åŸŸè®¿é—®äº†å¦å¤–ä¸€ä¸ªå‡½æ•°fné‡Œé¢çš„å±€éƒ¨å˜é‡numï¼Œå½¢æˆäº†é—­åŒ…ï¼Œæ­¤æ—¶funå°±æ˜¯é—­åŒ… //funè¢«èµ‹äºˆäº†ä¸€ä¸ªå…¨å±€å˜é‡ï¼Œæ‰€ä»¥funå§‹ç»ˆä¿å­˜åœ¨å†…å­˜ä¸­ï¼Œè€Œfunä¾èµ–fnçš„numï¼Œå› æ­¤numä¹Ÿå§‹ç»ˆåœ¨å†…å­˜ä¸­ function fn() { var num = 10; function fun() { console.log(num); } fun(); } fn(); åœ¨fnå¤–éƒ¨ä½œç”¨åŸŸè®¿é—®fnå†…éƒ¨å±€éƒ¨å˜é‡ï¼ˆå®ƒè¿”å›äº†å½“æ—¶çš„ä½œç”¨åŸŸï¼‰ï¼š //æ‰€ä»¥é—­åŒ…å°±æ˜¯å…¸å‹çš„é«˜é˜¶å‡½æ•° function fn() { var num = 10; return function() { console.log(num) } } var f = fn(); f(); é—­åŒ…çš„ä¸»è¦ä½œç”¨ï¼š å»¶ä¼¸äº†å˜é‡çš„ä½œç”¨èŒƒå›´ï¼ˆè¯»å–å‡½æ•°å†…éƒ¨çš„å˜é‡ï¼‰ è®©è¿™äº›å˜é‡çš„å€¼å§‹ç»ˆä¿æŒåœ¨å†…å­˜ä¸­ é—­åŒ…ç¼ºç‚¹ï¼š ç”±äºé—­åŒ…ä¼šä½¿å¾—å‡½æ•°ä¸­çš„å˜é‡éƒ½è¢«ä¿å­˜åœ¨å†…å­˜ä¸­ï¼Œå†…å­˜æ¶ˆè€—å¾ˆå¤§ï¼Œæ‰€ä»¥ä¸èƒ½æ»¥ç”¨é—­åŒ…ï¼Œå¦åˆ™ä¼šé€ æˆç½‘é¡µçš„æ€§èƒ½é—®é¢˜ï¼Œåœ¨IEä¸­å¯èƒ½å¯¼è‡´å†…å­˜æ³„éœ² åˆ©ç”¨é—­åŒ…è§£å†³å¼‚æ­¥é—®é¢˜ï¼šï¼ˆå› ä¸ºå‡½æ•°æ˜¯ä¸€ä¸ªä½œç”¨åŸŸï¼‰ //ç«‹å³æ‰§è¡Œå‡½æ•°ä¹Ÿæˆä¸ºäº†å°é—­åŒ…ï¼Œå› ä¸ºç«‹å³æ‰§è¡Œå‡½æ•°é‡Œé¢ä»»ä½•ä¸€ä¸ªå‡½æ•°éƒ½å¯ä»¥ä½¿ç”¨å®ƒçš„iå˜é‡ï¼Œæ­¤æ—¶é‡Œé¢ä½¿ç”¨å¤–å±‚içš„å‡½æ•°ï¼Œéƒ½æ˜¯é—­åŒ… for (var i = 0; i &lt; lis.length; i++) { (function (i) { lis[i].onclick = function () { console.log(i) } })(i); } å›è°ƒå‡½æ•°ï¼šè·å–å¼‚æ­¥æ“ä½œçš„ç»“æœï¼Œåªè¦ä½¿ç”¨äº†å›è°ƒå‡½æ•°ï¼Œå®é™…ä¸Šå°±æ˜¯ä½¿ç”¨é—­åŒ…â€”ã€Šä½ ä¸çŸ¥é“çš„JavaScriptã€‹ ä¸€èˆ¬æƒ…å†µä¸‹ï¼ŒæŠŠå‡½æ•°ä½œä¸ºå‚æ•°çš„ç›®çš„å°±æ˜¯ä¸ºäº†è·å–å‡½æ•°å†…éƒ¨çš„å¼‚æ­¥æ“ä½œçš„ç»“æœ //å¦‚æœéœ€è¦è·å–ä¸€ä¸ªå‡½æ•°ä¸­å¼‚æ­¥æ“ä½œçš„ç»“æœï¼Œåˆ™å¿…é¡»é€šè¿‡å›è°ƒå‡½æ•°æ¥è·å– function fn(callback) { setTimeout(function () { var data = 'hello'; callback(data); }, 1000) } fn(function (data) { console.log(data); }) é«˜é˜¶å‡½æ•°å¦‚æœä¸€ä¸ªå‡½æ•°ç¬¦åˆä¸‹é¢ä¸¤ä¸ªè§„èŒƒçš„ä»»ä½•ä¸€ä¸ªï¼Œé‚£è¯¥å‡½æ•°å°±æ˜¯é«˜é˜¶å‡½æ•° è‹¥Aå‡½æ•°ï¼Œæ¥æ”¶çš„å‚æ•°æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œé‚£ä¹ˆAå°±å¯ä»¥ç§°ä¹‹ä¸ºé«˜é˜¶å‡½æ•°ï¼ˆæ¯”å¦‚Promiseã€setTimoutï¼‰ è‹¥Aå‡½æ•°ï¼Œè°ƒç”¨çš„è¿”å›å€¼ä»ç„¶æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œé‚£ä¹ˆAå°±å¯ä»¥ç§°ä¹‹ä¸ºé«˜é˜¶å‡½æ•°ï¼ˆæ¯”å¦‚é˜²æŠ–ï¼ŒReactå®ç°ä¼ å‚çš„å›è°ƒå‡½æ•°ï¼‰ å‡½æ•°çš„æŸ¯é‡ŒåŒ– é€šè¿‡å‡½æ•°è°ƒç”¨ç»§ç»­è¿”å›å‡½æ•°çš„æ–¹å¼ï¼Œå®ç°å¤šæ¬¡æ¥æ”¶å‚æ•°æœ€åç»Ÿä¸€å¤„ç†çš„å‡½æ•°ç¼–ç å½¢å¼ï¼ˆæ¯”å¦‚Reactå®ç°ä¼ å‚çš„å›è°ƒå‡½æ•°ï¼‰ function sum(a){ return (b) => { return (c)=> { return a+b+c; } } } sum(1)(2)(3) çº¯å‡½æ•°ä¸€ç±»ç‰¹åˆ«çš„å‡½æ•° å¿…é¡»éµå®ˆä»¥ä¸‹çº¦æŸï¼š ä¸å¾—æ”¹å†™å‚æ•°æ•°æ®ï¼ˆå¦‚æœä¼ å…¥æ•°ç»„ã€å¯¹è±¡ï¼Œåˆ™ä¸èƒ½è®©ä»–ä»¬å‘ç”Ÿæ”¹åŠ¨ï¼‰ åªè¦æ˜¯åŒæ ·çš„è¾“å…¥ï¼ˆå®å‚ï¼‰ï¼Œå¿…å®šå¾—åˆ°åŒæ ·çš„è¾“å‡ºï¼ˆè¿”å›ï¼‰ ä¸ä¼šäº§ç”Ÿä»»ä½•å‰¯ä½œç”¨ï¼ˆä¾‹å¦‚ç½‘ç»œè¯·æ±‚ï¼Œè¾“å…¥å’Œè¾“å‡ºè®¾å¤‡ï¼‰ ä¸èƒ½è°ƒç”¨Date.now()æˆ–è€…Math.random()ç­‰ä¸çº¯æ–¹æ³• reduxçš„reducerå¿…é¡»æ˜¯ä¸€ä¸ªçº¯å‡½æ•° é—­åŒ…çš„æ¨¡å—æœ‰ä¸¤ä¸ªä¸»è¦çš„ç‰¹å¾ï¼ˆæºè‡ªã€Šä½ ä¸çŸ¥é“çš„JavaScriptã€‹ï¼‰ ä¸ºåˆ›å»ºå†…éƒ¨ä½œç”¨åŸŸè€Œè°ƒç”¨äº†ä¸€ä¸ªåŒ…è£…å‡½æ•° åŒ…è£…å‡½æ•°çš„è¿”å›å€¼å¿…é¡»è‡³å°‘åŒ…æ‹¬ä¸€ä¸ªå¯¹å†…éƒ¨å‡½æ•°çš„å¼•ç”¨ï¼Œè¿™æ ·å°±ä¼šåˆ›å»ºæ¶µç›–æ•´ä¸ªåŒ…å‡½æ•°å†…éƒ¨ä½œç”¨åŸŸçš„é—­åŒ… 6.é€’å½’å¦‚æœä¸€ä¸ªå‡½æ•°åœ¨å†…éƒ¨å¯ä»¥è°ƒç”¨å…¶æœ¬èº«ï¼Œåˆ™è¿™ä¸ªå‡½æ•°æ˜¯é€’å½’ï¼ˆä¿„ç½—æ–¯å¥—å¨ƒï¼‰ ä½†æ˜¯å®¹æ˜“å‘ç”Ÿâ€œæ ˆæº¢å‡ºâ€é”™è¯¯ï¼Œæ‰€ä»¥å¿…é¡»åŠ é€€å‡ºæ¡ä»¶â€œreturnâ€ æµ…æ‹·è´å’Œæ·±æ‹·è´ï¼ˆjQueryç¯‡ç›®æœ‰æåŠåˆ°ï¼ˆ$.extend([deep], target, object1, [objectN])ï¼‰ï¼‰ 1.æµ…æ‹·è´åªæ˜¯æ‹·è´ä¸€å±‚ï¼Œæ›´æ·±å±‚æ¬¡å¯¹è±¡çº§åˆ«çš„åªæ‹·è´å¼•ç”¨ 2.æ·±æ‹·è´æ‹·è´å¤šå±‚ï¼Œæ¯ä¸€çº§åˆ«çš„æ•°æ®éƒ½ä¼šæ‹·è´ ES6ä¸­æµ…æ‹·è´çš„è¯­æ³•ç³–ï¼šObject.assign(target, ...source)ï¼ˆæŠŠsourceæ‹·è´ç»™targetï¼Œå®ƒå°†è¿”å›ç›®æ ‡å¯¹è±¡ã€‚ï¼‰ const target = { a: 1, b: 2 }; const source = { b: 4, c: 5 }; const returnedTarget = Object.assign(target, source); console.log(target); // expected output: Object { a: 1, b: 4, c: 5 }ï¼ŒæŒ‰é¡ºåºè¦†ç›–æ‰åŸæ¥çš„å±æ€§ åˆ©ç”¨å¾ªç¯å†™æµ…æ‹·è´ var obj = { id: 1, name: 'andy', msg: { age: 18 } }; var o = {}; for (var k in obj) { // kæ˜¯å±æ€§åï¼Œ obj[k]æ˜¯å±æ€§å€¼ o[k] = obj[k]; } åˆ©ç”¨é€’å½’å†™æ·±æ‹·è´ ç¼ºç‚¹åœ¨äºï¼šæ€§èƒ½ä¸å¥½ï¼Œå ç”¨å†…å­˜å¾ˆå¤§ var obj = { id: 1, name: 'andy', msg: { age: 18 } }; var o = {}; function deepcopy(newobj, oldobj) { for(let k in oldobj) { // è·å–å±æ€§å€¼ const item = oldobj[k]; // åˆ¤æ–­è¯¥å€¼æ˜¯å¦å±äºæ•°ç»„(æ•°ç»„ä¹Ÿå±äºobjectï¼Œæ‰€ä»¥è¦å…ˆå†™) if(item instanceof Array) { newobj[k] = []; deepcopy(newobj[k], item); } else if(item instanceof Object) { // åˆ¤æ–­è¯¥å€¼æ˜¯å¦ä¸ºå¯¹è±¡ newobj[k] = {}; deepcopy(newobj[k], item); } else { // æ‰€ä»¥å‰©ä¸‹çš„å±äºç®€å•æ•°æ®ç±»å‹ newobj[k] = item; } } } deepcopy(o, obj); console.log(o); ä½¿ç”¨ JSON.parseå’Œ JSON.stringifyå®ç°æ·±æ‹·è´ const info = {name: \"Allen\", friends: {name: \"Khan\"}}; const newobj = JSON.parse(JSON.stringify(info)); è¿™ä¸ªæ–¹å¼çš„ç¼ºç‚¹åœ¨äºï¼šä¸èƒ½æœ‰undefinedå€¼ï¼Œä¸ç„¶å°±ä¼šå‡ºç°ä¸å¯é¢„æœŸçš„é—®é¢˜ï¼ˆæœ‰å¯èƒ½åˆ é™¤æ‰undefinedçš„å­—æ®µï¼‰ å®Œæ•´ç‰ˆæ·±æ‹·è´githubä¸Šä¸€ä¸ªå«lodashçš„åº“ï¼Œä½¿ç”¨æ·±æ‹·è´ä¹Ÿå·®ä¸å¤šæ˜¯ç±»ä¼¼çš„æ–¹æ³• const getType = obj => Object.prototype.toString.call(obj); const isObject = (target) => (typeof target === 'object' || typeof target === 'function') &amp;&amp; target !== null; const canTraverse = { '[object Map]': true, '[object Set]': true, '[object Array]': true, '[object Object]': true, '[object Arguments]': true, }; const mapTag = '[object Map]'; const setTag = '[object Set]'; const boolTag = '[object Boolean]'; const numberTag = '[object Number]'; const stringTag = '[object String]'; const symbolTag = '[object Symbol]'; const dateTag = '[object Date]'; const errorTag = '[object Error]'; const regexpTag = '[object RegExp]'; const funcTag = '[object Function]'; const handleRegExp = (target) => { const { source, flags } = target; return new target.constructor(source, flags); } const handleFunc = (func) => { // ç®­å¤´å‡½æ•°ç›´æ¥è¿”å›è‡ªèº« if(!func.prototype) return func; const bodyReg = /(?&lt;={)(.|\\n)+(?=})/m; const paramReg = /(?&lt;=\\().+(?=\\)\\s+{)/; const funcString = func.toString(); // åˆ†åˆ«åŒ¹é… å‡½æ•°å‚æ•° å’Œ å‡½æ•°ä½“ const param = paramReg.exec(funcString); const body = bodyReg.exec(funcString); if(!body) return null; if (param) { const paramArr = param[0].split(','); return new Function(...paramArr, body[0]); } else { return new Function(body[0]); } } const handleNotTraverse = (target, tag) => { const Ctor = target.constructor; switch(tag) { case boolTag: return new Object(Boolean.prototype.valueOf.call(target)); case numberTag: return new Object(Number.prototype.valueOf.call(target)); case stringTag: return new Object(String.prototype.valueOf.call(target)); case symbolTag: return new Object(Symbol.prototype.valueOf.call(target)); case errorTag: case dateTag: return new Ctor(target); case regexpTag: return handleRegExp(target); case funcTag: return handleFunc(target); default: return new Ctor(target); } } const deepClone = (target, map = new WeakMap()) => { if(!isObject(target)) return target; let type = getType(target); let cloneTarget; if(!canTraverse[type]) { // å¤„ç†ä¸èƒ½éå†çš„å¯¹è±¡ return handleNotTraverse(target, type); }else { // è¿™æ³¢æ“ä½œç›¸å½“å…³é”®ï¼Œå¯ä»¥ä¿è¯å¯¹è±¡çš„åŸå‹ä¸ä¸¢å¤±ï¼ let ctor = target.constructor; cloneTarget = new ctor(); } if(map.get(target)) return target; map.set(target, true); if(type === mapTag) { //å¤„ç†Map target.forEach((item, key) => { cloneTarget.set(deepClone(key, map), deepClone(item, map)); }) } if(type === setTag) { //å¤„ç†Set target.forEach(item => { cloneTarget.add(deepClone(item, map)); }) } // å¤„ç†æ•°ç»„å’Œå¯¹è±¡ for (let prop in target) { if (target.hasOwnProperty(prop)) { cloneTarget[prop] = deepClone(target[prop], map); } } return cloneTarget; } immutable.jsçš„æ‹·è´ä¹Ÿå€¼å¾—æ¢è®¨ï¼ˆè®°ä½æ˜¯æµ…æ‹·è´ï¼Œå¦‚æœæ•°æ®ç±»å‹å¤æ‚ï¼Œåœ¨é‡Œé¢è¿˜å¾—ç»§ç»­åŒ…è£¹immutableçš„Mapï¼‰ å®ƒçš„å®ç°åŸç†æ˜¯persistent data structureï¼ˆæŒä¹…åŒ–æ•°æ®ç»“æ„ï¼‰ï¼Œä¹Ÿå°±æ˜¯ä½¿ç”¨æ—§æ•°æ®åˆ›å»ºæ–°æ•°æ®æ—¶ï¼Œä¿è¯æ—§æ•°æ®åŒæ—¶å¯ç”¨ä¸”ä¸å˜ï¼ŒåŒæ—¶é¿å…äº†deepcopyæŠŠæ‰€æœ‰çš„èŠ‚ç‚¹éƒ½å¤åˆ¶ä¸€éå¸¦æ¥çš„æ€§èƒ½æŸè€—ï¼Œimmutableä½¿ç”¨äº†structural sharingï¼ˆç»“æ„å…±äº«ï¼‰ï¼Œå³å¦‚æœå¯¹è±¡æ ‘ä¸­ä¸€ä¸ªèŠ‚ç‚¹å‘ç”Ÿå˜åŒ–ï¼Œåªä¿®æ”¹è¿™ä¸ªèŠ‚ç‚¹å’Œå—ä»–å½±å“çš„çˆ¶èŠ‚ç‚¹ï¼Œåˆ™å…¶ä»–èŠ‚ç‚¹è¿›è¡Œå…±äº« æ¯”å¦‚è¯´ a = { b1: { c1:{ d1: 1 }, c2:{} }, b2:{ c3:{} } } æ­¤æ—¶é€šè¿‡ immutable æ‹·è´å¾—åˆ°å¯¹è±¡ a2ï¼Œå°†é‡Œé¢çš„c1è¿›è¡Œæ›´æ”¹ï¼Œæ­¤æ—¶ä¸ä¼šå½±å“åˆ°åŸæ¥çš„å¯¹è±¡ï¼Œè€Œæ˜¯ä»c1åˆ†è£‚æ–°ç”Ÿæˆä¸€ä¸ªæ–°çš„èŠ‚ç‚¹ï¼Œç„¶åb1ï¼Œaè·Ÿç€å˜ï¼Œå¾—åˆ°ä¸€ä¸ªæ—¢å’Œaå…±äº«éƒ¨åˆ†æ•°æ®ï¼Œåˆæœ‰è‡ªå·±çš„æ–°æ•°æ®çš„å¯¹è±¡ ä»è¿™å¼ å›¾å¯ä»¥çœ‹åˆ°æ¸…æ¥šçš„ååº”2165169-cebb05bca02f1772 (613Ã—575) (jianshu.io) è€Œè¿™ç¯‡æ–‡ç« ç”¨äºåŠ æ·±immutableçš„åŸç†https://zhuanlan.zhihu.com/p/44571842 ä½†æ˜¯è¿™ç§ä¸ºäº†ä¿æŒçŠ¶æ€çš„åœºæ™¯æ¯”è¾ƒé€‚ç”¨äºreactçš„reduxï¼ˆçº¯å‡½æ•°ï¼‰ï¼Œå¦‚æœæ˜¯vueçš„è¯å°±æ²¡å¿…è¦è€ƒè™‘è¿™ä¹ˆéº»çƒ¦ 7.æ­£åˆ™è¡¨è¾¾å¼æ¦‚è¿°æ­£åˆ™è¡¨è¾¾å¼ï¼ˆregular expressionï¼‰æ˜¯ç”¨äºåŒ¹é…å­—ç¬¦ä¸²ä¸­å­—ç¬¦ç»„åˆçš„æ¨¡å¼ï¼Œå†JavaScriptï¼Œæ­£åˆ™è¡¨è¾¾å¼ä¹Ÿæ˜¯å¯¹è±¡ æ­£åˆ™è¡¨è¾¾å¼é€šå¸¸ç”¨æ¥åšæ£€ç´¢ï¼Œæ›¿æ¢é‚£äº›ç¬¦åˆæŸä¸ªæ¨¡å¼ï¼ˆè§„åˆ™ï¼‰çš„æ–‡æœ¬ï¼Œä¾‹å¦‚æ˜µç§°è¾“å…¥æ¡†é‡Œçš„å¯¹ä¸­æ–‡çš„åŒ¹é…ï¼›æ­¤å¤–ï¼Œæ­£åˆ™è¡¨è¾¾å¼è¿˜å¸¸ç”¨äºè¿‡æ»¤æ‰é¡µé¢ä¸€äº›æ•æ„Ÿï¼ˆæ›¿æ¢ï¼‰ï¼Œæˆ–è€…ä»å­—ç¬¦ä¸²è·å–æˆ‘ä»¬æƒ³è¦çš„ç‰¹å®šéƒ¨åˆ†ï¼ˆæå–ï¼‰ç­‰ ç‰¹ç‚¹ï¼š1.çµæ´»æ€§ã€é€»è¾‘æ€§ã€åŠŸèƒ½æ€§éå¸¸å¼º 2.å¯ä»¥è¿…é€Ÿç”¨æç®€çš„å½¢å¼è¾¾åˆ°å¯¹å­—ç¬¦ä¸²å¤æ‚çš„æ§åˆ¶ 3.å¯¹åˆšæ¥è§¦çš„äººæ¥è¯´ï¼Œæ¯”è¾ƒæ™¦æ¶©éš¾æ‡‚ 4.ä¸€èˆ¬å®é™…å¼€å‘ï¼Œéƒ½æ˜¯ç›´æ¥å¤åˆ¶å†™å¥½çš„æ­£åˆ™è¡¨è¾¾å¼ï¼Œä½†æ˜¯è¦æ±‚ä¼šä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼ä¸”æ ¹æ®å®é™…æƒ…å†µä¿®æ”¹æ­£åˆ™è¡¨è¾¾å¼ åº”ç”¨1.é€šè¿‡è°ƒç”¨RegExpå¯¹è±¡çš„æ„é€ å‡½æ•°åˆ›å»º var å˜é‡å = new RegExp(/è¡¨è¾¾å¼/ä¿®é¥°ç¬¦) var å˜é‡å = new RegExp(&#39;è¡¨è¾¾å¼&#39;, &#39;ä¿®é¥°ç¬¦&#39;) 2.é€šè¿‡å­—é¢é‡åˆ›å»º var å˜é‡å = /è¡¨è¾¾å¼/ä¿®é¥°ç¬¦ï¼ˆæ­£åˆ™è¡¨è¾¾å¼ä¸éœ€è¦åŠ å¼•å·ï¼Œä¸ç®¡æ˜¯æ•°å­—å‹è¿˜æ˜¯å­—ç¬¦ä¸²å‹ï¼‰ æµ‹è¯•æ­£åˆ™è¡¨è¾¾å¼æ˜¯å¦ç¬¦åˆè¯­æ³•è§„èŒƒï¼štest() æ­£åˆ™å¯¹è±¡æ–¹æ³•ï¼Œç”¨äºæ£€æµ‹å­—ç¬¦ä¸²æ˜¯å¦ç¬¦åˆè¯¥è§„åˆ™ï¼Œè¯¥å¯¹è±¡ä¼šè¿”å›trueæˆ–falseï¼Œå…¶å‚æ•°æ˜¯æµ‹è¯•å­—ç¬¦ä¸² regexObj.test(str) ï¼ˆåªè¦åŒ…å«æœ‰strè¿™ä¸ªå­—ç¬¦ä¸²ï¼Œè¿”å›çš„éƒ½æ˜¯trueï¼‰ var rg = /123/; var rg2 = /123/g; console.log(rg.test(123)); //true console.log(rg.test(12123)); //true gï¼šå…¨å±€æ¨¡å¼ï¼ŒæŸ¥æ‰¾å­—ç¬¦ä¸²å…¨éƒ¨å†…å®¹ï¼Œå†æ¬¡åŒ¹é…æ—¶ä¼šå‘å‰æœç´¢ä¸‹ä¸€ä¸ªåŒ¹é…é¡¹ iï¼šä¸åŒºåˆ†å¤§å°å†™ mï¼šå¤šè¡Œæ¨¡å¼ï¼Œè¡¨ç¤ºæŸ¥æ‰¾åˆ°ä¸€è¡Œæœ«å°¾ä¼šç»§ç»­æŸ¥æ‰¾ yï¼šç²˜é™„æ¨¡å¼ï¼Œæ¯æ¬¡è°ƒç”¨exec()å°±åªä¼šåœ¨lastIndexçš„ä½ç½®ä¸Šå¯»æ‰¾åŒ¹é…å­—æ®µ uï¼šUnicodeæ¨¡å¼ sï¼šdotAllæ¨¡å¼ï¼Œè¡¨ç¤ºå…ƒå­—ç¬¦ . å¯ä»¥åŒ¹é…ä»»ä½•å­—ç¬¦ let a = \"address_address\"; let rg = /a/g; let reg = new RegExp(a, \"g\") //åœ¨æ­£åˆ™ä¸­ä½¿ç”¨å˜é‡ rg.test(\"å­—ç¬¦ä¸²\"); //æ˜¯å¦åŒ…å«è¯¥å­—ç¬¦ä¸²ï¼Œè¿”å›å¸ƒå°”å€¼ eval(`/a${a}/`).test(\"å­—ç¬¦ä¸²\") //åœ¨æ­£åˆ™ä¸­ä½¿ç”¨å˜é‡ + å…¶ä»–å­—ç¬¦ a.match(rg); //è¿”å›åŒ¹é…çš„å­—ç¬¦ä¸² + å…·ä½“ä¿¡æ¯ï¼Œè‹¥æ­£åˆ™å¯ç”¨å…¨å±€æ¨¡å¼ï¼Œåˆ™è¿”å›ä¸€ä¸ªæ•°ç»„ï¼ŒåŒ… å«æ‰€æœ‰åŒ¹é…çš„å­—ç¬¦ä¸² rg.exec(a); //å’Œmatchå·®ä¸å¤šï¼Œä¸è¿‡ä¸ä¼šå› ä¸ºå…¨å±€æ¨¡å¼æ”¹å˜è¿”å›å€¼ï¼Œå¦‚æœå¼€å…¨å±€æ¨¡å¼ï¼Œä¸‹æ¬¡ å†åŒ¹é…ä¸€æ¬¡ï¼Œåˆ™ä»lastIndexå¼€å§‹åŒ¹é…ï¼Œåœ¨è¿™é‡Œä¹Ÿå°±æ˜¯ä» ä¸‹æ ‡ä¸º1çš„d å¼€å§‹åŒ¹é… ç‰¹æ®Šå­—ç¬¦ä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼å¯ä»¥ç”±ç®€å•çš„å­—ç¬¦æ„æˆï¼Œæ¯”å¦‚/abc/ï¼Œ ä¹Ÿå¯ä»¥æ˜¯ç®€å•å’Œç‰¹æ®Šå­—ç¬¦ä¸²çš„ç»„åˆï¼Œæ¯”å¦‚/ab*c/ã€‚å…¶ä¸­ç‰¹æ®Šå­—ç¬¦ä¹Ÿè¢«ç§°ä¸ºå…ƒå­—ç¬¦ï¼Œåœ¨æ­£åˆ™è¡¨è¾¾å¼ä¸­å…·æœ‰ç‰¹æ®Šæ„ä¹‰çš„ä¸“ç”¨ç¬¦å·ï¼Œå¦‚^ ã€$ ã€+ ç­‰ ï¼ˆåŒ¹é…ç‰¹æ®Šå­—ç¬¦å‰é¢å¢åŠ  \\å°±å¯ä»¥äº†ï¼‰ æ­£åˆ™è¡¨è¾¾å¼é€ŸæŸ¥è¡¨ï¼šhttps://www.runoob.com/regexp/regexp-metachar.html è¾¹ç•Œç¬¦ï¼š^ è¡¨ç¤ºåŒ¹é…è¡Œé¦–çš„æ–‡æœ¬ï¼ˆä»¥è°å¼€å§‹ï¼‰ $ è¡¨ç¤ºåŒ¹é…è¡Œå°¾çš„æ–‡æœ¬ï¼ˆä»¥è°ç»“æŸï¼‰ var rg = /^abc/; console.log(rg.test('abcd')); //true console.log(rg.test('babc')); //false //å¿…é¡»æ˜¯abc,ç±»ä¼¼å…¨ç­‰ var rg2 = /^abc$/; console.log(rg.test('abcd')); //false console.log(rg.test('abcabc')); //false å­—ç¬¦ç±»ï¼š[]è¡¨ç¤ºæœ‰ä¸€ç³»åˆ—å­—ç¬¦å¯ä¾›é€‰æ‹©ï¼Œåªè¦åŒ¹é…åˆ°å…¶ä¸­ä¸€ä¸ªå°±å¯ä»¥äº† var rg = /[abc]/; //åªè¦åŒ…å«æœ‰aæˆ–è€…bæˆ–è€…cå°±è¿”å›true console.log(rg.test('andy')); //è¿”å›true //var rg = /^[abc]$/ æ˜¯ä¸‰é€‰ä¸€ï¼Œåªæœ‰æ˜¯å•ä¸ªaæˆ–è€…bæˆ–è€…cæ‰è¿”å›true []ä½¿ç”¨èŒƒå›´ç¬¦å· - var rg = /^[a-z]$/; //26ä¸ªè‹±æ–‡å°å†™å­—æ¯ä»»ä½•ä¸€ä¸ªå­—æ¯éƒ½è¿”å›true var rg1 = /^[a-zA-Z]$/; //26ä¸ªè‹±æ–‡å­—æ¯ä»»ä½•ä¸€ä¸ªå­—æ¯éƒ½è¿”å›true var rg2 = /^[a-z0-9_-]$/; //ä»»ä½•å•ä¸ª26å°å†™å­—æ¯ï¼Œ0-9æ•°å­—ï¼Œ_, -,éƒ½è¿”å›true []é‡Œä½¿ç”¨^ï¼šå¦‚æœä¸­æ‹¬å·é‡Œæœ‰^è¡¨ç¤ºå–åçš„æ„æ€ï¼Œåƒä¸‡åˆ«å’Œè¾¹ç•Œç¬¦^æ··æ·†ï¼Œè¦åŒºåˆ†å¼€æ¥ var rg = /^[^a-z]$/; //26ä¸ªè‹±æ–‡å°å†™å­—æ¯ä»»ä½•ä¸€ä¸ªå­—æ¯éƒ½è¿”å›false é‡è¯ç¬¦ï¼šç”¨æ¥è®¾å®šæŸä¸ªæ¨¡å¼å‡ºç°çš„æ¬¡æ•°ï¼Œæœ‰*ã€ +ã€ ?ã€ {}ï¼Œ{}çš„é‡è¯é—´ä¸è¦æœ‰ç©ºæ ¼ï¼Œå¯ä»¥ç”¨testæ¥æ£€æµ‹ä¸‹æ–¹æ­£åˆ™è¡¨è¾¾å¼ var rg = /^a*$/; //aå¯ä»¥å‡ºç°0-næ¬¡ï¼Œn>=0 var rg1 = /^a+$/; //aå¯ä»¥å‡ºç°1-næ¬¡ï¼Œn>=1 var rg2 = /^a?$/; //aå¯ä»¥å‡ºç°1æˆ–0æ¬¡ (?ä¹Ÿå¯ä»¥è¡¨ç¤ºç¦æ­¢è´ªå©ªï¼Œå¾€æœ€å°‘çš„åŒ¹é…æ–¹å¼å»é€‰æ‹©) var rg3 = /^a{3}$/; //aåªèƒ½å¯ä»¥å‡ºç°3æ¬¡ var rg4 = /^a{3,}$/; //aåªå¯ä»¥å‡ºç°3-næ¬¡ n>=3 var rg5 = /^a{3,16}$/; //aåªå¯ä»¥å‡ºç°3-16æ¬¡ //æ™®éçš„ç”¨æˆ·åè§„å®šï¼š var name = /^[a-zA-Z0-9_-]{6,16}$/ æ‹¬å·æ€»ç»“ []ä¸­æ‹¬å·ï¼šå­—ç¬¦é›†åˆï¼ŒåŒ¹é…æ–¹æ‹¬å·ä¸­çš„ä»»æ„å­—ç¬¦ {} å¤§æ‹¬å·ï¼šé‡è¯ç¬¦ï¼Œé‡Œé¢è¡¨ç¤ºé‡å¤æ¬¡æ•°ï¼Œä½†åªè®©å¤§æ‹¬å·å‰é¢ä¸€ä¸ªå­—ç¬¦é‡å¤ ï¼ˆæ³¨æ„ï¼š/^abc{3}$/ï¼Œåªè®©cé‡å¤ä¸‰æ¬¡ï¼Œå³abcccï¼‰ () å°æ‹¬å·ï¼šè¡¨ç¤ºä¼˜å…ˆçº§ å¯ä»¥ç”¨æ¥ï¼š/^(abc){3}$/ï¼Œè¡¨ç¤ºè®©abcé‡å¤ä¸‰æ¬¡ï¼Œå³abcabc é¢„å®šä¹‰ç±»\\d åŒ¹é…åˆ°0-9ä»»æ„ä¸€æ•°å­—ï¼Œç›¸å½“äº[0-9] (var rg = /\\d/; æˆ–è€… let reg = new RegExp(&quot;\\\\d&quot;)) \\D åŒ¹é…åˆ°0-9ä»¥å¤–çš„æ•°å­—ï¼Œç›¸å½“äº[^0-9] \\w åŒ¹é…ä»»æ„å­—æ¯ã€æ•°å­—ã€ä¸‹åˆ’çº¿ï¼Œç›¸å½“äº[A-Za-z0-9_] \\WåŒ¹é…é™¤å­—æ¯æ•°å­—ä¸‹åˆ’çº¿ä»¥å¤–çš„å­—ç¬¦ï¼Œç›¸å½“äº[^A-Za-z0-9_] \\s åŒ¹é…ç©ºæ ¼ï¼ˆåŒ…æ‹¬æ¢è¡Œç¬¦ã€åˆ¶è¡¨ç¬¦ã€ç©ºæ ¼ç¬¦ç­‰ï¼‰ï¼Œç›¸å½“äº[\\t\\r\\n\\v\\f] \\SåŒ¹é…éç©ºæ ¼å­—ç¬¦ï¼Œç›¸å½“äº[^\\t\\r\\n\\v\\f] æ­£åˆ™é‡Œçš„ â€œæˆ–è€…ç¬¦å·â€ï¼š| (var rg = /^\\d{3}-\\d{8}|\\d{4}-\\d{7}$/;) . é™¤äº†æ¢è¡Œå¤–çš„ä»»ä½•å­—ç¬¦ æ­£åˆ™æ›¿æ¢replace()æ–¹æ³•å¯ä»¥å®ç°æ›¿æ¢å­—ç¬¦ä¸²çš„æ“ä½œï¼Œç”¨æ¥æ›¿æ¢çš„å‚æ•°å¯ä»¥æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²æˆ–è€…æ˜¯ä¸€ä¸ªå­—ç¬¦è¡¨è¾¾å¼ stringObject.replace(regexp/substr, replacement) var str = 'red and blue and red'; var newstr = str.replace('red', 'yellow'); //ç»“æœä¸ºyellow and blue and red //var newstr = str.replace(/red/, 'yellow'); åŒç† ä½†æ˜¯replaceåªèƒ½æ›¿æ¢æ‰ç¬¬ä¸€ä¸ªåŒ¹é…çš„å­—ç¬¦/æ­£åˆ™è¡¨è¾¾å¼ï¼Œæ— æ³•æ»¡è¶³æ›¿æ¢æ‰å¤šä¸ªæ•æ„Ÿè¯ å¯ä»¥ä½¿ç”¨: /è¡¨è¾¾å¼/[switch] swtichä¹Ÿæˆä¸ºä¿®é¥°ç¬¦ï¼Œå³æŒ‰ç…§ä»€ä¹ˆæ ·çš„æ¨¡å¼æ¥åŒ¹é… var str = 'red and blue and red'; var newstr = str.replace(/red/g, 'yellow'); //ç»“æœä¸ºyellow and blue and yellow 8.ä½œç”¨åŸŸè¯æ³•ä½œç”¨åŸŸï¼šæ˜¯ä¸€å¥—å…³äºå¼•æ“å¦‚ä½•å¯»æ‰¾å˜é‡ä»¥åŠä¼šåœ¨ä½•å¤„æ‰¾åˆ°å˜é‡çš„è§„åˆ™ã€‚è¯æ³•ä½œç”¨åŸŸæœ€é‡è¦çš„ç‰¹å¾æ˜¯ä»–å®šä¹‰è¿‡ç¨‹å‘ç”Ÿåœ¨ä»£ç çš„ä¹¦å†™é˜¶æ®µï¼ˆé™¤äº†evalå’Œwithï¼‰ åŠ¨æ€ä½œç”¨åŸŸï¼šæ˜¯JavaScriptå¦ä¸€ä¸ªé‡è¦æœºåˆ¶thisçš„è¡¨äº²ï¼Œå®ƒè®©ä½œç”¨åŸŸä½œä¸ºä¸€ä¸ªè¿è¡Œæ—¶è¢«åŠ¨æ€ç¡®å®šçš„å½¢å¼ï¼Œè€Œä¸æ˜¯åœ¨å†™ä»£ç æ—¶è¿›è¡Œé™æ€ç¡®å®šçš„å½¢å¼ã€‚ åŒºåˆ«æ˜¯è¯æ³•ä½œç”¨åŸŸæ˜¯å†™ä»£ç æ—¶ç¡®å®šï¼ŒåŠ¨æ€ä½œç”¨åŸŸæ˜¯è¿è¡Œæ—¶ç¡®å®š äº‹å®ä¸ŠJavaScriptå¹¶ä¸å…·å¤‡åŠ¨æ€ä½œç”¨åŸŸï¼Œä»–åªæœ‰è¯æ³•ä½œç”¨åŸŸï¼Œç®€å•æ˜äº†ï¼Œä½†æ˜¯thisæœºåˆ¶æŸç§ç¨‹åº¦åƒå¾ˆåƒåŠ¨æ€ä½œç”¨åŸŸ function foo(){ console.log(a); } function bar(){ var a = 3; foo(); } var a = 2; bar(); //2 å¦‚æœJavaScriptå…·æœ‰åŠ¨æ€ä½œç”¨åŸŸï¼Œåˆ™ä¼šè¾“å‡º3ï¼ ä»å¦å¤–ä¸€ä¸²ä»£ç çœ‹è¯æ³•ä½œç”¨åŸŸ function bar(){ var a = 3; function foo(){ console.log(a); } foo(); } var a = 2; bar(); //3","categories":[{"name":"å‰ç«¯","slug":"å‰ç«¯","permalink":"https://taylor12138.github.io/categories/%E5%89%8D%E7%AB%AF/"}],"tags":[],"author":"Hello"},{"title":"çº¢å®ä¹¦å•ƒè¯»note(ä¸Š)","slug":"çº¢å®ä¹¦å•ƒè¯»note(ä¸Š)","date":"2022-04-07T06:26:45.318Z","updated":"2022-10-18T03:35:37.986Z","comments":true,"path":"2022/04/07/hong-bao-shu-ken-du-note-shang/","link":"","permalink":"https://taylor12138.github.io/2022/04/07/hong-bao-shu-ken-du-note-shang/","excerpt":"","text":"ç¬¬1ã€2ç« ï¼ˆJavaScriptï¼‰Scriptæ ‡ç­¾ åœ¨Scriptæ ‡ç­¾é‡Œé¢ä¸è¦å‡ºç° console.log(\"&lt;/script>\") //ä¼šæŠŠå®ƒå½“æˆscriptç»“æŸæ ‡ç­¾ï¼Œå³ä½¿æ˜¯å­—ç¬¦ä¸²ä¹Ÿä¸å¯ä»¥ï¼Œä½†æ˜¯é™¤é console.log(\"&lt;\\/script>\") å¯ä»¥ä½¿ç”¨asyncä»£æ›¿ DOMContentLoadedäº‹ä»¶è¿›è¡Œ å¼‚æ­¥æ“ä½œï¼ˆå¹¶ä¸æ˜¯æ‰€æœ‰æµè§ˆå™¨éƒ½æ”¯æŒasyncï¼‰ï¼Œä½¿å¾—é¡µé¢ä¿è¯domæ¸²æŸ“å®Œæ¯•åå†æ‰§è¡Œjsæ–‡ä»¶ï¼Œåªæ˜¯ä¸èƒ½ä¿è¯æ‰§è¡Œæ¬¡åº deferåªå¯¹å¤–éƒ¨è„šæœ¬æœ‰æ•ˆï¼ŒæŒ‰ç…§åŠ è½½é¡ºåºæ‰§è¡Œè„šæœ¬çš„ï¼Œè¿™ä¸€ç‚¹è¦å–„åŠ åˆ©ç”¨ asyncä¸èƒ½ä¿è¯å¤šä¸ªscriptæ ‡ç­¾äº‹ä»¶æ‰§è¡Œçš„é¡ºåºï¼ŒåŠ è½½å®Œäº†å°±ä¼šç«‹åˆ»æ‰§è¡Œ noscriptæ ‡ç­¾ï¼šå½“æµè§ˆå™¨ç¦ç”¨JavaScriptï¼Œæˆ–è€…å¯¹è„šæœ¬çš„æ”¯æŒå…³é—­æ—¶å¯ä»¥ä½¿ç”¨ &lt;script async src=\"xxxx\"> &lt;/script> &lt;script defer src=\"xxxx\"> &lt;/script> ç¬¬3ç« ï¼ˆè¯­è¨€åŸºç¡€ï¼‰æ ‡è¯†ç¬¦ç¬¬ä¸€ä¸ªå­—ç¬¦ä¸èƒ½ä¸ºæ•°å­— æ¨èè¯­å¥ä»¥åˆ†å·ç»“å°¾ï¼Œé™¤äº†æ˜¯ä¸€ä¸ªå¥½ä¹ æƒ¯ä¹‹å¤–ï¼Œæœ‰åŠ©äºåœ¨æŸäº›æƒ…å†µæå‡æ€§èƒ½ å˜é‡åœ¨ä¸åˆå§‹åŒ–(ç›´æ¥ var a; )çš„æƒ…å†µä¸‹ï¼Œä¼šä¿å­˜ä¸€ä¸ªç‰¹æ®Šå€¼ï¼šâ€undefinedâ€ å®šä¹‰ä¸€ä¸ªå°†æ¥è¦ä¿å­˜å¯¹è±¡å€¼çš„å˜é‡æ—¶ï¼Œå»ºè®®ä½¿ç”¨nullåˆå§‹åŒ– undefined æ˜¯ç”± null æ´¾ç”Ÿå‡ºæ¥çš„ï¼Œæ‰€ä»¥ null == undefined // true undefinedè¢«è®¾è®¡æ˜¯å¸Œæœ›è¡¨ç¤ºä¸€ä¸ªå˜é‡æœ€åŸå§‹çš„çŠ¶æ€ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡undefinedæ¥åˆ¤æ–­æ”¹å˜é‡æ˜¯å¦å­˜åœ¨ï¼Œæˆ–è€…æ˜¯å¦è¢«èµ‹å€¼ï¼ˆåˆå§‹åŒ–ï¼‰ å½“ä¸€ä¸ªå¯¹è±¡è¢«èµ‹å€¼äº†null ä»¥åï¼ŒåŸæ¥çš„å¯¹è±¡åœ¨å†…å­˜ä¸­å°±å¤„äºæ¸¸ç¦»çŠ¶æ€ï¼ŒGC ä¼šæ‹©æœºå›æ”¶è¯¥å¯¹è±¡å¹¶é‡Šæ”¾å†…å­˜ã€‚å› æ­¤ï¼Œå¦‚æœéœ€è¦é‡Šæ”¾æŸä¸ªå¯¹è±¡ï¼Œå°±å°†å˜é‡è®¾ç½®ä¸º nullï¼Œå³è¡¨ç¤ºè¯¥å¯¹è±¡å·²ç»è¢«æ¸…ç©ºï¼Œç›®å‰æ— æ•ˆçŠ¶æ€ã€‚ ifè¯­å¥ ä¼šè‡ªåŠ¨æ‰§è¡Œå…¶ä»–ç±»å‹çŸ¥é“å¸ƒå°”å€¼çš„è½¬æ¢ï¼Œæ³¨æ„ä»¥ä¸‹å‡ ä¸ªä¼šè¢«è½¬åŒ–ä¸ºfalseï¼š(å…¶ä»–çš„ä¸€èˆ¬éƒ½æ˜¯true) false â€œâ€ 0ã€NAN null undefined NANï¼šéæ•°å€¼ï¼Œä¸ç­‰äºåŒ…æ‹¬NANåœ¨å†…çš„ä»»ä½•å€¼ï¼Œä½†æ˜¯æœ‰ä¸€ä¸ªisNAN() å‡½æ•° å­—ç¬¦ä¸² å­—ç¬¦ä¸²ä¸€æ—¦åˆ›å»ºï¼Œä¸å¯æ”¹å˜ï¼Œä¸€èˆ¬æˆ‘ä»¬ä¿®æ”¹å­—ç¬¦ä¸²ï¼Œéƒ½æ˜¯é”€æ¯åŸå…ˆçš„å­—ç¬¦ä¸²ï¼Œç„¶åæŠŠæ–°çš„å¦ä¸€ä¸ªå­—ç¬¦ä¸²ä¿å­˜åˆ°è¯¥å˜é‡ let lang = 'Java'; lang += 'Script' //æ”¹å˜ï¼Œè¿›è¡Œé”€æ¯ + èµ‹å€¼ å˜é‡æå‡ ç”±äºå˜é‡æå‡éœ€è¦æŸ¥çœ‹æ˜¯å¦æœ‰varæˆ–è€…functionï¼Œæ‰€ä»¥éœ€è¦æ³¨æ„ console.log(a); //undefined var a = 100 //ä¼šå˜é‡æå‡ console.log(a); //æŠ¥é”™ a is not defined a = 100 //ä¸ä¼šå˜é‡æå‡,ä½†æ˜¯å³ä½¿åœ¨å‡½æ•°å†…éƒ¨å£°æ˜ä¹Ÿä¼šåˆ›å»ºä¸€ä¸ªå…¨å±€å˜é‡ï¼Œä¼šå¯¼è‡´å†…å­˜æ³„æ¼ å¯¹è±¡æ–¹æ³• Object.getOwnPropertyNames(obj1)è¿”å›å¯¹è±¡å®ä¾‹çš„å¸¸è§„å±æ€§æ•°ç»„ï¼Œæ¯”å¦‚ [name, value] Object.getOwnPropertySymbols(obj1)è¿”å›å¯¹è±¡å®ä¾‹çš„ç¬¦å·å±æ€§æ•°ç»„ï¼Œæ¯”å¦‚ [Symbol(foo), Symbol(bar)] è¿™ä¸¤ç§æ–¹æ³•äº’æ–¥ï¼Œä½†ï¼š Object.getOwnPropertyDescriptors(obj1)è¿”å›å¯¹è±¡å®ä¾‹çš„ç¬¦å· + å¸¸è§„å±æ€§çš„å¯¹è±¡ é€’å¢é€’å‡æ“ä½œç¬¦ &amp; ä¸€å…ƒåŠ å’Œå‡ å¯¹äºå¸ƒå°”å€¼ï¼Œå¦‚æœæ˜¯falseï¼Œåˆ™è½¬ä¸º0å†åšç›¸åº”æ”¹å˜ï¼›å¦‚æœä¸ºtrueï¼Œåˆ™è½¬ä¸º1å†åšç›¸åº”æ”¹å˜ let s1 = '2', s2 = false; s1++ //å€¼å˜æˆäº†æ•°å€¼3 s2++ //å€¼å˜æˆäº†æ•°å€¼1 è€Œä¸€å…ƒåŠ å’Œå‡ï¼Œä¹Ÿä¼šæ‰§è¡Œä¸Number()ç›¸ä¼¼çš„ç±»å‹è½¬æ¢ let s1 = false, s2 = \"1.1\"; s1 = +s1; //å¾—åˆ°æ•°å€¼0 s2 = -s2; //å¾—åˆ°æ•°å€¼-1.1 å·¦å³ç§»å’Œæ— ç¬¦å·å·¦å³ç§» æ­£å¸¸å·¦ç§»æ“ä½œå’Œå³ç§»æ“ä½œéƒ½æ˜¯ç›´æ¥è®©æ•°å€¼ä»¥äºŒè¿›åˆ¶å½¢å¼è¿›è¡Œç§»åŠ¨ã€‚ è€Œæ— ç¬¦å·å³ç§»ï¼ˆ&gt;&gt;&gt;ï¼‰ï¼Œå¯¹äºæ­£æ•°æ¥è¯´ï¼Œå’Œå³ç§»&gt;&gt;æ“ä½œä¸€æ ·ï¼›å¯¹äºè´Ÿæ•°æ¥è¯´ï¼Œä¼šå‡ºç°å·¨å¤§çš„å·®å¼‚ï¼Œæ— ç¬¦å·å³ç§»ä¼šç»§ç»­ç»™ç©ºä½è¡¥0 è€Œè´Ÿæ•°æ˜¯ä»¥ä¸€ç§äºŒè¡¥æ•°çš„äºŒè¿›åˆ¶ç¼–ç å­˜å‚¨ï¼Œä¹Ÿå°±æ˜¯ å…ˆè½¬æ­£æ•°çš„äºŒè¿›åˆ¶ 0 -&gt; 1, 1 -&gt; 0 ç»“æœ +1 let oldValue = -64 let newValue = oldValue >>> 5; //å¾—åˆ°134217726 åŠ æ€§æ“ä½œç¬¦ å½“ä¸¤ä¸ªæ“ä½œæ•°ï¼Œåªæœ‰ä¸€ä¸ªä¸ºå­—ç¬¦ä¸²æ—¶ï¼Œå¦å¤–ä¸€ä¸ªä¼šè½¬å˜ä¸ºå­—ç¬¦ä¸²ï¼Œç„¶åæ‹¼æ¥ let a = 1 + '1'; // \"11\" \"12\" + null //\"12null\" å‡æ³•æ“ä½œç¬¦ å½“ä»»æ„ä¸€ä¸ªæ“ä½œæ•°æ˜¯å­—ç¬¦ä¸²ã€å¸ƒå°”å€¼ã€nullæˆ–undefinedï¼Œåˆ™å…ˆåœ¨åå°ä½¿ç”¨Number()è½¬æ¢ä¸ºæ•°å€¼ï¼Œè‹¥æ˜¯å¯¹è±¡åˆ™è°ƒç”¨å…¶valueOf()æ–¹æ³•å–å¾—è¡¨ç¤ºå®ƒçš„æ•°å€¼ == å’Œ ===ã€Object.is() ==å’Œ !=éƒ½ä¼šå…ˆè¿›è¡Œç±»å‹è½¬æ¢ï¼ˆå¼ºåˆ¶ç±»å‹è½¬æ¢ï¼‰ï¼Œå†ç¡®å®šæ“ä½œæ•°æ˜¯å¦ç›¸ç­‰ è€Œ === å’Œ !== éƒ½ä¸ä¼šè½¬æ¢æ“ä½œæ•° Object.is()ç¡®å®šä¸¤ä¸ªå€¼æ˜¯å¦ç›¸åŒã€‚å¦‚æœä»¥ä¸‹æ¡ä»¶ä¹‹ä¸€æˆç«‹ï¼Œåˆ™ä¸¤ä¸ªå€¼ç›¸åŒï¼š ä¸¤è€… undefined ä¸¤è€… null ä¸¤è€…trueæˆ–ä¸¤è€…false ç›¸åŒé•¿åº¦çš„ä¸¤ä¸ªå­—ç¬¦ä¸²ä»¥ç›¸åŒçš„é¡ºåºå…·æœ‰ç›¸åŒçš„å­—ç¬¦ ä¸¤è€…éƒ½æ˜¯åŒä¸€ä¸ªå¯¹è±¡ï¼ˆæ„å‘³ç€ä¸¤ä¸ªå€¼éƒ½å¼•ç”¨äº†å†…å­˜ä¸­çš„åŒä¸€ä¸ªå¯¹è±¡ï¼‰ æ•°å­—å’Œ ä¸¤è€… +0 ä¸¤è€… -0 ä¸¤è€… NaN æˆ–ä¸¤è€…éƒ½éé›¶ä¸”ä¸¤è€…éƒ½ä¸æ˜¯NaNä¸”ä¸¤è€…éƒ½å…·æœ‰ç›¸åŒçš„å€¼ è¿™æ˜¯ä¸ä¸€æ ·æ ¹æ®ç­‰äº ==è¿ç®—ç¬¦ã€‚è¯¥ ==è¿è¥å•†åº”ç”¨å„ç§å¼ºåˆ¶è½¬æ¢åŒæ–¹ï¼ˆå¦‚æœå®ƒä»¬ä¸æ˜¯åŒä¸€ç±»å‹ï¼‰æµ‹è¯•ç›¸ç­‰ï¼ˆå¯¼è‡´è¿™ç§è¡Œä¸ºåƒä»¥å‰ä¸€æ · &quot;&quot; == falseæ˜¯trueï¼‰ï¼Œä½†Object.isä¸å¼ºè¿«ä»»ä½•ä¸€ä¸ªå€¼ã€‚ è¿™ä¹Ÿä¸åŒäºæ ¹æ®===è¿è¥å•†çš„å¹³ç­‰ ã€‚Object.is()å’Œä¹‹é—´çš„å”¯ä¸€åŒºåˆ«åœ¨äº===å®ƒä»¬å¯¹å¸¦ç¬¦å·é›¶å’Œ NaN çš„å¤„ç†ã€‚ä¾‹å¦‚ï¼Œ=== è¿ç®—ç¬¦ï¼ˆå’Œ==è¿ç®—ç¬¦ï¼‰å°†æ•°å€¼-0 å’Œ+0è§†ä¸ºç›¸ç­‰ã€‚æ­¤å¤–ï¼Œ===è¿ç®—ç¬¦å°† Number.NaNå’ŒNaNè§†ä¸ºä¸ç›¸ç­‰ã€‚ break &amp; continue breakå’Œcontinueéƒ½å¯ä»¥ä½¿ç”¨æ ‡ç­¾è¯­å¥é€€å‡ºå¤šé‡å¾ªç¯ let num = 0; outermost: for(let i = 0; i &lt; 10; i++){ for(let j = 0; j &lt; 10; j++){ if(i === 5 &amp;&amp; j === 5)break outermost; num++; } } ç¬¬4ç« ï¼ˆå˜é‡ã€ä½œç”¨åŸŸä¸å†…å­˜ï¼‰åŸå§‹ç±»å‹åˆå§‹åŒ–å¯ä»¥åªæ˜¯æ°¸è¿œæ˜¯å­—é¢é‡å½¢å¼ï¼Œå¦‚æœæ˜¯ä½¿ç”¨newå…³é”®å­—åˆ›å»ºï¼Œåˆ™JavaScriptä¼šåˆ›å»ºçˆ±ä¸€ä¸ªObjectå®ä¾‹ï¼Œå…¶è¡Œä¸ºç±»ä¼¼åŸå§‹å€¼ æ¯”å¦‚ let name1 = \"Allen\"; let name2 = new String(\"Bruce\"); name1.age = 18; name2.age = 19; console.log(name1.age) //undefined console.log(name2.age) //19 console.log(typeof name1) //string console.log(typeof name2) //object å¼•ç”¨å€¼ï¼ˆæ¯”å¦‚å¯¹è±¡ã€æ•°ç»„ï¼‰ä¼ é€’å‚æ•°æ—¶ï¼Œä¼šå½±å“åˆ°å‡½æ•°å¤–éƒ¨çš„åŸå§‹å˜é‡ï¼Œå› ä¸ºä¼ å…¥çš„æ˜¯æŒ‡é’ˆï¼Œä¿å­˜ç€æ•°å€¼å­˜æ”¾çš„åœ°å€ function change(obj){ obj.name = 'allen' } let obj = {}; change(obj); //{ name: 'allen' } å®è´¨ä¸Šå‚æ•°ä¼ é€’æœ‰ç‚¹åƒlet ä¸€ä¸ªå˜é‡ obj2 ï¼Œç„¶åè®© obj2 = objçš„æ“ä½œ ä¸ºäº†è¡¥æ•‘åƒåœ¾å›æ”¶æ—¶ç±»ä¼¼å¾ªç¯å¼•ç”¨çš„é—®é¢˜ï¼ŒIE9æŠŠBOMã€DOMå¯¹è±¡éƒ½æ”¹æˆäº†JavaScriptå¯¹è±¡ ç¬¬5ç« ï¼ˆåŸºæœ¬å¼•ç”¨ç±»å‹ï¼‰æ­£åˆ™è¡¨è¾¾å¼ æ­£åˆ™è¡¨è¾¾å¼ä½¿ç”¨åˆ°å…ƒå­—ç¬¦éœ€è¦ä½¿ç”¨ \\ è¿›è¡Œè½¬ä¹‰ï¼Œå¦‚æœæ­£åˆ™è¡¨è¾¾å¼æ˜¯ä½¿ç”¨ RegExp æ„é€ å‡½æ•°æ¥åˆ›å»ºï¼Œç”±äºå‚æ•°æ¨¡å¼æ˜¯å­—ç¬¦ä¸²ï¼Œæ‰€ä»¥éœ€è¦è¿›è¡ŒäºŒæ¬¡è½¬ä¹‰ \\\\ æ¯”å¦‚å­—é¢é‡æ¨¡å¼ï¼š /\\[bc\\]at/ å­—ç¬¦ä¸²æ¨¡å¼ï¼š\\\\[bc\\\\]at RegExpå®ä¾‹çš„ä¸»è¦æ–¹æ³•æ˜¯ exec()ï¼Œè¿”å›ä¸€ä¸ªæ•°ç»„ï¼ŒåŒ…å«åŒ¹é…çš„ä¿¡æ¯ï¼ŒåŒ¹é…ä¸åˆ°è¿”å›null å¦‚æœè¦è·å–åŒ¹é…çš„å­—ç¬¦ä¸²ï¼š/.de/.exec(&#39;ffff&#39;)[0] gå…¨å±€åŒ¹é…ï¼š let text = \"cat, bat, sat, fat\"; let pattern = /.at/g; let matches = pattern.exec(text); //catçš„æ•°ç»„ console.log(matches); let matches2 = pattern.exec(text); //batçš„æ•°ç»„ console.log(matches2); å­—ç¬¦ä¸²æ–¹æ³• str.indexOf(å­å­—ç¬¦ä¸²)ä»å­—ç¬¦ä¸²å¼€å¤´æ‰¾å­å­—ç¬¦ä¸² str.indexOf(å­å­—ç¬¦ä¸², index)ä»å­—ç¬¦ä¸²indexä½ç½®å¼€å§‹æ‰¾å­å­—ç¬¦ä¸² str.lastindexOf(å­å­—ç¬¦ä¸²)ä»å­—ç¬¦ä¸²æœ«å°¾å¼€å§‹æŸ¥æ‰¾å­å­—ç¬¦ä¸² å•ä¾‹å†…ç½®å¯¹è±¡ Globalå¯¹è±¡ï¼šå®ƒæ˜¯ECMAä¸­æœ€ç‰¹åˆ«çš„å¯¹è±¡ï¼Œå› ä¸ºä»£ç ä¸ä¼šæ˜¾å¼åœ°è®¿é—®å®ƒã€‚äº‹å®ä¸Šï¼Œä¸å­˜åœ¨å…¨å±€å˜é‡æˆ–å…¨å±€å‡½æ•°è¿™ç§ä¸œè¥¿ï¼Œåœ¨å…¨å±€ä½œç”¨åŸŸä¸­å®šä¹‰çš„å˜é‡çš„å‡½æ•°éƒ½ä¼šå˜æˆGlobalå¯¹è±¡çš„å±æ€§ï¼Œæˆ‘ä»¬æ‰€äº†è§£çš„ isNaN()ã€ parseInt()ã€ parseFloat()å®é™…ä¸Šéƒ½æ˜¯Globalå¯¹è±¡çš„æ–¹æ³•ï¼›è€ŒNANã€undefinedã€Arrayä¹Ÿéƒ½æ˜¯Globalçš„å±æ€§ã€‚ è€Œæˆ‘ä»¬å¹³æ—¶å±æ€§çš„windowå¯¹è±¡ï¼Œæ˜¯Globalå¯¹è±¡çš„ä»£ç†ï¼ˆECMA-262æ²¡æœ‰è§„å®šç›´æ¥è®¿é—®Globalå¯¹è±¡çš„æ–¹å¼ï¼‰ eval()æ–¹æ³•ï¼šå®ƒå¯èƒ½æ˜¯ECMAScriptè¯­è¨€ä¸­æœ€å¼ºå¤§çš„æ–¹æ³•ï¼Œå®ƒå°±æ˜¯ä¸€ä¸ªå®Œæ•´çš„ECMAScriptè§£é‡Šå™¨ eval(\"console.log('good!')\"); //ç­‰åŒäº console.log(\"good\") å½“è§£é‡Šå™¨å‘ç° eval()æ—¶ï¼Œä¼šå°†å‚æ•°è§£é‡Šä¸ºå®é™…çš„ECMAScriptè¯­å¥ï¼Œç„¶åå°†å…¶æ’å…¥åˆ°è¯¥ä½ç½®ï¼Œé€šè¿‡ eval()æ‰§è¡Œçš„ä»£ç å±äºè¯¥è°ƒç”¨æ‰€åœ¨ä¸Šä¸‹æ–‡ï¼Œè¢«æ‰§è¡Œçš„ä»£ç ä¸è¯¥ä¸Šä¸‹æ–‡æ‹¥æœ‰ç›¸åŒçš„ä½œç”¨åŸŸé“¾ã€‚è¿™æ„å‘³ç€åŒ…å«ä¸Šä¸‹æ–‡ä¸­çš„å˜é‡å¯ä»¥åœ¨eval()è°ƒç”¨å†…éƒ¨è¢«å¼•ç”¨ è¿™é‡Œevalè°ƒç”¨çš„msgå±äºå¤–éƒ¨ä¸Šä¸‹æ–‡ï¼Œå› ä¸ºç¬¬äºŒè¡Œä»£ç ä¼šè¢«æ›¿æ¢æˆä¸€è¡ŒçœŸæ­£çš„å‡½æ•°è°ƒç”¨ä»£ç  let msg = \"Batman\"; eval(\"console.log(msg)\"); //\"Batman\" å‡½æ•°sayæ˜¯åœ¨evalå†…éƒ¨å®šä¹‰çš„ï¼Œå› ä¸ºè¯¥è°ƒç”¨ä¼šè¢«æ›¿æ¢ä¸ºçœŸæ­£çš„å‡½æ•°å®šä¹‰ eval(\"function say(){ console.log('good!'); }\") say(); //good! éä¸¥æ ¼æ¨¡å¼ä¸‹ç›´æ¥è°ƒç”¨ eval() æ—¶ï¼Œé‡Œé¢ä½¿ç”¨ var å£°æ˜çš„å˜é‡å’Œä½¿ç”¨ function å£°æ˜çš„å‡½æ•°ä¼šä¿®æ”¹å½“å‰è¯æ³•ä½œç”¨åŸŸï¼Œé‡Œé¢ä½¿ç”¨ let å’Œ const å£°æ˜çš„å˜é‡ä¸ä¼šä¿®æ”¹å½“å‰è¯æ³•ä½œç”¨åŸŸï¼Œä½†æ˜¯ä¼šåœ¨å½“å‰åˆ›å»ºæ–°çš„è¯æ³•ä½œç”¨åŸŸã€‚ ä¸¥æ ¼æ¨¡å¼ä¸‹ç›´æ¥è°ƒç”¨çš„ eval() æ—¶ï¼Œä¼šåœ¨å½“å‰åˆ›å»ºä¸€ä¸ªæ–°çš„ç‹¬ç«‹çš„è¯æ³•ä½œç”¨åŸŸã€‚ eval(\"let msg = 'Batman'\") console.log(msg); //Err eval(\"var msg = 'Batman'\") console.log(msg); //Batman eval() æ˜¯ä¸€ä¸ªå±é™©çš„å‡½æ•°ï¼Œ å®ƒä½¿ç”¨ä¸è°ƒç”¨è€…ç›¸åŒçš„æƒé™æ‰§è¡Œä»£ç ã€‚å¦‚æœä½ ç”¨ eval() è¿è¡Œçš„å­—ç¬¦ä¸²ä»£ç è¢«æ¶æ„æ–¹ï¼ˆä¸æ€€å¥½æ„çš„äººï¼‰ä¿®æ”¹ï¼Œæ‚¨æœ€ç»ˆå¯èƒ½ä¼šåœ¨æ‚¨çš„ç½‘é¡µ/æ‰©å±•ç¨‹åºçš„æƒé™ä¸‹ï¼Œåœ¨ç”¨æˆ·è®¡ç®—æœºä¸Šè¿è¡Œæ¶æ„ä»£ç ã€‚æ›´é‡è¦çš„æ˜¯ï¼Œç¬¬ä¸‰æ–¹ä»£ç å¯ä»¥çœ‹åˆ°æŸä¸€ä¸ª eval() è¢«è°ƒç”¨æ—¶çš„ä½œç”¨åŸŸï¼Œè¿™ä¹Ÿæœ‰å¯èƒ½å¯¼è‡´ä¸€äº›ä¸åŒæ–¹å¼çš„æ”»å‡»ã€‚ç›¸ä¼¼çš„ Function å°±ä¸å®¹æ˜“è¢«æ”»å‡»ã€‚ eval() é€šå¸¸æ¯”å…¶ä»–æ›¿ä»£æ–¹æ³•æ›´æ…¢ï¼Œå› ä¸ºå®ƒå¿…é¡»è°ƒç”¨ JS è§£é‡Šå™¨ï¼Œè€Œè®¸å¤šå…¶ä»–ç»“æ„åˆ™å¯è¢«ç°ä»£ JS å¼•æ“è¿›è¡Œä¼˜åŒ–ã€‚ æ­¤å¤–ï¼Œç°ä»£JavaScriptè§£é‡Šå™¨å°†javascriptè½¬æ¢ä¸ºæœºå™¨ä»£ç ã€‚ è¿™æ„å‘³ç€ä»»ä½•å˜é‡å‘½åçš„æ¦‚å¿µéƒ½ä¼šè¢«åˆ é™¤ã€‚ å› æ­¤ï¼Œä»»æ„ä¸€ä¸ªevalçš„ä½¿ç”¨éƒ½ä¼šå¼ºåˆ¶æµè§ˆå™¨è¿›è¡Œå†—é•¿çš„å˜é‡åç§°æŸ¥æ‰¾ï¼Œä»¥ç¡®å®šå˜é‡åœ¨æœºå™¨ä»£ç ä¸­çš„ä½ç½®å¹¶è®¾ç½®å…¶å€¼ã€‚ å¦å¤–ï¼Œæ–°å†…å®¹å°†ä¼šé€šè¿‡ eval() å¼•è¿›ç»™å˜é‡ï¼Œ æ¯”å¦‚æ›´æ”¹è¯¥å˜é‡çš„ç±»å‹ï¼Œå› æ­¤ä¼šå¼ºåˆ¶æµè§ˆå™¨é‡æ–°æ‰§è¡Œæ‰€æœ‰å·²ç»ç”Ÿæˆçš„æœºå™¨ä»£ç ä»¥è¿›è¡Œè¡¥å¿ã€‚ ä½†æ˜¯ï¼Œï¼ˆè°¢å¤©è°¢åœ°ï¼‰å­˜åœ¨ä¸€ä¸ªéå¸¸å¥½çš„evalæ›¿ä»£æ–¹æ³•ï¼šåªéœ€ä½¿ç”¨ window.Functionã€‚ è¿™æœ‰ä¸ªä¾‹å­æ–¹ä¾¿ä½ äº†è§£å¦‚ä½•å°†eval()çš„ä½¿ç”¨è½¬å˜ä¸ºFunction()ã€‚ å…³äºevalæ›´å¤šä»‹ç» https://zhuanlan.zhihu.com/p/232078517 Evalç›´æ¥è°ƒç”¨å’Œé—´æ¥è°ƒç”¨ é—´æ¥evalè°ƒç”¨ï¼š (1, eval)('...') (eval, eval)('...') (1 ? eval : 0)('...') (__ = eval)('...') var e = eval; e('...') (function(e) { e('...') })(eval) (function(e) { return e })(eval)('...') (function() { arguments[0]('...') })(eval) this.eval('...') this['eval']('...') [eval][0]('...') eval.call(this, '...') eval('eval')('...') ç›´æ¥evalè°ƒç”¨ï¼š eval('...') (eval)('...') (((eval)))('...') (function() { return eval('...') })() eval('eval(\"...\")') (function(eval) { return eval('...'); })(eval) with({ eval: eval }) eval('...') with(window) eval('...') Ecma è§„èŒƒå°†å¼•ç”¨è§†ä¸ºevalâ€œç›´æ¥ eval è°ƒç”¨â€ï¼Œä½†ä»…äº§ç”Ÿevalä¸ºé—´æ¥çš„è¡¨è¾¾å¼ - å¹¶ä¸”é—´æ¥ eval è°ƒç”¨ä¿è¯åœ¨å…¨å±€èŒƒå›´å†…æ‰§è¡Œã€‚ ä½ æ˜¯å¦æ³¨æ„åˆ°ES5å®šä¹‰è¯´æ˜è°ƒç”¨è¡¨è¾¾å¼çš„evalåº”å½“æ‰§è¡Œæ ‡å‡†çš„ã€å†…ç½®çš„å‡½æ•°ï¼Ÿè¿™æ„å‘³ç€æ ¹æ®ä¸Šä¸‹æ–‡å†…å®¹eval(â€˜1+1â€™)å¿…å®šä¸æ˜¯ç›´æ¥è°ƒç”¨ã€‚ä»…ä»…å½“evalçœŸæ­£åœ°ï¼ˆä¸æ˜¯é‡å†™æˆ–è€…éšå«åœ°ï¼‰å¼•ç”¨äº†æ ‡å‡†çš„ã€å†…ç½®çš„å‡½æ•°çš„æ—¶å€™ï¼Œè°ƒç”¨æ‰è¢«è®¤ä¸ºæ˜¯ç›´æ¥è°ƒç”¨ã€‚ eval = (function(eval) { return function(expr) { return eval(expr); }; })(eval); eval('1+1'); // å®ƒçœ‹å‰æ¥åƒç›´æ¥è°ƒç”¨ï¼Œä¸è¿‡å®é™…ä¸Šæ˜¯é—´æ¥è°ƒç”¨ã€‚ // è¿™æ˜¯å› ä¸º`eval`è§£æä¸ºå®šåˆ¶çš„å‡½æ•°ï¼Œè€Œä¸æ˜¯æ ‡å‡†çš„ã€å†…ç½®çš„å‡½æ•°ã€‚ http://perfectionkills.com/global-eval-what-are-the-options/ new Function é™¤äº†evalä¹‹å¤–å¦å¤–ä¸€ç§åŠ¨æ€æ‰§è¡Œjsä»£ç çš„çš„æ–¹å¼ new Function( param1, param2, â€¦, paramN,funcBody );å®ƒåˆ›å»ºä¸€ä¸ªåŒ…å«0ä¸ªæˆ–è€…è¿‡ä¸ªå‚æ•°åä¸º param1 ç­‰çš„å‡½æ•°ï¼Œå‡½æ•°ä½“ä¸º funcBodyã€‚ç›¸å½“äºå¦‚ä¸‹æ–¹å¼åˆ›å»ºå‡½æ•°ï¼š function ( (param1), (param2), ..., (paramN) ){ (funcBody) } let sum = new Function('a', 'b', 'return a + b'); alert( sum(1, 2) ); // 3 let sayHi = new Function('alert(\"Hello\")'); sayHi(); // Hello let str = ... åŠ¨æ€åœ°æ¥æ”¶æ¥è‡ªæœåŠ¡å™¨çš„ä»£ç  ... let func = new Function(str); func(); Eval å’Œ new Function å¯¹æ¯” ç¬¬6ç« ï¼ˆé›†åˆå¼•ç”¨ç±»å‹ï¼‰å¯¹è±¡å±æ€§ ä¸€èˆ¬é€šè¿‡ç‚¹è¯­æ³•è¿›è¡Œè·å–ï¼Œä½†ä¹Ÿå¯ä»¥ä½¿ç”¨ä¸­æ‹¬å· console.log(person[\"name\"]); console.log(person.name); åªä¸è¿‡ä¸­æ‹¬å·çš„ä¸»è¦ä¼˜åŠ¿åœ¨äºå¯ä»¥é€šè¿‡å˜é‡è®¿é—®å±æ€§ let s = \"name\"; console.log(person[s]); å±æ€§æ›¿ä»£ ä¸€ä¸ªå¯¹è±¡ä¸­å¦‚æœæœ‰é‡å¤çš„å±æ€§ï¼Œåˆ™ä»¥ä¸‹é¢çš„å±æ€§å€¼ä¸ºå‡† const obj = { a: \"ab\", a: \"cd\", }; console.log(obj); // {a:'cd'} æ•°ç»„ æ•°ç»„ç©ºä½ï¼š ä½¿ç”¨æ•°ç»„å­—é¢é‡åˆå§‹åŒ–æ•°ç»„æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ä¸€ä¸²é€—å·æ¥åˆ›å»ºç©ºä½ã€‚ES6ä¹‹å‰çš„æ–¹æ³•ä¼šå¿½ç•¥ç©ºä½ï¼ŒES6æ–°å¢æ–¹æ³•æ™®éå°†è¿™äº›ç©ºä½å½“æˆå­˜åœ¨çš„å…ƒç´ ï¼Œåªä¸è¿‡å€¼ä¸ºundefinedã€‚ const option = [,,,,]; ç´¢å¼•è‡ªåŠ¨æ‰©å®¹ å¦‚æœæŠŠä¸€ä¸ªå€¼è®¾ç½®ç»™è¶…è¿‡æ•°ç»„æœ€å¤§ç´¢å¼•çš„ç´¢å¼•ï¼Œæ•°ç»„é•¿åº¦å°±ä¼šè‡ªåŠ¨æ‰©å±•åˆ°è¯¥ç´¢å¼•å€¼+1 let colors = [\"red\", \"blue\", \"green\"]; colors[2] = \"black\"; colors[3] = \"white\"; console.log(colors); //red, blue, black, white ä¿®æ”¹length æ•°ç»„lengthçš„ç‹¬ç‰¹ä¹‹å¤„åœ¨äºï¼Œå®ƒä¸æ˜¯åªè¯»çš„ï¼Œé€šè¿‡ä¿®æ”¹lengthå±æ€§ï¼Œå¯ä»¥å®ç°ä»æ•°ç»„æœ«å°¾åˆ é™¤ / æ·»åŠ å…ƒç´ ï¼ˆVue2.0çš„ç¼ºç‚¹ä¹‹ä¸€å°±æ˜¯ä¸èƒ½é€šè¿‡ä¿®æ”¹æ•°ç»„lengthå¾—åˆ°å“åº”å¼çš„ç»“æœï¼‰ï¼Œæ·»åŠ çš„å…ƒç´ é€šè¿‡undefinedè¿›è¡Œå¡«å…… æœç´¢ä½ç½®å’Œæ–¹æ³• indexOf() lastIndexOf() includes()å…¶ä¸­å‰ä¸¤ä¸ªåœ¨ä»»ä½•ç‰ˆæœ¬éƒ½å¯ä»¥ä½¿ç”¨ï¼Œç¬¬ä¸‰ä¸ªæ—¶ES7æ–°å¢ indexOf() includes()ä»å¼€å¤´æœç´¢åŒ¹é…å…ƒç´ ï¼ŒlastIndexOf()ä»ç»“å°¾å¼€å§‹æœç´¢ indexOf() lastIndexOf()æ‰¾ä¸åˆ°è¿”å›-1ï¼Œ includes()è¿”å›å¸ƒå°”å€¼ å®ƒä»¬éƒ½æ˜¯ç”¨å…¨ç­‰ ===è¿›è¡Œæ¯”è¾ƒçš„ å®šæ€§æ•°ç»„ ArrayBufferæ˜¯æ‰€æœ‰å®šå‹æ•°ç»„åŠè§†å›¾å¼•ç”¨çš„åŸºæœ¬å•ä½ï¼Œå®ƒæ˜¯ä¸€ä¸ªæ™®é€šçš„JSæ„é€ å‡½æ•°ï¼Œå¯ç”¨äºåœ¨å†…å­˜ä¸­åˆ†é…ç‰¹å®šæ•°é‡çš„å­—èŠ‚ç©ºé—´ã€‚ ä¸€ç»åˆ›å»ºä¾¿ä¸èƒ½å†è°ƒæ•´å¤§å° const buf = new ArrayBuffer(16) //åœ¨å†…å­˜ä¸­åˆ†é…16ä¸ªå­—èŠ‚ ç¬¬7ã€8ç« ï¼ˆè¿­ä»£å™¨å’Œç”Ÿæˆå™¨ï¼Œå¯¹è±¡å’Œç±»ï¼‰ç”Ÿæˆå™¨Generator å¯ä»¥ä½¿ç”¨æ˜Ÿå·å¢å¼º yieldè¡Œä¸ºï¼Œè®©ä»–èƒ½å¤Ÿè¿­ä»£ä¸€ä¸ªå¯è¿­ä»£å¯¹è±¡ï¼Œä»è€Œä¸€æ¬¡äº§å‡ºä¸€ä¸ªå€¼ function * generatorFn(){ for(const x of [1,2,3]){ yield x; } } //å¯ä»¥è½¬åŒ–ä¸º function * generatorFn(){ yield * [1,2,3]; } å®é™…ä¸Šåªæ˜¯å°†ä¸€ä¸ªå¯è¿­ä»£å¯¹è±¡åºåˆ—åŒ–ä¸ºä¸€è¿ä¸²å¯ä»¥å•ç‹¬äº§å‡ºçš„å€¼ï¼Œæ‰€ä»¥è¿™è·ŸæŠŠyieldæ”¾åˆ°ä¸€ä¸ªå¾ªç¯é‡Œæ²¡ä»€ä¹ˆä¸åŒ å’Œè¿­ä»£å™¨ç±»ä¼¼ï¼Œç”Ÿæˆå™¨ä¹Ÿæ”¯æŒ â€œå¯å…³é—­æ¦‚å¿µâ€ï¼Œå› ä¸º generatorå®ç°äº† iteratoræ¥å£ï¼Œä¸€ä¸ªå®ç° iteratoræ¥å£çš„å¯¹è±¡ä¸€å®šæœ‰ next()ï¼Œè¿˜æœ‰ä¸€ä¸ªå¯é€‰çš„ return()æ–¹æ³•ç”¨äºæå‰ç»ˆæ­¢è¿­ä»£å™¨ï¼Œç”Ÿæˆå™¨å¯¹è±¡é™¤äº†è¿™ä¸¤ä¸ªæ–¹æ³•ï¼Œè¿˜æœ‰ç¬¬ä¸‰ä¸ªæ–¹æ³• throw() throw()ä¼šåœ¨æš‚åœçš„æ—¶å€™å°†ä¸€ä¸ªæä¾›çš„é”™è¯¯æ³¨å…¥åˆ°ç”Ÿæˆå™¨å¯¹è±¡ä¸­ï¼Œå¦‚æœé”™è¯¯æœªå¤„ç†ï¼Œç”Ÿæˆå™¨å°±ä¼šå…³é—­ï¼›å¦‚æœç”Ÿæˆå™¨å†…éƒ¨å‡½æ•°å¤„ç†äº†è¿™ä¸ªé”™è¯¯ï¼Œé‚£ç”Ÿæˆå™¨å°±ä¸ä¼šå…³é—­ï¼Œè·³è¿‡å¯¹åº”çš„ yieldï¼Œç»§ç»­æ‰§è¡Œã€‚ å¯¹è±¡æ–¹æ³• å¯¹è±¡å®šä¹‰å±æ€§ï¼ˆè®¿é—®å™¨å±æ€§ï¼‰ä½¿ç”¨Object.defineProperty()ï¼Œè¯»å–å±æ€§çš„ç‰¹æ€§å¯ä»¥ä½¿ç”¨ Object.getOwnPropertyDescriptor()æ–¹æ³•ï¼Œå®ƒè¿”å›ä¸€ä¸ªå¯¹è±¡ å¯¹äºè®¿é—®å™¨å±æ€§åŒ…å« configurableã€enumberableã€getã€set å¯¹äºæ•°æ®å±æ€§åŒ…å« configurableã€enumberableã€writableå’Œ valueå±æ€§ ï¼ˆæœ‰ç‚¹åƒå¯¹å¯¹åº”Object.definePRopertyçš„å±æ€§ï¼‰ Object.assign(target, ...sources)æ–¹æ³•æ¥æ”¶ä¸€ä¸ªç›®æ ‡å¯¹è±¡å’Œä¸€ä¸ªæˆ–å¤šä¸ªæºå¯¹è±¡ä½œä¸ºå‚æ•°ï¼Œç„¶åå°†æ¯ä¸ªæºå¯¹è±¡ä¸­å¯æšä¸¾å’Œè‡ªæœ‰å±æ€§å¤åˆ¶åˆ°ç›®æ ‡å¯¹è±¡ï¼ˆæµ…æ‹·è´ï¼‰ const target = { a: 1, b: 2 }; const source = { b: 4, c: 5 }; const returnedTarget = Object.assign(target, source); console.log(target); // expected output: Object { a: 1, b: 4, c: 5 } console.log(returnedTarget); // expected output: Object { a: 1, b: 4, c: 5 } å…¨ç­‰å‡çº§ -&gt; å¯¹è±¡æ ‡è¯†åŠç›¸ç­‰åˆ¤å®š console.log(true === 1); //false console.log({} === {}); //false console.log(\"2\" === 2); //false console.log(+0 === -0); //true console.log(+0 === 0); //true console.log(-0 === 0); //true console.log(NaN === NaN); //false console.log(isNaN(NaN)); //true ES6è§„èŒƒæ–°å¢äº† Object.is() è¿™ä¸ªæ–¹æ³•å’Œ=== å¾ˆåƒï¼Œä½†ä¹ŸåŒæ—¶è€ƒè™‘äº†ä¸Šè¿°è¾¹ç•Œæƒ…å½¢ console.log(Object.is(true, 1)); //false console.log(Object.is({}, {})); //false console.log(Object.is(\"2\", 2)); //false console.log(Object.is(+0, -0)); //false console.log(Object.is(+0, 0)); //false console.log(Object.is(-0, 0)); //false console.log(Object.is(NaN, NaN)); //true å¯¹è±¡çš„å¯è®¡ç®—å±æ€§ï¼ˆä½¿ç”¨å˜é‡å®šä¹‰å±æ€§æ—¶ï¼Œå¿…é¡»æ”¾åœ¨æ–¹æ‹¬å·å†…ï¼Œä¸æ™®é€šé”®å€¼(String)è¿›è¡ŒåŒºåˆ†ã€‚ï¼‰ const name = 'Mike'; let person = {[name]: 'Matt'} åŸå‹é“¾ åŸå‹å¯¹è±¡.isPrototypeOf(å®ä¾‹)æ–¹æ³•ç¡®å®šä¸¤ä¸ªå¯¹è±¡ä¹‹é—´çš„ [[Prototype]]å…³ç³» console.log(Array.prototype.isPrototypeOf([])); // true è¿˜æœ‰ä¸€ä¸ª getPrototypeOf() å’Œ setPrototypeOf()æ–¹æ³•ï¼Œåˆ†åˆ«å¯¹åº”æ¹–ç‰‡åŒºå‚æ•°çš„åŸå‹å¯¹è±¡å’Œä¿®æ”¹å‚æ•°çš„åŸå‹å¯¹è±¡ï¼Œä½†æ˜¯ Object.setPrototypeOf()ä¼šä¸¥é‡å½±å“ä»£ç æ€§èƒ½ ä½¿ç”¨Object.getPrototypeOf(obj)æ–¹æ³• === obj.__proto__ å¯ä»¥ä½¿ç”¨hasOwnProerty()æ–¹æ³•ç”¨äºç¡®å®šæŸä¸ªå±æ€§æ˜¯å®ä¾‹ä¸Šè¿˜æ˜¯åœ¨åŸå‹å¯¹è±¡ï¼Œè¿™ä¸ªæ–¹æ³•æ˜¯ç»§æ‰¿è‡ªObjectçš„ï¼Œä¼šåœ¨å±æ€§å­˜åœ¨äºè°ƒç”¨å®ƒçš„å¯¹è±¡å®ä¾‹ä¸Šæ—¶è¿”å›trueï¼ˆè¿™ä¸ªæ–¹æ³•ä¹Ÿåº”ç”¨äºVue3.0æ£€æµ‹æ•°ç»„å±æ€§çš„å­˜åœ¨ + ä¿®æ”¹å±æ€§ + æ–°å¢å±æ€§ï¼‰ //person1æœ‰nameå±æ€§ã€ä½†æ˜¯æ²¡æœ‰othernameå±æ€§ console.log(person1.hasOwnProperty(\"name\")) //true console.log(person1.hasOwnProperty(\"othername\")) //false ä½†æ˜¯hasOwnPropertyæ˜¯ç¡®å®šè¯¥å®ä¾‹ä¸Šæœ‰æ²¡æœ‰è¿™ä¸ªå±æ€§ ï¼Œå¦‚æœè¯¥å®ä¾‹çš„å¯¹è±¡åŸå‹ä¸Šæœ‰è¿™ä¸ªå±æ€§ï¼Œä¹Ÿä¼šè¿”å›false inæ“ä½œç¬¦å°±ä¸ä¸€æ ·äº†ï¼Œinåœ¨ for inå¾ªç¯ä¸­ä½¿ç”¨ï¼Œä¹Ÿå¯ä»¥å•ç‹¬ä½¿ç”¨ï¼Œinæ“ä½œç¬¦ä¼šåœ¨å¯ä»¥é€šè¿‡å¯¹è±¡è®¿é—®æŒ‡å®šå±æ€§æ—¶ï¼Œè¿”å›true //person1æœ‰nameå±æ€§ã€ä½†æ˜¯æ²¡æœ‰othernameå±æ€§ person1.name = \"Bruce\" person1.prototype.othername = \"Allen\" console.log(\"name\" in person1) //true console.log(\"othername\" in person1) //true å¯¹è±¡è¿­ä»£ ECMAScript2017æ–°å¢äº†ä¸¤ä¸ªé™æ€æ–¹æ³•ï¼šObject.values()ï¼ˆè¿”å›å¯¹è±¡å€¼çš„æ•°ç»„ï¼‰ã€Object.values()ï¼ˆè¿”å›é”®/å€¼å¯¹çš„æ•°ç»„ï¼‰ ç»§æ‰¿æ‹“å±• åŸå‹å¼ç»§æ‰¿ï¼š é€‚ç”¨æƒ…å†µäºä½ æœ‰ä¸€ä¸ªå¯¹è±¡ï¼Œæƒ³åœ¨å®ƒçš„åŸºç¡€ä¸Šå†åˆ›å»ºä¸€ä¸ªæ–°å¯¹è±¡ å®ƒæ˜¯ä¸€ç§ä¸æ¶‰åŠä¸¥æ ¼æ„ä¹‰ä¸Šçš„æ„é€ å‡½æ•°ç»§æ‰¿æ–¹æ³•ï¼Œä»–çš„å‡ºå‘ç‚¹æ˜¯å³ä½¿ä¸è‡ªå®šä¹‰ç±»å‹ ES5é€šè¿‡å¢åŠ  Object.create()æ–¹æ³•æŠŠåŸå‹æ˜¯ç»§æ‰¿çš„æ¦‚å¿µè§„èŒƒåŒ–äº† let person = { name:\"Allen\", friends:[\"Bruce\", \"Curry\", \"Devid\"] } let anotherPerson = Object.create(person); //object(person)ä¹Ÿå¯ä»¥ anotherPerson.name = \"Greg\"; anotherPerson.fridens.push(\"Rob\"); let yetAnotherPerson = Object.create(person); yetAnotherPerson.name = \"Faker\"; yetAnotherPerson.fridens.push(\"Ariana\"); console.log(person.friends); //\"Bruce\", \"Curry\", \"Devid\", \"Rob\", \"Ariana\" console.log(person.name); //\"Allen\" ï¼ˆå³å¼•ç”¨ç±»å‹å­˜å…±äº«å±æ€§ï¼ŒåŸºæœ¬ç±»å‹å­˜å–å®ä¾‹å±æ€§ï¼‰ å¯„ç”Ÿå¼ç»§æ‰¿ï¼š function createAnother(original) { let clone = object(original); clone.sayHi = function () { console.log(\"hi!\"); } return clone; } let person = { name:\"Allen\", friends:[\"Bruce\", \"Curry\", \"Devid\"] } let another = createAnother(person); another.sayHi(); å®ƒè®©æ–°è¿”å›çš„å¯¹è±¡å…·æœ‰personçš„æ‰€æœ‰å±æ€§å’Œæ–¹æ³•ï¼Œè¿˜åˆ›å»ºäº†ä¸€ä¸ªæ–°çš„æ–¹æ³•sayHiã€‚ ä½†å¯„ç”Ÿå¼ç»§æ‰¿ç»™å¯¹è±¡æ·»åŠ å‡½æ•°ä¼šå¯¼è‡´å‡½æ•°éš¾ä»¥é‡ç”¨ï¼Œå’Œæ„é€ å‡½æ•°æ¨¡å¼ï¼ˆæ„é€ å‡½æ•°ç»§æ‰¿ï¼‰ç±»ä¼¼ã€‚ ä¼ ç»Ÿçš„ç»„åˆç»§æ‰¿ä¹Ÿå­˜åœ¨æ•ˆç‡é—®é¢˜ï¼Œä¸»è¦åœ¨äºçˆ¶ç±»æ„é€ å‡½æ•°å§‹ç»ˆä¼šè¢«è°ƒç”¨ä¸¤æ¬¡ï¼Œ ä¸€æ¬¡åœ¨åˆ›å»ºå­ç±»åŸå‹æ—¶è°ƒç”¨ï¼ˆSon.prototype = new Father();ï¼‰ ä¸€æ¬¡åœ¨å­ç±»æ„é€ å‡½æ•°ä¸­è°ƒç”¨ï¼ˆfunction Son(uname, age) {Father.call(this, uname, age);}ï¼‰ ç”±æ­¤å¯„ç”Ÿå¼ç»„åˆç»§æ‰¿çš„æ–¹å¼å¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜ //æ›¿ä»£åŸæ¥çš„Son.prototype = new Father(); function inheritPrototype(subType, superType) { let prototype = object(superType.prototype); prototype.constructor = subType; subType.prototype = prototype; } JSå®ç°æŠ½è±¡ç±»(ä»…ç»§æ‰¿ï¼Œæœ¬èº«ä¸ä¼šè¢«å®ä¾‹åŒ–) class Vehicle{ constructor(){ console.log(new.target); } if(new.target === Vehicle){ throw new Error(\"Vehicle annot be directly instantiated\"); } } ç¬¬9ç« ï¼ˆä»£ç†ä¸åå°„ï¼‰ä»£ç†ä¸åå°„ ä»£ç†ä¸ºç›®æ ‡å¯¹è±¡çš„æŠ½è±¡ï¼Œä»å¾ˆå¤šæ–¹é¢æ¥çœ‹ï¼Œä»£ç†ç±»ä¼¼äºC++çš„æŒ‡é’ˆï¼Œå› ä¸ºä»–ä»¬å¯ä»¥ç”¨ä½œç›®æ ‡å¯¹è±¡çš„æ›¿èº«ï¼Œä½†åˆå®Œå…¨ç‹¬ç«‹äºç›®æ ‡å¯¹è±¡ã€‚ç›®æ ‡å¯¹è±¡æ—¢å¯ä»¥è¢«ç›´æ¥æ“ä½œï¼Œä¹Ÿå¯ä»¥é€šè¿‡ä»£ç†æ¥æ“ä½œ const target = { id:'target' } // ä¼ å…¥å‚æ•°ä¸ºç›®æ ‡å¯¹è±¡å’Œå¤„ç†ç¨‹åºå¯¹è±¡ const proxy = new Proxy(target, {}); console.log(target.id); //target console.log(proxy.id); //target target.id = \"foo\" console.log(target.id); //foo console.log(proxy.id); //foo console.log(target.hasOwnproperty('id')); //true console.log(proxy.hasOwnproperty('id')); //true // å¯ä»¥é€šè¿‡ä¸¥æ ¼æ¨¡å¼åŒºåˆ† console.log(target === proxy); //false ä½¿ç”¨ä»£ç†çš„ä¸»è¦ç›®çš„æ˜¯å®šä¹‰æ•è·å™¨ï¼ˆåŸºæœ¬æ“ä½œæ‹¦æˆªå™¨ï¼‰ï¼Œæˆ‘ä»¬åœ¨å¤„ç†ç¨‹åºå¯¹è±¡ä¸­å®šä¹‰å³å¯ï¼Œæ¯”å¦‚è¿™é‡Œæˆ‘é‡æ–°å®šä¹‰äº† è¯¥å¯¹è±¡çš„ get æ–¹æ³• const handler = { get() { return 'handler override'; } } const proxy = new Proxy(target, handler); console.log(target.id); //foo console.log(proxy.id); //handler override æ ¹æ®ECMAScriptè§„èŒƒï¼Œæ¯ä¸ªæ•è·å™¨éƒ½çŸ¥é“ç›®æ ‡å¯¹è±¡çš„ä¸Šä¸‹æ–‡ï¼Œæ•è·å‡½æ•°ç­¾åï¼Œè€Œæ•è·ç¨‹åºçš„è¡Œä¸ºå¿…é¡»éµå¾ªâ€œæ•è·å™¨ä¸å˜å¼â€ï¼Œæ•è·å™¨ä¸å˜å¼å› æ–¹æ³•ä¸åŒè€Œå¼‚ï¼Œä½†é€šå¸¸éƒ½ä¼šé˜²æ­¢æ•è·å…¶å®šä¹‰å‡ºç°è¿‡äºåå¸¸çš„è¡Œä¸ºï¼ˆæ¯”å¦‚ç›®æ ‡å¯¹è±¡æœ‰ä¸€ä¸ªä¸å¯é…ç½®åˆ‡ä¸å¯å†™çš„æ•°æ®å±æ€§ï¼Œé‚£ä¹ˆåœ¨æ•è·å™¨è¿”å›ä¸€ä¸ªä¸è¯¥å±æ€§ä¸åŒçš„å€¼æ—¶ï¼Œä¼šæŠ›å‡ºTypeErrorï¼‰ å¯æ’¤é”€ä»£ç† ä½¿ç”¨new Proxy()åˆ›å»ºçš„æ™®é€šä»£ç†ï¼Œè¿™ç§è”ç³»ä¼šåœ¨ä»£ç†å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸå†…æŒç»­å­˜åœ¨ï¼Œæ‰€ä»¥æœ‰æ—¶å¯èƒ½éœ€è¦ä¸­æ–­ä»£ç†å¯¹è±¡å’Œç›®æ ‡å¯¹è±¡ä¹‹é—´çš„è”ç³»ã€‚ Proxyä¹Ÿæš´éœ²äº† revocable()æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•æ”¯æŒæ’¤é”€ä»£ç†å¯¹è±¡å’Œç›®æ ‡å¯¹è±¡çš„å…³è”ï¼Œæ’¤é”€ä»£ç†åå†æ¬¡è°ƒç”¨ä»£ç†ä¼šæŠ›å‡ºTypeError const {proxy, revoke} = Proxy.revocable(target, handler); //æ­¤æ—¶æˆ‘ä»¬å¯ä»¥æ’¤é”€ä»£ç† revoke(); //æ’¤é”€ä»£ç† console.log(proxy.id); //TypeError ä»£ç†çš„é—®é¢˜å’Œä¸è¶³ å¦‚æœtargetç›®æ ‡å¯¹è±¡è¿‡äºä¾èµ–å¯¹è±¡æ ‡è¯†ï¼Œå¯èƒ½ä¼šå‡ºç°æ„æ–™ä¹‹å¤–çš„å†…å®¹ï¼ˆæ¯”å¦‚WeakMapï¼‰ const wm = new WeakMap(); class User { constructor(userId) { wm.set(this, userId) } set id(userId) { wm.set(this, userId); } get id() { return wm.get(this) } } const user = new User(123); console.log(user.id); //123 const proxy = new Proxy(user, {}); console.log(proxy.id); //undefined æœ‰äº›ECMAScriptå†…ç½®ç±»å‹å¯èƒ½ä¼šä»¥æ¥ä»£ç†æ— æ³•æ§åˆ¶çš„æœºåˆ¶ï¼Œå¯¼è‡´ä»£ç†å•†è°ƒç”¨æŸäº›æ–¹æ³•å‡ºé”™ï¼Œæ¯”å¦‚Dateç±»å‹ ä»£ç†æ•è·å™¨ä¸åå°„æ–¹æ³• get()æ•è·å™¨ä¼šåœ¨è·å–å±æ€§å€¼çš„æ“ä½œä¸­è¢«è°ƒç”¨ï¼Œåå°„APIä¸º Reflect.get() set()æ•è·å™¨ä¼šåœ¨è®¾ç½®å±æ€§å€¼çš„æ“ä½œä¸­è¢«è°ƒç”¨ï¼Œåå°„APIä¸º Reflect.set() has()æ•è·å™¨ä¼šåœ¨inæ“ä½œç¬¦ä¸­è¢«è°ƒç”¨ï¼Œåå°„APIä¸º Reflect.has() defineProperty()æ•è·å™¨ä¼šåœ¨ Object.defineProperty() ä¸­è¢«è°ƒç”¨ï¼Œåå°„APIä¸º Reflect.defineProperty() â€¦â€¦. ä»£ç†æ¨¡å¼è¿˜å¯ä»¥å®ç°å±æ€§éšè—åŠŸèƒ½ã€å±æ€§éªŒè¯åŠŸèƒ½ç­‰ const hiddenProperties = ['foo', 'bar']; const target = { foo: 1, bar: 2, baz:3 } const proxy = new Proxy(target, { //éšè—å±æ€§åŠŸèƒ½ get(target, property) { if (hiddenProperties.includes(property)) return undefined; else return Reflect.get(...arguments); }, //å±æ€§éªŒè¯ set(target, property, value) { if (typeof value !== Number) return false;//æ‹’ç»èµ‹å€¼ else return Reflect.set(...arguments); } }) ç¬¬10ç« ï¼ˆå‡½æ•°ï¼‰å®è´¨ä¸Šï¼Œå‡½æ•°æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œæ˜¯Functionç±»å‹çš„å®ä¾‹ ECMAScript6çš„æ‰€æœ‰å‡½æ•°å¯¹è±¡éƒ½ä¼šæš´éœ²ä¸€ä¸ªåªè¯»çš„nameå±æ€§ï¼Œå…¶ä¸­åŒ…å«å…³äºå‡½æ•°çš„ä¿¡æ¯ï¼ˆå¦‚æœå®ƒæ˜¯ä½¿ç”¨Functionæ„é€ å‡½æ•°åˆ›å»ºï¼Œåˆ™ä¼šè¡¨ç¤ºæˆâ€anonymousâ€ï¼‰ function foo() { } let bar = function () { } let baz = () => { } console.log(foo.name); //foo console.log(bar.name); //bar console.log(baz.name); //baz console.log((new Function()).name); //anonymous æ³¨æ„ï¼šECMAScriptçš„å‡½æ•°æ²¡æœ‰é‡è½½ï¼ˆé‡è½½æŒ‡åŒä¸ªå‡½æ•°åé€šè¿‡æ¥æ”¶ä¸åŒçš„å‚æ•°ï¼ŒåŒ…æ‹¬ä¸ªæ•°ã€ç±»å‹ï¼Œè€Œå®ç°åŒå‡½æ•°åå®ç°ä¸åŒçš„æ–¹æ³•ï¼‰ äº‹å®ä¸Šï¼ŒJavaScriptå¼•æ“åœ¨åŠ è½½æ•°æ®æ—¶å¯¹å‡½æ•°å£°æ˜å’Œå‡½æ•°è¡¨è¾¾å¼åŒºåˆ†å¯¹å¾…çš„ã€‚ JavaScriptå¼•æ“åœ¨ä»»ä½•ä»£ç æ‰§è¡Œä¹‹å‰ï¼Œéƒ½ä¼šè¯»å–å‡½æ•°å£°æ˜ï¼Œå¹¶åœ¨æ‰§è¡Œä¸Šä¸‹æ–‡ä¸­ç”Ÿæˆå‡½æ•°å®šä¹‰ï¼›è€Œå‡½æ•°è¡¨è¾¾å¼å¿…é¡»ç­‰åˆ°ä»£ç æ‰§è¡Œåˆ°ä»–é‚£ä¸€è¡Œï¼Œæ‰ä¼šåœ¨æ‰§è¡Œä¸Šä¸‹æ–‡ä¸­ç”Ÿæˆå‡½æ•°å®šä¹‰ã€‚ //æ²¡é—®é¢˜ console.log(sum(10, 10)); function sum(num1, num2){ return num1 + num2; } //ä¼šå‡ºé”™ï¼Œä½¿ç”¨varä¹Ÿä¼šå‡ºé”™ console.log(sum(10, 10)); let sum = function(num1, num2){ return num1 + num2 } æˆ‘ä»¬å­¦ä¹ è¿‡argumentsï¼Œæ˜¯ä¸€ä¸ªä¼ªæ•°ç»„ï¼ŒåŒ…å«è°ƒç”¨å‡½æ•°æ—¶ä¼ å…¥çš„æ‰€æœ‰å‚æ•°ã€‚å®é™…ä¸Šå®ƒè¿˜æœ‰ä¸€ä¸ªcalleeå±æ€§ï¼Œæ˜¯ä¸€ä¸ªæŒ‡å‘argumentså¯¹è±¡æ‰€åœ¨å‡½æ•°çš„æŒ‡é’ˆï¼Œä»è€Œå®ç°å‡½æ•°é€»è¾‘ä¸å‡½æ•°åè§£è€¦ function dfs(num){ if(num &lt;= 1)return 1; else return num * arguments.callee(num-1); //ç›¸å½“äºnum * dfs(num-1) } ä¸¥æ ¼æ¨¡å¼ä¸‹ï¼Œè¿è¡Œçš„ä»£ç ä¸èƒ½è®¿é—®arguments.calleeï¼Œå› ä¸ºè®¿é—®ä¼šå‡ºé”™ é—­åŒ…å»¶ä¼¸ å‡½æ•°æ‰§è¡Œæ—¶ï¼Œæ¯ä¸ªæ‰§è¡Œä¸Šæ–‡ä¸­éƒ½ä¼šæœ‰ä¸€ä¸ªåŒ…å«å…¶ä¸­å˜é‡çš„å¯¹è±¡ã€‚å…¨å±€ä¸Šä¸‹æ–‡ä¸­çš„å«å˜é‡å¯¹è±¡ï¼Œå®ƒä¼šåœ¨ä»£ç æ‰§è¡ŒæœŸé—´å§‹ç»ˆå­˜åœ¨ã€‚è€Œå‡½æ•°å±€éƒ¨ä¸Šä¸‹æ–‡ä¸­å«åšæ´»åŠ¨å¯¹è±¡ï¼Œåªåœ¨å‡½æ•°æ‰§è¡ŒæœŸé—´å­˜åœ¨ã€‚ å‡½æ•°å†…éƒ¨çš„ä»£ç åœ¨è®¿é—®å˜é‡æ—¶ï¼Œå°±ä¼šä½¿ç”¨ç»™å®šçš„åç§°ä»ä½œç”¨åŸŸé“¾1ä¸­æŸ¥æ‰¾å˜é‡ï¼Œå‡½æ•°æ‰§è¡Œå®Œæ¯•åï¼Œå±€éƒ¨æ´»åŠ¨å¯¹è±¡å°±ä¼šè¢«é”€æ¯ï¼Œå†…å­˜ä¸­å°±åªå‰©ä¸‹å…¨å±€ä½œç”¨åŸŸï¼Œä¸è¿‡ï¼Œé—­åŒ…å°±ä¸ä¸€æ ·äº†ã€‚ åœ¨ä¸€ä¸ªå‡½æ•°å†…éƒ¨å®šä¹‰çš„å‡½æ•°ï¼Œå°±ä¼šæŠŠå…¶åŒ…å«çš„å‡½æ•°çš„æ´»åŠ¨å¯¹è±¡æ·»åŠ åˆ°è‡ªå·±çš„ä½œç”¨åŸŸé“¾ä¸­ ç¬¬11ç« ï¼ˆæœŸçº¦ä¸å¼‚æ­¥å‡½æ•°ï¼‰promise.allï¼šå¦‚æœæœ‰æœŸçº¦æ‹’ç»ï¼Œåˆ™ç¬¬ä¸€ä¸ªæ‹’ç»çš„å¥‘çº¦ä¼šå°†è‡ªå·±çš„ç†ç”±ä½œä¸ºåˆæˆæœŸçº¦çš„æ‹’ç»ç†ç”±ï¼ˆäº¤ç»™onRejectæˆ–è€…catchå¤„ç†ï¼‰ã€‚ä¹‹åå†æ‹’ç»çš„æœŸçº¦ä¸ä¼šå½±å“æœ€ç»ˆæœŸçº¦çš„æ‹’ç»ç†ç”± å¦‚æœè‡³å°‘æœ‰ä¸€ä¸ªåŒ…å«çš„æœŸçº¦å¾…å®šï¼Œåˆ™åˆæˆæœŸçº¦å¾…å®šï¼ˆpeddingï¼‰ï¼Œå¦‚æœæœ‰ä¸€ä¸ªåŒ…å«çš„æœŸçº¦æ‹’ç»ï¼Œåˆ™åˆæˆçš„æœŸçº¦ä¹Ÿä¼šæ‹’ç»ï¼ˆä¸€ä¸ªrejectedï¼Œåˆ™all rejectedï¼‰ promise.raceï¼šè°å¿«ç”¨è°çš„çŠ¶æ€ï¼› ç¬¬ä¸€ä¸ªè½å®šçš„æ‹’ç»æœŸçº¦ï¼Œå°±ä¼šæˆä¸ºæ‹’ç»åˆæˆæœŸçº¦çš„ç†ç”±ã€‚ä¹‹åå†æ‹’ç»çš„æœŸçº¦ä¸ä¼šå½±å“æœ€ç»ˆæœŸçº¦æ‹’ç»çš„ç†ç”±ã€‚ å’Œallç±»ä¼¼ï¼Œåˆæˆçš„æœŸçº¦ä¼šé™é»˜å¤„ç†æ‰€æœ‰åŒ…å«æœŸçº¦çš„æ‹’ç»æ“ä½œï¼Œä¸ä¼šæœ‰é”™è¯¯è·‘æ‰ã€‚ ES6ä¸æ”¯æŒå–æ¶ˆæœŸçº¦å’Œè¿›åº¦é€šçŸ¥ï¼Œä¸€ä¸ªä¸»è¦åŸå› æ˜¯è¿™æ ·ä¼šå¯¼è‡´æœŸçº¦è¿é”å’ŒæœŸçº¦åˆæˆè¿‡åº¦å¤æ‚åŒ–ã€‚ ä½†æ˜¯æˆ‘ä»¬å¯ä»¥åˆ©ç”¨é—­åŒ…ä¼ å…¥å›è°ƒå‡½æ•°å®ç°ä¸ƒæœˆçš„å–æ¶ˆå’Œè¿›åº¦é€šçŸ¥ async asyncå…³é”®å­—ç”¨åœ¨å‡½æ•°å£°æ˜ã€å‡½æ•°è¡¨è¾¾å¼ã€ç®­å¤´å‡½æ•°å’Œæ–¹æ³•ä¸Š async function foo(){} let bar = async function(){} let baz = async() => {} class Quex(){ async qux(){} } å¼‚æ­¥å‡½æ•°å¦‚æœä½¿ç”¨returnå…³é”®å­—è¿”å›äº†å€¼ï¼ˆé»˜è®¤è¿”å›undefinedï¼‰ï¼Œè¿™ä¸ªå€¼ä¼šè¢«Promise.resolve()åŒ…è£…æˆä¸€ä¸ªæœŸçº¦å¯¹è±¡ async function foo(){ console.log(1); return 3; //return Promise.resolve(3) } foo().then(console.log(2)); console.log(2) //1 //2 //3 å¼‚æ­¥å‡½æ•°asyncå’ŒpromiseæœŸçº¦ä¸€æ ·ï¼ŒæŠ›å‡ºé”™è¯¯ï¼ˆthrow errï¼‰ä¼šè¿”å›æ‹’ç»çš„æœŸçº¦ async function foo(){ console.log(1); throw 3; } foo.catch()(console.log); console.log(2) //1 //2 //3 ä¸è¿‡ï¼Œæ‹’ç»æœŸçº¦çš„é”™è¯¯ä¸ä¼šè¢«å¼‚æ­¥å‡½æ•°æ•è· async function foo(){ console.log(1); Promise.reject(3); } foo.catch()(console.log); console.log(2) //1 //2 //Uncaught 3 å¯¹äºawaitï¼Œé¢å¯¹æ‹’ç»çš„æœŸçº¦ï¼Œä¼šé‡Šæ”¾ï¼ˆunwrapï¼‰é”™è¯¯å€¼ï¼ˆå°†æ‹’ç»æœŸçº¦è¿”å›ï¼‰ async function foo(){ console.log(1); await Promise.reject(3); console.log(4); //è¿™ä¸€è¡Œä¸ä¼šè¢«æ‰§è¡Œ } foo.catch()(console.log); console.log(2) //1 //2 //Uncaught 3 awaitçš„é™åˆ¶ï¼šawaitå…³é”®å­—åªèƒ½åœ¨å¼‚æ­¥å‡½æ•°ï¼ˆasyncï¼‰ä¸­ä½¿ç”¨ è¦å®Œå…¨ç†è§£awaitï¼Œå¿…é¡»çŸ¥é“ä»–å¹¶éåªæ˜¯ç­‰å¾…ä¸€ä¸ªå€¼å¯ç”¨è¿™ä¹ˆç®€å•ï¼ŒJavaScriptè¿è¡Œæ—¶ç¢°åˆ°awaitå…³é”®å­—æ—¶ï¼Œä¼šè®°å½•é‚£é‡Œæš‚åœæ‰§è¡Œï¼Œç­‰åˆ°awaitå³è¾¹çš„å€¼å¯ç”¨äº†ï¼ŒJavaScriptè¿è¡Œæ—¶ä¼šå‘æ¶ˆæ¯é˜Ÿåˆ—æ¨é€ä¸€ä¸ªä»»åŠ¡ï¼Œè¿™ä¸ªä»»åŠ¡ä¼šæ¢å¤å¼‚æ­¥å‡½æ•°çš„æ‰§è¡Œ å› æ­¤ï¼Œå³ä½¿awaitåé¢è·Ÿç€ä¸€ä¸ªç«‹å³å¯ç”¨çš„å€¼ï¼Œå‡½æ•°çš„å…¶ä½™éƒ¨åˆ†ä¹Ÿä¼šè¢«å¼‚æ­¥æ±‚å€¼ async function foo(){ console.log(2); await null; //awaitæš‚åœæ‰§è¡Œï¼Œä¸ºç«‹å³å¯ç”¨çš„å€¼nullå‘æ¶ˆæ¯é˜Ÿåˆ—ä¸­æ·»åŠ ä¸€ä¸ªä»»åŠ¡ï¼Œç­‰åˆ°åŒæ­¥ä»»åŠ¡æ‰§è¡Œå®Œæ¯•åï¼Œå†å–å‡ºæ¥ console.log(4) } console.log(1); foo(); console.log(3); //1 //2 //3 //4 asyncå…³é”®å­—æ— è®ºä»å“ªä¸ªæ–¹é¢æ¥çœ‹ï¼Œéƒ½ä¸è¿‡æ˜¯ä¸€ä¸ªæ ‡è¯†ç¬¦ï¼Œæ¯•ç«Ÿï¼Œå¼‚æ­¥å‡½æ•°å¦‚æœä¸åŒ…å«awaitå…³é”®å­—ï¼Œå…¶æ‰§è¡ŒåŸºæœ¬ä¸Šè·Ÿæ™®é€šå‡½æ•°æ²¡æœ‰ä»€ä¹ˆåŒºåˆ«ã€‚ async function foo(){ console.log(2); } console.log(1) foo(); console.log(2) //1 //2 //3 æœŸçº¦å’Œå¼‚æ­¥å‡½æ•° æ ˆè¿½è¸ªå’Œå†…å­˜ç®¡ç† æœŸçº¦ï¼ˆpromiseï¼‰å’Œå¼‚æ­¥å‡½æ•°ï¼ˆasyncï¼‰çš„åŠŸèƒ½æœ‰ç›¸å½“ç¨‹åº¦çš„é‡å ï¼Œä½†æ˜¯ä»–ä»¬åœ¨å†…å­˜ä¸­çš„è¡¨ç¤ºåˆ™å·®åˆ«å¾ˆå¤§ã€‚ function fooPromiseExecutor(res, rej) { setTimeout(rej, 1000, 'bar'); } function foo() { new Promise(fooPromiseExecutor); } foo(); //Uncaught (in promise) bar //setTimeout //setTimeout (async) //fooPromiseExecutor //foo æ ˆè¿½è¸ªä¿¡æ¯åº”è¯¥æ˜¯ç›¸å½“ç›´æ¥åœ°è¡¨ç°JavaScriptå¼•æ“åœ¨å½“å‰æ ˆå†…å­˜ä¸­å‡½æ•°è°ƒç”¨ä¹‹é—´çš„åµŒå¥—å…³ç³»ã€‚åœ¨è¶…æ—¶å¤„ç†ç¨‹åºæ‰§è¡Œæ—¶å’Œæ‹’ç»æœŸçº¦æ—¶ï¼Œæˆ‘ä»¬çœ‹åˆ°é”™è¯¯ä¿¡æ¯åŒ…å«åµŒå¥—å‡½æ•°çš„æ ‡è¯†ç¬¦ï¼Œé‚£æ˜¯è¢«è°ƒç”¨ä»¥åˆ›å»ºåˆæœŸçº¦å®ä¾‹çš„å‡½æ•°ã€‚å¯æ˜¯æˆ‘ä»¬çŸ¥é“è¿™äº›å‡½æ•°å·²ç»è¿”å›ï¼Œå› æ­¤åœ¨è¿½è¸ªæ ˆä¸­ä¸åº”è¯¥çœ‹åˆ°å®ƒä»¬ã€‚ è€Œè¿™æ˜¯å› ä¸ºJavaScriptå¼•æ“åœ¨åˆ›å»ºæœŸçº¦æ—¶å°½å¯èƒ½ä¿ç•™å®Œæ•´çš„è°ƒç”¨æ ˆï¼Œåœ¨æŠ›å‡ºé”™è¯¯æ—¶è°ƒç”¨æ ˆå¯ä»¥ç”±è¿è¡Œæ—¶çš„é”™è¯¯å¤„ç†é€»è¾‘è·å–ã€‚å½“ç„¶ï¼Œè¿™æ„å‘³ç€æ ˆè¿½è¸ªä¿¡æ¯ä¼šå ç”¨å†…å­˜ï¼Œå¸¦æ¥è®¡ç®—å­˜å‚¨æˆæœ¬ã€‚ function fooPromiseExecutor(res, rej) { setTimeout(rej, 1000, 'bar'); } async function foo() { await new Promise(fooPromiseExecutor); } foo(); //Uncaught (in promise) bar //foo //async function (async) //foo è¿™æ ·ä¸€æ”¹ï¼Œæ ˆè¿½è¸ªä¿¡æ¯å°±èƒ½å‡†ç¡®åœ°åæ˜ äº†å½“å‰çš„è°ƒç”¨æ ˆã€‚fooPromiseExecutor()å·²ç»è¿”å›ï¼Œæ‰€ä»¥å®ƒä¸åœ¨é”™è¯¯ä¿¡æ¯ä¸­ï¼Œä½†foo()ç”±æ­¤è¢«æŒ‚èµ·äº†ï¼Œå¹¶æ²¡æœ‰é€€å‡ºã€‚JavaScriptè¿è¡Œæ—¶å¯ä»¥ç®€å•åœ°åœ¨åµŒå¥—å‡½æ•°ä¸­å­˜å‚¨æŒ‡å‘åŒ…å«å‡½æ•°çš„æŒ‡é’ˆï¼Œå°±è·Ÿå¯¹å¾…åŒæ­¥å‡½æ•°è°ƒç”¨æ ˆä¸€æ ·ã€‚è¿™ä¸ªæŒ‡é’ˆå®é™…ä¸Šå­˜å‚¨åœ¨å†…å­˜ä¸­ï¼Œå¯ç”¨äºå†å‡ºé”™æ—¶ç”Ÿæˆæ ˆè¿½è¸ªä¿¡æ¯ã€‚ ï¼ˆè¿™æ®µçœ‹ä¸å¤ªæ‡‚ï¼Œä¸è¿‡åªè¦ç†è§£åˆ°å¼‚æ­¥å‡½æ•°å¯¹æ¯”æœŸçº¦ä¼šå‡å°‘å†…å­˜æ¶ˆè€—ï¼Œå› æ­¤åœ¨é‡è§†æ€§èƒ½çš„åº”ç”¨ä¸­å¯ä»¥ä¼˜å…ˆè€ƒè™‘å³å¯ï¼‰","categories":[{"name":"å‰ç«¯","slug":"å‰ç«¯","permalink":"https://taylor12138.github.io/categories/%E5%89%8D%E7%AB%AF/"}],"tags":[],"author":"Hello"},{"title":"Ajax","slug":"Ajax","date":"2022-04-05T04:16:14.188Z","updated":"2023-03-11T17:58:00.264Z","comments":true,"path":"2022/04/05/ajax/","link":"","permalink":"https://taylor12138.github.io/2022/04/05/ajax/","excerpt":"","text":"1.Ajaxæ¦‚è¿°å®ƒæœ€å¤§çš„ç‰¹ç‚¹æ˜¯å¯ä»¥åœ¨ç½‘é¡µä¸åˆ·æ–°çš„æƒ…å†µä¸‹å‘æœåŠ¡ç«¯httpè¯·æ±‚ï¼Œç„¶åå¾—åˆ°httpå“åº” å®ƒå…¨ç§°ä¸º Asynchronous JavaScript And XMLï¼Œå°±æ˜¯å¼‚æ­¥çš„JSå’ŒXMLï¼Œé€šè¿‡Ajaxå¯ä»¥åœ¨æµè§ˆå™¨ä¸­å‘æœåŠ¡å™¨å‘é€å¼‚æ­¥è¯·æ±‚ï¼Œæœ€å¤§ä¼˜åŠ¿ï¼šæ— åˆ·æ–°è·å–æ•°æ®ã€‚AJAXä¸æ˜¯æ–°çš„ç¼–ç¨‹è¯­è¨€ï¼Œè€Œæ˜¯ä¸€ç§å°†ç°æœ‰æ ‡å‡†ç»„åˆåœ¨ä¸€èµ·ä½¿ç”¨çš„æ–°æ–¹å¼ Ajaxåœ¨åº”ç”¨å½“ä¸­éœ€è¦ä¸€ä¸ªæœåŠ¡ç«¯ï¼Œå¯ä»¥é€‰æ‹©nodejsæ¥é…åˆä½¿ç”¨ XMLç®€ä»‹XMLå¯æ‰©å±•æ ‡è®°è¯­è¨€ï¼Œæ˜¯è¢«è®¾è®¡ç”¨æ¥ä¼ è¾“å’Œå­˜å‚¨æ•°æ®çš„ï¼Œå®ƒå’Œhtmlå¾ˆåƒï¼Œå®ƒä»¬ä¸åŒçš„æ˜¯htmlä¸­éƒ½æ˜¯é¢„å®šä¹‰æ ‡ç­¾ï¼Œè€Œxmlæ²¡æœ‰é¢„å®šä¹‰æ ‡ç­¾ï¼Œå…¨æ˜¯è‡ªå®šä¹‰æ ‡ç­¾ï¼Œç”¨æ¥è¡¨ç¤ºä¸€äº›æ•°æ® æœ€å¼€å§‹ajaxåœ¨è¿›è¡Œæ•°æ®äº¤æ¢çš„æ—¶å€™ï¼Œæ‰€ä½¿ç”¨çš„æ ¼å¼å°±æ˜¯XML ä½†æ˜¯ç°åœ¨ajaxéƒ½æ˜¯ä½¿ç”¨jsonäº†ï¼Œjsonç›¸å¯¹xmlæ›´ä¸ºç®€æ´ï¼Œè€Œä¸”åœ¨æ•°æ®è½¬æ¢è¿™å—æ¯”è¾ƒå®¹æ˜“ï¼Œå¯ä»¥å€ŸåŠ©jsonçš„ä¸€äº›apiæ–¹æ³•ï¼Œå¿«é€Ÿå°†å­—ç¬¦ä¸²è½¬æˆjså¯¹è±¡ï¼Œçµæ´»åº¦è¿œèƒœXML XMLå’ŒHTMLè¿™åˆçœ‹èµ·æ¥å¾ˆå¥‡æ€ªï¼šHTML å’Œ XML éå¸¸ç›¸ä¼¼ã€‚æœ‰å¾ˆå¤š XML è§£æå™¨å¯ä»¥ä½¿ç”¨ã€‚HTML å­˜åœ¨ä¸€ä¸ª XML å˜ä½“ (XHTML)ï¼Œé‚£ä¹ˆæœ‰ä»€ä¹ˆå¤§çš„åŒºåˆ«å‘¢ï¼Ÿ åŒºåˆ«åœ¨äº HTML çš„å¤„ç†æ›´ä¸ºâ€œå®½å®¹â€ï¼Œå®ƒå…è®¸æ‚¨çœç•¥æŸäº›éšå¼æ·»åŠ çš„æ ‡è®°ï¼Œæœ‰æ—¶è¿˜èƒ½çœç•¥ä¸€äº›èµ·å§‹æˆ–è€…ç»“æŸæ ‡è®°ç­‰ç­‰ã€‚å’Œ XML ä¸¥æ ¼çš„è¯­æ³•ä¸åŒï¼ŒHTML æ•´ä½“æ¥çœ‹æ˜¯ä¸€ç§â€œè½¯æ€§â€çš„è¯­æ³•ã€‚ æ˜¾ç„¶ï¼Œè¿™ç§çœ‹ä¸Šå»ç»†å¾®çš„å·®åˆ«å®é™…ä¸Šå´å¸¦æ¥äº†å·¨å¤§çš„å½±å“ã€‚ä¸€æ–¹é¢ï¼Œè¿™æ˜¯ HTML å¦‚æ­¤æµè¡Œçš„åŸå› ï¼šå®ƒèƒ½åŒ…å®¹æ‚¨çš„é”™è¯¯ï¼Œç®€åŒ–ç½‘ç»œå¼€å‘ã€‚å¦ä¸€æ–¹é¢ï¼Œè¿™ä½¿å¾—å®ƒå¾ˆéš¾ç¼–å†™æ­£å¼çš„è¯­æ³•ã€‚æ¦‚æ‹¬åœ°è¯´ï¼ŒHTML æ— æ³•å¾ˆå®¹æ˜“åœ°é€šè¿‡å¸¸è§„è§£æå™¨è§£æï¼ˆå› ä¸ºå®ƒçš„è¯­æ³•ä¸æ˜¯ä¸ä¸Šä¸‹æ–‡æ— å…³çš„è¯­æ³•ï¼‰ï¼Œä¹Ÿæ— æ³•é€šè¿‡ XML è§£æå™¨æ¥è§£æã€‚ Ajaxç‰¹ç‚¹ä¼˜ç‚¹ï¼š 1.å¯ä»¥æ— éœ€åˆ·æ–°è€Œä¸æœåŠ¡å™¨ç«¯è¿›è¡Œé€šä¿¡ï¼ˆæé«˜ç”¨æˆ·ä½“éªŒï¼‰ 2.å…è®¸æ ¹æ®ç”¨æˆ·äº‹ä»¶æ¥æ›´æ–°éƒ¨åˆ†é¡µé¢å†…å®¹ ç¼ºç‚¹ 1.æ²¡æœ‰æµè§ˆè®°å½•ï¼Œä¸èƒ½å›é€€ 2.å­˜åœ¨è·¨åŸŸé—®é¢˜ï¼ˆåŒæºï¼‰ 3.SEOä¸å‹å¥½ï¼ˆæœç´¢å¼•æ“ä¼˜åŒ–ï¼‰ï¼ˆæºä»£ç ï¼ˆå“åº”ä½“ï¼‰æ²¡æœ‰éƒ¨åˆ†å•†å“ä¿¡æ¯ï¼Œé‚£äº›å•†å“ä¿¡æ¯éƒ½æ˜¯ajaxå‘æœåŠ¡ç«¯å‘è¯·æ±‚ï¼Œé€šè¿‡æœåŠ¡ç«¯è¿”ç»“æœï¼Œç„¶åjsåŠ¨æ€åˆ›å»ºåˆ°é¡µé¢ï¼Œæ‰€ä»¥çˆ¬è™«ä¹Ÿçˆ¬ä¸åˆ°å•†å“æ•°æ®ï¼‰ AjaxåŸç†Ajaxè¯·æ±‚æ•°æ®æµç¨‹æœ€æ ¸å¿ƒçš„ä¾èµ–æ˜¯æµè§ˆå™¨æä¾›çš„XMLHttpRequestå¯¹è±¡ï¼Œå®ƒæ‰®æ¼”çš„è§’è‰²ç›¸å½“äºç§˜ä¹¦ï¼Œä½¿å¾—æµè§ˆå™¨å¯ä»¥å‘å‡ºHTTPè¯·æ±‚ä¸æ¥æ”¶HTTPå“åº”ã€‚æµè§ˆå™¨æ¥ç€åšå…¶ä»–äº‹æƒ…ï¼Œç­‰æ”¶åˆ°XHRè¿”å›æ¥çš„æ•°æ®å†æ¸²æŸ“é¡µé¢ã€‚ 2.åŸç”Ÿajaxçš„get/postè¯·æ±‚å…ˆåœ¨scriptç»‘å®šäº‹ä»¶å¯¹è±¡ åˆ›å»ºå¯¹è±¡ï¼ˆæ§åˆ¶å¹³å°ä¸­networkä¹Ÿæœ‰XHRï¼Œå®ƒæ˜¯å¯¹ajaxè¯·æ±‚åšä¸€ä¸ªç­›é€‰ï¼‰ XMLHttpRequestï¼ˆXHRï¼‰å¯¹è±¡ç”¨äºä¸æœåŠ¡å™¨äº¤äº’ï¼Œæ˜¯BOMçš„èŒƒç•´å†…ã€‚é€šè¿‡ XMLHttpRequest å¯ä»¥åœ¨ä¸åˆ·æ–°é¡µé¢çš„æƒ…å†µä¸‹è¯·æ±‚ç‰¹å®š URLï¼Œè·å–æ•°æ®ã€‚è¿™å…è®¸ç½‘é¡µåœ¨ä¸å½±å“ç”¨æˆ·æ“ä½œçš„æƒ…å†µä¸‹ï¼Œæ›´æ–°é¡µé¢çš„å±€éƒ¨å†…å®¹ã€‚XMLHttpRequest åœ¨ ajax ç¼–ç¨‹ä¸­è¢«å¤§é‡ä½¿ç”¨ã€‚ åˆå§‹åŒ–ï¼Œè®¾ç½®è¯·æ±‚æ–¹æ³•ï¼ˆè¯·æ±‚ç±»å‹ï¼‰å’Œurl xhr.open(method, URL, [async, user, password]) æ­¤æ–¹æ³•æŒ‡å®šè¯·æ±‚çš„ä¸»è¦å‚æ•°ï¼š method â€”â€” HTTP æ–¹æ³•ã€‚é€šå¸¸æ˜¯ &quot;GET&quot; æˆ– &quot;POST&quot;ã€‚ URL â€”â€” è¦è¯·æ±‚çš„ URLï¼Œé€šå¸¸æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œä¹Ÿå¯ä»¥æ˜¯ URL å¯¹è±¡ã€‚ async â€”â€” å¦‚æœæ˜¾å¼åœ°è®¾ç½®ä¸º falseï¼Œé‚£ä¹ˆè¯·æ±‚å°†ä¼šä»¥åŒæ­¥çš„æ–¹å¼å¤„ç†ï¼Œæˆ‘ä»¬ç¨åä¼šè®²åˆ°å®ƒã€‚ userï¼Œpassword â€”â€” HTTP åŸºæœ¬èº«ä»½éªŒè¯ï¼ˆå¦‚æœéœ€è¦çš„è¯ï¼‰çš„ç™»å½•åå’Œå¯†ç ã€‚ æ­¤å¤–ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥é€šè¿‡ responseType æ¥è®¾ç½®å“åº”æ ¼å¼ &quot;&quot;ï¼ˆé»˜è®¤ï¼‰â€”â€” å“åº”æ ¼å¼ä¸ºå­—ç¬¦ä¸²ï¼Œ &quot;text&quot; â€”â€” å“åº”æ ¼å¼ä¸ºå­—ç¬¦ä¸²ï¼Œ &quot;arraybuffer&quot; â€”â€” å“åº”æ ¼å¼ä¸º ArrayBufferï¼ˆå¯¹äºäºŒè¿›åˆ¶æ•°æ®ï¼Œè¯·å‚è§ ArrayBufferï¼ŒäºŒè¿›åˆ¶æ•°ç»„ï¼‰ï¼Œ &quot;blob&quot; â€”â€” å“åº”æ ¼å¼ä¸º Blobï¼ˆå¯¹äºäºŒè¿›åˆ¶æ•°æ®ï¼Œè¯·å‚è§ Blobï¼‰ï¼Œ &quot;document&quot; â€”â€” å“åº”æ ¼å¼ä¸º XML documentï¼ˆå¯ä»¥ä½¿ç”¨ XPath å’Œå…¶ä»– XML æ–¹æ³•ï¼‰æˆ– HTML documentï¼ˆåŸºäºæ¥æ”¶æ•°æ®çš„ MIME ç±»å‹ï¼‰ &quot;json&quot; â€”â€” å“åº”æ ¼å¼ä¸º JSONï¼ˆè‡ªåŠ¨è§£æï¼‰ã€‚ xhr.open('GET', '/article/xmlhttprequest/example/json'); xhr.responseType = 'json'; å‘é€ï¼Œsendæ–¹æ³•å¯ä»¥æ¥æ”¶ä¸€ä¸ªå‚æ•°ï¼Œä½œä¸ºè¯·æ±‚ä½“ï¼ˆbodyï¼‰å‘é€çš„æ•°æ®ï¼Œå¦‚æœä¸éœ€è¦å‘é€è¯·æ±‚ä½“ï¼Œåˆ™å¿…é¡»ä¼ nullï¼Œå› ä¸ºè¿™ä¸ªå‚æ•°åœ¨æŸäº›æµè§ˆå™¨ä¸­æ˜¯å¿…é¡»çš„ xhr.send(null) xhr.send([body]) äº‹ä»¶ç»‘å®šï¼Œå¤„ç†æœåŠ¡ç«¯è¿”å›çš„ç»“æœ onreadystatechange on æœ‰ whençš„æ„æ€ï¼Œå³å½“ã€‚ã€‚ã€‚çš„æ—¶å€™readystateæ˜¯xhrå¯¹è±¡å½“ä¸­çš„å±æ€§ï¼Œè¡¨ç¤ºçŠ¶æ€0/1/2/3/4ï¼Œåˆ†åˆ«å¯¹åº”ä»¥ä¸Šæ­¥éª¤å®Œæˆä¸å¦çš„çŠ¶æ€ UNSENTï¼Œ0ï¼šæœªåˆå§‹åŒ– OPENEDï¼Œ1ï¼šopenæ–¹æ³•å·²ç»è°ƒç”¨å®Œæ¯• HEADERS_RECEIVEDï¼Œ2ï¼šsendæ–¹æ³•å·²ç»è°ƒç”¨å®Œæ¯•ï¼Œå¹¶ä¸”å¤´éƒ¨å’ŒçŠ¶æ€å·²ç»å¯è·å¾— LOADINGï¼Œ3ï¼šloading, ä¸‹è½½ä¸­ï¼› `responseText` å±æ€§å·²ç»åŒ…å«éƒ¨åˆ†æ•°æ®ã€‚ DONE 4ï¼šæœåŠ¡ç«¯è¿”å›äº†æ‰€æœ‰çš„ç»“æœchange æ”¹å˜çš„æ—¶å€™è§¦å‘ï¼Œè¿™é‡Œä¸€èˆ¬ä¼šè§¦å‘å››æ¬¡ï¼Œæ”¹ä¸€æ¬¡è§¦å‘ä¸€æ¬¡ æ­¤æ—¶xhrå¯¹è±¡çš„å±æ€§æœ‰ï¼š statusçŠ¶æ€ç ï¼ˆ200ç­‰ï¼‰ statusText çŠ¶æ€å­—ç¬¦ä¸²ï¼ˆOKç­‰ï¼‰ getAllResponseHeaders() æ‰€æœ‰å“åº”å¤´ response å“åº”ä½“ è‹¥æ”¶åˆ°ç›¸åº”ä¹‹å‰å¦‚æœæƒ³è¦å–æ¶ˆå¼‚æ­¥è¯·æ±‚ï¼Œå¯ä»¥è°ƒé€š abort æ–¹æ³• xhr.abort() ajaxçš„getè¯·æ±‚æ¡ˆä¾‹const btn = document.querySelector('button'); const result = document.querySelector('#result'); btn.addEventListener('click', () => { //1.åˆ›å»ºå¯¹è±¡ï¼Œæ§åˆ¶å¹³å°ä¸­networkä¹Ÿæœ‰XHRï¼Œå®ƒæ˜¯å¯¹ajaxè¯·æ±‚åšä¸€ä¸ªç­›é€‰ const xhr = new XMLHttpRequest(); //2.åˆå§‹åŒ–ï¼Œè®¾ç½®è¯·æ±‚æ–¹æ³•ï¼ˆè¯·æ±‚ç±»å‹ï¼‰å’Œurl xhr.open('GET', 'http://127.0.0.1:8000/server'); //3.å‘é€ xhr.send(); //4.äº‹ä»¶ç»‘å®šï¼Œå¤„ç†æœåŠ¡ç«¯è¿”å›çš„ç»“æœ xhr.onreadystatechange = () => { //åˆ¤æ–­,æœåŠ¡ç«¯è¿”å›äº†æ‰€æœ‰çš„ç»“æœ if (xhr.readyState === 4) { //åˆ¤æ–­å“åº”çŠ¶æ€ç  if (xhr.status >= 200 &amp;&amp; xhr.status &lt; 300) { //å¤„ç†ç»“æœ è¡Œã€å¤´ã€ç©ºè¡Œå’Œä½“ //1.å“åº”è¡Œé‡Œçš„æ•°æ® console.log(xhr.status); //çŠ¶æ€ç  console.log(xhr.statusText); //çŠ¶æ€å­—ç¬¦ä¸² console.log(xhr.getAllResponseHeaders()); //æ‰€æœ‰å“åº”å¤´ console.log(xhr.response); //å“åº”ä½“ //2.è®¾ç½®resultæ–‡æœ¬ result.innerHTML = xhr.response; } } } }) &lt;/script> ajaxçš„postè¯·æ±‚æ³¨æ„postå’Œgetçš„ä¸åŒç‚¹åœ¨äºï¼š 1.åˆå§‹åŒ–xhr.open(&#39;POST&#39;, url) 2.getæ˜¯åœ¨åˆå§‹åŒ–æ—¶ï¼Œxhr.open(&#39;GET&#39;, &#39;http://127.0.0.1:8000/server?a=100&amp;b=200&#39;);è¿›è¡Œå‚æ•°ä¼ é€’çš„ è€Œpostæ˜¯åœ¨å‘é€æ—¶send(a=100&amp;b=200);è¿›è¡Œå‚æ•°ä¼ é€’çš„ loadäº‹ä»¶Firefoxæœ€åˆåœ¨å®ç°XHRçš„æ—¶å€™ï¼Œæ›¾è‡´åŠ›äºç®€åŒ–äº¤äº’æ¨¡å¼ã€‚æœ€ç»ˆå¢åŠ äº†ä¸€ä¸ªloadäº‹ä»¶æ›¿ä»£readystatechangeäº‹ä»¶ï¼Œloadäº‹ä»¶ä¼šåœ¨å“åº”æ¥æ”¶å®Œæˆä¹‹åç«‹åˆ»è§¦å‘ï¼Œè¿™æ ·å°±ä¸ç”¨æ£€æŸ¥readystateå±æ€§äº†ã€‚è™½ç„¶onloadä¼ å…¥äº†ä¸€ä¸ªeventå¯¹è±¡ï¼Œä½†æ˜¯å¹¶ä¸æ˜¯æ‰€æœ‰æµè§ˆå™¨éƒ½å®ç°äº†è¿™ä¸ªeventå¯¹è±¡ï¼Œæ‰€ä»¥è¿˜æ˜¯ä½¿ç”¨XHRå¯¹è±¡å˜é‡æ¯”è¾ƒå¥½ let xhr = new XMLHttpRequest(); xhr.onload = function(){ if((xhr.status >= 200 &amp;&amp; xhr.status &lt; 300) || xhr.status == 304) { alert(xhr.response) } else { alert('err', 'xhr.status'); } } xhr.open(xxxxxx); xhr.send(null)l 3.ajaxå…¶ä»–httpè¯·æ±‚å¤´ Acceptï¼šæµè§ˆå™¨å¯ä»¥å¤„ç†çš„å†…å®¹ç±»å‹ Accept-Charsetï¼šæµè§ˆå™¨å¯ä»¥æ˜¾ç¤ºçš„å­—ç¬¦é›† Accept-Encodingï¼šæµè§ˆå™¨å¯ä»¥å¤„ç†çš„ç¼–ç ç±»å‹ Accept-Languageï¼šæµè§ˆå™¨ä½¿ç”¨çš„è¯­è¨€ Connectionï¼šæµè§ˆå™¨ä¸æœåŠ¡å™¨è¿æ¥ç±»å‹ Cookie Hostï¼šæ‰€åœ¨åŸŸ Refererï¼šå‘é€è¯·æ±‚çš„é¡µé¢URI User-Agentï¼šæµè§ˆå™¨çš„ç”¨æˆ·ä»£ç†å­—ç¬¦ä¸² æˆ‘ä»¬å¯ä»¥é€šè¿‡ xhr.getResponseHeader(è¯·æ±‚å¤´åç§°) è·å–å“åº”å¤´éƒ¨ å½“ç„¶ä¹Ÿå¯ä»¥ä½¿ç”¨ xhr.getAllResponseHeaders() è·å–æ‰€æœ‰åŒ…å«å“åº”å¤´éƒ¨çš„å­—ç¬¦ä¸² ajaxè¯·æ±‚å¤´è®¾ç½®è®¾ç½®è¯·æ±‚å¤´ï¼Œå¹¶ä¸”å¿…é¡»åœ¨openä¹‹åï¼Œsendä¹‹å‰ xhr.setRequestHeader(å±æ€§å, å±æ€§å€¼); xhr.open('POST', 'http://127.0.0.1:8000/server'); xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded'); xhr.send('a=100&amp;b=200&amp;c=300'); Content-Typeæ˜¯æ¥è®¾ç½®è¯·æ±‚ä½“å†…å®¹ç±»å‹ ä¸æ­¤åŒæ—¶è¿˜å¯ä»¥è‡ªå®šä¹‰å±æ€§ï¼Œxhr.setRequestHeader(&#39;name&#39;, &#39;Allen&#39;); ä½†ä¼šæŠ¥é”™ï¼Œé™¤éåç«¯äººå‘˜åœ¨æœåŠ¡å™¨ï¼š 1.å…ˆæŠŠæœåŠ¡å™¨å¯¹å½“å‰é¡µé¢çš„postè¯·æ±‚æ”¹æˆallï¼Œè¿™æ ·å¯ä»¥æ¥å—ä»»æ„ç±»å‹çš„è¯·æ±‚ app.post(url, callback) =&gt; app.all(url, callback) 2.è¯·æ±‚é‡Œè®¾ç½® res.setHeader(&#39;Access-Control-Allow-Headers&#39;, &#39;*&#39;); Content-TypeContent-Typeï¼ˆå†…å®¹ç±»å‹ï¼‰ï¼Œä¸€èˆ¬æ˜¯æŒ‡ç½‘é¡µä¸­å­˜åœ¨çš„ Content-Typeï¼Œç”¨äºå®šä¹‰ç½‘ç»œæ–‡ä»¶çš„ç±»å‹å’Œç½‘é¡µçš„ç¼–ç ï¼Œå†³å®šæµè§ˆå™¨å°†ä»¥ä»€ä¹ˆå½¢å¼ã€ä»€ä¹ˆç¼–ç è¯»å–è¿™ä¸ªæ–‡ä»¶ï¼Œä¸€èˆ¬ç”¨äºè¡¨æ˜è¯¥è¯·æ±‚çš„æ•°æ®ç±»å‹ å¸¸è§çš„åª’ä½“æ ¼å¼ç±»å‹å¦‚ä¸‹ï¼š text/html ï¼š HTMLæ ¼å¼ text/plain ï¼šçº¯æ–‡æœ¬æ ¼å¼ text/xml ï¼š XMLæ ¼å¼ image/gif ï¼šgifå›¾ç‰‡æ ¼å¼ image/jpeg ï¼šjpgå›¾ç‰‡æ ¼å¼ image/pngï¼špngå›¾ç‰‡æ ¼å¼ ä»¥applicationå¼€å¤´çš„åª’ä½“æ ¼å¼ç±»å‹ï¼š application/xhtml+xml ï¼šXHTMLæ ¼å¼ application/xmlï¼š XMLæ•°æ®æ ¼å¼ application/atom+xml ï¼šAtom XMLèšåˆæ ¼å¼ application/jsonï¼š JSONæ•°æ®æ ¼å¼ application/pdfï¼špdfæ ¼å¼ application/msword ï¼š Wordæ–‡æ¡£æ ¼å¼ application/octet-stream ï¼š äºŒè¿›åˆ¶æµæ•°æ®ï¼ˆå¦‚å¸¸è§çš„æ–‡ä»¶ä¸‹è½½ï¼‰ application/x-www-form-urlencoded ï¼š&lt;form encType=&quot;&quot;&gt;ä¸­é»˜è®¤çš„encTypeï¼Œformè¡¨å•æ•°æ®è¢«ç¼–ç ä¸ºkey/valueæ ¼å¼å‘é€åˆ°æœåŠ¡å™¨ï¼ˆè¡¨å•é»˜è®¤çš„æäº¤æ•°æ®çš„æ ¼å¼ï¼‰ä½¿ç”¨ä¸ URL å‚æ•°ç›¸åŒçš„ç¼–ç  å¦å¤–ä¸€ç§å¸¸è§çš„åª’ä½“æ ¼å¼æ˜¯ä¸Šä¼ æ–‡ä»¶ä¹‹æ—¶ä½¿ç”¨çš„ï¼š multipart/form-data ï¼š éœ€è¦åœ¨è¡¨å•ä¸­è¿›è¡Œæ–‡ä»¶ä¸Šä¼ æ—¶ï¼Œå°±éœ€è¦ä½¿ç”¨è¯¥æ ¼å¼ï¼Œå¦åˆ™å’Œx-www-form-urlencoded å·®ä¸å¤š å“åº”jsonæ•°æ®ä¿å­˜åœ¨jsonæ–‡ä»¶çš„æ˜¯jsonå­—ç¬¦ä¸² JSON.stringify(å¯¹è±¡) JavaScript å€¼(å¯¹è±¡æˆ–æ•°ç»„)è½¬æ¢ä¸º JSON å­—ç¬¦ä¸² JSON.parse(data) å­—ç¬¦è½¬å¯¹è±¡ æˆ–è€…ç›´æ¥åœ¨xhr.openä¹‹å‰è®¾ç½®ï¼š xhr.responseType = &#39;json&#39;ï¼Œè¿™æ ·é€šè¿‡xhr.responseå¾—åˆ°çš„å“åº”ä½“æ•°æ®éƒ½æ˜¯ä»¥å¯¹è±¡å½¢å¼ï¼Œä¸éœ€è¦å†è¿›è¡ŒJSON.parse(xhr.response) IEç¼“å­˜é—®é¢˜ieæµè§ˆå™¨å®ƒä¼šå¯¹ajaxçš„è¯·æ±‚ç»“æœåšä¸€ä¸ªç¼“å­˜ï¼Œè¿™æ ·å¯¼è‡´ä¸‹æ¬¡å†æ¬¡å‘é€è¯·æ±‚æ—¶ï¼Œç”¨çš„æ˜¯æœ¬åœ°ä¹‹å‰çš„ç¼“å­˜è¿›è¡Œå“åº”ï¼Œè€Œä¸æ˜¯æœ€æ–°æ•°æ®ï¼Œè¿™æ ·å¯¼è‡´æ—¶æ•ˆæ€§æ¯”è¾ƒå¼ºçš„ä½¿ç”¨åœºæ™¯ï¼Œajaxè¿™ä¸ªç¼“å­˜ä¼šå½±å“æœ€ç»ˆçš„ç»“æœæ­£ç¡®çš„å‘ˆç° ajaxå…³äºieç¼“å­˜é—®é¢˜è§£å†³æ–¹æ³•ï¼šxhr.open(&#39;POST&#39;, &#39;http://127.0.0.1:8000/server/ie?t=&#39;+Date.now()); ajaxè¯·æ±‚è¶…æ—¶é—®é¢˜ä¸ç½‘ç»œå¼‚å¸¸æˆ‘ä»¬æ°¸è¿œä¸èƒ½ä¿è¯æœåŠ¡ç«¯å¿«é€Ÿã€åŠæ—¶çš„å“åº” è¿™æ—¶æˆ‘ä»¬å¯¹è¶…æ—¶ã€å¼‚å¸¸æƒ…å†µç»™ç”¨æˆ·è¿›è¡Œæé†’ï¼ˆè¶…æ—¶åè‡ªåŠ¨å–æ¶ˆè¯·æ±‚ï¼‰ //è¶…æ—¶ 2s è®¾ç½® xhr.timeout = 2000; //è¶…æ—¶å›è°ƒå‡½æ•° xhr.ontimeout = function () { alert(\"ç½‘ç»œå¼‚å¸¸ï¼Œè¯·ç¨åé‡è¯•\"); } // ç½‘ç»œå¼‚å¸¸å›è°ƒè®¾ç½® xhr.onerror = function () { alert(\"æ‚¨çš„ç½‘ç»œä¼¼ä¹å‡ºäº†ä¸€ç‚¹é—®é¢˜ã€‚ã€‚ã€‚\"); } ajaxå–æ¶ˆè¯·æ±‚ä¸Šæ–¹æ˜¯è¶…æ—¶è‡ªåŠ¨å–æ¶ˆè¯·æ±‚ è¿™é‡Œæ¼”ç¤ºçš„æ˜¯æ‰‹åŠ¨å–æ¶ˆè¯·æ±‚ let xhr = null; btn[0].addEventListener('click', function () { xhr = new XMLHttpRequest(); xhr.open('GET', 'http://127.0.0.1:8000/server/time'); xhr.send(); }); //å–æ¶ˆæŒ‰é’® btn[1].addEventListener('click', function () { xhr.abort(); }) è¯·æ±‚é‡å¤å‘é€é—®é¢˜è¿‡äºé¢‘ç¹åœ°å‘é€è¯·æ±‚ä¼šå¯¼è‡´æœåŠ¡å™¨å‹åŠ›è¿‡å¤§ è¿™é‡Œå¯ä»¥è®¾ç½®ï¼Œå†æ¬¡å‘é€è¯·æ±‚æ—¶ï¼ŒæŠŠä¸Šä¸€ä¸ªè¯·æ±‚å–æ¶ˆæ‰ï¼ˆè¿™é‡Œåœ°é‡å¤å‘é€é—®é¢˜è®©æˆ‘æƒ³èµ·äº†èŠ‚æµé˜€ï¼‰ let isSending = false; btn[0].addEventListener('click', function () { // åˆ¤æ–­æ ‡è¯†å˜é‡,å¦‚æœæ­£æ˜¯åœ¨å‘é€ï¼Œåˆ™å–æ¶ˆè¯¥è¯·æ±‚ï¼Œåˆ›å»ºæ–°çš„è¯·æ±‚ if (isSending) xhr.abort(); xhr = new XMLHttpRequest(); isSending = true; xhr.open('GET', 'http://127.0.0.1:8000/server/time'); xhr.send(); xhr.onreadystatechange = function () { if (xhr.readyState === 4) { // åœ¨è¿™é‡Œä¸åŠ çŠ¶æ€ç åˆ¤æ–­ï¼Œå› ä¸ºè¿™å¯èƒ½æ˜¯ä¸€ä¸ªå¤±è´¥çš„è¯·æ±‚ï¼Œå¦‚æœåŠ åˆ¤æ–­çš„è¯ï¼Œå¯èƒ½å¯¼è‡´isSendingæ°¸è¿œä¸ä¸ºfalse isSending = false; } } }); è¡¨å•çš„åŒ/å¼‚æ­¥æäº¤ä½¿ç”¨jQueryå®ç°ajaxçš„æ³¨å†Œå°æ¡ˆä¾‹ ï¼ˆå¼‚æ­¥æäº¤ï¼Œå³ä½¿ç”¨submitäº‹ä»¶æ¥æäº¤æ•°æ®ï¼ŒåŒæ­¥æäº¤æ˜¯ç›´æ¥formè¡¨å•ä¸Šå¢åŠ å±æ€§å€¼ï¼š action=è·¯å¾„, method=&quot;POST&quot;ï¼‰ è¡¨å•å…·æœ‰é»˜è®¤çš„æäº¤è¡Œä¸ºï¼Œé»˜è®¤æ˜¯åŒæ­¥çš„ï¼ŒåŒæ­¥è¡¨å•æäº¤ç¼ºç‚¹ï¼š 1.æµè§ˆå™¨ä¼šé”æ­»ï¼ˆè½¬åœˆå„¿ï¼‰ç­‰å¾…æœåŠ¡ç«¯çš„å“åº”ç»“æœã€‚ 2.è¡¨å•çš„åŒæ­¥æäº¤ä¹‹åï¼Œæ— è®ºæœåŠ¡ç«¯å“åº”çš„æ˜¯ä»€ä¹ˆï¼Œéƒ½ä¼šç›´æ¥æŠŠå“åº”çš„ç»“æœï¼ˆres.send()ï¼‰è¦†ç›–æ‰å½“å‰é¡µé¢ã€‚ï¼ˆä¸Šé¢crudeæ¡ˆä¾‹æ²¡æœ‰è¦†ç›–æ˜¯å› ä¸ºï¼Œæ¯æ¬¡postè¯·æ±‚åéƒ½ç›´æ¥é‡å®šå‘äº†ï¼‰ 3.ç”¨æˆ·æäº¤è¡¨å•ä¹‹åï¼Œé¡µé¢é‡æ–°æ¸²æŸ“æ˜¾ç¤ºä»…ä»…æœ‰â€œå¯†ç /é‚®ç®±å·²å­˜åœ¨ï¼Œè¯·ç¨åé‡è¯•â€çš„å¦å¤–ä¸€ä¸ªé¡µé¢ï¼Œé‡æ–°æ›´æ”¹éœ€è¦åé€€ç½‘é¡µè¿›è¡Œå†æ¬¡è¡¨å•ä¿®æ”¹ã€æäº¤ï¼Œæ‰€ä»¥ä½“éªŒå¾ˆä¸å¥½ï¼Œæ‰€ä»¥åé¢é‡‡ç”¨äº†ç›´æ¥res.render(å½“å‰é¡µé¢, {æ•°æ®æ¸²æŸ“})+æç¤ºçš„æ–¹æ³• ä¼˜ç‚¹ï¼šç”±æœåŠ¡ç«¯å¤„ç†ï¼Œæ›´åŠ å®‰å…¨ä¸€ç‚¹ å¼‚æ­¥æäº¤: å‡å°‘æœåŠ¡å™¨å‹åŠ›ï¼Œè®©å®¢æˆ·ç«¯å¤„ç†æ›´å¤šäº¤äº’æ•ˆæœ //&lt;form id=\"login_form\"> &lt;button type=\"submit\">ç™»å½•&lt;/button> &lt;/form> $('#register_form').on('submit', function (e) { e.preventDefault() var formData = $(this).serialize() $.ajax({ url: '/register', type: 'post', data: formData, dataType: 'json', success: function (data) { var err_code = data.err_code if (err_code === 0) { // window.alert('æ³¨å†ŒæˆåŠŸï¼') // æœåŠ¡ç«¯é‡å®šå‘é’ˆå¯¹å¼‚æ­¥è¯·æ±‚æ— æ•ˆ window.location.href = '/' } else if (err_code === 1) { window.alert('é‚®ç®±å·²å­˜åœ¨ï¼') } else if (err_code === 2) { window.alert('æ˜µç§°å·²å­˜åœ¨ï¼') } else if (err_code === 500) { window.alert('æœåŠ¡å™¨å¿™ï¼Œè¯·ç¨åé‡è¯•ï¼') } } }) }) 4.AJAXçš„ä½¿ç”¨å·¥å…·jQueryä¸­çš„AJAXè¦å»githubä¸‹è½½åŒ…ï¼Œæˆ–è€…ç”¨scriptåŠ è½½å·¥å…·çš„ç½‘å€ åˆæˆ–è€…åœ¨BootCDNç½‘ç«™ä¸Šæ‰¾åˆ°å·¥å…·åŒ…ç½‘å€ï¼Œç”¨scriptåŠ è½½ä½¿ç”¨ï¼ˆç›¸å¯¹äºgithubç½‘å€æ›´å¿«é€Ÿï¼‰ ä½†æ˜¯ä¸å»ºè®®åœ¨Reactã€Vueé‡Œä½¿ç”¨ getå’Œpost $.get(url, å‚æ•°, callback, type) $.post(url, å‚æ•°, callback, type) å›è°ƒå‡½æ•°é‡Œæ¥æ”¶çš„dataä¸ºå“åº”ï¼Œå³æœåŠ¡å™¨é‡Œsendçš„æ•°æ® typeï¼šå¦‚å“åº”ä½“ç±»å‹â€™jsonâ€™åˆ™å°†jsonå­—ç¬¦ä¸²è½¬åŒ–ä¸ºå¯¹è±¡ &lt;button>get&lt;/button> &lt;button>post&lt;/button> &lt;script> $('button').eq(0).click(function () { $.get('http://127.0.0.1:8000/server/jquery', { a: 100, b: 200 }, function (data) { console.log(data); }, 'json'); }); $('button').eq(1).click(function () { $.post('http://127.0.0.1:8000/server/jquery', { a: 100, b: 200 }, function (data) { console.log(data); }); }) å¦å¤–ä¸€ç§æ–¹å¼ï¼Œå¯å®šä¹‰çš„å±æ€§æ“ä½œæ¯”è¾ƒçµæ´»ã€ç»“æ„æ¸…æ™°ï¼Œä½†æ˜¯ç›¸å¯¹ä»¥ä¸Šä¸¤ç§æ–¹å¼ä»£ç ä»¥è¾ƒå¤æ‚ $('button').eq(2).click(function () { $.ajax({ url: 'http://127.0.0.1:8000/server/jquery', data: { a: 100, b: 200 }, type: 'GET', //æŠŠæ¥æ”¶åˆ°çš„æ•°æ®è½¬æˆå¯¹è±¡ dataType: 'json', // æˆåŠŸçš„å›è°ƒ success: function (data) { console.log(data); }, timeout: 2000, // å¤±è´¥çš„å›è°ƒ err: function () { console.log('å‡ºé”™å•¦ï¼'); }, //å¤´ä¿¡æ¯ // headers: { // c: 300, // d: 400 // } }) }) Axiosç›®å‰ï¼ˆ2020ï¼‰å¹´æœ€çƒ­é—¨çš„ajaxå·¥å…·åº“ï¼Œè¦å»githubä¸‹è½½åŒ…ï¼Œæˆ–è€…ç”¨scriptåŠ è½½å·¥å…·çš„ç½‘å€ åˆæˆ–è€…åœ¨BootCDNç½‘ç«™ä¸Šæ‰¾åˆ°å·¥å…·åŒ…ç½‘å€ï¼Œç”¨scriptåŠ è½½ä½¿ç”¨ï¼ˆç›¸å¯¹äºgithubç½‘å€æ›´å¿«é€Ÿï¼‰ é¡¹ç›®ä¸­ä½¿ç”¨axioså±…å¤šã€æ”¯æŒPromiseï¼ˆå½“æˆPromiseå¯¹è±¡æ¥çœ‹å¾…ï¼‰ axioså¸¸è§é…ç½® urlï¼šè¯·æ±‚åœ°å€ methodï¼šè¯·æ±‚æ–¹æ³• baseURLï¼šè¯·æ±‚æ ¹è·¯å¾„ transformRequest:[function(data){}]ï¼šè¯·æ±‚å‰æ•°æ®å¤„ç† transformResponse:[function(data){}]ï¼šè¯·æ±‚åæ•°æ®å¤„ç† headers:{â€˜x-Requested-Withâ€™:â€™XMLRequestâ€™}ï¼šè‡ªå®šä¹‰è¯·æ±‚å¤´ paramsï¼šURLæŸ¥è¯¢å¯¹è±¡ï¼ˆä¸€èˆ¬ç”¨äºgetè¯·æ±‚ï¼‰ æµ‹è¯•è¯·æ±‚ç½‘å€æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä»¥ä¸‹ç½‘å€è¿›è¡Œè¯·æ±‚æµ‹è¯• http://httpbin.org/ axiosçš„é€šç”¨æ–¹å¼å’ŒjQueryçš„æ–¹å¼éƒ½å¾ˆåƒ btn[2].addEventListener('click', function () { axios({ method: 'POST', url: 'http://127.0.0.1:8000/axios', params: { id: 100, level: 500 }, headers: { a: 100, b: 200 }, // è¯·æ±‚ä½“å‚æ•° data: { username: 'allen', password: 123456 } }).then(res => { //å¤„ç†è¿”å›ç»“æœ console.log(res); }) }) get&amp;postgetæ–¹æ³•ï¼šaxios.get(url[, config]) å¦‚æœä¸æƒ³æŠŠå¯¹åº”å‚æ•°ç›´æ¥æ‹¼æ¥åˆ° url çš„åé¢ï¼Œåˆ™å¯ä»¥æŠŠå¯¹åº”å‚æ•°æ”¾åˆ°params btn[0].addEventListener('click', function () { axios.get('http://127.0.0.1:8000/axios', { // urlå‚æ•° params: { ID: 12345 }, }).then(value => { //è¿™é‡Œæ²¡æœ‰ä½¿ç”¨å›è°ƒå‡½æ•°ï¼Œå› ä¸ºaxiosæ”¯æŒPromiseï¼Œæ‰€ä»¥ä½¿ç”¨ç—›æ¨å¤„ç†å›è°ƒ //valueæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œé‡Œé¢åŒ…å«äº†å“åº”çš„å„ç±»ä¿¡æ¯ console.log(value); }); }); postæ–¹æ³•ï¼šaxios.post(url[, data[, config]]) ä¸€èˆ¬å¯ä»¥æŠŠå¯¹åº”å‚æ•°æ”¾åˆ°dataï¼ˆå³request.bodyï¼‰ btn[1].addEventListener('click', function () { axios.post('http://127.0.0.1:8000/axios', { // postç¬¬äºŒä¸ªå‚æ•°å¯ä»¥è®¾ç½®è¯·æ±‚ä½“ username: 'allen', password: 'allen' }, { //è®¾ç½®å…¶ä»–å‚æ•°ï¼Œå¦‚headersç­‰ }) }); axios.allæˆ‘ä»¬åœ¨Promiseä¸­å­¦ä¹ è¿‡å¤„ç†ç›¸äº’ä¾èµ–çš„å¹¶å‘ç½‘ç»œè¯·æ±‚è§£å†³æ–¹æ³•ï¼ˆå¤šä¸ªå¹¶å‘ç½‘ç»œè¯·æ±‚çš„å“åº”å…¨éƒ¨åˆ°è¾¾åæ‰å»åšç›¸åº”å¤„ç†ï¼‰ ä½†æ˜¯axiosæœ¬èº«æ”¯æŒæ”¯æŒPromiseè¯­æ³•ï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥ä½¿ç”¨ axios.all([axios(), axios().....]).then(result =&gt; {}) axios.all([ axios({url: ''}), axios({url: ''}) ]).then(results => { // resultsæ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œå®ƒåŒ…å«ä»¥ä¸Šå¼‚æ­¥æ“ä½œçš„ç»“æœ console.log(results[0], results[1]); }) å…¨å±€é…ç½®äº‹å®ä¸Šï¼Œåœ¨å¼€å‘ä¸­å¾ˆå¤šå‚æ•°éƒ½æ˜¯å›ºå®šçš„ è¿™æ—¶å€™æˆ‘ä»¬å¯ä»¥è¿›è¡Œä¸€äº›æŠ½å–ï¼Œä¹Ÿå¯ä»¥åˆ©ç”¨axioså…¨å±€é…ç½® axios.defaults.é…ç½® axios.defaults.baseURL = 'http://123.207.32.32:8000'; axios.defaults.timeout = 5000; ä¹‹åä¸ç”¨å†æ¬¡åœ¨axiosä¸­è®¾ç½®äº†ï¼ˆé™¤éä½ æƒ³æ›´æ”¹ï¼‰ï¼Œå·²ç»æœ‰äº†é»˜è®¤å€¼ axioså®ä¾‹å’Œæ¨¡å—å°è£…æœ‰æ—¶æˆ‘ä»¬éœ€è¦ä»ä¸åŒçš„æœåŠ¡å™¨å‘é€è¯·æ±‚ï¼Œåˆ™éœ€è¦å¯¹åº”ä¸åŒçš„ipåœ°å€ï¼Œè¿™æ—¶è®¾ç½®å…¨å±€é…ç½®ä¸å¤ªåˆé€‚ æ‰€ä»¥ä¸€èˆ¬éƒ½æ˜¯åˆ›å»ºå¯¹åº”axioså®ä¾‹è¿›è¡Œé…ç½® // åˆ›å»ºå®ä¾‹ const instance = axios.create({ // åœ¨é‡Œé¢è¿›è¡Œå®ä¾‹çš„åŸºæœ¬é…ç½® baseURL: 'http://123.207.32.32:8000', timeout: 5000 }); instance({ url:'/home/multidata' }).then(res => { console.log(res); }) è€Œä¸”åœ¨å¼€å‘è¿‡ç¨‹ä¸­ï¼Œä¸æ¨èç»„ä»¶å†…ç›´æ¥å¼•ç”¨ç¬¬ä¸‰æ–¹çš„ axios è¿›è¡Œä¾èµ–ï¼Œå¦‚æœæœ‰ä¸€å¤©axiosä¸å†è¿›è¡Œç»´æŠ¤ï¼Œæ”¹åŠ¨æ—¶ä¼šååˆ†éº»çƒ¦ æ‰€ä»¥æˆ‘ä»¬å¯ä»¥å¯¹å…¶è¿›è¡Œæ¨¡å—å°è£…ï¼š åœ¨srcæ–‡ä»¶å¤¹ä¸‹ï¼Œæ–°å»ºä¸€ä¸ªnetworkæ–‡ä»¶å¤¹ï¼Œç„¶åå†è¯¥æ–‡ä»¶å¤¹ä¸‹æ–°å»ºä¸€ä¸ª request.js æ–‡ä»¶ åœ¨é‡Œé¢æ’°å†™åŸºäº axios å‘é€ç½‘ç»œè¯·æ±‚ã€ä¸åŒå®ä¾‹çš„ä»£ç  //request.js import axios from 'axios' export function request(config) { // 1.åˆ›å»ºaxioså®ä¾‹ const instance = axios.create({ baseURL: 'http://123.207.32.32:8000', timeout: 5000, }) return instance(config); } //main.js // ä½¿ç”¨å°è£…requestæ¨¡å— import { request } from './network/request' request({ url: '/home/multidata' }).then(res => { console.log(res); }).catch(err => { console.log(err); }) axiosæ‹¦æˆªå™¨axiosæä¾›äº†æ‹¦æˆªå™¨ï¼Œç”¨äºæˆ‘ä»¬åœ¨æ¯æ¬¡å‘é€è¯·æ±‚æˆ–è€…å¾—åˆ°å“åº”åï¼Œè¿›è¡Œç›¸åº”çš„å¤„ç† æ‹¦æˆªè¯·æ±‚ï¼šaxios.interceptors.request.use(æˆåŠŸçš„å›è°ƒ, å¤±è´¥çš„å›è°ƒ) æ‹¦æˆªå“åº”ï¼šaxios.interceptors.response.use(æˆåŠŸçš„å›è°ƒ, å¤±è´¥çš„å›è°ƒ) ä¸‹é¢ä»¥instanceä¸ºå®ä¾‹ï¼Œè¿›è¡Œæ¼”ç¤º requestæ‹¦æˆªä¸‹æ¥çš„configå‚æ•°å…¶å®å°±æ˜¯æˆ‘ä»¬çš„ç½‘ç»œè¯·æ±‚çš„é…ç½®ï¼ˆä½†æ²¡æœ‰æ‹¦æˆªä¸‹æ•°æ®ï¼‰ responseæ‹¦æˆªä¸‹æ¥çš„ç»“æœï¼ˆåŒ…å«æ•°æ®ï¼‰ requestæ‹¦æˆªä¸‹æ¥è¿›è¡Œå¤„ç† æ¯”å¦‚ï¼šconfigä¸€äº›ä¿¡æ¯ä¸ç¬¦åˆæœåŠ¡å™¨è¦æ±‚ï¼Œæ·»åŠ headersä¹‹ç±»çš„ æ¯”å¦‚ï¼šæ¯æ¬¡å‘é€ç½‘ç»œè¯·æ±‚ï¼Œéƒ½å¸Œæœ›åœ¨ç•Œé¢ä¸­æ˜¾ç¤ºä¸€ä¸ªè¯·æ±‚çš„å›¾æ ‡ï¼Œæˆ–è€…è¯´å±•ç¤ºloadingç»„ä»¶ æ¯”å¦‚ï¼šæŸäº›ç½‘ç»œè¯·æ±‚ï¼ˆç™»å½•ï¼ˆtokenï¼‰ï¼‰ï¼Œå¿…é¡»æºå¸¦ä¸€äº›ç‰¹æ®Šçš„ä¿¡æ¯ const instance = axios.create({ baseURL: '...', timeout: 5000, }) //æ¯ä¸€æ¬¡å‘é€è¯·æ±‚ä¹‹å‰éƒ½ä¼šè¢«è°ƒç”¨ instance.interceptors.request.use(config => { console.log(config); // æ‹¦æˆªå®Œåå¿…é¡»æŠŠé…ç½®ç»™äººè¿˜å›å»ï¼Œä¸ç„¶ç½‘ç»œè¯·æ±‚ä¼šå‘é€å¤±è´¥ return config; }, err => { console.log(err); }); //æ¯ä¸€æ¬¡å¾—åˆ°å“åº”ï¼Œåˆ™ä¼šè¿›å…¥åˆ°è¯¥æ‹¦æˆªå™¨ instance.interceptors.response.use(res => { console.log(res); // æ‹¦æˆªå®Œåå¿…é¡»æŠŠé…ç½®ç»™äººè¿˜å›å»ï¼Œä¸ç„¶ç½‘ç»œè¯·æ±‚æ— è¿”å›ç»“æœï¼ˆundefinedï¼‰ //è¿™é‡Œæˆ‘åªè¿”å›data,ä¸çœ‹å…¶ä»–resçš„ä¿¡æ¯ return res.data; }, err => { console.log(err); }) åˆ©ç”¨fetchå‘é€ajaxè¯·æ±‚fetchå±äºå…¨å±€å¯¹è±¡ï¼Œå¯ä»¥ç›´æ¥å»è°ƒç”¨ï¼Œä¸åŒä¸‹è½½ä»€ä¹ˆåŒ…ï¼Œè¿”å›çš„ç»“æœæ˜¯ä¸€ä¸ªpromiseå¯¹è±¡ const fetchResponsePromise = fetch(resource [, init]) resourceï¼šurlï¼Œæˆ–è€…ä¸€ä¸ªrequestå¯¹è±¡ initï¼šå¯é€‰çš„é…ç½®é¡¹ æ³¨æ„ï¼šä½¿ç”¨fetchå¿…é¡»å®šä¹‰ Content-Typeï¼ˆaxioså°±ä¸ç”¨ï¼‰ï¼Œç”¨jsonæ ¼å¼å°±è¦è®¾ç½® â€˜application/jsonâ€™ application/jsonï¼š ä¸€ç§ä¼ è¾“æ ¼å¼ï¼Œåœ¨postmançœ‹åˆ°æ ¼å¼å†…å®¹æ˜¯rawçš„ä¸€èˆ¬å°±æ˜¯jsonæ ¼å¼çš„ï¼ŒrawæŒ‡çš„æ˜¯ä¸ä¼šå¯¹å…¶è¿›è¡Œä»»ä½•ç±»å‹çš„æ›´æ”¹ const payload = JSON.stringify({ foo: 'bar' }); const jsonheader = new Headers({ 'Content-Type': 'application/json' }) btn[0].addEventListener('click', function () { fetch('http://127.0.0.1:8000/fetch', { //è¯·æ±‚æ–¹æ³• method: 'POST', // è¯·æ±‚å¤´ headers: jsonheader //è¯·æ±‚ä½“,ç»MDNæ–‡æ¡£ä¸Šä»‹ç»ï¼Œè¿™é‡Œå¯ä»¥ä»¥å¤šç§å½¢å¼æ¥æ’°å†™ body: payload }).then(res => { //è¿”å›çš„ç»“æœæ˜¯ä¸€ä¸ªpromiseå¯¹è±¡,æ‰€ä»¥ä½¿ç”¨thenå›è°ƒæ–¹å¼æ¥æ”¶å’Œå¤„ç†ç»“æœ //ä½†æ˜¯è¿™é‡Œçš„resç»“æœä¸æ˜¯è¿”å›æ•°æ®ï¼Œè€Œæ˜¯æç¤ºè”ç³»æœåŠ¡å™¨æˆåŠŸ or å¤±è´¥ console.log(res); return res.json; },err => console.log(err)) //é™¤éæ–­ç½‘ï¼Œè”ç³»ä¸åˆ°æœåŠ¡å™¨ï¼Œæ‰ä¼šè¢«è°ƒç”¨) .then(data => { //è¿™é‡Œæ‰èƒ½çœŸæ­£å¾—åˆ°æˆ‘ä»¬æƒ³è¦çš„æ•°æ® console.log(data); }) }) è¯¦æƒ…å¯è¿›å…¥äº†è§£fetchä»‹ç»ï¼ˆååˆ†æ¨èï¼‰https://segmentfault.com/a/1190000003810652 ç¼ºç‚¹ï¼šå…¼å®¹æ€§è¾ƒä¸€èˆ¬ 5.TSå¯¹axiosçš„å°è£…åœ¨typescriptä¸­å¯¹æ¨¡å—çš„å°è£…åˆæœ‰ç‚¹ä¸åŒï¼Œä¸»è¦åœ¨äºæˆ‘ä»¬éœ€è¦é¢„å…ˆå¯¹æ¥å£çš„å®šä¹‰ é¦–å…ˆä¸ºæˆ‘ä»¬çš„ç½‘ç»œè¯·æ±‚å®šä¹‰ä¸€ä¸ªç±» import axios from 'axios' import type { AxiosInstance, AxiosRequestConfig } from 'axios' import { IInterceptor, IConfig } from './type' // æŠŠä¸€å¤§å †ä¸œè¥¿å°è£…åˆ°ä¸€å—ï¼Œæ¨èä½¿ç”¨ç±»è¿›è¡Œå°è£… export default class MYRequest { instance: AxiosInstance interceptors?: IInterceptor constructor(config: IConfig) { this.instance = axios.create(config) this.interceptors = config?.interceptors this.instance.interceptors.request.use( this.interceptors?.requesInterceptor, this.interceptors?.requstInterceptorCatch ) this.instance.interceptors.response.use( this.interceptors?.responseInterceptor, this.interceptors?.responseInterceptorCatch ) } request(config: AxiosRequestConfig): void { this.instance.request(config).then((res) => { console.log(res, 'requestæ–¹æ³•') }) } } ç±»ä¸­ä½¿ç”¨çš„æ¥å£ï¼ˆtypeï¼‰å†ç»™ä»–å°è£…æˆä¸€ä¸ªæ¨¡å— import { AxiosRequestConfig } from 'axios' export interface IInterceptor { requesInterceptor?: (config: AxiosRequestConfig) => AxiosRequestConfig requstInterceptorCatch?: (err: any) => any responseInterceptor?: (config: AxiosRequestConfig) => AxiosRequestConfig responseInterceptorCatch?: (err: any) => any } export interface IConfig extends AxiosRequestConfig { interceptors?: IInterceptor } ç„¶åå®ä¾‹åŒ–è¿™ä¸ªç±»ï¼Œæ¯ä¸ªå®ä¾‹éƒ½å¯ä»¥å•ç‹¬ä½œä¸ºç½‘ç»œè¯·æ±‚çš„å°è£…å‡½æ•°ï¼Œåˆ°æ—¶å€™é€šè¿‡ å®ä¾‹.æ–¹æ³• çš„å½¢å¼è¿›è¡Œè°ƒç”¨ import MYRequest from './request' import { BASE_URL } from './request/config' const myRequest = new MYRequest({ baseURL: BASE_URL, interceptors: { requesInterceptor: (config) => { const token = '123' if (token &amp;&amp; config.headers) { config.headers.Authorization = `Bearer ${token}` } console.log('è¯·æ±‚æˆåŠŸæ‹¦æˆª', config) return config }, requstInterceptorCatch: (err) => { console.log('è¯·æ±‚å¤±è´¥æ‹¦æˆª', err) }, responseInterceptor: (config) => { console.log('å“åº”æˆåŠŸæ‹¦æˆª', config) return config } } }) export default myRequest 6.è·¨åŸŸåŒæºç­–ç•¥å®ƒæ˜¯æµè§ˆå™¨æœ€æ ¸å¿ƒä¹Ÿæœ€åŸºæœ¬çš„å®‰å…¨åŠŸèƒ½ åŒæºï¼Œå³ï¼ˆå½“å‰ç½‘é¡µçš„urlå’Œajaxè¯·æ±‚çš„ç›®æ ‡èµ„æºçš„urlä¹‹é—´ï¼‰åè®®ã€åŸŸåã€ç«¯å£å·å¿…é¡»å®Œå…¨ç›¸åŒï¼Œè€Œajaxæ˜¯é»˜è®¤éµä»åŒæºç­–ç•¥ï¼Œ è€Œè¿èƒŒåŒæºç­–ç•¥å°±æ˜¯è·¨åŸŸï¼Œå‡å¦‚å½“å‰ç½‘é¡µæ—¶a.comï¼Œè€Œä½ å‘b.comå‘é€äº†è¯·æ±‚ï¼Œåˆ™æ­¤æ—¶æ˜¯è·¨åŸŸè¯·æ±‚ å•å°æœåŠ¡å™¨çš„æ€§èƒ½æ˜¯æœ‰ä¸Šé™çš„ï¼Œéœ€è¦å¤–åŠ æ›´å¤šçš„è®¡ç®—æœºã€æœåŠ¡å™¨æå‡æœåŠ¡æ°´å¹³ æ»¡è¶³åŒæºçš„æƒ…å†µï¼š btn.onclick = function () { const xhr = new XMLHttpRequest(); // è¿™é‡Œæ»¡è¶³urlåŒæºç­–ç•¥ï¼Œæ‰€ä»¥åœ¨ä»¥ //http://127.0.0.1:9000/homeæ‰“å¼€ç½‘ç«™æ—¶,å¯ä»¥ç®€å†™ä¸º/data xhr.open('GET', '/data'); xhr.send(); xhr.onreadystatechange = function () { if (xhr.readyState === 4) { if (xhr.status >= 200 &amp; xhr.status &lt; 300) { console.log(xhr.response); } } } }; const express = require('express'); const app = express(); app.get('/home', (req, res) => { res.sendFile(__dirname + '/kuayu.html'); }); app.get('/data', (req, res) => { res.send('ç”¨æˆ·æ•°æ®'); }) app.listen(9000, () => { console.log(\"æœåŠ¡å·²å¯åŠ¨ï¼Œ9000ç«¯å£ç›‘å¬ä¸­...\"); }) JSONPå®ç°è·¨åŸŸåŸç†JSONPï¼šJSON with padding JSONPæ˜¯ä¸€ä¸ªéå®˜æ–¹è§£å†³è·¨åŸŸçš„é—®é¢˜ï¼Œåªæ”¯æŒgetè¯·æ±‚ã€‚ åœ¨ç½‘é¡µæœ‰ä¸€äº›æ ‡ç­¾å¤©ç”Ÿå…·å¤‡è·¨åŸŸèƒ½åŠ›ï¼Œæ¯”å¦‚imgï¼Œlinkï¼Œscript ä¼˜ç‚¹ï¼šå…¼å®¹æ€§éå¸¸å¥½ ç¼ºç‚¹ï¼š æ˜¯åªæ”¯æŒgetè¯·æ±‚ï¼Œä¸æ”¯æŒpostè¯·æ±‚ã€‚ ä¸å¥½ç¡®å®šè¯·æ±‚æ˜¯å¦å¤±è´¥ è¦ä¿è¯WebæœåŠ¡å®‰å…¨æ€§æ‰èƒ½ä½¿ç”¨å®ƒï¼Œå› ä¸ºåŸŸä¸å¯ä¿¡æ—¶ï¼Œå¯èƒ½åŠ å…¥æ¶æ„å†…å®¹ï¼Œæ­¤æ—¶åªèƒ½å®Œå…¨åˆ é™¤æ‰JSONP &lt;script src=\"http://127.0.0.1:9000/jsonp\">&lt;/script> app.get('/jsonp', (req, res) => { res.send('console.log(\"hello world\")'); }) JSONPè·¨åŸŸå®ä¾‹åŠ¨æ€åˆ›å»ºscriptæ ‡ç­¾ï¼Œæ·»åŠ srcå€¼ä¸ºè¯·æ±‚çš„åŸŸååœ°å€ï¼Œå†åŠ¨æ€æ·»åŠ è‡³bodyå†…éƒ¨ const input = document.querySelector('input'); const p = document.querySelector('p'); // å£°æ˜handleå‡½æ•° function handle(data) { input.style.border = \"solid 1px #f00\"; p.innerHTML = data.msg; }; input.addEventListener('blur', function () { let username = this.value; //1. åˆ›å»ºscriptæ ‡ç­¾ const script = document.createElement('script'); //2. è®¾ç½®scriptçš„srcå±æ€§ script.src = 'http://127.0.0.1:9000/jsonp'; //3.å°†scriptæ’å…¥æ–‡æ¡£ä¸­(æ·»åŠ èŠ‚ç‚¹) document.body.appendChild(script); }) //æœåŠ¡å™¨éƒ¨åˆ† //jsonp app.get('/jsonp', (req, res) => { const data = { exist: 1, msg: 'ç”¨æˆ·åå·²ç»å­˜åœ¨' }; // è½¬å­—ç¬¦ä¸²å†è°ƒç”¨handleå‡½æ•° res.send(`handle(${JSON.stringify(data)})`); }) æ‰€ä»¥ä½¿ç”¨jsonpä¼ è¾“æ•°æ®æ—¶ï¼Œåç«¯éœ€è¦å¤„ç†æ•°æ®è®²æ•°æ®è½¬æ¢ä¸ºjsonæ ¼å¼ jQueryå®ç°è·¨åŸŸåŠŸèƒ½$(*selector*).getJSON(*url,data,success(data,status,xhr))* getJSON() æ–¹æ³•ä½¿ç”¨ AJAX çš„ HTTP GET è¯·æ±‚è·å– JSON æ•°æ®ã€‚è€Œè·¨åŸŸçš„å®ç°æ˜¯é€šè¿‡åœ¨urlåå¢åŠ &#39;?callback=?&#39;ï¼Œå¹¶ä¸”åœ¨æœåŠ¡å™¨ä¸Šè°ƒç”¨æ¥æ”¶jQuerycallbackå‚æ•°çš„å‡½æ•° $('button').eq(0).click(function () { // åœ¨jQueryé‡Œå‘é€JSONPè¯·æ±‚,è¿™é‡Œç¬¬ä¸€ä¸ªå‚æ•°åä¸€å®šè¦åŠ '?callback=?' $.getJSON('http:127.0.0.1:9000/jQuery-jsonp?callback=?', function (data) { console.log(data); $('#result').html(` åç§°: ${data.name},&lt;/br> åŸå¸‚: ${data.city[1]} `) }); }) //æœåŠ¡å™¨éƒ¨åˆ† app.get('/jQuery-jsonp', (req, res) => { const data = { name: 'Allen', city: ['åŒ—äº¬', 'æ¾³é—¨', 'å¹¿å·'] }; // æ¥æ”¶jQuerycallbacké‚£ä¸ªå‚æ•° let cb = req.query.callback; // è½¬å­—ç¬¦ä¸²å†è°ƒç”¨handleå‡½æ•° //cbå®é™…ä¸Šæ˜¯jQuery+ä¸€ä¸²æ•°å­—ï¼Œä½†ä»–ä¿å­˜çš„å…¶å®æ˜¯è°ƒç”¨jQuerygetJSONé‡Œçš„å›è°ƒå‡½æ•° res.send(`${cb}(${JSON.stringify(data)})`); }) CORSè§£å†³è·¨åŸŸé—®é¢˜CORSï¼Œè·¨åŸŸèµ„æºå…±äº«ï¼Œå®ƒæ˜¯å®˜æ–¹çš„è·¨åŸŸè§£å†³æ–¹æ¡ˆï¼Œå®ƒçš„ç‰¹ç‚¹æ˜¯ä¸éœ€è¦åœ¨å®¢æˆ·ç«¯åšä»»ä½•ç‰¹æ®Šæ“ä½œï¼Œå®Œå…¨åœ¨æœåŠ¡å™¨ä¸­è¿›è¡Œå¤„ç†ï¼Œæ”¯æŒgetã€postè¯·æ±‚ï¼Œè·¨åŸŸèµ„æºå…±äº«æ ‡å‡†æ–°å¢äº†ä¸€ç»„httpé¦–éƒ¨å­—æ®µï¼Œå…è®¸æœåŠ¡å™¨å£°æ˜å“ªäº›æºç«™é€šè¿‡æµè§ˆå™¨æƒé™è®¿é—®å“ªäº›èµ„æº å·¥ä½œåŸç†ï¼šè®¾ç½®ä¸€ä¸ªå“åº”å¤´ï¼ˆä½¿ç”¨è‡ªå®šä¹‰çš„HTTPå¤´éƒ¨ï¼‰å‘Šè¯‰æµè§ˆå™¨ï¼Œè¯¥è¯·æ±‚å…è®¸è·¨åŸŸï¼Œç„¶åæµè§ˆå™¨æ”¶åˆ°è¯¥å“åº”ä»¥åå¯¹å“åº”æ”¾è¡Œ setHeader(&quot;å…è®¸è·¨åŸŸå“åº”å¤´&quot;, &quot;*&quot;); è®¾ç½®å…è®¸è·¨åŸŸçš„å“åº”å¤´ï¼Œå®ƒä»¬çš„æ ¼å¼åˆ†åˆ«æ‰€ä»£è¡¨çš„å«ä¹‰æ˜¯ 1.origin å‚æ•°çš„å€¼æŒ‡å®šäº†å…è®¸è®¿é—®è¯¥èµ„æºçš„å¤–åŸŸ URIï¼Œå¯ä»¥æŒ‡å®šè¯¥å­—æ®µçš„å€¼ä¸ºé€šé…ç¬¦ï¼ˆ*ï¼‰ï¼Œè¡¨ç¤ºå…è®¸æ¥è‡ªæ‰€æœ‰åŸŸçš„è¯·æ±‚ã€‚ Access-Control-Allow-Origin: | * 2.æŒ‡æ˜äº†å®é™…è¯·æ±‚æ‰€å…è®¸ä½¿ç”¨çš„ HTTP æ–¹æ³•ã€‚ Access-Control-Allow-Methods: &lt;method&gt;[, &lt;method&gt;]*3.æŒ‡æ˜äº†å®é™…è¯·æ±‚ä¸­å…è®¸æºå¸¦çš„é¦–éƒ¨å­—æ®µã€‚ Access-Control-Allow-Headers: &lt;field-name&gt;[, &lt;field-name&gt;]*4.è¡¨ç¤ºæ˜¯å¦å…è®¸å‘é€Cookieã€‚é»˜è®¤æƒ…å†µä¸‹ï¼ŒCookieä¸åŒ…æ‹¬åœ¨CORSè¯·æ±‚ä¹‹ä¸­ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œä¸èƒ½å‘é€å’Œæ¥å—cookieã€‚è®¾ä¸ºtrueï¼Œå³è¡¨ç¤ºæœåŠ¡å™¨æ˜ç¡®è®¸å¯ï¼ŒCookieå¯ä»¥åŒ…å«åœ¨è¯·æ±‚ä¸­ï¼Œä¸€èµ·å‘ç»™æœåŠ¡å™¨ã€‚è¿™ä¸ªå€¼ä¹Ÿåªèƒ½è®¾ä¸ºtrueï¼Œå¦‚æœæœåŠ¡å™¨ä¸è¦æµè§ˆå™¨å‘é€Cookieï¼Œåˆ é™¤è¯¥å­—æ®µå³å¯ã€‚ Access-Control-Allow-Credentials: trueç­‰ç­‰â€¦â€¦. ç¬¬äºŒä¸ªå‚æ•°*æ˜¯é€šç”¨çš„æ„æ€ï¼Œä¹Ÿå¯ä»¥è®¾ç½®ä¸“ç”¨çš„url //æœåŠ¡å™¨éƒ¨åˆ† app.all('/CORS', (req, res) => { // è®¾ç½®å…è®¸è·¨åŸŸçš„å“åº”å¤´ res.setHeader(\"Access-Control-Allow-Origin\", \"*\"); res.setHeader(\"Access-Control-Allow-Headers\", \"*\"); //è¿™é‡Œè¡¨ç¤ºçš„æ˜¯åªæœ‰åœ°å€ä¸ºhttp://127.0.0.1:5500è¿™æ ·çš„ç½‘é¡µï¼Œæ‰èƒ½å‘æˆ‘ä»¬è¿™ä¸ªæœåŠ¡å‘é€è¯·æ±‚ // res.setHeader(\"Access-Control-Allow-Origin\", \"http://127.0.0.1:5500\"); res.send('hello world'); }) æˆ–è€…æ˜¯è¿™ä¸ªï¼ˆappendæ˜¯è¿½åŠ httpå“åº”å¤´ï¼‰ app.use((req, res, next) => { res.append(\"Access-Control-Allow-Origin\", \"*\") res.append(\"Access-Control-Allow-Content-Type\", \"*\") next(); }) å¦‚æœè®¾ç½®è¯·æ±‚å¤´ä¸è¡Œçš„è¯å¯ä»¥å®‰è£… CORS ï¼ˆ1ï¼‰å®‰è£…corsï¼š npm install cors express â€“save ï¼ˆ2ï¼‰ ç„¶ååœ¨æ–‡ä»¶ä¸­å¼•ç”¨ï¼š var cors = require('cors'); var express = require('express'); var server = express(); server.use(cors()); ä½†å®é™…ä¸Šï¼Œä¸Šçº¿çš„ç½‘ç«™ï¼Œå¾ˆå°‘ç”¨corsè§£å†³è·¨åŸŸï¼Œå› ä¸ºåŠ ä¸Šè¿™ä¸ªæ„å‘³ç€å¾ˆå¤šç½‘ç«™éƒ½å¯ä»¥è®¿é—®ä½  å¤æ‚è¯·æ±‚å’Œç®€å•è¯·æ±‚åœ¨æ¶‰åŠåˆ°CORSçš„è¯·æ±‚ä¸­ï¼Œæˆ‘ä»¬ä¼šæŠŠè¯·æ±‚åˆ†ä¸ºç®€å•è¯·æ±‚å’Œå¤æ‚è¯·æ±‚ã€‚ æµè§ˆå™¨é™åˆ¶è·¨åŸŸè¯·æ±‚ä¸€èˆ¬æœ‰ä¸¤ç§æ–¹å¼ï¼š æµè§ˆå™¨é™åˆ¶å‘èµ·è·¨åŸŸè¯·æ±‚ è·¨åŸŸè¯·æ±‚å¯ä»¥æ­£å¸¸å‘èµ·ï¼Œä½†æ˜¯è¿”å›çš„ç»“æœè¢«æµè§ˆå™¨æ‹¦æˆªäº† ä¸€èˆ¬æµè§ˆå™¨éƒ½æ˜¯ç¬¬äºŒç§æ–¹å¼é™åˆ¶è·¨åŸŸè¯·æ±‚ï¼Œé‚£å°±æ˜¯è¯´è¯·æ±‚å·²åˆ°è¾¾æœåŠ¡å™¨ï¼Œå¹¶æœ‰å¯èƒ½å¯¹æ•°æ®åº“é‡Œçš„æ•°æ®è¿›è¡Œäº†æ“ä½œï¼Œä½†æ˜¯è¿”å›çš„ç»“æœè¢«æµè§ˆå™¨æ‹¦æˆªäº†ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±è·å–ä¸åˆ°è¿”å›ç»“æœï¼Œè¿™æ˜¯ä¸€æ¬¡å¤±è´¥çš„è¯·æ±‚ï¼Œä½†æ˜¯å¯èƒ½å¯¹æ•°æ®åº“é‡Œçš„æ•°æ®äº§ç”Ÿäº†å½±å“ã€‚ä¸ºäº†é˜²æ­¢è¿™ç§æƒ…å†µçš„å‘ç”Ÿï¼Œè§„èŒƒè¦æ±‚ï¼Œå¯¹è¿™ç§å¯èƒ½å¯¹æœåŠ¡å™¨æ•°æ®äº§ç”Ÿä¸å¯é¢„æµ‹å½±å“çš„HTTPè¯·æ±‚æ–¹æ³•ï¼Œæµè§ˆå™¨å¿…é¡»å…ˆä½¿ç”¨OPTIONSæ–¹æ³•å‘èµ·ä¸€ä¸ªé¢„æ£€è¯·æ±‚ï¼Œä»è€Œè·çŸ¥æœåŠ¡å™¨æ˜¯å¦å…è®¸è¯¥è·¨åŸŸè¯·æ±‚ï¼šå¦‚æœå…è®¸ï¼Œå°±å‘é€å¸¦æ•°æ®çš„çœŸå®è¯·æ±‚ï¼›å¦‚æœä¸å…è®¸ï¼Œåˆ™é˜»æ­¢å‘é€å¸¦æ•°æ®çš„çœŸå®è¯·æ±‚ã€‚ ï¼ˆOPTIONSä¸ä¼šæºå¸¦è¯·æ±‚å‚æ•°å’Œcookie,ä¹Ÿä¸ä¼šå¯¹æœåŠ¡å™¨æ•°æ®äº§ç”Ÿå‰¯ä½œç”¨ï¼‰ å¤æ‚è¯·æ±‚ï¼šä¼šå‘é€å‘é¢„æ£€è¯·æ±‚ï¼ˆOPTIONSè¯·æ±‚ï¼‰ ç®€å•è¯·æ±‚ é‚£ä¹ˆæœ‰å“ªäº›ç®€å•è¯·æ±‚å‘¢ï¼Ÿä»¥ä¸‹æ˜¯æ¥è‡ªMDNå®˜æ–¹å¼•ç”¨ï¼š 1ã€ä½¿ç”¨ä¸‹åˆ—æ–¹æ³•ä¹‹ä¸€ï¼š GETã€ POSTã€ HEADã€‚ 2ã€ä¸å¾—äººä¸ºè®¾ç½®è¯¥é›†åˆä¹‹å¤–çš„å…¶ä»–é¦–éƒ¨å­—æ®µã€‚è¯¥é›†åˆä¸ºï¼š Accept Accept-Language Content-Language Content-Type 3ã€Content-Type çš„å€¼ä»…é™äºä¸‹åˆ—ä¸‰è€…ä¹‹ä¸€ï¼š text/plain multipart/form-data application/x-www-form-urlencoded4ã€è¯·æ±‚ä¸­çš„ä»»æ„XMLHttpRequestUpload å¯¹è±¡å‡æ²¡æœ‰æ³¨å†Œä»»ä½•äº‹ä»¶ç›‘å¬å™¨ï¼›XMLHttpRequestUpload å¯¹è±¡å¯ä»¥ä½¿ç”¨ XMLHttpRequest.upload å±æ€§è®¿é—® 5ã€è¯·æ±‚ä¸­æ²¡æœ‰ä½¿ç”¨ ReadableStream å¯¹è±¡ é‚£ä»€ä¹ˆæ˜¯å¤æ‚è¯·æ±‚å‘¢ï¼Œé™¤äº†ç®€å•è¯·æ±‚éƒ½æ˜¯å¤æ‚è¯·æ±‚ã€‚ postMessageè¿™æ˜¯ç”±H5æå‡ºæ¥çš„çš„APIï¼ŒIE8ä»¥ä¸Šæ”¯æŒè¿™ä¸ªåŠŸèƒ½ã€‚window.postMessage() æ–¹æ³•å¯ä»¥å®‰å…¨åœ°å®ç°è·¨æºé€šä¿¡ã€‚é€šå¸¸ï¼Œå¯¹äºä¸¤ä¸ªä¸åŒé¡µé¢çš„è„šæœ¬ï¼Œéƒ½éµå¾ªåŒæºç­–ç•¥æ‰èƒ½å¤Ÿå®ç°é€šä¿¡ã€‚ window.postMessage() æ–¹æ³•æä¾›äº†ä¸€ç§å—æ§æœºåˆ¶æ¥è§„é¿æ­¤é™åˆ¶ï¼Œåªè¦æ­£ç¡®çš„ä½¿ç”¨ï¼Œè¿™ç§æ–¹æ³•å°±å¾ˆå®‰å…¨ï¼ŒåŸç†æ˜¯å°†é€šè¿‡æ¶ˆæ¯äº‹ä»¶å¯¹è±¡æš´éœ²ç»™æ¥æ”¶æ¶ˆæ¯çš„çª—å£ã€‚ nginxä»£ç†è·¨åŸŸè·¨åŸŸåŸç†ï¼š åŒæºç­–ç•¥æ˜¯æµè§ˆå™¨çš„å®‰å…¨ç­–ç•¥ï¼Œä¸æ˜¯HTTPåè®®çš„ä¸€éƒ¨åˆ†ã€‚æœåŠ¡å™¨ç«¯è°ƒç”¨HTTPæ¥å£åªæ˜¯ä½¿ç”¨HTTPåè®®ï¼Œä¸ä¼šæ‰§è¡ŒJSè„šæœ¬ï¼ˆæ²¡æœ‰ä½¿ç”¨ajaxï¼Œajaxéµå®ˆåŒæºç­–ç•¥ï¼‰ï¼Œä¸éœ€è¦åŒæºç­–ç•¥ï¼Œä¹Ÿå°±ä¸å­˜åœ¨è·¨è¶Šé—®é¢˜ã€‚ å®ç°æ€è·¯ï¼š é€šè¿‡nginxé…ç½®ä¸€ä¸ªä»£ç†æœåŠ¡å™¨ï¼ˆåŸŸåä¸domain1ç›¸åŒï¼Œç«¯å£ä¸åŒï¼‰åšè·³æ¿æœºï¼Œåå‘ä»£ç†è®¿é—®domain2æ¥å£ï¼Œå¹¶ä¸”å¯ä»¥é¡ºä¾¿ä¿®æ”¹cookieä¸­domainä¿¡æ¯ï¼Œæ–¹ä¾¿å½“å‰åŸŸcookieå†™å…¥ï¼Œå®ç°è·¨åŸŸç™»å½•ã€‚ webpacké…ç½®ä»£ç†Reactè„šæ‰‹æ¶é¡¹ç›® jsonæ–‡ä»¶å®ç°ä»£ç† ä»£ç†æœªä½¿ç”¨ajaxï¼Œæ‰€ä»¥ä¸éœ€è¦éµå®ˆåŒæºç­–ç•¥ï¼Œä½†ä»£ç†çš„åŸŸåã€ç«¯å£å·ã€åè®®å‡å’Œå®¢æˆ·ç«¯åŒæºï¼Œæ‰€ä»¥å¯ä»¥è¿›è¡Œä¿¡æ¯äº¤äº’ æ¯”å¦‚åœ¨Reactä¸­çš„package.jsonè¿›è¡Œé…ç½® { \"proxy\":\"http://localhost:5000\" } ç„¶åaxioså‘æœ¬åœ°çš„ä»£ç†æœåŠ¡å™¨å‘é€è¯·æ±‚ï¼ˆæ­¤æ—¶æœ¬åœ°æ­å»ºé¡¹ç›®åœ°å€ä¸ºlocalhost:3000ï¼‰ axios.get('http:localhost:3000/students').then(res => console.log(res)) //æ­¤æ—¶å…ˆå»æœ¬åœ°3000æ‰¾è¯¥èµ„æºï¼Œæ‰¾ä¸åˆ°å°±å»åˆ°5000æ‰¾ ä¼˜ç‚¹ï¼šé…ç½®ç®€å• ç¼ºç‚¹ï¼šä½†æ˜¯æ³¨æ„è¿™ä¸ªæ–¹æ³•åªèƒ½ä»£ç†ä¸€ä¸ªç½‘å€ï¼Œè¿™æ˜¯ä¸ªå–å·§çš„æ–¹å¼ï¼Œå½“æˆ‘åŒæ—¶éœ€è¦å¯¹ â€œhttp//localhost:5000â€ã€â€http//localhost:5001â€å‘é€è¯·æ±‚ï¼Œå°±ä¸å¯ä»¥ä½¿ç”¨äº†ï¼Œæ­¤æ—¶Reactå¯ä»¥æ–°å»ºä¸€ä¸ªsetupProxy.js è¿›è¡Œæ­£å‘ä»£ç†ï¼ˆè¯·è·³è½¬è‡³ã€ŠReact(ä¸Šã€‹ç¯‡ç« ï¼‰ vue3è„šæ‰‹æ¶é¡¹ç›® åœ¨vue.config.jsæ–‡ä»¶ä¸­å®ç°ä»£ç†ï¼ˆå¯¹æˆ‘ä»¬æœ¬åœ°npm run serve çš„æœåŠ¡å™¨è¿›è¡Œé…ç½®ï¼‰ module.exports = { outputDir: './build', devServer: { proxy: { '^/api': { target: 'ç›®æ ‡åœ°å€', pathRewrite: { '^/api': '' }, changeOrigin: true } } } }","categories":[{"name":"å‰ç«¯","slug":"å‰ç«¯","permalink":"https://taylor12138.github.io/categories/%E5%89%8D%E7%AB%AF/"}],"tags":[],"author":"Hello"},{"title":"JavaScriptè¿›é˜¶ES6(ä¸‹)","slug":"JavaScriptè¿›é˜¶ES6(ä¸‹)","date":"2022-04-02T05:33:33.953Z","updated":"2022-04-02T05:33:33.953Z","comments":true,"path":"2022/04/02/javascript-jin-jie-es6-xia/","link":"","permalink":"https://taylor12138.github.io/2022/04/02/javascript-jin-jie-es6-xia/","excerpt":"","text":"5.SymbolSymbolè¡¨ç¤ºç‹¬ä¸€æ— äºŒçš„å€¼ï¼Œæ˜¯ES6å¼•å…¥çš„ç¬¬ä¸ƒç§æ•°æ®ç±»å‹ï¼Œæ˜¯ä¸€ç§ç±»ä¼¼äºå­—ç¬¦ä¸²çš„æ•°æ®ç±»å‹ï¼ˆæ°¸è¿œä¸ä¼šé‡å¤çš„å­—ç¬¦ä¸²ï¼‰ ç‰¹ç‚¹ï¼š Symbolçš„å€¼æ˜¯å”¯ä¸€çš„ã€‚è§£å†³å‘½åå†²çªçš„é—®é¢˜ï¼ˆå†…éƒ¨å®ç°å”¯ä¸€æ€§ï¼Œä¸å¯è§ï¼Œä¹Ÿå°±æ˜¯æ‰“å°ä¸å‡ºæ¥ï¼‰ Symbolä¸èƒ½ä¸å…¶ä»–æ•°æ®è¿›è¡Œè¿ç®—ï¼ˆéšå¼ç±»å‹è½¬æ¢ä¼šæŠ¥é”™ï¼Œä½†æ˜¯ï¼ŒSymbol å€¼å¯ä»¥æ˜¾å¼è½¬ä¸ºå­—ç¬¦ä¸²ã€è½¬ä¸ºå¸ƒå°”å€¼ï¼‰ Symbolå®šä¹‰çš„å¯¹è±¡å±æ€§ä¸èƒ½ä½¿ç”¨for in ã€for...of è¿›è¡Œå¾ªç¯ï¼Œä½†æ˜¯å¯ä»¥ä½¿ç”¨ Reflect.ownKeysæ¥è·å–å¯¹è±¡çš„æ‰€æœ‰é”®å åŸºæœ¬åˆ›å»º let s1 = Symbol(); // let s2 = Symbol('æè¿°å­—ç¬¦ä¸²');ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æè¿°å­—ç¬¦ä¸²æ›´å¥½çš„ç†è§£è¿™ä¸ªå€¼çš„ä½œç”¨ let s2 = Symbol('allen'); let s3 = Symbol('allen'); // è¿”å›falseï¼Œå› ä¸ºæè¿°å­—ç¬¦ä¸²ç±»ä¼¼äºèº«ä»½è¯ä¸Šçš„åå­—ï¼Œæˆ‘ä»¬å¯èƒ½åŒååŒå§“ä½†æ˜¯ä¸å¯èƒ½åŒä¸€èº«ä»½è¯ console.log(s2 === s3); //false Symbol.forè¿›è¡Œåˆ›å»ºï¼Œæ˜¯ä½œä¸ºä¸€ä¸ªå‡½æ•°å¯¹è±¡ï¼Œé€šè¿‡è¿™ç§æ–¹å¼åˆ›å»ºï¼Œæˆ‘ä»¬æ˜¯å¯ä»¥é€šè¿‡æè¿°å­—ç¬¦ä¸²å¾—åˆ°å¾—å‡ºå”¯ä¸€çš„symbolå€¼è¯¥æ–¹æ³•ä¼šæ ¹æ®ç»™å®šçš„é”® keyï¼Œæ¥ä»è¿è¡Œæ—¶çš„å…¨å±€ symbol æ³¨å†Œè¡¨ä¸­æ‰¾åˆ°å¯¹åº”çš„ symbolï¼Œå¦‚æœæ‰¾åˆ°äº†ï¼Œåˆ™è¿”å›å®ƒï¼Œå¦åˆ™ï¼Œæ–°å»ºä¸€ä¸ªä¸è¯¥é”®å…³è”çš„ symbolï¼Œå¹¶æ”¾å…¥å…¨å±€ symbol æ³¨å†Œè¡¨ä¸­ã€‚ï¼ˆç”¨äºéœ€è¦å…±äº«å’Œé‡ç”¨ç¬¦å·çš„å®ä¾‹ï¼‰ let s4 = Symbol.for('bruce'); let s5 = Symbol.for('bruce'); //é‡ç”¨å·²æœ‰ç¬¦å· console.log(s5 === s4); //true Symbol.keyFor(s4); //\"bruce\" åº”ç”¨èƒ½ä¿è¯ä¸ä¼šå‡ºç°åŒåçš„å±æ€§ã€‚è¿™å¯¹äºä¸€ä¸ªå¯¹è±¡ç”±å¤šä¸ªæ¨¡å—æ„æˆçš„æƒ…å†µéå¸¸æœ‰ç”¨ï¼Œèƒ½é˜²æ­¢æŸä¸€ä¸ªé”®è¢«ä¸å°å¿ƒæ”¹å†™æˆ–è¦†ç›–ã€‚ æ³¨æ„ï¼š Symbolå€¼ä½œä¸ºå¯¹è±¡å±æ€§åæ—¶ï¼Œä¸èƒ½ç”¨ç‚¹è¿ç®—ç¬¦ã€‚ åœ¨å¯¹è±¡ä¸­ä½¿ç”¨å˜é‡å®šä¹‰å±æ€§æ—¶ï¼Œå¿…é¡»æ”¾åœ¨æ–¹æ‹¬å·å†…ï¼Œä¸æ™®é€šé”®å€¼(String)è¿›è¡ŒåŒºåˆ†ã€‚ let mySymbol = Symbol(); // ç¬¬ä¸€ç§å†™æ³• let a = {}; a[mySymbol] = 'Hello!'; // ç¬¬äºŒç§å†™æ³• let a = { [mySymbol]: 'Hello!' }; a[mySymbol] // \"Hello!\" let s = Symbol(); let obj = { [s]: function (arg) { ... } }; obj[s](123); åˆ©ç”¨Symbolçš„ç‰¹æ€§å¯å®šä¹‰å†…éƒ¨ç§æœ‰å±æ€§æˆ–æ–¹æ³• function getObj(obj) { let privateKey = Symbol('privateKey'); objCopy = { ...obj } || {}; objCopy[privateKey] = function privateFunc() { console.log('privateFunc ') } return objCopy; } let newObj = getObj(); console.log(newObj[privateKey]); // æŠ¥é”™ï¼Œå¤–éƒ¨æ— æ³•è·å–åˆ°privateKeyçš„å€¼ console.log(newObj[Symbol('privateKey')]); //undefined,æ­¤æ—¶çš„symbolå·²ç»å˜æˆæ–°çš„symbolå€¼ Symbolçš„å†…ç½®å±æ€§ Symbol.hasInstanceï¼šå¯¹è±¡çš„Symbol.hasInstanceå±æ€§ï¼ŒæŒ‡å‘ä¸€ä¸ªå†…éƒ¨æ–¹æ³•ã€‚å½“å…¶ä»–å¯¹è±¡ä½¿ç”¨instanceofè¿ç®—ç¬¦ï¼Œåˆ¤æ–­æ˜¯å¦ä¸ºè¯¥å¯¹è±¡çš„å®ä¾‹æ—¶ï¼Œä¼šè°ƒç”¨è¿™ä¸ªæ–¹æ³•ã€‚æ¯”å¦‚ï¼Œfoo instanceof Fooåœ¨è¯­è¨€å†…éƒ¨ï¼Œå®é™…è°ƒç”¨çš„æ˜¯Foo[Symbol.hasInstance](foo)ã€‚ class MyClass { [Symbol.hasInstance](foo) { return foo instanceof Array; //å¦‚æœç›´æ¥ return falseï¼Œåˆ™è°ƒç”¨instanceofçš„æ—¶å€™æ— è®ºå‰é¢æ¥ä»€ä¹ˆå®ä¾‹ï¼Œéƒ½ä¼šè¿”å›false } } [1, 2, 3] instanceof new MyClass() // true Symbol.isConcatSpreadableï¼šå¯¹è±¡çš„Symbol.isConcatSpreadableå±æ€§ç­‰äºä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºè¯¥å¯¹è±¡ç”¨äºArray.prototype.concat()æ—¶ï¼Œæ˜¯å¦å¯ä»¥å±•å¼€ã€‚ let arr1 = ['c', 'd']; ['a', 'b'].concat(arr1, 'e') // ['a', 'b', 'c', 'd', 'e'] arr1[Symbol.isConcatSpreadable] // undefined let arr2 = ['c', 'd']; arr2[Symbol.isConcatSpreadable] = false; ['a', 'b'].concat(arr2, 'e') // ['a', 'b', ['c','d'], 'e'] è¿˜æœ‰å¾ˆå¤šï¼Œå¯ä»¥å»é˜®ä¸€å³°çš„ES6å…¥é—¨æŸ¥çœ‹ åœ¨å­¦ä¹ è¿‡ç¨‹è¸©çš„å‘var name = Symbol(); //Uncaught TypeError: Cannot convert a Symbol value to a string åœ¨ç½‘ä¸Šæ‰¾çš„çš„è§£é‡Šï¼š var å®šä¹‰çš„å˜é‡ä¼šæŠŠå®ƒæå‡åˆ°å½“å‰å‡½æ•°ä½œç”¨åŸŸé¡¶éƒ¨ï¼Œå¦‚æœæ˜¯æµè§ˆå™¨å…¨å±€ä½œç”¨åŸŸå°±ä¼šæˆä¸ºwindowçš„ä¸€ä¸ªå±æ€§ã€‚ By the wayï¼Œletä¼šæŠŠå˜é‡æå‡åˆ°å½“å‰å—çº§ä½œç”¨åŸŸé¡¶ç«¯ï¼Œå¦‚æœåœ¨æµè§ˆå™¨å…¨å±€ä½œç”¨åŸŸä¸‹ï¼Œä¸ä¼šè®©å˜é‡æˆä¸ºwindowçš„å±æ€§ã€‚ name æ˜¯windowå¯¹è±¡çš„ä¸€ä¸ªå›ºæœ‰å±æ€§ï¼Œå¯¹å®ƒçš„èµ‹å€¼ï¼Œä¼šè¢«å¼ºåˆ¶è½¬ä¸ºstringã€‚ å¯ä»¥æ‰“å¼€æ§åˆ¶å°æ‰“å°ä¸€ä¸‹windowï¼Œç¬¬äºŒä¸ªå±æ€§å°±æ˜¯nameã€‚ ç»™nameèµ‹å€¼ä¸€ä¸ªå¯¹è±¡ï¼Œä¼šè‡ªåŠ¨è½¬æ¢ä¸ºstringç±»å‹ symbol Symbolçš„éšå¼ç±»å‹è½¬æ¢ä¼šæŠ¥é”™ ä½¿ç”¨ var å£°æ˜å˜é‡ =&gt; ç»™ window çš„å˜é‡èµ‹å€¼ =&gt; window.nameçš„èµ‹å€¼å¿…é¡»è½¬æ¢ä¸ºå­—ç¬¦ä¸² =&gt; å¯¹å€¼Symbol()è½¬æ¢ä¸ºå­—ç¬¦ä¸²çš„è¿‡ç¨‹ä¸­ï¼Œè§¦çŠ¯äº†çš„ â€œSymbol()éšå¼ç±»å‹è½¬æ¢â€ 6.XXå™¨è¿­ä»£å™¨è¿­ä»£å™¨æ˜¯ä¸€ç§æ¥å£ï¼Œä¸ºå„ç§ä¸åŒæ•°æ®ç»“æ„æä¾›ç»Ÿä¸€çš„è®¿é—®æœºåˆ¶ï¼Œä»»ä½•æ•°æ®ç»“æ„åªè¦éƒ¨ç½²Iteratoræ¥å£ï¼Œå°±å¯ä»¥å®Œæˆéå†æ“ä½œ å®é™…ä¸Š Iteratoræ¥å£ï¼Œå°±æ˜¯å¯¹è±¡é‡Œé¢çš„ä¸€ä¸ªå±æ€§ï¼Œè€Œå±æ€§çš„åå­—å°±å«åš Symbol.Iterator ES6åˆ›é€ äº†ä¸€ç§ for ofå¾ªç¯ï¼ŒIteratorä¸»è¦ä¾› for ofæ¶ˆè´¹ï¼Œä¹Ÿå°±æ˜¯å¯ä»¥ä½¿ç”¨for ofï¼Œå°±æœ‰ Symbol.Iteratorå±æ€§ å®šä¹‰ Symbol.Iteratoråˆ™å®šä¹‰å®ƒçš„è¿­ä»£æ–¹å¼ é”™è¯¯ï¼šè¿­ä»£å¤±è´¥ï¼ï¼ï¼ const banji = { name: \"4399\", status: [ 'Allen', 'Bruce', 'Cat' ] } for (item of banji) { console.log(item); } nextæ–¹æ³•è¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œè¡¨ç¤ºå½“å‰æ•°æ®æˆå‘˜çš„ä¿¡æ¯ã€‚è¿™ä¸ªå¯¹è±¡å…·æœ‰valueå’Œdoneä¸¤ä¸ªå±æ€§ï¼Œvalueå±æ€§è¿”å›å½“å‰ä½ç½®çš„æˆå‘˜ï¼Œdoneå±æ€§æ˜¯ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºéå†æ˜¯å¦ç»“æŸï¼Œå³æ˜¯å¦è¿˜æœ‰å¿…è¦å†ä¸€æ¬¡è°ƒç”¨nextæ–¹æ³•ã€‚ æ­£ç¡®âˆšï¼Œé‡æ–°å®šä¹‰äº†è¿­ä»£å™¨ï¼Œç”¨æ¥è¿­ä»£status const banji = { name: \"4399\", status: [ 'Allen', 'Bruce', 'Cat' ], [Symbol.iterator]() { let index = 0; return { next: () => { // è¿™é‡Œçš„thisæŒ‡å‘æˆ‘ä»¬çš„banji // valueä¸ºè¿­ä»£çš„å€¼ï¼Œdoneè¡¨ç¤ºæ˜¯å¦åœæ­¢è¿­ä»£çš„çŠ¶æ€ if (index &lt; this.status.length) { const result = { value: this.status[index], done: false }; // ä¸‹æ ‡è‡ªå¢ï¼Œç»§ç»­è¿­ä»£ index++; return result; } else { return { value: undefined, done: true } } } } } } //è¿™é‡Œçš„itemç›´æ¥è¾“å‡ºvalue for (const item of banji) { console.log(item); } è¿­ä»£å™¨ä¸­æœ‰ä¸ª returnå‡½æ•°ï¼Œè¯¥æ–¹æ³•ç”¨äºæŒ‡å®šåœ¨è¿­ä»£å™¨æå‰å…³é—­æ‰§è¡Œçš„é€»è¾‘ï¼Œå¿…é¡»è¿”å›ä¸€ä¸ªIteratorResultå¯¹è±¡ï¼ˆé€šè¿‡breakã€continueã€returnã€throwï¼‰ class Counter{ constructor(limit){ this.limit = limit; } [Symbol.iterator](){ let count = 1; limit = this.limit; return { next(){ if(count &lt;= limit){ return {done: false, value: count++}; }else { return {done: true}; } } return(){ console.log('Exiting early'); return {done: true} } } } } ä¸è¿‡ï¼Œä»…ä»…ç»™ä¸€ä¸ªä¸å¯å…³é—­çš„è¿­ä»£å™¨å¢åŠ è¿™ä¸ªæ–¹æ³•å¹¶ä¸èƒ½è®©å®ƒä»¬å¯å…³é—­çš„ ç”Ÿæˆå™¨åè¯è§£é‡Šï¼š Generator å‡½æ•°æ˜¯ ES6 æä¾›çš„ä¸€ç§å¼‚æ­¥ç¼–ç¨‹è§£å†³æ–¹æ¡ˆ å½¢å¼ä¸Šï¼ŒGenerator å‡½æ•°æ˜¯ä¸€ä¸ªæ™®é€šå‡½æ•°ï¼Œä½†æ˜¯æœ‰ä¸¤ä¸ªç‰¹å¾ã€‚ä¸€æ˜¯ï¼Œfunctionå…³é”®å­—ä¸å‡½æ•°åä¹‹é—´æœ‰ä¸€ä¸ªæ˜Ÿå·ï¼›äºŒæ˜¯ï¼Œå‡½æ•°ä½“å†…éƒ¨ä½¿ç”¨yieldè¡¨è¾¾å¼ï¼Œå®šä¹‰ä¸åŒçš„å†…éƒ¨çŠ¶æ€ï¼ˆyieldåœ¨è‹±è¯­é‡Œçš„æ„æ€å°±æ˜¯â€œäº§å‡ºâ€ï¼‰ã€‚ ä½¿ç”¨æ–¹æ³•ï¼š Generator å‡½æ•°çš„è°ƒç”¨æ–¹æ³•ä¸æ™®é€šå‡½æ•°ä¸€æ ·ï¼Œä¹Ÿæ˜¯åœ¨å‡½æ•°ååé¢åŠ ä¸Šä¸€å¯¹åœ†æ‹¬å·ã€‚ä¸åŒçš„æ˜¯ï¼Œè°ƒç”¨ Generator å‡½æ•°åï¼Œè¯¥å‡½æ•°å¹¶ä¸æ‰§è¡Œï¼Œè¿”å›çš„ä¹Ÿä¸æ˜¯å‡½æ•°è¿è¡Œç»“æœï¼Œè€Œæ˜¯ä¸€ä¸ªæŒ‡å‘å†…éƒ¨çŠ¶æ€çš„æŒ‡é’ˆå¯¹è±¡ ä¸‹ä¸€æ­¥ï¼Œå¿…é¡»è°ƒç”¨éå†å™¨å¯¹è±¡çš„nextæ–¹æ³•ï¼Œä½¿å¾—æŒ‡é’ˆç§»å‘ä¸‹ä¸€ä¸ªçŠ¶æ€ï¼ˆä½¿ç”¨yieldåˆ†å‰²ï¼‰ã€‚æ¢è¨€ä¹‹ï¼ŒGenerator å‡½æ•°æ˜¯åˆ†æ®µæ‰§è¡Œçš„ï¼Œyieldè¡¨è¾¾å¼æ˜¯æš‚åœæ‰§è¡Œçš„æ ‡è®°ï¼Œè€Œnextæ–¹æ³•å¯ä»¥æ¢å¤æ‰§è¡Œã€‚ yieldæœ‰ç‚¹åƒå‡½æ•°çš„ä¸­é—´è¿”å›è¯­å¥ï¼Œå®ƒç”Ÿæˆçš„å€¼ä¼šå‡ºç°åœ¨ next()æ–¹æ³•è¿”å›çš„å¯¹è±¡é‡Œï¼Œé€šè¿‡ yieldå…³é”®å­—é€€å‡ºçš„ç”Ÿæˆå™¨å‡½æ•°ä¼šå¤„äº {done: false}çŠ¶æ€ï¼Œç›´æ¥é€šè¿‡ return å…³é”®å­—é€€å‡ºçš„ç”Ÿæˆå™¨å‡½æ•°ä¼šå¤„äº done: trueçŠ¶æ€ yieldè¯­å¥å¿…é¡»åœ¨ç”Ÿæˆå™¨å‡½æ•°å†…éƒ¨ä½¿ç”¨ ç”Ÿæˆå™¨å’Œè¿­ä»£å™¨çš„å…³ç³»ï¼šgeneratorå®ç°äº† iteratoræ¥å£ï¼Œæ¯ä¸€æ¬¡ç”Ÿæˆå™¨è°ƒç”¨nextæ–¹æ³•ï¼Œ ç”Ÿæˆå™¨æ¯ä¸€æ¬¡è°ƒç”¨ nextæ–¹æ³•ä¹‹åï¼Œ è¿”å›éƒ½å¾—æ˜¯ä¸€ä¸ªå¯¹è±¡ {value: xx, done: false / true} // yieldç”¨äºå‡½æ•°ä»£ç çš„åˆ†å‰²ï¼Œ3ä¸ªåˆ†éš”ç¬¦äº§ç”Ÿ4å—ä»£ç  function* gen() { console.log(\"123\"); yield 'aaaaa'; console.log(\"456\"); yield 'bbbbb'; console.log(\"789\"); yield 'cccc'; } let gen1 = gen(); console.log(gen1); //ç”Ÿæˆå™¨å¯¹è±¡gen // ç”Ÿæˆå™¨å‡½æ•°çš„æ‰§è¡Œå¿…é¡»è°ƒç”¨è¿­ä»£å™¨çš„next()ï¼Œvalueçš„å€¼ = yieldåçš„å€¼ //è¿™é‡Œçš„itemæ˜¯æ‰§è¡Œç›¸å¯¹ä»£ç å—åï¼Œç„¶åè¾“å‡ºvalue for (item of gen1) { console.log(item, \"è¿™æ˜¯ä¸€ä¸ªç‰‡æ®µ\"); } //123 //aaaaa è¿™æ˜¯ä¸€ä¸ªç‰‡æ®µ //456 //bbbbb è¿™æ˜¯ä¸€ä¸ªç‰‡æ®µ //789 //cccc è¿™æ˜¯ä¸€ä¸ªç‰‡æ®µ //æˆ–è€…ä½¿ç”¨ï¼š // gen1.next(); ///123 // gen1.next(); ///456 åœ¨ç”Ÿæˆå™¨çš„nextä¼ å…¥å®å‚ï¼Œä¼ å…¥çš„å‚æ•°ä½œä¸ºä¸Šä¸€ä¸ªyieldè¯­å¥çš„æ•´ä½“è¿”å›ç»“æœ function* gen(arg) { console.log(arg); let one = yield 111; console.log(one); let two = yield 222; console.log(two); let three = yield 333; console.log(three); } let iterator = gen('AAA'); //è¿™é‡Œè¾“å‡ºçš„æ˜¯yieldçš„è¿”å›å€¼ï¼Œè€Œä¸æ˜¯è¾“å‡ºvalueï¼Œæ‰€ä»¥ä½ çœ‹ä¸åˆ°111ï¼Œ222ï¼Œ333çš„è¾“å‡º iterator.next(); //AAAï¼› ç¬¬ä¸€ä¸ªnextè™½ç„¶æ²¡æœ‰ä¼ å€¼ï¼Œä½†æ˜¯ç¬¬ä¸€æ¬¡è°ƒç”¨next()ï¼Œä½ å³ä½¿ä¼ å…¥çš„å€¼ä¸ä¼šè¢«ä½¿ç”¨ï¼ˆæ¥è‡ªçº¢å®ä¹¦ p196ï¼‰ï¼Œå› ä¸ºè¿™ä¸€æ¬¡è°ƒç”¨æ˜¯ä¸ºäº†å¼€å§‹æ‰§è¡Œç”Ÿæˆå™¨å‡½æ•° iterator.next(); //undefined iterator.next('BBB'); //BBB iterator.next('CCC'); //CCC ç”Ÿæˆå™¨åº”ç”¨å¼‚æ­¥ç¼–ç¨‹ ä¸‹é¢ä½¿ç”¨ setTimeout æ¨¡æ‹Ÿå¼‚æ­¥ä»»åŠ¡çš„æ‰§è¡Œ function getUser() { setTimeout(() => { let data = \"ç”¨æˆ·ä¿¡æ¯\" iterator.next(data); }, 1000) } function getGood() { setTimeout(() => { let data = \"å•†å“ä¿¡æ¯\" }, 1000) } function* gen() { let data = yield getUser(); console.log(data); yield getGood(); } let iterator = gen(); iterator.next(); ä¸è¿‡æ­¤æ—¶åœ¨å†…éƒ¨å±…ç„¶è¦ä¾èµ–å¤–éƒ¨çš„å˜é‡ iteratorï¼Œæœ‰ç‚¹è€¦åˆåº¦å¤ªå¤§äº†ï¼Œä¸å¤ªå¥½ async await çš„å®ç°åŸç†æ­¤æ—¶æ›¿æ¢æˆä»¥ä¸‹å½¢å¼ï¼ˆasync await çš„å®ç°åŸç†ï¼‰ function getUser() { return new Promise((res, rej) => { setTimeout(() => { let data = \"ç”¨æˆ·ä¿¡æ¯\" res(data) }, 1000) }) } function getGood(args) { return new Promise((res, rej) => { setTimeout(() => { let data = \"å•†å“ä¿¡æ¯ \" + args res(data) }, 1000) }) } function* gen() { const data = yield getUser(); console.log(data); const data2 = yield getGood(data); console.log(data2); } function run(fn) { const gen = fn() function next(data) { const res = gen.next(data) if (res.done) return res.value res.value.then(res => { next(res) }) } next() } run(gen) ä½¿ç”¨è¿­ä»£å™¨æ„é€ å°å‹è®¡æ—¶å™¨ï¼ˆæ¡ˆä¾‹ï¼‰ function* gen() { for (let i = 0; i &lt; 5; i++) { setTimeout(() => { console.log(i); a.next(); }, 1000); yield; } } let a = gen(); a.next(); ç”Ÿæˆå™¨å®ç°æœºåˆ¶åç¨‹é˜®ä¸€å³°è€å¸ˆä¹Ÿè¯´è¿‡ï¼šGenerator å‡½æ•°æ˜¯åç¨‹åœ¨ ES6 çš„å®ç°ï¼Œæœ€å¤§ç‰¹ç‚¹å°±æ˜¯å¯ä»¥äº¤å‡ºå‡½æ•°çš„æ‰§è¡Œæƒï¼ˆå³æš‚åœæ‰§è¡Œï¼‰ã€‚ è®©ç”Ÿæˆå™¨çš„é˜»å¡æœºåˆ¶ï¼šåç¨‹ï¼Œæˆ‘ä»¬éœ€è¦ä¸€æ¢ç©¶ç«Ÿ åç¨‹ï¼šåç¨‹æ˜¯ä¸€ç§æ¯”çº¿ç¨‹æ›´åŠ è½»é‡çº§çš„å­˜åœ¨ï¼Œåç¨‹å¤„åœ¨çº¿ç¨‹çš„ç¯å¢ƒä¸­ï¼Œä¸€ä¸ªçº¿ç¨‹å¯ä»¥å­˜åœ¨å¤šä¸ªåç¨‹ï¼Œå¯ä»¥å°†åç¨‹ç†è§£ä¸ºçº¿ç¨‹ä¸­çš„ä¸€ä¸ªä¸ªä»»åŠ¡ã€‚ä¸åƒè¿›ç¨‹å’Œçº¿ç¨‹ï¼Œåç¨‹å¹¶ä¸å—æ“ä½œç³»ç»Ÿçš„ç®¡ç†ï¼Œè€Œæ˜¯è¢«å…·ä½“çš„åº”ç”¨ç¨‹åºä»£ç æ‰€æ§åˆ¶ã€‚ åç¨‹çš„åˆ‡æ¢åœ¨ç”¨æˆ·æ€å®Œæˆï¼Œåˆ‡æ¢çš„ä»£ä»·æ¯”çº¿ç¨‹ä»ç”¨æˆ·æ€åˆ°å†…æ ¸æ€çš„ä»£ä»·å°å¾ˆå¤šã€‚ æ“ä½œç³»ç»Ÿå¹¶ä¸çŸ¥é“åç¨‹çš„å­˜åœ¨ï¼Œå®ƒåªçŸ¥é“çº¿ç¨‹ï¼Œå› æ­¤åœ¨åç¨‹è°ƒç”¨é˜»å¡IOæ“ä½œçš„æ—¶å€™ï¼Œæ“ä½œç³»ç»Ÿä¼šè®©çº¿ç¨‹è¿›å…¥é˜»å¡çŠ¶æ€ï¼Œå½“å‰çš„åç¨‹å’Œå…¶å®ƒç»‘å®šåœ¨è¯¥çº¿ç¨‹ä¹‹ä¸Šçš„åç¨‹éƒ½ä¼šé™·å…¥é˜»å¡è€Œå¾—ä¸åˆ°è°ƒåº¦ï¼Œè¿™å¾€å¾€æ˜¯ä¸èƒ½æ¥å—çš„ã€‚ å› æ­¤åœ¨åç¨‹ä¸­ä¸èƒ½è°ƒç”¨å¯¼è‡´çº¿ç¨‹é˜»å¡çš„æ“ä½œã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œåç¨‹åªæœ‰å’Œå¼‚æ­¥IOç»“åˆèµ·æ¥ï¼Œæ‰èƒ½å‘æŒ¥æœ€å¤§çš„å¨åŠ›ã€‚ ä¸€ä¸ªçº¿ç¨‹ä¸€æ¬¡åªèƒ½æ‰§è¡Œä¸€ä¸ªåç¨‹ã€‚æ¯”å¦‚å½“å‰æ‰§è¡Œ A åç¨‹ï¼Œå¦å¤–è¿˜æœ‰ä¸€ä¸ª B åç¨‹ï¼Œå¦‚æœæƒ³è¦æ‰§è¡Œ B çš„ä»»åŠ¡ï¼Œå°±å¿…é¡»åœ¨ A åç¨‹ä¸­å°†JS çº¿ç¨‹çš„æ§åˆ¶æƒè½¬äº¤ç»™ Båç¨‹ï¼Œé‚£ä¹ˆç°åœ¨ B æ‰§è¡Œï¼ŒA å°±ç›¸å½“äºå¤„äºæš‚åœçš„çŠ¶æ€ ä¸¾ä¸€ä¸ªä¾‹å­ï¼ˆæ¥æºäºhttps://juejin.cn/post/6844904004007247880#heading-24çš„ç”Ÿæˆå™¨ä¾‹å­ï¼‰ function* A() { console.log(\"æˆ‘æ˜¯A\"); yield B(); // Aåœä½ï¼Œåœ¨è¿™é‡Œè½¬äº¤çº¿ç¨‹æ‰§è¡Œæƒç»™B console.log(\"ç»“æŸäº†\"); } function B() { console.log(\"æˆ‘æ˜¯B\"); return 100;// è¿”å›ï¼Œå¹¶ä¸”å°†çº¿ç¨‹æ‰§è¡Œæƒè¿˜ç»™A } let gen = A(); gen.next(); // æˆ‘æ˜¯A æˆ‘æ˜¯B gen.next(); // ç»“æŸäº† å¾ªç¯çŠ¶æ€æœºé€šè¿‡ES5babelçš„è½¬æ¢ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä»¥ä¸‹çš„ES6ä»£ç çš„è½¬æ¢ function* generateRandoms (max) { max = max || 1; while (true) { let newMax = yield Math.random() * max; if (newMax !== undefined) { max = newMax; } } } var generateRandoms = regeneratorRuntime.mark(function generateRandoms(max) { var newMax; return regeneratorRuntime.wrap(function generateRandoms$(context$1$0) { while (1) switch (context$1$0.prev = context$1$0.next) { case 0: max = max || 1; case 1: if (!true) { context$1$0.next = 8; break; } context$1$0.next = 4; return Math.random() * max; case 4: newMax = context$1$0.sent; if (newMax !== undefined) { max = newMax; } context$1$0.next = 1; break; case 8: case \"end\": return context$1$0.stop(); } }, generateRandoms, this); }); å…¶ä¸­æ˜¯é€šè¿‡çŠ¶æ€æœºçš„æ¨¡æ‹Ÿï¼ˆswitch + æ— é™å¾ªç¯whileï¼‰å®ç°ï¼Œé€€å‡ºå¾ªç¯çš„æ—¶å€™æ˜¯é€šè¿‡åˆ¤æ–­å½“å‰æ˜¯å¦åˆ°è¾¾æœ€åä¸€æ­¥è¿›è¡Œbreak è¿™ä¸€ç‰‡æ–‡ç« ä½œè€…è‡ªå·±è®¾è®¡ä»£ç æ¨¡æ‹ŸåŸç”Ÿçš„generatorå¹¶ä¸”è®²è§£çš„å¾ˆè¯¦ç»†ï¼Œå€¼å¾—ä¸€çœ‹https://zhuanlan.zhihu.com/p/216060145 7.å…¶ä»–å¯é€‰é“¾å¯é€‰é“¾æ˜¯ES11ï¼ˆ2020ï¼‰ä¸­å¢åŠ çš„ç‰¹æ€§ å®ƒä½œç”¨æ˜¯å½“å¯¹è±¡å±æ€§ä¸å­˜åœ¨æ—¶ï¼Œä¼šçŸ­è·¯ï¼Œç›´æ¥è¿”å›undefinedï¼Œå¦‚æœå­˜åœ¨ï¼Œé‚£ä¹ˆæ‰ä¼šç»§ç»­æ‰§è¡Œ ä½¿ç”¨ï¼šï¼ˆ å¦‚æœbä¸ä¸ºundefinedåˆ™ç»§ç»­è¿›è¡Œå±æ€§æŸ¥æ‰¾æ‰¾åˆ°c ï¼‰ const a = { b: { c: \"allen\" } } console.log(a.b?.c) æ‰§è¡Œä¸Šä¸‹æ–‡ &amp; ä½œç”¨åŸŸå˜é‡å’Œå‡½æ•°çš„ä¸Šä¸‹æ–‡å†³å®šäº†ä»–ä»¬å¯ä»¥è®¿é—®å“ªäº›æ•°æ®ï¼Œä»¥åŠä»–ä»¬çš„è¡Œä¸ºï¼Œæ¯ä¸ªä¸Šä¸‹æ–‡éƒ½æœ‰ä¸€ä¸ªå…³è”çš„å˜é‡å¯¹è±¡ï¼Œè€Œè¿™ä¸ªä¸Šä¸‹æ–‡ä¸­å®šä¹‰çš„æ‰€æœ‰å˜é‡å’Œå‡½æ•°éƒ½å­˜åœ¨äºè¿™ä¸ªå¯¹è±¡ä¹‹ä¸Šã€‚ï¼ˆä¸ªäººç†è§£ï¼Œä¸Šä¸‹æ–‡ = ä»–ä»¬çš„ä½œç”¨åŸŸï¼‰ å…¨å±€ä¸Šä¸‹æ–‡ï¼šå…¨å±€ä¸Šä¸‹æ–‡æ˜¯æœ€å¤–å±‚çš„ä¸Šä¸‹æ–‡ï¼Œæ ¹æ®ESMAScriptçš„å®¿ä¸»ç¯å¢ƒå¯¹è±¡å¯èƒ½ä¸ä¸€æ ·ã€‚ä½†æ˜¯åœ¨æµè§ˆå™¨ä¸­ï¼Œå…¨å±€ä¸Šä¸‹æ–‡å°±æ˜¯æˆ‘ä»¬å¸¸è¯´çš„windowå¯¹è±¡ã€‚ä¸Šä¸‹æ–‡åœ¨å…¶æ‰€æœ‰ä»£ç éƒ½æ‰§è¡Œå®Œæ¯•åä¼šè¢«é”€æ¯ï¼Œè€Œå…¨å±€ä¸Šä¸‹æ–‡åœ¨åº”ç”¨ç¨‹åºé€€å‡ºå‰æ‰ä¼šè¢«é”€æ¯ï¼Œæ¯”å¦‚å…³é—­ç½‘é¡µã€é€€å‡ºæµè§ˆå™¨ã€‚ å‡½æ•°ä¸Šä¸‹æ–‡ï¼šæ¯ä¸ªå‡½æ•°éƒ½æœ‰è‡ªå·±çš„ä¸Šä¸‹æ–‡ï¼Œå½“å‡½æ•°ä¸Šä¸‹æ–‡è¢«æ¨åˆ°ä¸€ä¸ªä¸Šä¸‹æ–‡æ ˆä¸Šï¼Œå½“å‡½æ•°æ‰§è¡Œå®Œä¹‹åï¼Œä¸Šä¸‹æ–‡æ ˆä¼šå¼¹å‡ºè¯¥å‡½æ•°ä¸Šä¸‹æ–‡ï¼Œå°†æ§åˆ¶æƒè¿”è¿˜ç»™ä¹‹å‰çš„ä¸Šä¸‹æ–‡ å†…éƒ¨ä¸Šä¸‹æ–‡å¯ä»¥é€šè¿‡ä½œç”¨åŸŸé“¾è®¿é—®å¤–éƒ¨ä¸Šä¸‹æ–‡çš„ä¸€åˆ‡ï¼Œä½†æ˜¯å¤–éƒ¨ä¸Šä¸‹æ–‡æ— æ³•è®¿é—®å†…éƒ¨ä¸Šä¸‹æ–‡çš„ä¸€åˆ‡ï¼Œå³æ¯ä¸ªä¸Šä¸‹æ–‡éƒ½å¯ä»¥åˆ°ä¸Šä¸€çº§ä¸Šä¸‹æ–‡ä¸­å»æœç´¢å˜é‡å’Œå‡½æ•°ï¼Œä½†ä»»ä½•ä¸Šä¸‹æ–‡éƒ½ä¸èƒ½åˆ°ä¸‹ä¸€çº§ä¸Šä¸‹æ–‡å»æœç´¢ã€‚ æ³¨æ„ é™¤äº†å…¨å±€ä¸Šä¸‹æ–‡ å’Œ å‡½æ•°ä¸Šä¸‹æ–‡ï¼Œè¿˜æœ‰eval()ç¬¬ä¸‰ç§ä¸Šä¸‹æ–‡ è€Œä¸”è¿˜æœ‰å…¶ä»–æ–¹å¼æ¥å¢å¼ºä½œç”¨åŸŸï¼Œæ¯”å¦‚æŸäº›è¯­å¥ä¼šå¯¼è‡´åœ¨ä½œç”¨åŸŸé“¾å‰ç«¯ä¸´æ—¶æ·»åŠ ä¸€ä¸ªä¸Šä¸‹æ–‡ï¼Œæ¯”å¦‚ try/catchã€with è¯¡å¼‚è¡Œä¸ºå°æ€è€ƒå…ˆä¸Šä»£ç ï¼Œå…ˆä¸Šä»£ç  console.log(a) // undefined { a=1 function a() {} } console.log(a) // 1 console.log(a) // undefined { function a() {} a=1 } console.log(a) // func a æˆ‘åœ¨ç½‘ä¸Šæœåˆ°çš„éƒ¨åˆ†å‚è€ƒï¼Œå¸Œæœ›å¯¹ä½ ä»¬æœ‰å¸®åŠ©","categories":[{"name":"å‰ç«¯","slug":"å‰ç«¯","permalink":"https://taylor12138.github.io/categories/%E5%89%8D%E7%AB%AF/"}],"tags":[],"author":"Hello"},{"title":"JavaScriptè¿›é˜¶ES6(ä¸Š)","slug":"JavaScriptè¿›é˜¶ES6(ä¸Š)","date":"2022-04-02T04:15:14.533Z","updated":"2022-10-17T11:52:34.982Z","comments":true,"path":"2022/04/02/javascript-jin-jie-es6-shang/","link":"","permalink":"https://taylor12138.github.io/2022/04/02/javascript-jin-jie-es6-shang/","excerpt":"","text":"1.ESMAScript6ES6å…¶å®æ˜¯ä¸€ä¸ªæ³›æŒ‡ï¼Œæ³›æŒ‡ES2015åç»­çš„ç‰ˆæœ¬ 2.æ–°å¢è¯­æ³•å£°æ˜å˜é‡ES5ä¹‹å‰å› ä¸ºifã€foréƒ½æ²¡æœ‰å—çº§ä½œç”¨åŸŸçš„æ¦‚å¿µï¼Œæ‰€ä»¥å¾ˆå¤šæ—¶å€™éƒ½éœ€è¦å€ŸåŠ© functionçš„ä½œç”¨åŸŸ è§£å†³åº”ç”¨å¤–éƒ¨å˜é‡çš„é—®é¢˜ let å£°æ˜çš„å˜é‡ 1.åªåœ¨æ‰€å¤„å—çº§æœ‰æ•ˆï¼ˆå¤§æ‹¬å·ä¸­æœ‰æ•ˆï¼Œä¹Ÿå°±æ˜¯è¯´ifå’Œforéƒ½æœ‰å®ƒçš„å—çº§ä½œç”¨åŸŸäº†ï¼‰ï¼Œå¯ä»¥é˜²æ­¢å¾ªç¯å˜é‡å˜æˆå…¨å±€å˜é‡ 2.ä¸å­˜åœ¨å˜é‡æå‡ï¼Œåªèƒ½å…ˆå£°æ˜å†ä½¿ç”¨ï¼Œä¸å¯é‡å¤å£°æ˜ 3.æš‚æ—¶æ€§æ­»åŒºï¼ˆå³åœ¨å—çº§ä½œç”¨åŸŸä¸­ä½¿ç”¨æŸå˜é‡ï¼Œåˆ™ä¼šå…ˆåœ¨è¯¥å—çº§ä¸­æŸ¥æ‰¾æ­¤å˜é‡ï¼‰ var num = 10; if(true) { console.log(num); //æŠ¥é”™ï¼Œå˜é‡å£°æ˜åœ¨åé¢ let num = 20; } åˆ©ç”¨letè§£å†³å¼‚æ­¥é—®é¢˜ï¼šï¼ˆå› ä¸ºletä»…åœ¨å½“å‰å—çº§æœ‰æ•ˆï¼Œæ¯ä¸ªè¿­ä»£è“„å¥´å«å£°æ˜ä¸€ä¸ªæ–°çš„è¿­ä»£å˜é‡ï¼Œç„¶åä½¿ç”¨ä¸Šä¸€ä¸ªè¿­ä»£ç»“æŸæ—¶çš„å€¼æ¥åˆå§‹åŒ–è¿™ä¸ªå˜é‡ã€‚ï¼‰ for (let i = 0; i &lt; lis.length; i++) { lis[i].onclick = function () { console.log(i); } } constå£°æ˜å¸¸é‡ï¼Œå¸¸é‡å°±æ˜¯å€¼ï¼ˆå†…å­˜åœ°å€ï¼‰ä¸èƒ½å˜åŒ–çš„é‡ï¼ˆå€¼å¯ä»¥æ”¹ï¼Œå†…å­˜åœ°å€ä¸èƒ½å˜ï¼‰ 1.å…·æœ‰å—çº§ä½œç”¨åŸŸ 2.constå£°æ˜å¸¸é‡æ—¶å¿…é¡»èµ‹å€¼ 3.åŸºæœ¬æ•°æ®ç±»å‹ï¼šå¸¸é‡èµ‹å€¼åï¼Œä¸å¯ä¿®æ”¹ï¼›å¤æ‚æ•°æ®ç±»å‹ï¼šå¯¹è±¡èµ‹å€¼åï¼ˆæ•°ç»„ä¹‹ç±»çš„ï¼‰ä¸å¯æ›´æ”¹ï¼Œä½†æ˜¯å¯ä»¥æ›´æ”¹æ•°æ®ç»“æ„å†…éƒ¨çš„å€¼ 4.ä¸å­˜åœ¨å˜é‡æå‡ï¼Œåªèƒ½å…ˆå£°æ˜å†ä½¿ç”¨ const ary = [100, 200]; ary[0] = 'a'; //å¯ä»¥ //ary = ['a', 200]; //ä¸å¯ä»¥ ES6ä¹‹å‰çš„å—çº§ä½œç”¨åŸŸï¼š åŸæ¥çš„ä»£ç  { let a = 2; console.log(a); } console.log(a); ä»¥å‰çš„ä»£ç æ¥å®ç°(ä¸‘çš„è¦æ­»ï¼ï¼ï¼) try{ throw 2; } catch(a) { console.log(a); } console.log(a) è§£æ„èµ‹å€¼ES6å…è®¸ä»æ•°ç»„æˆ–è€…å¯¹è±¡ï¼ˆåˆ†åˆ«ä½¿ç”¨[]ã€{}ï¼‰ä¸­ä¸€ä¸€æå–å€¼ï¼ŒæŒ‰ç…§å¯¹åº”çš„ä½ç½®ï¼Œå¯¹å˜é‡èµ‹å€¼ //æ•°ç»„ let ary = [1, 2, 3]; let [a, b, c, d, e] = ary; //1, 2, 3, undefined, undefined //ä¹Ÿå¯ä»¥ let [a, b, c] = [1, 2, 3]; //å¯¹è±¡ let person = {name: 'zhangsan', age: 20}; let {name, age} = person; let {name, age = 18} = person; //è§£æ„èµ‹å€¼ï¼Œå¦‚æœåŸæ¥personæ²¡æœ‰ageå±æ€§ï¼Œåˆ™å®šä¹‰é»˜è®¤å€¼age = 18 å¯¹è±¡çš„å¦ä¸€è§£æ„å†™æ³•ï¼ˆé‡å‘½åï¼‰ let {name: myName, age: myAge} = person; å¦‚æœnameå’Œageåˆ†åˆ«å’Œpersonä¸­çš„å±æ€§å€¼åŒ¹é…æˆåŠŸï¼Œåˆ™å°†å·¦ä¾§è¯¥å±æ€§å€¼èµ‹å€¼ç»™å³è¾¹çš„myNameï¼ŒmyAgeå˜é‡ é™¤æ­¤å¤–ï¼Œè¿˜æœ‰åµŒå¥—è§£æ„èµ‹å€¼å†™æ³• //4.å¯¹è±¡çš„è§£æ„èµ‹å€¼ let obj = {a:{b:1}}; const {a:{b}} = obj; //æˆ‘ä»¬å¾—åˆ°bçš„æ•°æ® console.log(b); //1 ç®­å¤´å‡½æ•°(å½¢å‚) =&gt; {å‡½æ•°ä½“} ç®­å¤´å‡½æ•°ç”¨æ¥ç®€åŒ–å®šä¹‰å‡½æ•°è¯­æ³• const fn = () => { console.log('xx'); } // ä¹Ÿå¯ä»¥ï¼Œè¿”å›undefined //const fn = () => console.log('xx'); å¦‚æœå‡½æ•°ä½“åªæœ‰ä¸€å¥è¯ï¼Œä¸”ä»£ç æ‰§è¡Œç»“æœå°±æ˜¯è¿”å›å€¼ï¼Œåˆ™å¯ä»¥çœç•¥å¤§æ‹¬å· //ä¼ ç»Ÿ function sum(num1, num2) { return num1+num2; } //new const sum1 = (num1, num2) => num1+num2; å¦‚æœå½¢å‚åªæœ‰ä¸€ä¸ªï¼Œå°æ‹¬å·å¯ä»¥çœç•¥ //ä¼ ç»Ÿ function sum(a) { return a; } //new const sum1 = a => a; å¦‚æœè¿”å›çš„æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œä¸èƒ½ç›´æ¥åŠ å¤§æ‹¬å· //const sum1 = a => {}; é”™ï¼Œè¿”å›undefined const sum1 = a => ({}); //å¯¹ ç®­å¤´å‡½æ•°å’Œä¼ ç»Ÿå‡½æ•°ä¸ä¸€æ ·ï¼Œç®­å¤´å‡½æ•°çš„thisæŒ‡å‘å‡½æ•°å®šä¹‰ä½ç½®ï¼ˆä½¿ç”¨äº†ç®­å¤´å‡½æ•°çš„é‚£ä¸ªå‡½æ•°ï¼‰çš„ä¸Šä¸‹æ–‡thisï¼ˆå®šä¹‰å‡½æ•°åœ°ç‚¹æœ€è¿‘ä½œç”¨åŸŸä¸­çš„thisï¼‰ ä¹Ÿå°±æ˜¯è¯´ï¼Œç®­å¤´å‡½æ•°çš„thisä½¿ç”¨çš„æ˜¯è¯æ³•ä½œç”¨åŸŸï¼Œè€Œä¸æ˜¯thisåŸæ¥çš„åŠ¨æ€ä½œç”¨åŸŸ æ­¤æ—¶æˆ‘ä»¬è®¤ä¸ºç®­å¤´å‡½æ•°å°†ç¨‹åºå‘˜ä»¬ç»å¸¸çŠ¯çš„ä¸€ä¸ªé”™è¯¯æ ‡å‡†åŒ–äº†ï¼Œä¹Ÿå°±æ˜¯æ··æ·†thisç»‘å®šè§„åˆ™ï¼ˆåŠ¨æ€ä½œç”¨åŸŸï¼‰å’Œè¯æ³•ä½œç”¨åŸŸè§„åˆ™ ä½†æ˜¯ ç®­å¤´å‡½æ•°ä¸é€‚åˆäº‹ä»¶å›è°ƒ function fn() { console.log(this); return () => { console.log(this); } } const obj = { name: 'zhangsan' }; const resFn = fn.call(obj); //è¿™æ—¶thisæŒ‡å‘objï¼Œæ‰€ä»¥ç®­å¤´å‡½æ•°è·Ÿç€æŒ‡å‘obj è¿”å›{ name: 'zhangsan' } resFn(); //ç®­å¤´å‡½æ•°ä¸­thisæŒ‡å‘æŒ‡å‘ä¸Šä¸‹æ–‡thisï¼Œæ­¤æ—¶ç®­å¤´å‡½æ•°thisè·Ÿç€ä¸Šä¸‹æ–‡thiså‘ç”Ÿæ”¹åŠ¨ï¼Œè¾“å‡º{ name: 'zhangsan' } 2.ä¸é€‚åˆå¯¹è±¡çš„æ–¹æ³• å¯¹è±¡ä¸èƒ½äº§ç”Ÿä½œç”¨åŸŸï¼Œæ‰€ä»¥ç®­å¤´å‡½æ•°å®é™…è¢«å®šä¹‰åœ¨å…¨å±€ä½œç”¨åŸŸä¸‹ï¼Œæ‰€ä»¥æ­¤å¤„çš„thisæŒ‡å‘windowï¼Œæ‰€ä»¥ç®­å¤´å‡½æ•°å¤„çš„this.ageæœªå®šä¹‰ var obj = { age: 20, say: () => { alert(this.age); //undefined }, con: function () { console.log(this); //obj } } obj.say(); obj.con(); const obj = { aaa() { setTimeout(function () { setTimeout(function () { console.log(1, this); //window }) setTimeout(() => { console.log(2, this); //window }) console.log(3, this); //window }) setTimeout(() => { setTimeout(function () { console.log(4, this); //window }) setTimeout(() => { console.log(5, this); //obj }); console.log(6, this); //obj }); } } 3.ç”±äºç®­å¤´å‡½æ•°å¿…é¡»ä»¥èµ‹å€¼å£°æ˜çš„æ–¹å¼å‡ºç°ï¼Œæ‰€ä»¥æ²¡æœ‰å˜é‡æå‡ //ä¼šå‡ºé”™ï¼Œä½¿ç”¨varä¹Ÿä¼šå‡ºé”™ console.log(sum(10, 10)); let sum = (num1, num2) => { return num1 + num2 } 4.ç®­å¤´å‡½æ•°æ˜¯ä¸å­˜åœ¨åŸå‹çš„ const arrow = () => { console.log('a'); } function fn() { console.log('a'); } console.log(arrow.prototype); // undefined console.log(fn.prototype); // {constructor: Æ’} argumentsçš„ä½¿ç”¨å½“æˆ‘ä»¬ä¸ç¡®å®šå‡½æ•°ç”¨å¤šå°‘ä¸ªå‚æ•°æ¥ä¼ é€’çš„æ—¶å€™ï¼Œargumentså®é™…ä¸Šæ˜¯å½“å‰å‡½æ•°çš„ä¸€ä¸ªå†…ç½®å¯¹è±¡ï¼ˆå‡½æ•°æ‰æ‹¥æœ‰ï¼‰ï¼Œargumentså‚¨å­˜äº†ä¼ é€’çš„æ‰€æœ‰å®å‚,å®ƒå±•ç¤ºçš„æ–¹å¼æ˜¯ä¼ªæ•°ç»„ï¼Œå› æ­¤å¯ä»¥è¿›è¡Œéå†ï¼ˆä½¿ç”¨forç­‰ï¼‰ æ³¨æ„ï¼š ç®­å¤´å‡½æ•°æ˜¯ç”¨ä¸äº†argumentsï¼ˆè™½ç„¶ç®­å¤´å‡½æ•°ä¹Ÿç”¨ä¸äº†å®ƒï¼Œä½†æ˜¯å¯ä»¥ä½¿ç”¨å‰©ä½™å‚æ•°è¡¥è¶³ï¼‰ argumentså¯¹è±¡çš„å€¼ä¸åæ˜ å‚æ•°çš„é»˜è®¤å€¼ï¼ˆå½“å‡½æ•°è®¾ç½®äº†é»˜è®¤å‚æ•°å€¼ï¼‰ï¼Œå®ƒå§‹ç»ˆä»¥è°ƒç”¨å‡½æ•°æ—¶ä¼ å…¥çš„å€¼ä¸ºå‡† function fn(){ console.log(agruments); console.log(agruments.length); } fn(1,2,3); //åˆ™è¾“å‡º1ï¼Œ2ï¼Œ3 //3 arguements çš„å€¼å§‹ç»ˆä¼šä¸å¯¹åº”çš„å‘½åå‚æ•°åŒæ­¥ï¼ˆä¿®æ”¹arguments[i]ï¼Œä¼šå¯¹åº”ä¿®æ”¹ç¬¬iä¸ªå‚æ•°çš„å€¼ï¼‰ï¼Œä½†è¿™å¹¶ä¸æ„å‘³ç€å®ƒä»¬éƒ½è®¿é—®åŒä¸€ä¸ªå†…å­˜åœ°å€ï¼Œè¿™ç§åŒæ­¥æ˜¯å•å‘çš„ï¼Œä¿®æ”¹å‘½åå‚æ•°çš„å€¼ï¼Œä¸ä¼šå½±å“argument[i] å¯¹åº”çš„å€¼ function a(a, b) { arguments[0] = 100; console.log(a, 'this is a'); //100 a = 50; console.log(arguments[0], 'this is argument[0]'); //100 } let aaa = 1, b = 2; a(aaa, b) console.log(aaa); //1 ä¼ªæ•°ç»„ï¼š1.å…·æœ‰lengthå±æ€§ 2.æŒ‰ç´¢å¼•å‡¡æ˜¯å‚¨å­˜æ•°æ® 3.ä¸å…·æœ‰pushï¼ŒpopåŠŸèƒ½ æ³¨æ„ï¼š å¯¹å‚æ•°ä½¿ç”¨sliceä¼šé˜»æ­¢æŸäº›JavaScriptå¼•æ“ä¸­çš„ä¼˜åŒ– (æ¯”å¦‚ V8 - æ›´å¤šä¿¡æ¯)ã€‚å¦‚æœä½ å…³å¿ƒæ€§èƒ½ï¼Œå°è¯•é€šè¿‡éå†argumentså¯¹è±¡æ¥æ„é€ ä¸€ä¸ªæ–°çš„æ•°ç»„ã€‚å¦ä¸€ç§æ–¹æ³•æ˜¯ä½¿ç”¨è¢«å¿½è§†çš„Arrayæ„é€ å‡½æ•°ä½œä¸ºä¸€ä¸ªå‡½æ•°ï¼š var args = (arguments.length === 1 ? [arguments[0]] : Array.apply(null, arguments));å‰©ä½™å‚æ•°å‰©ä½™å‚æ•°è¯­æ³•ï¼ˆå±•å¼€è¿ç®—ç¬¦ï¼‰å…è®¸æˆ‘ä»¬å°†ä¸€ä¸ªä¸å®šæ•°é‡çš„å‚æ•°è¡¨ç¤ºä¸ºä¸€ä¸ªæ•°ç»„ ...args æ½œè§„åˆ™ï¼š ...argsè¦æ”¾åˆ°å‚æ•°çš„æœ€åï¼Œä¸ç„¶ä¼šæŠ¥é”™ //1.ä½œä¸ºä¼ å‚ï¼ˆrestå‚æ•°ï¼‰ function sum(first, ...args) { console.log(first); //10 console.log(args); //20, 30 } sum(10, 20, 30); //2.å‰©ä½™å‚æ•°é…åˆè§£æ„ let students = ['allen', 'berry', 'david']; let [s1, ...s2] = students; //s1ä¸ºallenï¼Œs2ä¸º[berry. david]çš„æ•°ç»„ //3.ä½œä¸ºå‚æ•°ä¼ å…¥ï¼Œå°†æ•°ç»„arr2é‡Œçš„æ•°æ®åˆ’åˆ†æˆè‹¥å¹²ä¸ªï¼Œç„¶åä¸€ä¸ªä¸€ä¸ªä¼ å…¥æ•°ç»„arr1ï¼šï¼ˆæ‰©å±•è¿ç®—ç¬¦ï¼‰ arr1.push(...arr2); å’Œargumentsä¸ä¸€æ ·çš„æ˜¯ï¼Œargumentså¾—åˆ°çš„æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œè€Œâ€¦argsä¸­ argså¾—åˆ°çš„æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œå¯ä»¥ä½¿ç”¨æ•°ç»„æ–¹æ³•ï¼ˆfilterã€someã€mapã€everyç­‰ï¼‰ function data1(){ console.log(arguments); } function data2(...args){ console.log(args); } åˆ©ç”¨argsæ‰‹å†™new åº”è¯äº†ã€Šä½ ä¸çŸ¥é“çš„JavaScriptã€‹é‡Œ åˆ›å»ºä¸€ä¸ªå…¨æ–°çš„å¯¹è±¡ è¿™ä¸ªæ–°å¯¹è±¡ä¼šè¢«æ‰§è¡ŒPrototypeè¿æ¥ æ–°å¯¹è±¡ä¼šç»‘å®šåˆ°å‡½æ•°è°ƒç”¨çš„this å¦‚æœå‡½æ•°æ²¡æœ‰å…¶ä»–è¿”å›å€¼ï¼Œé‚£ä¹ˆnewè¡¨è¾¾å¼ä¸­çš„å‡½æ•°è°ƒç”¨ä¼šè‡ªåŠ¨è¿”å›è¿™ä¸ªæ–°å¯¹è±¡ function _new(Constructor, ...args) { var obj = {}; obj.__proto__ = Constructor.prototype; var ret = Constructor.apply(obj, args) return ret instanceof Object ? ret : obj; } function One(a) { this.a = a; } let a = new One('good'); let b = _new(One, 'good'); console.log(a); console.log(b); å±•å¼€è¿ç®—ç¬¦å‰©ä½™è¯­æ³•(Rest syntax) çœ‹èµ·æ¥å’Œå±•å¼€è¯­æ³•å®Œå…¨ç›¸åŒï¼Œä¸åŒç‚¹åœ¨äº, å‰©ä½™å‚æ•°ç”¨äºè§£æ„æ•°ç»„å’Œå¯¹è±¡ã€‚ä»æŸç§æ„ä¹‰ä¸Šè¯´ï¼Œå‰©ä½™è¯­æ³•ä¸å±•å¼€è¯­æ³•æ˜¯ç›¸åçš„ï¼šå±•å¼€è¯­æ³•å°†æ•°ç»„å±•å¼€ä¸ºå…¶ä¸­çš„å„ä¸ªå…ƒç´ ï¼Œè€Œå‰©ä½™è¯­æ³•åˆ™æ˜¯å°†å¤šä¸ªå…ƒç´ æ”¶é›†èµ·æ¥å¹¶â€œå‡èšâ€ä¸ºå•ä¸ªå…ƒç´ ã€‚ï¼ˆæ¥æºäºMDNï¼‰ è¿ç”¨äºæ•°ç»„ var arr1 = [0, 1, 2]; var arr2 = [3, 4, 5]; arr1 = [...arr2, ...arr1]; ä¸€èˆ¬å±•å¼€è¿ç®—ç¬¦åªèƒ½å±•å¼€å¯è¿­ä»£å¯¹è±¡ï¼Œå¯¹äºå¯¹è±¡ï¼Œä½†æ˜¯å¯ä»¥ ä½¿ç”¨ let person1 = {...person2}è¿›è¡Œå±•å¼€ å‚æ•°é»˜è®¤å€¼å¯ä»¥ç»™å‡½æ•°é™„ä¸Šé»˜è®¤çš„å‚æ•°å€¼ï¼Œåœ¨è°ƒç”¨æ—¶æ²¡æœ‰ç»™åˆ°çš„å½¢å‚ä¼šç”¨é»˜è®¤å€¼ä»£æ›¿ ä¸€èˆ¬å…·æœ‰é»˜è®¤å€¼çš„å‚æ•°éƒ½é åï¼ˆæ½œè§„åˆ™ï¼‰ function add(a, b ,c=10){ return a + b + c; } console.log(add(1, 2)); //13 3.ES6å†…ç½®å¯¹è±¡çš„æ‰©å±•arrayçš„æ‰©å±• ...ary æ‰©å±•è¿ç®—ç¬¦æ˜¯å’Œå‰©ä½™å‚æ•°ç›¸åçš„åŸç†ï¼Œå®ƒå¯ä»¥å°†æ•°ç»„æˆ–è€…å¯¹è±¡è½¬ä¸ºç”¨é€—å·åˆ†éš”çš„å‚æ•°åºåˆ— ...ary let ary = [1, 2, 3]; console.log(...ary); // 1, 2, 3 //ç›¸å½“äº console.log('1', '2', '3'); æ‰©å±•è¿ç®—ç¬¦åº”ç”¨ï¼šæ•°ç»„åˆå¹¶ //æ–¹æ³•ä¸€ï¼š let ary1 = [1, 2, 3]; let ary2 = [3, 4, 5]; let ary3 = [...ary1, ...ary2]; //æ–¹æ³•äºŒ ary1.push(...ary2); ...aryæ‰©å±•è¿ç®—ç¬¦è¿˜èƒ½æŠŠä¼ªæ•°ç»„è½¬æ¢æˆçœŸæ­£çš„æ•°ç»„ï¼Œç„¶åå¯ä»¥ä½¿ç”¨æ•°ç»„çš„æ–¹æ³• å¯è®¡ç®—å±æ€§å ES6å¢åŠ äº†å¯è®¡ç®—å±æ€§åï¼Œå¯ä»¥åœ¨æ–‡å­—å½¢å¼ä¸­ä½¿ç”¨ [] åŒ…è£¹ä¸€ä¸ªè¡¨è¾¾å¼å½“ä½œå±æ€§å const prefix = \"foo\"; const obj = { [prefix + \"bar\"]: \"hello\" } stringçš„æ‹“å±•ES6æ–°å¢çš„åˆ›å»ºå­—ç¬¦ä¸²çš„æ–¹å¼ï¼Œä½¿ç”¨åå¼•å·å®šä¹‰ let name = allen;(æ¨¡æ¿å­—ç¬¦ä¸²) æ¨¡æ¿å­—ç¬¦ä¸²çš„ç‰¹ç‚¹ï¼š 1.å¯ä»¥è§£æå˜é‡ï¼Œä¸ç”¨å­—ç¬¦ä¸²æ‹¼æ¥${å˜é‡å} 2.å¯ä»¥æ¢è¡Œï¼Œæ’°å†™è¾ƒä¸ºç¾è§‚ 3.å¯ä»¥è°ƒç”¨å‡½æ•°ï¼Œå¾—åˆ°çš„ç»“æœä¸ºå‡½æ•°è¿”å›å€¼${å‡½æ•°å()} const saySomething = () => 'æˆ‘æ˜¯å‡½æ•°'; let a = `allen`; let = `hello, my name is ${name}`; let html = `&lt;div> &lt;span>${saySomething()}&lt;/span> &lt;/div>`; setæ•°æ®ç»“æ„ES6æä¾›äº†æ–°çš„æ•°æ®ç»“æ„Setã€‚å®ƒç±»ä¼¼äºæ•°ç»„ï¼Œä½†æ˜¯æˆå‘˜çš„å€¼éƒ½æ˜¯å”¯ä¸€çš„ï¼Œæ²¡æœ‰é‡å¤çš„å€¼ï¼ˆä¸ä¼šå­˜å‚¨é‡å¤çš„å€¼ï¼‰ã€è‡ªåŠ¨å»é‡ é›†åˆå®ç°äº† iteratoræ¥å£ï¼Œæ‰€ä»¥å¯ä»¥ä½¿ç”¨ for of Setæœ¬èº«æ˜¯ä¸€ä¸ªæ„é€ å‡½æ•°ï¼Œç”¨æ¥ç”ŸæˆSetæ•°æ®ç»“æ„ const s = new Set([\"a\", \"a\",\"b\"]); console.log(s.size); const ary = [...s]; //æ•°ç»„å»é‡ s.add(value) æ·»åŠ æŸä¸ªå€¼ï¼Œè¿”å›Setç»“æ„æœ¬èº« s.delete(value) åˆ é™¤æŸä¸ªå€¼ï¼Œè¿”å›å¸ƒå°”å€¼è¡¨ç¤ºåˆ é™¤æˆåŠŸä¸å¦ s.has(value) è¿”å›å¸ƒå°”å€¼ï¼ŒæŸ¥çœ‹æ˜¯å¦ä¸ºSetæˆå‘˜ s.clear() æ¸…ç©ºæ‰€æœ‰æˆå‘˜ s.values()æŸ¥çœ‹æ‰€æœ‰å…ƒç´  s[Symbol.iterator] s.size() è¿”å›Setå®ä¾‹çš„æˆå‘˜æ€»æ•° Setç»“æ„å®ä¾‹ä¸æ•°ç»„ä¸€æ ·ï¼Œä¹Ÿæœ‰forEachæ–¹æ³•ï¼Œç”¨äºå¯¹æ¯ä¸ªæˆå‘˜æ‰§è¡ŒæŸç§æ“ä½œï¼Œæ²¡æœ‰è¿”å›å€¼ mapæ•°æ®ç»“æ„ æ˜¯ä¸€ä¸ªå¸¦é”®çš„æ•°æ®é¡¹çš„é›†åˆï¼Œå°±åƒä¸€ä¸ª Object ä¸€æ ·ã€‚ ä½†æ˜¯å®ƒä»¬æœ€å¤§çš„å·®åˆ«æ˜¯ Map å…è®¸ä»»ä½•ç±»å‹çš„é”®ï¼ˆkeyï¼‰ï¼Œâ€œé”®â€çš„èŒƒå›´ä¸é™äºå­—ç¬¦ä¸²ï¼Œå„ç§ç±»å‹çš„å€¼ï¼ˆåŒ…æ‹¬å¯¹è±¡ï¼‰éƒ½å¯ä»¥å½“ä½œé”® ï¼ˆObjectçš„é”®åªèƒ½ä¸ºå­—ç¬¦ä¸²ï¼Œå…¶å®è¿˜èƒ½ä¸ºæ•°å€¼æˆ–ç¬¦å·ï¼Œä½†å®ƒä»¬éƒ½ä¼šè½¬åŒ–ä¸ºå­—ç¬¦ä¸²ï¼‰ã€‚ Map çš„éå†é¡ºåºå°±æ˜¯æ’å…¥é¡ºåºã€‚ ä½¿ç”¨å¯¹è±¡ä½œä¸ºé”®æ˜¯ Map æœ€å€¼å¾—æ³¨æ„å’Œé‡è¦çš„åŠŸèƒ½ä¹‹ä¸€ let map = new Map(); let john = { name: \"John\" }; map.set('1', 'str1'); // å­—ç¬¦ä¸²é”® map.set(1, 'num1'); // æ•°å­—é”® map.set(true, 'bool1'); // å¸ƒå°”å€¼é”® map.set(john, 123)); // å¯¹è±¡é”® // è¿˜è®°å¾—æ™®é€šçš„ Object å—? å®ƒä¼šå°†é”®è½¬åŒ–ä¸ºå­—ç¬¦ä¸² // Map åˆ™ä¼šä¿ç•™é”®çš„ç±»å‹ï¼Œæ‰€ä»¥ä¸‹é¢è¿™ä¸¤ä¸ªç»“æœä¸åŒï¼š alert( map.get(1) ); // 'num1' alert( map.get('1') ); // 'str1' alert( map.size ); // 3 å½“ç„¶ä¹Ÿå¯ä»¥æ¥å—ä¸€ä¸ªæ•°ç»„ä½œä¸ºå‚æ•° const map = new Map([ ['name', 'å¼ ä¸‰'], ['title', 'Author'] ]); æ–¹æ³• + å±æ€§ new Map() â€”â€” åˆ›å»º mapã€‚ map.set(key, value) â€”â€” æ ¹æ®é”®å­˜å‚¨å€¼ã€‚ map.get(key) â€”â€” æ ¹æ®é”®æ¥è¿”å›å€¼ï¼Œå¦‚æœ map ä¸­ä¸å­˜åœ¨å¯¹åº”çš„ keyï¼Œåˆ™è¿”å› undefinedã€‚ map.has(key) â€”â€” å¦‚æœ key å­˜åœ¨åˆ™è¿”å› trueï¼Œå¦åˆ™è¿”å› falseã€‚ map.delete(key) â€”â€” åˆ é™¤æŒ‡å®šé”®çš„å€¼ã€‚ map.clear() â€”â€” æ¸…ç©º mapã€‚ map.size â€”â€” è¿”å›å½“å‰å…ƒç´ ä¸ªæ•°ã€‚ map.keys() â€”â€” éå†å¹¶è¿”å›æ‰€æœ‰çš„é”®ï¼ˆreturns an iterable for keysï¼Œè¿”å›ä¸€ä¸ªå¼•ç”¨çš„ Iterator å¯¹è±¡ã€‚å®ƒåŒ…å«æŒ‰ç…§é¡ºåºæ’å…¥ Map å¯¹è±¡ä¸­æ¯ä¸ªå…ƒç´ çš„keyå€¼ã€‚ï¼‰ map.values() â€”â€” éå†å¹¶è¿”å›æ‰€æœ‰çš„å€¼ï¼ˆreturns an iterable for valuesï¼‰ map.entries()â€”â€” éå†å¹¶è¿”å›æ‰€æœ‰çš„é”®å€¼å¯¹ï¼Œentrieså®é™…ä¸Šæ˜¯å¼•ç”¨äº† [Symbol.iterator]è¿™ä¸ªå±æ€§ map.entries === map[Symbol.iterator] //true åªæœ‰å¯¹åŒä¸€ä¸ªå¯¹è±¡çš„å¼•ç”¨ï¼ŒMap ç»“æ„æ‰å°†å…¶è§†ä¸ºåŒä¸€ä¸ªé”®ã€‚è¿™ä¸€ç‚¹è¦éå¸¸å°å¿ƒã€‚ const map = new Map(); map.set(['a'], 555); map.get(['a']) // undefined mapå’ŒObjectå¯¹æ¯”ï¼š 1.å†…å­˜å ç”¨ï¼šç»™å›ºå®šå¤§å°çš„å†…å­˜ï¼ŒMapå¤§çº¦å¯ä»¥æ¯”Objectå¤šå­˜å‚¨50%é”®å€¼å¯¹ 2.æ’å…¥æ€§èƒ½ï¼šObjectå’ŒMapæ’å…¥æ–°çš„é”®å€¼å¯¹æ¶ˆè€—å¤§è‡´ç›¸å½“ï¼Œä¸è¿‡æ’å…¥Mapåœ¨æ‰€æœ‰æµè§ˆå™¨ä¸­ä¸€èˆ¬ä¼šç¨å¾®å¿«ä¸€ç‚¹å„¿ 3.æŸ¥æ‰¾é€Ÿåº¦ï¼šä¸æ’å…¥ä¸åŒï¼Œä»å¤§å‹Objectå’ŒMapä¸­æŸ¥æ‰¾é”®å€¼å¯¹çš„æ€§èƒ½å·®å¼‚æå°ï¼Œå¦‚æœæ¶‰åŠå¤§é‡æŸ¥æ‰¾å·¥ä½œï¼ˆå¯¹ä¸¤ä¸ªç±»å‹è€Œè¨€ï¼ŒæŸ¥æ‰¾é€Ÿåº¦ä¸ä¼šéšç€é”®å€¼å¯¹æ•°é‡å¢åŠ è€Œå¢åŠ ï¼‰ï¼ŒæŸäº›æƒ…å†µå¯èƒ½Objectæ›´å¥½ä¸€ç‚¹ 4.åˆ é™¤æ€§èƒ½ï¼šåˆ é™¤Objcetå±æ€§çš„æ€§èƒ½ä¸€ç›´ä»¥æ¥é¥±å—è¯Ÿç—…ï¼Œè€Œå¯¹äºå¤§å¤šæ•°æµè§ˆå™¨å¼•æ“æ¥è¯´ï¼ŒMapçš„delete()åˆ é™¤æ“ä½œç”šè‡³æ¯”æ’å…¥å’ŒæŸ¥æ‰¾æ›´å¿«ï¼Œæ— ç–‘æ—¶Mapå®Œèƒœ å¼±å¼•ç”¨ç±»å‹ï¼ˆå¾ˆå¤šå±æ€§ã€è¿­ä»£æ–¹æ³•ä¸èƒ½ç”¨ + ä¿å­˜çš„å…ƒç´ æœ‰é™åˆ¶ï¼‰ let s = new WeakSet()ä¿å­˜çš„å…ƒç´ å¿…é¡»å¾—æ˜¯å¼•ç”¨ç±»å‹ï¼ˆå¯¹è±¡ / æ•°ç»„ï¼‰ï¼ˆDOMå…ƒç´ ä¹Ÿæ˜¯å¯¹è±¡ï¼Œæ‰€ä»¥ä¹Ÿèƒ½å­˜å‚¨ï¼‰ let map = new WeakMap()çš„key å¿…é¡»å¾—æ˜¯å¼•ç”¨ç±»å‹ï¼ˆå¯¹è±¡ / æ•°ç»„ï¼‰ï¼ˆDOMå…ƒç´ ä¹Ÿæ˜¯å¯¹è±¡ï¼Œæ‰€ä»¥ä¹Ÿèƒ½å­˜å‚¨ï¼‰ å¼±å¼•ç”¨ä¸æ”¯æŒéå†æ–¹æ³•ï¼Œåªæœ‰å››ä¸ªæ–¹æ³•å¯ç”¨ï¼Œget()ã€set()ã€has()ã€delete() æ­£å¸¸å¼•ç”¨ç±»å‹çš„åƒåœ¾å›æ”¶ï¼š è°å¼•ç”¨è¿™ä¸ªæ•°æ®ï¼Œå°±å¼•ç”¨æ¬¡æ•° + 1ï¼Œ åŸæ¥å¼•ç”¨è¿™ç»„æ•°æ®ï¼Œåé¢èµ‹å€¼ä¸ºnullï¼Œå¼•ç”¨æ¬¡æ•° -1 å½“è¿™ç»„æ•°æ®å¼•ç”¨æ¬¡æ•°ä¸º0ï¼Œåˆ™æ ¹æ®åƒåœ¾å›æ”¶æœºåˆ¶ä¼šè¢«å›æ”¶æ‰ å¼±å¼•ç”¨ç±»å‹çš„åƒåœ¾å›æ”¶ï¼š å½“weakå¼±å¼•ç”¨æ•°æ®æ—¶ï¼Œå¼•ç”¨æ¬¡æ•°ä¸ä¼š + 1 è¿™æ ·çš„è¯ä¼˜ç‚¹å°±æ˜¯ï¼Œæ¸…é™¤å˜é‡çš„æ—¶å€™ï¼Œä¸ç”¨å†å»weakå¼±å¼•ç”¨ç±»å‹é‚£é‡Œè¿›è¡Œæ¸…é™¤ï¼ˆä¸ç”¨èµ‹å€¼nullï¼‰ objçš„æ‹“å±•åˆ©ç”¨å¯¹è±¡å­—é¢é‡åˆ›å»ºå¯¹è±¡å³ç›´æ¥ç”¨{}åˆ›å»ºå¯¹è±¡è€Œä¸æ˜¯newå‡ºæ¥ï¼Œè€ŒES6æ–°å¢å¯¹è±¡å­—é¢é‡çš„å¢å¼ºå†™æ³• const name = 'Allen'; const age = 18; const height = 1.88; // ES5å¯¹è±¡å­—é¢é‡å„ç±»å±æ€§ã€å‡½æ•°å†™æ³• obj = { name: name, age: age, height: height, run: function () { } }; // ES6å¯¹è±¡å­—é¢é‡å„ç±»å±æ€§ã€å‡½æ•°å†™æ³• obj2 = { name, age, height, run() { } //æ­¤å†™æ³•ä»…æ”¯æŒåœ¨å­—é¢é‡/ç±»ä¸­ }; åˆ¤æ–­ä¸€ä¸ªå¯¹è±¡æ˜¯å¦ä¸ºç©ºï¼Œå¯ä»¥ä½¿ç”¨ Object.key(å¯¹è±¡åç§°).length === 0 js åˆ¤æ–­å¯¹è±¡çš„å±æ€§æ˜¯å¦å­˜åœ¨ inè¿ç®—ç¬¦ ï¼ˆå±æ€§å in å¯¹è±¡ï¼‰ æƒ…å†µ1:å¯¹è±¡è‡ªèº«å±æ€§ var obj={a:1}; \"a\" in obj//true æƒ…å†µ2:å¯¹è±¡ç»§æ‰¿çš„å±æ€§ var objA = {a:1}; var objB = Object.create(A) \"a\" in objB //true æŸ¥æ‰¾ç¬¦åˆæ¡ä»¶çš„ç¬¬ä¸€ä¸ªå¯¹è±¡ find(function(currentValue, index, arr),thisValue) å‚æ•° æè¿° currentValue å¿…éœ€ã€‚å½“å‰å…ƒç´  index å¯é€‰ã€‚å½“å‰å…ƒç´ çš„ç´¢å¼•å€¼ arr å¯é€‰ã€‚å½“å‰å…ƒç´ æ‰€å±çš„æ•°ç»„å¯¹è±¡ thisValue å¯é€‰ã€‚ ä¼ é€’ç»™å‡½æ•°çš„å€¼ä¸€èˆ¬ç”¨ â€œthisâ€ å€¼ã€‚å¦‚æœè¿™ä¸ªå‚æ•°ä¸ºç©ºï¼Œ â€œundefinedâ€ ä¼šä¼ é€’ç»™ â€œthisâ€ å€¼ //å®ç°ä¸€æ­¥æŸ¥æ‰¾ç¬¦åˆæ¡ä»¶çš„product let product = state.cartList.find(item => item.id === payload.id); è¿”å›ç¬¦åˆæµ‹è¯•æ¡ä»¶çš„ç¬¬ä¸€ä¸ªæ•°ç»„å…ƒç´ å€¼ï¼Œå¦‚æœæ²¡æœ‰ç¬¦åˆæ¡ä»¶çš„åˆ™è¿”å› undefinedã€‚ å¯¹è±¡ä½¿ç”¨å˜é‡åä½œä¸ºé”®å let a = 'name'; let obj = {}; //obj.a = 'Allen'é”™è¯¯ï¼ obj[a] = Allen //æ­£ç¡® åˆæˆ–è€… let a = 'name'; let obj = { [a]:'Allen' }; 4.Promisecallback hellå›è°ƒåœ°ç‹±ï¼šcallback hellï¼Œå¼‚æ­¥é‡Œé¢å¥—ç€å¦ä¸€ä¸ªå¼‚æ­¥ æ— æ³•ä¿è¯å¼‚æ­¥ä»»åŠ¡æ‰§è¡Œé¡ºåºï¼š var fs = require('fs'); fs.readFile('./index.txt', function (err, data) { if (err) { // throwçš„ä½œç”¨ï¼šæŠ›å‡ºå¼‚å¸¸ //å³1.é˜»æ­¢ç¨‹åºçš„æ‰§è¡Œï¼Œ 2.æŠŠé”™è¯¯ä¿¡æ¯æ‰“å°åˆ°æ§åˆ¶å° throw err; } console.log(data); }); fs.readFile('./index2.txt', function (err, data) { if (err) throw err; console.log(data); }); fs.readFile('./index3.txt', function (err, data) { if (err) throw err; console.log(data); }); é€šè¿‡å›è°ƒåµŒå¥—çš„æ–¹å¼æ¥ä¿è¯é¡ºåºï¼Œä½†ç”±æ­¤å‚¬ç”Ÿäº†å›è°ƒåœ°ç‹±ï¼Œè¯­æ³•ååˆ†ä¸‘é™‹ï¼Œä»£ç ä¸‘é™‹ fs.readFile('./index.txt', function (err, data) { if (err) { // throwçš„ä½œç”¨ï¼šæŠ›å‡ºå¼‚å¸¸ //å³1.é˜»æ­¢ç¨‹åºçš„æ‰§è¡Œï¼Œ 2.æŠŠé”™è¯¯ä¿¡æ¯æ‰“å°åˆ°æ§åˆ¶å° throw err; } console.log(data); fs.readFile('./index2.txt', function (err, data) { if (err) throw err; console.log(data); fs.readFile('./index3.txt', function (err, data) { if (err) throw err; console.log(data); }); }); }); Promiseä¸ºäº†é¿å…å›è°ƒåœ°ç‹±åµŒå¥—ï¼Œæ‰€ä»¥ES6ä¸­æ–°å¢äº†APIï¼šPromiseï¼ˆç”Ÿäº§å¾®ä»»åŠ¡ï¼‰ åº”ç”¨åœºæ™¯ï¼šæ•°æ®æ¥æºäºå¤šä¸ªæ¥å£ï¼Œå‡ºç°å›è°ƒåµŒå¥— Promiseæœ¬èº«ä¸æ˜¯å¼‚æ­¥çš„ï¼Œåªæ˜¯é‡Œé¢çš„ä»»åŠ¡å¾€å¾€éƒ½æ˜¯å¼‚æ­¥çš„ new Promise(resolve => { resolve(); console.log(\"promise\"); }).then(value => console.log(\"success!\")); console.log(\"end\"); //æ‰§è¡Œé¡ºåº: //promise //end //success! åˆ›å»ºä¸€ä¸ªpromiseå®¹å™¨ =&gt; è€Œè¿™é‡Œå®¹å™¨ä¸€æ—¦åˆ›å»ºï¼Œå°±å¼€å§‹æ‰§è¡Œé‡Œé¢çš„ä»£ç  =&gt; å®¹å™¨ä¸­å­˜æ”¾ä¸€ä¸ªå¼‚æ­¥ä»»åŠ¡é»˜è®¤pendingçŠ¶æ€ï¼Œè¡¨ç¤ºæ­£å‡†å¤‡å»åšï¼Œå³å°†å‘ç”Ÿçš„ ä¸ªäººè§‰å¾—ï¼šresolveå’Œrejectç±»ä¼¼äºä¸¤ä¸ªcallbackï¼Œç„¶åå†å¤–é¢è¿›è¡Œå›è°ƒç½¢äº†finally()æ–¹æ³•ç”¨äºæŒ‡å®šä¸ç®¡Promiseå¯¹è±¡æœ€åçŠ¶æ€å¦‚ä½•ï¼ˆæ— è®ºç»“æœæ˜¯fulfilledæˆ–è€…æ˜¯rejectedï¼‰ï¼Œéƒ½ä¼šæ‰§è¡Œçš„æ“ä½œï¼Œè¯¥æ–¹æ³•æ—¶ES2018å¼•å…¥çš„æ ‡å‡† var fs = require('fs'); //å°è£…å®ä¾‹åŒ–Promise+è¯»å–æ•°æ®API function ProReadFile(Path) { return new Promise(function (resolve, reject) { fs.readFile(Path, 'utf8', function (err, data) { if (err) { // å¤±è´¥äº†ï¼Œæ‰¿è¯ºå®¹å™¨ä¸­çš„ä»»åŠ¡å¤±è´¥ // æŠŠå®¹å™¨çš„pendingçŠ¶æ€æ”¹ä¸ºRejected // è°ƒç”¨rejectç›¸å½“äºè°ƒç”¨äº†thenæ–¹æ³•ç¬¬äºŒä¸ªå‚æ•°å‡½æ•° reject(err); } else { // æ‰¿è¯ºå®¹å™¨ä¸­çš„ä»»åŠ¡æˆåŠŸ // æŠŠå®¹å™¨çš„pendingçŠ¶æ€æ”¹ä¸ºæˆåŠŸResolved // è°ƒç”¨resolveç›¸å½“äºè°ƒç”¨äº†thenæ–¹æ³•ç¬¬ä¸€ä¸ªå‚æ•°å‡½æ•° resolve(data); } }) }); }; å½“è¿”å›ç»“æœæˆåŠŸåï¼ŒthenåšæŒ‡å®šæ“ä½œ ä½¿ç”¨Promiseè¿‡ç¨‹ä¸­resolveæˆ–rejectåï¼Œåé¢ä»£ç è¿˜ä¼šæ‰§è¡Œï¼Œé™¤éä½ ç›´æ¥return thençš„è¯´æ˜ï¼š then(resolve(), reject()) æˆåŠŸçŠ¶æ€Fulfilledæ—¶ï¼ˆresolveï¼ŒæˆåŠŸåˆ™è¿›å…¥ä¸‹ä¸€ä¸ªthenï¼‰ï¼Œthenæ–¹æ³•æ¥æ”¶ä¸¤ä¸ªå‚æ•°:1.å®¹å™¨ä¸­çš„resolveå‡½æ•°, 2.å®¹å™¨ä¸­çš„rejectå‡½æ•°ï¼Œè¿™é‡ŒæŠŠthençœ‹æˆä¸€ä¸ªæ•´ä½“ï¼Œthenä¼šé»˜è®¤è¿”å›ä¸€ä¸ªfulfilledçŠ¶æ€çš„Promise å¤±è´¥çŠ¶æ€Rejectedï¼ˆè‡ªå·±è®¾ç½®åˆ¤æ–­å¤±è´¥çš„æ¡ä»¶ï¼Œç„¶årejectå‡½æ•°ï¼‰ï¼Œä¼šå›è°ƒcatch åœ¨ç±»é‡Œé¢å®šä¹‰ ä¸€ä¸ªthenæ–¹æ³•ï¼Œé‚£ä¹ˆä»–ä¼šåŒ…è£…æˆä¸€ä¸ªPromiseï¼Œä½†æ˜¯æ³¨æ„è¿™ä¸ªPromise é»˜è®¤æ²¡æœ‰çŠ¶æ€ï¼Œéœ€è¦æ‰‹åŠ¨å» resolve æˆ–è€… reject ProReadFile('./index.txt') .then(function (data) { console.log(data); //å½“ç¬¬ä¸€ä¸ªè¯»å–æˆåŠŸæ—¶ï¼Œè¿™é‡Œè¿”å›åé¢æƒ³è¦ç»§ç»­æ‰§è¡Œçš„Promiseå¼‚æ­¥ä»»åŠ¡ï¼Œå¦‚æœæ²¡æœ‰è¿”å›ï¼Œåˆ™åé¢æ”¶åˆ°çš„æ˜¯undefined //æˆ‘ä»¬çœŸæ­£æœ‰ç”¨çš„æ˜¯return ä¸€ä¸ªPromiseå¯¹è±¡ //å¦‚æœreturn 123ï¼Œåˆ™æ¥ä¸‹æ¥çš„thençš„functionå‚æ•°æ¥å—çš„dataæ˜¯123ï¼Œè€Œä¸”å¹¶ä¸æ˜¯å‰é¢çš„å¼‚æ­¥ä»»åŠ¡æ‰§è¡Œå®Œæ¯•æ‰è¿›å…¥ä¸‹ä¸€ä¸ªthen return ProReadFile('./index2.txt'); }, err => { console.log('è¯»å–æ–‡ä»¶å¤±è´¥', err); throw 'error message'; //è¦è°ƒç”¨è¿™ä¸ªï¼Œä¸ç„¶è¿”å›undefinedï¼Œä¼šè¿›å…¥ä¸‹ä¸€ä¸ªthençš„resolveçš„å›è°ƒ }) .then(function (data) { console.log(data); //ç¬¬äºŒä¸ªè¯»å–æˆåŠŸæ—¶ï¼Œè¿™é‡Œè¿”å›åé¢æƒ³è¦ç»§ç»­æ‰§è¡Œçš„Promiseå¼‚æ­¥ä»»åŠ¡ return ProReadFile('./index3.txt'); }, err => { console.log('è¯»å–æ–‡ä»¶å¤±è´¥', err); throw 'error message'; }) .then(function (data) { console.log(data); }, err => { console.log('è¯»å–æ–‡ä»¶å¤±è´¥', err); }) catchæ•ˆæœå’Œå†™åœ¨thençš„ç¬¬äºŒä¸ªå‚æ•°é‡Œé¢ä¸€æ ·ã€‚ä¸è¿‡å®ƒè¿˜æœ‰å¦å¤–ä¸€ä¸ªä½œç”¨ï¼šåœ¨æ‰§è¡Œresolveçš„å›è°ƒï¼ˆä¹Ÿå°±æ˜¯ä¸Šé¢thenä¸­çš„ç¬¬ä¸€ä¸ªå‚æ•°ï¼‰æ—¶ï¼Œå¦‚æœæŠ›å‡ºå¼‚å¸¸äº†ï¼ˆä»£ç å‡ºé”™äº†ï¼‰ï¼Œé‚£ä¹ˆå¹¶ä¸ä¼šæŠ¥é”™å¡æ­»jsï¼Œè€Œæ˜¯ä¼šè¿›åˆ°è¿™ä¸ªcatchæ–¹æ³•ä¸­ï¼ˆæ¨èæŠŠcatchæ”¾åœ¨é“¾å¼ç»“æ„çš„æœ€åï¼Œå‰é¢æ— è®ºç¬¬å‡ ä¸ªå‡ºé”™ï¼Œéƒ½ä¼šè·‘åˆ°æœ€åæ‰§è¡Œè¿™ä¸ªcatchï¼ˆé™¤éä½ äº‹å…ˆåœ¨å‰é¢ç”¨rejectçš„å›è°ƒå‡½æ•°å¤„ç†è¿‡é”™è¯¯ç»“æœäº†ï¼‰ï¼‰ã€‚è¯·çœ‹ä¸‹é¢çš„ä»£ç ï¼š ProReadFile('./index.txt') .then(function (data) { console.log(data); return ProReadFile('./index2.txt'); }).catch(err => {console.log('æ–‡ä»¶è¯»å–å¤±è´¥', err)}) ç‰¹æ®Šæƒ…å†µçŠ¶æ€ä¼ é€’ æ³¨æ„ï¼šå¦‚æœresolveæˆ–rejectä¸­çš„å‚æ•°æ˜¯promiseå®ä¾‹å¯¹è±¡ var p1 = new Promise(function (resolve, reject) { setTimeout(function () { resolve('1'); }, 3000); }) var p2 = new Promise(function (resolve, reject) { setTimeout(function () { resolve(p1); // resolveçš„å‚æ•°æ˜¯ä¸€ä¸ªpromiseå¯¹è±¡ }, 1000); }); p2 .then(function (data) { console.log('resolveæ‰§è¡Œ') console.log(data) }, function (err) { console.log(err) }) 3såä¾æ¬¡æ‰“å° â€˜resolveæ‰§è¡Œâ€™ â€˜1â€™ ï¼ˆæ—¶é—´ = max ï¼ˆp1çš„å®šæ—¶æ—¶é•¿, p2çš„å®šæ—¶æ—¶é•¿ï¼‰ï¼‰ è¿™æ—¶p1çš„çŠ¶æ€å°±ä¼šä¼ é€’ç»™p2ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œp1çš„çŠ¶æ€å†³å®šäº†p2çš„çŠ¶æ€ã€‚å¦‚æœp1çš„çŠ¶æ€æ˜¯pendingï¼Œé‚£ä¹ˆp2çš„å›è°ƒå‡½æ•°å°±ä¼šç­‰å¾…p1çš„çŠ¶æ€æ”¹å˜ï¼›å¦‚æœp1çš„çŠ¶æ€å·²ç»æ˜¯resolvedæˆ–è€…rejectedï¼Œé‚£ä¹ˆp2çš„å›è°ƒå‡½æ•°å°†ä¼šç«‹åˆ»æ‰§è¡Œã€‚ï¼ˆå®é™…ä¸Šæœ‰ç‚¹åƒæ˜¯promise.allSettleçš„åŸç†ï¼Ÿï¼‰ let p1 = new Promise((resolve, reject) => { reject(\"æ‹’ç»\"); }) new Promise((resolve, reject) => { resolve(p1); }).then(res => { console.log(\"res\"); }, err => { console.log(\"err\", err); }) //err æ‹’ç» ä¸Šé¢è¯´åˆ°p1çš„çŠ¶æ€ä¼šä¼ é€’ï¼Œæ‰€ä»¥è¿™é‡Œp1çš„çŠ¶æ€æ˜¯Rejectedï¼Œä¼ é€’ç»™äº†ä¸‹é¢è¿™ä¸ªPromiseï¼Œæ‰§è¡Œçš„æ˜¯Rejectedçš„å›è°ƒ è¿”å›å€¼é—®é¢˜ æ³¨æ„ å¦‚æœè¿”å›å€¼ä¸ºä¸€ä¸ªæ™®é€šå‚æ•° thenæ–¹æ³•ä¼šè¿”å›ä¸€ä¸ªæ–°çš„promise,è¿™ä¸ªæ–°promiseçš„valueç”±returnçš„å€¼å†³å®š æ‰§è¡Œreturnè¯­å¥åä¸æ˜¯Promiseå®ä¾‹ï¼Œæ˜¯123ï¼Œåˆ™å¯¼è‡´å½“å‰thenæ–¹æ³•è¿”å›çš„promiseå˜ä¸ºæˆåŠŸçŠ¶æ€ pending-&gt;fulfilled(Resolved) åœ¨è¿™é‡Œå®ƒå…¶å®æ˜¯ return new Promise.resolve(123)çš„ç®€å†™ var p2 = p1.then(function (data) { console.log(data); return 123456 }, err => { console.log('è¯»å–æ–‡ä»¶å¤±è´¥', err); }) .then(function (data) { console.log(data); // è¿™ä¸ªå›è°ƒä¸€å®šä¼šè¢«è°ƒç”¨ï¼Œæ‰“å°123456 }, err => { console.log('è¯»å–æ–‡ä»¶å¤±è´¥', err); }) æ³¨æ„ ç”šè‡³æ²¡æœ‰è¿”å›å€¼æ—¶ï¼Œå®ƒè¿˜ä¼šè‡ªåŠ¨ç»™ä½  pedding -&gt; fulfilledï¼Œï¼ˆå› ä¸ºä¼šè¿”å›é»˜è®¤è¿”å›å€¼undefinedï¼‰ç„¶åè¿›å…¥ä¸‹ä¸€ä¸ªthençš„ç¬¬ä¸€ä¸ªæˆåŠŸçš„å›è°ƒå‡½æ•°é‡Œ è€Œåè€Œå¦‚æœä½  return äº†ä¸€ä¸ªpromiseå®ä¾‹ï¼Œåœ¨è¿™ä¸ªå®ä¾‹é‡Œé¢æ²¡æœ‰è°ƒç”¨ resolve æˆ–è€… rejectï¼Œå°±è¿›å…¥ä¸äº†ä¸‹ä¸€ä¸ªthené‡Œé¢ æ‰€ä»¥ï¼ï¼ï¼ å› ä¸ºå¼‚æ­¥æ“ä½œæˆ‘ä»¬æ‰ä½¿ç”¨Promiseï¼Œè€Œè¿”å›å€¼éPromiseçš„æƒ…å†µä¼šå¯¼è‡´æœªæ‰§è¡Œå®Œå¼‚æ­¥æ“ä½œåˆ™ç›´æ¥è¿›å…¥ä¸‹ä¸€æ­¥çš„thené‡Œé¢ï¼Œè¿™æ ·å’ŒåŸæ¥æœªä½¿ç”¨Promiseè¯­å¥åœ°æ‰§è¡Œæ–¹å¼ç›¸åŒï¼Œå’Œæˆ‘ä»¬æƒ³è¦æœ‰åºåœ°è¿›è¡Œå¼‚æ­¥æ“ä½œçš„åˆè¡·èƒŒé“è€Œé©° æ‰€ä»¥æˆ‘ä»¬æ¨èè¿”å›å€¼è¿”å›ä¸€ä¸ª new Promiseï¼Œè¿™æ ·ç­‰åˆ°Promiseå®ä¾‹è°ƒç”¨resolve / rejectåæ‰ä¼šè¿›å…¥ä¸‹ä¸€æ­¥thenï¼Œæ‰ç¬¦åˆæˆ‘ä»¬çš„ä»£ç è§„èŒƒå’Œåˆè¡·ï¼ï¼ ç›´æ¥æŠ›å‡ºå¼‚å¸¸é—®é¢˜ æ³¨æ„ å¦‚æœæƒ³è¦è¿”å›åç›´æ¥è·³è½¬åˆ°ä¸‹ä¸€ä¸ªthençš„rejectå‡½æ•°é‡Œï¼Œå¯ä»¥ç›´æ¥ throw ErrorMessage æ‰§è¡Œthrowè¯­å¥åï¼Œå¯¼è‡´å½“å‰thenæ–¹æ³•è¿”å›çš„promiseå˜ä¸ºå¤±è´¥çŠ¶æ€ pending-&gt;Rejected å› ä¸ºå®ƒå…¶å®æ˜¯ return new Promise.reject(&#39;error message&#39;)çš„ç®€å†™ var p2 = p1.then(function (data) { console.log(data); throw 'error message'; }, err => { console.log('è¯»å–æ–‡ä»¶å¤±è´¥', err); }) .then(function (data) { console.log(data); }, err => { console.log('è¯»å–æ–‡ä»¶å¤±è´¥', err); // è¿™ä¸ªå›è°ƒä¸€å®šä¼šè¢«è°ƒç”¨ }) åŒé‡thené—®é¢˜ æ³¨æ„ thenæ–¹æ³•æä¾›ä¸€ä¸ªä¾›è‡ªå®šä¹‰çš„å›è°ƒå‡½æ•°ï¼Œè‹¥ä¼ å…¥éå‡½æ•°ï¼Œåˆ™ä¼šå¿½ç•¥å½“å‰thenæ–¹æ³•ã€‚ ä»¥ä¸‹çš„ä¾‹å­å°±æ˜¯å¿½ç•¥äº†ç¬¬ä¸€ä¸ªthenï¼Œå› ä¸ºå®ƒæœªä¼ å…¥å‡½æ•°ï¼Œä¼ å…¥çš„æ˜¯ â€˜æ–°çš„å€¼â€™ let func = function() { return new Promise((resolve, reject) => { resolve('è¿”å›å€¼'); }); }; let cb = function() { return 'æ–°çš„å€¼'; } func().then(cb()).then(resp => { console.warn(resp); console.warn('========='); }); //è¾“å‡ºï¼šè¿”å›å€¼ ============ çŠ¶æ€é—®é¢˜ æ³¨æ„ åœ¨æ‰§è¡Œpromiseåï¼Œreturnæ—¶éƒ½ä¼šåŒ…è£…æˆä¸€ä¸ªæ–°çš„Promiseå®ä¾‹ï¼Œä½†å¦‚æœthenæ–¹æ³•è¿˜æœªè¢«è°ƒç”¨ï¼Œåˆ™è¿™ä¸ªå®ä¾‹å®ƒçš„çŠ¶æ€è¿˜æ˜¯pedding let p1 = new Promise((resolve, reject) => { resolve(\"fulfilled\"); }) let p2 = p1.then( val => {console.log(val);}, err => {console.log(err)} ) console.log(p1); console.log(p2); setTimeout(()=>{ console.log(p1); console.log(p2); }) //è¾“å‡º //Promise&lt;resolved> //Promise&lt;pending> //fulfilled //Promise&lt;resolved> //Promise&lt;resolved> Promiseçš„allæ–¹æ³•ä½¿ç”¨åº”ç”¨åœºæ™¯ï¼šå¤„ç†å¤šä¸ªç›¸äº’ä¾èµ–çš„å¼‚æ­¥è¯·æ±‚ Promise.all([ new Promise((resolve, reject) => { setTimeout(() => { resolve('hello'); }, 1000); }), new Promise((resolve, reject) => { setTimeout(() => { resolve('world'); }, 2000); }) ]) // ä¸¤ä¸ªç½‘ç»œè¯·æ±‚éƒ½å®Œæˆåæ‰ä¼šè¿›å…¥then // å¦‚æœæœ‰ä¸€ä¸ªå¤±è´¥ï¼Œæ­¤å›è°ƒç›´æ¥å¤±è´¥ï¼Œå¤±è´¥åŸå› æ˜¯é‚£ä¸ªç¬¬ä¸€ä¸ªå¤±è´¥çš„promise .then(results => { // resultsæ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œå®ƒåŒ…å«ä»¥ä¸Šå¼‚æ­¥æ“ä½œçš„ç»“æœ console.log(results[0], results[1]); }) é™¤äº† allä¹‹å¤–ï¼Œè¿˜æœ‰allSettleã€raceæ–¹æ³•ï¼Œåˆ†åˆ«è¡¨ç¤º allSettleï¼šåªæœ‰ç­‰åˆ°æ‰€æœ‰è¿™äº›å‚æ•°å®ä¾‹éƒ½è¿”å›ç»“æœï¼Œä¸ç®¡æ˜¯fulfilledè¿˜æ˜¯rejectedï¼ŒåŒ…è£…å®ä¾‹æ‰ä¼šç»“æŸï¼Œè¿”å›ä¸€ä¸ªå¯¹è±¡æ•°ç»„ï¼Œæ¯ä¸ªå¯¹è±¡è¡¨ç¤ºå¯¹åº”çš„promiseç»“æœ raceï¼šè°æ‰§è¡Œçš„å¿«å°±å–å†³äºè°çš„çŠ¶æ€ anyï¼šåªè¦å‚æ•°å®ä¾‹æœ‰ä¸€ä¸ªå˜æˆfulfilledçŠ¶æ€ï¼ŒåŒ…è£…å®ä¾‹å°±ä¼šå˜æˆfulfilledçŠ¶æ€ï¼›å¦‚æœæ‰€æœ‰å‚æ•°å®ä¾‹éƒ½å˜æˆrejectedçŠ¶æ€ï¼ŒåŒ…è£…å®ä¾‹å°±ä¼šå˜æˆrejectedçŠ¶æ€ã€‚ ï¼ˆæ„Ÿè§‰raceæ–¹æ³•å¯èƒ½æ˜¯å°è£…ajaxä¸­è®¾ç½®è¯·æ±‚è¶…æ—¶æ—¶é•¿çš„åŸç†ï¼‰ æœ‰ç©ºè¿˜å¯ä»¥çœ‹çœ‹å¤§ä½¬æ‰‹å†™promise.allå’Œpromise.race https://blog.csdn.net/qq1498982270/article/details/93922893 asyncå’Œawaitè¯­æ³•ç³–asyncå’Œawaitæ—¶Promiseçš„è¯­æ³•ç³– ï¼ˆ2021.6.27çº æ­£ï¼Œæˆ‘åœ¨ã€Šçº¢å®ä¹¦çš„å•ƒè¯»ã€‹ç¯‡ç›®è§£é‡Šäº†å®ƒä»¬åœ¨å†…å­˜ä¸­çš„å·®åˆ«ï¼‰ ä½¿ç”¨ await å¼‚æ­¥å‡½æ•°() ç›¸å½“äº .then(res =&gt; { return å¼‚æ­¥å‡½æ•°() })ï¼Œå¤„ç†å¼‚æ­¥ä»»åŠ¡ï¼Œæœ‰å¼‚æ­¥ä»»åŠ¡ -&gt; åŒæ­¥ä»»åŠ¡çš„æ„Ÿè§‰ï¼Œè®°å¾—æ¯æ¬¡éƒ½æŠŠå¼‚æ­¥ä»»åŠ¡æ”¾åœ¨awaitåé¢ï¼Œè€Œä¸”æ¯æ¬¡åœ¨await å¼‚æ­¥æ“ä½œä¹‹åçš„åŒæ­¥ä»»åŠ¡å°±åƒè¢«æ”¾åœ¨å¦ä¸€ä¸ªthené‡Œé¢ï¼Œä¼šç­‰å¾…å¼‚æ­¥ä»»åŠ¡çš„å®Œæˆåå†æ‰§è¡Œ async function pro(delay = 1000) { return new Promise((resolve, reject) => { setTimeout(() => { resolve(\"hello\"); }, delay); }) } async function show() { for (const item of [\"Allen\", \"Bruce\", \"Carry\"]) { let hello = await pro(); console.log(item); console.log(\"hello\"); console.log(\"world\"); } } show(); // //åŸå§‹æ–¹æ³• // let p = Promise.resolve(); // for (const item of [\"Allen\", \"Bruce\", \"Carry\"]) { // p = p.then((res) => { // return pro(); // }).then(() => { // console.log(item); // console.log(\"hello\"); // console.log(\"world\"); // }) // } è¯­æ³•ç³–å¯ä»¥é…åˆ thenã€ catchä¸€èµ·ä½¿ç”¨ async function fn() { return await new Promise((resolve, reject) => { setTimeout(() => { console.log(\"nononon\"); resolve(); }, 1000); }) } fn().then(res => { console.log(\"success\"); }).catch((err) => { console.log(err); }) async + awaitå®ç°å¹¶è¡Œæ‰§è¡Œ ï¼ˆé…åˆPromise.allï¼‰ async function fn(k) { return await new Promise((resolve, reject) => { setTimeout(() => { console.log(k); resolve(k); }, 1000); }) } async function hd() { let res = await Promise.all([fn(\"hello\"), fn(\"world\")]) console.log(res); } hd(); await å†…éƒ¨å®ç°äº† generatorï¼Œå…¶å® await å°±æ˜¯ generator åŠ ä¸Š Promise çš„è¯­æ³•ç³–ï¼Œä¸”å†…éƒ¨å®ç°äº†è‡ªåŠ¨æ‰§è¡Œ generator Promiseç¼ºç‚¹ æ— æ³•å–æ¶ˆPromise,ä¸€æ—¦æ–°å»ºå®ƒå°±ä¼šç«‹å³æ‰§è¡Œï¼Œæ— æ³•ä¸­é€”å–æ¶ˆã€‚ï¼ˆåªèƒ½æŠ›å‡ºé”™è¯¯ä¸­æ–­ï¼ˆthrowï¼‰ï¼‰(JavaScripté«˜çº§ç¨‹åºè®¾è®¡æœ‰æåŠåˆ°) å¦‚æœä¸è®¾ç½®å›è°ƒå‡½æ•°ï¼Œpromiseå†…éƒ¨æŠ›å‡ºçš„é”™è¯¯ï¼Œä¸ä¼šååº”åˆ°å¤–éƒ¨ã€‚ å½“å¤„äºpendingçŠ¶æ€æ—¶ï¼Œæ— æ³•å¾—çŸ¥ç›®å‰è¿›å±•åˆ°å“ªä¸€ä¸ªé˜¶æ®µï¼ˆåˆšåˆšå¼€å§‹è¿˜æ˜¯å³å°†å®Œæˆï¼‰ã€‚(JavaScripté«˜çº§ç¨‹åºè®¾è®¡æœ‰æåŠåˆ°) å¯èƒ½ä»£ç æ’°å†™æ¯”è¾ƒç¹ç + å†—é•¿ æ‰‹å†™promiseå‡½æ•°ä½“å†…éƒ¨é¦–å…ˆåˆ›å»ºäº†å¸¸é‡ thatï¼Œå› ä¸ºä»£ç å¯èƒ½ä¼šå¼‚æ­¥æ‰§è¡Œï¼Œç”¨äºè·å–æ­£ç¡®çš„ this å¯¹è±¡ï¼ˆå³thisä¸€å¼€å§‹æŒ‡å‘MyPromiseï¼Œåé¢æŒ‡å‘windowï¼‰ const PENDING = 'pending' const RESOLVED = 'resolved' const REJECTED = 'rejected' function MyPromise(fn) { const that = this //æ­¤æ—¶thisæŒ‡å‘MyPromise that.state = PENDING that.value = null that.resolvedCallbacks = [] that.rejectedCallbacks = [] // å¾…å®Œå–„ resolve å’Œ reject å‡½æ•° function resolve(value) { //æ­¤æ—¶thisæŒ‡å‘window if (that.state === PENDING) { that.state = RESOLVED that.value = value that.resolvedCallbacks.map(cb => cb(that.value)) } } function reject(value) { if (that.state === PENDING) { that.state = REJECTED that.value = value that.rejectedCallbacks.map(cb => cb(that.value)) } } // å¾…å®Œå–„æ‰§è¡Œ fn å‡½æ•° try { fn(resolve, reject) } catch (e) { reject(e) } } // thenæ–¹æ³• MyPromise.prototype.then = function (onFulfilled, onRejected) { //å®é™…ä¸Šè¿™é‡Œé¢çš„çš„thiséƒ½æŒ‡å‘MyPromiseï¼Œç”šè‡³ä¸æ¢æˆthatä¹Ÿè¡Œï¼Œä½†æ˜¯ä¸ºäº†ç¾è§‚å’Œæ˜“è¯»æ€§éƒ½æ¢æˆthat const that = this onFulfilled = typeof onFulfilled === 'function' ? onFulfilled : v => v onRejected = typeof onRejected === 'function' ? onRejected : r => { throw r } if (that.state === PENDING) { that.resolvedCallbacks.push(onFulfilled) that.rejectedCallbacks.push(onRejected) } if (that.state === RESOLVED) { onFulfilled(that.value) } if (that.state === REJECTED) { onRejected(that.value) } } å®è·µ new MyPromise((resolve, reject) => { setTimeout(() => { resolve(1) // æ­¤æ—¶ç¯å¢ƒä¸‹thisä¸ºwindow }, 2000) }).then(value => { console.log(value) }) 5.Errorå½“è¿è¡Œæ—¶é”™è¯¯äº§ç”Ÿæ—¶ï¼ŒError å¯¹è±¡ä¼šè¢«æŠ›å‡ºã€‚Error å¯¹è±¡ä¹Ÿå¯ç”¨äºç”¨æˆ·è‡ªå®šä¹‰çš„å¼‚å¸¸çš„åŸºç¡€å¯¹è±¡ã€‚ä¸‹é¢åˆ—å‡ºäº†å„ç§å†…å»ºçš„æ ‡å‡†é”™è¯¯ç±»å‹ã€‚ æˆ‘ä»¬é€šå¸¸åœ¨å¼‚æ­¥è¯·æ±‚åä½¿ç”¨try catchæ•è·ï¼Œåœ¨å‘ç”Ÿè¯·æ±‚é”™è¯¯çš„æ—¶å€™å¯ä»¥throw ä¸€ä¸ª Error fetchAPI().then((res) => { console.log(res); if (!res) throw new Error('å½“å‰æ²¡æœ‰è¿”å›å€¼ï¼Ÿï¼Ÿï¼š no response'); }).catch((e) => { console.log(e); }); å…¶ä»–erroré™¤äº†é€šç”¨çš„ Error æ„é€ å‡½æ•°å¤–ï¼ŒJavaScript è¿˜æœ‰å…¶å®ƒç±»å‹çš„é”™è¯¯æ„é€ å‡½æ•°ã€‚å¯¹äºå®¢æˆ·ç«¯å¼‚å¸¸ï¼Œè¯¦è§å¼‚å¸¸å¤„ç†è¯­å¥ã€‚ EvalError åˆ›å»ºä¸€ä¸ª error å®ä¾‹ï¼Œè¡¨ç¤ºé”™è¯¯çš„åŸå› ï¼šä¸ eval() æœ‰å…³ã€‚ RangeError åˆ›å»ºä¸€ä¸ª error å®ä¾‹ï¼Œè¡¨ç¤ºé”™è¯¯çš„åŸå› ï¼šæ•°å€¼å˜é‡æˆ–å‚æ•°è¶…å‡ºå…¶æœ‰æ•ˆèŒƒå›´ã€‚ ReferenceError åˆ›å»ºä¸€ä¸ª error å®ä¾‹ï¼Œè¡¨ç¤ºé”™è¯¯çš„åŸå› ï¼šæ— æ•ˆå¼•ç”¨ã€‚ SyntaxError åˆ›å»ºä¸€ä¸ª error å®ä¾‹ï¼Œè¡¨ç¤ºé”™è¯¯çš„åŸå› ï¼šè¯­æ³•é”™è¯¯ã€‚ TypeError åˆ›å»ºä¸€ä¸ª error å®ä¾‹ï¼Œè¡¨ç¤ºé”™è¯¯çš„åŸå› ï¼šå˜é‡æˆ–å‚æ•°ä¸å±äºæœ‰æ•ˆç±»å‹ã€‚ URIError åˆ›å»ºä¸€ä¸ª error å®ä¾‹ï¼Œè¡¨ç¤ºé”™è¯¯çš„åŸå› ï¼šç»™ encodeURI() æˆ– decodeURI() ä¼ é€’çš„å‚æ•°æ— æ•ˆã€‚ AggregateError åˆ›å»ºä¸€ä¸ª error å®ä¾‹ï¼Œå…¶ä¸­åŒ…è£¹äº†ç”±ä¸€ä¸ªæ“ä½œäº§ç”Ÿä¸”éœ€è¦æŠ¥å‘Šçš„å¤šä¸ªé”™è¯¯ã€‚å¦‚ï¼šPromise.any() äº§ç”Ÿçš„é”™è¯¯ã€‚ InternalError éæ ‡å‡† åˆ›å»ºä¸€ä¸ªä»£è¡¨ Javascript å¼•æ“å†…éƒ¨é”™è¯¯çš„å¼‚å¸¸æŠ›å‡ºçš„å®ä¾‹ã€‚å¦‚ï¼šé€’å½’å¤ªå¤šã€‚ å½“ç„¶ä¹Ÿå¯ä»¥è‡ªå®šä¹‰Error class PayError extends Error { constructor(code, message, other = null) { super(message); this.code = code; this.other = other; } }","categories":[{"name":"å‰ç«¯","slug":"å‰ç«¯","permalink":"https://taylor12138.github.io/categories/%E5%89%8D%E7%AB%AF/"}],"tags":[],"author":"Hello"},{"title":"Reactæ‹“å±•","slug":"Reactæ‹“å±•","date":"2022-03-30T16:00:00.000Z","updated":"2022-11-13T07:55:44.258Z","comments":true,"path":"2022/03/31/react-tuo-zhan/","link":"","permalink":"https://taylor12138.github.io/2022/03/31/react-tuo-zhan/","excerpt":"","text":"æ‹“å±•GraphQLGraphQLæ˜¯Facebookå¼€å‘çš„ä¸€ç§æŸ¥è¯¢è¯­è¨€ï¼Œå¹¶äº2015å¹´å‘å¸ƒï¼Œå®ƒæ˜¯REST APIçš„æ›¿ä»£å“ å®ƒæ—¢æ˜¯ä¸€ç§ç”¨äºAPIçš„æŸ¥è¯¢è¯­è¨€ï¼Œä¹Ÿæ˜¯ä¸€ä¸ªæ»¡è¶³ä½ æ•°æ®æŸ¥è¯¢è¿è¡Œæ—¶ï¼ŒGraphQLå¯¹ä½ çš„APIçš„æ•°æ®æä¾›äº†ä¸€å¥—æ˜“äºç†è§£çš„å®Œæ•´æè¿°ï¼Œä½¿å¾—å®¢æˆ·ç«¯èƒ½å¤Ÿå‡†ç¡®è·å–ä»–éœ€è¦çš„æ•°æ®ï¼Œä¸”æ²¡æœ‰ä»»ä½•å†—ä½™ï¼Œä¹Ÿè®©APIæ›´å®¹æ˜“éšç€æ—¶é—´æ¨ç§»è€Œæ¼”è¿› ä¸­æ–‡ç½‘https://graphql.cn/ ç‰¹ç‚¹ï¼š è¯·æ±‚éœ€è¦çš„æ•°æ®ï¼Œä¸å¤šä¸å°‘ è·å–å¤šä¸ªèµ„æºï¼Œåªç”¨ä¸€ä¸ªè¯·æ±‚ æè¿°æ‰€æœ‰å¯èƒ½ç±»å‹çš„ç³»ç»Ÿï¼Œæ ¹æ®éœ€æ±‚å¹³æ»‘æ¨è¿›ï¼Œæ·»åŠ æˆ–éšè—å­—æ®µ ä½†æ˜¯éœ€è¦åç«¯ä¹Ÿæ”¹é€ æˆGreaphQLçš„æ–¹å¼ DvaJSdva é¦–å…ˆæ˜¯ä¸€ä¸ªåŸºäº redux å’Œ redux-saga çš„æ•°æ®æµæ–¹æ¡ˆï¼Œç„¶åä¸ºäº†ç®€åŒ–å¼€å‘ä½“éªŒï¼Œdva è¿˜é¢å¤–å†…ç½®äº† react-router å’Œ fetchï¼Œæ‰€ä»¥ä¹Ÿå¯ä»¥ç†è§£ä¸ºä¸€ä¸ªè½»é‡çº§çš„åº”ç”¨æ¡†æ¶ã€‚ï¼ˆç”¨èµ·æ¥æ€ä¹ˆå’ŒReactå‡ ä¹ä¸€æ ·ï¼Œä½†æ˜¯é‡Œé¢çš„éƒ¨åˆ†åŠŸèƒ½å’Œvueçš„vuexä¸€æ ·ã€‚ï¼‰ æ•°æ®æµå›¾ ï¼ˆä¸è¿‡ç°åœ¨å¥½åƒä¸æ›´æ–°äº†ï¼‰ Umiumi æ˜¯ä¸€ä¸ªå¯æ’æ‹”çš„reactåº”ç”¨æ¡†æ¶(é›†æˆå¤šä¸ªå¤§å¤šæ•°éƒ½æ‰€éœ€çš„ä¾èµ–ï¼)ï¼Œå®ƒä»¥è·¯ç”±ä¸ºåŸºç¡€ï¼Œæ”¯æŒç±»next.jsçš„çº¦å®šå¼è·¯ç”±ï¼Œä»¥åŠå„ç§è¿›é˜¶çš„è·¯ç”±åŠŸèƒ½ï¼Œå¹¶ä»¥æ­¤è¿›è¡ŒåŠŸèƒ½æ‹“å±•ï¼Œæ¯”å¦‚æ”¯æŒè·¯ç”±çº§çš„æŒ‰éœ€åŠ è½½ã€‚umiåœ¨çº¦å®šæ˜¯è·¯ç”±çš„åŠŸèƒ½ä¼šæ›´åƒnuxt.jsä¸€ç‚¹ let us use: mkdir myapp && cd myapp npx @umijs/create-umi-app npm i mockï¼šæ”¾å‡æ•°æ®æµ‹è¯•ç”¨ srcï¼š umiæ–‡ä»¶å¤¹ï¼šæŠ€æœ¯å†…æ•›ï¼Œæˆ‘ä»¬ä¸éœ€è¦å…³æ³¨å®ƒ pageæ–‡ä»¶å¤¹ï¼Œæ”¾æˆ‘ä»¬çš„åŠŸèƒ½é¡µé¢ï¼Œå†ä¸é…ç½®è·¯ç”±çš„æƒ…å†µä¸‹ï¼ˆæ³¨é‡Šæ‰.umiorc.tsä¸­routesé€‰é¡¹ï¼‰ï¼Œåœ¨è¯¥æ–‡ä»¶å¤¹ä¸‹ç›´æ¥æ–°å»ºxx.tsxæ–‡ä»¶ï¼Œå°†è‡ªåŠ¨æˆä¸ºè·¯ç”±ï¼Œindex.tsxæ–‡ä»¶ä¸ºé¦–é¡µï¼ˆå¯¹åº” &quot;/&quot; è·¯ç”±ï¼‰ï¼Œ404.tsxä¸ºæ‰¾ä¸åˆ°è·³è½¬çš„é¡µé¢ åµŒå¥—è·¯ç”±åˆ™æ–°å»ºæ–‡ä»¶å¤¹ï¼ˆæ–‡ä»¶å¤¹åä¸ºä¸€çº§è·¯ç”±åï¼‰ï¼Œåº•ä¸‹çš„ _layout.tsx ä¸ºä¸€çº§è·¯ç”±ç»„ä»¶é¡µé¢ï¼Œå¹¶ä¸”åœ¨é‡Œé¢æ”¾ç½® props.childrenç”¨äºä½œä¸ºäºŒçº§è·¯ç”±çš„æ’æ§½ä½ç½® ï¼Œæ–°å»º nowplay.tsxï¼Œåˆ™ nowplayä¸ºäºŒçº§è·¯ç”±å å®ƒçš„å£°æ˜å¼å¯¼èˆª // layouts/index.tsx import React from 'react'; import {NavLink} from 'umi' import style from './index.less' export default function(props:any) { if (props.location.pathname.includes('/detail')) { return { props.children } } return ( film cinema center { props.children } ); } ç›®å½•ç»“æ„ .umirc.ts é…ç½®æ–‡ä»¶ï¼ŒåŒ…å« umi å†…ç½®åŠŸèƒ½å’Œæ’ä»¶çš„é…ç½®ã€‚ /src ç›®å½• .umi ç›®å½• ä¸´æ—¶æ–‡ä»¶ç›®å½•ï¼Œæ¯”å¦‚å…¥å£æ–‡ä»¶ã€è·¯ç”±ç­‰ï¼Œéƒ½ä¼šè¢«ä¸´æ—¶ç”Ÿæˆåˆ°è¿™é‡Œã€‚ä¸è¦æäº¤ .umi ç›®å½•åˆ° git ä»“åº“ï¼Œä»–ä»¬ä¼šåœ¨ umi dev å’Œ umi build æ—¶è¢«åˆ é™¤å¹¶é‡æ–°ç”Ÿæˆã€‚ ä¸ºä»€ä¹ˆä¸æ˜¯ï¼Ÿcreate-react-appcreate-react-app æ˜¯åŸºäº webpack çš„æ‰“åŒ…å±‚æ–¹æ¡ˆï¼ŒåŒ…å« buildã€devã€lint ç­‰ï¼Œä»–åœ¨æ‰“åŒ…å±‚æŠŠä½“éªŒåšåˆ°äº†æè‡´ï¼Œä½†æ˜¯ä¸åŒ…å«è·¯ç”±ï¼Œä¸æ˜¯æ¡†æ¶ï¼Œä¹Ÿä¸æ”¯æŒé…ç½®ã€‚æ‰€ä»¥ï¼Œå¦‚æœå¤§å®¶æƒ³åŸºäºä»–ä¿®æ”¹éƒ¨åˆ†é…ç½®ï¼Œæˆ–è€…å¸Œæœ›åœ¨æ‰“åŒ…å±‚ä¹‹å¤–ä¹ŸåšæŠ€æœ¯æ”¶æ•›æ—¶ï¼Œå°±ä¼šé‡åˆ°å›°éš¾ã€‚ next.jsnext.js æ˜¯ä¸ªå¾ˆå¥½çš„é€‰æ‹©ï¼ŒUmi å¾ˆå¤šåŠŸèƒ½æ˜¯å‚è€ƒ next.js åšçš„ã€‚è¦è¯´æœ‰å“ªäº›åœ°æ–¹ä¸å¦‚ Umiï¼Œæˆ‘è§‰å¾—å¯èƒ½æ˜¯ä¸å¤Ÿè´´è¿‘ä¸šåŠ¡ï¼Œä¸å¤Ÿæ¥åœ°æ°”ã€‚æ¯”å¦‚ antdã€dva çš„æ·±åº¦æ•´åˆï¼Œæ¯”å¦‚å›½é™…åŒ–ã€æƒé™ã€æ•°æ®æµã€é…ç½®å¼è·¯ç”±ã€è¡¥ä¸æ–¹æ¡ˆã€è‡ªåŠ¨åŒ– external æ–¹é¢ç­‰ç­‰ä¸€çº¿å¼€å‘è€…æ‰ä¼šé‡åˆ°çš„é—®é¢˜ã€‚ Recoilç›®å‰reduxå­˜åœ¨çš„é—®é¢˜ï¼š é™¡å³­çš„å­¦ä¹ æ›²çº¿ å¤ªå¤šçš„æ ·æ¿ä»£ç  é‡æ–°ç»„ç»‡ä½ çš„é¡¹ç›® ç¼ºä¹å¹¶å‘æ¨¡å¼æ”¯æŒ éååº”æ€§æ–¹æ³• éš¾ä»¥å®ç°ä»£ç æ‹†åˆ† æ²¡æœ‰å†…ç½®çš„å¼‚æ­¥æ”¯æŒ æ­¤æ—¶æˆ‘ä»¬éœ€è¦ä¸€ä¸ªæ›´åŠ è½»å·§æ–¹ä¾¿çš„çŠ¶æ€åº“è§£å†³å®ƒï¼šRecoil æ˜¯ React çš„çŠ¶æ€ç®¡ç†åº“ å®ƒçš„åº•å±‚é€»è¾‘è¿˜æ˜¯ä¸€ä¸ª context åŠ ä¸Šå„ç§çŠ¶æ€æ›´æ–° ä¼˜ç‚¹å°±æ˜¯ååˆ†æ–¹ä¾¿ï¼Œæˆ‘ä»¬å¯ä»¥åƒä½¿ç”¨useStateä¸€æ ·ä½¿ç”¨å®ƒï¼Œé€‚åº”ç°åœ¨çš„ç®€æ´å¼ç¼–ç é£æ°”ï¼Œè€Œä¸”æ²¡æœ‰reduxé‚£ç§å¯èƒ½ä¼šå½±å“å…¶ä»–ç›¸å…³ç»„ä»¶é‡æ–°æ¸²æŸ“é—®é¢˜ï¼›ç¼ºç‚¹æ˜¯SSRåœºæ™¯çš„çŠ¶æ€å…±äº«å¥½åƒæœ‰ç‚¹é—®é¢˜ npm install recoil yarn add recoil å¯¼åŒ…ï¼š import { RecoilRoot, atom, selector, useRecoilState, useRecoilValue, } from 'recoil'; é¦–å…ˆè¦åŒ…è£¹ä½æœ€å¤–å±‚çš„Appç»„ä»¶ import React from 'react'; function App() { return ( &lt;RecoilRoot> &lt;CharacterCounter /> &lt;/RecoilRoot> ); } ä¸€ä¸ª atom ä»£è¡¨ä¸€ä¸ªçŠ¶æ€ã€‚Atom å¯åœ¨ä»»æ„ç»„ä»¶ä¸­è¿›è¡Œè¯»å†™ã€‚è¯»å– atom å€¼çš„ç»„ä»¶éšå¼è®¢é˜…äº†è¯¥ atomï¼Œå› æ­¤ä»»ä½• atom çš„æ›´æ–°éƒ½å°†è‡´ä½¿ä½¿ç”¨å¯¹åº” atom çš„ç»„ä»¶é‡æ–°æ¸²æŸ“ï¼š const textState = atom({ key: 'textState', // unique ID (with respect to other atoms/selectors) default: '', // default value (aka initial value) }); ä½¿ç”¨èµ·æ¥å’ŒuseStateä¸€æ ·ï¼Œå¾ˆæ–¹ä¾¿ï¼Œå…é™¤äº†reduxå†™æ³•çš„çƒ¦æ¼ const [text, setText] = useRecoilState(textState); å¦‚æœå¯¹äºatom çŠ¶æ€åªè¯»ï¼ˆåœ¨ç»„ä»¶ä¸­ç›´æ¥åƒçŠ¶æ€ä¸€æ ·å»ä½¿ç”¨ï¼‰ï¼Œæˆ–è€…åªå†™ï¼Œå¯ä»¥ä½¿ç”¨ const todoList = useRecoilValue(todoListState); const setTodoList = useSetRecoilState(todoListState); const addItem = () => { setTodoList((oldTodoList) => [ ...oldTodoList, { id: getId(), text: inputValue, isComplete: false, }, ]); setInputValue(''); }; selector åœ¨æ–‡æ¡£ä¸­è¿˜æœ‰ä¸€ä¸ªselectorï¼Œæœ‰ç‚¹ç±»ä¼¼äºè®¡ç®—å±æ€§ï¼Œå®ƒè¿˜æœ‰ä¾èµ–é¡¹ï¼Œä½¿ç”¨æ–¹æ³•å¯ä»¥åœ¨å®˜ç½‘æŸ¥çœ‹ react-infinite-scroll-componentreactæä¾›çš„æ— é™æ»šåŠ¨æ–¹æ¡ˆï¼Œå®˜æ–¹æ–‡æ¡£ usage &lt;InfiniteScroll dataLength={items.length} //This is important field to render the next data next={fetchData} hasMore={true} loader={&lt;h4>Loading...&lt;/h4>} endMessage={ &lt;p style={{ textAlign: 'center' }}> &lt;b>Yay! You have seen it all&lt;/b> &lt;/p> } // below props only if you need pull down functionality refreshFunction={this.refresh} pullDownToRefresh pullDownToRefreshThreshold={50} pullDownToRefreshContent={ &lt;h3 style={{ textAlign: 'center' }}>&amp;#8595; Pull down to refresh&lt;/h3> } releaseToRefreshContent={ &lt;h3 style={{ textAlign: 'center' }}>&amp;#8593; Release to refresh&lt;/h3> } > {items} &lt;/InfiniteScroll> React SSRCSR æ¨¡å¼ä¸‹ï¼Œæˆ‘ä»¬æŠŠæ°´ç†è§£ä¸ºæ•°æ®ï¼ŒåŒæ ·é€‚ç”¨äº SSRï¼Œåªæ˜¯è¿‡ç¨‹ç¨å¤æ‚äº›ï¼š æœåŠ¡ç«¯æ¸²æŸ“ï¼šåœ¨æœåŠ¡ç«¯æ³¨å…¥æ•°æ®ï¼Œæ„å»ºå‡ºç»„ä»¶æ ‘ åºåˆ—åŒ–æˆ HTMLï¼šè„±æ°´æˆäººå¹² å®¢æˆ·ç«¯æ¸²æŸ“ï¼šåˆ°è¾¾å®¢æˆ·ç«¯åæ³¡æ°´ï¼Œæ¿€æ´»æ°´æµï¼Œå˜å›æ´»äºº ç±»æ¯”ä¸‰ä½“äººçš„ç”Ÿå­˜æ¨¡å¼ï¼Œä¹±çºªå…ƒæ¥ä¸´æ—¶å…ˆè„±æ°´æˆäººå¹²ï¼ˆSSR ä¸­çš„æœåŠ¡ç«¯æ¸²æŸ“éƒ¨åˆ†ï¼‰ï¼Œæ’çºªå…ƒåˆ°æ¥åå†æ³¡æ°´å¤æ´»ï¼ˆSSR ä¸­çš„å®¢æˆ·ç«¯ hydrate éƒ¨åˆ†ï¼‰ å‚è€ƒï¼šhttps://juejin.cn/post/6901089942580150280","categories":[{"name":"å‰ç«¯","slug":"å‰ç«¯","permalink":"https://taylor12138.github.io/categories/%E5%89%8D%E7%AB%AF/"}],"tags":[],"author":"Hello"},{"title":"Echarts","slug":"Echarts","date":"2022-03-26T05:13:35.297Z","updated":"2022-03-26T05:13:35.297Z","comments":true,"path":"2022/03/26/echarts/","link":"","permalink":"https://taylor12138.github.io/2022/03/26/echarts/","excerpt":"","text":"Echarts.jsEchart.jsï¼Œå®ƒæ˜¯ç”±ç™¾åº¦å…¬å¸å¼€å‘çš„ä¸€ä¸ªä½¿ç”¨JavaScriptå®ç°çš„å¼€æºå¯è§†åŒ–åº“ï¼ˆåŒæ—¶ä¹Ÿæœ‰D3.jsï¼Œå®ƒæ˜¯å›½å¤–çš„å¯è§†åŒ–åº“ï¼‰ï¼Œå…¼å®¹æ€§å¼ºï¼Œåº•å±‚ä¾èµ–è½»é‡çº§çš„ Canvas ç±»åº“ ZRenderï¼Œå¯é«˜åº¦ä¸ªæ€§åŒ–å®šåˆ¶æ•°æ®å¯è§†åŒ–å›¾è¡¨ï¼ˆç§»åŠ¨ç«¯pcç«¯éƒ½å…¼å®¹ï¼‰ å®‰è£…ï¼š npm install echarts --save å®˜ç½‘ï¼šhttps://echarts.apache.org/zh/index.html å‰ç«¯å¯è§†åŒ–å·¥å…·å¸¸è§å·¥å…·ï¼šEChartsã€g2ã€d3ã€visã€hightChartç­‰ g2æ¡†æ¶å°è£…ï¼šbizchartsï¼ˆreactï¼‰ã€viserï¼ˆvueï¼‰ åœ°ç†å¯è§†åŒ– ï¼šg2ã€L7ã€é«˜å¾·çš„locaã€èœé¸Ÿçš„é¸Ÿå›¾ 3Då¯è§†åŒ–ï¼šthree.js ä½¿ç”¨æ­¥éª¤ å¼•å…¥Echartsæ–‡ä»¶ å¯ä»¥é€šè¿‡å¯¼å…¥ import * as echarts from 'echarts' ä¹Ÿå¯ä»¥ç›´æ¥æ”¾åœ¨å…¨å±€ï¼Œç›´æ¥ä½¿ç”¨ Vue.prototype.$echarts = window.echarts å‡†å¤‡å‘ˆç°å›¾è¡¨çš„ç›’å­ï¼ˆä¸€å®šè¦æœ‰å®½é«˜ï¼Œæ¯”å¦‚width: 600px; height: 400pxï¼‰ åˆå§‹åŒ–echartså¯¹è±¡ initæ–¹æ³•ï¼š (dom: HTMLDivElement|HTMLCanvasElement, theme?: Object|string, opts?: { devicePixelRatio?: number, renderer?: string, useDirtyRect?: boolean, // ä» `v5.0.0` å¼€å§‹æ”¯æŒ width?: number|string, height?: number|string, locale?: string }) => ECharts åˆ›å»ºä¸€ä¸ª ECharts å®ä¾‹ï¼Œè¿”å› echartsInstanceï¼Œä¸èƒ½åœ¨å•ä¸ªå®¹å™¨ä¸Šåˆå§‹åŒ–å¤šä¸ª ECharts å®ä¾‹ã€‚ å‚æ•° dom å®ä¾‹å®¹å™¨ï¼Œä¸€èˆ¬æ˜¯ä¸€ä¸ªå…·æœ‰é«˜å®½çš„divå…ƒç´ ã€‚ æ³¨ï¼šå¦‚æœdivæ˜¯éšè—çš„ï¼ŒECharts å¯èƒ½ä¼šè·å–ä¸åˆ°divçš„é«˜å®½å¯¼è‡´åˆå§‹åŒ–å¤±è´¥ï¼Œè¿™æ—¶å€™å¯ä»¥æ˜ç¡®æŒ‡å®šdivçš„style.widthå’Œstyle.heightï¼Œæˆ–è€…åœ¨divæ˜¾ç¤ºåæ‰‹åŠ¨è°ƒç”¨ echartsInstance.resize è°ƒæ•´å°ºå¯¸ã€‚ ECharts 3 ä¸­æ”¯æŒç›´æ¥ä½¿ç”¨canvaså…ƒç´ ä½œä¸ºå®¹å™¨ï¼Œè¿™æ ·ç»˜åˆ¶å®Œå›¾è¡¨å¯ä»¥ç›´æ¥å°† canvas ä½œä¸ºå›¾ç‰‡åº”ç”¨åˆ°å…¶å®ƒåœ°æ–¹ï¼Œä¾‹å¦‚åœ¨ WebGL ä¸­ä½œä¸ºè´´å›¾ï¼Œè¿™è·Ÿä½¿ç”¨ echartsInstance.getDataURL ç”Ÿæˆå›¾ç‰‡é“¾æ¥ç›¸æ¯”å¯ä»¥æ”¯æŒå›¾è¡¨çš„å®æ—¶åˆ·æ–°ã€‚ theme åº”ç”¨çš„ä¸»é¢˜ã€‚å¯ä»¥æ˜¯ä¸€ä¸ªä¸»é¢˜çš„é…ç½®å¯¹è±¡ï¼Œä¹Ÿå¯ä»¥æ˜¯ä½¿ç”¨å·²ç»é€šè¿‡ echarts.registerTheme æ³¨å†Œçš„ä¸»é¢˜åç§°ã€‚å‚è§ ECharts ä¸­çš„æ ·å¼ç®€ä»‹ã€‚ opts é™„åŠ å‚æ•°ã€‚æœ‰ä¸‹é¢å‡ ä¸ªå¯é€‰é¡¹ï¼š devicePixelRatio è®¾å¤‡åƒç´ æ¯”ï¼Œé»˜è®¤å–æµè§ˆå™¨çš„å€¼window.devicePixelRatioã€‚ renderer æ¸²æŸ“å™¨ï¼Œæ”¯æŒ &#39;canvas&#39; æˆ–è€… &#39;svg&#39;ã€‚å‚è§ ä½¿ç”¨ Canvas æˆ–è€… SVG æ¸²æŸ“ã€‚ useDirtyRect æ˜¯å¦å¼€å¯è„çŸ©å½¢æ¸²æŸ“ï¼Œé»˜è®¤ä¸ºfalseã€‚å‚è§ ECharts 5 æ–°ç‰¹æ€§ã€‚ width å¯æ˜¾å¼æŒ‡å®šå®ä¾‹å®½åº¦ï¼Œå•ä½ä¸ºåƒç´ ã€‚å¦‚æœä¼ å…¥å€¼ä¸º null/undefined/&#39;auto&#39;ï¼Œåˆ™è¡¨ç¤ºè‡ªåŠ¨å– domï¼ˆå®ä¾‹å®¹å™¨ï¼‰çš„å®½åº¦ã€‚ height å¯æ˜¾å¼æŒ‡å®šå®ä¾‹é«˜åº¦ï¼Œå•ä½ä¸ºåƒç´ ã€‚å¦‚æœä¼ å…¥å€¼ä¸º null/undefined/&#39;auto&#39;ï¼Œåˆ™è¡¨ç¤ºè‡ªåŠ¨å– domï¼ˆå®ä¾‹å®¹å™¨ï¼‰çš„é«˜åº¦ã€‚ locale ä½¿ç”¨çš„è¯­è¨€ï¼Œå†…ç½® &#39;ZH&#39; å’Œ &#39;EN&#39; ä¸¤ä¸ªè¯­è¨€ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ echarts.registerLocale æ–¹æ³•æ³¨å†Œæ–°çš„è¯­è¨€åŒ…ã€‚ç›®å‰æ”¯æŒçš„è¯­è¨€è§ src/i18nã€‚ å¦‚æœä¸æŒ‡å®šä¸»é¢˜ï¼Œä¹Ÿéœ€åœ¨ä¼ å…¥optså‰å…ˆä¼ å…¥nullï¼Œå¦‚ï¼š const chart = echarts.init(dom, null, {renderer: 'svg'}); å‡†å¤‡é…ç½®é¡¹ å°†é…ç½®è®¾ç½®ç»™echartså®ä¾‹å¯¹è±¡ï¼ˆé…ç½®æ˜¯å¯ä»¥è®¾ç½®å¤šæ¬¡ï¼Œå åŠ è®¾ç½®ï¼Œè¿™æ ·å¯ä»¥åˆ†ç¦»æ•°æ®çš„ä»£ç å’Œåˆå§‹åŒ–çš„ä»£ç ï¼‰ import * as echarts from 'echarts'; // åŸºäºå‡†å¤‡å¥½çš„domï¼Œåˆå§‹åŒ–echartså®ä¾‹(å¦‚æœæ˜¯vueåˆ™ç”¨refè·å–) var myChart = echarts.init(document.getElementById('main')); // ç»˜åˆ¶å›¾è¡¨ myChart.setOption({ //æ ‡é¢˜ title: { text: 'ECharts å…¥é—¨ç¤ºä¾‹' }, //é€šç”¨é…ç½®ï¼Œå¯è®¾ç½®å¯¹å›¾è¡¨æ¥è§¦äº‹ä»¶ tooltip: { //é»˜è®¤mousemoveï¼Œç§»åŠ¨åˆ°æ¯ä¸€é¡¹è§¦å‘å…‰æ ‡å’Œè¯¦æƒ…ä¿¡æ¯ trigger:'item', //è®¾ç½®åè¦clickï¼Œç‚¹å‡»æ‰ä¼šæœ‰ä¿¡æ¯æç¤º triggerOn:'click' }, //å·¥å…·æ ï¼Œé‡Œé¢æœ‰å¾ˆå¤šå¥½ç”¨çš„å·¥å…· toolbox:{ feature:{ //å¯ä»¥ç›´æ¥åˆ°å¯¼å‡ºå›¾ç‰‡çš„åŠŸèƒ½ saveAsImage:{} } } //xè½´ xAxis: { type: \"category\", data: ['è¡¬è¡«', 'ç¾Šæ¯›è¡«', 'é›ªçººè¡«', 'è£¤å­', 'é«˜è·Ÿé‹', 'è¢œå­'] }, //yè½´ yAxis: { type: \"value\", scale:true //è®©æ•°æ®ä¸ä¼šä»0å¼€å§‹ }, //ç³»åˆ—åˆ—è¡¨ï¼Œé€šè¿‡typeå†³å®šå›¾è¡¨ç±»å‹ï¼Œå¯ä»¥æœ‰å¤šä¸ªå¯¹è±¡ series: [{ name: 'é”€é‡', type: 'bar', data: [5, 20, 36, 10, 10, 20] }] }); è½´çš„typeï¼š category ç±»ç›®è½´ valueæ•°å€¼è½´ï¼ˆä¸€èˆ¬ä¸ºæ•°å€¼è½´åˆ™ä¸ç”¨è®¾ç½®dataå±æ€§ï¼Œå®ƒä¼šå»å¦ä¸€ä¸ªè½´æ¯ä¸ªç±»åˆ«å–seriesæ‰¾åˆ°å¯¹åº”çš„æ•°æ®ï¼‰ ç³»åˆ—è¡¨çš„typeï¼šlineï¼ˆæŠ˜çº¿å›¾ï¼‰ã€barï¼ˆæŸ±çŠ¶å›¾ï¼‰ã€pieï¼ˆé¥¼å›¾ï¼‰ã€scatterï¼ˆæ•£ç‚¹å›¾ï¼‰ã€graphï¼ˆå…³ç³»å›¾ï¼‰ã€treeï¼ˆæ ‘å›¾ï¼‰ æŠ˜çº¿å›¾æ•°æ®æ›²çº¿å¹³æ»‘ï¼šsmooth:true æ•£ç‚¹å›¾ã€æ¶Ÿæ¼ªæ•£ç‚¹å›¾ï¼ˆeffectScatterï¼‰ éœ€è¦äºŒç»´æ•°ç»„é…åˆä½¿ç”¨ é¥¼å›¾çš„æ•°æ®ï¼š{name:&#39;allen&#39;, value:100}ï¼Œä¸éœ€è¦xè½´ã€yè½´ mapåœ°å›¾çš„tooltipï¼šæç¤ºæ¡†ç»„ä»¶ï¼Œå¯åœ¨é‡Œé¢è¿›è¡Œä¿®æ”¹ï¼Œå¾—åˆ°æç¤ºçš„å†…å®¹ä¸åŒ æ›´å¤šé…ç½®é¡¹è¯¦æƒ…æŸ¥çœ‹å®˜æ–¹æ–‡æ¡£ ä¸€ä¸ªå¾ˆæœ‰è¶£çš„echartså›¾è¡¨å®ä¾‹https://echarts.apache.org/examples/zh/editor.html?c=bar-race-country è¿˜æœ‰äº›echats5æ–°ç‰¹æ€§ï¼šå®ç°å›¾è¡¨è·¨ç³»åˆ—çš„å½¢å˜åŠ¨ç”»ï¼Œæ›´åŠ é…·ç‚«ï¼ å›¾å½¢åŸç†Echartsä½¿ç”¨ä¸€ä¸ªåä¸º zrender çš„æ¸²æŸ“å¼•æ“æ¥ç®¡ç†æ¸²æŸ“å…ƒç´ ï¼Œå¹¶ä»¥é€šç”¨çš„æ–¹å¼æ¸²æŸ“åˆ°ä¸åŒçš„å¹³å° ZRenderï¼šäºŒç»´çŸ¢é‡åº“Zrenderï¼Œç”¨äºå›¾å½¢å…ƒç´ ç®¡ç†ã€æ¸²æŸ“å™¨ç®¡ç†å’Œäº‹ä»¶ç³»ç»Ÿã€‚å®ƒæ”¯æŒå¤šç§æ¸²æŸ“åç«¯ï¼ŒåŒ…æ‹¬canvasã€svgå’Œvmlã€‚ Echartsæœ€åˆé‡‡ç”¨canvasç»˜åˆ¶å›¾è¡¨ï¼Œä½†æ˜¯ä»Echarts4.xå¼€å§‹ï¼Œå‘å¸ƒäº†SVGæ¸²æŸ“å™¨ï¼Œæä¾›äº†å¦å¤–ä¸€ç§æ¸²æŸ“æ–¹å¼ Echartsçš„SVG VS Canvas çŸ¥ä¹ä¸Šçš„ç»“è®ºå¤§å›¾ ç»¿è‰²è¡¨ç¤ºæ¨èä½¿ç”¨ SVGï¼Œçº¢è‰²è¡¨ç¤ºæ¨èä½¿ç”¨ Canvasï¼Œâ†‘ç®­å¤´è¶Šå¤šè¡¨ç¤ºæ¨èç¨‹åº¦è¶Šå¼ºçƒˆ ä½¿ç”¨SVG ç§»åŠ¨å¹³å°ä¼˜é€‰ SVG å›¾è¡¨ä¸ªæ•°å¾ˆå¤šæ—¶ä¼˜é€‰ SVG å¯¼å‡ºå°æ–‡ä»¶é«˜æ¸…æ™°æ—¶ä½¿ç”¨ SVG ä½¿ç”¨Canvas éƒ¨åˆ†ç‰¹æ®Šæ¸²æŸ“æ•ˆæœåªæœ‰ Canvas æ”¯æŒ é™¤äº†æŸäº›ç‰¹æ®Šçš„æ¸²æŸ“å¯èƒ½ä¾èµ– Canvasï¼šå¦‚ç‚«å…‰å°¾è¿¹ç‰¹æ•ˆã€å¸¦æœ‰æ··åˆæ•ˆæœçš„çƒ­åŠ›å›¾ç­‰ï¼Œç»å¤§éƒ¨åˆ†åŠŸèƒ½ SVG éƒ½æ˜¯æ”¯æŒçš„ã€‚æ­¤å¤–ï¼Œç›®å‰çš„ SVG ç‰ˆä¸­ï¼Œå¯Œæ–‡æœ¬ã€æè´¨åŠŸèƒ½å°šæœªå®ç°ã€‚ æ•°æ®é‡ç‰¹åˆ«å¤§æ—¶æ¨èä½¿ç”¨ Canvas æ¸²æŸ“ çŸ¥ä¹åœ°å€ï¼šhttps://zhuanlan.zhihu.com/p/33093211","categories":[{"name":"å‰ç«¯","slug":"å‰ç«¯","permalink":"https://taylor12138.github.io/categories/%E5%89%8D%E7%AB%AF/"}],"tags":[],"author":"Hello"},{"title":"Threejs(ä¸Š)","slug":"Threejs(ä¸Š)","date":"2022-03-19T16:00:00.000Z","updated":"2023-06-11T17:05:46.261Z","comments":true,"path":"2022/03/20/threejs-shang/","link":"","permalink":"https://taylor12138.github.io/2022/03/20/threejs-shang/","excerpt":"","text":"1.threejsç®€ä»‹WebGLWebGLï¼ˆå…¨å†™Web Graphics Libraryï¼‰å­—é¢æ„ä¹‰ç†è§£å°±æ˜¯webå›¾åƒåº“.æ˜¯ä¸€ç§3Dç»˜å›¾åè®®ï¼Œç§ç»˜å›¾æŠ€æœ¯æ ‡å‡†å…è®¸æŠŠJavaScriptå’ŒOpenGL ES 2.0ç»“åˆåœ¨ä¸€èµ·ï¼Œé€šè¿‡å¢åŠ OpenGL ES 2.0çš„ä¸€ä¸ªJavaScriptç»‘å®š å½“ç„¶ä¹Ÿå¯ä»¥è¯´æ˜¯ä¸€ä¸ªè´Ÿè´£å›¾å½¢å¤„ç†çš„JavaScript APIï¼Œå¯åœ¨ä»»ä½•å…¼å®¹çš„Webæµè§ˆå™¨ä¸­æ¸²æŸ“é«˜æ€§èƒ½çš„äº¤äº’å¼3Då’Œ2Då›¾å½¢ï¼Œè€Œæ— éœ€ä½¿ç”¨æ’ä»¶.æ€»ç»“ä¸€å¥è¯,â€œwebglæ˜¯ä¸€ä¸ªä¸“é—¨è®¡ç®—æˆ–æ¸²æŸ“3Då›¾åƒçš„javascriptAPIä¹Ÿå¯ä»¥ç§°ä¹‹ä¸ºä¸“é—¨å¤„ç†3Då›¾åƒçš„ä¸€ç§javaScriptæŠ€æœ¯â€ï¼ WEBGL VS canvas VS SVG SVG:æœ¬èº«æœƒè®Šæˆç€è¦½å™¨ DOMã€‚å„ªé»æ˜¯æ–¹ä¾¿äº¤äº’ï¼Œç¼ºé»æ˜¯å› ç‚ºæ¯ä¸€å€‹ SVG å…ƒç´ éƒ½æ˜¯ä¸€å€‹ DOM å…ƒç´ ï¼Œç¹ªè£½æˆ–ç§»å‹•ä¸€å€‹ SVG å…ƒç´ ï¼Œç€è¦½å™¨éƒ½éœ€è¦é‡æ–°ç¹ªè£½ã€æ¸²æŸ“é é¢ canvas: ä¸æ¶‰åŠ DOM å…ƒç´ ï¼Œå’Œ SVG ç¹ªè£½çš„å…ƒç´ ç›¸æ¯”ï¼Œäº¤äº’æ€§å·®ï¼Œä½†ä¹Ÿæ­£å› å¦‚æ­¤ï¼Œåœ¨å…ƒç´ è‡ªèº«çš„å‹•ç•«ç‰¹æ•ˆä¸Šä¸å— DOM ä½ç½®é™åˆ¶ï¼Œåœ¨ç€è¦½å™¨æ€§èƒ½ï¼ˆè¼‰å…¥é€Ÿåº¦ï¼‰ä¸Šæ¯” SVG æ›´ä½³ã€‚ WebGL:WebGL é€šé WebGL JS API é€£æ¥ Javascript å’Œ GPU ç·¨è­¯ç¨‹åºã€‚GPU ç¹ªåœ–çš„æ¸²æŸ“å¤§éƒ¨åˆ†åœ¨ GPU ä¸Šé€²è¡Œï¼Œå°ç€è¦½å™¨å£“åŠ›æ¸›å°ï¼Œæ€§èƒ½å¹¾å€‹é‡ç´šåœ°æé«˜ï¼Œä½¿ WebGL æˆç‚ºç€è¦½å™¨å…§çš„3Dæ¸²æŸ“ã€å¤§æ•¸æ“šå¯è¦–åŒ–å”¯ä¸€çš„é¸æ“‡ã€‚ threejsæ¦‚è¿°éšç€WebGLåœ¨2011å¹´æ¨å‡ºä¹‹åï¼Œ3dæŠ€æœ¯æ­£å¼å‘é«˜çº§ç¼–ç¨‹è¯­è¨€jsæ•å¼€å¤§é—¨ threejsæ˜¯åŸºäºåŸç”ŸwebGLå°è£…è¿è¡Œçš„ä¸‰ç»´å¼•æ“ï¼Œåœ¨æ‰€æœ‰webGLå¼•æ“ä¸­ï¼Œthreejsæ˜¯å›½å†…èµ„æ–™æœ€å¤šï¼Œä½¿ç”¨æœ€å¹¿æ³›çš„ä¸‰ç»´å¼•æ“ å¹¶ä¸”Threejsä¼šé€‰æ‹©æ€§æ¸²æŸ“ï¼Œåªæ¸²æŸ“å±å¹•å½“å‰å‡ºç°çš„Object3D å®˜ç½‘ï¼šhttps://threejs.org/ GitHubï¼šhttps://github.com/mrdoob/three.js ä¸€ä¸ªç‚«é…·çš„threejsç½‘ç«™æ¨èhttps://lusion.co/ï¼›å½“ç„¶å®˜ç½‘ä¹Ÿæœ‰å¾ˆå¤šthreejsçš„æ¡ˆä¾‹ç½‘ç«™ threejsæ•™å­¦ï¼š Three.js Fundamentals Three.js Journey Learn Three.js åˆã‚ã¦ã®Three.js æ³•å›½threejsé«˜çº§å¼€å‘å·¥ç¨‹å¸ˆBruno Simonçš„æ•™å­¦è§†é¢‘ threejsç¨‹åºç»“æ„ åœºæ™¯ ç½‘ç»œæ¨¡å‹ å…‰ç…§ ç›¸æœº ä½ç½® è§†çº¿æ–¹å‘ æŠ•å½±æ–¹å¼ æ¸²æŸ“å™¨ æ¸²æŸ“å™¨åˆ›å»º æ¸²æŸ“å™¨æ¸²æŸ“ domElementå±æ€§ ç¬”è€…æ„Ÿå—æ„Ÿè§‰threejså¾ˆçµæ´»ï¼Œåƒjsä¸€æ ·ï¼Œåˆå¾ˆç»†è‡´ï¼Œä½ å¯ä»¥çµæ´»æŠŠä¸€ä¸ªç‰©å“æ‹†åˆ†æˆè®¸å¤šä¸ªå•ç‹¬çš„èŠ‚ç‚¹ï¼Œä½ ç”šè‡³å¯ä»¥æŠŠä¸€æ ¹æ‰‹æŒ‡æ‹†æˆä¸‰ä¸ªèŠ‚ç‚¹ï¼Œå¯¹å…¶è¿›è¡Œä¸åŒæ›²ç‡å¯¹åº”çš„rotationè®¡ç®—ï¼Œæ¢ç®—ä¸‹æ¥ä¸€åªæ‰‹éƒ½å¯ä»¥æœ‰å‡ åç”šè‡³å‡ ç™¾ä¸ªèŠ‚ç‚¹æ¥æ“æ§ã€‚è¿™é‡Œæœ‰ä¸€ä¸ªå¦å…‹çš„ä¾‹å­ï¼šhttps://threejs.org/manual/#zh/scenegraph ç»†çš„ç¼ºç‚¹å°±æ˜¯éº»çƒ¦ï¼Œæ²¡æœ‰å°è£…å¥½çš„ä¸œè¥¿ï¼Œçµæ´»å’Œä¾¿æ·æ€»æ˜¯ç›¸å¯¹çš„ï¼Œå¹¶ä¸”è¿˜éœ€è¦ä¸€äº›å›¾å½¢å­¦çš„çŸ¥è¯† å›¾ç‰‡è¦æ±‚threejsç”¨åˆ°çš„ä¸€äº›å›¾ï¼Œå‡ºäº†ä¸€äº›æ™®é€šå›¾ç‰‡ï¼Œè¿˜æœ‰æ—¶å€™éœ€è¦å¯ä»¥æœ¬èº«è¦è°ƒèŠ‚å…‰äº®çš„å›¾ç‰‡ï¼ˆä½¿ç”¨HDRçš„å›¾ç‰‡ï¼‰ HDRå›¾ï¼šé«˜åŠ¨æ€èŒƒå›´å›¾åƒ(High-Dynamic Rangeï¼Œç®€ç§°HDR)ï¼Œç›¸æ¯”æ™®é€šçš„å›¾åƒï¼Œå¯ä»¥æä¾›æ›´å¤šçš„åŠ¨æ€èŒƒå›´å’Œå›¾åƒç»†èŠ‚ï¼Œæ ¹æ®ä¸åŒçš„æ›å…‰æ—¶é—´çš„LDR(Low-Dynamic Range)å›¾åƒï¼Œåˆ©ç”¨æ¯ä¸ªæ›å…‰æ—¶é—´ç›¸å¯¹åº”æœ€ä½³ç»†èŠ‚çš„LDRå›¾åƒæ¥åˆæˆæœ€ç»ˆHDRå›¾åƒï¼Œèƒ½å¤Ÿæ›´å¥½çš„åæ˜ å‡ºçœŸå®ç¯å¢ƒä¸­çš„è§†è§‰æ•ˆæœã€‚ è¿™é‡Œæœ‰ä¸ªHDRå›¾æ¨èç½‘å€ï¼šhttps://polyhaven.com/ å®‰è£…é¡¹ç›®ä¸­å®‰è£… npm i three æ¨èå·¥å…·threejså‚æ•°ä¼—å¤šå—ï¼Œä½†ä¸å›¾å½¢å­¦èƒ½åŠ›ä¸å¥½çš„åŒå­¦å»ºè®®é…åˆä¸Š Dat.gui å·¥å…· æ‹¼å‘½è°ƒæ•´å‚æ•°ï¼Œè¾¾åˆ°è‡ªå·±æƒ³è¦çš„æ•ˆæœ WebGLå…¼å®¹æ€§æ£€æŸ¥ï¼ˆWebGL compatibility checkï¼‰ è™½ç„¶è¿™ä¸ªé—®é¢˜ç°åœ¨å·²ç»å˜å¾—è¶Šæ¥ä¸æ˜æ˜¾ï¼Œä½†ä¸å¯å¦å®šçš„æ˜¯ï¼ŒæŸäº›è®¾å¤‡ä»¥åŠæµè§ˆå™¨ç›´åˆ°ç°åœ¨ä»ç„¶ä¸æ”¯æŒWebGLã€‚ä»¥ä¸‹çš„æ–¹æ³•å¯ä»¥å¸®åŠ©ä½ æ£€æµ‹å½“å‰ç”¨æˆ·æ‰€ä½¿ç”¨çš„ç¯å¢ƒæ˜¯å¦æ”¯æŒWebGLï¼Œå¦‚æœä¸æ”¯æŒï¼Œå°†ä¼šå‘ç”¨æˆ·æç¤ºä¸€æ¡ä¿¡æ¯ã€‚ è¯·å°†https://github.com/mrdoob/three.js/blob/master/examples/jsm/capabilities/WebGL.jså¼•å…¥åˆ°ä½ çš„æ–‡ä»¶ï¼Œå¹¶åœ¨å°è¯•å¼€å§‹æ¸²æŸ“ä¹‹å‰å…ˆè¿è¡Œè¯¥æ–‡ä»¶ã€‚ if (WebGL.isWebGLAvailable()) { // Initiate function or other initializations here animate(); } else { const warning = WebGL.getWebGLErrorMessage(); document.getElementById(&#39;container&#39;).appendChild(warning); }2.åˆå§‹startä¸ºäº†çœŸæ­£èƒ½å¤Ÿè®©ä½ çš„åœºæ™¯å€ŸåŠ©three.jsæ¥è¿›è¡Œæ˜¾ç¤ºï¼Œæˆ‘ä»¬éœ€è¦ä»¥ä¸‹å‡ ä¸ªå¯¹è±¡ï¼šåœºæ™¯ã€ç›¸æœºå’Œæ¸²æŸ“å™¨ï¼Œè¿™æ ·æˆ‘ä»¬å°±èƒ½é€è¿‡æ‘„åƒæœºæ¸²æŸ“å‡ºåœºæ™¯ã€‚ const scene = new THREE.Scene(); const camera = new THREE.PerspectiveCamera( 75, window.innerWidth / window.innerHeight, 0.1, 1000 ); //ä¸€èˆ¬å¯ä»¥è®¾ç½®ä¸º75Â°ã€45Â°çš„è§’åº¦ç­‰ const renderer = new THREE.WebGLRenderer(); renderer.setSize( window.innerWidth, window.innerHeight ); //æœ€åå†æ·»åŠ åˆ°æ–‡æ¡£ä¸­ document.body.appendChild( renderer.domElement ); //å½“ç„¶è¿˜å¯ä»¥åœ¨åˆ›å»ºæ¸²æŸ“å™¨çš„æ—¶å€™ æ·»åŠ è¿›ducoment const canvas = document.querySelector('.mycanvas'); const renderer = new THREE.WebGLRenderer({ canvas }); è®©æˆ‘ä»¬æ­å»ºç¬¬ä¸€ä¸ªå°æ¡ˆä¾‹å§ è¾…åŠ©å·¥å…·ç”¨äºè¾…åŠ©æ‰¾åˆ°ç©ºé—´æ„Ÿè§‰çš„è¾…åŠ©å·¥å…· //æ˜¾ç¤ºä¸‰ç»´åæ ‡ç³» // çº¢è‰²ä¸ºxè½´ã€ç»¿è‰²ä¸ºyè½´ã€è“è‰²ä¸ºzè½´ const axes = new THREE.AxisHelper(20) //æ–°ç‰ˆæœ¬æ˜¯ const axesHelper = new THREE.AxesHelper(20);ï¼Œä¼ å…¥çš„å‚æ•°ä¸ºåæ ‡è½´é•¿åº¦ //æ·»åŠ åˆ°åœºæ™¯ä¸­ scene.add(axes) å½“ç„¶è¿˜æœ‰ä¸åŒçš„helperï¼Œæ¯”å¦‚CameraHelperã€DirectionalLightHelper ç­‰ï¼Œéƒ½æ˜¯å®˜æ–¹çš„è¾…åŠ©å·¥å…·ï¼Œå¯ä»¥åœ¨å®˜ç½‘ä¸­æ‰¾åˆ°å¯¹åº”çš„helperè¿›è¡Œè°ƒè¯• ç”¨äºæŸ¥çœ‹å¸§æ•°ç­‰æ€§èƒ½ç›¸å…³çš„å·¥å…· import Stats from 'three/examples/jsm/libs/stats.module' const stats = Stats(); document.body.appendChild(stats.dom); renderer.setAnimationLoop(() => { renderer.render(scene, camera); stats.update(); }); debugå·¥å…· å¯ä»¥å»æˆ‘çš„ã€ŠåŠ¨ç”»è¾…åŠ©å·¥å…·ã€‹blogæŸ¥çœ‹ ä¸‰å¤§è¦ç´ (1)ç›¸æœºthree.jsé‡Œæœ‰å‡ ç§ä¸åŒçš„ç›¸æœºï¼Œåœ¨è¿™é‡Œï¼Œæˆ‘ä»¬ä½¿ç”¨çš„æ˜¯PerspectiveCameraï¼ˆé€è§†æ‘„åƒæœºï¼‰ã€‚ è¿™ä¸ªç›¸æœºçš„ç‰¹ç‚¹æ˜¯èƒ½å°†åœºæ™¯ä¸­çš„ç‰©ä½“è¿›è¡Œè¿›å¤§è¿œå°çš„æ¸²æŸ“ const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000); ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯è§†é‡è§’åº¦ï¼ˆFOVï¼‰ã€‚è§†é‡è§’åº¦å°±æ˜¯æ— è®ºåœ¨ä»€ä¹ˆæ—¶å€™ï¼Œä½ æ‰€èƒ½åœ¨æ˜¾ç¤ºå™¨ä¸Šçœ‹åˆ°çš„åœºæ™¯çš„èŒƒå›´ï¼Œå®ƒçš„å•ä½æ˜¯è§’åº¦(ä¸å¼§åº¦åŒºåˆ†å¼€)ï¼Œä¸€èˆ¬45ã€75æ¯”è¾ƒå¤šï¼Œ75æœ€å¤šï¼Œå› ä¸ºæ¯”è¾ƒæ¥è¿‘äººçœ¼èƒ½çœ‹åˆ°çš„è§’åº¦èŒƒå›´ã€‚ ç¬¬äºŒä¸ªå‚æ•°æ˜¯é•¿å®½æ¯”ï¼ˆaspect ratioï¼‰ã€‚ ä¹Ÿå°±æ˜¯ä½ ç”¨ä¸€ä¸ªç‰©ä½“çš„å®½é™¤ä»¥å®ƒçš„é«˜çš„å€¼ã€‚æ¯”å¦‚è¯´ï¼Œå½“ä½ åœ¨ä¸€ä¸ªå®½å±ç”µè§†ä¸Šæ’­æ”¾è€ç”µå½±æ—¶ï¼Œå¯ä»¥çœ‹åˆ°å›¾åƒä»¿ä½›æ˜¯è¢«å‹æ‰çš„ã€‚ æ¥ä¸‹æ¥çš„ä¸¤ä¸ªå‚æ•°æ˜¯è¿‘æˆªé¢ï¼ˆnearï¼‰å’Œè¿œæˆªé¢ï¼ˆfarï¼‰ã€‚é€šä¿—æ¥è®²å°±æ˜¯ç›¸æœºèƒ½çœ‹åˆ°çš„æœ€è¿‘çš„è·ç¦»å’Œæœ€è¿œçš„è·ç¦»ã€‚ è®¾ç½®å®Œè¿˜å¾—è®¾ç½®ç›¸æœºçš„ä½ç½®ï¼Œå‚æ•°åˆ†åˆ«æ˜¯xã€yã€zåæ ‡ camera.position.set(-1.8, 0.6, 2.7); .aspect : Float æ‘„åƒæœºè§†é”¥ä½“çš„é•¿å®½æ¯”ï¼Œé€šå¸¸æ˜¯ä½¿ç”¨ç”»å¸ƒçš„å®½/ç”»å¸ƒçš„é«˜ã€‚é»˜è®¤å€¼æ˜¯1ï¼ˆæ­£æ–¹å½¢ç”»å¸ƒï¼‰ã€‚ camera.lookAt(scene.position) è®©å½“å‰ç›¸æœºæŒ‡å‘åœºæ™¯ä¸­å¿ƒï¼Œè¿™é‡Œçš„å‚æ•°å¿…é¡»ä¼ å…¥ä¸€ä¸ªposition å…¶ä»–ç›¸æœºæ­£äº¤ç›¸æœºï¼ˆOrthographicCameraï¼‰ OrthographicCamera( left : Number, right : Number, top : Number, bottom : Number, near : Number, far : Number ) left â€” æ‘„åƒæœºè§†å·¦è¾¹ç•Œã€‚right â€” æ‘„åƒæœºè§†å³è¾¹ç•Œã€‚top â€” æ‘„åƒæœºè§†ä¸Šè¾¹ç•Œã€‚bottom â€” æ‘„åƒæœºè§†ä¸‹è¾¹ç•Œã€‚near â€” æ‘„åƒæœºè¿‘ç«¯è·ç¦»ã€‚far â€” æ‘„åƒæœºè¿œç«¯è·ç¦»ã€‚ è¿™ä¸€æ‘„åƒæœºä½¿ç”¨orthographic projectionï¼ˆæ­£äº¤æŠ•å½±ï¼‰æ¥è¿›è¡ŒæŠ•å½±ã€‚ ä»–æ²¡æœ‰è§†é‡è§’åº¦ï¼ˆfovï¼‰çš„æ¦‚å¿µï¼Œåœ¨è¿™ç§æŠ•å½±æ¨¡å¼ä¸‹ï¼Œæ— è®ºç‰©ä½“è·ç¦»ç›¸æœºè·ç¦»è¿œæˆ–è€…è¿‘ï¼Œåœ¨æœ€ç»ˆæ¸²æŸ“çš„å›¾ç‰‡ä¸­ç‰©ä½“çš„å¤§å°éƒ½ä¿æŒä¸å˜ã€‚ è¿™å¯¹äºæ¸²æŸ“2Dåœºæ™¯æˆ–è€…UIå…ƒç´ æ˜¯éå¸¸æœ‰ç”¨çš„ã€‚ updateProjectionMatrix.updateProjectionMatrix () : undefined æ›´æ–°æ‘„åƒæœºæŠ•å½±çŸ©é˜µï¼Œåœ¨ä»»ä½•å‚æ•°è¢«æ”¹å˜ä»¥åå¿…é¡»è¢«è°ƒç”¨ã€‚ æ¯”å¦‚ä¸‹é¢å°±æ˜¯ç›¸æœºçš„ aspect å‘ç”Ÿæ”¹å˜ï¼Œæ‰€ä»¥éœ€è¦æˆ‘ä»¬æ‰‹åŠ¨updateä¸€ä¸‹ this.camera.aspect = window.innerWidth / window.innerHeight; //å…¶å®ä¹Ÿå°±æ˜¯è°ƒæ•´cameraç¬¬äºŒä¸ªå‚æ•° // æ›´æ–°ä¸€ä¸‹æ‘„åƒæœºè½¬æ¢3dæŠ•å½±çš„çŸ©é˜µ this.camera.updateProjectionMatrix(); ä¸€èˆ¬æœ€å¤šç”¨åˆ°ä»¥ä¸Š2ç§ç›¸æœºï¼Œå¦‚æœ æƒ³äº†è§£æ›´å¤šç›¸æœº çœ‹è¿™é‡Œ (2)WebGLRendererï¼ˆæ¸²æŸ“å™¨ï¼‰//å¯ä»¥è®¾ç½®æŠ—é”¯é½¿ antialias const renderer = new THREE.WebGLRenderer({ antialias: true }); //è®¾ç½®åƒç´ æ¯”,window.devicePixelRatioä¸ºå½“å‰æµè§ˆå™¨çš„åƒç´ æ¯” renderer.setPixelRatio(window.devicePixelRatio) //è®¾ç½®ç”»å¸ƒ å°ºå¯¸å¤§å° renderer.setSize(window.innerWidth, window.innerHeight); ä½¿ç”¨æ¸²æŸ“å™¨åï¼Œè¿˜å¾—è®©å…¶åœ¨æµè§ˆå™¨ä¸­è¿›è¡Œæ¸²æŸ“ renderer.render(scene, camera) ä½¿ç”¨cssçš„èƒŒæ™¯ .my-canvas { width: 100%; height: 100%; display: block; background: url(resources/images/daikanyama.jpg) no-repeat center center; background-size: cover; } const renderer = new THREE.WebGLRenderer({ antialias: true, canvas, alpha: true, }); åº”å¯¹HD-DPIæ˜¾ç¤ºå™¨å¦‚æœä½ ç¡®å®æƒ³ç”¨è®¾å¤‡çš„åˆ†è¾¨ç‡æ¥æ¸²æŸ“ï¼Œthree.jsä¸­æœ‰ä¸¤ç§æ–¹æ³•æ¥å®ç°ã€‚ ä¸€ç§æ˜¯ä½¿ç”¨renderer.setPixelRatioæ¥å‘Šè¯‰three.jsåˆ†è¾¨ç‡çš„å€æ•°ã€‚ è®¿é—®æµè§ˆå™¨ä»CSSåƒç´ åˆ°è®¾å¤‡åƒç´ çš„å€æ•°ç„¶åä¼ ç»™three.jsã€‚ renderer.setPixelRatio(window.devicePixelRatio);ä¹‹åä»»ä½•å¯¹renderer.setSizeçš„è°ƒç”¨éƒ½ä¼šç¥å¥‡åœ°ä½¿ç”¨æ‚¨è¯·æ±‚çš„å¤§å°ä¹˜ä»¥æ‚¨ä¼ å…¥çš„åƒç´ æ¯”ä¾‹. å¼ºçƒˆä¸å»ºè®®è¿™æ ·ã€‚ çœ‹ä¸‹é¢ã€‚ å¦ä¸€ç§æ–¹æ³•æ˜¯åœ¨è°ƒæ•´canvasçš„å¤§å°æ—¶è‡ªå·±å¤„ç†ã€‚ function resizeRendererToDisplaySize(renderer) { const canvas = renderer.domElement; const pixelRatio = window.devicePixelRatio; const width = canvas.clientWidth * pixelRatio | 0; const height = canvas.clientHeight * pixelRatio | 0; const needResize = canvas.width !== width || canvas.height !== height; if (needResize) { renderer.setSize(width, height, false); } return needResize; } ç¬¬äºŒç§æ–¹æ³•ä»å®¢è§‚ä¸Šæ¥è¯´æ›´å¥½ã€‚ä¸ºä»€ä¹ˆï¼Ÿå› ä¸ºæˆ‘æ‹¿åˆ°äº†æˆ‘æƒ³è¦çš„ã€‚ åœ¨ä½¿ç”¨three.jsæ—¶æœ‰å¾ˆå¤šç§æƒ…å†µä¸‹æˆ‘ä»¬éœ€è¦çŸ¥é“canvasçš„ç»˜å›¾ç¼“å†²åŒºçš„ç¡®åˆ‡å°ºå¯¸ã€‚ æ¯”å¦‚åˆ¶ä½œåæœŸå¤„ç†æ»¤é•œæˆ–è€…æˆ‘ä»¬åœ¨æ“ä½œç€è‰²å™¨éœ€è¦è®¿é—®gl_FragCoordå˜é‡ï¼Œå¦‚æœæˆ‘ä»¬æˆªå±æˆ–è€…ç»™GPU è¯»å–åƒç´ ï¼Œç»˜åˆ¶åˆ°äºŒç»´çš„canvasç­‰ç­‰ã€‚ é€šè¿‡æˆ‘ä»¬è‡ªå·±å¤„ç†æˆ‘ä»¬ä¼šä¸€ç›´çŸ¥é“ä½¿ç”¨çš„å°ºå¯¸æ˜¯ä¸æ˜¯æˆ‘ä»¬éœ€è¦çš„ã€‚ å¹•åå¹¶æ²¡æœ‰ä»€ä¹ˆç‰¹æ®Šçš„é­”æ³•å‘ç”Ÿã€‚ åŠ¨ç”»loop .setAnimationLoop ( callback : Function ) : undefined callback â€” æ¯ä¸ªå¯ç”¨å¸§éƒ½ä¼šè°ƒç”¨çš„å‡½æ•°ã€‚ å¦‚æœä¼ å…¥â€˜nullâ€™,æ‰€æœ‰æ­£åœ¨è¿›è¡Œçš„åŠ¨ç”»éƒ½ä¼šåœæ­¢ã€‚ å¯ç”¨æ¥ä»£æ›¿requestAnimationFrameçš„å†…ç½®å‡½æ•°. å¯¹äºWebXRé¡¹ç›®ï¼Œå¿…é¡»ä½¿ç”¨æ­¤å‡½æ•°ã€‚(å¯ä»¥ç†è§£ä¸ºå°±æ˜¯ä¸€ä¸ª requestAnimationFrame ) renderFn() { mesh.rotation.y += 0.01; this.renderer.render(this.scene, camera) this.renderer.setAnimationLoop(this.renderFn) } // åŠ¨ç”»å‡½æ•° animate() { this.renderFn(); } ä½†æ˜¯æœ‰ä¸€ä¸ªç¼ºé™·ï¼šå½“ä½ å¸§æ•°è¶Šé«˜ï¼ˆä¸åŒæ‰‹æœºè¡¨ç°ä¸åŒï¼‰ï¼Œæ­¤æ—¶åŠ¨ç”»è¶Šå¿«ï¼Œä¸ºæ­¤æˆ‘ä»¬éœ€è¦åšä¸€äº›ç­–ç•¥ï¼šé€šè¿‡æ—¶é—´è°ƒèŠ‚æˆ‘ä»¬çš„frame rate æ–¹æ³•ä¸€ï¼šæœ¬åœ°æ—¶é—´ let time = Date.now(); renderFn() { const currentTime = Date.now(); const deltaTime = currentTime - time; time = currentTime; mesh.rotation.y += 0.01 * deltaTime; this.renderer.render(this.scene, camera) this.renderer.setAnimationLoop(this.renderFn) } æ–¹æ³•äºŒï¼šthreejsçš„clock const clock = new THREE.Clock() renderFn() { const elapsedTime = clock.getElapsedTime(); //å¾—åˆ°çš„æ˜¯ç§’ä¸æ˜¯æ¯«ç§’ mesh.rotation.y += elapsedTime; this.renderer.render(this.scene, camera) this.renderer.setAnimationLoop(this.renderFn) } è‰²è°ƒæ˜ å°„åœ¨è®¾ç½®hdrå›¾ä¹‹åï¼Œå¯ä»¥è®¾ç½®è‰²è°ƒæ˜ å°„å±æ€§ï¼Œè¿™äº›å¸¸é‡å®šä¹‰äº†WebGLRendererä¸­toneMappingçš„å±æ€§ã€‚ è¿™ä¸ªå±æ€§ç”¨äºåœ¨æ™®é€šè®¡ç®—æœºæ˜¾ç¤ºå™¨æˆ–è€…ç§»åŠ¨è®¾å¤‡å±å¹•ç­‰ä½åŠ¨æ€èŒƒå›´ä»‹è´¨ä¸Šï¼Œæ¨¡æ‹Ÿã€é€¼è¿‘é«˜åŠ¨æ€èŒƒå›´ï¼ˆHDRï¼‰æ•ˆæœã€‚ //è‰²è°ƒæ˜ å°„ï¼ˆå¸¸é‡ï¼‰ï¼Œè®¾ç½®ä¸ºç”µå½±çº§åˆ« renderer.toneMapping = THREE.ACESFilmicToneMapping; //è°ƒèŠ‚æ›å…‰ç¨‹åº¦ renderer.toneMappingExposure = 2; å…¶ä»–é’ˆå¯¹ä¸éœ€è¦åŠ¨ç”»çš„åœºæ™¯ï¼Œä¸€èˆ¬æˆ‘ä»¬åœ¨æè´¨åŠ è½½å®Œæˆåæ‰è°ƒç”¨renderæ–¹æ³•. æˆ‘ä»¬è¿™ä¹ˆåšæ˜¯å› ä¸ºä½¿ç”¨äº†æŒ‰éœ€æ¸²æŸ“ä¸­çš„æ–¹æ³•, è€Œä¸æ˜¯è¿ç»­æ¸²æŸ“. è¿™æ ·æˆ‘ä»¬ä»…ä»…éœ€è¦åœ¨æè´¨åŠ è½½åæ¸²æŸ“ä¸€éå°±å¥½. (3)sceneï¼ˆåœºæ™¯ï¼‰const scene = new THREE.Scene() scene.add(xx) //å°†xxæ·»åŠ å…¥åœºæ™¯, å¯ä¼ å…¥å¤šä¸ªObject3D scene.remove(xx) //å°†xxç§»é™¤åœºæ™¯ å®ƒç»§æ‰¿äºObject3Dï¼Œå®ƒä»£è¡¨ä¸€ä¸ªå±€éƒ¨ç©ºé—´ï¼Œä»¥ä¸‹æ˜¯å®˜ç½‘æ–‡æ¡£å¯¹åœºæ™¯è§£é‡Šçš„ä¸€ä¸ªä¾‹å­ï¼š å¤ªé˜³ç³»ã€å¤ªé˜³ã€åœ°çƒã€æœˆäº®ã€‚ åœ°çƒç»•ç€å¤ªé˜³è½¬ï¼Œæœˆçƒç»•ç€åœ°çƒè½¬ï¼Œæœˆçƒç»•ç€åœ°çƒè½¬äº†ä¸€åœˆã€‚ä»æœˆçƒçš„è§’åº¦çœ‹ï¼Œå®ƒæ˜¯åœ¨åœ°çƒçš„ â€œå±€éƒ¨ç©ºé—´ â€œä¸­æ—‹è½¬ã€‚å°½ç®¡å®ƒç›¸å¯¹äºå¤ªé˜³çš„è¿åŠ¨æ˜¯ä¸€äº›ç–¯ç‹‚çš„åƒèºçº¿å›¾ä¸€æ ·çš„æ›²çº¿ï¼Œä½†ä»æœˆçƒçš„è§’åº¦æ¥çœ‹ï¼Œå®ƒåªéœ€è¦å…³æ³¨è‡ªèº«å›´ç»•åœ°çƒè¿™ä¸ªå±€éƒ¨ç©ºé—´çš„æ—‹è½¬å³å¯ã€‚ è¿™ä¸ªæ˜¯æˆ‘æŒ‰ç…§å®˜ç½‘å†™çš„æ—‹è½¬çš„ä¾‹å­ å¦‚æœåœ¨åœºæ™¯ä¸­æ·»åŠ å¤ªé˜³ï¼Œå¤ªé˜³æ—‹è½¬æ˜¯ä¸ªæ ¹æ®åœºæ™¯æ—‹è½¬ï¼ŒæŠŠåœ°çƒæ·»åŠ è¿›å¤ªé˜³ä¸­ï¼Œé™¤äº†åœ°çƒè‡ªè½¬ï¼Œåœ°çƒè¿˜ä¼šå› ä¸ºå¤ªé˜³çš„æ—‹è½¬ï¼Œäº§ç”Ÿä»¥å¤ªé˜³ä¸ºç›¸å¯¹ç‚¹è¿›è¡Œæ—‹è½¬ï¼Œæ­¤æ—¶å¦‚æœsunMesh.scale.set(5, 5, 5) æ¯”ä¾‹è®¾ç½®ä¸º 5xã€‚è¿™æ„å‘³ç€ sunMeshs çš„å±€éƒ¨ç©ºé—´æ˜¯ 5 å€å¤§ã€‚è¿™è¡¨ç¤ºåœ°çƒç°åœ¨å¤§äº† 5 å€ï¼Œå®ƒä¸å¤ªé˜³çš„è·ç¦» ( earthMesh.position.x = 10 ) ä¹Ÿæ˜¯ 5 å€ã€‚è¿™ä¸ªä»¥å¤ªé˜³ä¸ºå±€éƒ¨ç©ºé—´çš„ä¸€åˆ‡ï¼Œéƒ½ä¼šå½±å“åˆ°åœ°çƒ //åˆ›å»ºå¤ªé˜³ const sunMaterial = new THREE.MeshPhongMaterial({ emissive: 0xffff00 }); const sunMesh = new THREE.Mesh(sphereGeometry, sunMaterial); sunMesh.scale.set(5, 5, 5); // æ‰©å¤§å¤ªé˜³çš„å¤§å° scene.add(sunMesh); objects.push(sunMesh); //åˆ›å»ºåœ°çƒ const earthMaterial = new THREE.MeshPhongMaterial({ color: 0x2233ff, emissive: 0x112244 }); const earthMesh = new THREE.Mesh(sphereGeometry, earthMaterial); earthMesh.position.x = 10; sunMesh.add(earthMesh); objects.push(earthMesh); æ‰€ä»¥æˆ‘ä»¬æœ€å¥½åšä¸€ä¸ªå¤ªé˜³ç³»ï¼Œå†å¾€å¤ªé˜³ç³»é‡Œæ·»åŠ åœ°çƒå’Œå¤ªé˜³ //åˆ›å»ºå¤ªé˜³ç³» const solarSystem = new THREE.Object3D(); scene.add(solarSystem); objects.push(solarSystem); //åˆ›å»ºå¤ªé˜³ const sunMaterial = new THREE.MeshPhongMaterial({ emissive: 0xffff00 }); const sunMesh = new THREE.Mesh(sphereGeometry, sunMaterial); sunMesh.scale.set(5, 5, 5); // æ‰©å¤§å¤ªé˜³çš„å¤§å° solarSystem.add(sunMesh); objects.push(sunMesh); //åˆ›å»ºåœ°çƒ const earthMaterial = new THREE.MeshPhongMaterial({ color: 0x2233ff, emissive: 0x112244 }); const earthMesh = new THREE.Mesh(sphereGeometry, earthMaterial); earthMesh.position.x = 10; solarSystem.add(earthMesh); objects.push(earthMesh); æœ€åå†è¯•ä¸€è¯•åŠ ä¸Šåœ°æœˆç³» //åˆ›å»ºåœ°æœˆç³» const earthOrbit = new THREE.Object3D(); earthOrbit.position.x = 10; solarSystem.add(earthOrbit); objects.push(earthOrbit); // åˆ›å»ºåœ°çƒ const earthMaterial = new THREE.MeshPhongMaterial({ color: 0x2233ff, emissive: 0x112244 }); const earthMesh = new THREE.Mesh(sphereGeometry, earthMaterial); earthOrbit.add(earthMesh); objects.push(earthMesh); // åˆ›å»ºæœˆäº® const moonMaterial = new THREE.MeshPhongMaterial({ color: 0x888888, emissive: 0x222222 }); const moonMesh = new THREE.Mesh(sphereGeometry, moonMaterial); moonMesh.position.x = 2; moonMesh.scale.set(0.5, 0.5, 0.5); earthOrbit.add(moonMesh); objects.push(moonMesh); åŒºå—ï¼ˆObject3Dï¼‰ç®¡ç†çš„ä¼˜ç‚¹é€šè¿‡è¿™ç§åŒºå—ï¼ˆObject3Dï¼‰çš„æ–¹å¼ï¼Œç®¡ç†æ¯ä¸ªMeshï¼Œåœ¨æŸä¸ªåœºæ™¯ä¸‹æœ‰å¤§é‡Meshéœ€è¦è¿›è¡Œç§»åŠ¨æ—¶æœ‰å·¨å¤§çš„æ€§èƒ½ä¼˜åŒ–ç©ºé—´ï¼Œæ­¤æ—¶æˆç™¾ä¸Šåƒçš„Meshæ”¾åœ¨ä¸€ä¸ªObject3Dé‡Œè¿›è¡Œä½ç½®å˜åŒ–ï¼Œå¯ä»¥è¢«å½“æˆä¸€æ¬¡çš„ä½ç½®å˜åŒ– æ‰€ä»¥å¯ä»¥çœ‹åˆ°å¾ˆå¤šæ¡ˆä¾‹ï¼Œåœ¨å¯¼å…¥.gltfæ–‡ä»¶ä¹‹åï¼Œä¸æ€¥ç€é€šè¿‡traverse éå† æ¯ä¸€ä¸ªèŠ‚ç‚¹è¿›è¡Œæ§åˆ¶ï¼Œè€Œæ˜¯å¯ä»¥å§ èŠ‚ç‚¹ï¼ˆmeshï¼‰ä¸¢åˆ°object 3Dé‡Œï¼Œè¿›è¡Œç»Ÿä¸€ç®¡ç† åœºæ™¯å†…éƒ¨æ–¹æ³• .background(Object) è‹¥ä¸ä¸ºç©ºï¼Œåœ¨æ¸²æŸ“åœºæ™¯çš„æ—¶å€™å°†è®¾ç½®èƒŒæ™¯ï¼Œä¸”èƒŒæ™¯æ€»æ˜¯é¦–å…ˆè¢«æ¸²æŸ“çš„ã€‚ å¯ä»¥è®¾ç½®ä¸€ä¸ªç”¨äºçš„â€œclearâ€çš„Colorï¼ˆé¢œè‰²ï¼‰ã€ä¸€ä¸ªè¦†ç›–canvasçš„Textureï¼ˆçº¹ç†ï¼‰ï¼Œ æˆ–æ˜¯ a cubemap as a CubeTexture or an equirectangular as a Textureã€‚é»˜è®¤å€¼ä¸ºnullã€‚ å½“ç„¶ä¹Ÿå¯ä»¥ä½¿ç”¨threejsçš„Color scene.background = new THREE.Color(BACKGROUND_COLOR); å¦‚æœèƒŒæ™¯å›¾è¢«æ‹‰ä¼¸äº†ï¼Œè¯´æ˜ä»–è¢«è‡ªåŠ¨é€‚åº”å±å¹•å®½é«˜ï¼Œæ­¤æ—¶éœ€è¦æˆ‘ä»¬è°ƒæ•´å›¾ç‰‡æ¯”ä¾‹ function render(time) { ... // è®¾ç½®èƒŒæ™¯è´´å›¾çš„repeatå’Œoffsetå±æ€§ // æ¥ä¿è¯å›¾ç‰‡çš„æ¯”ä¾‹æ˜¯æ­£ç¡®çš„ // æ³¨æ„å›¾ç‰‡æœ‰å¯èƒ½è¿˜æ²¡åŠ è½½å®Œæˆ const canvasAspect = canvas.clientWidth / canvas.clientHeight; const imageAspect = bgTexture.image ? bgTexture.image.width / bgTexture.image.height : 1; const aspect = imageAspect / canvasAspect; bgTexture.offset.x = aspect > 1 ? (1 - 1 / aspect) / 2 : 0; bgTexture.repeat.x = aspect > 1 ? 1 / aspect : 1; bgTexture.offset.y = aspect > 1 ? 0 : (1 - aspect) / 2; bgTexture.repeat.y = aspect > 1 ? 1 : aspect; ... renderer.render(scene, camera); requestAnimationFrame(render); } .environment(texture) è‹¥è¯¥å€¼ä¸ä¸ºnullï¼Œåˆ™è¯¥çº¹ç†è´´å›¾å°†ä¼šè¢«è®¾ä¸ºåœºæ™¯ä¸­æ‰€æœ‰ç‰©ç†æè´¨çš„ç¯å¢ƒè´´å›¾ã€‚ ç„¶è€Œï¼Œè¯¥å±æ€§ä¸èƒ½å¤Ÿè¦†ç›–å·²å­˜åœ¨çš„ã€å·²åˆ†é…ç»™ MeshStandardMaterial.envMap çš„è´´å›¾ã€‚é»˜è®¤ä¸ºnullã€‚ ç¯å¢ƒè´´å›¾æ˜¯ä¸€ç§ç”¨äºæ¨¡æ‹Ÿç‰©ä½“å‘¨å›´ç¯å¢ƒï¼ˆå¤©ç©ºã€åœ°é¢ã€è¿œå¤„ç‰©ä½“ç­‰ï¼‰åå°„çš„è´´å›¾ï¼Œå¯ä»¥ç”¨äºå¢å¼ºåœºæ™¯çš„çœŸå®æ„Ÿå’Œç»†èŠ‚ï¼Œåœ¨ä¸€äº›æ¡ˆä¾‹ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°é‡‘å±é¢åå°„å‘¨è¾¹ç¯å¢ƒï¼Œè¿™å°±æ˜¯ç¯å¢ƒè´´å›¾ï¼ˆscene.environmentçš„ä½œç”¨ï¼‰ã€‚ .fog( color : Integer, near : Float, far : Float ) ä¸€ä¸ªfogå®ä¾‹å®šä¹‰äº†å½±å“åœºæ™¯ä¸­çš„æ¯ä¸ªç‰©ä½“çš„é›¾çš„ç±»å‹ // è®¾ç½®è¿·é›¾ this.scene.fog = new THREE.Fog(0xf1f1f1, 20, 100); .near : Float å¼€å§‹åº”ç”¨é›¾çš„æœ€å°è·ç¦»ã€‚è·ç¦»å°äºæ´»åŠ¨æ‘„åƒæœºâ€œnearâ€ä¸ªå•ä½çš„ç‰©ä½“å°†ä¸ä¼šè¢«é›¾æ‰€å½±å“ã€‚ é»˜è®¤å€¼æ˜¯1ã€‚ .far : Float ç»“æŸè®¡ç®—ã€åº”ç”¨é›¾çš„æœ€å¤§è·ç¦»ï¼Œè·ç¦»å¤§äºæ´»åŠ¨æ‘„åƒæœºâ€œfarâ€ä¸ªå•ä½çš„ç‰©ä½“å°†ä¸ä¼šè¢«é›¾æ‰€å½±å“ã€‚ é›¾çš„é¢œè‰²æ˜¯æ ¹æ® scene.background æ¥çš„ .getObjectByName(name:string) ç”¨äºæŸ¥æ‰¾sceneä¸­éƒ½æŸä¸ªç‰©ä»¶ï¼Œæ¯”å¦‚ cube.name = 'nameCube' scene.add(cube) const findRes = scene.getObjectByName('nameCube') console.log(findRes.position) function removeCube(findRes){ if(findRes instanceof Mesh) { scene.remove(findRes) } } traverse åŒæ ·çš„ï¼Œsceneç»§æ‰¿äº†object3Dï¼Œsceneä¹Ÿæœ‰traverseæ–¹æ³•ï¼Œç”¨äºéå†åä»£ï¼Œè¢«è°ƒç”¨è€…å’Œæ¯ä¸ªåä»£å¯¹è±¡éƒ½ä¼šè°ƒç”¨è¯¥å‡½æ•° scene.traverse((obj) => { if(obj instanceof Mesh &amp;&amp; obj != plane) { obj.rotation.x += 0.01; obj.rotation.y += 0.01; obj.rotation.z += 0.01; } }) .overrideMaterial : Material å¦‚æœä¸ä¸ºç©ºï¼Œå®ƒå°†å¼ºåˆ¶åœºæ™¯ä¸­çš„æ¯ä¸ªç‰©ä½“ä½¿ç”¨è¿™é‡Œçš„æè´¨æ¥æ¸²æŸ“ã€‚é»˜è®¤å€¼ä¸ºnullã€‚ 3.textureï¼ˆçº¹ç†ï¼‰çº¹ç†è´´å›¾ï¼Œtextureå…¶å®å°±æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œå¸¸å¸¸æ”¾ç½®äºææ–™å•Šã€å‡ ä½•çš„è¡¨é¢ï¼Œæ¥å‘ˆç°å¤–è§‚ï¼Œå¯ä»¥çœ‹æˆä¸€å±‚â€œçš®â€ è¿™é‡Œè¿˜æœ‰ä¸€ä¸ªæ¯”è¾ƒå‡ºåçš„3dçº¹ç†ç½‘ç«™ï¼šhttps://3dtextures.me/ LoaderåŠ è½½çº¹ç†å›¾TextureLoaderï¼šåŠ è½½textureçš„ä¸€ä¸ªç±»ã€‚ å†…éƒ¨ä½¿ç”¨ImageLoaderæ¥åŠ è½½æ–‡ä»¶ã€‚ .load ( url : String, onLoad : Function, onProgress : Function, onError : Function ) : Texture url â€” æ–‡ä»¶çš„URLæˆ–è€…è·¯å¾„ï¼Œä¹Ÿå¯ä»¥ä¸º Data URI.onLoad â€” åŠ è½½å®Œæˆæ—¶å°†è°ƒç”¨ã€‚å›è°ƒå‚æ•°ä¸ºå°†è¦åŠ è½½çš„texture.onProgress â€” å°†åœ¨åŠ è½½è¿‡ç¨‹ä¸­è¿›è¡Œè°ƒç”¨ã€‚å‚æ•°ä¸ºXMLHttpRequestå®ä¾‹ï¼Œå®ä¾‹åŒ…å«totalå’Œloadedå­—èŠ‚ã€‚onError â€” åœ¨åŠ è½½é”™è¯¯æ—¶è¢«è°ƒç”¨ã€‚ ä»ç»™å®šçš„URLå¼€å§‹åŠ è½½å¹¶å°†å®Œå…¨åŠ è½½çš„textureä¼ é€’ç»™onLoadã€‚è¯¥æ–¹æ³•è¿˜è¿”å›ä¸€ä¸ªæ–°çš„çº¹ç†å¯¹è±¡ï¼Œè¯¥çº¹ç†å¯¹è±¡å¯ä»¥ç›´æ¥ç”¨äºæè´¨åˆ›å»ºã€‚ å¦‚æœé‡‡ç”¨æ­¤æ–¹æ³•ï¼Œä¸€æ—¦ç›¸åº”çš„åŠ è½½è¿‡ç¨‹å®Œæˆï¼Œçº¹ç†å¯èƒ½ä¼šåœ¨åœºæ™¯ä¸­å‡ºç°ã€‚ å…¶å®è¿˜æœ‰ä¸€ä¸ªCubeTextureLoaderï¼Œç”¨æ¥åŠ è½½CubeTextureç±»ï¼Œç«‹æ–¹ä½“è´´å›¾ï¼Œä¸€æ¬¡æ€§åŠ è½½å½“å‰è§†è§’ä¸Šä¸‹å·¦å³å‰åçš„å›¾ï¼Œå½¢æˆä¸€ä¸ªç«‹ä½“çš„map å¦‚æœçœŸå¯¹å…¨å±€çš„åŠ è½½ï¼ˆloadingï¼‰æƒ…å†µï¼Œå¯ä»¥ä½¿ç”¨ LoadingManager å…¶åŠŸèƒ½æ˜¯å¤„ç†å¹¶è·Ÿè¸ªå·²åŠ è½½å’Œå¾…å¤„ç†çš„æ•°æ®ã€‚å¦‚æœæœªæ‰‹åŠ¨è®¾ç½®åŠ å¼ºç®¡ç†å™¨ï¼Œåˆ™ä¼šä¸ºåŠ è½½å™¨åˆ›å»ºå’Œä½¿ç”¨é»˜è®¤å…¨å±€å®ä¾‹åŠ è½½å™¨ç®¡ç†å™¨ - è¯·å‚é˜… DefaultLoadingManager. ä¸€èˆ¬æ¥è¯´ï¼Œé»˜è®¤çš„åŠ è½½ç®¡ç†å™¨å·²è¶³å¤Ÿä½¿ç”¨äº†ï¼Œä½†æœ‰æ—¶å€™ä¹Ÿéœ€è¦è®¾ç½®å•ç‹¬çš„åŠ è½½å™¨ - ä¾‹å¦‚ï¼Œå¦‚æœä½ æƒ³ä¸ºå¯¹è±¡å’Œçº¹ç†æ˜¾ç¤ºå•ç‹¬çš„åŠ è½½æ¡ã€‚ const loadingManager = new THREE.LoadingManager(); loadingManager.onStart = function ( url, itemsLoaded, itemsTotal ) { console.log( 'Started loading file: ' + url + '.\\nLoaded ' + itemsLoaded + ' of ' + itemsTotal + ' files.' ); }; loadingManager.onLoad = function ( ) { console.log( 'Loading complete!'); }; loadingManager.onProgress = function ( url, itemsLoaded, itemsTotal ) { console.log( 'Loading file: ' + url + '.\\nLoaded ' + itemsLoaded + ' of ' + itemsTotal + ' files.' ); }; loadingManager.onError = function ( url ) { console.log( 'There was an error loading ' + url ); }; //çº¹ç†åŠ è½½å™¨ const textureLoader = new THREE.TextureLoader(); const texture = textureLoader.load(\"color.jpg\"); ç»™æè´¨èµ‹äºˆçº¹ç†jpgè´´å›¾çº¹ç†ï¼ˆæè´¨ï¼‰ .map : Texture é¢œè‰²è´´å›¾ã€‚é»˜è®¤ä¸ºnullã€‚ const planeMaterial = new THREE.MeshBasicMaterial({ color: 0xcccc }) setEnvMap(hdr) { const textureLoader = new THREE.TextureLoader(); const bricks = textureLoader.load(\"./images/brick.jpg\"); planeMaterial.map = bricks; } æˆ–è€…åœ¨åˆå§‹åŒ–ææ–™çš„æ—¶å€™ //è®©ç«‹æ–¹ä½“6ä¸ªé¢å›¾å½¢ä¸åŒ const materials = [ new THREE.MeshBasicMaterial({map: loader.load('resources/images/flower-1.jpg')}), new THREE.MeshBasicMaterial({map: loader.load('resources/images/flower-2.jpg')}), new THREE.MeshBasicMaterial({map: loader.load('resources/images/flower-3.jpg')}), new THREE.MeshBasicMaterial({map: loader.load('resources/images/flower-4.jpg')}), new THREE.MeshBasicMaterial({map: loader.load('resources/images/flower-5.jpg')}), new THREE.MeshBasicMaterial({map: loader.load('resources/images/flower-6.jpg')}), ]; const cube = new THREE.Mesh(geometry, materials); ä½†éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¹¶ä¸æ˜¯æ‰€æœ‰çš„å‡ ä½•ä½“ç±»å‹éƒ½æ”¯æŒå¤šç§æè´¨ã€‚BoxGeometry å’Œ BoxGeometry å¯ä»¥ä½¿ç”¨6ç§ææ–™ï¼Œæ¯ä¸ªé¢ä¸€ä¸ªã€‚ConeGeometry å’Œ ConeGeometry å¯ä»¥ä½¿ç”¨2ç§ææ–™ï¼Œä¸€ç§ç”¨äºåº•éƒ¨ï¼Œä¸€ç§ç”¨äºä¾§é¢ã€‚ CylinderGeometry å’Œ CylinderGeometry å¯ä»¥ä½¿ç”¨3ç§ææ–™ï¼Œåˆ†åˆ«æ˜¯åº•éƒ¨ã€é¡¶éƒ¨å’Œä¾§é¢ã€‚å¯¹äºå…¶ä»–æƒ…å†µï¼Œä½ éœ€è¦å»ºç«‹æˆ–åŠ è½½è‡ªå®šä¹‰å‡ ä½•ä½“å’Œï¼ˆæˆ–ï¼‰ä¿®æ”¹çº¹ç†åæ ‡ã€‚ åˆæˆ–è€…æ˜¯ï¼š(æ³¨æ„åŠ è½½çš„å¼‚æ­¥å¤„ç†) textureLoader.load(\"color.jpg\", (texture) => { //åˆ›å»ºæ­£æ–¹ä½“ const geometry = new THREE.BoxGeometry(1, 1, 1); const material = new THREE.MeshBasicMaterial({ map: texture }); const cube = new THREE.Mesh(geometry, material); cube.position.set(1, 0, 0); scene.add(cube); }); .envMap : Texture ç¯å¢ƒè´´å›¾ã€‚é»˜è®¤å€¼ä¸ºnullã€‚ çº¹ç†é‡å¤ //æœ‰2ä¸ªå±æ€§ï¼ŒwrapS ç”¨äºæ°´å¹³åŒ…è£¹ï¼ŒwrapT ç”¨äºå‚ç›´åŒ…è£¹ã€‚ texture.wrapS = THREE.RepeatWrapping; texture.wrapT = THREE.RepeatWrapping; //é‡å¤æ˜¯ç”¨[repeat]é‡å¤å±æ€§è®¾ç½®çš„ï¼Œä¸€ä¸‹ä¸¤ä¸ªå€¼è¡¨ç¤ºé‡å¤çš„æ¬¡æ•° const timesToRepeatHorizontally = 4; const timesToRepeatVertically = 2; someTexture.repeat.set(timesToRepeatHorizontally, timesToRepeatVertically); hdrå›¾è®¾ç½®çº¹ç†å½“ç„¶ä¹Ÿå¯ä»¥é€šè¿‡hdrå›¾è®¾ç½®çº¹ç†èƒŒæ™¯ import { RGBELoader } from \"three/examples/jsm/loaders/RGBELoader\"; //... // è®¾ç½®åœºæ™¯ï¼ˆç¯å¢ƒèƒŒæ™¯ï¼‰ setEnvMap(hdr) { // å›è°ƒå¾—åˆ°çš„å‚æ•°æ˜¯çº¹ç†å¯¹è±¡ // æ€ä¹ˆæ„Ÿè§‰è¿™é‡Œçš„è·¯å¾„æ˜¯ç›´æ¥æŠŠhdræ–‡ä»¶å¤¹æ”¾åœ¨publicä¸‹ new RGBELoader().setPath(\"./hdr/\").load(hdr + \".hdr\", (texture) => { //å‘Šè¯‰ä»–è¯¥çº¹ç†èƒŒæ™¯æ˜¯åœ†æŸ±ä½“æ˜ å°„ texture.mapping = THREE.EquirectangularReflectionMapping this.scene.background = texture; this.scene.environment = texture; }); } ç«‹ä½“è´´å›¾å¦‚æœä½ æƒ³ä½“éªŒç«‹ä½“çš„è´´å›¾ç¯å¢ƒï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨åˆ° CubeTextureLoaderï¼Œä¼ å…¥6ä¸ªç«‹æ–¹ä½“é¢çš„è´´å›¾ { const loader = new THREE.CubeTextureLoader(); const texture = loader.load([ 'resources/images/cubemaps/computer-history-museum/pos-x.jpg', 'resources/images/cubemaps/computer-history-museum/neg-x.jpg', 'resources/images/cubemaps/computer-history-museum/pos-y.jpg', 'resources/images/cubemaps/computer-history-museum/neg-y.jpg', 'resources/images/cubemaps/computer-history-museum/pos-z.jpg', 'resources/images/cubemaps/computer-history-museum/neg-z.jpg', ]); scene.background = texture; } æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ•ˆæœ å°è¯•ä¸€ä¸‹ æ­¤å¤–ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥é€šè¿‡WebGLCubeRenderTarget.fromEquirectangularTexture ç›´æ¥æ¸²æŸ“ä¸€å¼  360 å…¨æ™¯ç›¸æœºå›¾ å¯ä»¥çœ‹è¿™é‡Œçš„æ¡ˆä¾‹ ä¼˜åŒ–ï¼šçº¹ç†å†…å­˜çº¹ç†å¾€å¾€æ˜¯three.jsåº”ç”¨ä¸­ä½¿ç”¨å†…å­˜æœ€å¤šçš„éƒ¨åˆ†ã€‚é‡è¦çš„æ˜¯è¦æ˜ç™½ï¼Œä¸€èˆ¬æ¥è¯´ï¼Œçº¹ç†ä¼šå ç”¨ å®½åº¦ * é«˜åº¦ * 4 * 1.33 å­—èŠ‚çš„å†…å­˜ã€‚ æ‰€ä»¥ï¼Œä¸€èˆ¬ä¸ºäº†è®©three.jsä½¿ç”¨çº¹ç†ï¼Œå¿…é¡»æŠŠçº¹ç†äº¤ç»™GPUï¼Œè€ŒGPUä¸€èˆ¬éƒ½è¦æ±‚çº¹ç†æ•°æ®ä¸è¢«å‹ç¼©ã€‚æ‰€ä»¥ï¼Œä¸ä»…ä»…è¦è®©ä½ çš„çº¹ç†çš„æ–‡ä»¶å¤§å°å°ï¼Œè¿˜å¾—è®©ä½ çš„çº¹ç†å°ºå¯¸å° ä½†æ˜¯ï¼Œè™½ç„¶æˆ‘ä»¬å¯ä»¥ç”¨å„ç§è£å‰ªã€ç¼©æ”¾çš„æ–¹å¼ï¼Œè®©å›¾ç‰‡å®½é«˜å˜å°ï¼Œä½†æ˜¯è¿™å¯èƒ½å¯¼è‡´æˆ‘ä»¬å­˜åœ¨GPUçš„å›¾ç‰‡å¤ªå°äº†ï¼Œåƒç´ é¢œè‰²å¯èƒ½ä¼šå˜æˆè¿™æ · ä¸è¿‡ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨mipmapsè§£å†³è¿™ä¸ªé—®é¢˜ï¼Œè¦è®¾ç½®filterï¼Œ å½“åœ¨ç»˜åˆ¶çš„çº¹ç†å¤§äºå…¶åŸå§‹å°ºå¯¸æ—¶è®¾ç½®è¿‡æ»¤å™¨ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è®¾ç½® texture.magFilterï¼ˆTHREE.LinearFilterã€NearestFilterï¼‰æ¥é€‰æ‹©åƒç´ çš„å±•ç¤ºæƒ…å†µ å½“åœ¨ç»˜åˆ¶çš„çº¹ç†å°äºå…¶åŸå§‹å°ºå¯¸æ—¶è®¾ç½®è¿‡æ»¤å™¨ï¼Œä½ è¦è®¾ç½® texture.minFilter THREE.NearestFilter åŒä¸Šï¼Œåœ¨çº¹ç†ä¸­é€‰æ‹©æœ€è¿‘çš„åƒç´ ã€‚ THREE.LinearFilter å’Œä¸Šé¢ä¸€æ ·ï¼Œä»çº¹ç†ä¸­é€‰æ‹©4ä¸ªåƒç´ ï¼Œç„¶åæ··åˆå®ƒä»¬ 4.å‡ ä¸ªæ¯”è¾ƒé‡è¦çš„ç±» + æ¦‚å¿µä¸‰ç»´å‘é‡ï¼ˆVector3ï¼‰è¯¥ç±»è¡¨ç¤ºçš„æ˜¯ä¸€ä¸ªä¸‰ç»´å‘é‡ï¼ˆ3D vectorï¼‰ã€‚ ä¸€ä¸ªä¸‰ç»´å‘é‡è¡¨ç¤ºçš„æ˜¯ä¸€ä¸ªæœ‰é¡ºåºçš„ã€ä¸‰ä¸ªä¸ºä¸€ç»„çš„æ•°å­—ç»„åˆï¼ˆæ ‡è®°ä¸ºxã€yå’Œzï¼‰ï¼Œ å¯è¢«ç”¨æ¥è¡¨ç¤ºå¾ˆå¤šäº‹ç‰©ï¼Œä¾‹å¦‚ï¼š ä¸€ä¸ªä½äºä¸‰ç»´ç©ºé—´ä¸­çš„ç‚¹ã€‚ ä¸€ä¸ªåœ¨ä¸‰ç»´ç©ºé—´ä¸­çš„æ–¹å‘ä¸é•¿åº¦çš„å®šä¹‰ã€‚åœ¨three.jsä¸­ï¼Œé•¿åº¦æ€»æ˜¯ä»(0, 0, 0)åˆ°(x, y, z)çš„ Euclidean distanceï¼ˆæ¬§å‡ é‡Œå¾·è·ç¦»ï¼Œå³ç›´çº¿è·ç¦»ï¼‰ï¼Œ æ–¹å‘ä¹Ÿæ˜¯ä»(0, 0, 0)åˆ°(x, y, z)çš„æ–¹å‘ã€‚ ä»»æ„çš„ã€æœ‰é¡ºåºçš„ã€ä¸‰ä¸ªä¸ºä¸€ç»„çš„æ•°å­—ç»„åˆã€‚ å…¶ä»–çš„ä¸€äº›äº‹ç‰©ä¹Ÿå¯ä»¥ä½¿ç”¨äºŒç»´å‘é‡è¿›è¡Œè¡¨ç¤ºï¼Œæ¯”å¦‚è¯´åŠ¨é‡çŸ¢é‡ç­‰ç­‰ï¼› ä½†ä»¥ä¸Šè¿™äº›æ˜¯å®ƒåœ¨three.jsä¸­çš„å¸¸ç”¨ç”¨é€”ã€‚ å¯¹ Vector3 å®ä¾‹è¿›è¡Œéå†å°†æŒ‰ç›¸åº”çš„é¡ºåºç”Ÿæˆå®ƒçš„åˆ†é‡ (x, y, z)ã€‚ ä»£ç ç¤ºä¾‹ const a = new THREE.Vector3(0, 1, 0); //no arguments; will be initialised to (0, 0, 0) const b = new THREE.Vector3(); const d = a.distanceTo( b ); æ¯”å¦‚æˆ‘è¦è·å–ç‰©ä½“å’Œç›¸æœºçš„è·ç¦»ï¼Œæˆ–è€…ç‰©ä½“è·ç¦»æŸä¸ªç‚¹çš„è·ç¦» const a = new THREE.Vector3(0, 1, 0); //cubeè·ç¦»ç›¸æœºçš„è·ç¦» console.log(cube.position.distanceTo(camera.position)); æœ‰å¾ˆå¤šåœ°æ–¹ç»§æ‰¿äº†Vectorï¼Œæ¯”å¦‚Object3Dçš„positionå±æ€§ã€scaleå±æ€§ç­‰ã€‚ ä¸‰ç»´ç‰©ä½“ï¼ˆObject3Dï¼‰è¿™æ˜¯Three.jsä¸­å¤§éƒ¨åˆ†å¯¹è±¡çš„åŸºç±»ï¼Œæä¾›äº†ä¸€ç³»åˆ—çš„å±æ€§å’Œæ–¹æ³•æ¥å¯¹ä¸‰ç»´ç©ºé—´ä¸­çš„ç‰©ä½“è¿›è¡Œæ“çºµã€‚ è¯·æ³¨æ„ï¼Œå¯ä»¥é€šè¿‡.add( object )æ–¹æ³•æ¥å°†å¯¹è±¡è¿›è¡Œç»„åˆï¼Œè¯¥æ–¹æ³•å°†å¯¹è±¡æ·»åŠ ä¸ºå­å¯¹è±¡ï¼Œä½†ä¸ºæ­¤æœ€å¥½ä½¿ç”¨Groupï¼ˆæ¥ä½œä¸ºçˆ¶å¯¹è±¡ï¼‰ã€‚ ä»–æœ‰postionã€scaleã€rotationç­‰å±æ€§ï¼Œè¿˜æœ‰addã€lookAtã€traverseï¼ˆç”¨äºéå†ï¼‰ç­‰æ–¹æ³• å¯ä»¥æŠŠå®ƒçœ‹æˆjsä¸­çš„objecté‚£ä¹ˆé€šç”¨ Object3D.scale.set(x, y, z)ï¼šè®¾ç½®ç‰©ä½“å¤§å° Object3D.position.set(x, y, z)ï¼šè®¾ç½®ç‰©ä½“ä½ç½® Object3D.rotation.set(x, y, z)ï¼šè®¾ç½®ç‰©ä½“æ—‹è½¬è§’åº¦ï¼Œåˆ†åˆ«è¡¨ç¤ºxã€yã€zè½´æ—‹è½¬é‡ï¼ˆå¤‡æ³¨ï¼Œå¦‚æœåœ¨rotationæœ‰ç–‘æƒ‘çš„æ—¶å€™ï¼Œå¯ä»¥å°è¯•ä¸€ä¸‹.cube.rotation.reorder(&#39;YXZ&#39;);ï¼Œä»–æ—‹è½¬è§’åº¦ä¼šæ ¹æ®å½“å‰ç‰©ä½“çš„xã€yã€zè½´æ—‹è½¬ ï¼‰ Meshï¼šç½‘æ ¼è¡¨ç¤ºåŸºäºä»¥ä¸‰è§’å½¢ä¸ºpolygon meshï¼ˆå¤šè¾¹å½¢ç½‘æ ¼ï¼‰çš„ç‰©ä½“çš„ç±»ï¼Œå®ƒç»§æ‰¿object3Dã€‚ åŒæ—¶ä¹Ÿä½œä¸ºå…¶ä»–ç±»çš„åŸºç±»ï¼Œä¾‹å¦‚SkinnedMeshã€‚ ä»£ç ç¤ºä¾‹ const geometry = new THREE.BoxGeometry( 1, 1, 1 ); //ç”Ÿæˆä¸€ä¸ªç«‹æ–¹ä½“ const material = new THREE.MeshBasicMaterial({ color: 0xffff00 }); //åˆ›å»ºä¸€ä¸ªæè´¨material const mesh = new THREE.Mesh( geometry, material ); scene.add( mesh ); ä½ å¯ä»¥ç†è§£ä»–ä¸ºä¸€ä¸ªç±»ä¼¼pixiçš„spriteï¼Œä½†æ˜¯å®ƒç”±ä¸€ä¸ªç‰©ä½“å‡ ä½•ï¼ˆgeometryï¼‰ + ææ–™ï¼ˆmaterialï¼‰ åˆæˆçš„ï¼Œæ¯”å¦‚ä¸€é¢—æœ¨å¤´å°±æ˜¯ç”±ä¸€ä¸ªåœ†æŸ±ä½“ + æœ¨æè´¨åˆæˆçš„ Groupå®ƒå‡ ä¹å’ŒObject3Dæ˜¯ç›¸åŒçš„ï¼Œå…¶ç›®çš„æ˜¯ä½¿å¾—ç»„ä¸­å¯¹è±¡åœ¨è¯­æ³•ä¸Šçš„ç»“æ„æ›´åŠ æ¸…æ™°ã€‚ ä½ å¯ä»¥å°±æŠŠä»–å½“æˆä¸€ä¸ªObject3Dæ¥çœ‹ï¼Œåªä¸è¿‡ä»–ä¸€èˆ¬ç”¨äºè£…è½½å¤šä¸ªMeshï¼Œåœ¨pixié‡Œç±»ä¼¼äºcontainerçš„æ¦‚å¿µ const geometry = new THREE.BoxGeometry( 1, 1, 1 ); const material = new THREE.MeshBasicMaterial( {color: 0x00ff00} ); const cubeA = new THREE.Mesh( geometry, material ); cubeA.position.set( 100, 100, 0 ); const cubeB = new THREE.Mesh( geometry, material ); cubeB.position.set( -100, -100, 0 ); //create a group and add the two cubes //These cubes can now be rotated / scaled etc as a group const group = new THREE.Group(); group.add( cubeA ); group.add( cubeB ); scene.add( group ); Float32Arrayæºè‡ªåŸç”Ÿjavascript mdnï¼š Float32Array ç±»å‹æ•°ç»„ä»£è¡¨çš„æ˜¯å¹³å°å­—èŠ‚é¡ºåºä¸º 32 ä½çš„æµ®ç‚¹æ•°å‹æ•°ç»„ (å¯¹åº”äº C æµ®ç‚¹æ•°æ®ç±»å‹) ã€‚ å¯¹äº WebGL åº”ç”¨ç¨‹åºï¼Œä»Arrayåˆ°çš„æ½œåœ¨ä»£ä»·é«˜æ˜‚çš„è½¬æ¢Float32Arrayéœ€è¦åŒ…å«åœ¨ä»»ä½•æ€§èƒ½æµ‹é‡ä¸­ã€‚ å®ƒåªèƒ½å­˜å‚¨floatæ•°æ® åªèƒ½å­˜å‚¨å›ºå®šçš„é•¿åº¦ ä½†æ˜¯ç«¯ä¸Šå¤„ç†èµ·æ¥ååˆ†å¿«é€Ÿ // 3ä¸ªé¡¶ç‚¹ï¼Œåˆ›å»º9ä¸ªæ•°å€¼ const positionArr = new Float32Array(9); //ç¬¬ä¸€é¡¶ç‚¹ï¼ˆvertexï¼‰çš„xã€yã€zåæ ‡ positionArr[0] = 0; positionArr[1] = 0; positionArr[2] = 0; //ç¬¬äºŒé¡¶ç‚¹ï¼ˆvertexï¼‰çš„xã€yã€zåæ ‡ positionArr[3] = 0; positionArr[4] = 1; positionArr[5] = 0; //ç¬¬ä¸‰é¡¶ç‚¹ï¼ˆvertexï¼‰çš„xã€yã€zåæ ‡ positionArr[6] = 1; positionArr[7] = 0; positionArr[8] = 0; //ç¬¬äºŒç§åˆ›å»ºæ–¹å¼ const positionArr2 = new Float32Array([0, 0, 0, 0, 1, 0, 1, 0, 0]); BufferAttributeè¿™ä¸ªç±»ç”¨äºå­˜å‚¨ä¸BufferGeometryç›¸å…³è”çš„ attributeï¼ˆä¾‹å¦‚é¡¶ç‚¹ä½ç½®å‘é‡ï¼ˆpositionï¼‰ï¼Œé¢ç‰‡ç´¢å¼•ï¼Œæ³•å‘é‡ï¼ˆnormalï¼‰ï¼Œé¢œè‰²å€¼ï¼ˆcolorï¼‰ï¼ŒUVåæ ‡ï¼ˆuvï¼‰ä»¥åŠä»»ä½•è‡ªå®šä¹‰ attribute ï¼‰ã€‚ åˆ©ç”¨ BufferAttributeï¼Œå¯ä»¥æ›´é«˜æ•ˆçš„å‘GPUä¼ é€’æ•°æ®ã€‚ æ„é€ å‡½æ•° BufferAttribute( array : TypedArray, itemSize : Integer, normalized : Boolean ) array â€“ å¿…é¡»æ˜¯ TypedArray. ç±»å‹ï¼Œç”¨äºå®ä¾‹åŒ–ç¼“å­˜ã€‚è¯¥é˜Ÿåˆ—åº”è¯¥åŒ…å«ï¼šitemSize * numVerticesä¸ªå…ƒç´ ï¼ŒnumVertices æ˜¯ BufferGeometryä¸­çš„é¡¶ç‚¹æ•°ç›® itemSize â€“ é˜Ÿåˆ—ä¸­ä¸é¡¶ç‚¹ç›¸å…³çš„æ•°æ®å€¼çš„å¤§å°ã€‚ä¸¾ä¾‹ï¼Œå¦‚æœ attribute å­˜å‚¨çš„æ˜¯ä¸‰å…ƒç»„ï¼ˆä¾‹å¦‚é¡¶ç‚¹ç©ºé—´åæ ‡ã€æ³•å‘é‡æˆ–é¢œè‰²å€¼ï¼‰åˆ™itemSizeçš„å€¼åº”è¯¥æ˜¯3ã€‚ normalized â€“ (å¯é€‰) æŒ‡æ˜ç¼“å­˜ä¸­çš„æ•°æ®å¦‚ä½•ä¸GLSLä»£ç ä¸­çš„æ•°æ®å¯¹åº”ã€‚ä¾‹å¦‚ï¼Œå¦‚æœarrayæ˜¯ UInt16Arrayç±»å‹ï¼Œä¸”normalizedçš„å€¼æ˜¯ trueï¼Œåˆ™é˜Ÿåˆ—ä¸­çš„å€¼å°†ä¼šä» 0 - +65535 æ˜ å°„ä¸º GLSL ä¸­çš„ 0.0f - +1.0fã€‚ å¦‚æœarrayæ˜¯ Int16Array (æœ‰ç¬¦å·)ï¼Œåˆ™å€¼å°†ä¼šä» -32768 - +32767 æ˜ å°„ä¸º -1.0f - +1.0fã€‚è‹¥ normalized çš„å€¼ä¸º falseï¼Œåˆ™æ•°æ®æ˜ å°„ä¸ä¼šå½’ä¸€åŒ–ï¼Œè€Œä¼šç›´æ¥æ˜ å°„ä¸º float å€¼ï¼Œä¾‹å¦‚ï¼Œ32767 å°†ä¼šæ˜ å°„ä¸º 32767.0f. const positionArrtribute = new THREE.BufferAttribute(positionArr, 3); //positionArrä¸ºä¸Šæ–¹çš„Float32Array å› æ­¤ï¼Œå¦‚æœä½ è¦ç›´æ¥ä¿®æ”¹BufferAttributeï¼Œå¿…é¡»é€šè¿‡setAttributeçš„å½¢å¼æ·»åŠ ï¼Œå¹¶ä¸”ä¼ å…¥ Float32Array æ•°ç»„ï¼Œè¯¦æƒ…å¯ä»¥çœ‹ ä¸‹é¢ Geometry éƒ¨åˆ† UVuvåæ ‡å¯ä»¥ç†è§£ä¸ºçº¹ç†åæ ‡ï¼Œåƒå‰ç«¯ç²¾çµå›¾ä¸€æ ·ï¼Œæ¯ä¸€å—Â·éƒ½ä¼šæœ‰å¯¹åº”çš„ä½ç½®ï¼Œè€Œä¸”ä¹Ÿæ˜¯äºŒç»´çš„ è¿™é‡Œå¼•ç”¨Bruno Simon çš„ä¸¤å¼ å›¾è¡¨ç°texutreå¯¹åº”çš„å¹³é¢åæ ‡ï¼ˆäºŒç»´uvä½ç½®ï¼Œ åœ¨BufferAttributeä¸­å®ƒçš„itemSizeä¸º2ï¼‰ è®¾ç½®uv //åˆ›å»ºç¼“å†²å‡ ä½• const geometry = new THREE.BufferGeometry(); const material = new THREE.MeshStandardMaterial(); material.map = xxTexture; const mesh = new THREE.Mesh(geometry, material); //é€šè¿‡setAttributeï¼Œä¼ å…¥ä¸€ä¸ªBufferAttribute //è®°ä½è¿™é‡Œæ˜¯äºŒç»´çš„ geometry.setAttribute(\"uv2\", BufferAttribute(mesh.geometry.attributes.uv.array, 2)); è¿™é‡Œè¿˜æœ‰ä¸€ä¸ªè‰å›¾ï¼Œå¾ˆç”ŸåŠ¨å½¢è±¡ï¼šhttps://blog.csdn.net/from_the_star/article/details/106594769 Uï¼ˆå›¾ç‰‡åœ¨æ˜¾ç¤ºå™¨æ°´å¹³çš„åæ ‡ï¼‰å’ŒVï¼ˆå›¾ç‰‡åœ¨æ˜¾ç¤ºå™¨å‚ç›´çš„åæ ‡ï¼‰ èŒƒå›´æ˜¯ 0 - 1ï¼Œé€šè¿‡setAttributeæˆ‘ä»¬å¯ä»¥ä¼ å…¥å½“å‰è¿™ä¸ª BufferAttribute çš„çº¹ç†åæ ‡ä½ç½® å¯ä»¥åœ¨0~1.0ä¹‹é—´ä»»æ„å–å€¼(æ˜¯ç™¾åˆ†æ¯”å€¼ï¼Œæ¯”å¦‚0.3ï¼Œå¯¹åº”æ˜¯30%çš„ä½ç½®)ï¼Œçº¹ç†è´´å›¾å·¦ä¸‹è§’å¯¹åº”çš„UVåæ ‡æ˜¯(0,0)ï¼Œå³ä¸Šè§’å¯¹åº”çš„åæ ‡(1,1) è€Œä¸”æˆ‘ä»¬è¿˜èƒ½é€šè¿‡è®¾ç½® textureçš„offsetåç§»ï¼ˆå®é™…ä¸Šä¹Ÿæ˜¯è®¾ç½®uvæ–¹å‘çš„åç§»ï¼‰ï¼Œæ¥åˆ›å»ºä¸€ä¸ªuvåŠ¨ç”»ï¼Œçœ‹è¿™é‡Œ(æ–‘é©¬çº¿æ¡ˆä¾‹) Normalsæ³•å‘é‡ç»´åŸºç™¾ç§‘æ¦‚å¿µï¼š æ³•å‘é‡ï¼Œæ˜¯ç©ºé—´è§£æå‡ ä½•çš„ä¸€ä¸ªæ¦‚å¿µï¼Œå‚ç›´äºå¹³é¢çš„ç›´çº¿æ‰€è¡¨ç¤ºçš„å‘é‡ä¸ºè¯¥å¹³é¢çš„æ³•å‘é‡ã€‚ æ³•å‘é‡é€‚ç”¨äºè§£æå‡ ä½•ã€‚ ç”±äºç©ºé—´å†…æœ‰æ— æ•°ä¸ªç›´çº¿å‚ç›´äºå·²çŸ¥å¹³é¢ï¼Œå› æ­¤ä¸€ä¸ªå¹³é¢éƒ½å­˜åœ¨æ— æ•°ä¸ªæ³•å‘é‡ï¼ˆåŒ…æ‹¬ä¸¤ä¸ªå•ä½æ³•å‘é‡ï¼‰ã€‚ normalsè¡¨ç¤ºçš„æ˜¯æ³•å‘é‡ï¼Œä¸€èˆ¬å’Œå…‰ç…§ã€åå°„ã€æŠ˜å°„æœ‰å…³ æ¯”å¦‚åœ¨å›¾ç‰‡é‡Œï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°å¦‚æœå…‰ç…§æŒ‰ç…§å·¦ä¸Šåˆ°å³ä¸‹çš„è§’åº¦å°„è¿›æ¥ï¼Œå·¦ä¸ŠåŠçƒæ˜¯æœ‰å…‰ç…§ååº”çš„ï¼Œå³ä¸‹æ˜¯é€æ¸å˜æš—çš„ï¼Œå¹¶ä¸”å³ä¸‹è§’ä¼šéšä¹‹äº§ç”Ÿé˜´å½±ï¼Œæ­¤æ—¶æˆ‘ä»¬è¿˜èƒ½çœ‹åˆ°å·¦ä¸Šèƒ½å½¢æˆåå°„çš„å‘é‡è§’åº¦, è¿™é‡Œæˆ‘åˆ›å»ºä¸€ä¸ªVertexNormalsHelper ï¼Œæ–¹ä¾¿è§‚å¯Ÿæ³•å‘é‡ ä¸‹é¢è¿™ä¸ªä¾‹å­ï¼Œæˆ‘åŒæ–¹å‘å…‰æ­£å¸¸æ‰“å…‰ï¼ŒæŒ‰ç…§çº¢çº¿çš„æŒ‡ç¤ºæ˜¯æ­£å¸¸çš„ï¼Œæ­¤æ—¶ä¸Šé¢çš„æ³•å‘é‡ä¸º [0, 1, 0] ä½†æ˜¯å½“æˆ‘ä»¬æŠŠé¡¶ç‚¹çš„æ³•å‘é‡è°ƒæ•´ä¸º [1, 0, 0]æ­¤æ—¶æœºä¼šçœ‹åˆ°å’Œä¾§é¢ä¸€æ ·çš„æ‰“å…‰æƒ…å†µ 5.Meshç»„æˆå‡ ä½•ï¼ˆGeometryï¼‰ä»‹ç» ç›®å‰ä¸ºæ­¢ï¼Œthreejså·²åˆ é™¤ä¹‹å‰æœ‰çš„Geometryï¼Œç”¨çš„éƒ½æ˜¯ä»¥BufferGeometryä¸ºåŸºç±»çš„Geometry https://github.com/mrdoob/three.js/wiki/Migration-Guide#r124--r125 å®˜ç½‘ä»‹ç» ç”¨çš„æ¯”è¾ƒå¤šçš„BoxGeometryã€PlaneGeometry ã€TextGeometryï¼ˆTextGeometryç”Ÿæˆç½‘æ ¼å‰éœ€è¦å…ˆåŠ è½½ 3D å­—ä½“æ•°æ®ã€‚ æ•°æ®çš„åŠ è½½æ˜¯å¼‚æ­¥çš„ï¼Œæ‰€ä»¥åœ¨å°è¯•åˆ›å»ºå‡ ä½•ä½“å‰éœ€è¦ç­‰å¾…ã€‚é€šè¿‡å°†å­—ä½“åŠ è½½ Promise åŒ–ï¼Œå¹¶ä¸”æˆ‘ä»¬å¯ä»¥é€šè¿‡å‡å°‘curveSegmentsã€ bevelSegmentsçš„å€¼è¿›è¡Œä¼˜åŒ–ï¼‰ ä¸€äº›å¤§ä½¬ç”šè‡³å¯ä»¥é  ShapeGeometry æˆ–è€…æ˜¯åˆ›å»ºä¸€ä¸ªempty BufferGeometryæ”¹é€ æˆè‡ªå·±æƒ³è¦çš„å½¢çŠ¶ å¦‚æœç»˜åˆ¶ä¸€äº›åƒ PlaneGeometry å’Œ ShapeGeometry è¿™æ ·çš„äºŒç»´å›¾å½¢ï¼Œæ²¡æœ‰å†…éƒ¨, å¦‚æœä¸è®¾ç½® side: THREE.DoubleSideï¼Œå½“ä»åé¢çœ‹æ—¶å®ƒä»¬ä¼šæ¶ˆå¤±ã€‚ å¯¹äºç¢°æ’æ£€æµ‹ï¼Œthreejsé»˜è®¤ä½¿ç”¨sphere bouding ä¹Ÿå°±æ˜¯ä¸€ä¸ªçƒå½¢ å…¶å®ä¹Ÿå°±æ˜¯Geometryçš„è¿™ä¸¤ä¸ªå±æ€§ BufferGeometry åœ¨ä¹‹å‰æœ‰ä¸ªGeometryï¼Œä¸€ç›´å’ŒBufferGeometryè¿›è¡Œå¯¹æ¯”ï¼š åŸºäº BufferGeometry çš„å›¾å…ƒæ˜¯é¢å‘æ€§èƒ½çš„ç±»å‹ã€‚ å‡ ä½•ä½“çš„é¡¶ç‚¹æ˜¯ç›´æ¥ç”Ÿæˆä¸ºä¸€ä¸ªé«˜æ•ˆçš„ç±»å‹æ•°ç»„å½¢å¼ï¼Œå¯ä»¥è¢«ä¸Šä¼ åˆ° GPU è¿›è¡Œæ¸²æŸ“ã€‚ è¿™æ„å‘³ç€å®ƒä»¬èƒ½æ›´å¿«çš„å¯åŠ¨ï¼Œå ç”¨æ›´å°‘çš„å†…å­˜ã€‚ä½†å¦‚æœæƒ³ä¿®æ”¹æ•°æ®ï¼Œå°±éœ€è¦å¤æ‚çš„ç¼–ç¨‹ã€‚ åŸºäº Geometry çš„å›¾å…ƒæ›´çµæ´»ã€æ›´æ˜“ä¿®æ”¹ï¼ˆå»ºç«‹åœ¨bufferGeometryä¹‹ä¸Šå°è£…å¥½çš„apiï¼‰ã€‚ å®ƒä»¬æ ¹æ® JavaScript çš„ç±»è€Œæ¥ï¼Œåƒ Vector3 æ˜¯ 3D çš„ç‚¹ï¼ŒFace3 æ˜¯ä¸‰è§’å½¢ã€‚ å®ƒä»¬éœ€è¦æ›´å¤šçš„å†…å­˜ï¼Œåœ¨èƒ½å¤Ÿè¢«æ¸²æŸ“å‰ï¼ŒThree.js ä¼šå°†å®ƒä»¬è½¬æ¢æˆç›¸åº”çš„ BufferGeometry è¡¨ç°å½¢å¼ã€‚ ä¸¾ä¸ªç®€å•çš„ä¾‹å­ï¼ŒBufferGeometry ä¸èƒ½è½»æ¾çš„æ·»åŠ æ–°çš„é¡¶ç‚¹ã€‚ ä½¿ç”¨é¡¶ç‚¹çš„æ•°é‡åœ¨åˆ›å»ºæ—¶å°±å®šå¥½äº†ï¼Œç›¸åº”çš„åˆ›å»ºå­˜å‚¨ï¼Œå¡«å……é¡¶ç‚¹æ•°æ®ã€‚ ä½†ç”¨ Geometry ä½ å°±èƒ½éšæ—¶æ·»åŠ é¡¶ç‚¹ã€‚ æ€»ç»“å°±æ˜¯ï¼šæ¶ˆè€—æ€§èƒ½çš„åœ°æ–¹æœ€å¥½ç”¨BufferGeometry(æ¯”å¦‚è¯´çƒŸã€é›¾ã€é›ªã€é›¨ä¹‹ç±»çš„)ï¼Œä½†æ˜¯BufferGeometryç”¨èµ·æ¥å¾ˆéº»çƒ¦ï¼Œæ™®éçš„åœ°æ–¹æ­£å¸¸ç”¨Geometryå°±å¥½äº† å®é™…ä¸Šï¼ŒBufferGeometry æœ¬è´¨ä¸Šæ˜¯ä¸€ç³»åˆ— BufferAttributes çš„ åç§° ã€‚æ¯ä¸€ä¸ª BufferAttribute ä»£è¡¨ä¸€ç§ç±»å‹æ•°æ®çš„æ•°ç»„ï¼šä½ç½®ï¼Œæ³•çº¿ï¼Œé¢œè‰²ï¼Œuvï¼Œç­‰ç­‰â€¦â€¦ è¿™äº›åˆèµ·æ¥ï¼Œ BufferAttributes ä»£è¡¨æ¯ä¸ªé¡¶ç‚¹æ‰€æœ‰æ•°æ®çš„ å¹¶è¡Œæ•°ç»„ ã€‚ è€Œä¸Šé¢position, normal, color, uv ï¼Œå®ƒä»¬æŒ‡çš„æ˜¯ å¹¶è¡Œæ•°ç»„ ï¼Œä»£è¡¨æ¯ä¸ªå±æ€§çš„ç¬¬Nä¸ªæ•°æ®é›†å±äºåŒä¸€ä¸ªé¡¶ç‚¹ã€‚index=4çš„é¡¶ç‚¹è¢«é«˜äº®è¡¨ç¤ºè´¯ç©¿æ‰€æœ‰å±æ€§çš„å¹³è¡Œæ•°æ®å®šä¹‰ä¸€ä¸ªé¡¶ç‚¹ã€‚ //åˆ›å»ºç¼“å†²å‡ ä½• const geometry = new THREE.BufferGeometry(); //é€šè¿‡setAttributeï¼Œä¼ å…¥ä¸€ä¸ªBufferAttribute geometry.setAttribute(\"position\", positionArrtribute); const material = new THREE.MeshBasicMaterial({ color: 0xff0000, wireframe: true }); const mesh = new THREE.Mesh(geometry, material); console.log(geometry.attributes) /* { position: Float32BufferAttribute normal: Float32BufferAttribute uv: Float32BufferAttribute } */ æ¡ˆä¾‹ ï¼ˆä¸Šä¸‡çš„ç²’å­æ•ˆæœä»ç„¶ç‰¹åˆ«æµç•…ï¼‰ æè´¨ï¼ˆmaterialï¼‰ä»‹ç»åŸºç¡€å±æ€§.opacity : Float åœ¨0.0 - 1.0çš„èŒƒå›´å†…çš„æµ®ç‚¹æ•°ï¼Œè¡¨æ˜æè´¨çš„é€æ˜åº¦ã€‚å€¼0.0è¡¨ç¤ºå®Œå…¨é€æ˜ï¼Œ1.0è¡¨ç¤ºå®Œå…¨ä¸é€æ˜ã€‚å¦‚æœæè´¨çš„transparentå±æ€§æœªè®¾ç½®ä¸ºtrueï¼Œåˆ™æè´¨å°†ä¿æŒå®Œå…¨ä¸é€æ˜ï¼Œæ­¤å€¼ä»…å½±å“å…¶é¢œè‰²ã€‚ é»˜è®¤å€¼ä¸º1.0ã€‚ ç»å¸¸ç”¨äº è¿‡æ¸¡æ¶ˆå¤±åŠ¨ç”» .side : Integer å®šä¹‰å°†è¦æ¸²æŸ“å“ªä¸€é¢ - æ­£é¢ï¼ŒèƒŒé¢æˆ–ä¸¤è€…ã€‚ é»˜è®¤ä¸ºTHREE.FrontSideã€‚å…¶ä»–é€‰é¡¹æœ‰THREE.BackSide å’Œ THREE.DoubleSideã€‚ ç»å¸¸ç”¨äº è®¾ç½®é€æ˜æ—¶æ›´æ”¹ä¸ºåŒé¢ï¼Œå¯ä»¥çœ‹åˆ°åé¢é‚£å±‚ ç±»åˆ« MeshBasicMaterialï¼šä¸€ä¸ªä»¥ç®€å•ç€è‰²ï¼ˆå¹³é¢æˆ–çº¿æ¡†ï¼‰æ–¹å¼æ¥ç»˜åˆ¶å‡ ä½•ä½“çš„æè´¨ã€‚è¿™ç§æè´¨ä¸å—å…‰ç…§çš„å½±å“ã€‚ï¼ˆæœ€ä½³æ€§èƒ½ï¼‰ MeshDepthMaterialï¼ˆæ·±åº¦ç½‘æ ¼æè´¨ï¼‰ï¼šä¸€ç§æŒ‰æ·±åº¦ç»˜åˆ¶å‡ ä½•ä½“çš„æè´¨ã€‚æ·±åº¦åŸºäºç›¸æœºè¿œè¿‘å¹³é¢ã€‚ç™½è‰²æœ€è¿‘ï¼Œé»‘è‰²æœ€è¿œï¼Œå¯ç”¨äºé˜´å½±ã€‚ MeshMatcapMaterialï¼šMeshMatcapMaterial ä¸å¯¹ç¯å…‰ä½œå‡ºååº”ã€‚ å®ƒå°†ä¼šæŠ•å°„é˜´å½±åˆ°ä¸€ä¸ªæ¥å—é˜´å½±çš„ç‰©ä½“ä¸Š(and shadow clipping works)ï¼Œä½†ä¸ä¼šäº§ç”Ÿè‡ªèº«é˜´å½±æˆ–æ˜¯æ¥å—é˜´å½±ã€‚mapcatæè´¨å¤§å…¨ MeshToonMaterialï¼šä¸€ç§å®ç°å¡é€šç€è‰²çš„æè´¨ã€‚ MeshNormalMaterialï¼šä¸€ç§æŠŠæ³•å‘é‡æ˜ å°„åˆ°RGBé¢œè‰²çš„æè´¨ã€‚ï¼ˆæœ‰ç‚¹èµ›åšæœ‹å…‹ã€å®‡å®™è‰²å½©ç³»åˆ—çš„é£æ ¼ï¼‰ MeshLambertMaterialï¼šä¸€ç§éå…‰æ³½è¡¨é¢çš„æè´¨ï¼Œæ²¡æœ‰é•œé¢é«˜å…‰ã€‚è¯¥æè´¨ä½¿ç”¨åŸºäºéç‰©ç†çš„Lambertianæ¨¡å‹æ¥è®¡ç®—åå°„ç‡ã€‚ è¿™å¯ä»¥å¾ˆå¥½åœ°æ¨¡æ‹Ÿä¸€äº›è¡¨é¢ï¼ˆä¾‹å¦‚æœªç»å¤„ç†çš„æœ¨ææˆ–çŸ³æï¼‰ï¼Œä½†ä¸èƒ½æ¨¡æ‹Ÿå…·æœ‰é•œé¢é«˜å…‰çš„å…‰æ³½è¡¨é¢ï¼ˆä¾‹å¦‚æ¶‚æ¼†æœ¨æï¼‰ã€‚ MeshPhongMaterialï¼šä¸€ç§ç”¨äºå…·æœ‰é•œé¢é«˜å…‰çš„å…‰æ³½è¡¨é¢çš„æè´¨ã€‚è¯¥æè´¨ä½¿ç”¨éç‰©ç†çš„Blinn-Phongæ¨¡å‹æ¥è®¡ç®—åå°„ç‡ã€‚ ä¸MeshLambertMaterialä¸­ä½¿ç”¨çš„Lambertianæ¨¡å‹ä¸åŒï¼Œè¯¥æè´¨å¯ä»¥æ¨¡æ‹Ÿå…·æœ‰é•œé¢é«˜å…‰çš„å…‰æ³½è¡¨é¢ï¼ˆä¾‹å¦‚æ¶‚æ¼†æœ¨æï¼‰ã€‚ï¼ˆè§‚æ„Ÿæ›´ä½³ï¼‰ MeshStandardMaterialï¼šä¸€ç§åŸºäºç‰©ç†çš„æ ‡å‡†æè´¨ï¼Œä½¿ç”¨Metallic-Roughnesså·¥ä½œæµç¨‹ã€‚ åŸºäºç‰©ç†çš„æ¸²æŸ“ï¼ˆPBRï¼‰æœ€è¿‘å·²æˆä¸ºè®¸å¤š3Dåº”ç”¨ç¨‹åºçš„æ ‡å‡†ï¼Œä¾‹å¦‚Unityï¼Œ Unrealå’Œ 3D Studio Maxã€‚ åœ¨å®è·µä¸­ï¼Œè¯¥æè´¨æä¾›äº†æ¯”MeshLambertMaterial æˆ–MeshPhongMaterial æ›´ç²¾ç¡®å’Œé€¼çœŸçš„ç»“æœï¼Œä»£ä»·æ˜¯è®¡ç®—æˆæœ¬æ›´é«˜ã€‚ MeshPhysicalMaterialï¼šï¼ˆæœ€è€—è´¹æ€§èƒ½ï¼‰ MeshStandardMaterialçš„æ‰©å±•ï¼Œæä¾›äº†æ›´é«˜çº§çš„åŸºäºç‰©ç†çš„æ¸²æŸ“å±æ€§ï¼š Clearcoat: æœ‰äº›ç±»ä¼¼äºè½¦æ¼†ï¼Œç¢³çº¤ï¼Œè¢«æ°´æ‰“æ¹¿çš„è¡¨é¢çš„æè´¨éœ€è¦åœ¨é¢ä¸Šå†å¢åŠ ä¸€ä¸ªé€æ˜çš„ï¼Œå…·æœ‰ä¸€å®šåå…‰ç‰¹æ€§çš„é¢ã€‚è€Œä¸”è¿™ä¸ªé¢è¯´ä¸å®šæœ‰ä¸€å®šçš„èµ·ä¼ä¸ç²—ç³™åº¦ã€‚Clearcoatå¯ä»¥åœ¨ä¸éœ€è¦é‡æ–°åˆ›å»ºä¸€ä¸ªé€æ˜çš„é¢çš„æƒ…å†µä¸‹åšåˆ°ç±»ä¼¼çš„æ•ˆæœã€‚ åŸºäºç‰©ç†çš„é€æ˜åº¦:.opacityå±æ€§æœ‰ä¸€äº›é™åˆ¶:åœ¨é€æ˜åº¦æ¯”è¾ƒé«˜çš„æ—¶å€™ï¼Œåå°„ä¹Ÿéšä¹‹å‡å°‘ã€‚ä½¿ç”¨åŸºäºç‰©ç†çš„é€å…‰æ€§.transmissionå±æ€§å¯ä»¥è®©ä¸€äº›å¾ˆè–„çš„é€æ˜è¡¨é¢ï¼Œä¾‹å¦‚ç»ç’ƒï¼Œå˜å¾—æ›´çœŸå®ä¸€äº›ã€‚ é«˜çº§å…‰çº¿åå°„: ä¸ºéé‡‘å±æè´¨æä¾›äº†æ›´å¤šæ›´çµæ´»çš„å…‰çº¿åå°„ã€‚ ç‰©ç†ç½‘æ ¼æè´¨ä½¿ç”¨äº†æ›´å¤æ‚çš„ç€è‰²å™¨åŠŸèƒ½ï¼Œæ‰€ä»¥åœ¨æ¯ä¸ªåƒç´ çš„æ¸²æŸ“éƒ½è¦æ¯”three.jsä¸­çš„å…¶ä»–æè´¨æ›´è´¹æ€§èƒ½ï¼Œå¤§éƒ¨åˆ†çš„ç‰¹æ€§æ˜¯é»˜è®¤å…³é—­çš„ï¼Œéœ€è¦æ‰‹åŠ¨å¼€å¯ï¼Œæ¯å¼€å¯ä¸€é¡¹åŠŸèƒ½åœ¨å¼€å¯çš„æ—¶å€™æ‰ä¼šæ›´è€—æ€§èƒ½ã€‚è¯·æ³¨æ„ï¼Œä¸ºè·å¾—æœ€ä½³æ•ˆæœï¼Œæ‚¨åœ¨ä½¿ç”¨æ­¤æè´¨æ—¶åº”å§‹ç»ˆæŒ‡å®šenvironment mapã€‚ é€šè¿‡ material.wireframe = true è¿˜å¯ä»¥æŸ¥çœ‹é¡¶ç‚¹ç›¸å…³ä¿¡æ¯ PointsMaterial: ç‚¹ææ–™ï¼Œä¸»è¦ç”¨æ¥åˆ¶é€ ç‚¹ æ¯ä¸ªææ–™çš„å…·ä½“å±æ€§ï¼Œå¯ä»¥åœ¨threejså®˜ç½‘æŸ¥çœ‹ å‚è€ƒæ–‡ç«  Three.js Fundamentals","categories":[{"name":"å‰ç«¯","slug":"å‰ç«¯","permalink":"https://taylor12138.github.io/categories/%E5%89%8D%E7%AB%AF/"}],"tags":[],"author":"Hello"},{"title":"Threejs(ä¸‹)","slug":"Threejs(ä¸‹)","date":"2022-03-19T16:00:00.000Z","updated":"2023-05-25T16:11:53.709Z","comments":true,"path":"2022/03/20/threejs-xia/","link":"","permalink":"https://taylor12138.github.io/2022/03/20/threejs-xia/","excerpt":"","text":"5.å®è·µå°å®è·µï¼ˆåœºæ™¯+é˜´å½±+å°ç«‹æ–¹ä½“ï¼‰ const scene = new THREE.Scene(); const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000); //ä¸€èˆ¬å¯ä»¥è®¾ç½®ä¸º75Â°ã€45Â°çš„è§’åº¦ç­‰ const renderer = new THREE.WebGLRenderer(); //è®¾ç½®æ¸²æŸ“å™¨åˆå§‹é¢œè‰² renderer.setClearColor(new THREE.Color(0xFFFFFF)) renderer.setSize(window.innerWidth, window.innerHeight); // æ˜¾ç¤ºæ¸²æŸ“ç‰©ä½“çš„é˜´å½± renderer.shadowMapEnabled = true; //æ˜¾ç¤ºä¸‰ç»´åæ ‡ç³» const axes = new THREE.AxisHelper(20) //æ·»åŠ åˆ°åœºæ™¯ä¸­ scene.add(axes) /*************************åœ°é¢*************************/ //è®¾ç½®ä¸€ä¸ªåœ°é¢å‡ ä½•ä½“ const planeGeometry = new THREE.PlaneGeometry(50, 50) //ç»™åœ°é¢ä¸Šè‰² const planeMaterial = new THREE.MeshBasicMaterial({ color: 0xcccc }) //ç»“åˆæè´¨ const plane = new THREE.Mesh(planeGeometry, planeMaterial) //ç‰©å“ç§»åŠ¨ä½ç½® plane.rotation.x = -0.5 * Math.PI // è®¾ç½®åœ°é¢é˜´å½±+æ¥å—å…¶ä»–é˜´å½± plane.castShadow = true; plane.receiveShadow = true scene.add(plane) /***********************æ·»åŠ ç«‹æ–¹ä½“*****************/ //è®¾ç½®ä¸€ä¸ªç«‹æ–¹ä½“ï¼Œä¼ å…¥é•¿å®½é«˜ const cubeGeometry = new THREE.BoxGeometry(4, 4, 4) //MeshBasicMaterialæè´¨ä¸å—å…‰ç…§çš„å½±å“ï¼Œæ‰€ä»¥è¿™é‡Œç”¨MeshLambertMaterial const cubeMaterial = new THREE.MeshLambertMaterial({ color: 0x00ff }) const cube = new THREE.Mesh(cubeGeometry, cubeMaterial) cube.position.y = 5 //å¯¹è±¡æ˜¯å¦æ¸²æŸ“åˆ°é˜´å½±è´´å›¾å½“ä¸­ cube.castShadow = true; scene.add(cube) /***********åˆ›å»ºä¸€ä¸ªèšå…‰ç¯ï¼ˆæ‰ä¼šæœ‰é˜´å½±æ•ˆæœï¼‰***********/ // ä¼ å…¥ä¸€ä¸ªå‚æ•°ï¼Œä¸ºç¯å…‰é¢œè‰² const spotLight = new THREE.SpotLight(0xFFFFFF); spotLight.position.set(130, 130, -130); spotLight.castShadow = true; // æ·»åŠ èšå…‰ç¯ scene.add(spotLight) /***************å®šä½ç›¸æœºï¼Œå¹¶ä¸”æŒ‡å‘åœºæ™¯ä¸­å¿ƒ***********/ camera.position.x = 30; camera.position.y = 30; camera.position.z = 30; camera.lookAt(scene.position) //æœ€åå†æ·»åŠ åˆ°æ–‡æ¡£ä¸­ document.body.appendChild(renderer.domElement); renderer.render(scene, camera) å°å®è·µæ¨èç½‘ç«™https://github.com/JChehe/blog/issues/44 ä¸€ä¸ªæ¢è‚¤å°æ¤…å­ä½œä¸ºå®è·µ https://github.com/JChehe/blog/issues/45 3dä»»åŠ¡äº¤äº’ï¼ˆè¿›é˜¶ç‰ˆï¼‰ 6.æ§åˆ¶å™¨è¿™é‡Œè¯´çš„æ§åˆ¶å™¨ï¼Œä¸å¦‚è¯´æ˜¯ç›¸æœºçš„æ§åˆ¶å™¨ï¼Œä¸€èˆ¬æ¥è¯´æˆ‘ä»¬å¯ä»¥é€šè¿‡è®¾ç½®æ§åˆ¶å™¨ï¼Œæ§åˆ¶é•œå¤´ï¼Œæˆ–è€…å…¶ä»–ç‰©ä½“è¿›è¡Œå˜æ¢ è¿™é‡Œç¤ºèŒƒä¸€ä¸ªè½¨é“æ§åˆ¶å™¨(æœ€å¸¸ç”¨) //å¯¼å…¥æ§åˆ¶å™¨ï¼Œè½¨é“æ§åˆ¶å™¨ï¼ˆå›´ç»•ç‰©ä½“æŸ¥çœ‹ï¼‰ import { OrbitControls } from \"three/examples/jsm/controls/OrbitControls\"; //é•œå¤´æ§åˆ¶å™¨ initControls() { // è¿™é‡Œæˆ‘åœ¨domä¸­æ§åˆ¶é•œå¤´,è¿›è¡Œè½¨é“ç§»åŠ¨ this.controls = new OrbitControls(this.camera, this.renderer.domElement); } æ­¤æ—¶æˆ‘ä»¬å°±å¯ä»¥è½¬åŠ¨æ‘„åƒå¤´è¿›è¡Œ360Â°æ—‹è½¬äº†ï¼ ï¼ˆå†…éƒ¨å®é™…ä¸Šæ„Ÿè§‰æ˜¯é€šè¿‡mousemoveä¹‹ç±»çš„ç›‘å¬å½“å‰domå…ƒç´ çš„äº‹ä»¶ï¼Œç„¶åsinã€cosè°ƒæ•´cameraçš„positionï¼Œæ­¤æ—¶å½¢æˆä¸€ä¸ªè½¨é“çš„æ•ˆæœï¼‰ ç„¶ååœ¨ä½¿ç”¨è½¨é“æ§åˆ¶å™¨æ—¶ï¼Œè¿˜å¯ä»¥è®¾ç½®targetï¼š .target : Vector3 æ§åˆ¶å™¨çš„ç„¦ç‚¹ï¼Œ.objectçš„è½¨é“å›´ç»•å®ƒè¿è¡Œï¼Œé»˜è®¤ä¸ºVector3(0, 0, 0)ã€‚ å®ƒå¯ä»¥åœ¨ä»»ä½•æ—¶å€™è¢«æ‰‹åŠ¨æ›´æ–°ï¼Œä»¥æ›´æ”¹æ§åˆ¶å™¨çš„ç„¦ç‚¹ã€‚ è¯·æ³¨æ„ï¼Œå¦‚æœè¯¥å€¼è¢«å¯ç”¨ï¼Œä½ å°†å¿…é¡»åœ¨ä½ çš„åŠ¨ç”»å¾ªç¯é‡Œè°ƒç”¨.update()ã€‚ controls.target.set( 0, 0.5, 0 ); å¦å¤–ä¸€ä¸ªå¸¸ç”¨çš„å°±æ˜¯æŒ‡é’ˆé”å®šæ§åˆ¶å™¨ï¼ˆPointerLockControlsï¼‰ è¯¥ç±»çš„å®ç°æ˜¯åŸºäºPointer Lock APIçš„ã€‚ å¯¹äºç¬¬ä¸€äººç§°3Dæ¸¸æˆæ¥è¯´ï¼Œ PointerLockControls æ˜¯ä¸€ä¸ªéå¸¸å®Œç¾çš„é€‰æ‹©ã€‚ å…¶ä»–æ§åˆ¶å™¨å¯ä»¥åœ¨è¿™é‡ŒæŸ¥çœ‹ OrbitControlséƒ¨åˆ†å±æ€§ æ³¨æ„ï¼šä½¿ç”¨äº†æ§åˆ¶å™¨ä¹‹åè®°å¾—åœ¨æ¯æ¬¡åŠ¨ç”»renderçš„æ—¶å€™controls.update(); å½“ç„¶ä¹Ÿå¯ä»¥è‡ªå·±æ·»åŠ äº›æ§åˆ¶å™¨çš„å±æ€§ this.controls.maxPolarAngle = Math.PI / 2; this.controls.minPolarAngle = Math.PI / 3; this.controls.enableDamping = true; this.controls.enablePan = false; this.controls.dampingFactor = 0.1; this.controls.autoRotate = false; // this.controls.autoRotateSpeed = 0.2; // 30 .enabled: Boolean å½“è®¾ç½®ä¸ºfalseæ—¶ï¼Œå°†æš‚æ—¶å…³é—­æ§åˆ¶å™¨ï¼Œé»˜è®¤ä¸ºtrue .maxPolarAngle : Float ä½ èƒ½å¤Ÿå‚ç›´æ—‹è½¬çš„è§’åº¦çš„ä¸Šé™ï¼ŒèŒƒå›´æ˜¯0åˆ°Math.PIï¼Œå…¶é»˜è®¤å€¼ä¸ºMath.PIã€‚ .enableDamping : Boolean å°†å…¶è®¾ç½®ä¸ºtrueä»¥å¯ç”¨é˜»å°¼ï¼ˆæƒ¯æ€§ï¼‰ï¼Œè¿™å°†ç»™æ§åˆ¶å™¨å¸¦æ¥é‡é‡æ„Ÿã€‚é»˜è®¤å€¼ä¸ºfalseã€‚ä½ å¯ä»¥ç†è§£ä¸ºå®ƒä¼šè®©ä½ æ§åˆ¶å™¨çš„åŠ¨ä½œæ›´ä¸æ»‘ï¼Œç¬¦åˆç‰©ç†æ€§è´¨è¯·æ³¨æ„ï¼Œå¦‚æœè¯¥å€¼è¢«å¯ç”¨ï¼Œä½ å°†å¿…é¡»åœ¨ä½ çš„åŠ¨ç”»å¾ªç¯é‡Œè°ƒç”¨.update()ã€‚ .enablePan : Boolean å¯ç”¨æˆ–ç¦ç”¨æ‘„åƒæœºå¹³ç§»ï¼Œé»˜è®¤ä¸ºtrueã€‚ .dampingFactor : Float å½“.enableDampingè®¾ç½®ä¸ºtrueçš„æ—¶å€™ï¼Œé˜»å°¼æƒ¯æ€§æœ‰å¤šå¤§ã€‚è¯·æ³¨æ„ï¼Œè¦ä½¿å¾—è¿™ä¸€å€¼ç”Ÿæ•ˆï¼Œä½ å¿…é¡»åœ¨ä½ çš„åŠ¨ç”»å¾ªç¯é‡Œè°ƒç”¨.update()ã€‚ .autoRotate : Boolean å°†å…¶è®¾ä¸ºtrueï¼Œä»¥è‡ªåŠ¨å›´ç»•ç›®æ ‡æ—‹è½¬ã€‚è¯·æ³¨æ„ï¼Œå¦‚æœå®ƒè¢«å¯ç”¨ï¼Œä½ å¿…é¡»åœ¨ä½ çš„åŠ¨ç”»å¾ªç¯é‡Œè°ƒç”¨.update()ã€‚ .autoRotateSpeed : Float å½“.autoRotateä¸ºtrueæ—¶ï¼Œå›´ç»•ç›®æ ‡æ—‹è½¬çš„é€Ÿåº¦å°†æœ‰å¤šå¿«ï¼Œé»˜è®¤å€¼ä¸º2.0ï¼Œç›¸å½“äºåœ¨60fpsæ—¶æ¯æ—‹è½¬ä¸€å‘¨éœ€è¦30ç§’ã€‚è¯·æ³¨æ„ï¼Œå¦‚æœ.autoRotateè¢«å¯ç”¨ï¼Œä½ å¿…é¡»åœ¨ä½ çš„åŠ¨ç”»å¾ªç¯é‡Œè°ƒç”¨.update()ã€‚ å› ä¸ºå¯ç”¨äº†ä»¥ä¸Šéƒ¨åˆ†å±æ€§ï¼Œæ‰€ä»¥éœ€è¦åœ¨animateä¸­è°ƒç”¨update æ³¨æ„ï¼Œå¦‚æœé€šè¿‡æ”¹å˜ç›¸æœºä½ç½®è€Œå‘ç”Ÿå½“å‰è§†è§’åç§»ï¼Œç›¸æœºè§†è§’æ²¡æœ‰èšç„¦äºå¯¹è±¡çš„æƒ…å†µä¸‹ï¼Œåœ¨åŠ¨ç”»animateä¸­è°ƒç”¨this.controls.update()ä¹Ÿå¯ä»¥è§£å†³ // åŠ¨ç”»å‡½æ•° animate() { this.controls.update(); this.renderer.setAnimationLoop(this.render.bind(this)); } 7.æ·»åŠ æ¨¡å‹é™¤äº†è‡ªå·±æ‰‹åŠ¨åˆ›å»ºé›†åˆä½“ï¼Œæ¥ç»™å½“å‰åœºæ™¯æ·»åŠ æ¨¡å‹ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥å¯¼å…¥æ¨¡å‹ï¼ˆglbæ–‡ä»¶ã€OBJæ–‡ä»¶ã€GLTFæ–‡ä»¶ï¼‰ glbæ–‡ä»¶ï¼šGLBæ–‡ä»¶æ˜¯ä»¥å›¾å½¢è¯­è¨€ä¼ è¾“æ ¼å¼ï¼ˆGLTFï¼‰ä¿å­˜çš„3Dæ¨¡å‹ï¼Œå®ƒä»¥äºŒè¿›åˆ¶æ ¼å¼å­˜å‚¨æœ‰å…³3Dæ¨¡å‹çš„ä¿¡æ¯ï¼ŒåŒ…æ‹¬èŠ‚ç‚¹å±‚çº§ã€æ‘„åƒæœºã€æè´¨ã€åŠ¨ç”»å’Œç½‘æ ¼ã€‚GLBæ–‡ä»¶æ˜¯.GLTFæ–‡ä»¶çš„äºŒè¿›åˆ¶ç‰ˆæœ¬ã€‚ æ–‡ä»¶æ ¼å¼ï¼ˆFile Formatï¼‰æ˜¾ç„¶ Three.js æ”¯æŒå¾ˆå¤š 3D å¯¹è±¡æ–‡ä»¶æ ¼å¼ï¼Œä½†å®ƒæ¨èçš„æ ¼å¼ä¹‹ä¸€æ˜¯ glTF(.glb)ã€‚åŒæ—¶ Blender ä¹Ÿæ”¯æŒå¯¼å‡ºè¯¥æ ¼å¼ï¼Œæ‰€ä»¥æ¯«æ— ç–‘è™‘ã€‚ // å¯¼å…¥æ¨¡å‹è§£æå™¨ import { GLTFLoader } from \"three/examples/jsm/loaders/GLTFLoader\"; setModel(modelName) { // ç”±äºæ·»åŠ æ¨¡å‹æ˜¯å¼‚æ­¥æ“ä½œï¼Œæ‰€ä»¥å¯ä»¥å°è£…ä¸€ä¸ªpromiseç»™å®ƒ return new Promise((res, rej) => { //public/gltf/æ¨¡å‹æ–‡ä»¶ const loader = new GLTFLoader().setPath(\"gltf/\"); loader.load(modelName, (gltf) => { this.model = gltf.scene.children[0]; // è°ƒæ•´æ¨¡å‹å¤§å°,æˆ–è€…ä¸è®¾ç½®ä¹Ÿè¡Œ this.model.scale.set(7, 7, 7); this.scene.add(this.model); res(modelName + \"æ·»åŠ æˆåŠŸ\"); }); }); } æ­¤æ—¶modalç»§æ‰¿Object 3Dï¼Œå¯ä»¥è®¾ç½®æ¨¡å‹å¤§å°ã€æ¨¡å‹ä½ç½®ã€æ¨¡å‹æ—‹è½¬è§’åº¦ åˆ é™¤æ¨¡å‹ï¼š this.model &amp;&amp; this.model.removeFromParent() æ¨¡å‹traverseæ–¹æ³•ä¸€èˆ¬blenderçš„glbæ¨¡å‹ï¼Œé€šè¿‡gltf.sceneå¾—åˆ°çš„æ¨¡å‹ï¼ˆmodelï¼‰ï¼Œéƒ½ä¼šæœ‰ traverse æ–¹æ³•ï¼Œæ–¹æ³•éå†æ‰€æœ‰ç½‘æ ¼ï¼ˆmeshï¼‰ä»¥å¯ç”¨æŠ•å°„å’Œæ¥æ”¶é˜´å½±çš„èƒ½åŠ›ã€‚è¯¥æ“ä½œéœ€è¦åœ¨ scene.add(model) å‰å®Œæˆã€‚ å› æ­¤æˆ‘ä»¬å¯ä»¥é€šè¿‡ ``traverseéå† ä¿®æ”¹æ¨¡å‹ä¸­çš„æŸä¸ªéƒ¨ä½çš„æè´¨ã€é¢œè‰²ã€é˜´å½± //æ·»åŠ é˜´å½±ï¼Œè°ƒæ•´æ¨¡å‹æè´¨ this.model.traverse((o) => { if (o.isBone) { console.log(o.name);//è¾“å‡ºmodelé‡Œé¢åŒ…å«çš„éª¨å¤´ } if (o.isMesh) { o.castShadow = true; o.receiveShadow = true; o.material = stacy_mtl; // Add this line } }); æ·»åŠ æ¨¡å‹åœ°æ¿// æ·»åŠ åœ°æ¿ setFloor() { // Floor var floorGeometry = new THREE.PlaneGeometry(5000, 5000, 1, 1); var floorMaterial = new THREE.MeshPhongMaterial({ color: 0xeeeeee, shininess: 0, }); var floor = new THREE.Mesh(floorGeometry, floorMaterial); floor.rotation.x = -0.5 * Math.PI; floor.receiveShadow = true; floor.position.y = -11; this.scene.add(floor); } PlaneGeometry ä¸€ä¸ªç”¨äºç”Ÿæˆå¹³é¢å‡ ä½•ä½“çš„ç±»ã€‚ width â€” å¹³é¢æ²¿ç€Xè½´çš„å®½åº¦ã€‚é»˜è®¤å€¼æ˜¯1ã€‚ height â€” å¹³é¢æ²¿ç€Yè½´çš„é«˜åº¦ã€‚é»˜è®¤å€¼æ˜¯1ã€‚ widthSegments â€” ï¼ˆå¯é€‰ï¼‰å¹³é¢çš„å®½åº¦åˆ†æ®µæ•°ï¼Œé»˜è®¤å€¼æ˜¯1ã€‚ heightSegments â€” ï¼ˆå¯é€‰ï¼‰å¹³é¢çš„é«˜åº¦åˆ†æ®µæ•°ï¼Œé»˜è®¤å€¼æ˜¯1ã€‚ å½“ç„¶ä¹Ÿå¯ä»¥è®¾ç½®ç½‘æ ¼ var gridHelper = new THREE.GridHelper(200, 25); gridHelper.position.y = -11; this.scene.add(gridHelper); æ¨¡å‹ç´ æä¸€èˆ¬å‰ç«¯äººå‘˜å¾ˆéš¾è‡ªå·±å»é€ ç´ æï¼Œä»¥ä¸‹æ˜¯ä¸€äº›3dæ¨¡å‹å¾—ç´ æç½‘ç«™ https://www.mixamo.com/ ä½¿ç”¨mixamoçš„æ¨¡å‹ä¹‹åï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹ç½‘ç«™ï¼Œå°†åŠ¨ç”»å¯¼å…¥æ¨¡å‹ï¼šhttps://nilooy.github.io/character-animation-combiner/ https://sketchfab.com/ ï¼ˆéƒ¨åˆ†ä»˜è´¹ï¼‰ è¿˜æœ‰ä¸€ä¸ªå…³äºå»ºæ¨¡å¾ˆé…·çš„ç½‘ç«™ï¼šhttps://marmoset.co/ FBXæ–‡ä»¶è€Œç½‘ç«™ä¸Šä¸€äº›ç´ æä¸‹è½½ä»¥åæ˜¯ .fbx æ–‡ä»¶æ ¼å¼ï¼Œè¿™æ—¶å€™æˆ‘ä»¬ä½¿ç”¨çš„åŠ è½½å™¨å¯ä»¥ä¸ºFBXLoader import { FBXLoader } from \"three/examples/jsm/loaders/FBXLoader\"; è€Œå®ƒçš„ä½¿ç”¨æ–¹å¼ä»ç„¶æ˜¯å’Œ GLTFLoader å·®ä¸å¤šï¼Œé€šè¿‡ setPath å’Œ .loadæ–¹æ³•å»ä½¿ç”¨ const loader = new FBXLoader().setPath(`fbx/${this.charactorName}/`); return new Promise((res, rej) => { loader.load( \"people.fbx\", (fbx) => { console.log(fbx, \"fbx\"); // this.loaderAnim.remove(); fbx.scale.setScalar(0.3); this.model = fbx; this.model.position.y = -10; this.model.rotation.y = Math.PI / 2; // æ·»åŠ é˜´å½± this.model.traverse((o) => { if (o.isMesh) { o.castShadow = true; o.receiveShadow = true; } }); this.scene.add(this.model); res(); }, undefined, function (error) { console.error(error); } ); }); 8.ç¯å…‰ç¼ºå°‘å…‰ï¼Œæ‘„åƒæœºå°±ä¸èƒ½çœ‹åˆ°ä»»ä½•æœ‰åå…‰æè´¨çš„ä¸œè¥¿ å…‰æºä»‹ç» SpotLight( color : Integer, intensity : Float, distance : Float, angle : Radians, penumbra : Float, decay : Float ) èšå…‰ç¯ï¼Œä¸€ä¸ªå…‰ç…§èŒƒå›´ä¸ºé”¥ä½“çš„ç¯ï¼ˆæ–¹å‘å…‰ï¼‰ color - (å¯é€‰å‚æ•°) åå…­è¿›åˆ¶å…‰ç…§é¢œè‰²ã€‚ ç¼ºçœå€¼ 0xffffff (ç™½è‰²)ã€‚ intensity - (å¯é€‰å‚æ•°) å…‰ç…§å¼ºåº¦ã€‚ ç¼ºçœå€¼ 1ã€‚ distance - ä»å…‰æºå‘å‡ºå…‰çš„æœ€å¤§è·ç¦»ï¼Œå…¶å¼ºåº¦æ ¹æ®å…‰æºçš„è·ç¦»çº¿æ€§è¡°å‡ã€‚ angle - å…‰çº¿æ•£å°„è§’åº¦ï¼Œæœ€å¤§ä¸ºMath.PI/2ã€‚ penumbra - èšå…‰é”¥çš„åŠå½±è¡°å‡ç™¾åˆ†æ¯”ã€‚åœ¨0å’Œ1ä¹‹é—´çš„å€¼ã€‚é»˜è®¤ä¸º0ã€‚ decay - æ²¿ç€å…‰ç…§è·ç¦»çš„è¡°å‡é‡ã€‚ å…‰çº¿ä»ä¸€ä¸ªç‚¹æ²¿ä¸€ä¸ªæ–¹å‘å°„å‡ºï¼Œéšç€å…‰çº¿ç…§å°„çš„å˜è¿œï¼Œå…‰çº¿åœ†é”¥ä½“çš„å°ºå¯¸ä¹Ÿé€æ¸å¢å¤§ï¼Œå’Œæ‰‹ç”µç­’ç±»ä¼¼ï¼ˆäº§ç”Ÿé˜´å½±ï¼‰ AmbientLight( color : Integer, intensity : Float )ï¼ˆç¯å¢ƒå…‰ï¼‰ï¼ˆä¸èƒ½æŠ•å°„é˜´å½±ï¼‰ color - (å‚æ•°å¯é€‰ï¼‰é¢œè‰²çš„rgbæ•°å€¼ã€‚ç¼ºçœå€¼ä¸º 0xffffffã€‚ intensity - (å‚æ•°å¯é€‰)å…‰ç…§çš„å¼ºåº¦ã€‚ç¼ºçœå€¼ä¸º 1ã€‚ ç¯å¢ƒå…‰ä¼šå‡åŒ€çš„ç…§äº®åœºæ™¯ä¸­çš„æ‰€æœ‰ç‰©ä½“ã€‚ç‰¹ç‚¹ä¹Ÿå°±æ˜¯å‡åŒ€ç…§äº®ï¼Œè®©æˆ‘ä»¬çœ‹çš„è§ç‰©ä½“ï¼Œå®é™…ä¸Šæˆ‘ä»¬å¯ä»¥å°†å…¶è§†ä¸ºâ€œäº®åº¦â€ ç¯å¢ƒå…‰ä¸èƒ½ç”¨æ¥æŠ•å°„é˜´å½±ï¼Œå› ä¸ºå®ƒæ²¡æœ‰æ–¹å‘ã€‚ PointLight( color : Integer, intensity : Float, distance : Number, decay : Float ) ç‚¹å…‰æºï¼ˆæ–¹å‘å…‰ï¼‰ color - (å¯é€‰å‚æ•°)) åå…­è¿›åˆ¶å…‰ç…§é¢œè‰²ã€‚ ç¼ºçœå€¼ 0xffffff (ç™½è‰²)ã€‚ intensity - (å¯é€‰å‚æ•°) å…‰ç…§å¼ºåº¦ã€‚ ç¼ºçœå€¼ 1ã€‚ distance - è¿™ä¸ªè·ç¦»è¡¨ç¤ºä»å…‰æºåˆ°å…‰ç…§å¼ºåº¦ä¸º0çš„ä½ç½®ã€‚ å½“è®¾ç½®ä¸º0æ—¶ï¼Œå…‰æ°¸è¿œä¸ä¼šæ¶ˆå¤±(è·ç¦»æ— ç©·å¤§)ã€‚ç¼ºçœå€¼ 0. decay - æ²¿ç€å…‰ç…§è·ç¦»çš„è¡°é€€é‡ã€‚ç¼ºçœå€¼ 2ã€‚ ä»ä¸€ä¸ªç‚¹å‘å„ä¸ªæ–¹å‘å‘å°„çš„å…‰æºã€‚ä¸€ä¸ªå¸¸è§çš„ä¾‹å­æ˜¯æ¨¡æ‹Ÿä¸€ä¸ªç¯æ³¡å‘å‡ºçš„å…‰ã€‚ RectAreaLight( color : Integer, intensity : Float, width : Float, height : Float )å¹³é¢å…‰å…‰æºï¼ˆæ–¹å‘å…‰ï¼‰ color - (å¯é€‰å‚æ•°) åå…­è¿›åˆ¶æ•°å­—è¡¨ç¤ºçš„å…‰ç…§é¢œè‰²ã€‚ç¼ºçœå€¼ä¸º 0xffffff (ç™½è‰²) intensity - (å¯é€‰å‚æ•°) å…‰æºå¼ºåº¦ï¼äº®åº¦ ã€‚ç¼ºçœå€¼ä¸º 1ã€‚ width - (å¯é€‰å‚æ•°) å…‰æºå®½åº¦ã€‚ç¼ºçœå€¼ä¸º 10ã€‚ height - (å¯é€‰å‚æ•°) å…‰æºé«˜åº¦ã€‚ç¼ºçœå€¼ä¸º 10ã€‚ å¹³é¢å…‰å…‰æºä»ä¸€ä¸ªçŸ©å½¢å¹³é¢ä¸Šå‡åŒ€åœ°å‘å°„å…‰çº¿ï¼Œé•¿å¾—åƒä¸€ä¸ªæ‰“å…‰æ¿ä¸€æ ·ï¼Œè¿™ç§å…‰æºå¯ä»¥ç”¨æ¥æ¨¡æ‹Ÿåƒæ˜äº®çš„çª—æˆ·æˆ–è€…æ¡çŠ¶ç¯å…‰å…‰æºã€‚å¸¸åº”ç”¨äºå®¶å…·å»ºæ¨¡ è¿˜å¯ä»¥é€šè¿‡ RectAreaLight.lookAt(x, y, z) å»è®¾ç½®é¢å‘çš„æ–¹å‘ æ³¨æ„ï¼šä¸æ”¯æŒé˜´å½±ï¼Œåªæ”¯æŒ MeshStandardMaterial å’Œ MeshPhysicalMaterial ä¸¤ç§æè´¨ï¼Œä½ å¿…é¡»åœ¨ä½ çš„åœºæ™¯ä¸­åŠ å…¥ RectAreaLightUniformsLib ï¼Œå¹¶è°ƒç”¨init()ã€‚ import {RectAreaLightUniformsLib} from 'three/addons/lights/RectAreaLightUniformsLib.js HemisphereLightï¼šï¼ˆç¯å¢ƒå…‰ï¼‰ï¼ˆä¸èƒ½æŠ•å°„é˜´å½±ï¼‰ skyColor - (å¯é€‰å‚æ•°) å¤©ç©ºä¸­å‘å‡ºå…‰çº¿çš„é¢œè‰²ã€‚ ç¼ºçœå€¼ 0xffffffã€‚ groundColor - (å¯é€‰å‚æ•°) åœ°é¢å‘å‡ºå…‰çº¿çš„é¢œè‰²ã€‚ ç¼ºçœå€¼ 0xffffffã€‚ intensity - (å¯é€‰å‚æ•°) å…‰ç…§å¼ºåº¦ã€‚ ç¼ºçœå€¼ 1ã€‚ åŠçƒå…‰ï¼Œå…‰æºç›´æ¥æ”¾ç½®äºåœºæ™¯ä¹‹ä¸Šï¼Œå…‰ç…§é¢œè‰²ä»å¤©ç©ºå…‰çº¿é¢œè‰²æ¸å˜åˆ°åœ°é¢å…‰çº¿é¢œè‰²ã€‚æœ‰ç‚¹åƒAmbientLightçš„å‡çº§ç‰ˆï¼Œå¯ä»¥å…¼é¡¾ä¸Šæ–¹å’Œä¸‹æ–¹çš„ç¯å¢ƒå…‰ ä¸ºå®¤å¤–åœºæ™¯åˆ›é€ æ›´åŠ è‡ªç„¶çš„å…‰ç…§ var hemiLight = new THREE.HemisphereLight(0xffffff, 0xffffff, 0.61); hemiLight.position.set(0, 50, 0); // Add hemisphere light to scene this.scene.add(hemiLight); DirectionalLightï¼šå®šå‘å…‰ï¼Œè·ç¦»å¾ˆè¿œçš„å…‰ï¼Œä»–çš„æ‰€æœ‰å…‰éƒ½æ˜¯å¹³è¡Œçš„ï¼ˆæ–¹å‘å…‰ï¼Œæ¨¡æ‹Ÿå¤ªé˜³å…‰ï¼Œ æœ‰targetï¼‰ color - (å¯é€‰å‚æ•°) 16è¿›åˆ¶è¡¨ç¤ºå…‰çš„é¢œè‰²ã€‚ ç¼ºçœå€¼ä¸º 0xffffff (ç™½è‰²)ã€‚ intensity - (å¯é€‰å‚æ•°) å…‰ç…§çš„å¼ºåº¦ã€‚ç¼ºçœå€¼ä¸º1ã€‚ å¹³è¡Œå…‰æ˜¯æ²¿ç€ç‰¹å®šæ–¹å‘å‘å°„çš„å…‰ã€‚è¿™ç§å…‰çš„è¡¨ç°åƒæ˜¯æ— é™è¿œ,ä»å®ƒå‘å‡ºçš„å…‰çº¿éƒ½æ˜¯å¹³è¡Œçš„ã€‚å¸¸å¸¸ç”¨å¹³è¡Œå…‰æ¥æ¨¡æ‹Ÿå¤ªé˜³å…‰ çš„æ•ˆæœ; å¤ªé˜³è¶³å¤Ÿè¿œï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥è®¤ä¸ºå¤ªé˜³çš„ä½ç½®æ˜¯æ— é™è¿œï¼Œæ‰€ä»¥æˆ‘ä»¬è®¤ä¸ºä»å¤ªé˜³å‘å‡ºçš„å…‰çº¿ä¹Ÿéƒ½æ˜¯å¹³è¡Œçš„ã€‚ var dirLight = new THREE.DirectionalLight(0xffffff, 0.54); dirLight.position.set(-8, 12, 8); dirLight.castShadow = true; // Add directional Light to this.scene this.scene.add(dirLight); ä½†æ˜¯å³ä½¿æ˜¯æ¨¡æ‹Ÿå¤ªé˜³å…‰ï¼Œä½†æ˜¯ä»–ä¹Ÿæœ‰å…‰ç…§èŒƒå›´ï¼ˆå¯ä»¥ä½¿ç”¨ CameraHelper æŸ¥çœ‹é˜´å½±çš„è¦†ç›–èŒƒå›´ï¼Œè®°ä½ä¸€å®šè¦æ·»åŠ å®Œé˜´å½±æ‰æœ‰æ•ˆ ï¼‰ å¯¹äºæœ‰æ–¹å‘çš„å…‰ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹æ³•æ¥æŒ‡å®šå…‰ç…§ç›®æ ‡ dirLight.target.position.set(-5, 0, 0); //å¹³è¡Œå…‰çš„æ–¹å‘æ˜¯ä»å®ƒçš„ä½ç½®åˆ°ç›®æ ‡ä½ç½®ã€‚é»˜è®¤çš„ç›®æ ‡ä½ç½®ä¸ºåŸç‚¹ (0,0,0)ã€‚ //æ³¨æ„: å¯¹äºç›®æ ‡çš„ä½ç½®ï¼Œè¦å°†å…¶æ›´æ”¹ä¸ºé™¤ç¼ºçœå€¼ä¹‹å¤–çš„ä»»ä½•ä½ç½®,å®ƒå¿…é¡»è¢«æ·»åŠ åˆ° scene åœºæ™¯ä¸­å»ã€‚ this.scene.add(light.target); è¿˜å¯ä»¥ç”¨DirectionalLightHelperè¾…åŠ©æŸ¥çœ‹å…‰çº¿ DirectionalLightHelperï¼š ç”¨äºæ¨¡æ‹Ÿåœºæ™¯ä¸­å¹³è¡Œå…‰ DirectionalLight çš„è¾…åŠ©å¯¹è±¡. å…¶ä¸­åŒ…å«äº†è¡¨ç¤ºå…‰ä½ç½®çš„å¹³é¢å’Œè¡¨ç¤ºå…‰æ–¹å‘çš„çº¿æ®µ. ä»£ç ç¤ºä¾‹ const light = new THREE.DirectionalLight( 0xFFFFFF ); const helper = new THREE.DirectionalLightHelper( light, 5 ); scene.add( helper ); è¿™é‡Œæ¥ä¸€ä¸ªå°ä¾‹å­ è®©ä½ è‡ªå·±å°è¯•ä¸‹ï½ï¼šhttps://codesandbox.io/s/threejs-light-xdehpp?file=/src/script.js å…³äºå…‰ç…§çš„æ€è·¯ï¼š å…³äºå…‰ç…§ï¼Œæˆ‘ä»¬å°šæœªæåŠçš„æ˜¯ WebGLRenderer ä¸­æœ‰ä¸€ä¸ªè®¾ç½®é¡¹ physicallyCorrectLightsã€‚è¿™ä¸ªè®¾ç½®ä¼šå½±å“ï¼ˆéšç€ç¦»å…‰æºçš„è·ç¦»å¢åŠ ï¼‰å…‰ç…§å¦‚ä½•å‡å¼±ã€‚è¿™ä¸ªè®¾ç½®ä¼šå½±å“ç‚¹å…‰æºï¼ˆPointLightï¼‰å’Œèšå…‰ç¯ï¼ˆSpotLightï¼‰ï¼ŒçŸ©å½¢åŒºåŸŸå…‰ï¼ˆRectAreaLightï¼‰ä¼šè‡ªåŠ¨åº”ç”¨è¿™ä¸ªç‰¹æ€§ã€‚ åœ¨è®¾ç½®å…‰ç…§æ—¶ï¼ŒåŸºæœ¬æ€è·¯æ˜¯ä¸è¦è®¾ç½® distance æ¥è¡¨ç°å…‰ç…§çš„è¡°å‡ï¼Œä¹Ÿä¸è¦è®¾ç½® intensityã€‚è€Œæ˜¯è®¾ç½®å…‰ç…§çš„ power å±æ€§ï¼Œä»¥æµæ˜ä¸ºå•ä½ï¼Œthree.js ä¼šè¿›è¡Œç‰©ç†è®¡ç®—ï¼Œä»è€Œè¡¨ç°å‡ºæ¥è¿‘çœŸå®çš„å…‰ç…§æ•ˆæœã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ three.js å‚ä¸è®¡ç®—çš„é•¿åº¦å•ä½æ˜¯ç±³ï¼Œä¸€ä¸ª 60ç“¦ çš„ç¯æ³¡å¤§æ¦‚æ˜¯ 800 æµæ˜å¼ºåº¦ã€‚å¹¶ä¸”å…‰æºæœ‰ä¸€ä¸ª decay å±æ€§ï¼Œä¸ºäº†æ¨¡æ‹ŸçœŸå®æ•ˆæœï¼Œåº”è¯¥è¢«è®¾ç½®ä¸º 2ã€‚ æ›´å¤šè¯¦æƒ…å¯ä»¥åœ¨è¿™é‡Œæ‰¾åˆ° æ³¨æ„ï¼Œæˆ‘ä»¬é™¤äº†å¯ä»¥ç»™åœºæ™¯sceneæ·»åŠ ç¯å…‰ï¼Œè¿˜å¯ä»¥ç»™æ‘„åƒæœºcameraæ·»åŠ ç¯å…‰ï¼Œæ¯”å¦‚å¸¸è§çš„ç‚¹å…‰æºï¼špointLight å…‰æºè¾…åŠ©çº¿//è¾…åŠ©å‡½æ•° //å…‰æºè¾…åŠ©å·¥å…· const lightHelper = new THREE.DirectionalLightHelper(dirLight); //å¯ä»¥çœ‹åˆ°å½“å‰ç›¸æœºå¯è§†èŒƒå›´ï¼Œè¿™é‡ŒæŸ¥çœ‹çš„äº‹é˜´å½±çš„è¦†ç›–èŒƒå›´ const shadowCameraHelper = new THREE.CameraHelper(dirLight.shadow.camera); this.scene.add(lightHelper); this.scene.add(shadowCameraHelper); æ ¹æ®ä»¥ä¸Šæ–¹æ³•ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥åœ¨ä½¿ç”¨ä¸åŒçš„å…‰çº¿æ—¶ï¼Œä»åº“ä¸­å¼•ç”¨ä¸åŒçš„è¾…åŠ©çº¿ xxxLightHelper ç”Ÿäº§ç¯å¢ƒä¸‹æˆ‘ä»¬å¯ä»¥éšè—æ‰ shadowCameraHelper.visible = false é•œå¤´å…‰æ™•ï¼ˆLensflareï¼‰åˆ›å»ºä¸€ä¸ªæ¨¡æ‹Ÿè¿½è¸ªç€ç¯å…‰çš„é•œå¤´å…‰æ™•ã€‚ LensflareElement( texture : Texture, size : Float, distance : Float, color : Color ) texture - ç”¨äºå…‰æ™•çš„THREE.Textureï¼ˆè´´å›¾ï¼‰ size - ï¼ˆå¯é€‰ï¼‰å…‰æ™•å°ºå¯¸ï¼ˆå•ä½ä¸ºåƒç´ ï¼‰ distance - ï¼ˆå¯é€‰ï¼‰å’Œå…‰æºçš„è·ç¦»å€¼åœ¨0åˆ°1ä¹‹é—´ï¼ˆå€¼ä¸º0æ—¶åœ¨å…‰æºçš„ä½ç½®ï¼‰ color - ï¼ˆå¯é€‰ï¼‰å…‰æ™•çš„ï¼ˆColorï¼‰é¢œè‰² ä»£ç ç¤ºä¾‹ const light = new THREE.PointLight( 0xffffff, 1.5, 2000 ); const textureLoader = new THREE.TextureLoader(); const textureFlare0 = textureLoader.load( \"textures/lensflare/lensflare0.png\" ); //é˜³å…‰è´´å›¾ const textureFlare1 = textureLoader.load( \"textures/lensflare/lensflare2.png\" ); //é˜³å…‰è´´å›¾ const textureFlare2 = textureLoader.load( \"textures/lensflare/lensflare3.png\" ); //é˜³å…‰è´´å›¾ const lensflare = new Lensflare(); lensflare.addElement( new LensflareElement( textureFlare0, 512, 0 ) ); lensflare.addElement( new LensflareElement( textureFlare1, 512, 0 ) ); lensflare.addElement( new LensflareElement( textureFlare2, 60, 0.6 ) ); light.add( lensflare ); å…‰çš„æ€§èƒ½å…‰æºçš„æ•°é‡ï¼Œå½“ç„¶ä¹Ÿæ˜¯å½±å“æ€§èƒ½çš„ä¸€éƒ¨åˆ†ï¼Œè¶Šå°‘è¶Šå¥½ï¼Œæœ€å°çš„æ€§èƒ½æ¶ˆè€—ä¸º2ä¸ªç¯å¢ƒå…‰ï¼ˆAmbientLightã€HemisphereLight ï¼‰ï¼Œæœ€è€—è´¹æ€§èƒ½çš„æ˜¯SpotLightã€RectAreaLightï¼Œå…‰çš„æ€§èƒ½å’Œé˜´å½±çš„åˆ¶é€  + æ¸²æŸ“æ¬¡æ•°æ˜¯æ†ç»‘åœ¨ä¸€èµ·çš„ 9.é˜´å½±threejsåœ¨æ¸²æŸ“çš„æ—¶å€™ï¼Œå¦‚æœéœ€è¦æ¸²æŸ“é˜´å½±ï¼Œä¼šå¸®æˆ‘ä»¬ä½¿ç”¨ MeshDepthMaterial çš„æè´¨æ›¿æ¢æ‰€æœ‰æè´¨ï¼ˆmaterialï¼‰ï¼Œå¹¶ä¸”ç”Ÿæˆ + å­˜å‚¨ä¸€ç§åä¸º shadow maps çš„é˜´å½±è´´å›¾ï¼ˆtextureï¼‰ï¼Œæ”¹shadow maps è®°å½•äº†äº§ç”Ÿé˜´å½±çš„ç‰©ä½“å¯¹åº”çš„äºŒç»´é˜´å½±å›¾åƒ é˜´å½±çš„æ€§èƒ½é¦–å…ˆå…³äºé˜´å½±çš„æ€§èƒ½é—®é¢˜ï¼š Three.js é»˜è®¤ä½¿ç”¨shadow mapsï¼ˆé˜´å½±è´´å›¾ï¼‰ï¼Œé˜´å½±è´´å›¾çš„å·¥ä½œæ–¹å¼å°±æ˜¯å…·æœ‰æŠ•å°„é˜´å½±çš„å…‰èƒ½å¯¹æ‰€æœ‰èƒ½è¢«æŠ•å°„é˜´å½±çš„ç‰©ä½“ä»å…‰æºæ¸²æŸ“é˜´å½±ï¼Œæ‰€ä»¥ä½ å¯ä»¥ç†è§£ä¸ºé˜´å½±è¿™ä¸€å±‚ï¼Œthreejså·²ç»å¸®æˆ‘ä»¬åšå¥½äº†ï¼Œç¯å…‰æ•°é‡ï¼Œå†³å®šé˜´å½±çš„æ¸²æŸ“ã€‚æ‰€ä»¥é˜´å½±è¿™éƒ¨åˆ†å®Œå…¨æ²¡æœ‰å•¥æ“ä½œï¼Œéš¾çš„åœ¨äºé˜´å½±çš„ä¼˜åŒ–éƒ¨åˆ† é‚£ä¹ˆè¯´æ˜ï¼š å¦‚æœä½ æœ‰ 20 ä¸ªç‰©ä½“å¯¹è±¡ã€5 ä¸ªç¯å…‰ï¼Œå¹¶ä¸”æ‰€æœ‰çš„ç‰©ä½“éƒ½èƒ½è¢«æŠ•å°„é˜´å½±ï¼Œæ‰€æœ‰çš„å…‰éƒ½èƒ½æŠ•å°„é˜´å½±ï¼Œé‚£ä¹ˆè¿™ä¸ªåœºæ™¯è¿™ä¸ªåœºæ™¯å°†ä¼šç»˜åˆ¶ 6 æ¬¡ã€‚ç¬¬ä¸€ä¸ªç¯å…‰å°†ä¼šä¸ºæ‰€æœ‰çš„ç‰©ä½“æŠ•å½±é˜´å½±ï¼Œç»˜åˆ¶åœºæ™¯ã€‚ç„¶åæ˜¯ç¬¬äºŒä¸ªç¯å…‰ç»˜åˆ¶åœºæ™¯ï¼Œç„¶åæ˜¯ç¬¬ä¸‰ä¸ªç¯å…‰ï¼Œä»¥æ­¤ç±»æ¨ã€‚æœ€åä¸€æ¬¡ï¼ˆå³ç¬¬å…­æ¬¡ï¼‰å°†é€šè¿‡å‰äº”ä¸ªç¯å…‰æ¸²æŸ“çš„æ•°æ®ï¼Œæ¸²æŸ“å‡ºæœ€ç»ˆçš„å®é™…åœºæ™¯ã€‚ è§£å†³æ–¹æ³•ï¼š åªä½¿ç”¨ä¸€ä¸ªå…‰æºï¼Œä»è€Œå‡å°‘é˜´å½±æ•°é‡ ä½¿ç”¨å…‰ç…§è´´å›¾æˆ–è€…ç¯å¢ƒå…‰è´´å›¾ï¼Œé¢„å…ˆè®¡ç®—ç¦»çº¿ç…§æ˜çš„æ•ˆæœã€‚ä¸è¿‡è¿™å°†å¯¼è‡´é™æ€å…‰ç…§ï¼ˆå¼•ç”¨ä¸ä¼šåŠ¨ï¼‰ ä½¿ç”¨å‡çš„é˜´å½± Animal Crossing Pocket Campï¼Œåœ¨å…¶ä¸­ä½ å¯ä»¥çœ‹åˆ°æ¯ä¸ªå­—ç¬¦éƒ½æœ‰ä¸€ä¸ªç®€å•çš„åŸå‹é˜´å½±ã€‚è¿™ç§æ–¹å¼å¾ˆæœ‰æ•ˆï¼Œä¹Ÿå¾ˆæ–¹ä¾¿ã€‚Monument Valley çºªå¿µç¢‘è°·çœ‹èµ·æ¥ä¼¼ä¹ä¹Ÿä½¿ç”¨è¿™ç§é˜´å½±ã€‚ å¸¸è§„ä¸€ç‚¹çš„ä¼˜åŒ–æ–¹æ³•ï¼š ä¼˜åŒ–æ€§èƒ½ï¼šå‡å°é˜´å½±è´´å›¾å¤§å°ï¼ˆmapsizeï¼‰ ä¼˜åŒ–è´¨é‡ï¼šå‡å°‘é˜´å½±è¦†ç›–èŒƒå›´ï¼ˆå…‰ç…§æŠ•å°„èŒƒå›´ï¼‰ï¼ˆshadowmapèŒƒå›´å†…è¢«æŠ•å°„çš„ç‰©ä½“ä½“ç§¯å¤§äº†ï¼ˆç›¸å¯¹ï¼‰ï¼Œèƒ½å¾—åˆ°æ›´é«˜è´¨é‡çš„é˜´å½±ï¼‰ ä¼˜åŒ–æ€§èƒ½ï¼šå°è¯•è®¾ç½®ä½è´¨é‡é˜´å½±è´´å›¾ å°è¯•ä¸€ä¸‹ æ·»åŠ æ¨¡å‹é˜´å½±ç¬¬ä¸€æ­¥ï¼Œåœ¨åˆå§‹åŒ–rendererçš„æ—¶å€™å…ˆè®¾ç½®shadowMapï¼Œè®©æ¸²æŸ“å™¨å¼€å¯é˜´å½± this.renderer.shadowMap.enabled = true; .shadowMap : WebGLShadowMap å¦‚æœä½¿ç”¨ï¼Œå®ƒåŒ…å«é˜´å½±è´´å›¾çš„å¼•ç”¨ã€‚- enabled: å¦‚æœè®¾ç½®å¼€å¯ï¼Œå…è®¸åœ¨åœºæ™¯ä¸­ä½¿ç”¨é˜´å½±è´´å›¾ã€‚é»˜è®¤æ˜¯ falseã€‚ ç¬¬äºŒæ­¥ï¼Œç»™ç¯å…‰æ·»åŠ é˜´å½±æŠ•å°„æ”¯æŒï¼š xxx.castShadow = true æ˜¯å¦æŠ•å°„é˜´å½± ç¬¬ä¸‰æ­¥ï¼Œæ·»åŠ åœ°æ¿æ—¶éœ€è¦ï¼š floor.receiveShadow = true; æ˜¯å¦èƒ½æ¥å—é˜´å½± å¯¹äºåœºæ™¯ä¸­çš„æ¯ä¸€ä¸ªéœ€è¦é˜´å½±çš„ç‰©ä½“ï¼Œéƒ½éœ€è¦è®¾ç½® castShadow ã€receiveShadow åœ¨ loader å‡½æ•°å†…ï¼Œæˆ‘ä»¬èƒ½éå† 3D æ¨¡å‹ï¼ˆçš„ç»„æˆå…ƒç´ ï¼‰ã€‚å› æ­¤ï¼Œè·³åˆ° loader å‡½æ•°ï¼Œåœ¨ theModel = gltf.scene; ä¸‹æ·»åŠ è¿™ä¸ªæ“ä½œã€‚ä¸º 3D æ¨¡å‹çš„æ¯ä¸€ä¸ªå…ƒç´ ï¼ˆæ¤…è…¿ã€åå«ç­‰ï¼‰å¯ç”¨æŠ•å°„å’Œæ¥æ”¶é˜´å½±çš„é€‰é¡¹ã€‚è¯¥éå†æ–¹æ³•åœ¨åç»­ä¼šè¢«å†æ¬¡ä½¿ç”¨ã€‚ const loader = new GLTFLoader(); loader.load( modelName, (gltf) => { this.model = gltf.scene; // æ·»åŠ é˜´å½± this.model.traverse((o) => { if (o.isMesh) { o.castShadow = true; o.receiveShadow = true; } }); this.scene.add(this.model); }, undefined, function (error) { console.error(error); } ); è®¾ç½®é˜´å½±æˆ‘ä»¬ç»™å®šå‘å…‰è®¾ç½®é˜´å½±ï¼Œæ­¤æ—¶é€šè¿‡æ‰“å°shadowå±æ€§å¯ä»¥çœ‹åˆ°å¥¹çš„shadowmapå°ºå¯¸ //æ–¹å‘å…‰ const directionalLight = new THREE.DirectionalLight(0xffffff, 0.5); directionalLight.castShadow = true; directionalLight.position.set(10, 10, 5); console.log(directionalLight.shadow); mapSize: Vector2 x: 512 y: 512 isVector2: trueå› æ­¤æˆ‘ä»¬è¿˜å¯ä»¥è®¾ç½®é˜´å½±å¤§å°æ€ä¹ˆæ ·ï¼š xxlight.shadow.mapSize = new THREE.Vector2(1024, 1024); é˜´å½±å°ºå¯¸è¶Šå¤§ï¼Œæ€§èƒ½æ¶ˆè€—è¶Šå¤§ï¼Œä½†æ˜¯é˜´å½±è´¨é‡è¶Šå¥½ ä¸‹é¢çš„å›¾ç‰‡åˆ†åˆ«å¯¹åº” 512ã€1024ã€128 DirectionalLightå°å®è·µ let d = 8.25; let dirLight = new THREE.DirectionalLight(0xffffff, 0.54); dirLight.position.set(-8, 12, 8); dirLight.castShadow = true; //äºŒç»´å‘é‡ï¼ˆVector2ï¼‰ //è¡¨ç¤º2D vectorï¼ˆäºŒç»´å‘é‡ï¼‰çš„ç±»ã€‚ ä¸€ä¸ªäºŒç»´å‘é‡æ˜¯ä¸€å¯¹æœ‰é¡ºåºçš„æ•°å­—ï¼ˆæ ‡è®°ä¸ºxå’Œyï¼‰ï¼Œå¯ç”¨æ¥è¡¨ç¤ºå¾ˆå¤šäº‹ç‰©ï¼Œä¾‹å¦‚ï¼š dirLight.shadow.mapSize = new THREE.Vector2(1024, 1024); dirLight.shadow.camera.near = 0.1; dirLight.shadow.camera.far = 1500; dirLight.shadow.camera.left = d * -1; dirLight.shadow.camera.right = d; dirLight.shadow.camera.top = d; dirLight.shadow.camera.bottom = d * -1; è¿™é‡Œæ ¹æ®ä½œè€…çš„è§£é‡Šï¼šæˆ‘å‡­å€Ÿä¸ªäººæ„Ÿè§‰å°†å®šå‘å…‰æ”¾ç½®åœ¨ä¸€ä¸ªé€‚å½“çš„ä½ç½®ã€‚éšåï¼Œå¯ç”¨å…¶æŠ•å°„é˜´å½±çš„èƒ½åŠ›å¹¶è®¾ç½®äº†é˜´å½±çš„åˆ†è¾¨ç‡ã€‚é˜´å½±çš„å…¶ä½™è®¾ç½®åˆ™ä¸å…‰çš„è§†åœºç›¸å…³ï¼ˆè¯‘è€…æ³¨ï¼šå®šå‘å…‰æ˜¯ä½¿ç”¨æ­£äº¤æ‘„åƒæœºè®¡ç®—é˜´å½±ï¼Œå‚è€ƒ DirectionalLightShadowï¼‰ï¼Œè¿™æ¦‚å¿µå¯¹æˆ‘æ¥è¯´ä¹Ÿæœ‰äº›æ¨¡ç³Šï¼Œä½†åªè¦æ¸…æ™°çŸ¥é“ï¼šå¯é€šè¿‡è°ƒæ•´å˜é‡ d ä»¥ç¡®ä¿é˜´å½±ä¸è¢«è£å‰ªã€‚ å‡å°‘é˜´å½±è¦†ç›–èŒƒå›´xxLight.shadow.camera æ˜¯ä¸€ä¸ªæ­£äº¤ç›¸æœºï¼Œå¯ä»¥é€šè¿‡è°ƒæ§ä¿®æ”¹æ”¹ç¯å…‰ä¸‹é˜´å½±çš„è¦†ç›–èŒƒå›´ é€šè¿‡CameraHelperï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°å½“å‰å…‰æºå†…é˜´å½±çš„è¦†ç›–èŒƒå›´ï¼Œæˆ‘ä»¬å¯ä»¥æ ¹æ®éœ€æ±‚ç¨å¾®è°ƒæ•´ï¼Œæé«˜æ€§èƒ½ //è¿™æ˜¯ä¸€ä¸ªæ­£äº¤ç›¸æœº //å‡å°‘è¦†ç›–è·ç¦» directionalLight.shadow.camera.near = 1; directionalLight.shadow.camera.far = 20; //å‡å°‘è¦†ç›–å¤§å°,å¯ä»¥å‚è€ƒæ­£äº¤ç›¸æœºéƒ¨åˆ†çš„å‚æ•° directionalLight.shadow.camera.top = 2; directionalLight.shadow.camera.bottom = -2; directionalLight.shadow.camera.left = -2; directionalLight.shadow.camera.right = -2; åˆšå¥½åˆ°è¾¾èŒƒå›´å†…æ˜¯æœ€å¥½çš„ å¹¶ä¸”è¿˜å¯ä»¥é€šè¿‡radiusæ§åˆ¶é˜´å½±è™šåŒ– .radius : Float å°†æ­¤å€¼è®¾ç½®ä¸ºå¤§äº1çš„å€¼å°†æ¨¡ç³Šé˜´å½±çš„è¾¹ç¼˜ã€‚è¾ƒé«˜çš„å€¼ä¼šåœ¨é˜´å½±ä¸­äº§ç”Ÿä¸å¿…è¦çš„æ¡å¸¦æ•ˆæœ - æ›´å¤§çš„mapSizeå°†å…è®¸åœ¨è¿™äº›æ•ˆæœå˜å¾—å¯è§ä¹‹å‰ä½¿ç”¨æ›´é«˜çš„å€¼ã€‚ directionalLight.shadow.radius = 10; å°è¯•ä¸€ä¸‹å§ï½ é˜´å½±ç±»å‹ THREE.BasicShadowMapï¼šä½è´¨é‡é«˜æ€§èƒ½é˜´å½±è´´å›¾ THREE.PCFShadowMapï¼šè´´å›¾è¾¹ç¼˜å¹³æ»‘ï¼Œæ€§èƒ½æ¶ˆè€—ä¸é«˜ï¼Œthreejsé»˜è®¤ä½¿ç”¨çš„shadow map THREE.PCFSoftShadowMapï¼šæ€§èƒ½æ¶ˆè€—é«˜äºTHREE.PCFShadowMapï¼Œæ›´åŠ å¹³æ»‘ï¼Œè¡¨ç°èƒ½åŠ›æ›´å¥½,radiusï¼ˆé˜´å½±è™šåŒ–ï¼‰æ— æ³•ç”Ÿæ•ˆ THREE.VSMShadowMap renderer.shadowMap.type = THREE.PCFShadowMap æˆ‘ä»¬é€šè¿‡light.shadow.type è¿›è¡Œæ§åˆ¶ 10.åŠ¨ç”»åŠ¨ç”»æ–¹é¢çš„åˆ¶ä½œå¯ä»¥å‚è€ƒthreejså®˜ç½‘çš„AnimationActionç³»åˆ—ï¼Œä¸è¿‡ä¸€èˆ¬éƒ½è¦ä¼ å…¥ç”±blenderåˆ¶ä½œçš„æ¨¡å‹åŠ¨ç”»ä¼šæ¯”è¾ƒæ–¹ä¾¿ ä»¥ä¸‹å®ä¾‹ä½¿ç”¨çš„æ˜¯AnimationMixerï¼Œä¸€ä¸ªåŠ¨ç”»æ··åˆå™¨ï¼Œå®ƒæ˜¯ç”¨äºåœºæ™¯ä¸­ç‰¹å®šå¯¹è±¡çš„åŠ¨ç”»çš„æ’­æ”¾å™¨ã€‚å½“åœºæ™¯ä¸­çš„å¤šä¸ªå¯¹è±¡ç‹¬ç«‹åŠ¨ç”»æ—¶ï¼Œæ¯ä¸ªå¯¹è±¡éƒ½å¯ä»¥ä½¿ç”¨åŒä¸€ä¸ªåŠ¨ç”»æ··åˆå™¨ã€‚ï¼ˆä¼ å…¥blenderåˆ¶ä½œå¥½çš„åŠ¨ç”»ï¼‰ setModel(modelName) { // ç”±äºæ·»åŠ æ¨¡å‹æ˜¯å¼‚æ­¥æ“ä½œï¼Œæ‰€ä»¥å¯ä»¥å°è£…ä¸€ä¸ªpromiseç»™å®ƒ return new Promise((res, rej) => { const loader = new GLTFLoader().setPath(\"gltf/\"); loader.load(modelName, (gltf) => { console.log(gltf); this.model = gltf.scene.children[0]; // æŠŠé‡Œé¢çš„sceneéƒ½ä¼ è¿›å» this.scene.add(gltf.scene); //æ‘„åƒå¤´éƒ½æ”¹ä¸ºæ¨¡å‹åº”ç”¨çš„æ‘„åƒå¤´ this.camera = gltf.cameras[0]; //è°ƒç”¨åŠ¨ç”»,æˆ‘ä»¬å¯ä»¥æŠŠAnimationMixerå½“ä½œä¸€ä¸ªè®¾ç½®å¥½å…³é”®å¸§çš„æ’­æ”¾å™¨ //è¿™é‡Œä¸»è¦è¿˜æ˜¯æ‘„åƒå¤´åœ¨åŠ¨,children[1]é‡Œé¢æ”¾ä¸€ä¸ªæ‘„åƒæœºcamera this.mixer = new THREE.AnimationMixer(gltf.scene.children[1]); this.animateAction = this.mixer.clipAction(gltf.animations[0]); // è®¾ç½®åŠ¨ç”»æ’­æ”¾æ—¶é•¿ this.animateAction.setDuration(20).setLoop(THREE.LoopOnce); // æ’­æ”¾å®Œæ¯•åœæ­¢ this.animateAction.clampWhenFinished = true; this.animateAction.play(); //è®¾ç½®æ¨¡å‹å†…éƒ¨ç¯å…‰ const spotlight1 = gltf.scene.children[2].children[0]; spotlight1.intensity = 1; const spotlight2 = gltf.scene.children[3].children[0]; spotlight2.intensity = 1; const spotlight3 = gltf.scene.children[4].children[0]; spotlight3.intensity = 1; console.log(gltf, \"again\"); res(modelName + \"æ·»åŠ æˆåŠŸ\"); }); }); AnimationMixer( rootObject : Object3D )ï¼šåŠ¨ç”»æ··åˆå™¨æ˜¯ç”¨äºåœºæ™¯ä¸­ç‰¹å®šå¯¹è±¡çš„åŠ¨ç”»çš„æ’­æ”¾å™¨ï¼Œå‚æ•°ä¸ºåŠ¨ç”»çš„å¯¹è±¡ AnimationClipï¼šåŠ¨ç”»å‰ªè¾‘ï¼ˆAnimationClipï¼‰æ˜¯ä¸€ä¸ªå¯é‡ç”¨çš„å…³é”®å¸§è½¨é“é›†ï¼Œå¯ä»¥ç†è§£ä¸ºå®ƒå°±æ˜¯åŠ¨ç”»ã€‚å¯ä»¥ä»æ¨¡å‹ä¸­è·å–çš„ï¼Œæ¡ˆä¾‹ä¸­ä¸º gltf.animations[0] AnimationActions ï¼Œå¯ä»¥ç†è§£ä¸ºä½¿ç”¨åŠ¨ç”»çš„å·¥å…·ï¼Œç”¨æ¥è°ƒåº¦å­˜å‚¨åœ¨AnimationClipsä¸­çš„åŠ¨ç”»ã€‚æ¡ˆä¾‹ä¸­ä¸º this.animateAction clipActionï¼šä¸€ä¸ªæ–¹æ³•ï¼Œ =ã€‹ AnimationActions = mixer.clipAction(AnimationClip); AnimationActionså¯¹äºå­˜å‚¨åŠ¨ç”»çš„AnimationActionså¯¹è±¡ï¼Œæœ‰ä»¥ä¸‹å‡ ä¸ªå¸¸ç”¨çš„æ–¹æ³• .play () : this è®©æ··åˆå™¨æ¿€æ´»åŠ¨ä½œã€‚æ­¤æ–¹æ³•å¯é“¾å¼è°ƒç”¨ã€‚ .enabled : Boolean enabled å€¼è®¾ä¸ºfalseä¼šç¦ç”¨åŠ¨ä½œ, ä¹Ÿå°±æ˜¯æ— æ•ˆ.é»˜è®¤å€¼æ˜¯true .setLoop ( loopMode : Number, repetitions : Number ) : this è®¾ç½®å¾ªç¯ï¼ˆloop modeï¼‰åŠå¾ªç¯é‡å¤æ¬¡æ•°ï¼ˆrepetitionsï¼‰ã€‚æ”¹æ–¹æ³•å¯è¢«é“¾å¼è°ƒç”¨ã€‚ æˆ‘ä»¬é€šå¸¸ç”¨æ¥è®¾ç½®åŠ¨ç”»æ’­æ”¾æ¬¡æ•° .reset () : this é‡ç½®åŠ¨ä½œã€‚æ­¤æ–¹æ³•å¯é“¾å¼è°ƒç”¨ã€‚ .crossFadeTo ( fadeInAction : AnimationAction, durationInSeconds : Number, warpBoolean : Boolean ) : this åœ¨ä¼ å…¥çš„æ—¶é—´æ®µå†…, è®©æ­¤åŠ¨ä½œæ·¡å‡ºï¼ˆfade outï¼‰ï¼ŒåŒæ—¶è®©å¦ä¸€ä¸ªåŠ¨ä½œæ·¡å…¥ã€‚æ­¤æ–¹æ³•å¯é“¾å¼è°ƒç”¨ã€‚ å¸¸ç”¨äºåŠ¨ç”»ä¸­åˆ‡æ¢åŠ¨ä½œ å¦‚æœwarpBooleanå€¼æ˜¯true, é¢å¤–çš„ warping (æ—¶é—´æ¯”ä¾‹çš„æ¸å˜)å°†ä¼šè¢«åº”ç”¨ã€‚ æ·»åŠ åŠ¨æ€æ•ˆæœç„¶åå†æ·»åŠ threejsæä¾›çš„è®¡æ—¶å™¨ this.clock = new THREE.Clock(); //threeæä¾›çš„è®¡æ—¶å™¨ è¯¥å¯¹è±¡ç”¨äºè·Ÿè¸ªæ—¶é—´ã€‚å¦‚æœperformance.nowå¯ç”¨ï¼Œåˆ™ Clock å¯¹è±¡é€šè¿‡è¯¥æ–¹æ³•å®ç°ï¼Œå¦åˆ™å›è½åˆ°ä½¿ç”¨ç•¥æ¬ ç²¾å‡†çš„Date.nowæ¥å®ç°ã€‚ åœ¨æ¯ä¸€æ¬¡renderè·å–æ¯ä¸€å¸§çš„æ—¶é—´å·® ä½†æ˜¯ä¸€èˆ¬ä¸å»ºè®®ä½¿ç”¨getDeltaï¼Œbecause ä½ å¯èƒ½ä¼šè·å–åˆ°å»ä¹–çš„å€¼ï¼Œmakes no sense render() { const delta = this.clock.getDelta(); this.mixer &amp;&amp; this.mixer.update(delta); this.renderer.render(this.scene, this.camera); } å½“ç„¶ä¹Ÿå¯ä»¥æŠŠmixerä½œä¸ºæ•°ç»„å­˜å‚¨ï¼ŒæŠŠæ¯ä¸€æ¬¡åŠ¨ç”»å­˜å‚¨åˆ°mixerä¸­ loader.load(\"dancing.fbx\", (anim) => { console.log(anim, \"anim\"); const m = new THREE.AnimationMixer(this.model); this.mixer.push(m); this.animateAction = m.clipAction(anim.animations[0]); this.animateAction.play(); }); ç„¶åå†æ¸²æŸ“å‡½æ•°ä¸­é€ä¸ªè°ƒç”¨ // æ¸²æŸ“å‡½æ•° render() { const delta = this.clock.getDelta(); if (this.mixer.length > 0) { this.mixer.map((m) => m.update(delta)); } this.renderer.render(this.scene, this.camera); } æ³¨æ„ï¼šè¿™ç§æ–¹å¼å¯èƒ½å¯¼è‡´å¾—åˆ°çš„animationä»é—ç•™ä¸Šä¸€ä¸ªåŠ¨ä½œçš„æŸä¸ªè‚¢ä½“åŠ¨ä½œï¼Œå¯¼è‡´åŠ¨ç”»åŠ¨ä½œâ€œä¸è§„èŒƒâ€ 11.å¯¹äºåŠ¨ç”»ä¸­çš„äº‹ä»¶ç›‘å¬ çª—å£å¤§å°è°ƒæ•´ï¼šresize å¯¹äºçª—å£å¤§å°è°ƒæ•´ï¼Œå¯ä»¥ä½¿ç”¨ window.addEventListener(\"resize\", this.windowResize.bind(this)); windowResize() { this.camera.aspect = window.innerWidth / window.innerHeight; //å…¶å®ä¹Ÿå°±æ˜¯è°ƒæ•´cameraç¬¬äºŒä¸ªå‚æ•° // æ›´æ–°ä¸€ä¸‹æ‘„åƒæœºè½¬æ¢3dæŠ•å½±çš„çŸ©é˜µ this.camera.updateProjectionMatrix(); //æ›´æ–°æ¸²æŸ“å™¨æ¸²æŸ“å¤§å° this.renderer.setSize(window.innerWidth, window.innerHeight); } é¼ æ ‡ç§»åŠ¨ï¼šmousemove å¯¹äºé¼ æ ‡ç§»åŠ¨å¯ä»¥ä½¿ç”¨ window.addEventListener(\"mousemove\", this.windowMouseMove.bind(this)); é¼ æ ‡ç‚¹å‡»ã€æ¡Œé¢è§¦å±ï¼šclickã€touchend å¯¹äºé¼ æ ‡ç‚¹å‡»ï¼Œæˆ‘ä»¬å¹¶ä¸èƒ½å•çº¯ä¸ºæ ‡ç­¾æ·»åŠ ç‚¹å‡»äº‹ä»¶ï¼Œæ¯•ç«Ÿä¸æ˜¯domçš„ä¸€éƒ¨åˆ†ï¼Œè¿™é‡Œé‡‡ç”¨å°„çº¿å®ç° å³å‘ä¸€å®šæ–¹å‘å‘å°„æ¿€å…‰æŸï¼Œç„¶åè¿”å›è¢«å‡»ä¸­çš„å¯¹è±¡é›†åˆã€‚åœ¨è¯¥æ¡ˆä¾‹ä¸­ï¼Œæ¿€å…‰çº¿æ˜¯ä»æ‘„åƒæœºå°„å‘å…‰æ ‡ã€‚ Raycaster() è¿™ä¸ªç±»ç”¨äºè¿›è¡Œraycastingï¼ˆå…‰çº¿æŠ•å°„ï¼‰ã€‚ å…‰çº¿æŠ•å°„ç”¨äºè¿›è¡Œé¼ æ ‡æ‹¾å–ï¼ˆåœ¨ä¸‰ç»´ç©ºé—´ä¸­è®¡ç®—å‡ºé¼ æ ‡ç§»è¿‡äº†ä»€ä¹ˆç‰©ä½“ï¼‰ã€‚ // é€šè¿‡æ‘„åƒæœºå’Œé¼ æ ‡ä½ç½®æ›´æ–°å°„çº¿ raycaster.setFromCamera( pointer, camera ); // è®¡ç®—ç‰©ä½“å’Œå°„çº¿çš„ç„¦ç‚¹ const intersects = raycaster.intersectObjects( scene.children ); const raycaster = new THREE.Raycaster(); const currentlyAnimating = false; window.addEventListener('click', e => raycast(e)); window.addEventListener('touchend', e => raycast(e, true)); function raycast(e, touch = false) { var mouse = {}; if (touch) { mouse.x = 2 * (e.changedTouches[0].clientX / window.innerWidth) - 1; mouse.y = 1 - 2 * (e.changedTouches[0].clientY / window.innerHeight); } else { mouse.x = 2 * (e.clientX / window.innerWidth) - 1; mouse.y = 1 - 2 * (e.clientY / window.innerHeight); } // update the picking ray with the camera and mouse position raycaster.setFromCamera(mouse, camera); // calculate objects intersecting the picking ray var intersects = raycaster.intersectObjects(scene.children, true); if (intersects[0]) { var object = intersects[0].object; if (object.name === 'stacy') { //åˆ¤æ–­ currentlyAnimating æ˜¯å¦ä¸º falseï¼Œå³å½“æœ‰åŠ¨ç”»æ­£åœ¨æ‰§è¡Œï¼Œé‚£ä¹ˆå°±ä¸ä¼šæ‰§è¡Œæ–°åŠ¨ç”»ã€‚ if (!currentlyAnimating) { currentlyAnimating = true; playOnClick(); } } } } 12.ç²¾çµå’Œç²’å­ç‚¹äº‘ç²¾çµæè´¨å¹³æ—¶æˆ‘ä»¬è§åˆ°çš„å¾ˆå¤šä¸‹é›¨ã€ä¸‹é›ªã€çƒŸé›¾æ•ˆæœï¼Œéƒ½æ˜¯é‡‡ç”¨ç²’å­ç³»ç»ŸåŠŸèƒ½ ä½¿ç”¨çš„ææ–™ï¼š ç‚¹ç²¾çµæè´¨(SpriteMaterial)ï¼Œä¸€ç§ä½¿ç”¨Spriteçš„æè´¨ã€‚ //åˆ›å»ºç²¾çµæè´¨ createSprites() { for (let x = -30; x &lt; 30; x++) { for (let y = -20; y &lt; 20; y++) { for (let z = 0; z &lt; 5; z++) { const material = new THREE.SpriteMaterial({ opacity: 1.0, color: Math.random() * 0xffffff, }); const sprite = new THREE.Sprite(material); sprite.position.set(x * 4, y * 4, z * 100); this.scene.add(sprite); } } } } ç‚¹äº‘æ•ˆæœåœ¨æˆ‘ä»¬åˆ›å»ºçš„ç²¾çµæ•°é‡ä¸å¤šçš„æƒ…å†µä¸‹ï¼Œç²¾çµå¯¹è±¡ä¹Ÿå¯ä»¥å®ç°å¤æ‚çš„ç‚¹äº‘æ•ˆæœï¼Œä½†æ˜¯ä¼šå¡åˆ°çˆ†ç‚¸ï¼Œè¿™æ—¶å€™çš„æ¸²æŸ“æ•ˆç‡æ˜¯æˆ‘ä»¬æ‰€ä¸èƒ½æ¥å—çš„ threejsç»™æˆ‘ä»¬æä¾›äº†æ›´å¥½çš„ç‚¹äº‘æ–¹æ¡ˆ // åˆ›å»ºç‚¹äº‘ createPoints() { //åˆ›å»ºä¸€ä¸ªç¼“å†²å‡ ä½•ä½“ const geom = new THREE.BufferGeometry(); const material = new THREE.PointsMaterial({ size: 2, //ç²’å­å¤§å° vertexColors: true, //è®¾ç½®é¡¶ç‚¹é¢œè‰²å¼€å…³æ˜¯å¦é‡‡ç”¨ç¼“å†²å‡ ä½•ä½“ color: 0xffff, }); const positions = []; const colors = []; for (let x = -30; x &lt; 30; x++) { for (let y = -20; y &lt; 20; y++) { for (let z = -30; z &lt; 30; z++) { positions.push(x * 4, y * 4, z * 100); const clr = new THREE.Color(Math.random() * 0xffffff); colors.push(clr.r, clr.g, clr.b); } } } geom.setAttribute( \"position\", new THREE.Float32BufferAttribute(positions, 3) ); geom.setAttribute(\"color\", new THREE.Float32BufferAttribute(colors, 3)); const cloud = new THREE.Points(geom, material); this.scene.add(cloud); } ä¸è¿‡æ„Ÿè§‰ä¸»è¦è¿˜æ˜¯ç¼“å†²å‡ ä½•ä½“è§£å†³äº†å¡é¡¿é—®é¢˜ BufferGeometryï¼šç¼“å­˜å‡ ä½•ä½“ï¼Œæ˜¯é¢ç‰‡ã€çº¿æˆ–ç‚¹å‡ ä½•ä½“çš„æœ‰æ•ˆè¡¨è¿°ã€‚åŒ…æ‹¬é¡¶ç‚¹ä½ç½®ï¼Œé¢ç‰‡ç´¢å¼•ã€æ³•ç›¸é‡ã€é¢œè‰²å€¼ã€UV åæ ‡å’Œè‡ªå®šä¹‰ç¼“å­˜å±æ€§å€¼ã€‚ä½¿ç”¨ BufferGeometry å¯ä»¥æœ‰æ•ˆå‡å°‘å‘ GPU ä¼ è¾“ä¸Šè¿°æ•°æ®æ‰€éœ€çš„å¼€é”€ã€‚ è¯»å–æˆ–ç¼–è¾‘ BufferGeometry ä¸­çš„æ•°æ®ï¼Œè§ BufferAttribute æ–‡æ¡£ã€‚ ç‚¹æè´¨(PointsMaterial) Pointsä½¿ç”¨çš„é»˜è®¤æè´¨ã€‚ ä¸‹é›¨æ•ˆæœå°å®è·µ// åˆ›å»ºé›¨æ»´ createRain() { //åˆ›å»ºä¸€ä¸ªç¼“å†²å‡ ä½•ä½“ const geom = new THREE.BufferGeometry(); const material = new THREE.PointsMaterial({ size: 4, //ç²’å­å¤§å° vertexColors: true, //é‡‡ç”¨æ¯ä¸ªç²’å­çš„é¢œè‰² transparent: true, depthWrite: false, //è®©é»‘è‰²èƒŒæ™¯é€æ˜æ˜¾ç¤º opacity: 0.6, map: this.getTexture(\"img/rain2.png\"), blending: THREE.AdditiveBlending, //é€‰æ‹©é™„åŠ çš„æ··åˆæ¨¡å¼ï¼Œæ¨¡å¼å«ä¹‰ä¸ºåœ¨ç”»æ–°åƒç´ æ—¶é¢œè‰²ä¼šè¢«æ·»åŠ åˆ°æ–°åƒç´ ä¸Š sizeAttenuation: true, //é›¨æ»´ç²’å­è¿œå°è¿‘å¤§ color: new THREE.Color(0xffffff), }); const positions = []; const colors = []; const velocities = []; //æ¯ä¸ªç²’å­åç§»é‡ const range = 500; for (let i = 0; i &lt; 15000; i++) { positions.push( Math.random() * range - range / 2, Math.random() * range - range / 2, Math.random() * range - range / 2 ); velocities.push((Math.random() - 0.5) / 3, 0.1 + Math.random() / 5); const color = new THREE.Color(0x00eeff); const asHSL = {}; color.getHSL(asHSL); // é¢œè‰²é‡‡ç”¨HSLè‰²å½©æ¨¡å¼ï¼Œæˆ‘ä»¬å¯¹äº®åº¦é‡‡ç”¨éšæœºå€¼çš„è®¾ç½® color.setHSL(asHSL.h, asHSL.s, asHSL.l * Math.random()); colors.push(color.r, color.g, color.b); } geom.setAttribute( \"position\", new THREE.Float32BufferAttribute(positions, 3) ); geom.setAttribute(\"color\", new THREE.Float32BufferAttribute(colors, 3)); // è‡ªå®šä¹‰å±æ€§ï¼Œåˆ¶é€ åŠ¨ç”»ä¸‹é›¨æ•ˆæœ geom.setAttribute( \"velocity\", new THREE.Float32BufferAttribute(velocities, 2) ); this.cloud = new THREE.Points(geom, material); console.log(this.cloud); this.scene.add(this.cloud); } //ä¸‹é›¨æ•ˆæœåŠ¨ç”» raining() { const pos_BufferAttr = this.cloud.geometry.getAttribute(\"position\"); const vel_BufferAttr = this.cloud.geometry.getAttribute(\"velocity\"); for (let i = 0; i &lt; pos_BufferAttr.count; i++) { let pos_x = pos_BufferAttr.getX(i); let pos_y = pos_BufferAttr.getY(i); let vel_x = vel_BufferAttr.getX(i); let vel_y = vel_BufferAttr.getY(i); pos_x = pos_x - vel_x; pos_y = pos_y - vel_y; // è¾¹ç•Œåˆ¤æ–­ if (pos_x &lt;= -20 || pos_x >= 20) vel_x = vel_x * -1; if (pos_y &lt;= 0) pos_y = 60; pos_BufferAttr.setX(i, pos_x); pos_BufferAttr.setY(i, pos_y); vel_BufferAttr.setX(i, vel_x); } //å…³é”®ä»£ç :æŠŠä¸¤ä¸ªç¼“å†²å±æ€§çš„needUpdateå±æ€§è®¾ç½®ä¸ºçœŸ,é©±ä½¿threejså¯¹åˆšæ‰ä¿®æ”¹çš„æ•°å€¼è¿›è¡Œæ›´æ–° pos_BufferAttr.needsUpdate = true; vel_BufferAttr.needsUpdate = true; } ç„¶åå†æ¯ä¸€æ¬¡renderä¸­è°ƒç”¨ä¸‹é›¨å‡½æ•°å³å¯ render() { if (this.cloud !== null) { this.raining(); } this.renderer.render(this.scene, this.camera); } 13.å…¶ä»–ç»†èŠ‚rotationä¸€ä¸ªcube //ç¬¬ä¸€æ­¥ cube.rotation.y = Math.PI / 2; //ç¬¬äºŒæ­¥ cube.rotation.x = Math.PI / 2; æ­¤æ—¶çš„æ—‹è½¬æ—¶ç›´æ¥æŒ‡æ ¹æ®å½“å‰æ ‡å‡†çš„åæ ‡è½´æ—‹è½¬ å¦‚æœæƒ³è¦æ ¹æ®ç‰©ä½“è‡ªèº«çš„xã€yã€zè½´ï¼ˆä¼šæ ¹æ®æ—‹è½¬è§’åº¦å˜åŒ–çš„åæ ‡ï¼‰æ¥è½¬ï¼Œéœ€è¦åœ¨æ—‹è½¬å‰å¢åŠ  reorder åº”ç”¨åœºæ™¯ï¼šç¬¬ä¸€äººç§°è§†è§’çš„åº”ç”¨ //å›åˆ°ç¬¬äºŒæ­¥ cube.rotation.reorder(\"YXZ\"); cube.rotation.y = Math.PI / 2; cube.rotation.x = Math.PI / 2; gsapåŠ¨ç”»åº“gsapåº“é™¤äº†èƒ½è¿ç”¨äºæ­£å¸¸çš„domå’Œå¯¹è±¡ï¼Œè¿˜èƒ½åœ¨threeä¸­ä½¿ç”¨ import gsap from 'gsap' gsap.to(mesh.position, {duration: 1, x: 2}) gsap.to(mesh.position, {duration: 2, y: 2}) å…¶ä»–ä¼˜åŒ–ç»†èŠ‚ å“åº”å¼æ¸²æŸ“ï¼ˆä¸»è¦æ˜¯é€šè¿‡å–æ¶ˆrequestAnimationFrameå‡å°‘æ€§èƒ½æ¶ˆè€—ï¼‰ å…¶å†…å®¹ä¸»è¦æ˜¯é€šè¿‡å–æ¶ˆrequestAnimationFrameå‡å°‘æ€§èƒ½æ¶ˆè€—ï¼Œå¯¹äºä¸€äº›æ•´ä½“åŠ¨ç”»è¦æ±‚ä¸é«˜çš„3dåœºæ™¯ï¼Œæˆ‘ä»¬æ­¤æ—¶å¯èƒ½ä¹‹éœ€è¦è½¬åŠ¨é•œå¤´è§‚å¯Ÿå¯ä»¥ï¼Œå¯ä»¥é¿å…ä½¿ç”¨requestAnimationFrameï¼Œå¯ä»¥é€šè¿‡ controls.addEventListener('change', render); æ¥å®æ—¶ç›‘å¬ç›¸æœºçš„å˜åŠ¨ï¼Œç„¶åå†render å¹¶ä¸”å¯ç”¨é˜»å°¼ ï¼ˆenableDampingï¼‰,è®©ç¿»è½¬æ›´åŠ ä¸æ»‘ OffscreenCanvas æ˜¯ä¸€ä¸ªç›¸å¯¹è¾ƒæ–°çš„æµè§ˆå™¨åŠŸèƒ½ï¼Œç›®å‰ä»…åœ¨Chromeå¯ç”¨ï¼Œä½†æ˜¾ç„¶æœªæ¥ä¼šé€‚ç”¨åˆ°åˆ«çš„æµè§ˆå™¨ä¸Šã€‚ OffscreenCanvas å…è®¸ä½¿ç”¨Web Workerå»æ¸²æŸ“ç”»å¸ƒï¼Œè¿™æ˜¯ä¸€ç§å‡è½»ç¹é‡å¤æ‚å·¥ä½œçš„æ–¹æ³•ï¼Œæ¯”å¦‚æŠŠæ¸²æŸ“ä¸€ä¸ªå¤æ‚çš„3Dåœºæ™¯äº¤ç»™ä¸€ä¸ªWeb Workerï¼Œé¿å…å‡æ…¢æµè§ˆå™¨çš„å“åº”é€Ÿåº¦ã€‚å®ƒä¹Ÿæ„å‘³ç€æ•°æ®åœ¨Workerä¸­åŠ è½½å’Œè§£æï¼Œå› æ­¤å¯èƒ½ä¼šå‡å°‘é¡µé¢åŠ è½½æ—¶çš„å¡é¡¿ã€‚ å®ä¾‹åŒ–ç½‘æ ¼InstancedMesh ä¸€ç§å…·æœ‰å®ä¾‹åŒ–æ¸²æŸ“æ”¯æŒçš„ç‰¹æ®Šç‰ˆæœ¬çš„Meshã€‚ä½ å¯ä»¥ä½¿ç”¨ InstancedMesh æ¥æ¸²æŸ“å¤§é‡å…·æœ‰ç›¸åŒå‡ ä½•ä½“ä¸æè´¨ã€ä½†å…·æœ‰ä¸åŒä¸–ç•Œå˜æ¢çš„ç‰©ä½“ã€‚ ä½¿ç”¨ InstancedMesh å°†å¸®åŠ©ä½ å‡å°‘ draw call çš„æ•°é‡ï¼Œä»è€Œæå‡ä½ åº”ç”¨ç¨‹åºçš„æ•´ä½“æ¸²æŸ“æ€§èƒ½ã€‚ ä¸€èˆ¬ç”¨äºå¤§é‡é‡å¤çš„mesh const total = 1000000; let insGeometry = new THREE.BoxBufferGeometry(1, 1, 1); //åˆ›å»ºå…·æœ‰å¤šä¸ªå®ä¾‹çš„å®ä¾‹åŒ–å‡ ä½•ä½“ let instanceMeshs = new THREE.InstancedMesh(insGeometry, material, total); //ä¿®æ”¹ä½ç½® let transform = new THREE.Object3D(); for (let index = 0; i &lt; total; i++) { transform.position.set(Math.random() * 2000, Math.random() * 2000, Math.random() * 2000); transform.scale.set(Math.random() * 50 + 50, Math.random() * 50 + 50, Math.random() * 50 + 50); transform.updateMatrix(); //ä¿®æ”¹å®ä¾‹åŒ–å‡ ä½•ä½“ä¸­çš„å•ä¸ªå®ä¾‹çš„çŸ©é˜µä»¥æ”¹å˜å¤§å°ã€æ–¹å‘ã€ä½ç½®ç­‰ instanceMeshs.setMatrixAt(i, transform.matrix); } å†…å­˜æ¸…ç†Three.jsåº”ç”¨ç»å¸¸ä½¿ç”¨å¤§é‡çš„å†…å­˜ï¼Œå¤§å¤šæ•°çš„three.jsåº”ç”¨åœ¨åˆå§‹åŒ–çš„æ—¶å€™åŠ è½½èµ„æºï¼Œå¹¶ä¸”ä¸€ç›´ä½¿ç”¨è¿™äº›èµ„æºç›´åˆ°é¡µé¢å…³é—­ã€‚ä½†æ˜¯ï¼Œå¦‚æœä½ æƒ³éšæ—¶é—´çš„å˜åŠ¨åŠ è½½å’Œæ”¹å˜èµ„æºæ€ä¹ˆåŠå‘¢ï¼Ÿ ä¸åƒå¤§å¤šæ•°çš„JavaScriptåº“ï¼Œthree.jsä¸èƒ½è‡ªåŠ¨çš„æ¸…é™¤è¿™äº›èµ„æºã€‚ å¦‚æœä½ åˆ‡æ¢é¡µé¢ï¼Œæµè§ˆå™¨ä¼šæ¸…é™¤è¿™äº›èµ„æºï¼Œéœ€è¦æˆ‘ä»¬è‡ªå·±æ¥ç®¡ç†è¿™äº›ä¸œè¥¿ã€‚ const boxGeometry = new THREE.BoxGeometry(...); const boxTexture = textureLoader.load(...); const boxMaterial = new THREE.MeshPhongMaterial({map: texture}); ç„¶ååœ¨ä½ å¤„ç†å®Œäº†å®ƒä»¬ä¹‹åï¼Œè¿›è¡Œå†…å­˜çš„é‡Šæ”¾ boxGeometry.dispose(); boxTexture.dispose(); boxMaterial.dispose(); å¦‚æœä½ å«Œéº»çƒ¦çš„è¯ï¼Œå¯ä»¥é€ ä¸€ä¸ªç±»ï¼Œæ¥è‡ªåŠ¨ç®¡ç†èµ„æºæ¸…é™¤ ä¸€äº›å®¹æ˜“å‡ºç°çš„bugé˜²æ­¢canvasè¢«æ¸…ç©º canvasæˆªå›¾ è·å–é”®ç›˜è¾“å…¥ é€æ˜åŒ–canvas é€æ˜ç«‹æ–¹ä½“ååŠéƒ¨åˆ†æ¶ˆå¤±é—®é¢˜ å‚è€ƒæ–‡ç«  Three.js Fundamentals å­¦ä¹ è§†é¢‘ï¼šThree.js Journey","categories":[{"name":"å‰ç«¯","slug":"å‰ç«¯","permalink":"https://taylor12138.github.io/categories/%E5%89%8D%E7%AB%AF/"}],"tags":[],"author":"Hello"},{"title":"websocket","slug":"websocket","date":"2022-03-05T11:17:27.225Z","updated":"2022-03-05T11:17:27.225Z","comments":true,"path":"2022/03/05/websocket/","link":"","permalink":"https://taylor12138.github.io/2022/03/05/websocket/","excerpt":"","text":"1.WebSocketæ¦‚æ‹¬WebSocket æ˜¯ HTML5 å¼€å§‹æä¾›çš„ä¸€ç§åœ¨å•ä¸ª TCP è¿æ¥ä¸Šè¿›è¡Œå…¨åŒå·¥é€šè®¯çš„åè®®ï¼Œæ˜¯ä¸€ä¸ªæŒä¹…åŒ–çš„åè®®ã€‚ WebSocket ä½¿å¾—å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´çš„æ•°æ®äº¤æ¢å˜å¾—æ›´åŠ ç®€å•ï¼Œå…è®¸æœåŠ¡ç«¯ä¸»åŠ¨å‘å®¢æˆ·ç«¯æ¨é€æ•°æ®ã€‚åœ¨ WebSocket API ä¸­ï¼Œæµè§ˆå™¨å’ŒæœåŠ¡å™¨åªéœ€è¦å®Œæˆä¸€æ¬¡æ¡æ‰‹ï¼Œä¸¤è€…ä¹‹é—´å°±ç›´æ¥å¯ä»¥åˆ›å»ºæŒä¹…æ€§çš„è¿æ¥ï¼Œå¹¶è¿›è¡ŒåŒå‘æ•°æ®ä¼ è¾“ã€‚ï¼ˆæ‰“ç ´äº†ä¸‰æ¬¡æ¡æ‰‹å®šå¾‹ï¼Ÿï¼Ÿï¼NoNoNoï¼Œè¿™é‡ŒæŒ‡çš„æ˜¯ä¸€æ¬¡æ¡æ‰‹æŒ‡çš„æ˜¯å»ºç«‹è¿æ¥ï¼Œå®Œæˆæ¡æ‰‹å½’æ ¹åˆ°åº•äºä¼ è¾“å±‚tcpåè®®çš„ä¸‰æ¬¡æ¡æ‰‹ï¼‰ ä½†æ˜¯WebSocketæ˜¯åŸºäºhttp1.1ï¼ˆWebsocket é€šè¿‡HTTP/1.1 åè®®çš„101çŠ¶æ€ç è¿›è¡Œæ¡æ‰‹ã€‚ï¼‰ + TCPåè®®çš„ï¼Œhttp/2é€‰æ‹©äº†åŸºäºSPDY ï¼ˆå€Ÿç”¨Wikipediaçš„ï¼‰ GET /chat HTTP/1.1 Host: server.example.com Upgrade: websocket Connection: Upgrade ï¼ˆConnectionï¼šé€šç”¨é¦–éƒ¨å­—æ®µï¼‰ Sec-WebSocket-Key: x3JJHMbDL1EzLkh9GBhXDw== ï¼ˆæµè§ˆå™¨éšæœºç”Ÿæˆï¼ŒéªŒè¯ä½œç”¨ï¼‰ Sec-WebSocket-Protocol: chat, superchat ï¼ˆä¸åŒçš„æœåŠ¡æ‰€éœ€è¦çš„åè®®ï¼‰ Sec-WebSocket-Version: 13 ï¼ˆåè®®ç‰ˆæœ¬ï¼‰ Origin: http://example.com è€Œå…¶ä¸­çš„æ ¸å¿ƒåœ¨ Upgrade: websocket Connection: Upgrade WebSocketæ¨é€æŠ€æœ¯ç°åœ¨ï¼Œå¾ˆå¤šç½‘ç«™ä¸ºäº†å®ç°æ¨é€æŠ€æœ¯ï¼Œæ‰€ç”¨çš„æŠ€æœ¯éƒ½æ˜¯ Ajax è½®è¯¢ã€‚è½®è¯¢æ˜¯åœ¨ç‰¹å®šçš„çš„æ—¶é—´é—´éš”ï¼ˆå¦‚æ¯1ç§’ï¼‰ï¼Œç”±æµè§ˆå™¨å¯¹æœåŠ¡å™¨å‘å‡ºHTTPè¯·æ±‚ï¼Œç„¶åç”±æœåŠ¡å™¨è¿”å›æœ€æ–°çš„æ•°æ®ç»™å®¢æˆ·ç«¯çš„æµè§ˆå™¨ 1.æµè§ˆå™¨é€šè¿‡ JavaScript å‘æœåŠ¡å™¨å‘å‡ºå»ºç«‹ WebSocket è¿æ¥çš„è¯·æ±‚ï¼Œè¿æ¥å»ºç«‹ä»¥åï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ç«¯å°±å¯ä»¥é€šè¿‡ TCP è¿æ¥ç›´æ¥äº¤æ¢æ•°æ®ã€‚ï¼ˆé€šè¿‡æ¡æ‰‹å»ºç«‹è¿æ¥ï¼Œhttpåè®®å‡çº§ä¸ºwebsocketåè®®ï¼ŒæœåŠ¡ç«¯å“åº”101çŠ¶æ€ç ï¼‰ 2.å½“ä½ è·å– Web Socket è¿æ¥åï¼Œä½ å¯ä»¥é€šè¿‡ send() æ–¹æ³•æ¥å‘æœåŠ¡å™¨å‘é€æ•°æ®ï¼Œå¹¶é€šè¿‡ onmessage äº‹ä»¶æ¥æ¥æ”¶æœåŠ¡å™¨è¿”å›çš„æ•°æ®ã€‚ï¼ˆå…è®¸æœåŠ¡ç«¯ä¸»åŠ¨å‘å®¢æˆ·ç«¯æ¨é€æ•°æ®ï¼‰ WebSocketæ¨é€æŠ€æœ¯å’Œhttp2.0çš„æœåŠ¡ç«¯æ¨é€ï¼ˆserver pushï¼‰ï¼š HTTPåè®®å’ŒWebSocketåè®®éƒ½æ˜¯åº”ç”¨å±‚çš„åè®®ï¼Œä¸¤è€…åº”ç”¨åœºæ™¯ä¸ä¸€æ ·ã€‚ HTTPä¸»è¦ç”¨æ¥ä¸€é—®ä¸€ç­”çš„æ–¹å¼äº¤ä»˜ä¿¡æ¯ï¼›WebSocketè®©é€šä¿¡åŒæ–¹éƒ½å¯ä»¥ä¸»åŠ¨å»äº¤æ¢ä¿¡æ¯ã€‚ HTTP2è™½ç„¶æ”¯æŒæœåŠ¡å™¨æ¨é€èµ„æºåˆ°å®¢æˆ·ç«¯ï¼Œä½†é‚£ä¸æ˜¯åº”ç”¨ç¨‹åºå¯ä»¥æ„ŸçŸ¥çš„ï¼Œä¸»è¦æ˜¯è®©æµè§ˆå™¨ï¼ˆç”¨æˆ·ä»£ç†ï¼‰æå‰ç¼“å­˜é™æ€èµ„æºï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸èƒ½æŒ‡æœ›HTTP2å¯ä»¥åƒWebSocketå»ºç«‹åŒå‘å®æ—¶é€šä¿¡ã€‚ SocketSocket å…¶å®å¹¶ä¸æ˜¯ä¸€ä¸ªåè®®ï¼Œæ˜¯åº”ç”¨å±‚ä¸ TCP/IP åè®®é€šä¿¡çš„ä¸­é—´è½¯ä»¶æŠ½è±¡å±‚ï¼Œå®ƒæ˜¯ä¸€ç»„æ¥å£ã€‚ é€šè¿‡Socketï¼Œæˆ‘ä»¬æ‰èƒ½ä½¿ç”¨TCP/IPåè®®ã€‚ websocketåè®®å‡çº§å®¢æˆ·ç«¯ GET ws://localhost:3000/ws/chat HTTP/1.1 Host: localhost Upgrade: websocket Connection: Upgrade Origin: http://localhost:3000 Sec-WebSocket-Key: client-random-string Sec-WebSocket-Version: 13 1.GETè¯·æ±‚çš„åœ°å€ä»¥ws://å¼€å¤´çš„åœ°å€ï¼› 2.è¯·æ±‚å¤´Upgrade: websocketå’ŒConnection: Upgradeè¡¨ç¤ºè½¬æ¢æˆä¸ºWebSocketè¿æ¥ï¼› Sec-WebSocket-Keyæ˜¯ç”¨äºæ ‡è¯†è¿™ä¸ªè¿æ¥ï¼Œå¹¶éç”¨äºåŠ å¯†æ•°æ®ï¼› Sec-WebSocket-VersionæŒ‡å®šäº†WebSocketçš„åè®®ç‰ˆæœ¬ã€‚ æœåŠ¡ç«¯ HTTP/1.1 101 Switching Protocols Upgrade: websocket Connection: Upgrade Sec-WebSocket-Accept: server-random-string è¯¥å“åº”ä»£ç 101è¡¨ç¤ºæœ¬æ¬¡è¿æ¥çš„HTTPåè®®å³å°†è¢«æ›´æ”¹ï¼Œæ›´æ”¹åçš„åè®®å°±æ˜¯Upgrade: websocketæŒ‡å®šçš„WebSocketåè®®ã€‚ 2.websocketå®è·µåœ¨è®¡ç½‘personnelç¯‡ç« ä¸­æˆ‘ä»¬é˜è¿°äº†websocketçš„å®ç°åŸç†ï¼Œwebsocketåè®®è®©æœåŠ¡ç«¯å®ç°å‘å®¢æˆ·ç«¯ä¸»åŠ¨æ¨é€æ¶ˆæ¯çš„åŠŸèƒ½ï¼Œä¸å†éœ€è¦é‡‡ç”¨æ—§ç‰ˆAjaxè½®è¯¢è¿™ç§æµªè´¹èµ„æºçš„æ–¹å¼ã€‚ websocketåŸºäºhttp 1.1åè®® æ¥è‡ªå®¢æˆ·ç«¯çš„æ¡æ‰‹å½¢å¼ GET ws://localhost/chat HTTP/1.1 Host: localhost Upgrade: websocket Connection: Upgrade Sec-WebSocket-Key: dGhlIHNhbXBsZSBub25jZQ== Sec-WebSocket-Extension: permessage-deflate Sec-WebSocket-Version: 13 Upgradeè¡¨æ˜æ˜¯ä¸€ä¸ªå‡çº§é“¾æ¥ï¼Œå‡çº§ä¸ºwebsocket Sec-WebSocket-Keyæ˜¯å®¢æˆ·ç«¯é‡‡ç”¨base64ä½éšæœºå­—ç¬¦åºåˆ—ï¼ŒæœåŠ¡å™¨æ¥æ”¶å®¢æˆ·ç«¯HTTPåè®®å‡çº§çš„è¯æ˜ï¼Œç”¨äºæ ‡è¯†è¯¥å®¢æˆ·ç«¯ï¼Œè¦æ±‚æœåŠ¡ç«¯å“åº”ä¸€ä¸ªå¯¹åº”çš„åŠ å¯† Sec-WebSocket-Accept Sec-WebSocket-Extensionåè®®æ‹“å±•ç±»å‹ æ¥è‡ªæœåŠ¡ç«¯çš„æ¡æ‰‹å½¢å¼ HTTP/1.1 101 Switching Protocols Upgrade: websocket Connection: Upgrade Sec-WebSocket-Accept: s3pPLMBiTxaQ9kYGzzhZRbK+xOo= Sec-WebSocket-Extension: permessage-deflate å®¢æˆ·ç«¯çš„å®ç°åˆ›å»ºwebsocketå¯¹è±¡ var aWebSocket = new WebSocket(url [, protocols]); url è¦è¿æ¥çš„URLï¼›è¿™åº”è¯¥æ˜¯WebSocketæœåŠ¡å™¨å°†å“åº”çš„URLã€‚ protocols å¯é€‰ ä¸€ä¸ªåè®®å­—ç¬¦ä¸²æˆ–è€…ä¸€ä¸ªåŒ…å«åè®®å­—ç¬¦ä¸²çš„æ•°ç»„ã€‚è¿™äº›å­—ç¬¦ä¸²ç”¨äºæŒ‡å®šå­åè®®ï¼Œè¿™æ ·å•ä¸ªæœåŠ¡å™¨å¯ä»¥å®ç°å¤šä¸ªWebSocketå­åè®®ï¼ˆä¾‹å¦‚ï¼Œæ‚¨å¯èƒ½å¸Œæœ›ä¸€å°æœåŠ¡å™¨èƒ½å¤Ÿæ ¹æ®æŒ‡å®šçš„åè®®ï¼ˆprotocolï¼‰å¤„ç†ä¸åŒç±»å‹çš„äº¤äº’ï¼‰ã€‚å¦‚æœä¸æŒ‡å®šåè®®å­—ç¬¦ä¸²ï¼Œåˆ™å‡å®šä¸ºç©ºå­—ç¬¦ä¸²ã€‚ // H5å·²ç»æä¾›äº†websocketçš„APIï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ //è¿™æ˜¯äººå®¶websocketå®˜æ–¹æä¾›æµ‹è¯•çš„url let socket = new WebSocket('ws://echo.websocket.org') websocketäº‹ä»¶ äº‹ä»¶ äº‹ä»¶å¤„ç†ç¨‹åº æè¿° open websocketå¯¹è±¡.onopen å»ºç«‹è¿æ¥æ—¶è§¦å‘ message websocketå¯¹è±¡.onmessage å®¢æˆ·ç«¯æ¥æ”¶æœåŠ¡ç«¯æ•°æ®æ—¶è§¦å‘ error websocketå¯¹è±¡.onerror é€šä¿¡å‘ç”Ÿé”™è¯¯è§¦å‘ close websocketå¯¹è±¡.onclose è¿æ¥å…³é—­è§¦å‘ websocketæ–¹æ³• send()æ–¹æ³•ï¼Œï¼Œç”¨äºç»™æœåŠ¡ç«¯å‘é€æ•°æ® ç„¶åå†æµè§ˆå™¨è°ƒè¯•å¯ä»¥çœ‹åˆ°æˆ‘ä»¬å‘é€æˆåŠŸäº† //H5å·²ç»æä¾›äº†websocketçš„APIï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ //è¿™æ˜¯äººå®¶websocketå®˜æ–¹æä¾›æµ‹è¯•çš„url let ws = new WebSocket('ws://echo.websocket.org'); // 1.è¿æ¥æˆåŠŸçš„å›è°ƒ ws.addEventListener('open', function () { console.log('è¿æ¥æˆåŠŸ'); }) // 2.ä¸»åŠ¨ç»™websocketå‘æ¶ˆæ¯ button.addEventListener('click', function () { let val = input.value; ws.send(val) }) // 3.æ¥æ”¶websocketæœåŠ¡çš„æ•°æ®ï¼Œé€šè¿‡äº‹ä»¶å¯¹è±¡eå¯ä»¥å¾—åˆ°æœåŠ¡ç«¯è¿”å›çš„æ•°æ® ws.addEventListener('message', function (e) { console.log(e); div.innerHTML = e.data; }) æœåŠ¡ç«¯çš„å®ç°è¿™é‡Œæˆ‘ä½¿ç”¨çš„æ˜¯nodejså¸¦çš„websocketåŒ…ï¼ˆhttps://github.com/sitegui/nodejs-websocket è¿™ä¸ªæ˜¯è¯¥åŒ…å¯¹åº”çš„æºç åœ°ç‚¹ï¼Œé‡Œé¢æœ‰è¯¦è§£è¯¥åŒ…åˆ›å»ºæœåŠ¡å¯¹è±¡åï¼Œå¯ä»¥ä½¿ç”¨çš„æ–¹æ³•ï¼‰ npm install nodejs-websocket åœ¨æ–°å»ºçš„nodejsæœåŠ¡å™¨ä¸Šä½¿ç”¨ æ¯ä¸€æ¬¡åªè¦æœ‰ç”¨æˆ·è¿›è¡Œè¿æ¥ï¼Œå°±ä¼šæ‰§è¡Œè¯¥å›è°ƒå‡½æ•°ï¼Œç„¶åç»™å½“å‰ç”¨æˆ·åˆ›å»ºä¸€ä¸ªconnectå¯¹è±¡ const ws = require(\"nodejs-websocket\") const server = ws.createServer(function (connect) { console.log(\"New connection\") //textäº‹ä»¶ç”¨äºæ¥æ”¶ç”¨æˆ·è¯·æ±‚ï¼Œdataä¸ºç”¨æˆ·å‘é€çš„æ•°æ® connect.on(\"text\", function (data) { console.log(\"Received \" + data) //æœåŠ¡å™¨ç»™å®¢æˆ·ç«¯å‘é€å“åº” connect.sendText(data.toUpperCase() + \"!!!\") }) //websocketè¿æ¥æ–­å¼€ï¼ˆç”¨æˆ·å…³é—­ç½‘é¡µç­‰æ“ä½œï¼‰ï¼Œæ‰§è¡Œçš„å›è°ƒå‡½æ•° connect.on(\"close\", function (code, reason) { console.log(\"Connection closed\") }) //ä¸€èˆ¬ä½¿ç”¨æ³¨å†Œcloseä¼´éšç€ä¸€ä¸ªerroräº‹ä»¶ï¼Œå¤„ç†ç”¨æˆ·é”™è¯¯ä¿¡æ¯ connect.on('error', () => { console.log('ç”¨æˆ·è¿æ¥å¼‚å¸¸'); }) //ç›‘å¬ç«¯å£5208 }).listen(5208, () => { console.log('app is running at port!'); }) ç»™æ‰€æœ‰ç”¨æˆ·å‘é€ä¿¡æ¯ï¼ˆå¹¿æ’­ï¼‰çš„æ–¹æ³• broadcast function broadcast(server, msg) { server.connections.forEach(function (conn) { conn.sendText(msg) }) } ç„¶ååœ¨æ¯ä¸ªconnectå¯¹è±¡çš„äº‹ä»¶é‡Œè°ƒç”¨ broadcast(msg)å³å¯ï¼Œå¦‚æœmsgæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œè¦å°†å¯¹è±¡è½¬åŒ–ä¸ºå­—ç¬¦ä¸²æ‰èƒ½å‘é€ send(JSON.stringfy(msg)) 3.websocketæ¡†æ¶å¯ä»¥ä»ä¸Šé¢çœ‹åˆ°ï¼Œæˆ‘ä»¬ä½¿ç”¨websocketæ—¶æ¯ä¸€æ­¥äº‹ä»¶éƒ½éœ€è¦æˆ‘ä»¬è‡ªå·±å»å°è£…ï¼Œæ”¯æŒçš„æ—¶é—´å¤ªå°‘ï¼Œå¯èƒ½ä¼šæ¯”è¾ƒéº»çƒ¦ï¼Œåœ¨åº”å¯¹æå¤æ‚åº¦çš„ä»£ç æ˜¯ä¼šç•¥æ˜¾å†—æ‚ï¼› æˆ‘ä»¬å¯ä»¥ä½¿ç”¨websocketæ¡†æ¶ socket.io è¿›è¡Œæ›¿ä»£ + å®Œå–„ è¯´æ˜¯è¯´æ¡†æ¶ï¼Œä½†å®˜æ–¹ä¹Ÿè§£é‡Šäº†socket.ioå¹¶ä¸æ˜¯websocketçš„ä¸€ä¸ªå®è·µï¼Œå³ä½¿ä»–åœ¨å…¶ä¸­æœ‰ä½¿ç”¨åˆ°websocketçš„ä¼ è¾“åè®®ï¼Œä½†å®ƒä½œå‡ºäº†è®¸å¤šæ‹“å±•ï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆ WebSocket å®¢æˆ·ç«¯æ— æ³•æˆåŠŸè¿æ¥åˆ° Socket.IO æœåŠ¡å™¨ï¼Œè€Œ Socket.IO å®¢æˆ·ç«¯ä¹Ÿæ— æ³•è¿æ¥åˆ°æ™®é€š WebSocket æœåŠ¡å™¨çš„åŸå› ã€‚ï¼ˆä½†åœ¨å®ç°åŠŸèƒ½ä¸Šï¼Œæˆ‘ä»¬å¯ä»¥çœ‹æˆæ˜¯ä¸€è‡´çš„ï¼‰ é™„ä¸Šå®˜ç½‘ https://socket.io/ æœåŠ¡ç«¯ä½¿ç”¨npm install socket.io åœ¨expressä¸­å¯ä»¥ä½¿ç”¨ï¼ˆå®˜ç½‘è¿˜æœ‰åœ¨typescriptã€koaç­‰è¯­è¨€æ¡†æ¶ä¸­ä½¿ç”¨çš„æ–¹æ³•ï¼‰ const app = require(\"express\")(); const httpServer = require(\"http\").createServer(app); //ä»¥å‰æˆ‘ä»¬ä½¿ç”¨åŸç”Ÿnodejsåˆ›å»ºæœåŠ¡å™¨ã€å‘é€è¯·æ±‚è°ƒç”¨è¿‡httpåŒ… const options = { /* ... */ }; const io = require(\"socket.io\")(httpServer, [options]); httpServer.listen(3000); 1.æ­¤æ—¶ç›‘å¬ç”¨æˆ·è¿æ¥äº‹ä»¶ io.on(&quot;connection&quot;, socket =&gt; {}) socket å‚æ•°è¡¨ç¤ºå½“å‰ç”¨æˆ· socket.emit(äº‹ä»¶å, ä¼ å…¥æ•°æ®å‚æ•°)socketä¸»åŠ¨è§¦å‘äº‹ä»¶çš„æ–¹æ³• socket.on(äº‹ä»¶å, æ¥æ”¶æ•°æ®å‚æ•°)socketç›‘å¬æµè§ˆå™¨ï¼ˆå®¢æˆ·ç«¯ï¼‰/ æœåŠ¡å™¨ äº‹ä»¶çš„æ–¹æ³• äº‹ä»¶åå‚æ•°æ˜¯è‡ªå®šä¹‰çš„ï¼Œè¯¥ä¼ é€’æ–¹å¼æœ‰ç‚¹åƒVueçš„äº‹ä»¶æ€»çº¿ï¼ˆeventbusï¼‰ï¼Œå®è¡Œè®¢é˜…å’Œå‘å¸ƒæ¶ˆæ¯æ•°æ® å¹¿æ’­æ¶ˆæ¯: io.emit io.on io.on(\"connection\", socket => { /* ... */ socket.emit('send', {name:'Allen'}); //å‘é€æ•°æ®åˆ°å®¢æˆ·ç«¯ }); 2.æ­¤æ—¶ç›‘å¬ç”¨æˆ·æ–­å¼€äº‹ä»¶ io.on(&quot;disconnect&quot;, () =&gt; {}) 3.è·¨åŸŸé—®é¢˜ æ³¨æ„ï¼šåœ¨ socket.io ä¸­ä½¿ç”¨ corså…è®¸è·¨åŸŸæ—¶ï¼Œå¿…é¡»åœ¨optioné€‰é¡¹é‡Œè¿›è¡Œè®¾ç½®ï¼Œä¸ç„¶ä¼šæŠ¥é”™ // socket åˆå§‹åŒ– const io = require(\"socket.io\")(server, { cors: true }) å®¢æˆ·ç«¯ä½¿ç”¨å®‰è£… &lt;script src = \"/socket.io/socket.io.js\" > &lt;/script> &lt;script> const socket = io(); &lt;/script> or $ npm install socket.io-client åœ¨åŒä¸€ä¸ªåŸŸé€šä¿¡ const socket = io(); ä¸åŒåŸŸé€šä¿¡ const socket = io(\"æœåŠ¡å™¨åœ°å€url\"); ç›¸å¯¹æœåŠ¡ç«¯ï¼Œå®¢æˆ·ç«¯å¹¶ä¸éœ€è¦å°†ç›‘å¬å’Œå‘å¸ƒæ—¶é—´æ”¾åœ¨ io.on(&quot;connection&quot;, () =&gt; {})é‡Œé¢ï¼Œç›´æ¥åœ¨script/ jsæ–‡ä»¶é‡Œä½¿ç”¨ socket.emit(äº‹ä»¶å, æ•°æ®å‚æ•°) / socket.on(äº‹ä»¶å, æ•°æ®å‚æ•°) æ¥å®æ–½å®¢æˆ·ç«¯çš„äº‹ä»¶ç›‘å¬å’Œå‘å¸ƒ è¸©å‘ä¹‹è·¯ï¼š éƒ¨ç½²åˆ°æœåŠ¡å™¨ä¸Šæ—¶ï¼Œurlåœ°å€è®°å¾—ä¸ºåè®®å + ip + ç«¯å£å·","categories":[{"name":"ç½‘ç»œ","slug":"ç½‘ç»œ","permalink":"https://taylor12138.github.io/categories/%E7%BD%91%E7%BB%9C/"}],"tags":[],"author":"Hello"},{"title":"whistle","slug":"whistle","date":"2022-03-05T11:17:27.225Z","updated":"2023-01-24T03:52:50.827Z","comments":true,"path":"2022/03/05/whistle/","link":"","permalink":"https://taylor12138.github.io/2022/03/05/whistle/","excerpt":"","text":"Whislteæ¦‚è¿°Whistle æ˜¯ä¸€ä¸ªåŸºäº Node å®ç°çš„è·¨å¹³å° Web è°ƒè¯•ä»£ç†å·¥å…·ã€‚ å’Œå…¶ä»–æŠ“åŒ…è½¯ä»¶ï¼Œå¦‚ Charlesã€Fiddler ä¸€æ ·ï¼Œå®ƒå¯ä»¥æŸ¥çœ‹ã€ä¿®æ”¹ HTTPã€HTTPSã€Websocket çš„è¯·æ±‚ã€å“åº”ï¼Œä¹Ÿå¯ä»¥ä½œä¸º HTTP ä»£ç†æœåŠ¡å™¨ä½¿ç”¨ã€‚å¾—ç›Šäºå…¶å¼ºå¤§çš„è§„åˆ™é…ç½®åŠŸèƒ½ï¼Œç†è®ºä¸Šå¯ä»¥å®ç°å¯¹è¯·æ±‚ã€å“åº”çš„ä»»æ„ä¿®æ”¹ã€‚Whistle æ˜¯å¼€æºè½¯ä»¶ï¼Œä½¿ç”¨å®Œå…¨å…è´¹ã€‚ å®˜æ–¹æ–‡æ¡£ &amp; GitHub å¿«é€Ÿå®‰è£…ï¼š brew install whistle # é€šè¿‡ Homebrew å®‰è£… npm i -g whistle # æˆ–è€…é€šè¿‡ npm å…¨å±€å®‰è£… å¯åŠ¨ Whistle æœåŠ¡ï¼š w2 start ç„¶åå°±å¯ä»¥çœ‹è§ é…ç½®ä»£ç†é…ç½®ä»£ç†æ–¹å¼æˆ‘ä»¬å¯ä»¥æŸ¥çœ‹å®˜ç½‘ï¼šhttps://wproxy.org/whistle/install.html å…¶ä¸­æœ‰macã€windows å…¨å±€ä»£ç†ï¼Œchromeå±€éƒ¨ä»£ç†ã€æ‰‹æœºå…¨å±€ä»£ç† è¿™é‡Œæˆ‘é€‰æ‹©chromeå±€éƒ¨ä»£ç†ï¼Œä½¿ç”¨ Proxy SwitchyOmega æ‰©å±•ç¨‹åºï¼Œå•ç‹¬ä¸ºæµè§ˆå™¨å•ç‹¬è®¾ç½®ä»£ç†ï¼Œè¿›è¡Œæœ¬åœ°ç¯å¢ƒè°ƒè¯• å®‰è£…å®Œæˆåï¼Œæˆ‘ä»¬å¯¹å…¶è¿›è¡Œä»£ç†é…ç½®ï¼š ä»¥ä¸Šå°±é…ç½®å®Œäº†ï¼Œåœ¨å¼€å¯whistleåï¼Œï¼Œå¯¹äºæµè§ˆå™¨å…ˆæ‰“å¼€auto switchï¼Œ ç„¶åå†æ‰“å¼€http://127.0.0.1:8899/#networkå°±å¯ä»¥çœ‹åˆ°åŒ…ä¿¡æ¯äº† ä½¿ç”¨æˆ‘ä»¬ç‚¹å‡»å…¶ä¸­ä¸€ä¸ªè¯·æ±‚ï¼Œåœ¨å³ä¾§è¾¹æ ä¸­å³å¯çœ‹åˆ°è¯¥è¯·æ±‚ä¸å“åº”çš„è¯¦ç»†ä¿¡æ¯ã€‚å…¶ä¸­ï¼š Overview è¯·æ±‚çš„åŸºæœ¬ä¿¡æ¯ Inspectors è¯·æ±‚ä¸å“åº”çš„è¯¦æƒ… Request: Headers, WebForms, Body, JSONView, HexView, Cookies, Raw Response: Headers, Preview, Body, JSONView, HexView, Cookies, Trailers, Raw Timeline è¯·æ±‚çš„æ—¶é—´çº¿ Composer æ„é€ è¯·æ±‚ï¼Œæˆ–è€…ä¿®æ”¹è¯·æ±‚å†æ¬¡å‘é€ Tools å…¶ä»–å·¥å…· ç„¶åç‚¹å‡»å“åº”è¯¦æƒ…çš„ Inspectors -&gt; response -&gt; +key -&gt; å–ä¸ªåå­—ï¼Œå°†å“åº”ä¿¡æ¯ä¿å­˜åˆ°æœ¬åœ° ç„¶åï¼Œåœ¨å·¦ä¾§è¾¹æ çš„ã€ŒValuesã€èœå•ä¸­ï¼Œå°±å¯ä»¥çœ‹åˆ°æˆ‘ä»¬ä¿å­˜çš„å“åº”ç»“æœ è¿™æ˜¯ä¸€ä¸ªç¼–è¾‘é¡µé¢ï¼Œç¼–è¾‘å®Œåæˆ‘ä»¬å¯ä»¥ç”¨control + s ä¿å­˜ å½“ç„¶ï¼Œæˆ‘ä»¬æœ€å¥½æŠŠä»–æ¢æˆjsonæ ¼å¼ è®¾ç½®æ›¿æ¢è§„åˆ™ç°åœ¨æˆ‘ä»¬æœ‰äº†mockçš„jsonæ–‡ä»¶ï¼Œå¯ä»¥é€šè¿‡whistleçš„Rulesé€‰é¡¹è®¾ç½®è§„åˆ™ï¼Œè®©æ¥å£åŒ¹é…å¯¹åº”çš„mockæ•°æ® # æŠŠå‰é¢çš„è¯·æ±‚åœ°å€å¤åˆ¶è¿‡æ¥ https://åŸŸå/api/moyi/activity/creative/painting file://`{mockname.json}` # å¦‚æœä½ æ˜¯è·¨åŸŸè®¿é—®çš„ï¼Œå¯èƒ½éœ€è¦åœ¨æœ€ååŠ ä¸€ä¸ª resCorsï¼Œå°±åƒè¿™æ ·ï¼š https://åŸŸå/api/moyi/activity/creative/painting file://`{mockname.json}` resCors://enable è€Œå¯¹äºä¸€èˆ¬æƒ…å†µï¼Œæˆ‘ä»¬ä¹Ÿä¸å¯èƒ½é’ˆå¯¹ä¸€ä¸ªåœ°å€ä¸€æ¬¡è§„åˆ™æ›¿æ¢ä¿¡æ¯ï¼Œå®˜æ–¹å®ƒçš„åŒ¹é…æ¨¡å¼è§„åˆ™ï¼Œå’Œæ­£åˆ™åŒ¹é…ç±»ä¼¼ï¼Œå½“ç„¶è¿˜æœ‰å…¶ä»–å¥½ç”¨çš„åŒ¹é…è§„åˆ™ï¼Œè¯¦æƒ…ï¼šhttps://wproxy.org/whistle/pattern.html # è·¯å¾„åŒ¹é… http://www.test.com/xxx operatorURI # é€šé…ç¬¦åŒ¹é… ^/api/moyi/activity/creative/painting file://`{mockname.json}` # æ­£åˆ™åŒ¹é… æ‰€æœ‰è¿™ä¸ªåŸŸåä¸‹çš„æ¥å£éƒ½å¼ºåˆ¶å¼€å¯ CORS /(igame|moyis|music)\\.163\\.com\\/.*api\\/.*/i resCors://enable hostæ›¿æ¢åŒæ ·çš„ï¼Œåœ¨Rulesè§„åˆ™é¡µï¼Œå¯ä»¥åƒè®¾ç½®æœ¬åœ°/etc/hostsä¸€æ ·è®¾ç½®æœ¬åœ°host 127.0.0.1 www.example.com é™¤æ­¤ä¹‹å¤–è¿˜æœ‰å…¶ä»–ç‰¹ç‚¹ï¼š çµæ´»åŒ¹é… é™¤äº†ä¿ç•™hostsæ–‡ä»¶å•ä¸€çš„è¯­æ³•è§„åˆ™æ¥æ”¯æŒåŸŸååŒ¹é…å¤–ï¼Œwhistleè¿˜æä¾›ç»™å¼€å‘è€…æ›´åŠ çµæ´»å¼ºå¤§çš„ç«¯å£æ˜ å°„(å³æ”¯æŒipå¸¦ç«¯å£)ã€CNAMEã€è·¯å¾„åŒ¹é…ã€ç²¾ç¡®åŒ¹é…ã€æ­£åˆ™è¡¨è¾¾å¼ã€ç»„åˆç­‰hoståŒ¹é…æ¨¡å¼ã€‚è¯­æ³•è§„åˆ™çš„ä¸€èˆ¬æè¿°å¦‚ä¸‹ï¼š host pattern1 pattern2 patternN hostä¸ºè®¡åˆ’è½¬å‘åˆ°ip:portï¼Œpattern1-Nä¸ºåŒ¹é…è¯·æ±‚urlçš„è¡¨è¾¾å¼ã€‚å½“patternåªæœ‰ä¸€ä¸ªæ—¶ï¼Œhostå’Œpatternçš„é¡ºåºå¾€å¾€å¯ä»¥äº’æ¢ï¼Œå…·ä½“å¯å‚è€ƒåŒ¹é…æ¨¡å¼ã€‚ ç«¯å£æ˜ å°„ 127.0.0.1:8080 www.example.com # ä½ç½®å¯ä»¥è°ƒæ¢ï¼Œç­‰ä»·äºï¼š # www.example.com 127.0.0.1:8080 å¯¹äºæœ¬åœ°å¼€å‘è°ƒè¯•ï¼Œå¾€å¾€æ— æ³•åªåœ¨80ç«¯å£æä¾›WebæœåŠ¡ã€‚å¦‚æœä½¿ç”¨ä¼ ç»Ÿçš„hostsæ–‡ä»¶æ–¹å¼ï¼Œæˆ‘ä»¬åªèƒ½é€šè¿‡www.example.com:8080è®¿é—®åˆ°æœ¬åœ°çš„8080ç«¯å£ï¼Œä½¿ç”¨whistleæä¾›çš„ç«¯å£æ˜ å°„åŠŸèƒ½å³å¯å¾ˆå¥½è§£å†³è¿™ä¸€é—®é¢˜ã€‚ è·¯å¾„åŒ¹é… 127.0.0.1:8080 example.com/test # ä½ç½®å¯ä»¥è°ƒæ¢ï¼Œç­‰ä»·äºï¼š # example.com/test 127.0.0.1:8080 é€šè¿‡é…ç½®ä¸Šè¿°è§„åˆ™ï¼Œå¯å°†example.com/testè·¯å¾„ä¸‹çš„è¯·æ±‚è½¬å‘åˆ°æœ¬åœ°çš„8080ç«¯å£ï¼Œæ¯”å¦‚è¯·æ±‚example.com/test/a.htmlã€example.com/test?a=1ï¼Œä½†å¯¹äºè¯·æ±‚example.com/testaåˆ™ä¸ä¼šè¿›è¡Œè½¬å‘å¤„ç†ã€‚æ³¨æ„ï¼Œä½¿ç”¨ä¼ ç»Ÿçš„hostsè¯­æ³•ï¼Œæ˜¯å°†è¯¥åŸŸåä¸‹çš„æ‰€æœ‰è¯·æ±‚éƒ½è¿›è¡Œhostæ›¿æ¢å¤„ç†ã€‚ å…¶ä»–åŒ¹é…è§„åˆ™å’Œç‰¹æ€§å¯ä»¥æŸ¥çœ‹å®˜ç½‘ çº¿ä¸Šç¯å¢ƒæ‰“å¼€æœ¬åœ°é¡µé¢ç»è¿‡whistleä»£ç†åï¼Œæˆ‘ä»¬å¯ä»¥éšæ„é€šè¿‡ä¿®æ”¹è¯·æ±‚å†…å®¹ï¼Œå°†è¯·æ±‚å†…å®¹ä»£ç†ä¸ºæœ¬åœ°é¡µé¢ï¼Œåœ¨ä¼ ç»™appï¼Œå°±å¯ä»¥å®ç°appçº¿ä¸Šç¯å¢ƒæŸ¥çœ‹æœ¬åœ°ç¯å¢ƒé¡µé¢ è€Œè¿™é‡Œæ›´æ¨èé‡å®šå‘ï¼ˆredirectï¼‰æ¥æ›¿æ¢çº¿ä¸Šé¡µé¢è€Œä¸æ˜¯å¼ºè¡Œæš´åŠ›æ›¿æ¢htmlï¼Œæ˜¯å› ä¸ºé¡µé¢çš„urlåœ°å€è¿˜æ˜¯æ²¡å˜çš„ï¼Œæ­¤æ—¶cssã€jsèµ„æºå¦‚æœæ˜¯ä¾èµ–url + è·¯å¾„åè·å–çš„è¯ï¼Œä¼šå¯¼è‡´èµ„æºåŠ è½½å¤±è´¥ï¼Œç”šè‡³å‡ºç°ä¸€äº›è·¨åŸŸé—®é¢˜ 1.é¦–å…ˆæˆ‘ä»¬å°†æ‰‹æœºå¼„ä¸ªä»£ç† 2.ç»™æ‰‹æœºè£…å¥½æ ¹è¯ä¹¦ï¼Œå¥½æŠ“httpsçš„åŒ… 3.åœ¨Rulesè§„åˆ™é¡µä¸‹è¿›è¡Œæ›¿æ¢ https://m.moyi.163.com/newyear20230117/half/index.html redirect://`http://æœ¬åœ°ipåœ°å€:8080/half/index.html` # é€šé…ç¬¦ç®€åŒ–ï¼Œä¹Ÿå¯ä»¥æ‰“å¼€æœ¬åœ°å¼€å‘é¡µé¢å“¦ï¼Œæ³¨æ„è¦ç”¨å±€åŸŸç½‘åœ°å€ ^/newyear20230117/half/index.html redirect://`http://æœ¬åœ°ipåœ°å€:8080` æ­¤æ—¶æˆ‘ä»¬å°±å¯ä»¥åœ¨çº¿ä¸Šç¯å¢ƒçœ‹åˆ°æˆ‘ä»¬æœ¬åœ°æµ‹è¯•ç¯å¢ƒçš„é¡µé¢äº†ï½ æ›¿æ¢jsèµ„æºé™¤æ­¤ä¹‹å¤–ï¼Œæˆ‘ä»¬ç”šè‡³å¯ä»¥æ›¿æ¢çº¿ä¸Šçš„jsèµ„æºï¼Œå¸®æˆ‘ä»¬å…é™¤æ‰åå¤çº¿ä¸Šéƒ¨ç½²ï¼Œæµ‹è¯•çš„é—®é¢˜ï¼ˆæœ¬åœ°æµ‹è¯•ç¯å¢ƒæ²¡é—®é¢˜ï¼Œçº¿ä¸Šç¯å¢ƒæœ‰é—®é¢˜çš„æ—¶å€™ï¼‰ æ¯”å¦‚ï¼Œæˆ‘æ„Ÿè§‰è¿™ä¸ªåŒ…çš„jsä»£ç æœ‰é—®é¢˜ï¼Œç°åœ¨æƒ³è¦æ›¿æ¢æ‰ æˆ‘ä»¬ç›´æ¥æŠŠåŸå§‹è„šæœ¬ä¸‹è½½ä¸‹æ¥ï¼Œä¿®æ”¹å®ƒã€‚ç„¶åæ·»åŠ ä»¥ä¸‹è§„åˆ™ï¼š # è¿™é‡Œåœ¨æ–‡ä»¶é‡ŒåŠ äº†ä¸ª alert(12345)ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥åŠ  debugger ^/static_public/5fb72673e2a9649c728fbf99/SocialLiveTask/1.0.2/index.min.js file:///Users/localcode/Downloads/index.min.js # å¯é€‰ï¼šç¦ç”¨ JS æ–‡ä»¶çš„æµè§ˆå™¨ç¼“å­˜ *.js cache://no åˆ·æ–°é¡µé¢ï¼Œå¯ä»¥çœ‹åˆ°ä¿®æ”¹çš„ä»£ç å·²ç»ç”Ÿæ•ˆäº†ï¼ˆå¦‚æœæ²¡ç”Ÿæ•ˆï¼Œä½ å¯èƒ½éœ€è¦æ¸…ç©ºæµè§ˆå™¨ç¼“å­˜ï¼‰ã€‚è™½ç„¶ä»£ç æ˜¯ minified è¿‡çš„ï¼Œä½†æ ¼å¼åŒ–ä¸€ä¸‹ï¼Œå¤§éƒ¨åˆ†æƒ…å†µä¸‹ä¹Ÿå¯ä»¥è°ƒè¯•äº†ã€‚ä½†å¦‚æœä»£ç å¾ˆå¤æ‚ï¼Œminified ä¹‹åæ ¹æœ¬çœ‹ä¸æ‡‚å‘¢ï¼Ÿ æ²¡æœ‰å…³ç³»ï¼Œå¦‚æœä½ æœ¬åœ°æœ‰æºç ï¼Œé‚£ä¹ˆå¯ä»¥ä¿®æ”¹æºç ï¼Œé€šè¿‡ npm run build ç”Ÿæˆç¼–è¯‘ç»“æœï¼Œç„¶åå†åšèµ„æºæ›¿æ¢ã€‚ç†è®ºä¸Šæ¥è¯´ï¼Œåªè¦å‚æ•°æ­£ç¡®ï¼Œæœ¬åœ°ç”Ÿäº§çš„æ„å»ºç»“æœåº”è¯¥å’Œçº¿ä¸Šçš„æ˜¯ä¸€è‡´çš„ï¼Œæ‰€ä»¥æ›¿æ¢ä¹Ÿä¸ä¼šæœ‰é—®é¢˜ã€‚ é€šè¿‡è¿™ç§æ–¹æ³•ï¼Œå¯ä»¥çœå»åå¤éƒ¨ç½²å†éªŒè¯çš„éº»çƒ¦ è®¾ç½® Cookieåœ¨æ‰‹æœºä¸Šè®¾ç½® cookie ä¸€ç›´æ˜¯ä¸ªæ¯”è¾ƒéº»çƒ¦çš„é—®é¢˜ï¼Œä¸€èˆ¬å¯èƒ½ä¼šåšä¸ªå¼€å‘ç™»å½•é¡µæ¥å†™å…¥ cookieã€‚é€šè¿‡ Whistle çš„ cookie æ›¿æ¢åŠŸèƒ½ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥æŠŠ cookie å†™å…¥æ‰‹æœºï¼Œæ— éœ€å…¶ä»–ç¹çæ“ä½œã€‚ ä»¥äº‘éŸ³ä¹çš„ MIDDLE_U cookie ä¸ºä¾‹ï¼Œåœ¨ whistle -&gt; http://127.0.0.1:8899/#values ä¸­æ–°å»ºä¸€ä¸ª JSONï¼š { \"MIDDLE_U\": { \"value\": \"4547604608\", \"maxAge\": 315360000, \"httpOnly\": false, \"path\": \"/\", \"secure\": false, \"domain\": \".moyi.163.com\" } } åœ¨ Rules ä¸­æ·»åŠ å¦‚ä¸‹è§„åˆ™ï¼š # æ³¨æ„ï¼šåŸŸåéœ€è¦å’Œä¸Šé¢ cookie ä¸­çš„ domain æ˜¯åŒæº # è¿™é‡ŒåŒ¹é…çš„æ˜¯æ¥å£çš„åŸŸå api.moyi.163.com resCookies://{moyidevcookie.json} åœ¨æ‰‹æœºä¸Šè®¿é—®ä¸€ä¸‹è¿™ä¸ªé¡µé¢ï¼Œcookie å°±è¢«è®¾ç½®ä¸Šå•¦ã€‚è®¾ç½®å®Œæˆåå¯ä»¥æŠŠè¿™è¡Œè§„åˆ™æ³¨é‡Šæ‰ï¼Œåªè¦æ‰‹æœºä¸Šä¸æ¸…ç©ºä¼šä¸€ç›´ç”Ÿæ•ˆã€‚","categories":[{"name":"ç½‘ç»œ","slug":"ç½‘ç»œ","permalink":"https://taylor12138.github.io/categories/%E7%BD%91%E7%BB%9C/"}],"tags":[],"author":"Hello"},{"title":"BOM","slug":"BOM","date":"2022-03-05T03:03:30.465Z","updated":"2023-01-26T13:28:56.129Z","comments":true,"path":"2022/03/05/bom/","link":"","permalink":"https://taylor12138.github.io/2022/03/05/bom/","excerpt":"","text":"1.BOMæ¦‚è¿°BOMæ˜¯æµè§ˆå™¨å¯¹è±¡æ¨¡å‹ï¼Œä»–æä¾›ç‹¬ç«‹äºå†…å®¹è€Œä¸æµè§ˆå™¨çª—å£è¿›è¡Œäº¤äº’çš„å¯¹è±¡ï¼Œå…¶æ ¸å¿ƒå¯¹è±¡æ˜¯window BOMç¼ºä¹æ ‡å‡†ï¼ŒJavascriptè¯­æ³•çš„æ ‡å‡†åŒ–ç»„ç»‡æ˜¯ECMAï¼ŒDOMæ ‡å‡†åŒ–ç»„ç»‡æ˜¯W3Cï¼ŒBOMæœ€åˆæ˜¯Netscapeæµè§ˆå™¨æ ‡å‡†çš„ä¸€éƒ¨åˆ†ï¼Œæ‰€ä»¥å®ƒçš„å…¼å®¹æ€§æ¯”è¾ƒçš„å·® BOMæ¯”DOMæ›´å¤§ï¼Œå®ƒåŒ…å«ç€DOM windowå¯¹è±¡æ˜¯æµè§ˆå™¨çš„é¡¶çº§å¯¹è±¡ï¼Œå®ƒæ˜¯JSæµè§ˆå™¨çš„ä¸€ä¸ªæ¥å£ï¼Œæ˜¯ä¸€ä¸ªå…¨å±€å¯¹è±¡ï¼Œå®šä¹‰åœ¨å…¨å±€ä½œç”¨åŸŸçš„å˜é‡ï¼ˆvarï¼‰ã€å‡½æ•°éƒ½ä¼šå˜æˆwindowå¯¹è±¡çš„å±æ€§å’Œæ–¹æ³•ï¼ˆalert()ã€prompt() ï¼‰ï¼Œåœ¨è°ƒç”¨çš„æ—¶å€™å¯ä»¥çœç•¥window 2.onLoadæœ¬æ¥æˆ‘ä»¬çš„å†…åµŒå¼&lt;script&gt;&lt;/script&gt;åªèƒ½æ”¾åœ¨æ‰€æœ‰æ ‡ç­¾æ ‡ç­¾ä¸‹æ–¹ è€Œwindow.onloadå¯ä»¥è§£å†³ï¼Œå®ƒæ˜¯çª—å£åŠ è½½äº‹ä»¶ï¼Œå½“æ–‡æ¡£å†…å®¹å®Œå…¨åŠ è½½ä»¥åæ‰ä¼šè§¦å‘è¯¥äº‹ä»¶ï¼ˆåŒ…æ‹¬å›¾åƒã€è„šæœ¬ã€CSSï¼‰ï¼Œå°±è°ƒç”¨è¯¥å‡½æ•° &lt;script> window.onload = function() { var btn = document.querySelector('button'); btn.onclick = function() { } } &lt;/script> &lt;button>&lt;/button> ä½†æ˜¯window.onloadä¼ ç»Ÿæ³¨å†Œæ–¹å¼åªèƒ½å†™ä¸€æ¬¡ï¼Œå¦‚æœå†™å¤šä¸ªï¼Œåªä»¥æœ€åä¸€ä¸ªonloadä¸ºå‡†ï¼Œæ‰€ä»¥æ¨è window.addEventListener('load', function() {}) æ‰€ä»¥ä¸€èˆ¬æƒ…å†µä¸‹å¼•å…¥jsæ–‡ä»¶ï¼Œåˆ™è¯¥jsæ–‡ä»¶éƒ½è¦æ·»åŠ  â†‘ pageshowäº‹ä»¶ä¸‹é¢ä¸‰ç§æƒ…å†µä¼šè§¦å‘loadäº‹ä»¶ï¼š 1.aæ ‡ç­¾çš„è¶…é“¾æ¥ 2.F5åˆ·æ–°ï¼ˆæˆ–è€…å¼ºåˆ¶åˆ·æ–°ï¼‰ 3.å‰è¿›æˆ–åé€€ ä½†æ˜¯åœ¨ç«ç‹ä¸­æœ‰ä¸ªâ€œå¾€è¿”ç¼“å­˜â€ï¼Œå®ƒä¸ä»…ä¿ç•™ç€é¡µé¢æ•°æ®ï¼Œè¿˜ä¿å­˜ç€DOMå’ŒJavascriptçš„çŠ¶æ€ï¼Œå®é™…ä¸Šå°†æ•´ä¸ªé¡µé¢ä¿å­˜åœ¨å†…å­˜é‡Œï¼Œå¯¼è‡´åé€€æŒ‰é’®ä¸èƒ½åˆ·æ–°é¡µé¢ï¼ˆæ— æ³•è§¦å‘loadäº‹ä»¶ï¼‰ æ‰€ä»¥æ­¤æ—¶å¯ä»¥ç”¨pageshowäº‹ä»¶æ¥è§¦å‘ï¼Œå®ƒæœ‰ç‚¹åƒloadï¼Œä½†æ˜¯äº‹ä»¶åœ¨é¡µé¢æ˜¾ç¤ºæ—¶å°±ä¼šè§¦å‘ï¼Œæ— è®ºé¡µé¢æ˜¯å¦æ¥è‡ªç¼“å­˜ï¼ˆæ³¨æ„è¿™ä¸ªäº‹ä»¶æ˜¯ç»™windowæ·»åŠ çš„ï¼‰ window.addEventListener('pageshow', fucntion(e){ //e.persistedè¿”å›çš„æ˜¯trueï¼Œå°±æ˜¯è¯´å¦‚æœè¿™ä¸ªé¡µé¢æ˜¯ä»ç¼“å­˜å–è¿‡æ¥çš„é¡µé¢ï¼Œä¹Ÿéœ€è¦é‡æ–°è®¡ç®—ä¸€ä¸‹rem if(e.persisted) { setRemUnit(); //è¿™ä¸ªå‡½æ•°æ˜¯è®¾ç½®remçš„ } }) DOMContentLoadedå½“DOMåŠ è½½å®Œæ¯•æ—¶è§¦å‘ï¼Œä¸åŒ…æ‹¬æ ·å¼è¡¨ï¼Œå›¾ç‰‡ï¼Œflashç­‰ï¼Œie9ä»¥ä¸Šæ”¯æŒï¼Œå¦‚æœé¡µé¢å›¾ç‰‡å¾ˆå¤šï¼Œonloadçš„è§¦å‘ä¼šæ¯”è¾ƒä¹…ï¼Œç”¨æˆ·ä½“éªŒä¸ä½³ ï¼Œæ­¤æ—¶DOMContentLoadedæ¯”è¾ƒåˆé€‚ï¼Œæ‰§è¡Œé¡ºåºDOMContentLoaded &gt; onload document.addEventListener('DOMContentLoaded',function(){ }); å½“åˆå§‹çš„ HTML æ–‡æ¡£è¢«å®Œå…¨åŠ è½½å’Œè§£æå®Œæˆä¹‹åï¼ŒDOMContentLoaded äº‹ä»¶è¢«è§¦å‘ï¼Œè€Œæ— éœ€ç­‰å¾…æ ·å¼è¡¨ã€å›¾åƒå’Œå­æ¡†æ¶çš„å®Œå…¨åŠ è½½ã€‚ loadå’Œreadyï¼ˆjQueryï¼‰ ä¸€èˆ¬æƒ…å†µä¸‹ä¸€ä¸ªé¡µé¢å“åº”åŠ è½½çš„åŸºæœ¬é¡ºåºæ˜¯ï¼šåŸŸåè§£æ -&gt; åŠ è½½html -&gt; åŠ è½½jså’Œcss -&gt; åŠ è½½å›¾ç‰‡ç­‰å…¶ä»–ä¿¡æ¯ $(document).ready()ï¼ˆåœ¨åŸç”Ÿçš„jSä¸­ä¸åŒ…æ‹¬ready()ï¼‰ ä»å­—é¢çš„æ„æ€ä¸Šç†è§£ï¼Œå°±æ˜¯æ–‡æ¡£å‡†å¤‡å¥½äº†ã€‚ä¹Ÿå°±æ˜¯æµè§ˆå™¨å·²ç»åŠ è½½å¹¶è§£æå®Œæ•´ä¸ªhtmlæ–‡æ¡£ï¼Œdomæ ‘å·²ç»å»ºç«‹èµ·æ¥äº†,ç„¶åæ‰§è¡Œæ­¤å‡½æ•°ï¼ˆä¸åŒ…å«å›¾ç‰‡ï¼Œcssç­‰ï¼‰ load æ˜¯å½“é¡µé¢æ‰€æœ‰èµ„æºå…¨éƒ¨åŠ è½½å®Œæˆåï¼ˆåŒ…æ‹¬DOMæ–‡æ¡£æ ‘ï¼Œcssæ–‡ä»¶ï¼Œjsæ–‡ä»¶ï¼Œå›¾ç‰‡èµ„æºç­‰ï¼‰ï¼Œæ‰§è¡Œä¸€ä¸ªå‡½æ•°ï¼Œloadæ–¹æ³•å°±æ˜¯onloadäº‹ä»¶ã€‚ æ‰€ä»¥å¯¹åº”çš„ç¼ºç‚¹æ˜¯ï¼šå¦‚æœå›¾ç‰‡èµ„æºè¾ƒå¤šï¼ŒåŠ è½½æ—¶é—´è¾ƒé•¿ï¼Œonloadåç­‰å¾…æ‰§è¡Œçš„å‡½æ•°éœ€è¦ç­‰å¾…è¾ƒé•¿æ—¶é—´ï¼Œæ‰€ä»¥ä¸€äº›æ•ˆæœå¯èƒ½å—åˆ°å½±å“ unloadäº‹ä»¶ä¸loadç›¸å¯¹çš„æ˜¯unloadäº‹ä»¶ï¼Œå®ƒåœ¨æ–‡æ¡£å¸è½½ä¹‹åè§¦å‘ï¼ˆæœ‰ç‚¹åƒç”Ÿå‘½å‘¨æœŸé‡Œçš„beforeDestoryï¼‰ï¼›ä¸€èˆ¬æ˜¯ä»ä¸€ä¸ªé¡µé¢å¯¼èˆªåˆ°å¦å¤–ä¸€ä¸ªé¡µé¢å¸‚è¢«è§¦å‘ï¼Œå¸¸ç”¨äºæ¸…ç†å¼•ç”¨ï¼Œé¿å…å†…å­˜æ³„æ¼ window.addEventListener(\"unload\", () => { console.log(\"unLoad!!!!\") }) 3.è°ƒæ•´çª—å£å¤§å°åªè¦çª—å£å‘ç”Ÿå˜åŒ–ï¼Œå°±ä¼šè§¦å‘è¿™ä¸ªäº‹ä»¶ window.onresize = function() {} window.addEventListener(&#39;resize&#39;, function() {}) å“åº”å¼å¸ƒå±€åŸç† &lt;div>&lt;/div> &lt;script> var div = document.querySelector('div'); window.addEventListener('resize', function() { if (window.innerWidth &lt;= 800) { div.stye.display = 'none'; } else { div.style.display = 'block'; } }) &lt;/script> 4.å®šæ—¶äº‹ä»¶setTimeoutwindow.setTimeout(è°ƒç”¨å‡½æ•°, å»¶æ—¶æ—¶é—´) è¿™ä¸ªwindowåœ¨è°ƒç”¨æ—¶å¯ä»¥çœç•¥ï¼Œå»¶æ—¶æ—¶é—´å•ä½æ˜¯æ¯«ç§’ï¼Œé»˜è®¤çœç•¥ä¸º0 å»¶æ—¶xxæ¯«ç§’åï¼Œæ‰§è¡Œè¯¥å‡½æ•°ï¼Œå†™å‡½æ•°åä¸åŠ æ‹¬å·ã€ä¸å¸¦å‚æ•° var a = setTimeout(function() {}, 1000); var b = setTimeout(callback, 1000); //callbackä¸ºä¸€ä¸ªå‡½æ•° é¡µé¢ä¸­æ—¶å¸¸æœ‰å¾ˆå¤šå®šæ—¶å™¨ï¼Œæˆ‘ä»¬ç»å¸¸ç»™å®šæ—¶å™¨åŠ æ ‡è¯†ç¬¦ï¼ˆåå­—ï¼‰ setTimeout() è¿™ä¸ªè°ƒç”¨å‡½æ•°æˆ‘ä»¬ä¹Ÿç§°ä¹‹ä¸ºå›è°ƒå‡½æ•°ï¼ˆéœ€è¦ç­‰å¾…æ—¶é—´ï¼Œæ—¶é—´åˆ°äº†æ‰å»è°ƒç”¨è¯¥å‡½æ•°ï¼‰ callback ï¼Œä»¥å‰onclickä¹‹ç±»çš„å‡½æ•°ä¹Ÿæ˜¯å›è°ƒå‡½æ•° æ³¨æ„ï¼š HTML5æ ‡å‡†è§„å®šäº†setTimeout()çš„ç¬¬äºŒä¸ªå‚æ•°çš„æœ€å°å€¼ï¼ˆæœ€çŸ­é—´éš”ï¼‰ï¼Œä¸å¾—ä½äº4æ¯«ç§’ï¼Œå¦‚æœä½äºè¿™ä¸ªå€¼ï¼Œå°±ä¼šè‡ªåŠ¨å¢åŠ ã€‚åœ¨æ­¤ä¹‹å‰ï¼Œè€ç‰ˆæœ¬çš„æµè§ˆå™¨éƒ½å°†æœ€çŸ­é—´éš”è®¾ä¸º10æ¯«ç§’ã€‚å¦å¤–ï¼Œå¯¹äºé‚£äº›DOMçš„å˜åŠ¨ï¼ˆå°¤å…¶æ˜¯æ¶‰åŠé¡µé¢é‡æ–°æ¸²æŸ“çš„éƒ¨åˆ†ï¼‰ï¼Œé€šå¸¸ä¸ä¼šç«‹å³æ‰§è¡Œï¼Œè€Œæ˜¯æ¯16æ¯«ç§’æ‰§è¡Œä¸€æ¬¡ã€‚è¿™æ—¶ä½¿ç”¨requestAnimationFrame()çš„æ•ˆæœè¦å¥½äºsetTimeout()ã€‚ åœ¨nodeä¸­ï¼Œå½“ç¬¬äºŒä¸ªå‚æ•°delayå¤§äº2147483647æˆ–å°äº æ—¶1ï¼Œdelay å°†è®¾ç½®ä¸º1ã€‚éæ•´æ•°å»¶è¿Ÿè¢«æˆªæ–­ä¸ºæ•´æ•°ã€‚ åœæ­¢å®šæ—¶å™¨ window.clearTimeout (timeoutID) timeIDä¸ºå®šæ—¶å™¨çš„åå­—ï¼ˆæ‰€ä»¥æˆ‘ä»¬ä¸Šæ–¹è¯´æ˜äº†ç»å¸¸è¦ç»™å®šæ—¶å™¨åŠ åå­—ï¼‰ï¼Œè¿™é‡Œçš„windowä¹Ÿå¯ä»¥çœç•¥ï¼Œè°ƒç”¨è¯¥åœæ­¢å®šæ—¶å™¨æ–¹æ³•åï¼Œå®šæ—¶å™¨çš„è°ƒç”¨å‡½æ•°ä¸æ‰§è¡Œï¼Œæ—¶é—´è¢«åœæ­¢äº† setIntervalwindow.setInterval(å›è°ƒå‡½æ•°, [é—´éš”æ¯«ç§’æ•°]) é‡å¤è°ƒç”¨ä¸€ä¸ªå‡½æ•°ï¼Œæ¯éš”è¿™ä¸ªæ—¶é—´å°±å»è°ƒç”¨ä¸€æ¬¡ï¼Œå†™å‡½æ•°åå‡½æ•°ä¸åŠ æ‹¬å·ã€ä¸å¸¦å‚æ•°ï¼›windowä¹Ÿå¯ä»¥çœç•¥ï¼Œé»˜è®¤çœç•¥çš„è¯ä¸º0ï¼ŒåŒæ ·æˆ‘ä»¬ä¹Ÿç»å¸¸ç»™è¯¥å®šæ—¶å™¨åŠ æ ‡è¯†ç¬¦ï¼ˆåå­—ï¼‰ è¿™é‡Œçš„å…³é”®ç‚¹æ˜¯ç¬¬äºŒä¸ªå‚æ•°ï¼Œé—´éš”æ—¶é—´ï¼ŒæŒ‡çš„æ˜¯å‘é˜Ÿåˆ—æ·»åŠ æ–°ä»»åŠ¡ä¹‹å‰ç­‰å¾…çš„æ—¶é—´ï¼Œ æ¯”å¦‚è°ƒç”¨setTimeoutçš„æ—¶é—´ä¸º01:00:00ï¼Œé—´éš”æ—¶é—´ä¸º300æ¯«ç§’ï¼Œè¿™æ„å‘³ç€ 01:00:03æ—¶ï¼Œæµè§ˆå™¨æ‰ä¼šæŠŠä»»åŠ¡æ·»åŠ åˆ°æ‰§è¡Œé˜Ÿåˆ—é‡Œï¼Œæµè§ˆå™¨ä¸å…³å¿ƒè¿™ä¸ªä»»åŠ¡ä»€ä¹ˆæ—¶å€™æ‰§è¡Œï¼Œæˆ–è€…æ‰§è¡Œè¦èŠ±å¤šé•¿æ—¶é—´ å› æ­¤åˆ°äº† 01:00:06ï¼Œå®ƒä¼šåœ¨æƒ³é˜Ÿåˆ—ä¸­æ·»åŠ ä¸€ä¸ªä»»åŠ¡ JavaScriptä¸­ä½¿ç”¨ setInterval å¼€å¯è½®è¯¢ã€‚å®šæ—¶å™¨ä»£ç å¯èƒ½åœ¨ä»£ç å†æ¬¡è¢«æ·»åŠ åˆ°é˜Ÿåˆ—ä¹‹å‰è¿˜æ²¡æœ‰å®Œæˆæ‰§è¡Œï¼Œç»“æœå¯¼è‡´å®šæ—¶å™¨ä»£ç è¿ç»­è¿è¡Œå¥½å‡ æ¬¡ï¼Œè€Œä¹‹é—´æ²¡æœ‰ä»»ä½•åœé¡¿ã€‚è€Œjavascriptå¼•æ“å¯¹è¿™ä¸ªé—®é¢˜çš„è§£å†³æ˜¯ï¼šå½“ä½¿ç”¨setInterval()æ—¶ï¼Œä»…å½“æ²¡æœ‰è¯¥å®šæ—¶å™¨çš„ä»»ä½•å…¶ä»–ä»£ç å®ä¾‹æ—¶ï¼Œæ‰å°†å®šæ—¶å™¨ä»£ç æ·»åŠ åˆ°é˜Ÿåˆ—ä¸­ã€‚è¿™ç¡®ä¿äº†å®šæ—¶å™¨ä»£ç åŠ å…¥åˆ°é˜Ÿåˆ—ä¸­çš„æœ€å°æ—¶é—´é—´éš”ä¸ºæŒ‡å®šé—´éš”ã€‚ åœæ­¢setIntervalå®šæ—¶å™¨ window.clearInterval(intervalID) åŒåœæ­¢å®šæ—¶å™¨ åˆ©ç”¨å®šæ—¶å™¨è‡ªåŠ¨è°ƒç”¨äº‹ä»¶ ä¾‹å¦‚è°ƒç”¨åœ¨jsä¸­çš„æŸç‚¹å‡»äº‹ä»¶ // è‡ªåŠ¨æ’­æ”¾è½®æ’­å›¾ let timer = setInterval(function () { arrow_r.click(); }, 2000); }) é€šå¸¸æ¥è¯´ä¸å»ºè®®ä½¿ç”¨ setIntervalã€‚ç¬¬ä¸€ï¼Œå®ƒå’Œ setTimeout ä¸€æ ·ï¼Œä¸èƒ½ä¿è¯åœ¨é¢„æœŸçš„æ—¶é—´æ‰§è¡Œä»»åŠ¡ã€‚ç¬¬äºŒï¼Œå®ƒå­˜åœ¨æ‰§è¡Œç´¯ç§¯çš„é—®é¢˜ï¼Œè¯·çœ‹ä»¥ä¸‹ä¼ªä»£ç  function demo() { setInterval(function(){ console.log(2) },1000) sleep(2000) } demo() ä»¥ä¸Šä»£ç åœ¨æµè§ˆå™¨ç¯å¢ƒä¸­ï¼Œå¦‚æœå®šæ—¶å™¨æ‰§è¡Œè¿‡ç¨‹ä¸­å‡ºç°äº†è€—æ—¶æ“ä½œï¼Œå¤šä¸ªå›è°ƒå‡½æ•°ä¼šåœ¨è€—æ—¶æ“ä½œç»“æŸä»¥ååŒæ—¶æ‰§è¡Œï¼Œè¿™æ ·å¯èƒ½å°±ä¼šå¸¦æ¥æ€§èƒ½ä¸Šçš„é—®é¢˜ã€‚ å®šæ—¶å™¨çš„é—®é¢˜å…³äºå®šæ—¶å™¨å»¶æ—¶æ¯”è®¾å®šæ›´ä¹…çš„åŸå› ï¼š æœ€å°å»¶æ—¶ &gt;=4msï¼ˆä¹Ÿå°±æ˜¯è¯´æœ‰4msçš„å»¶æ—¶ï¼‰ åœ¨æµè§ˆå™¨ä¸­ï¼ŒsetTimeout()/setInterval() çš„æ¯è°ƒç”¨ä¸€æ¬¡å®šæ—¶å™¨çš„æœ€å°é—´éš”æ˜¯4msï¼ˆä¸è¿‡ï¼ŒChrome å·²å°†å…¶æ›´æ”¹ä¸º 2 æ¯«ç§’ï¼Œå¹¶ä¸”æ˜¾ç„¶å­˜åœ¨ä¸€äº›é—®é¢˜ã€‚ï¼‰ï¼Œè¿™é€šå¸¸æ˜¯ç”±äºå‡½æ•°åµŒå¥—å¯¼è‡´ï¼ˆåµŒå¥—å±‚çº§è¾¾åˆ°ä¸€å®šæ·±åº¦ï¼‰ï¼Œæˆ–è€…æ˜¯ç”±äºå·²ç»æ‰§è¡Œçš„setIntervalçš„å›è°ƒå‡½æ•°é˜»å¡å¯¼è‡´çš„ã€‚ä¾‹å¦‚ï¼š function cb() { f(); setTimeout(cb, 0); } setTimeout(cb, 0); setInterval(f, 0); å¦‚æœæƒ³åœ¨æµè§ˆå™¨ä¸­å®ç°0mså»¶æ—¶çš„å®šæ—¶å™¨ï¼Œä½ å¯ä»¥å‚è€ƒï¼ˆä½¿ç”¨postMessageè‡ªå·±å†™ä¸€ä¸ªå®šæ—¶å™¨å‡½æ•°åŠ è½½windowå¯¹è±¡ä¸Šï¼‰ https://dbaron.org/log/20100309-faster-timeouts å› æ­¤ï¼Œåœ¨é—´éš”æ—¶é—´æç«¯çš„æƒ…å†µä¸‹ï¼Œä¸å»ºè®®ä½¿ç”¨å®šæ—¶å™¨ requestAnimationFrameï¼ˆIE9-æµè§ˆå™¨ä¸æ”¯æŒè¯¥æ–¹æ³•ï¼‰å®˜æ–¹è§£é‡Šï¼šè‹¥ä½ æƒ³åœ¨æµè§ˆå™¨ä¸‹æ¬¡é‡ç»˜ä¹‹å‰ç»§ç»­æ›´æ–°ä¸‹ä¸€å¸§åŠ¨ç”»ï¼Œé‚£ä¹ˆå›è°ƒå‡½æ•°è‡ªèº«å¿…é¡»å†æ¬¡è°ƒç”¨window.requestAnimationFrame() å‚æ•°ï¼šcallback ä¸‹ä¸€æ¬¡é‡ç»˜ä¹‹å‰æ›´æ–°åŠ¨ç”»å¸§æ‰€è°ƒç”¨çš„å‡½æ•°(å³ä¸Šé¢æ‰€è¯´çš„å›è°ƒå‡½æ•°)ã€‚ æ³¨æ„ï¼šè¿™ä¸ªcallbackä¼šè‡ªå¸¦ä¸€ä¸ªå‚æ•°ï¼šè¯¥å›è°ƒå‡½æ•°ä¼šè¢«ä¼ å…¥DOMHighResTimeStampå‚æ•°ï¼Œè¯¥å‚æ•°ä¸performance.now()çš„è¿”å›å€¼ç›¸åŒï¼Œå®ƒè¡¨ç¤ºrequestAnimationFrame() å¼€å§‹å»æ‰§è¡Œå›è°ƒå‡½æ•°çš„æ—¶åˆ»ã€‚ æœ‰ç‚¹åƒåœç•™æ—¶é—´ä¸º 1 / 60 ç§’çš„setTimeoutï¼Œé»˜è®¤æ¯ç§’60å¸§ï¼Œä¹Ÿå°±æ˜¯ 1000 / 60ï¼Œé‡‡ç”¨ç³»ç»Ÿæ—¶é—´é—´éš”ï¼Œä¿æŒæœ€ä½³ç»˜åˆ¶æ•ˆç‡ï¼ŒåŠ¨ç”»ä¸ä¼šæ‰å¸§ï¼Œè‡ªç„¶æµç•… å¯¹æ¯”èµ· setIntervalå’Œ setTimeoutçš„ä¼˜åŠ¿ requestAnimationFrame ä¼šæŠŠæ¯ä¸€å¸§ä¸­çš„æ‰€æœ‰DOMæ“ä½œé›†ä¸­èµ·æ¥ï¼Œåœ¨ä¸€æ¬¡é‡ç»˜æˆ–å›æµä¸­å°±å®Œæˆï¼Œå¹¶ä¸”é‡ç»˜æˆ–å›æµçš„æ—¶é—´é—´éš”ç´§ç´§è·Ÿéšæµè§ˆå™¨çš„åˆ·æ–°é¢‘ç‡ï¼Œä¸€èˆ¬æ¥è¯´ï¼Œè¿™ä¸ªé¢‘ç‡ä¸ºæ¯ç§’60å¸§ã€‚ åœ¨éšè—æˆ–ä¸å¯è§çš„å…ƒç´ ä¸­ï¼ŒrequestAnimationFrameå°†ä¸ä¼šè¿›è¡Œé‡ç»˜æˆ–å›æµï¼Œè¿™å½“ç„¶å°±æ„å‘³ç€æ›´å°‘çš„çš„cpuï¼Œgpuå’Œå†…å­˜ä½¿ç”¨é‡ã€‚ (function animloop() { render(); window.requestAnimationFrame(animloop); })(); å½“ç„¶ï¼ŒrequestAnimationFrameä¹Ÿæœ‰è‡ªå·±çš„æ¶ˆé™¤å®šæ—¶å™¨ï¼Œéœ€è¦ä¼ å…¥requestAnimationFrameçš„idï¼Œè€Œidæ¥è‡ªäºrequestAnimationFrameçš„è¿”å›ã€‚ let rafId = null; (function animloop(time) { console.log(time,Date.now()) render(); rafId = requestAnimationFrame(animloop); //å¦‚æœleftç­‰äº50 åœæ­¢åŠ¨ç”» if(left == 50){ cancelAnimationFrame(rafId) } })(); å¯¹äºrequestAnimationFrame ä»»åŠ¡ç±»å‹çš„åˆ’åˆ†ï¼š W3C å·¥ä½œç»„åœ¨ 2015 å¹´ 9 æœˆ 22 æ—¥çš„ä¸€ç¯‡å·¥ä½œç¬”è®°ã€ŠTiming control for script-based animationsã€‹ ä¸­æåˆ°äº† animation task source è¿™ä¸€æ¦‚å¿µï¼Œåœ¨è¯¥æ–‡ä¸­ï¼Œç¡®å®å°† animation frame request callback list ä¸­çš„ callback ä½œä¸º task å¤„ç†ã€‚å¦å¤–ï¼Œåœ¨ zone.js ä¸­ä¹Ÿå°† requestAnimationFrame åˆ’è¿› macrotask åˆ†ç±»ä¸­ã€‚ä½† whatwg è§„èŒƒä¸­å¯¹ requestAnimationFrame callback æœªæ˜ç¡®å‡ºç°ä»»ä½• task ç›¸å…³å­—çœ¼ï¼Œç”±äº whatwg å’Œ w3c çš„åˆ†æ­§ï¼Œæˆ‘å¯¹ requestAnimationFrame æ˜¯å¦è¯¥åˆ’åˆ†ä¸º task å­˜ä¿ç•™æ„è§ã€‚ setTimeout(() => { console.log('A') }, 0) requestAnimationFrame(() => { console.log('B') Promise.resolve().then(() => { console.log('C') }) }) /*å¤šåˆ·æ–°å‡ æ¬¡ ç»“æœ1ï¼š B C A ç»“æœ2ï¼š A B C */ æ‰§è¡Œ requestAnimationFrame callback æ˜¯ UI Render çš„å…¶ä¸­ä¸€æ­¥ã€‚ å¦‚æœæµè§ˆå™¨è¯•å›¾å®ç° 60Hz çš„åˆ·æ–°ç‡ï¼Œé‚£ä¹ˆ UI Render åªéœ€è¦æ¯ç§’æ‰§è¡Œ 60 æ¬¡ï¼ˆæ¯ 16.7 msï¼‰ã€‚å¦‚æœæµè§ˆå™¨å‘ç°ã€é¡¶å±‚æµè§ˆå™¨ä¸Šä¸‹æ–‡ã€æ— æ³•ç»´æŒä½è¿™ä¸ªé¢‘ç‡ï¼Œå¯èƒ½ä¼šä¸‹è°ƒåˆ°å¯ç»´æŒçš„ 30Hzï¼Œè€Œä¸æ˜¯æ‰å¸§ã€‚ï¼ˆæœ¬è§„èŒƒå¹¶ä¸å¯¹ä½•æ—¶è¿›è¡Œ render åšä»»ä½•è§„å®šã€‚ï¼‰ç±»ä¼¼çš„ï¼Œå¦‚æœä¸€ä¸ªé¡¶å±‚æµè§ˆå™¨ä¸Šä¸‹æ–‡åœ¨åå°è¿è¡Œï¼Œç”¨æˆ·ä»£ç†å¯èƒ½å†³å®šå°†è¯¥é¡µé¢çš„åˆ·æ–°ç‡é™åˆ° 4Hzï¼Œç”šè‡³æ›´ä½ã€‚ ç”±äºè§„èŒƒæ²¡æœ‰åšçº¦å®šï¼Œæ‰€ä»¥æµè§ˆå™¨åœ¨ render ç­–ç•¥ä¸Šæœ‰å……åˆ†çš„è‡ªä¸»æ€§ã€‚æ—¢æœ‰å¯èƒ½å‡ºç°æ¯ä¸€è½® eventloop åéƒ½ render çš„ç°è±¡ï¼Œä¹Ÿæœ‰å¯èƒ½å‡ºç°å‡ åè½® eventloop éƒ½ä¸ render çš„æƒ…å†µã€‚ performance.now()performance.now() æ–¹æ³•è¿”å›ä¸€ä¸ªç²¾ç¡®åˆ°æ¯«ç§’çš„ DOMHighResTimeStampã€‚ è­¦å‘Šï¼š è¿™ä¸ªæ—¶é—´æˆ³å®é™…ä¸Šå¹¶ä¸æ˜¯é«˜ç²¾åº¦çš„ã€‚ä¸ºäº†é™ä½åƒSpectreè¿™æ ·çš„å®‰å…¨å¨èƒï¼Œå„ç±»æµè§ˆå™¨å¯¹è¯¥ç±»å‹çš„å€¼åšäº†ä¸åŒç¨‹åº¦ä¸Šçš„å››èˆäº”å…¥å¤„ç†ã€‚ï¼ˆFirefox ä» Firefox 59 å¼€å§‹å››èˆäº”å…¥åˆ° 2 æ¯«ç§’ç²¾åº¦ï¼‰ä¸€äº›æµè§ˆå™¨è¿˜å¯èƒ½å¯¹è¿™ä¸ªå€¼ä½œç¨å¾®çš„éšæœºåŒ–å¤„ç†ã€‚è¿™ä¸ªå€¼çš„ç²¾åº¦åœ¨æœªæ¥çš„ç‰ˆæœ¬ä¸­å¯èƒ½ä¼šå†æ¬¡æ”¹å–„ï¼›æµè§ˆå™¨å¼€å‘è€…è¿˜åœ¨è°ƒæŸ¥è¿™äº›æ—¶é—´æµ‹å®šæ”»å‡»å’Œå¦‚ä½•æ›´å¥½çš„ç¼“è§£è¿™äº›æ”»å‡»ã€‚ å®ƒå’ŒDate.now()ä¸åŒçš„ç‚¹ï¼š å’Œ JavaScript ä¸­å…¶ä»–å¯ç”¨çš„æ—¶é—´ç±»å‡½æ•°ï¼ˆæ¯”å¦‚Date.nowï¼‰ä¸åŒçš„æ˜¯ï¼Œwindow.performance.now()è¿”å›çš„æ—¶é—´æˆ³æ²¡æœ‰è¢«é™åˆ¶åœ¨ä¸€æ¯«ç§’çš„ç²¾ç¡®åº¦å†…ï¼Œç›¸åï¼Œå®ƒä»¬ä»¥æµ®ç‚¹æ•°çš„å½¢å¼è¡¨ç¤ºæ—¶é—´ï¼Œç²¾åº¦æœ€é«˜å¯è¾¾å¾®ç§’çº§ã€‚ å¦å¤–ä¸€ä¸ªä¸åŒç‚¹æ˜¯ï¼Œwindow.performance.now()æ˜¯ä»¥ä¸€ä¸ªæ’å®šçš„é€Ÿç‡æ…¢æ…¢å¢åŠ çš„ï¼Œå®ƒä¸ä¼šå—åˆ°ç³»ç»Ÿæ—¶é—´çš„å½±å“ï¼ˆç³»ç»Ÿæ—¶é’Ÿå¯èƒ½ä¼šè¢«æ‰‹åŠ¨è°ƒæ•´æˆ–è¢« NTP ç­‰è½¯ä»¶ç¯¡æ”¹ï¼‰ã€‚å¦å¤–ï¼Œperformance.timing.navigationStart + performance.now() çº¦ç­‰äº Date.now()ã€‚ 5.JSæ‰§è¡Œé˜Ÿåˆ—JSåŸå…ˆæ˜¯å•çº¿ç¨‹ï¼Œä¹Ÿå°±æ˜¯è¯´åŒä¸€æ—¶é—´åªèƒ½åšä¸€ä»¶äº‹ï¼Œä½†æ˜¯å•çº¿ç¨‹å°±æ„å‘³ç€ï¼Œæ‰€æœ‰ä»»åŠ¡éœ€è¦æ’é˜Ÿï¼Œé’±ä¸€ä¸ªä»»åŠ¡ç»“æŸåï¼Œæ‰èƒ½æ‰§è¡Œä¸‹ä¸€ä¸ªä»»åŠ¡ï¼Œå¦‚æœJSæ‰§è¡Œæ—¶é—´è¿‡é•¿ï¼Œå°±ä¼šé€ æˆé¡µé¢çš„æ¸²æŸ“ä¸è¿è´¯ï¼Œå¯¼è‡´é¡µé¢æ¸²æŸ“åŠ è½½é˜»å¡ å¤šçº¿ç¨‹ååˆ†å¼ºå¤§ï¼Œä½†æ˜¯å¤šçº¿ç¨‹åŒæ­¥æ¯”è¾ƒå¤æ‚ï¼Œå¹¶ä¸”å±é™©ï¼Œç¨æœ‰ä¸æ…å°±ä¼šå´©æºƒæ­»é” &amp; é€ æˆå¤§é‡å¹¶å‘é—®é¢˜ è€Œä¼ ç»Ÿä¸Šï¼ŒJSæ—¨åœ¨ç”¨äºç®€çŸ­ï¼Œå¿«é€Ÿè¿è¡Œçš„ä»£ç ç‰‡æ®µï¼Œä½œä¸ºæµè§ˆå™¨è„šæœ¬è¯­è¨€ï¼Œä¸»è¦ç”¨é€”æ˜¯ä¸ç”¨æˆ·äº’åŠ¨ï¼Œä»¥åŠæ“ä½œDOMï¼Œæ‰€ä»¥JSæ¯”è¾ƒé€‚åˆå•çº¿ç¨‹ ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒH5æå‡ºWeb Workeræ ‡å‡†ï¼Œå…è®¸JSåˆ›å»ºå¤šä¸ªçº¿ç¨‹ï¼ˆå®é™…ä¸Šæ˜¯â€œå‡â€å¹¶å‘ï¼‰ï¼Œäºæ˜¯JSå‡ºç°äº†åŒæ­¥ï¼ˆå•çº¿ç¨‹ï¼‰å’Œå¼‚æ­¥ï¼ˆç°åœ¨çš„JSå¯ä»¥åŒæ—¶å¤šä¸ªä»»åŠ¡ï¼‰ ä»–ä»¬æœ¬è´¨çš„åŒºåˆ«æ˜¯ï¼Œè¿™æ¡æµæ°´çº¿ä¸Šå„ä¸ªæµç¨‹æ‰§è¡Œçš„é¡ºåºä¸åŒ ï¼ˆ1ï¼‰åŒæ­¥å’Œå¼‚æ­¥åŒæ­¥ä»»åŠ¡éƒ½æ”¾åœ¨ä¸€ä¸ªä¸»çº¿ç¨‹ä¸Šæ‰§è¡Œï¼Œå½¢æˆä¸€ä¸ªæ‰§è¡Œæ ˆï¼ŒæŒ‰é¡ºåºæ‰§è¡Œ å¼‚æ­¥ä»»åŠ¡ï¼šJSçš„å¼‚æ­¥æ˜¯é€šè¿‡å›è°ƒå‡½æ•°å®ç°çš„ï¼Œä¸€èˆ¬è€Œè¨€ï¼Œå¼‚æ­¥ä»»åŠ¡æœ‰ä»¥ä¸‹ä¸‰ç§ç±»å‹ 1.æ™®é€šäº‹ä»¶ï¼Œå¦‚clickã€resizeç­‰ 2.èµ„æºåŠ è½½ï¼Œå¦‚loadã€errorç­‰ 3.å®šæ—¶å™¨ï¼Œå¦‚setTimeoutã€setIntervalç­‰ ï¼ˆ2ï¼‰å®ä»»åŠ¡å’Œå¾®ä»»åŠ¡è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯new Promiseæ˜¯ä¼šè¿›å…¥åˆ°ä¸»çº¿ç¨‹ä¸­ç«‹åˆ»æ‰§è¡Œï¼ˆpromiseæœ¬èº«ä¸æ˜¯å¼‚æ­¥ï¼Œåªæ˜¯é‡Œé¢çš„ä»»åŠ¡æ˜¯å¼‚æ­¥çš„ç½¢äº†ï¼‰ï¼Œè€Œpromise.thenåˆ™å±äºå¾®ä»»åŠ¡ å®ä»»åŠ¡(macro-task)ï¼šæ˜¯ç”±å®¿ä¸»ï¼ˆNodeã€æµè§ˆå™¨ï¼‰å‘èµ·çš„ï¼Œæ¯”å¦‚æ•´ä½“ä»£ç scriptã€setTimeOutã€setIntervalã€postMessage å¾®ä»»åŠ¡(mincro-task)ï¼šç”±JavaScriptè‡ªèº«å‘èµ·ï¼Œæ¯”å¦‚promise.thenã€process.nextTick(node) å¾®ä»»åŠ¡å…ˆæ‰§è¡Œï¼Œå®ä»»åŠ¡åæ‰§è¡Œ åŒæ­¥ä»£ç æ‰§è¡Œå®Œæˆåï¼Œä¼šå…ˆæ‰§è¡Œå¾®ä»»åŠ¡é˜Ÿåˆ—ã€‚æ³¨æ„ï¼šæ­¤æ—¶ä¼šæŠŠæ‰€æœ‰å¾®ä»»åŠ¡é˜Ÿåˆ—å…¨éƒ¨æ‰§è¡Œå®Œã€‚å†å»å®é˜Ÿåˆ—macrotaskå–å‡ºä¸€ä¸ªæ‰§è¡Œï¼Œå¦‚æœå®ä»»åŠ¡æ‰§è¡Œè¿‡ç¨‹ä¸­äº§ç”Ÿæ–°çš„å¾®ä»»åŠ¡ï¼Œä¼šè·³è¿‡å¾®ä»»åŠ¡ç»§ç»­æ‰§è¡Œå¹¶ç«‹å³æŠŠå¾®ä»»åŠ¡æ”¾åˆ°å¼‚æ­¥ä»»åŠ¡é˜Ÿåˆ—å¤§æ± å­ä¸­ã€‚å½“å‰å®ä»»åŠ¡æ‰§è¡Œå®Œåï¼Œåˆå»æ£€æŸ¥å¾…æ‰§è¡Œçš„ä»»åŠ¡é˜Ÿåˆ—å¤§æ± å­ï¼Œå¦‚æœæœ‰å¾®ä»»åŠ¡ï¼Œå°±ä¼˜å…ˆæ‰§è¡Œå¾®ä»»åŠ¡ï¼Œå¦‚æœæ²¡æœ‰å°±ç»§ç»­æ‰§è¡Œå®ä»»åŠ¡é˜Ÿåˆ— ï¼ˆ3ï¼‰æ‰§è¡Œæœºåˆ¶1.å…ˆæ‰§è¡Œæ‰§è¡Œæ ˆä¸­çš„åŒæ­¥ä»»åŠ¡ å…¶å®æˆ‘ä»¬å¹³æ—¶ä¹Ÿå¯ä»¥åœ¨æŠ¥é”™ä¿¡æ¯çœ‹åˆ°æ‰§è¡Œæ ˆ function foo() { throw new Error('error') } function bar() { foo() } bar() 2.å¼‚æ­¥ä»»åŠ¡ï¼ˆå›è°ƒå‡½æ•°ï¼‰æ”¾å…¥ä»»åŠ¡é˜Ÿåˆ—ä¸­ï¼ˆåªè¦å¼‚æ­¥ä»»åŠ¡æœ‰äº†è¿è¡Œç»“æœï¼Œå°±åœ¨â€ä»»åŠ¡é˜Ÿåˆ—â€ä¹‹ä¸­æ”¾ç½®ä¸€ä¸ªäº‹ä»¶ã€‚ï¼‰ 3.â€ä»»åŠ¡é˜Ÿåˆ—â€ä¸­çš„äº‹ä»¶ï¼Œé™¤äº†IOè®¾å¤‡çš„äº‹ä»¶ä»¥å¤–ï¼Œè¿˜åŒ…æ‹¬ä¸€äº›ç”¨æˆ·äº§ç”Ÿçš„äº‹ä»¶ï¼ˆæ¯”å¦‚é¼ æ ‡ç‚¹å‡»ã€é¡µé¢æ»šåŠ¨ç­‰ç­‰ï¼‰ã€‚åªè¦æŒ‡å®šè¿‡å›è°ƒå‡½æ•°ï¼Œè¿™äº›äº‹ä»¶å‘ç”Ÿæ—¶å°±ä¼šè¿›å…¥â€ä»»åŠ¡é˜Ÿåˆ—â€ï¼Œç­‰å¾…ä¸»çº¿ç¨‹è¯»å–ã€‚ 4.ä¸€æ—¦æ‰§è¡Œæ ˆæ‰€æœ‰åŒæ­¥ä»»åŠ¡æ‰§è¡Œå®Œæ¯•ï¼Œç³»ç»Ÿå°±ä¼šæŒ‰æ¬¡åºè¯»å–ä»»åŠ¡é˜Ÿåˆ—çš„å¼‚æ­¥ä»»åŠ¡ï¼Œäºæ˜¯è¢«è¯»å–çš„å¼‚æ­¥ä»»åŠ¡ç»“æŸç­‰å¾…çŠ¶æ€ï¼Œè¿›å…¥æ‰§è¡Œæ ˆï¼Œå¼€å§‹æ‰§è¡Œ æ³¨æ„ï¼šï¼ï¼ æ‰€è°“â€å›è°ƒå‡½æ•°â€ï¼ˆcallbackï¼‰ï¼Œå°±æ˜¯é‚£äº›ä¼šè¢«ä¸»çº¿ç¨‹æŒ‚èµ·æ¥çš„ä»£ç ã€‚å¼‚æ­¥ä»»åŠ¡å¿…é¡»æŒ‡å®šå›è°ƒå‡½æ•°ï¼Œå½“ä¸»çº¿ç¨‹å¼€å§‹æ‰§è¡Œå¼‚æ­¥ä»»åŠ¡ï¼Œå°±æ˜¯æ‰§è¡Œå¯¹åº”çš„å›è°ƒå‡½æ•°ã€‚ï¼ˆæ¯”å¦‚setTimeout(fn, time)ï¼Œç¬¬ä¸€ä¸ªå‚æ•°ä¸ºå›è°ƒå‡½æ•°ï¼‰ æœ‰å¼‚æ­¥ä»»åŠ¡äº¤ç»™å¼‚æ­¥è¿›ç¨‹å¤„ç†ï¼ˆæ–°å¼€ä¸€ä¸ªçº¿ç¨‹ç”¨æ¥æ‰§è¡Œé‚£äº›å¼‚æ­¥ä»»åŠ¡ï¼Œæˆ‘ä»¬æš‚ä¸”ç§°ä¸ºå·¥ä½œçº¿ç¨‹ï¼‰ï¼Œå¼‚æ­¥ä»»åŠ¡æ‰§è¡Œå®Œæ¯•åæ¨å…¥ä»»åŠ¡é˜Ÿåˆ— å½“ä¸»çº¿ç¨‹æ‰§è¡Œå®Œæ¯•å°±æ¥æŸ¥è¯¢ä»»åŠ¡é˜Ÿåˆ—ï¼Œå–æ’åœ¨ç¬¬ä¸€ä½çš„äº‹ä»¶æ¨å…¥ä¸»çº¿ç¨‹å¤„ç†ï¼Œæ‰§è¡Œå®Œå†æ¥å–ï¼Œä¸æ–­å¾ªç¯ï¼Œè¿™ä¸ªè¿‡ç¨‹å«ä½œäº‹ä»¶å¾ªç¯ ï¼ˆå®é™…ä¸Šç»†åˆ†å¼‚æ­¥äº‹ä»¶çš„ä¼˜å…ˆçº§æœ‰å®ä»»åŠ¡å’Œå¾®ä»»åŠ¡ï¼Œä¼˜å…ˆçº§ï¼šå¾®ä»»åŠ¡&gt;å®ä»»åŠ¡ï¼‰ å¼‚æ­¥ä»»åŠ¡æ‰§è¡Œé¡ºåºä¸ä¸€å®šæŒ‰ç…§åŸæ¥é¡ºåºï¼Œè¦å–å†³äºæ–‡ä»¶å¤§å°ã€æ“ä½œç³»ç»Ÿè°ƒåº¦æœºåˆ¶ç­‰å¤šæ–¹é¢åŸå›  ï¼ˆ4ï¼‰nodeçš„æ‰§è¡Œæœºåˆ¶nodeçš„äº‹ä»¶å¾ªç¯åŒ…æ‹¬å…­å¤§é˜¶æ®µï¼Œæ¯ä¸ªé˜¶æ®µéƒ½æœ‰ä¸€ä¸ªè‡ªå·±çš„å…ˆè¿›å…ˆå‡ºçš„é˜Ÿåˆ—ï¼Œåªæœ‰å½“è¿™ä¸ªé˜Ÿåˆ—çš„äº‹ä»¶æ‰§è¡Œå®Œæˆ–è€…è¾¾åˆ°è¯¥é˜¶æ®µçš„ä¸Šé™æ—¶ï¼Œæ‰ä¼šè¿›å…¥ä¸‹ä¸€ä¸ªé˜¶æ®µã€‚ timersé˜¶æ®µï¼ˆsetTimeoutã€setIntervalçš„äº‹ä»¶å›è°ƒï¼‰ pending callbacks é˜¶æ®µï¼šå¤„ç†ä¸Šä¸€è½®å¾ªç¯ä¸­å°‘æ•°æœªæ‰§è¡Œçš„I/Oå›è°ƒ idleï¼Œprepareé˜¶æ®µï¼šä»…nodeå†…éƒ¨ä½¿ç”¨ pollé˜¶æ®µï¼šä¼šåšä¸¤ä»¶äº‹ï¼Œé€‚å½“æ¡ä»¶ä¸‹nodeé˜»å¡åœ¨è¿™é‡Œ ä¸¤ä»¶äº‹æƒ…ï¼š å›åˆ° timer é˜¶æ®µæ‰§è¡Œå›è°ƒ æ‰§è¡Œ I/O å›è°ƒ checké˜¶æ®µï¼šæ‰§è¡ŒsetImmediateå›è°ƒ close callbacks é˜¶æ®µï¼šæ‰§è¡Œsocketçš„closeå›è°ƒ è¿™å¯¼è‡´äº†nodeå’Œæµè§ˆå™¨ç«¯æ‰§è¡Œå®ä»»åŠ¡å’Œå¾®ä»»åŠ¡çš„é¡ºåºä¸ä¸€æ ·ï¼ï¼ ä¸è¿‡ï¼ï¼åœ¨nodeæ–°çš„ç‰ˆæœ¬é€æ­¥å®Œå–„äº†ï¼Œä¹Ÿå°±æ˜¯nodeæ–°ç‰ˆæœ¬æ ‡å‡†å’Œæµè§ˆå™¨è¶‹äºç›¸åŒ ï¼ˆV12.7ä»¥ä¸Šï¼‰ process.nextTick è¿™ä¸ªå‡½æ•°å…¶å®æ˜¯ç‹¬ç«‹äºnodeçš„ Event Loop ä¹‹å¤–çš„ï¼Œå®ƒæœ‰ä¸€ä¸ªè‡ªå·±çš„é˜Ÿåˆ—ï¼Œå½“æ¯ä¸ªé˜¶æ®µå®Œæˆåï¼Œå¦‚æœå­˜åœ¨ nextTick é˜Ÿåˆ—ï¼Œå°±ä¼šæ¸…ç©ºé˜Ÿåˆ—ä¸­çš„æ‰€æœ‰å›è°ƒå‡½æ•°ï¼Œå¹¶ä¸”ä¼˜å…ˆäºå…¶ä»– microtask æ‰§è¡Œã€‚ ä¸€ä¸ªå°æ¡ˆä¾‹ï¼šï¼ˆhttps://segmentfault.com/a/1190000023315304ï¼‰ setTimeout(() => { setTimeout(() => { console.log('setTimeout'); }, 0); setImmediate(() => { console.log('setImmediate'); }); }, 0); å¤–å±‚æ˜¯ä¸€ä¸ªsetTimeoutï¼Œæ‰€ä»¥æ‰§è¡Œä»–çš„å›è°ƒçš„æ—¶å€™å·²ç»åœ¨timersé˜¶æ®µäº† å¤„ç†é‡Œé¢çš„setTimeoutï¼Œå› ä¸ºæœ¬æ¬¡å¾ªç¯çš„timersæ­£åœ¨æ‰§è¡Œï¼Œæ‰€ä»¥ä»–çš„å›è°ƒå…¶å®åŠ åˆ°äº†ä¸‹ä¸ªtimersé˜¶æ®µ å¤„ç†é‡Œé¢çš„setImmediateï¼Œå°†å®ƒçš„å›è°ƒåŠ å…¥checké˜¶æ®µçš„é˜Ÿåˆ— å¤–å±‚timersé˜¶æ®µæ‰§è¡Œå®Œï¼Œä¹‹åäº‹ä»¶å¾ªç¯ç»§ç»­å¾€åé¢çš„é˜¶æ®µèµ°ï¼Œè¿›å…¥pending callbacksï¼Œidle, prepareï¼Œpollï¼Œè¿™å‡ ä¸ªé˜Ÿåˆ—éƒ½æ˜¯ç©ºçš„ï¼Œæ‰€ä»¥ç»§ç»­å¾€ä¸‹ åˆ°äº†checké˜¶æ®µï¼Œå‘ç°äº†setImmediateçš„å›è°ƒï¼Œæ‹¿å‡ºæ¥æ‰§è¡Œ ç„¶åæ˜¯close callbacksï¼Œé˜Ÿåˆ—æ˜¯ç©ºçš„ï¼Œè·³è¿‡ åˆæ˜¯timersé˜¶æ®µï¼Œæ‰§è¡Œæˆ‘ä»¬çš„console ä½†å¦‚æœæŠŠ setTimeoutã€ setImmediateæ”¾åœ¨å¤–é¢ä¼šæ€ä¹ˆæ ·ï¼Ÿ console.log('outer'); setTimeout(() => { console.log('setTimeout'); }, 0); setImmediate(() => { console.log('setImmediate'); }); ç»“æœæ˜¯ï¼å¤šè¿è¡Œå‡ æ¬¡ï¼Œç»“æœä¸ä¸€æ · è€Œå…¶ä¸­çš„æ‰§è¡Œæ˜¯è¿™æ ·å­çš„ï¼š å¤–å±‚åŒæ­¥ä»£ç ä¸€æ¬¡æ€§å…¨éƒ¨æ‰§è¡Œå®Œï¼Œé‡åˆ°å¼‚æ­¥APIå°±å¡åˆ°å¯¹åº”çš„é˜¶æ®µ é‡åˆ°setTimeoutï¼Œè™½ç„¶è®¾ç½®çš„æ˜¯0æ¯«ç§’è§¦å‘ï¼Œä½†æ˜¯è¢«node.jså¼ºåˆ¶æ”¹ä¸º1æ¯«ç§’ï¼Œå¡å…¥timersé˜¶æ®µ é‡åˆ°setImmediateå¡å…¥checké˜¶æ®µ åŒæ­¥ä»£ç æ‰§è¡Œå®Œæ¯•ï¼Œè¿›å…¥Event Loop å…ˆè¿›å…¥timesé˜¶æ®µï¼Œæ£€æŸ¥å½“å‰æ—¶é—´è¿‡å»äº†1æ¯«ç§’æ²¡æœ‰ï¼Œå¦‚æœè¿‡äº†1æ¯«ç§’ï¼Œæ»¡è¶³setTimeoutæ¡ä»¶ï¼Œæ‰§è¡Œå›è°ƒï¼Œå¦‚æœæ²¡è¿‡1æ¯«ç§’ï¼Œè·³è¿‡ è·³è¿‡ç©ºçš„é˜¶æ®µï¼Œè¿›å…¥checké˜¶æ®µï¼Œæ‰§è¡ŒsetImmediateå›è°ƒ æœ€åæ€»ç»“çš„åŸå› æ˜¯ï¼š é€šè¿‡ä¸Šè¿°æµç¨‹çš„æ¢³ç†ï¼Œæˆ‘ä»¬å‘ç°å…³é”®å°±åœ¨è¿™ä¸ª1æ¯«ç§’ï¼Œå¦‚æœåŒæ­¥ä»£ç æ‰§è¡Œæ—¶é—´è¾ƒé•¿ï¼Œè¿›å…¥Event Loopçš„æ—¶å€™1æ¯«ç§’å·²ç»è¿‡äº†ï¼ŒsetTimeoutæ‰§è¡Œï¼Œå¦‚æœ1æ¯«ç§’è¿˜æ²¡åˆ°ï¼Œå°±å…ˆæ‰§è¡Œäº†setImmediateã€‚ æ¯æ¬¡æˆ‘ä»¬è¿è¡Œè„šæœ¬æ—¶ï¼Œæœºå™¨çŠ¶æ€å¯èƒ½ä¸ä¸€æ ·ï¼Œå¯¼è‡´è¿è¡Œæ—¶æœ‰1æ¯«ç§’çš„å·®è·ï¼Œä¸€ä¼šå„¿setTimeoutå…ˆæ‰§è¡Œï¼Œä¸€ä¼šå„¿setImmediateå…ˆæ‰§è¡Œ 6.locationå¯¹è±¡locationæ˜¯windowå¯¹è±¡æä¾›ç»™æˆ‘ä»¬çš„ä¸€ä¸ªå±æ€§ï¼Œç”¨äºè·å–æˆ–è®¾ç½®çª—ä½“çš„URLï¼Œå¹¶ä¸”å¯ä»¥ç”¨äºè§£æURLï¼Œè¿”å›çš„æ˜¯ä¸€ä¸ªå¯¹è±¡ URLï¼šç»Ÿä¸€èµ„æºå®šä½ç¬¦æ˜¯äº’è”ç½‘ä¸Šæ ‡å‡†èµ„æºçš„åœ°å€ï¼Œäº’è”ç½‘ä¸Šæ¯ä¸ªæ–‡ä»¶éƒ½æœ‰å”¯ä¸€çš„URLï¼Œå®ƒåŒ…å«çš„ä¿¡æ¯æ”¯æŒæ–‡ä»¶çš„ä½ç½®ä»¥åŠæµè§ˆå™¨è¯¥å¦‚ä½•ä½¿ç”¨å®ƒï¼ˆURLä¹Ÿå°±æ˜¯æˆ‘ä»¬çš„ç½‘å€ï¼‰ ç»„æˆï¼š protocol://host[:port]/path/[?query]#fragment protocolï¼šé€šä¿¡åè®®ï¼Œå³httpã€ftpç­‰ hostï¼šä¸»æœºï¼ˆåŸŸåï¼‰ portï¼šç«¯å£å·ï¼Œå¯é€‰ pathï¼šè·¯å¾„ï¼Œç”¨ / åˆ†éš” queryï¼šå‚æ•°ï¼Œä»¥é”®å¯¹çš„å½¢å¼ï¼Œé€šè¿‡ &amp; åˆ†éš” fragmentï¼šç‰‡æ®µï¼Œ # åé¢å†…å®¹ï¼Œå¸¸è§äºé“¾æ¥é”šç‚¹ locationå¯¹è±¡å±æ€§ï¼š location.href è·å–æˆ–è®¾ç½®ï¼ˆå®ç°é¡µé¢è·³è½¬ï¼‰ æ•´ä¸ªURLï¼ˆæœ€å¸¸è§ï¼‰ location.hash URLæ•£åˆ—å€¼ï¼ŒVue-Routerã€çš„hashæ¨¡å¼ã€Reactè·¯ç”±çš„HashRouter è·³è½¬åŸç† location.host æœåŠ¡å™¨åå’Œç«¯å£å· location.search è¿”å›å‚æ•°ï¼ˆå³queryéƒ¨åˆ† ï¼‰ï¼ˆè¿™ä¸å°±æ˜¯Reactçš„searchä¼ å‚å—ï¼Ÿï¼‰ location.assign() è·Ÿhrefä¸€æ ·ï¼Œå¯ä»¥è·³è½¬é¡µé¢ï¼Œä½†æ˜¯å¯ä»¥åé€€ location.replace() åŒä¸Šï¼Œä½†æ˜¯ä¸èƒ½è®°å½•å†å²ï¼Œä¸èƒ½å®ç°åé€€åŠŸèƒ½ location.reload() ç±»ä¼¼äºF5åˆ·æ–° ï¼ˆlocation.reload(true)ä¸ºå¼ºåˆ¶åˆ·æ–°ï¼Œç¼“å­˜ä¸€èµ·æ²¡äº†ï¼‰ ç­‰ç­‰ 7.navigatorå¯¹è±¡navigatorå¯¹è±¡åŒ…å«æµè§ˆå™¨çš„ä¿¡æ¯ï¼Œå®ƒå¯ä»¥çŸ¥é“ä½ æ˜¯ç”¨çš„æ˜¯pcç«¯æµè§ˆå™¨è¿˜æ˜¯ç§»åŠ¨ç«¯æµè§ˆå™¨ï¼Œæœ‰å¾ˆå¤šå±æ€§ï¼Œæœ€å¸¸ç”¨çš„æ˜¯userAgentï¼Œè¯¥å±æ€§å€¼è¿”å›åˆå®¢æˆ·æœºå‘é€æœåŠ¡å™¨user-agentå¤´éƒ¨çš„å€¼ &lt;script> if((navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i))) { window.location.href = \"../H5/index.html\"; //æ‰‹æœº } &lt;/script> å¼•å…¥ä»¥ä¸Šä»£ç å¯ä»¥è‡ªåŠ¨åˆ¤æ–­æ˜¯è¿›å…¥äº†pcç«¯æµè§ˆå™¨è¿˜æ˜¯ç§»åŠ¨ç«¯æµè§ˆå™¨ æ­¤å¤–ï¼Œnavigatorè¿˜æš´éœ²äº†ä¸€äº›APIï¼Œå¯æä¾›æµè§ˆå™¨å’Œæ“ä½œç³»ç»Ÿçš„çŠ¶æ€ä¿¡æ¯ Geolocation API navigator.geolocationå±æ€§æš´éœ²äº†Geolocation APIï¼Œå¯ä»¥è®©æµè§ˆå™¨è„šæœ¬æ„ŸçŸ¥å½“å‰è®¾å¤‡çš„åœ°ç†ä½ç½®ã€‚è¿™ä¸ªAPIåªåœ¨å®‰å…¨æ‰§è¡Œç¯å¢ƒï¼ˆHTTPSï¼‰ä¸­å¯ç”¨ æ‰‹æœºGPSçš„åæ ‡ç³»ç»Ÿå¯èƒ½å…·æœ‰æé«˜çš„ç²¾åº¦ï¼Œè€ŒIPåœ°å€çš„ç²¾åº¦å°±è¦å·®çš„å¾ˆå¤š ä¸è¿‡æµè§ˆå™¨ä¹Ÿæœ‰å¯èƒ½ä¼šåˆ©ç”¨ Google Location Serviceï¼ˆChromeå’ŒFirefoxï¼‰ç­‰æœåŠ¡ç¡®å®šä½ç½®ã€‚æœ‰æ—¶å€™ï¼Œä½ å¯èƒ½å‘ç°è‡ªå·±å¹¶æ²¡æœ‰GPSï¼Œä½†æµè§ˆå™¨ç»™å‡ºçš„åæ ‡å´ååˆ†ç²¾ç¡®ï¼Œæ˜¯å› ä¸ºæµè§ˆå™¨ä¼šæ”¶é›†æ‰€æœ‰å¯ç”¨çš„æ— çº¿ç½‘ç»œï¼ŒåŒ…æ‹¬Wifiå’Œèœ‚çªä¿¡å·ï¼Œæ‹¿åˆ°è¿™äº›ä¿¡æ¯åï¼Œå†å»æŸ¥è¯¢ç½‘ç»œæ•°æ®åº“ã€‚ navigator.geolocation.getCurrentPosition((position) => console.log(position), (err) => console.log(err)) ç¬¬ä¸€ä¸ªæ˜¯å›è°ƒæˆåŠŸçš„å‡½æ•°ï¼Œä¼ å…¥çš„ postionå‚æ•°ï¼Œæœ‰ä¼—å¤šå±æ€§ï¼Œ æ¯”å¦‚å…¶ä¸­ postion.coordinateså¯¹è±¡æœ‰ latitude ç»åº¦ï¼Œ longitudeç»´åº¦ã€alititudeæµ·æ‹”ã€speedè®¾å¤‡ç§»åŠ¨é€Ÿåº¦ ç¬¬äºŒä¸ªæ¥æ”¶å¤±è´¥å›è°ƒå‡½æ•° Connection Stateä»»ä½•æ—¶å€™ï¼Œéƒ½å¯ä»¥é€šè¿‡ navigator.onLineå±æ€§æ¥ç¡®å®šæµè§ˆå™¨çš„è”ç½‘çŠ¶æ€ï¼Œè¯¥å±æ€§è¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºæµè§ˆå™¨æ˜¯å¦è”ç½‘ã€‚ const connectionStateChange = () => console.log(navigator.onLine); window.addEventListener('onLine', connectionStateChange) window.addEventListener('offLine', connectionStateChange) //è®¾å¤‡è”ç½‘ //true //æ–­ç½‘ //false è§†é¢‘å½•åˆ¶å±å¹•å…±äº« const mediaDevices = navigator.mediaDevices; mediaDevices æ˜¯ Navigator åªè¯»å±æ€§ï¼Œè¿”å›ä¸€ä¸ª MediaDevices å¯¹è±¡ï¼Œè¯¥å¯¹è±¡å¯æä¾›å¯¹ç›¸æœºå’Œéº¦å…‹é£ç­‰åª’ä½“è¾“å…¥è®¾å¤‡çš„è¿æ¥è®¿é—®ï¼Œä¹ŸåŒ…æ‹¬å±å¹•å…±äº«ã€‚ è€Œ MediaDevices æ¥å£çš„ getDisplayMedia() æ–¹æ³•æç¤ºç”¨æˆ·å»é€‰æ‹©å’Œæˆæƒæ•è·å±•ç¤ºçš„å†…å®¹æˆ–éƒ¨åˆ†å†…å®¹ï¼ˆå¦‚ä¸€ä¸ªçª—å£ï¼‰åœ¨ä¸€ä¸ª MediaStream é‡Œ. ç„¶åï¼Œè¿™ä¸ªåª’ä½“æµå¯ä»¥é€šè¿‡ä½¿ç”¨ MediaStream Recording API è¢«è®°å½•æˆ–è€…ä½œä¸ºWebRTC ä¼šè¯çš„ä¸€éƒ¨åˆ†è¢«ä¼ è¾“ï¼Œä¹Ÿå°±æ˜¯è¢« MediaRecorderä¼ è¾“ const promise = navigator.mediaDevices.getDisplayMedia(constraints); æ­¤æ—¶å¯ä»¥å…±äº«å±å¹• document.querySelector('#start').onclick = function() { if (navigator.mediaDevices &amp;&amp; navigator.mediaDevices.getDisplayMedia) { navigator.mediaDevices.getDisplayMedia({ video: true, audio: false }).then((stream) => { document.querySelector('#video').srcObject = stream; }).catch((err) => { console.error(err); }) } else { alert('ä¸æ”¯æŒè¿™ä¸ªç‰¹æ€§'); } } å±å¹•å½•åˆ¶ MediaRecorder æ˜¯ MediaStream Recording API æä¾›çš„ç”¨æ¥è¿›è¡Œåª’ä½“è½»æ¾å½•åˆ¶çš„æ¥å£, ä»–éœ€è¦é€šè¿‡è°ƒç”¨ MediaRecorder() æ„é€ æ–¹æ³•è¿›è¡Œå®ä¾‹åŒ–. new MediaRecorder(stream, [, options]); MediaRecorder.start(timeslice)å¼€å¯å½•åˆ¶ï¼Œtimesliceæ˜¯ä¸€ä¸ªå¯é€‰å‚æ•°ï¼Œè®¾ç½®äº†è¿™ä¸ªå‚æ•°å°±ä¼šæŒ‰ç…§æ—¶é—´æ®µå­˜å‚¨æ•°æ® const btn = document.querySelector('.button') btn.addEventListener('click', async () => { //ä¸€ä¸ªæ•è·çš„æ¥å£ï¼Œæ­¤æ—¶ä¼šå¼¹å‡ºä¸€ä¸ªå¼¹çª—ï¼Œè®©ä½ é€‰æ‹©æ•è·å“ªé‡Œçš„ï¼Œè¿”å›ä¸€ä¸ªpromiseå¯¹è±¡ï¼ˆè§†é¢‘æµï¼‰ //ç›®å‰åªèƒ½å½•å±å¹•ï¼Œæš‚æ— æ³•æ”¯æŒéŸ³é¢‘ï¼Œåœ¨ç›‘å¬dataavailableã€stopé˜¶æ®µå‡ºé—®é¢˜ const stream = await navigator.mediaDevices.getDisplayMedia({ video: true, audio: false }) // MediaRecorder.isTypeSupported()æ–¹æ³•ä¼šåˆ¤æ–­å…¶ MIME æ ¼å¼èƒ½å¦è¢«å®¢æˆ·ç«¯å½•åˆ¶ã€‚ const mime = MediaRecorder.isTypeSupported(\"video/webm; codecs=vp9\") ? \"video/webm; codecs=vp9\" : \"video/webm\" //å®ä¾‹åŒ–å½•åˆ¶æ¥å£ const recorder = new MediaRecorder(stream, { mimeType: 'audio/webm' }) const chunks = [] recorder.addEventListener('dataavailable', (e) => { chunks.push(e.data) }) recorder.addEventListener('stop', () => { //è§†é¢‘æµè½¬blobï¼ŒäºŒè¿›åˆ¶æ•°æ® const blob = new Blob(chunks, { type: chunks[0].type }) let url = URL.createObjectURL(blob) //å±•ç¤ºè§†é¢‘ const video = document.querySelector('.video') video.src = url //ä¸‹è½½ const a = document.createElement('a') a.href = url a.download = 'video.webm' //è®¾ç½®aæ ‡ç­¾ä¸‹è½½å±æ€§ a.click() }) recorder.start() //éœ€è¦æˆ‘ä»¬å»æ‰‹åŠ¨å¯åŠ¨ }) æŸ¥çœ‹MIME æ ¼å¼æ”¯æŒæƒ…å†µ const types = [\"video/webm\", \"audio/webm\", \"video/webm\\;codecs=vp8\", \"video/webm\\;codecs=daala\", \"video/webm\\;codecs=h264\", \"audio/webm\\;codecs=opus\", \"video/mpeg\"]; for (var i in types) { console.log(\"Is \" + types[i] + \" supported? \" + (MediaRecorder.isTypeSupported(types[i]) ? \"Maybe!\" : \"Nope :(\")); } å‚è€ƒèµ„æ–™https://cloud.tencent.com/developer/article/1793748 7.historyå¯¹è±¡ç”¨äºä¸æµè§ˆå™¨å†å²è®°å½•è¿›è¡Œäº¤äº’ï¼ˆå®é™…ä¸Šå’Œæµè§ˆå™¨è‡ªå¸¦çš„é¡µé¢åé€€ï¼Œå‰è¿›åŠŸèƒ½ä¸€æ ·ï¼‰ å®é™…å¼€å‘ç”¨çš„å°‘ï¼Œä½†æ˜¯ä¸€äº›OAåŠå…¬ç³»ç»Ÿä¼šç”¨åˆ° history.back() åé€€åŠŸèƒ½ history.forward() å‰è¿›åŠŸèƒ½ history.go(å‚æ•°) å‰è¿›åé€€åŠŸèƒ½ï¼Œå‚æ•°æ˜¯1å‰è¿›ä¸€ä¸ªé¡µé¢ï¼Œ-1åé€€ä¸€ä¸ªé¡µé¢ history.pushState å†å²è®°å½•ç®¡ç† hashchange ä¼šåœ¨é¡µé¢URLçš„æ•£åˆ—å˜åŒ–æ—¶è¢«è§¦å‘ï¼Œå¼€å‘è€…å¯ä»¥åœ¨æ­¤æ—¶æ‰§è¡ŒæŸäº›æ“ä½œï¼Œè€ŒçŠ¶æ€ç®¡ç†APIåˆ™å¯ä»¥è®©å¼€å‘è€…æ”¹å˜æµè§ˆå™¨URLè€Œä¸ä¼šé‡æ–°åŠ è½½é¡µé¢ã€‚ä¸ºæ­¤ å¯ä»¥ä½¿ç”¨history.pushState()æ–¹æ³• æ¥æ”¶ä¸‰ä¸ªå‚æ•° ä¸€ä¸ªstateå¯¹è±¡ ä¸€ä¸ªæ–°çš„çŠ¶æ€æ ‡é¢˜ ä¸€ä¸ªå¯é€‰çš„ ç›¸å¯¹URL history.pushState(stateObj, &quot;my title&quot;, &quot;baz.html&quot;) æ‰§è¡Œåï¼ŒçŠ¶æ€ä¿¡æ¯ä¼šè¢«æ¨é€åˆ°å†å²è®°å½•ä¸­ï¼Œæµè§ˆå™¨åœ°å€æ ä¹Ÿä¼šæ”¹å˜ä»¥åæ˜ æ–°çš„ç›¸å¯¹URLï¼Œå³ä½¿location.hrefè¿”å›çš„æ˜¯åœ°å€æ ä¸­çš„å†…å®¹ï¼Œæµè§ˆå™¨ä¸ä¼šå‘æœåŠ¡å™¨å‘é€è¯·æ±‚ã€‚ å¯ä»¥é€šè¿‡ history.stateæ¥è·å–å½“å‰çš„çŠ¶æ€å¯¹è±¡ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ replaceState()å¹¶ä¼ å…¥ä¸ pushState()åŒæ ·çš„å‰ä¸¤ä¸ªå‚æ•°æ¥æ›´æ–°çŠ¶æ€ï¼ˆè¦†ç›–çŠ¶æ€ï¼‰ æ³¨æ„ï¼šä½¿ç”¨HTML5çŠ¶æ€ç®¡ç†æ—¶ï¼Œè¦ç¡®ä¿é€šè¿‡ pushState()åˆ›é€ çš„æ¯ä¸ªâ€œå‡â€çš„URLèƒŒåéƒ½å¯¹åº”ç€æœåŠ¡å™¨ä¸Šä¸€ä¸ªçœŸå®çš„çš„URLï¼Œå¦åˆ™å•å‡»â€œåˆ·æ–°â€æŒ‰é’®ä¼šå¯¼è‡´404.æ‰€æœ‰å•é¡µé¢åº”ç”¨ç¨‹åºï¼ˆSPAï¼‰æ¡†æ¶éƒ½å¿…é¡»é€šè¿‡æœåŠ¡å™¨æˆ–å®¢æˆ·ç«¯çš„æŸäº›é…ç½®è§£å†³è¿™ä¸ªé—®é¢˜ã€‚ é€šè¿‡pushStateçš„æ–¹å¼æ›´æ”¹hrefå’Œç›´æ¥ç‚¹å‡» &lt;a href=&quot;/åç¼€å&quot;&gt; ä¸åŒçš„æ˜¯ï¼Œåè€…ä¼šå‘æœåŠ¡å™¨è¯·æ±‚èµ„æº 8.è·å–CSSå±æ€§çš„å€¼Window.getComputedStyle()æ–¹æ³•è¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œè¯¥å¯¹è±¡åœ¨åº”ç”¨æ´»åŠ¨æ ·å¼è¡¨å¹¶è§£æè¿™äº›å€¼å¯èƒ½åŒ…å«çš„ä»»ä½•åŸºæœ¬è®¡ç®—åæŠ¥å‘Šå…ƒç´ çš„æ‰€æœ‰CSSå±æ€§çš„å€¼ã€‚ ç§æœ‰çš„CSSå±æ€§å€¼å¯ä»¥é€šè¿‡å¯¹è±¡æä¾›çš„APIæˆ–é€šè¿‡ç®€å•åœ°ä½¿ç”¨CSSå±æ€§åç§°è¿›è¡Œç´¢å¼•æ¥è®¿é—®ã€‚ let style = window.getComputedStyle(element, [pseudoElt]); å¯¹æ¯”ç›´æ¥è·å– style ï¼š è¿”å›çš„å¯¹è±¡ä¸ä»å…ƒç´ çš„ style (en-US) å±æ€§è¿”å›çš„å¯¹è±¡å…·æœ‰ç›¸åŒçš„ç±»å‹;ç„¶è€Œï¼Œä¸¤ä¸ªå¯¹è±¡å…·æœ‰ä¸åŒçš„ç›®çš„ã€‚ä»getComputedStyleè¿”å›çš„å¯¹è±¡æ˜¯åªè¯»çš„ï¼Œå¯ä»¥ç”¨äºæ£€æŸ¥å…ƒç´ çš„æ ·å¼ï¼ˆåŒ…æ‹¬ç”±ä¸€ä¸ª&lt;style&gt;å…ƒç´ æˆ–ä¸€ä¸ªå¤–éƒ¨æ ·å¼è¡¨è®¾ç½®çš„é‚£äº›æ ·å¼ï¼‰ã€‚elt.styleå¯¹è±¡åº”ç”¨äºåœ¨ç‰¹å®šå…ƒç´ ä¸Šè®¾ç½®æ ·å¼ã€‚","categories":[{"name":"å‰ç«¯","slug":"å‰ç«¯","permalink":"https://taylor12138.github.io/categories/%E5%89%8D%E7%AB%AF/"}],"tags":[],"author":"Hello"},{"title":"Reactä¸­ä½¿ç”¨TS","slug":"Reactä¸­ä½¿ç”¨TS","date":"2022-03-04T16:00:00.000Z","updated":"2022-05-03T03:54:29.541Z","comments":true,"path":"2022/03/05/react-zhong-shi-yong-ts/","link":"","permalink":"https://taylor12138.github.io/2022/03/05/react-zhong-shi-yong-ts/","excerpt":"","text":"åœ¨Reactä¸­ä½¿ç”¨typescriptReactè„šæ‰‹æ¶ + typescript npx create-react-app my-app --template typescript å¦‚æœæ˜¯å¯¹å½“å‰Reactè„šæ‰‹æ¶é¡¹ç›®æ·»åŠ typescriptæ”¯æŒ npm install --save typescript @types/node @types/react @types/react-dom @types/jest ä½†æ˜¯æœ‰ä¸ªé—®é¢˜å°±æ˜¯ï¼šå°† TypeScript æ·»åŠ åˆ°ç°æœ‰é¡¹ç›®ä¸ä¼šæ·»åŠ  tsconfig https://github.com/facebook/create-react-app/issues/10951 ä½œä¸ºä¸€ç§è¾ƒä¸ºæ— è¯­çš„è§£å†³æ–¹æ³•ï¼š ä½œä¸ºä¸€ç§è§£å†³æ–¹æ³•ï¼Œæˆ‘é€šè¿‡è¿è¡Œåˆ›å»ºäº†ä¸€ä¸ªæ–°çš„ react åº”ç”¨ç¨‹åºï¼šnpx create-react-app ts-example --template typescriptç„¶åå°†ç”Ÿæˆçš„ tsconfig.json çš„å†…å®¹å¤åˆ¶ç²˜è´´åˆ°æˆ‘ç°æœ‰çš„åº”ç”¨ç¨‹åºä¸­ã€‚ å¯¹äºç±»å¼ç»„ä»¶åœ¨æ„å»ºReactç»„ä»¶ç±»çš„æ—¶å€™ï¼Œè¿˜æœ‰è¿™ä¸€ç§æ¥å£çš„å†™æ³• React.Component&lt;propsæ¥å£çš„åç§°, stateæ¥å£çš„åç§°&gt;ï¼Œç”¨æ¥è¯´æ˜æ´¾ç”Ÿçš„ Component ä½¿ç”¨çš„ Props å’Œ State çš„ç±»å‹ React.Component&lt;Props, State> refå¯¹è±¡ï¼Œæˆ‘ä»¬ä¹Ÿéœ€è¦æ‰‹åŠ¨å£°æ˜å®ƒçš„ç±»å‹ myRef = React.createRef&lt;refçš„å…ƒç´ ç±»å‹&gt;()æ¯”å¦‚ä»¥ä¸‹ä¾‹å­ import React, { Component, createRef } from 'react'; interface IState { name: string } // æ³›å‹ç¬¬ä¸€ä¸ªçº¦å®špropså±æ€§ã€ç¬¬äºŒä¸ªçº¦å®šçŠ¶æ€ class App extends Component&lt;any, IState> { state = { name: \"allen\" } myRef = createRef&lt;HTMLInputElement>() render() { return ( &lt;div> &lt;input type=\"text\" ref={ this.myRef}/> &lt;button onClick={ () => { console.log((this.myRef.current as HTMLInputElement).value); } }>&lt;/button> &lt;Child name={this.state.name}>&lt;/Child> &lt;/div> ); } } interface IProps { name: string } class Child extends Component&lt;IProps, IState> { } export default App; å¯¹äºå‡½æ•°å¼ç»„ä»¶å‡½æ•°å¼ç»„ä»¶ååˆ†è½»æ¾ï¼Œä¸ç”¨åšä»€ä¹ˆå¤„ç†ï¼Œä½œä¸ºçŠ¶æ€stateå·²ç»è¢«éšå¼æ¨å¯¼äº† è€Œå…¶ä»–çš„è§„èŒƒä¹Ÿååˆ†è½»æ¾ import React, {useState, useRef} from 'react' //éè¦è‡ªå·±æ˜¾å¼ä¹Ÿä¸æ˜¯ä¸è¡Œï¼š const [name, setName] = useState&lt;string>(\"allen\") interface IProps { name: string } export default function App(props:IProps) { const [name, setName] = useState(\"allen\") const inputRef = useRef&lt;HTMLInputElement>(null) return ( &lt;div> &lt;div>{name}&lt;/div> &lt;input type=\"text\" ref={inputRef}/> &lt;button onClick={ () => { setName(\"Mikasa\") console.log((inputRef.current as HTMLInputElement).value); } }>&lt;/button> &lt;/div> ) } reactè·¯ç”±+TSå¯¹äºreact-router-domï¼Œæ— æ³•ç›´æ¥ä½¿ç”¨ï¼Œéœ€è¦å£°æ˜æ–‡ä»¶ï¼ˆdeclareï¼‰ï¼ˆæˆ–è€…ä½ è‡ªå·±å†™å£°æ˜æ–‡ä»¶ï¼Œæ‰‹åŠ¨ç‹—å¤´ï¼‰ npm i --save-dev @types/react-router-dom æ³¨æ„äº‹é¡¹ï¼šä½œä¸ºè·¯ç”±ç»„ä»¶ï¼Œåº”è¯¥å¸¦æœ‰ä¸‰ä¸ªå±æ€§ï¼šhistoryã€locationã€match é¦–å…ˆå¼•å…¥ RouteComponentProps propsçš„å£°æ˜ï¼Œå¾—åˆ°è·¯ç”±ç»„ä»¶çš„ç±»å‹æ¨æ–­ å…¶æ¬¡å¯ä»¥åœ¨è¯¥å£°æ˜ä¸­ä¼ å…¥æ³›å‹ï¼Œè¿™ä¸ªæ³›å‹æ˜¯æŒ‡å®šè·¯ç”±å‚æ•°ï¼ˆparamsï¼‰ç±»å‹çš„æ³›å‹ import React, { useState, useRef } from 'react' import {RouteComponentProps} from 'react-router-dom'; interface IParams { name: string } export default function App(props:RouteComponentProps&lt;IParams>) { return ( &lt;div> {props.match.params.name} &lt;/div> ) } redux+TSreduxå·²ç»æœ‰å£°æ˜æ–‡ä»¶äº†ï¼Œè¿™é‡Œä¸ç”¨ä¸‹è½½ ä¸‰ä¸ªæ–‡ä»¶ æ–°å»º store.js æ–°å»ºä¸€ä¸ªå¤„ç†xxxç»„ä»¶çš„ xxx-reducer.js å¯é€‰ï¼Œæ–°å»ºä¸€ä¸ªå¤„ç†xxç»„å»ºçš„xxx-action.js storeå‡ ä¹ç…§å¸¸å†™å°±è¡Œäº†ï¼Œè€Œreducerå’Œactionä¼ å‚çš„æ—¶å€™å°å°ä¿®æ”¹ä¸€ä¸‹ interface IAction { type: string; payload?: any; } interface IPreState { isShow: boolean } export default function countReducer(preState: IPreState = { isShow: true }, action: IAction) { const { type, payload } = action; let newState = preState; //... return newState; } å°å‘aliaså…³äºTSåœ¨create react appåº”ç”¨çš„å°å‘ webpacké…ç½® module.exports = { //... resolve: { alias: { '@': path.join(__dirname, '../src') } } }; ä½†æ˜¯åœ¨é¡¹ç›®ä¸­ä½¿ç”¨aliasè½¬æ¢çš„å…¨å±€è·¯å¾„ï¼Œtsä¸ä¹°è´¦ ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œéœ€è¦å€ŸåŠ©tsconfigï¼Œå°½ç®¡webpackå·²ç»é…ç½®å¥½äº†aliasï¼Œ å¯æ˜¯tså¹¶ä¸è®¤è´¦ã€‚ tsconfig.jsoné…ç½®å¦‚ä¸‹ éœ€è¦åœ¨compilerOptions å¢åŠ 2ä¸ªå­—æ®µï¼Œ baseUrl æŒ‡å®šå½“å‰å·¥ç¨‹çš„è·¯å¾„ï¼Œ paths ç”¨äºå¯¹åˆ«åçš„æ˜ å°„ã€‚ { \"compilerOptions\": { // ... \"baseUrl\": \".\", \"paths\": { \"@/*\": [\"./src/*\"] } // ... } } åœ¨æ­¤å°±èƒ½è§£å†³ä¸Šè¿°é—®é¢˜äº†ï¼Œå¦‚æœä¸è¡Œå¯èƒ½éœ€è¦é‡å¯vscodeã€‚","categories":[{"name":"å‰ç«¯","slug":"å‰ç«¯","permalink":"https://taylor12138.github.io/categories/%E5%89%8D%E7%AB%AF/"}],"tags":[],"author":"Hello"},{"title":"MongoDB","slug":"MongoDB","date":"2022-02-26T12:22:09.129Z","updated":"2022-02-26T12:22:09.129Z","comments":true,"path":"2022/02/26/mongodb/","link":"","permalink":"https://taylor12138.github.io/2022/02/26/mongodb/","excerpt":"","text":"1.MongoDBæ¦‚è¿°MongoDB æ˜¯ä¸€ä¸ªåŸºäºåˆ†å¸ƒå¼æ–‡ä»¶å­˜å‚¨çš„æ•°æ®åº“ã€‚ç”± C++ è¯­è¨€ç¼–å†™ã€‚æ—¨åœ¨ä¸º WEB åº”ç”¨æä¾›å¯æ‰©å±•çš„é«˜æ€§èƒ½æ•°æ®å­˜å‚¨è§£å†³æ–¹æ¡ˆã€‚ mongoDBä¸éœ€è¦å­¦ä¹ sqlè¯­å¥ NoSQLï¼ŒæŒ‡çš„æ˜¯éå…³ç³»å‹çš„æ•°æ®åº“ã€‚NoSQLæœ‰æ—¶ä¹Ÿç§°ä½œNot Only SQLçš„ç¼©å†™ å…³ç³»å‹æ•°æ®åº“å’Œéå…³ç³»å‹æ•°æ®åº“ å…³ç³»å‹æ•°æ®åº“ éå…³ç³»å‹æ•°æ®åº“ éœ€è¦é€šè¿‡sqlè¯­è¨€æ¥æ“ä½œ ä¸éœ€è¦ éœ€è¦è®¾è®¡è¡¨ç»“æ„ï¼Œæ”¯æŒçº¦æŸ ä¸éœ€è¦ é€šè¿‡äº‹åŠ¡æ¥æ§åˆ¶å¤šå¼ è¡¨çš„æ›´æ–° æ²¡æœ‰äº‹åŠ¡è¿™ä¸ªæ¦‚å¿µï¼Œæ¯ä¸€ä¸ªæ•°æ®é›†éƒ½æ˜¯åŸå­çº§åˆ«çš„ã€‚ ä»¥æ•°æ®åº“è¡¨çš„å½¢å¼å­˜å‚¨ ç”¨key- valueé”®å€¼å¯¹å­˜å‚¨ï¼Œç»“æ„ä¸ç¨³å®š çºµå‘æ‰©å±•ï¼Œæ•°æ®é‡‡ç”¨çºµå‘æ‰©å±•ï¼Œæé«˜å¤„ç†èƒ½åŠ› æ¨ªå‘æ‹“å±•ï¼Œå¤©ç„¶æ˜¯åˆ†å¸ƒå¼çš„ï¼Œæ‰€ä»¥å¯ä»¥é€šè¿‡é›†ç¾¤æ¥å®ç°è´Ÿè½½å‡è¡¡ éå…³ç³»å‹æ•°æ®åº“æ²¡æœ‰è¡Œåˆ—çš„æ¦‚å¿µï¼Œç”¨jsonæ¥å­˜å‚¨æ•°æ® è€ŒMongoDBæ˜¯é•¿å¾—æœ€åƒå…³ç³»å‹æ•°æ®åº“çš„éå…³ç³»å‹æ•°æ®åº“ æ•°æ®åº“ =&gt; æ•°æ®åº“ æ•°æ®è¡¨ =&gt; é›†åˆï¼ˆæ•°ç»„ï¼‰ è¡¨è®°å½• =&gt; ï¼ˆæ–‡æ¡£å¯¹è±¡ï¼‰ { æ•°æ®åº“:{ é›†åˆ:[ {name: &#39;Allen&#39;}, {name: &#39;Allen&#39;}, {name: &#39;Allen&#39;}, ] } } MongoDB å°†æ•°æ®å­˜å‚¨ä¸º BSON æ–‡æ¡£ã€‚BSON æ˜¯ JSONï¼ˆJavaScript Object Notationï¼‰çš„äºŒè¿›åˆ¶è¡¨ç¤ºã€‚ tipï¼š æ•°æ®åº“ä¹‹é—´çš„å…³ç³»ï¼š ä¸€å¯¹ä¸€ï¼ˆèº«ä»½è¯å·ï¼‰ ä¸€å¯¹å¤šï¼ˆä¸€ä¸ªç­çº§å¤šåå­¦ç”Ÿï¼‰ å¤šå¯¹å¤šï¼ˆä¸€ä¸ªå­¦ç”Ÿå¤šé—¨è¯¾ç¨‹ï¼Œä¸€é—¨è¯¾å¯ä»¥è¢«å¤šåå­¦ç”Ÿé€‰ï¼‰ï¼Œä¸€èˆ¬å†å»ºç«‹ä¸€ä¸ªä¸­é—´è¡¨ï¼Œæ¥ä¿å­˜ä¸¤ä¸ªè¡¨ä¹‹é—´çš„å…³ç³»ä¿¡æ¯ 2.ä½¿ç”¨ï¼ˆwindowsç‰ˆï¼‰å¼€å¯æœåŠ¡ï¼ˆæœåŠ¡ç«¯ï¼‰æ–¹å¼ä¸€ï¼šæ ¹æ®èœé¸Ÿæ•™ç¨‹æä¾›çš„window MongoDBæ“ä½œæ•™ç¨‹ï¼Œå°±å¯ä»¥æ³¨å†Œæˆwindowçš„ä¸€ä¸ªæœåŠ¡ï¼Œç„¶åå¯ä»¥é€šè¿‡é¼ æ ‡å³é”®å¼€å¯å’Œåœæ­¢è¿™ä¸ªæœåŠ¡äº† æ–¹å¼äºŒï¼š #mongodb é»˜è®¤ä½¿ç”¨æ‰§è¡Œ mongod å‘½ä»¤æ‰€å¤„ç›˜æ ¹ç›®å½•ä¸‹çš„/data/dbä½œä¸ºè‡ªå·±çš„æ•°æ®å­˜å‚¨ç›®å½• #æ‰€ä»¥åœ¨ç¬¬ä¸€æ¬¡æ‰§è¡Œè¯¥å‘½ä»¤ä¹‹å‰ï¼Œå…ˆæ‰‹åŠ¨æ–°å»ºä¸€ä¸ª E(MongoDBæ‰€å±ç›˜):/data/db #ç„¶åå†è‡ªå·±æ‰€å±ç›˜ä¸‹ è¿è¡Œè¯¥å‘½ä»¤ mongod åœæ­¢æœåŠ¡ï¼šctrl + Cæˆ–è€…ç›´æ¥å…³é—­cmdçª—å£ å¦‚æœæƒ³è¦ä¿®æ”¹é»˜è®¤çš„æ•°æ®å­˜å‚¨ç›®å½•è·¯å¾„ï¼Œå¯ä»¥ï¼ˆä½†æ˜¯æ¯”è¾ƒéº»çƒ¦ï¼Œä¸æ¨èï¼‰ mongod --dbpath=æ•°æ®å­˜å‚¨ç›®å½•è·¯å¾„ æ³¨æ„ï¼Œåœ¨mongoDB4.xä»¥åï¼Œä¸éœ€è¦å¼€å¯æœåŠ¡è¿™ä¸ªæ­¥éª¤ï¼Œå› ä¸ºåœ¨å®¢æˆ·ç«¯æ‰§è¡Œè¿æ¥å‘½ä»¤çš„æ—¶å€™ï¼Œè®¡ç®—æœºä¼šè‡ªåŠ¨å¸®æˆ‘ä»¬å¼€å¯æœåŠ¡ è¿æ¥ï¼ˆå®¢æˆ·ç«¯ï¼‰ç”¨ä¸€ä¸ªå‘½ä»¤çª—å£æ¥æ‰“å¼€MongoDBæ•°æ®åº“ æ­¤æ—¶å†æ‰“å¼€ä¸€ä¸ªçª—å£ï¼Œè¾“å…¥ä»¥ä¸‹å‘½ä»¤è¿›è¡Œè¿æ¥ï¼ˆè¿™ä¸ªå‘½ä»¤æ‰§è¡ŒæˆåŠŸçš„å‰ææ˜¯è¦æŠŠe:mongo/binï¼Œä¹Ÿå°±æ˜¯è‡ªå·±å®‰è£…çš„mongoDBçš„binè·¯å¾„åŠ å…¥åˆ°å½“å‰ç³»ç»Ÿçš„ç¯å¢ƒå˜é‡ä¸­ï¼‰ #è¯¥å‘½ä»¤é»˜è®¤è¿æ¥æœ¬æœºçš„MongoDBæœåŠ¡ mongo æ–­å¼€è¿æ¥ exitåŸºæœ¬å‘½ä»¤æŸ¥çœ‹æ˜¾ç¤ºæ‰€æœ‰æ•°æ®åº“ show dbs æŸ¥çœ‹å½“å‰æ“ä½œçš„æ•°æ®åº“ï¼Œé»˜è®¤ä¸ºtestï¼Œä¾›æµ‹è¯• db åˆ‡æ¢åˆ°æŒ‡å®šæ•°æ®åº“ï¼Œå¦‚æœæ²¡æœ‰è¯¥æ•°æ®åº“åˆ™ä¼šæ–°å»ºä¸€ä¸ªï¼ˆçœŸæ­£åˆ›å»ºå‡ºæ¥è¿˜å¾—å¾€è¯¥æ•°æ®åº“é‡Œæ’å…¥ä¸€æ¡æ•°æ®ï¼‰ use æ•°æ®åº“åç§°åˆ é™¤å½“å‰åˆ‡æ¢åˆ°çš„æ•°æ®åº“ db.dropDatabase æŸ¥çœ‹å½“å‰æ•°æ®åº“çš„é›†åˆï¼ˆä¸€ä¸ªæ•°æ®åº“æœ‰å¤šä¸ªé›†åˆï¼‰ show collections åŸç”Ÿçš„æŸ¥è¯¢æ–¹æ³•å¯¹äºå°é¡¹ç›®è¿˜å¥½ï¼Œå¯¹äºå¤§é¡¹ç›®æ¥è¯´å¯èƒ½æ€§èƒ½ä¸æ˜¯å¾ˆå¥½ï¼Œæ¨èä½¿ç”¨ç¬¬ä¸‰æ–¹åº“æ¥æŸ¥è¯¢ ä½ ç”šè‡³å¯ä»¥åœ¨å‘½ä»¤è¡Œé‡Œå†™forå¾ªç¯æ¥æ’å…¥ã€‚ã€‚ #åœ¨å½“å‰æ•°æ®åº“çš„studentsé›†åˆä¸­æ’å…¥ä¸€ä¸ªæ•°æ®ï¼ˆå¯¹è±¡ï¼‰ï¼Œæ²¡æœ‰è¿™ä¸ªé›†åˆåˆ™ä¼šæ–°å»ºä¸€ä¸ª db.students.insertOne({\"name\": \"Jack\"}) #åœ¨å½“å‰æ•°æ®åº“çš„studentsé›†åˆä¸­å†æ’å…¥ä¸€ä¸ªæ•°æ®ï¼ˆå¯¹è±¡ï¼‰ db.students.insert({\"name\": \"Allen\"}) #æŸ¥çœ‹å½“å‰æ•°æ®åº“çš„studentsé›†åˆä¸­çš„æ•°æ® db.students.find() #æŸ¥çœ‹å½“å‰æ•°æ®åº“çš„studentsé›†åˆä¸­çš„æ•°æ®æ•°é‡ db.students.find().count() #æŸ¥æ‰¾å½“å‰æ•°æ®åº“çš„studentsé›†åˆä¸­nameä¸ºAllençš„æ•°æ® db.students.find({\"name\": \"Allen\"}) #æŸ¥æ‰¾å½“å‰æ•°æ®åº“çš„studentsé›†åˆä¸­nameä»¥Aå¼€å¤´çš„æ•°æ® db.students.find({\"name\": A}) #æŸ¥è¯¢å‰5æ¡æ•°æ® db.students.find().limit(5) #è·³è¿‡10æ¡æ•°æ®æŸ¥æ‰¾ db.students.find().skip(10) #ç§»é™¤ title ä¸ºâ€œMongoDBâ€çš„æ–‡æ¡£ db.test.remove({'title': 'MongoDB'}) #ä¸€å¤„testé›†åˆä¸­æ‰€æœ‰æ•°æ® db.test.remove({}) #ä¿®æ”¹æ•°æ®,ä¿®æ”¹nameä¸ºAllençš„æ•°æ®ï¼Œå°†å…¶ageæ”¹ä¸º33 db.stundents.update({\"name\": \"Allen\"}, {$set:{\"age\": 33}}) #å®Œæ•´æ›¿æ¢æ‰æ•°æ® db.stundents.update({\"name\": \"Allen\"}, {\"name\": \"Bruce\"}) åˆ é™¤é›†åˆ db.students.drop()ç´¢å¼•ä½¿ç”¨åŸºç¡€ä½¿ç”¨ç´¢å¼•æ˜¯æŒ‡å¯¹æ•°æ®åº“è¡¨ä¸­ä¸€åˆ—æˆ–è€…å¤šåˆ—çš„å€¼è¿›è¡Œæ’åºçš„ä¸€ç§æ•°æ®ç»“æ„ï¼Œå¯ä»¥è®©æˆ‘ä»¬æŸ¥è¯¢æ•°æ®åº“å˜å¾—æ›´å¿«ï¼ŒMongoDBçš„ç´¢å¼•å‡ ä¹å’Œä¼ ç»Ÿçš„å…³ç³»å‹æ•°æ®åº“ä¸€æ‘¸ä¸€æ ·ï¼Œå…¶ä¸­ä¹ŸåŒ…å«äº†ä¸€äº›åŸºæœ¬çš„æŸ¥è¯¢ä¼˜åŒ–æŠ€å·§ å¦‚æœæˆ‘ä»¬å¯¹æŸä¸€å­—æ®µå¢åŠ ç´¢å¼•ï¼ŒæŸ¥è¯¢æ—¶å°±ä¼šå…ˆå»ç´¢å¼•åˆ—è¡¨ä¸­ä¸€æ¬¡å®šä½åˆ°ç‰¹å®šå€¼çš„è¡Œæ•°ï¼Œå¤§å¤§å‡å°‘éå†åŒ¹é…çš„è¡Œæ•°ï¼Œæ‰€ä»¥èƒ½æ˜æ˜¾å¢åŠ æŸ¥è¯¢çš„é€Ÿåº¦ã€‚ï¼ˆæœ‰ç‚¹ç›®å½•çš„æ„Ÿè§‰ï¼‰ åˆ›å»ºç´¢å¼•ï¼ˆé‡Œé¢ä¼ å…¥è¦è®¾ç½®ç´¢å¼•çš„å­—æ®µï¼ˆkeyï¼‰ï¼Œå€¼ä¸º1å‡åºåºæ’åºï¼Œ-1ä¸ºé™åºï¼‰ db.user.ensureIndex({\"name\": 1}) è·å–å½“å‰é›†åˆç´¢å¼• db.user.getIndexes() åˆ é™¤ç´¢å¼• db.user.dropIndex({\"name\": 1}) æ­¤æ—¶ä½¿ç”¨ db.students.find({&quot;name&quot;: &quot;Allen&quot;})ä¼šå‘ç°å¿«äº†å·¨å¤šï¼ˆä¸Šç™¾å€çš„é€Ÿåº¦ï¼‰ å¤åˆç´¢å¼•å¦‚æœæˆ‘ä»¬ä½¿ç”¨findæŸ¥è¯¢æ—¶ï¼Œä½¿ç”¨çš„æ˜¯å¤åˆæŸ¥è¯¢ï¼Œä¹Ÿå°±æ˜¯ db.students.find({&quot;name&quot;: &quot;Allen&quot;, &quot;age&quot;: 1})è¿™ç§ç±»å‹çš„ï¼Œæ­¤æ—¶æˆ‘ä»¬éœ€è¦å¤åˆç´¢å¼•ï¼Œæ­¤æ—¶æˆ‘ä»¬ 1.åªå¯¹æŸ¥è¯¢nameè¿›è¡ŒæŸ¥è¯¢ï¼šä¼šå‘½ä¸­ç´¢å¼• 1.å¯¹æŸ¥è¯¢name &amp; age è¿›è¡ŒæŸ¥è¯¢ï¼šä¼šå‘½ä¸­ç´¢å¼•age 1.åªå¯¹æŸ¥è¯¢ageè¿›è¡ŒæŸ¥è¯¢ï¼šä¸ä¼šå‘½ä¸­ç´¢å¼• db.user.ensureIndex({\"name\": 1, \"age\": 1}) å”¯ä¸€ç´¢å¼•åœ¨ç¼ºçœçš„æƒ…å†µä¸‹åˆ›å»ºçš„ç´¢å¼•å‡ä¸æ˜¯å”¯ä¸€ç´¢å¼•ï¼Œä¸‹é¢ç¤ºä¾‹å°†åˆ›å»ºå”¯ä¸€ç´¢å¼• è¯´äººè¯å°±æ˜¯è®¾ç½®å®Œå”¯ä¸€ç´¢å¼•ä»¥åï¼Œè¿™ä¸ªå­—æ®µå°±ä¸èƒ½é‡å¤ï¼Œæ¯”å¦‚ç›®å‰æŸä¸ªæ•°æ®å…¶ä¸­ä¸€ä¸ªé”®å€¼å¯¹ä¸º {&quot;uid&quot;: 1}ï¼Œåˆ™ä¸èƒ½å†æ¬¡æ·»åŠ  å…¶ä¸­æœ‰ä¸ªé”®å€¼å¯¹ä¸º {&quot;uid&quot;: 1} çš„æ•°æ® db.user.ensureIndex({\"uid\": 1}, {\"unique\": true}) #å†æ¬¡æ’å…¥uidé‡å¤çš„æ–‡æ¡£åï¼ŒMongDBå°†æŠ¥é”™ db.user.insert({\"uid\": 1}) db.user.insert({\"uid\": 1}) 3.MongoDBæƒé™ç®¡ç†1.åˆ›å»ºè¶…çº§ç®¡ç†å‘˜è´¦æˆ·(root)ï¼Œåˆ é™¤ç®¡ç†å‘˜ä¸º db,dropUser(ç”¨æˆ·å) use admin #æŸ¥çœ‹å½“å‰æ•°æ®åº“çš„è´¦æˆ· show users db.createUser({ user:\"admin\", pwd:'123456', roles:[{role:'root', db:'admin'}] }) 2.ä¿®æ”¹Mongdbæ•°æ®åº“é…ç½®æ–‡ä»¶ åœ¨mongodbå®‰è£…ç›®å½•ä¸‹çš„binæ–‡ä»¶å¤¹ä¸­ï¼Œæ‰¾åˆ°mongod.cfgï¼ˆï¼‰è®°å¾—å…ˆå¤‡ä»½ä¸€ä¸‹ï¼Œç”¨æ–‡æœ¬ç¼–è¾‘æ‰“å¼€ï¼ˆæ³¨æ„ç©ºæ ¼æ ¼å¼ï¼‰ security: [ä¸¤ä¸ªç©ºæ ¼]authorization:[ä¸€ä¸ªç©ºæ ¼]enable3.é‡å¯mongodbæœåŠ¡ 4.ç”¨è¶…çº§ç®¡ç†å‘˜è´¦æˆ·è¿æ¥mongdobæ•°æ®åº“ï¼Œç¬¬äºŒä¸ªå–å†³äºä½ æ³¨å†Œçš„æ—¶å€™é€‰æ‹©çš„db #è¶…çº§ç®¡ç†å‘˜ç™»å½• mongo admin -u ç”¨æˆ·å -p å¯†ç  å¦‚æœæ˜¯è¿æ¥è¿œç¨‹æœåŠ¡å™¨ï¼Œåˆ™æ•²å…¥ä»¥ä¸‹å‘½ä»¤ mongo è¿œç¨‹æœåŠ¡å™¨ipåœ°å€ -u ç”¨æˆ·å -p å¯†ç  5.ç»™xxæ•°æ®åº“åˆ›å»ºä¸€ä¸ªè´¦æˆ·ï¼Œè®©å…¶åªèƒ½è®¿é—®xxæ•°æ®åº“ï¼Œä¸èƒ½è®¿é—®å…¶ä»–æ•°æ®åº“ use xx db.createUser({ user:\"xxmin\", pwd:'123456', roles:[{role:'dbOwner', db:'xx'}] }) æ•°æ®åº“ç”¨æˆ·è§’è‰²ï¼šreadã€readWrite; æ•°æ®åº“ç®¡ç†è§’è‰²ï¼šdbAdminã€dbOwnerã€userAdminï¼› é›†ç¾¤ç®¡ç†è§’è‰²ï¼šclusterAdminã€clusterManagerã€clusterMonitorã€hostManagerï¼› å¤‡ä»½æ¢å¤è§’è‰²ï¼šbackupã€restoreï¼› æ‰€æœ‰æ•°æ®åº“è§’è‰²ï¼šreadAnyDatabaseã€readWriteAnyDatabaseã€userAdminAnyDatabaseã€dbAdminAnyDatabase è¶…çº§ç”¨æˆ·è§’è‰²ï¼šroot 4.åœ¨Nodeä¸­æ“ä½œMongoDBæ•°æ®æ–¹æ³•ä¸€ï¼šä½¿ç”¨å®˜æ–¹çš„mongodbåŒ…æ¥æ“ä½œï¼ˆå¹¶ä¸”æ ¹æ®æ–‡æ¡£æä¾›çš„ä½¿ç”¨æ–¹æ³•æ­¥éª¤è¿›è¡Œæ“ä½œï¼‰ https://github.com/mongodb/node-mongodb-native ï¼ˆnewï¼‰https://docs.mongodb.com/drivers/node/current/fundamentals/connection/ CRUD const { MongoClient } = require(\"mongodb\"); // Connection URI const uri = \"mongodb://127.0.0.1:27017/\"; // Create a new MongoClient const client = new MongoClient(uri); async function run() { try { // Connect the client to the server await client.connect(); const db = client.db(\"cartoon\"); //æ•°æ®åº“åå­— const Result = await db .collection(\"bookss\") //é›†åˆåè¯ .find({}) .limit(3) .toArray(); console.log(Result); } finally { // Ensures that the client will close when you finish/error await client.close(); } } run().catch(console.dir); æ–¹æ³•äºŒï¼šä½¿ç”¨ç¬¬ä¸‰æ–¹mongooseæ¥æ“ä½œ MongoDBæ•°æ®åº“ 5.Mongoosehttps://mongoosejs.com/ Mongooseæ˜¯åœ¨nodejså¼‚æ­¥ç¯å¢ƒä¸‹å¯¹MongoDBè¿›è¡Œä¾¿æ·æ“ä½œçš„å¯¹è±¡æ¨¡å‹å·¥å…·ï¼ŒMongooseæ˜¯NodeJSçš„é©±åŠ¨ï¼Œä¸èƒ½ä½œä¸ºå…¶ä»–è¯­è¨€çš„é©±åŠ¨ ï¼ˆmongooseæ‰€æœ‰apiéƒ½æ”¯æŒpromiseï¼Œnpmä¸‹è½½çš„æ—¶å€™ç›´æ¥ä¸‹è½½mongooseå°±å¥½äº†ï¼Œä¸ç”¨ä¸‹mongodbï¼‰ npm i mongoose --save ä»¥ä¸‹ä»£ç åœ¨mongooseå®˜ç½‘ä¹Ÿèƒ½æŸ¥çœ‹åˆ° 1.å¼•åŒ… require(&#39;mongoose&#39;); =&gt; 2.è¿æ¥æ•°æ®åº“ mongoose.connect (æŒ‡å®šè¿æ¥çš„æ•°æ®åº“ä¸ä¸€å®šéœ€è¦å­˜åœ¨ï¼Œå½“ä½ æ’å…¥ç¬¬ä¸€æ¡æ•°æ®ä¹‹åå°±ä¼šè¢«è‡ªåŠ¨åˆ›å»ºå‡ºæ¥)=&gt; ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯è¿æ¥çš„æ•°æ®åº“ ç¬¬äºŒä¸ªå‚æ•°æ˜¯optionï¼Œmongodb4.0ä¹‹åï¼Œéƒ½éœ€è¦ä¼ å…¥ useNewUrlParser å‚æ•°ï¼Œä¼šè¯†åˆ«urlé‡Œç”¨æˆ·æ‰€éœ€çš„dbï¼Œä¸ä¼ å…¥ä¼šæŠ¥è­¦å‘Šï¼Œè€Œ useUnifiedTopology æ˜¯ä½¿ç”¨ä¸€ä¸ªç»Ÿä¸€çš„æ‹“æ‰‘ç»“æ„ ç¬¬ä¸‰ä¸ªå‚æ•°å¯ä¼ å…¥ä¸€ä¸ªå›è°ƒå‡½æ•° fn ï¼Œå‘Šè¯‰ç”¨æˆ·ï¼šè¿æ¥æˆåŠŸ æ³¨æ„ï¼šMongooseServerSelectionError: connect ECONNREFUSED ::1:27017çš„é—®é¢˜å¯èƒ½æ˜¯ç”±äºnodeç‰ˆæœ¬å·å¯¼è‡´çš„ï¼Œè¯·æŸ¥çœ‹å½“å‰nodeç‰ˆæœ¬æ˜¯å¦å°äº17.0 3.åˆ›å»ºæ¨¡å‹mongoose.model(è¡¨å, æ•°æ®ç»“æ„)ï¼ˆè¿™é‡Œæ¨¡å‹åˆ›å»ºååˆ†çµæ´»ï¼Œåªéœ€è¦åœ¨ä»£ç ä¸­è®¾è®¡ä½ çš„æ•°æ®åº“å°±å¯ä»¥äº†ï¼‰ =&gt; 4.å®ä¾‹åŒ–æ¨¡å‹(new)ï¼Œå¹¶å°†æ¯ä¸ªå®ä¾‹åŒ–çš„æ•°æ®ä¿å­˜ save() åœ¨è¯¥æ¨¡å‹é›†åˆé‡Œ //demo.js // å¼•åŒ… const mongoose = require('mongoose'); //è¿æ¥MongoDBæ•°æ®åº“ï¼ˆè¿™é‡Œé¡ºä¾¿åˆ›å»ºäº†ä¸€ä¸ªå«testçš„æ•°æ®åº“ï¼‰ mongoose.connect('mongodb://localhost:27017/test', { useNewUrlParser: true, useUnifiedTopology: true }); //å¦‚æœæ•°æ®åº“è¦ç®¡ç†å‘˜è´¦å·å¯†ç ï¼Œåˆ™éœ€è¦ä»¥ä»¥ä¸‹æ–¹å¼è¿æ¥(è´¦æˆ·å:å¯†ç @) //mongoose.connect('mongodb://allen:123456@localhost:27017/test'); //åˆ›å»ºä¸€ä¸ªæ¨¡å‹ï¼Œè¯´ç™½äº†å°±æ˜¯åœ¨è®¾è®¡æ•°æ®åº“ //è¿™é‡Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯è¡¨åï¼šCatï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯æ•°æ®ç»“æ„ const Cat = mongoose.model('Cat', { name: String }); for (let i = 0; i &lt; 10; i++) { // å®ä¾‹åŒ–ä¸€ä¸ªCatï¼ˆå¾€catsé›†åˆé‡Œé¢æ’å…¥æ¯ä¸€ä¸ªkittyæ•°æ®ï¼‰ const kitty = new Cat({ name: 'Zildjian' }); // æŒä¹…åŒ–ä¿å­˜kittyå®ä¾‹ kitty.save().then(() => console.log('meow')); } è¿æ¥æœ¬åœ°çš„æ—¶å€™ï¼Œè¿æ¥åœ°å€å¯ä»¥åœ¨cmdä¸­è¾“å…¥mongoï¼Œç„¶åè¿™é‡Œä¼šçœ‹å¾—åˆ° è®¾è®¡æ–‡æ¡£ç»“æ„åœ¨ç¬¬3æ­¥åˆ›å»ºæ¨¡å‹ä¹‹å‰ï¼Œå…¶å®è¿˜å¯ä»¥ç‹¬ç«‹å¼€æ¥ï¼Œä½¿ç”¨Schemaè®¾ç½®æ–‡æ¡£ç»“æ„ï¼Œå®ƒä¼šæ˜ å°„åˆ°mongodbä¸­çš„ä¸€ä¸ªcollection è¿™ä¸ªSchemaæ˜¯mongooseå¯¹æ¯”mongodbçªå‡ºçš„ä¸€ä¸ªç‰¹ç‚¹ å­—æ®µåç§°å°±æ˜¯è¡¨ç»“æ„çš„å±æ€§åç§° çº¦æŸçš„ç›®çš„å°±æ˜¯ä¸ºäº†ä¿è¯æ•°æ®çš„å®Œæ•´æ€§ï¼Œä¸è¦æœ‰è„æ•°æ® var mongoose = require('mongoose'); var Schema = mongoose.Schema; mongoose.connect('mongodb://localhost:27017/test', { useNewUrlParser: true, useUnifiedTopology: true }); var userSchema = new Schema({ username: { type: String, required: true //è®¾ç½®è¯¥å±æ€§å¿…é¡»æœ‰é…ç½®ï¼Œä½¿ç”¨required }, password: { type: String, required: true }, email: { type: String }, other:{ type: String, default: 'noting' } }); ç„¶åå†ç”¨mongoose.model(è¡¨å, æ•°æ®ç»“æ„)å‘å¸ƒæ¨¡å‹ï¼Œæ­¤æ—¶æŠŠè¿™ä¸ªä¾‹å­ä¸­userSchemaæ”¾å…¥ç¬¬äºŒä¸ªå‚æ•°å³å¯ var User = mongoose.model('User', userSchema); ç¬¬ä¸€ä¸ªå‚æ•°ï¼šä¸ºä¼ å…¥ä¸€ä¸ªå¤§å†™å¼€å¤´çš„å­—ç¬¦ä¸²ï¼Œç”¨æ¥è¡¨ç¤ºä½ çš„æ–‡æ¡£åç§°ï¼Œè¿™ä¸ªæ¨¡å‹ä¼šå’Œæ¨¡å‹åç§°ç›¸åŒçš„å¤æ•°æ•°æ®åº“collectrionå»ºç«‹è¿æ¥ ç¬¬äºŒä¸ªä¼ çš„æ˜¯å¯¹æ–‡æ¡£çš„çº¦æŸï¼Œæ¶æ„Schema è¿™é‡Œæˆ‘ä»¬è§„å®šçš„é›†åˆè§„èŒƒä¸ºusers collectionï¼Œå› ä¸ºçš„Userçš„å¤æ•°å½¢å¼æ˜¯usersï¼Œå³é›†åˆçš„åç§° å½“ç„¶æˆ‘ä»¬è¿™é‡Œå¯ä»¥ä¼ å…¥ç¬¬ä¸‰ä¸ªå‚æ•°ï¼Œæ­¤æ—¶æˆ‘ä»¬å°±å¯ä»¥æŒ‡å®šé›†åˆï¼Œä¸ç”¨ä½¿ç”¨é»˜è®¤çš„é‚£ä¸ªç¬¬ä¸€ä¸ªå‚æ•°å¤æ•°å½¢å¼!å³é›†åˆåç§°çš„è§„èŒƒ var User = mongoose.model('User', userSchema, 'user'); //æˆ‘è¦å®šä¹‰user collectionçš„è§„èŒƒ! è¿”å›å€¼æ˜¯æ¨¡å‹æ„é€ å‡½æ•°ï¼Œæˆ‘ä»¬æœ‰äº†æ¨¡å‹æ„é€ å‡½æ•°ä¹‹åï¼Œå°±å¯ä»¥å¯¹usersé›†åˆæ•°æ®è¿›è¡Œæ“ä½œäº† æ“ä½œæ•°æ®ç¡®ä¿æ•°æ®åº“MongoDBè¢«æ‰“å¼€ï¼Œå¹¶ä¸”å†å¦å¤–ä¸€ä¸ªçª—å£è¿›è¡Œè¿æ¥ æ³¨æ„ï¼šmongooseå¢åŠ æ•°æ®æ˜¯ç»™ä½ è‡ªåŠ¨ç”Ÿæˆid å¢åŠ æ•°æ® åˆ©ç”¨è¿”å›çš„æ¨¡å‹æ„é€ å‡½æ•°ï¼Œnewä¸€ä¸ªå®ä¾‹å¯¹è±¡ï¼Œé¡ºä¾¿ä½¿ç”¨save()è¿›è¡Œä¿å­˜ let allen = new User({ username: 'allen', password: '123456', email: 'allen@qq.com' }); //retæ˜¯åˆšåˆšæ’å…¥çš„é‚£æ¡æ•°æ® allen.save((err, ret) => { if (err) { console.log('ä¿å­˜å¤±è´¥'); } else { console.log('ä¿å­˜æˆå…±'); console.log(ret); } }) æŸ¥è¯¢æ•°æ® æ¨¡å‹æ„é€ å‡½æ•°.find() æŸ¥è¯¢æ‰€æœ‰æ•°æ®ï¼Œretè¿”å›ä¸€ä¸ªæ•°ç»„ï¼Œè®°å½•é‡Œé¢çš„æ•°æ®ï¼ˆæ–‡æ¡£ï¼‰ User.find(function (err, ret) { if (err) { console.log('æŸ¥è¯¢å¤±è´¥'); } else { console.log(ret); } }); æ¡ä»¶æŸ¥è¯¢ï¼ŒæŸ¥è¯¢usernameä¸ºBruceçš„æ•°æ®(æŒ‰æ¡ä»¶æŸ¥æ‰¾ï¼Œretè¿”å›ä¸€ä¸ªæ•°ç»„ï¼Œè®°å½•é‡Œé¢çš„æ•°æ®ï¼ˆæ–‡æ¡£ï¼‰) User.find({ username: 'Bruce' }, function (err, ret) { if (err) { console.log('æŸ¥è¯¢å¤±è´¥'); } else { console.log(ret); } }); åªæ‰¾åˆ°ç¬¬ä¸€ä¸ªåŒ¹é…åˆ°çš„å¯¹è±¡ï¼ˆæ–‡æ¡£ï¼‰æ•°æ®ï¼Œretè¿”å›ä¸€ä¸ªå¯¹è±¡ User.findOne({ username: 'Bruce', password: '123456' }, function (err, ret) { if (err) { console.log('æŸ¥è¯¢å¤±è´¥'); } else { console.log(ret); } }); //promiseæ ¼å¼ï¼Œå› ä¸ºmongooseæ‰€æœ‰apiéƒ½æ”¯æŒpromise // User.findOne({ username: 'Bruce', password: '123456' }) // .then(data => { // console.log(data); // }, err => { // console.log('æŸ¥è¯¢å¤±è´¥'); // }) åˆ©ç”¨æˆ–ï¼Œæ»¡è¶³å…¶ä¸­ä¸€ä¸ªæ¡ä»¶æŸ¥è¯¢æˆåŠŸ User.findOne({ $or: [ { email: body.email }, { nickname: body.nickname } ] }, function (err, data) { if (err) { res.status(500).send('Server err'); }else { console.log(data) } }) åˆ é™¤æ•°æ® removeç°åœ¨ä¼¼ä¹å·²ç»åºŸå¼ƒäº†ï¼Œæ‰€ä»¥é‡‡ç”¨delete åˆ é™¤å•ä¸ªæ•°æ®ï¼Œåˆ é™¤æ¡ä»¶ä¸ºusername: &#39;Zildjian&#39;çš„æ•°æ® User.deleteOne({ name: 'Zildjian' }, function (err) { if (err) console.log('åˆ é™¤å¤±è´¥'); }); åˆ é™¤å¤šä¸ªï¼Œåˆ é™¤æ¡ä»¶ä¸ºusername: &#39;Zildjian&#39;çš„æ•°æ® User.deleteMany({ name: 'Zildjian' }, function (err) { if (err) console.log('åˆ é™¤å¤±è´¥'); }); æ ¹æ®idåˆ é™¤ï¼š findByIdAndDelete æ›´æ–°æ•°æ® updateOne ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºæŸ¥æ‰¾æ¡ä»¶ ç¬¬äºŒä¸ªå‚æ•°ä¸ºæ›´æ–°çš„æ•°æ® å›è°ƒå‡½æ•°èƒ½æŸ¥çœ‹æ›´æ”¹æ“ä½œæˆåŠŸä¸å¦ User.updateOne({name: 'Allen'},{name: 'hhhh'}, function (err, data) { if (err) { res.status(500).send('Server err'); }else { console.log(data) } }) æ ¹æ®idæ›´æ”¹æ•°æ® User.findByIdAndUpdate('60142a5acbcef341281a7d18', { password: '789456' }, function (err, ret) { if (err) console.log('æ›´æ–°å¤±è´¥'); else console.log('æ›´æ–°æˆåŠŸï¼'); }) è¿˜æœ‰å…¶ä»–æ›´æ–°æ•°æ®æ–¹æ³•å¯ä»¥åœ¨mongooseæ–‡æ¡£æŸ¥çœ‹ æ¨¡å—åŒ–//db.js var mongoose = require(\"mongoose\"); mongoose.connect( \"mongodb://localhost:27017/test\", { useNewUrlParser: true, useUnifiedTopology: true }, function (err) { if (err) { console.log(err); return; } console.log(\"æ•°æ®åº“è¿æ¥æˆåŠŸ\"); } ); module.exports = mongoose; //user.js const mongoose = require('./db') var Schema = mongoose.Schema; const userSchema = new Schema({ username: String, password: String }); var User = mongoose.model('User', userSchema, 'user'); module.exports = User æ­¤æ—¶æˆ‘ä»¬å°±å¯ä»¥åœ¨ä¸»ç›®å½•ä¸‹çš„app.jsä¸­å¯¼å…¥Userï¼Œä½¿ç”¨å®ƒçš„æ–¹æ³•ç›´æ¥æ“ä½œæ•°æ®åº“äº† 6.Mongooseå…¶ä»–é¢„å¤„ç†ä¿®é¥°ç¬¦å®šä¹‰æ–‡æ¡£ç»“æ„çš„ä¸€äº›æ¨¡å¼ä¿®é¥°ç¬¦ var userSchema = new Schema({ username: { type: String, trim: true, //è‡ªåŠ¨å»æ‰å·¦å³ç©ºæ ¼ lowercase: true, //è‡ªåŠ¨å»æ‰å·¦å³ç©ºæ ¼ uppercase: true, //è‡ªåŠ¨å»æ‰å·¦å³ç©ºæ ¼ }, password: { type: String, required: true }, }); é™¤æ­¤ä¹‹å¤–ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥è‡ªå®šä¹‰ä¿®é¥°ç¬¦ é€šè¿‡setï¼ˆå»ºè®®ä½¿ç”¨ï¼‰ä¿®é¥°ç¬¦åœ¨å¢åŠ æ•°æ®çš„æ—¶å€™è¿›è¡Œæ ¼å¼åŒ– é€šè¿‡getï¼ˆä¸å»ºè®®ä½¿ç”¨ï¼‰ä¿®é¥°ç¬¦åœ¨å®ä¾‹è·å–æ•°æ®çš„æ—¶å€™å¯¹æ•°æ®è¿›è¡Œæ ¼å¼åŒ– setï¼š const mongoose = require(\"./db\"); var Schema = mongoose.Schema; const focusSchema = new Schema({ title: String, pic: String, redirect: { type: String, set(params) { //å¢åŠ æ•°æ®çš„æ—¶å€™å¯¹redirectå­—æ®µè¿›è¡Œå¤„ç† // è¿™é‡Œçš„paramsæ˜¯redirectå¯¹åº”çš„å€¼ //è¿”å›çš„æ•°æ®ä¸ºæ•°æ®åº“å®é™…ä¿å­˜çš„å€¼ const rg = /^http(s?):\\/\\//; if (rg.test(params)) return params; return \"http://\" + params; }, }, }); var Focus = mongoose.model(\"Focus\", focusSchema, \"focus\"); module.exports = Focus; const Focus = require(\"./model/focus\"); let allen = new Focus({ title: \"title\", pic: \"pic\", redirect: \"netease.com\", }); //retæ˜¯åˆšåˆšæ’å…¥çš„é‚£æ¡æ•°æ® allen.save((err, ret) => { if (err) { console.log(\"ä¿å­˜å¤±è´¥\"); } else { console.log(\"ä¿å­˜æˆåŠŸ\"); console.log(ret); //redirect: 'https://netease.com', } }); getï¼šä½¿ç”¨getæ–¹æ³•ä¹‹åçš„ç»“æœï¼ˆæ„Ÿè§‰æ²¡å•¥ç”¨å¤„ã€‚ã€‚ï¼‰ /*pic: { type: String, get(params) { return \"001\" + params; }, },*/ const Focus = require(\"./model/focus\"); let allen = new Focus({ title: \"title\", pic: \"pic\", redirect: \"netease.com\", }); console.log(allen.title, allen.pic) //title, 001pic mongooseç´¢å¼•ä½¿ç”¨æˆ‘ä»¬å¯ä»¥åœ¨Schemaï¼ˆæ–‡æ¡£çº¦æŸç»“æ„ï¼‰ä¸­ç›´æ¥åˆ¶å®šç´¢å¼• uniqueä¸ºè®¾ç½®å”¯ä¸€ç´¢å¼• indexä¸ºè®¾ç½®æ™®é€šç´¢å¼• const userSchema = new mongoose.Schema({ username: { type: String, unique: true }, password: { type: String, index: true } }); mongooseæ‰©å±•é™æ€ | å®ä¾‹æ–¹æ³•å®é™…æƒ…å†µæ‰©å±•é™æ€æ–¹æ³•ç”¨çš„æ¯”è¾ƒå¤š const userSchema = new mongoose.Schema({ //... }); // é™æ€æ–¹æ³• userSchema.statics.fn1 = function(id, cb){ this.find({\"id\": id}, function(err, dos){ cb(err, dos) }) } // å®ä¾‹æ–¹æ³• userSchema.mehods.fn2 = function(){ //... } const User = mongoose.model('User', userSchema); è°ƒç”¨æ–¹å¼ User.fn1(123, function(){ //... }) let allen = new User({ username: 'allen', password: '123456', email: 'allen@qq.com' }); allen.fn2() 7.Aboutæ•°æ®åº“åŸºç¡€çŸ¥è¯†äº‹åŠ¡ï¼šæ˜¯æ•°æ®åº“æ“ä½œçš„æœ€å°å·¥ä½œå•å…ƒï¼Œæ˜¯ä½œä¸ºå•ä¸ªé€»è¾‘å·¥ä½œå•å…ƒæ‰§è¡Œçš„ä¸€ç³»åˆ—æ“ä½œï¼›è¿™äº›æ“ä½œä½œä¸ºä¸€ä¸ªæ•´ä½“ä¸€èµ·å‘ç³»ç»Ÿæäº¤ï¼Œè¦ä¹ˆéƒ½æ‰§è¡Œã€è¦ä¹ˆéƒ½ä¸æ‰§è¡Œï¼›äº‹åŠ¡æ˜¯ä¸€ç»„ä¸å¯å†åˆ†å‰²çš„æ“ä½œé›†åˆï¼ˆå·¥ä½œé€»è¾‘å•å…ƒï¼‰ï¼› æ•°æ®åº“çš„äº‹åŠ¡ç‰¹æ€§æœ‰ï¼šåŸå­æ€§ã€ä¸€è‡´æ€§ã€æŒä¹…æ€§ã€éš”ç¦»æ€§ A atomicity åŸå­æ€§ æŒ‡çš„æ˜¯äº‹åŠ¡åŒ…å«çš„æ‰€æœ‰æ“ä½œï¼Œè¦ä¹ˆå…¨éƒ¨æˆåŠŸï¼Œè¦ä¹ˆå…¨éƒ¨å›æ»šå¤±è´¥ï¼ˆè¦ä¹ˆéƒ½åšï¼Œè¦ä¹ˆéƒ½ä¸åšï¼‰ C consistency ä¸€è‡´æ€§ æŒ‡çš„æ˜¯äº‹åŠ¡å¿…é¡»ä½¿æ•°æ®åº“ä»ä¸€ä¸ªä¸€è‡´æ€§çŠ¶æ€åˆ°å¦ä¸€ä¸ªä¸€è‡´æ€§çŠ¶æ€ï¼Œå³äº‹åŠ¡æ‰§è¡Œå‰åå…¨éƒ¨å¤„äºä¸€è‡´æ€§çŠ¶æ€ I isolation éš”ç¦»æ€§ æŒ‡çš„æ˜¯å¤šä¸ªå¹¶å‘äº‹ç‰©é—´äº’ç›¸éš”ç¦»ï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ªäº‹åŠ¡æ‰§è¡Œçš„è¿‡ç¨‹ä¸­,ä¸åº”è¯¥å—åˆ°å…¶ä»–äº‹åŠ¡çš„å¹²æ‰° D durability æŒä¹…æ€§ æŒ‡çš„æ˜¯äº‹åŠ¡ä¸€æ—¦æäº¤äº†ï¼Œé‚£ä¹ˆå¯¹æ•°æ®åº“ä¸­æ•°æ®çš„ä¿®æ”¹å°±æ˜¯æ°¸ä¹…æ€§çš„ï¼Œå³ä¾¿åœ¨æ•°æ®åº“ç³»ç»Ÿé‡åˆ°æ•…éšœçš„æƒ…å†µä¸‹ä¹Ÿä¸ä¼šä¸¢å¤±æäº¤äº‹åŠ¡çš„æ“ä½œ è„è¯»ï¼šå°±æ˜¯æ²¡æœ‰æäº¤çš„æ•°æ®ï¼Œä¸¾ä¸ªä¾‹å­ï¼šæ¯”å¦‚æŸä¸ªäº‹åŠ¡åœ¨å¯¹æ•°æ®åº“ä¸­æŸæ¡è®°å½•è¿›è¡Œä¿®æ”¹ï¼Œä¿®æ”¹åæ²¡æœ‰æäº¤ä¹Ÿæ²¡æœ‰å›æ»šï¼Œä¹Ÿå°±æ˜¯è®©å…¶å¤„äºä¸€ä¸ªå¾…å®šçš„çŠ¶æ€ï¼Œè¿™ä¸ªæ—¶å€™å¦‚æœæœ‰å…¶ä»–çš„äº‹åŠ¡æ¥å…ˆä¸€æ­¥å¯¹è¿™æ¡è®°å½•è¿›è¡Œè¯»å–æˆ–è€…å¤„ç†äº†çš„ç°è±¡ã€‚ ä¸å¯é‡å¤è¯»å–ï¼šä¸€ä¸ªäº‹åŠ¡å…ˆåè¯»å–æŸæ¡è®°å½•ï¼Œä½†åœ¨ä¸¤æ¬¡è¯»å–ä¹‹é—´è¯¥æ¡è®°å½•æ¯å…¶ä»–å¦ä¸€ä¸ªäº‹åŠ¡ç»™ä¿®æ”¹äº†ï¼Œå°±é€ æˆäº†ä¸¤æ¬¡è¯»å–çš„æ•°æ®ä¸åŒçš„ç°è±¡ã€‚ å¹»è¯»ï¼šå¹»è¯»å°±æ˜¯ä¸€ä¸ªäº‹åŠ¡æŒ‰ç…§æŸ¥è¯¢æ¡ä»¶æŸ¥è¯¢ä»¥å‰æ£€ç´¢è¿‡çš„æ•°æ®å¯æ˜¯å‘ç°è¯¥æ•°æ®è¢«å…¶ä»–äº‹åŠ¡æ’å…¥äº†æ»¡è¶³å…¶æŸ¥è¯¢æ¡ä»¶çš„æ–°æ•°æ®çš„ç°è±¡ã€‚ ä¸å¯é‡å¤è¯»å’Œè„è¯»çš„åŒºåˆ«æ˜¯ä¸€ä¸ªæ˜¯è¯»å–äº†å‰ä¸€äº‹åŠ¡æäº¤çš„æ•°æ®ï¼Œè€Œä¸€ä¸ªæ˜¯è¯»å–äº†å¦ä¸€ä¸ªäº‹åŠ¡æœªæäº¤çš„æ•°æ® å¹»è¯»å’Œä¸å¯é‡å¤è¯»ä¸åŒçš„æ˜¯ï¼Œå¹»è¯»é’ˆå¯¹çš„æ˜¯æ•°æ®æ¡æ•°çš„å˜åŒ– æ˜æ–‡å’Œå¯†æ–‡æ˜æ–‡æ”¾å¯†ç çš„å±é™© æ•°æ®åº“ä¸€æ—¦è¢«æ”»ç ´ï¼Œæˆ–è€…è¢«é»‘å®¢è„±åº“ï¼Œæ‰€æœ‰ä¿¡æ¯éƒ½è¢«æ³„éœ² æ•°æ®åº“ç®¡ç†å‘˜â€œå¿ƒæ€€ä¸è½¨â€ å¯†æ–‡ï¼šæ˜æ–‡ç»è¿‡åŠ å¯†ä¹‹åè¾“å‡ºçš„ç»“æœ åªè¦åŠ å¯†çš„æ˜¯åŒä¸€ä¸ªæ˜æ–‡ï¼Œåˆ™è¾“å‡ºç»“æœç›¸åŒ å¯†æ–‡æ˜¯ä¸å¯ä»¥ä½ æƒ³è½¬æ¢ä¸ºæ˜æ–‡çš„ ç”¨æ³•æ˜¯åªå°†è¾“å…¥çš„è½¬æˆå¯†æ–‡ï¼Œç„¶åå¯¹å¯†æ–‡è¿›è¡Œå¯¹æ¯”å³å¯ åŠ å¯†æ–¹å¼ï¼šMD5ï¼ˆä¸»æµï¼‰ï¼Œsha1ï¼ˆå¾®ä¿¡ï¼Œä¸è¿‡ç°åœ¨ä¼°è®¡ç”¨sha2äº†ï¼‰ï¼Œè€Œå¤§å‚å¯èƒ½æ˜¯å…ˆäº¤ç»™md5åŠ å¯†ï¼Œç„¶åå†äº¤ç»™sha2åœ¨åŠ å¯†ä¸€æ¬¡ï¼Œç„¶åå†ä¾é è‡ªå·±çš„ç®—æ³•ï¼Œå†åŠ å¯†ä¸€æ¬¡ npm i md5 const md5 = require('md5') const miwen = md5(password) ä½†æ˜¯å¾€ä¸Šç™¾åº¦ä¸€ä¸‹æœ‰md5åœ¨çº¿è§£å¯†åŠŸèƒ½ï¼ä¸è¿‡è¿™ä¸ªè§£å¯†åŠŸèƒ½æ˜¯é å¤§æ•°æ®å †èµ·æ¥çš„ï¼Œå¦‚æœå¯†ç å¤æ‚ä¸€ç‚¹å¯èƒ½å°±è§£å¯†ä¸äº†ï¼ˆæƒŠå–œå“ˆå“ˆå“ˆï¼‰ https://www.cmd5.com/ æœ¬ç«™é’ˆå¯¹md5ã€sha1ç­‰å…¨çƒé€šç”¨å…¬å¼€çš„åŠ å¯†ç®—æ³•è¿›è¡Œåå‘æŸ¥è¯¢ï¼Œé€šè¿‡ç©·ä¸¾å­—ç¬¦ç»„åˆçš„æ–¹å¼ï¼Œåˆ›å»ºäº†æ˜æ–‡å¯†æ–‡å¯¹åº”æŸ¥è¯¢æ•°æ®åº“ï¼Œåˆ›å»ºçš„è®°å½•çº¦90ä¸‡äº¿æ¡ï¼Œå ç”¨ç¡¬ç›˜è¶…è¿‡500TBï¼ŒæŸ¥è¯¢æˆåŠŸç‡95%ä»¥ä¸Šï¼Œå¾ˆå¤šå¤æ‚å¯†æ–‡åªæœ‰æœ¬ç«™æ‰å¯æŸ¥è¯¢ã€‚è‡ª2006å¹´å·²ç¨³å®šè¿è¡Œåä½™å¹´ï¼Œå›½å†…å¤–äº«æœ‰ç››èª‰ã€‚ 2004å¹´ï¼Œè¯å®MD5ç®—æ³•æ— æ³•é˜²æ­¢ç¢°æ’ï¼ˆcollisionï¼‰ï¼Œå› æ­¤ä¸é€‚ç”¨äºå®‰å…¨æ€§è®¤è¯ npm i sha1 const sha1 = require('sha1') const miwen = sha1(password) ä½†æ˜¯å¯¹äºå¼±å£ä»¤å¯†ç ï¼Œå¾€ä¸Šè¿˜æ˜¯å¯ä»¥æŸ¥è¯¢æŸ¥å¾—å‡ºæ¥","categories":[{"name":"å‰ç«¯","slug":"å‰ç«¯","permalink":"https://taylor12138.github.io/categories/%E5%89%8D%E7%AB%AF/"}],"tags":[],"author":"Hello"},{"title":"ç®—æ³•çŸ¥è¯†","slug":"ç®—æ³•çŸ¥è¯†","date":"2022-01-26T12:00:23.951Z","updated":"2022-01-26T12:00:23.951Z","comments":true,"path":"2022/01/26/suan-fa-zhi-shi/","link":"","permalink":"https://taylor12138.github.io/2022/01/26/suan-fa-zhi-shi/","excerpt":"","text":"åˆ¤æ–­é“¾è¡¨æ˜¯å¦æœ‰ç¯ä½¿ç”¨å¿«æ…¢æŒ‡é’ˆï¼Œå½“ä»–ä»¬ç›¸é‡æ—¶ï¼Œåˆ™æœ‰ç¯ bool IsExitsLoop(slist *head) { slist *slow = head, *fast = head; while ( fast && fast->next ) { slow = slow->next; fast = fast->next->next; if ( slow == fast ) break; } return !(fast == NULL || fast->next == NULL); } æ‰¾åˆ°ç¯çš„å…¥å£å‚è€ƒåšå®¢åœ°å€ï¼šhttp://www.cppblog.com/humanchao/archive/2012/11/12/47357.html å…¬å¼æ¨å¯¼ï¼š å¿«æŒ‡é’ˆç»è¿‡çš„è·¯å¾„ï¼š2s æ…¢æŒ‡é’ˆç»è¿‡çš„è·¯å¾„ï¼šs nrï¼šèµ°äº†nåœˆ å‡è®¾çœŸä¸ªé“¾è¡¨é•¿åº¦ä¸ºLï¼Œå…¥ç¯å£ä¸ç›¸é‡ç‚¹è·ç¦»ä¸ºxï¼Œèµ·ç‚¹åˆ°å…¥ç¯å£çš„è·ç¦»ä¸ºa åˆ™æœ‰ï¼š 2s = s + nr s = nr a + x = nr a + x = (n - 1)r + r = (n-1)r + L - a a = (n - 1)r + (L - a - x)ç”±å…¬å¼æ¨å¯¼å¯çŸ¥ï¼Œåªéœ€è¦æˆ‘ä»¬è®©ä¸¤ä¸ªæŒ‡é’ˆåˆ†åˆ«æŒ‡å‘èµ·ç‚¹å’Œç›¸é‡çš„ç‚¹ï¼Œæ¯æ¬¡åˆ†åˆ«nextèµ°ä¸€æ­¥ï¼Œåˆ™ä¸€å®šä¼šåœ¨å…¥ç¯ç‚¹ç›¸é‡ã€‚ æ±‚ç¯çš„å¤§å°åªéœ€è®©è¿™ä¸¤ä¸ªå¿«æ…¢æŒ‡é’ˆï¼Œç»§ç»­åœ¨ç¯é‡Œé¢èµ°ï¼Œå†æ¬¡ç›¸é‡æ—¶ï¼Œæ‰€èµ°çš„æ­¥æ•° = ç¯çš„é•¿åº¦ èƒŒåŒ…é—®é¢˜01èƒŒåŒ…æ±‚æœ€å¤§å€¼ xè½´ä»£è¡¨bagçš„å®¹é‡æå‡ï¼Œyè½´ä»£è¡¨ä¸åŒç‰©ä½“çš„åºå· ç‰©å“å®šä¹‰ï¼š int w[5] = { 0 , 2 , 3 , 4 , 5 }; //å•†å“çš„ä½“ç§¯2ã€3ã€4ã€5 int v[5] = { 0 , 3 , 4 , 5 , 6 }; //å•†å“çš„ä»·å€¼3ã€4ã€5ã€6 int bagV = 8; //èƒŒåŒ…å¤§å° çŠ¶æ€è½¬ç§»æ–¹ç¨‹ï¼š for (int i = 1; i","categories":[{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"https://taylor12138.github.io/categories/%E7%AE%97%E6%B3%95/"}],"tags":[],"author":"Hello"},{"title":"çº¢å®ä¹¦å•ƒè¯»note(ä¸‹)","slug":"çº¢å®ä¹¦å•ƒè¯»note(ä¸‹)","date":"2021-12-20T04:37:38.669Z","updated":"2021-12-20T04:37:38.669Z","comments":true,"path":"2021/12/20/hong-bao-shu-ken-du-note-xia/","link":"","permalink":"https://taylor12138.github.io/2021/12/20/hong-bao-shu-ken-du-note-xia/","excerpt":"","text":"ç¬¬12ç« BOMBOMæ ¸å¿ƒæ˜¯windowå¯¹è±¡ï¼Œwindowå¯¹è±¡åœ¨æµè§ˆå™¨æœ‰åŒé‡èº«ä»½ï¼Œä¸€ä¸ªæ˜¯ECMAScriptçš„Globalå¯¹è±¡ï¼Œä¸€ä¸ªå°±æ˜¯æµè§ˆå™¨çª—å£çš„JavaScriptæ¥å£ã€‚ çª—å£å…³ç³» topå¯¹è±¡å§‹ç»ˆæŒ‡å‘æœ€ä¸Šå±‚çª—å£ï¼Œå³æµè§ˆå™¨çª—å£æœ¬èº« parentå¯¹è±¡å§‹ç»ˆæŒ‡å‘å½“å‰çª—å£çš„çˆ¶çª—å£ï¼Œå¦‚æœå½“å‰çª—å£æ˜¯æœ€ä¸Šå±‚çª—å£ï¼Œåˆ™parent = top selfå¯¹è±¡å§‹ç»ˆæŒ‡å‘windowï¼Œæ˜¯windowçš„ç»ˆæå±æ€§ï¼Œå®é™…ä¸Šselfå’Œwindowå°±æ˜¯åŒä¸€å¯¹è±¡ï¼Œæš´éœ²selfæ˜¯ä¸ºäº†å’Œtopã€parentä¿æŒä¸€è‡´ å¯¼èˆªå’Œæ‰“å¼€æ–°çª—å£ window.open()ç”¨äºå¯¼èˆªåˆ°æŒ‡å®šçš„URLï¼Œåˆ†åˆ«æ¥å—å››ä¸ªå‚æ•°ï¼Œè¿”å›ä¸€ä¸ªå¯¹æ–°å»ºçª—å£çš„å¼•ç”¨ åŠ è½½çš„URL ç›®æ ‡çª—å£ å¦‚æœä¸æ˜¯å·²æœ‰çª—å£ï¼Œåˆ™ä¼šæ‰“å¼€ä¸€ä¸ªæ–°çš„çª—å£æˆ–æ ‡ç­¾é¡µ ç‰¹æ€§å­—ç¬¦ä¸²ï¼ˆé…ç½®ï¼‰ ä»¥é€—å·åˆ†éš”ï¼Œè®¾ç½®å­—ç¬¦ä¸² æ¯”å¦‚fullscreenï¼Œè¡¨ç¤ºçª—å£æ˜¯å¦æœ€å¤§åŒ–ï¼›heightï¼Œæ–°çª—å£çš„é«˜åº¦ æ–°çª—å£åœ¨æµè§ˆå™¨å†å²è®°å½•ä¸­æ˜¯å¦æ›¿ä»£å½“å‰åŠ è½½é¡µçš„å¸ƒå°”å€¼ï¼ˆé€šå¸¸ä¸ä¼ è¿™ä¸ªå‚æ•°ï¼‰ let wroxWin = window.open(\"https//www.wrox.com/\", \"wroxWindow\", \"height=400, width=400, top=10, left=10, resizable=yes\") è€Œå¼¹å‡ºçª—å£æœ‰ç‚¹æ—¶é—´è¢«åœ¨çº¿å¹¿å‘Šç”¨æ»¥äº†ï¼Œäºæ˜¯ï¼ŒIE7ä¹‹åã€Firefoxã€Operaç­‰å¼€å§‹å¼¹çª—æ–½åŠ é™åˆ¶ï¼›æ­¤å¤–ç½‘é¡µåŠ è½½è¿‡ç¨‹ä¸­è°ƒç”¨window.open()æ²¡æœ‰æ•ˆæœï¼Œè€Œä¸”å¯èƒ½å¯¼è‡´å‘ç”¨æˆ·æ˜¾ç¤ºé”™è¯¯ï¼Œå¼¹çª—é€šå¸¸å¯èƒ½åœ¨é¼ æ ‡ç‚¹å‡»æˆ–æŒ‰ä¸‹é”®ç›˜ä¸­çš„æŸä¸ªé”®æ‰èƒ½æ‰“å¼€ã€‚ å¼¹çª—å±è”½ï¼šæ‰€æœ‰ç°ä»£æµè§ˆå™¨éƒ½å†…ç½®äº†å±è”½å¼¹çª—çš„ç¨‹åºï¼Œå¦‚æœæ˜¯æµè§ˆå™¨å†…ç½®çš„å¼¹çª—å±è”½ç»„ç»‡äº†å¼¹çª—ï¼Œé‚£ä¹ˆ window.open()è¿”å›null let wroxWin = window.open(\"https//www.wrox.com\", \"_blank\"); if (wroxWin == null) { alert(\"The popup was block\") } å¦‚æœæ˜¯æµè§ˆå™¨æ‹“å±•æˆ–è€…å…¶ä»–ç¨‹åºå±è”½å¼¹çª—æ—¶ï¼Œwindow.open()é€šå¸¸ä¼šæŠ›å‡ºé”™è¯¯ ç³»ç»Ÿå¯¹è¯æ¡† console.log() alert() confirm() ï¼Œæœ‰ç‚¹åƒalert()ï¼Œä½†æ˜¯ç¡®è®¤æ¡†æœ‰ä¸¤ä¸ªæŒ‰é’® Cancelã€OKï¼Œè¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ prompt()ï¼Œæœ‰ç‚¹åƒ confirm()çš„å‡çº§ç‰ˆï¼Œè¿˜å¤šäº†ä¸€ä¸ªæ–‡æœ¬æ¡†è®©ç”¨æˆ·è¾“å…¥ï¼Œpromptä¼šè¿”å›æ–‡æœ¬æ¡†ä¸­çš„å€¼ ç¬¬13ç« å®¢æˆ·ç«¯çš„æ£€æµ‹ç”¨æˆ·ä»£ç†æ£€æµ‹é€šè¿‡æµè§ˆå™¨çš„ç”¨æˆ·ä»£ç†å­—ç¬¦ä¸²ç¡®å®šä½¿ç”¨çš„æ˜¯ä»€ä¹ˆæµè§ˆå™¨ã€‚ç”¨æˆ·ä»£ç†å­—ç¬¦ä¸²åŒ…å«åœ¨æ¯ä¸ªHTTPè¯·æ±‚å¤´éƒ¨ï¼Œåœ¨JavaScriptä¸­å¯ä»¥é€šè¿‡ navigator.userAgentè®¿é—®ã€‚ åœ¨æœåŠ¡å™¨ç«¯ï¼Œå¸¸è§çš„åšæ³•æ˜¯æ ¹æ®æ¥æ”¶åˆ°çš„ç”¨æˆ·ä»£ç†å­—ç¬¦ä¸²ç¡®å®šæµè§ˆå™¨å¹¶æ‰§è¡Œç›¸åº”çš„æ“ä½œã€‚è€Œåœ¨å®¢æˆ·ç«¯ï¼Œç”¨æˆ·ä»£ç†æ£€æµ‹è¢«è®¤ä¸ºæ˜¯ä¸å¯é çš„ï¼ˆå­—ç¬¦ä¸²å¯ä»¥é€ å‡ï¼‰ã€‚ æœ¬æ¥ userAgentæ˜¯ä¸€ä¸ªåªè¯»å±æ€§ console.log(window.navigator.userAgent); window.navigator.userAgent = 'foobar'; //æ— æ•ˆ ä¸è¿‡ï¼Œé€šè¿‡ç®€å•çš„æ–¹æ³•å¯ä»¥ç»•è¿‡è¿™ä¸ªé™åˆ¶ï¼Œæ¯”å¦‚æœ‰äº›æµè§ˆå™¨æä¾›ä¼ªç§æœ‰çš„ __defineGetter__æ–¹æ³•ï¼Œåˆ©ç”¨å®ƒå¯ä»¥ç¯¡æ”¹ç”¨æˆ·ä»£ç†å­—ç¬¦ä¸²ã€‚ console.log(window.navigator.userAgent); window.navigator.__defineGetter__('userAgent', () => 'foobar'); //æ— æ•ˆ ç¬¬14ç« DOMå¾—åˆ°çš„æ˜¯å½“å‰èŠ‚ç‚¹åœ¨åŒä¸€çˆ¶èŠ‚ç‚¹ä¸‹çš„å…„å¼ŸèŠ‚ç‚¹: node.previousSiblingå’Œ node.nextSibling æ˜¯å¦æœ‰å­©å­èŠ‚ç‚¹ï¼š hasChildNodes() cloneNode()ï¼šä¼šè¿”å›ä¸è°ƒç”¨å®ƒçš„èŠ‚ç‚¹ä¸€æ¨¡ä¸€æ ·çš„èŠ‚ç‚¹ï¼Œè¯¥æ–¹æ³•æ¥æ”¶ä¸€ä¸ªå¸ƒå°”å€¼å‚æ•°ï¼Œè¡¨ç¤ºæ˜¯å¦æ·±å¤åˆ¶ æ·±å¤åˆ¶ä¼šå¤åˆ¶èŠ‚ç‚¹åŠå…¶æ•´ä¸ªå­DOMæ ‘ï¼Œå¦‚æœä¼ å…¥falseï¼Œåˆ™åªä¼šå¤åˆ¶è°ƒç”¨è¯¥æ–¹æ³•çš„èŠ‚ç‚¹ã€‚ æ³¨æ„ï¼šæ­¤æ–¹æ³•å¹¶ä¸ä¼šå¤åˆ¶JavaScriptå±æ€§ï¼Œåªå¤åˆ¶äº†htmlå±æ€§ document.URLå–å¾—å½“å‰é¡µé¢çš„å®Œæ•´URL document.domainå–å¾—å½“å‰é¡µé¢çš„åŸŸåï¼Œæµè§ˆå™¨å¯¹domainå±æ€§è¿˜æœ‰ä¸€ä¸ªé™åˆ¶ï¼Œå°±æ˜¯è¿™ä¸ªå±æ€§ä¸€æ—¦æ”¾æ¾å°±ä¸èƒ½å†æ”¶ç´§ï¼Œæ¯”å¦‚æŠŠdocument.domainè®¾ç½®æˆAï¼Œå°±ä¸èƒ½å†è®¾ç½®æˆBäº† document.domain = 'baidu.com'; document.domain = 'google.com'; //æ”¶ç´§ï¼Œé”™è¯¯ document.referrerå–å¾—æ¥æº element.attributesè·å–å½“å‰å…ƒç´ æ‰€æœ‰å±æ€§ï¼Œä»–æœ€æœ‰ç”¨çš„åœºæ™¯æ˜¯éœ€è¦è¿­ä»£å…ƒç´ ä¸Šæ‰€æœ‰å±æ€§çš„æ—¶å€™ï¼Œè¿™æ—¶å€™å¾€å¾€æ˜¯è¦æŠŠDOMç»“æ„åºåˆ—åŒ–ä¸ºXMLæˆ–HTMLå­—ç¬¦ä¸²ã€‚ function output(element){ let pairs = []; let len = element.attributes.length; for(let i = 0; i &lt; len; i++) { const attribute = element.attributes[i]; pairs.push(`${attribute.nodeName} = ${attribute.nodeValue}`) } return pairs.join(''); } ç”¨ innerHTMLåˆ›å»ºçš„ scriptæ ‡ç­¾æ°¸è¿œä¸ä¼šè¢«æ‰§è¡Œ é€»è¾‘ä¸Šå¯ä»¥åœ¨JSä¿®æ”¹CSSä»£ç (é™¤äº†IE) let style = document.createElement('style'); style.appendChild(document.createTextNode(\"body{background-color: red}\")) ç†è§£NodeListã€HTMLCollectionã€NamedNodeMapæ˜¯ç†è§£DOMç¼–ç¨‹çš„å…³é”®ï¼Œè¿™ä¸‰ä¸ªé›†åˆéƒ½æ˜¯å®æ—¶çš„ï¼Œæ„å‘³ç€å®ƒä»¬çš„å€¼éƒ½æ˜¯â€œæœ€æ–°çš„â€ MutationObserveræ¥å£ï¼šè§‚å¯Ÿå…ƒç´ å±æ€§ã€å­èŠ‚ç‚¹ã€æ–‡æœ¬æˆ–è€…å‰ä¸‰è€…ä»»æ„ç»„åˆçš„å˜åŒ– let observer = new MutationObserver(() => console.log('&lt;body> attributes changed')); observer.observe(document.body, {attributes: true}); æ‰§è¡Œä»¥ä¸Šä»£ç ä¹‹åï¼Œbodyå…ƒç´ ä»»ä½•å±æ€§å˜åŒ–éƒ½ä¼šè§¦å‘å›è°ƒ å®ƒæ¥å—ä¸€ä¸ªMutationRecordæ•°ç»„ï¼Œä¿å­˜ç€å˜åŒ–ä¿¡æ¯ let observer = new MutationObserver((mutationRecords) => console.log(mutationRecords)); é€šå¸¸åªè¦è¢«è§‚å¯Ÿå…ƒç´ ä¸è¢«åƒåœ¾å›æ”¶ï¼ŒMutationObserverçš„å›è°ƒéƒ½ä¼šç›¸åº”DOMå˜åŒ–äº‹ä»¶ï¼Œä»è€Œè¢«æ‰§è¡Œï¼Œè‹¥è¦æå‰ç»ˆæ­¢å›è°ƒï¼Œå¯ä»¥è°ƒç”¨ disconnect()æ–¹æ³• observer.disconnect() ä¸ªäººæ„Ÿè§‰å’Œ IntersectionObserver API æœ‰æ‰€å…³è” MutationObserverçš„åƒåœ¾å›æ”¶ï¼š MutationObserveræ‹¥æœ‰å¯¹è¦è§‚å¯Ÿçš„ç›®æ ‡ç»“ç‚¹çš„å¼±å¼•ç”¨ï¼Œå› ä¸ºæ˜¯å¼±å¼•ç”¨ï¼Œæ‰€ä»¥ä¸ä¼šå¦¨ç¢åƒåœ¾å›æ”¶ç¨‹åºå›æ”¶ç›®æ ‡èŠ‚ç‚¹ ç„¶è€Œç›®æ ‡èŠ‚ç‚¹å¯¹ MutationObserveræœ‰å¼ºå¼•ç”¨ï¼Œå¦‚æœç›®æ ‡èŠ‚ç‚¹ä»DOMè¢«ç§»é™¤ï¼Œéšåè¢«åƒåœ¾å›æ”¶ï¼Œåˆ™å…³è”çš„ MutationObserverä¹Ÿä¼šè¢«åƒåœ¾å›æ”¶ ç¬¬17ç« äº‹ä»¶ä½¿ç”¨clickäº‹ä»¶æ‰§è¡Œä»£ç ï¼Œæœ‰äººè®¤ä¸ºï¼Œæ¢æˆmousedownæ‰§è¡Œä»£ç åº”ç”¨ç¨‹åºä¼šæ›´å¿«ï¼Œä½†æ˜¯å¯¹äºéšœç¢ç”¨æˆ·ä½¿ç”¨çš„å±å¹•é˜…è¯»å™¨ä¸Šï¼Œä¼šå¯¼è‡´ä»£ç æ— æ³•æ‰§è¡Œï¼Œå› ä¸ºå±å¹•é˜…è¯»å™¨æ— æ³•è§¦å‘mousedownäº‹ä»¶ oncontextmanuäº‹ä»¶é»˜è®¤åœ¨ç½‘é¡µå‡ºç°ç‚¹å‡»é¼ æ ‡å³é”®å¼¹å‡ºä¸Šä¸‹æ–‡èœå• contextmenuäº‹ä»¶å†’æ³¡ï¼Œå› æ­¤åªè¦ç»™documentæŒ‡å®šä¸€ä¸ªäº‹ä»¶å¤„ç†ç¨‹åºå°±å¯ä»¥å¤„ç†é¡µé¢ä¸Šçš„æ‰€æœ‰åŒç±»äº‹ä»¶ è¿™ä¸ªæ—¶é—´å¯ä»¥åœ¨æ‰€æœ‰æµè§ˆå™¨ä¸­å–æ¶ˆï¼Œå³ä½¿ç”¨event.preventDefault hashchangeäº‹ä»¶ï¼šç”¨äºURLæ•£åˆ—å€¼ï¼ˆ#åé¢éƒ¨åˆ†å‘ç”Ÿæ”¹å˜è€Œå›è°ƒçš„äº‹ä»¶ï¼‰ hashchangeäº‹ä»¶å¤„ç†å¿…é¡»äº¤ä»˜ç»™windowï¼Œï¼Œå®ƒçš„eventå¯¹è±¡æœ‰ä¸¤ä¸ªæ–°å±æ€§ï¼šoldURLã€newURL ç¬¬19ç« è¡¨å•è„šæœ¬è¡¨å•å¯ä»¥é€šè¿‡æŒ‰é’®æäº¤è¡¨å•ï¼Œä¹Ÿå¯ä»¥é€šè¿‡form.submit()æäº¤è¡¨å•ã€‚é€šè¿‡ submit()æäº¤è¡¨å•çš„æ—¶å€™ï¼Œsubmitäº‹ä»¶ä¸ä¼šè§¦å‘ï¼Œå› æ­¤åœ¨è°ƒç”¨è¿™ä¸ªæ–¹æ³•ä¹‹å‰è¦å…ˆåšæ•°æ®éªŒè¯ã€‚ è¡¨å•æäº¤çš„ä¸€ä¸ªæœ€å¤§çš„é—®é¢˜æ˜¯å¯èƒ½ä¼šæäº¤2æ¬¡è¡¨å•ã€‚å¦‚æœè¡¨å•æäº¤ä¹‹åæ²¡æœ‰ä»€ä¹ˆååº”ï¼Œé‚£ä¹ˆæ²¡æœ‰è€å¿ƒçš„ç”¨æˆ·å¯èƒ½ä¼šå¤šæ¬¡ç‚¹å‡»ï¼Œç»“æœé€ æˆæœåŠ¡å™¨å¤„ç†é‡å¤è¯·æ±‚ï¼Œç”šè‡³é€ æˆå¤šæ¬¡ä¸‹å•çš„ä¸¥é‡åæœï¼ è§£å†³æ–¹æ³•ï¼š1.æäº¤åç¦ç”¨æŒ‰é’®ï¼›2.é€šè¿‡onsubmitäº‹ä»¶å¤„ç†ç¨‹åºå–æ¶ˆä¹‹åçš„è¡¨å•æäº¤ åŒæ ·çš„ï¼Œä¹Ÿå¯ä»¥é€šè¿‡ form.reset()é‡ç½®è¡¨å•ï¼Œä½†æ˜¯ä¸submitä¸åŒçš„æ˜¯ï¼Œreset()æ–¹æ³•ä¼šåƒå•å‡»é‡ç½®æŒ‰é’®ä¸€æ ·è§¦å‘resetäº‹ä»¶ let form = document.getElementById(\"myForm\"); form.addEventListener(\"submit\", (e) => { let target = e.target; let btn = target.elements[\"submit-btn\"]; //nameå±æ€§ä¸ºsubmit-btnçš„åœ¨formå†…åµŒçš„æŒ‰é’® btn.disabled = true; }) æ³¨æ„è¿™ä¸ªåŠŸèƒ½ä¸èƒ½ç›´æ¥é€šè¿‡æäº¤æŒ‰é’®æ·»åŠ clickäº‹ä»¶æ¥å®ç°ï¼Œå› ä¸ºä¸åŒçš„æµè§ˆå™¨ä¸­è§¦å‘äº‹ä»¶çš„æ—¶é—´æ˜¯ä¸ä¸€æ ·çš„ï¼Œæœ‰äº›æµè§ˆå™¨æ˜¯è§¦å‘æ—¶æœºï¼šsubmit &gt; click ï¼›æœ‰ä¸€äº›æ˜¯ submit &lt; click9 è·¨æµè§ˆå™¨å¾—åˆ°/ è®¾ç½®å‰ªåˆ‡æ¿æ•°æ® function getClipboardText(event) { var clipboardData = (event.clipboardData || window.clipboardData); return clipboardData.get(\"text\"); } function setClipboardText(event, value) { if(event.clipboardData) { return event.clipboardData.setData(\"text/plain\", value); } else if (window.clipboardData) { return window.clip } } ç¬¬20ç« JavaScript APINotifications API ç”¨äºå‘ç”¨æˆ·æ˜¾ç¤ºé€šçŸ¥ï¼Œè¿™é‡Œçš„é€šçŸ¥å¾ˆåƒalert Notifications APIåˆè¢«æ»¥ç”¨çš„å¯èƒ½æ€§ï¼Œå› æ­¤ä¼šé»˜è®¤å¼€å¯ä¸¤é¡¹å®‰å…¨æªæ–½ é€šçŸ¥åªèƒ½åœ¨è¿è¡Œåœ¨å®‰å…¨ä¸Šä¸‹æ–‡çš„ä»£ç ä¸­è¢«è§¦å‘ é€šçŸ¥å¿…é¡»æŒ‰ç…§æ¯ä¸ªæºçš„åŸåˆ™æ˜ç¡®å¾—åˆ°ç”¨æˆ·å…è®¸ // è®¾ç½®é€šçŸ¥æƒé™ Notification.requestPermission() .then(permission => { console.log(permission); const n = new Notification(\"æˆ‘æ˜¯é€šçŸ¥ï¼Œæˆ‘åœ¨è¢«è°ƒç”¨\"); n.onshow = () => console.log('show'); n.onclick = () => console.log('click'); n.onclose = () => console.log('close'); n.onerror = () => console.log('error'); }) æ­¤é¡¹åŠŸèƒ½ä»…åœ¨å®‰å…¨ä¸Šä¸‹æ–‡(HTTPS), ä¸€äº› æ”¯æŒçš„æµè§ˆå™¨. æ‰¹é‡ç¼–ç ï¼Œé€šè¿‡ TextEncoder çš„å®ä¾‹å®Œæˆçš„ï¼Œè¯¥å®ä¾‹ä¸Šæœ‰ä¸€ä¸ª encodeæ–¹æ³•ï¼Œæ¥å—ä¸€ä¸ªå­—ç¬¦ä¸²å‚æ•°ï¼Œå¹¶ä»¥Uni8Arrayæ•…äº‹è¿”å›æ¯ä¸€ä¸ªå­—ç¬¦çš„UTF-8çš„ç¼–ç  const textEncoder = new TextEncoder(); const decodedText = 'foo' const encodedText = textEncoder.encode(decodedText); æ‹–æ”¾äº‹ä»¶ IE4æœ€æ—©åœ¨ç½‘é¡µä¸­æ”¯æŒå›¾ç‰‡å’Œæ–‡æœ¬çš„æ‹–æ”¾äº‹ä»¶ï¼ŒIE5ä¹‹åä¸æ–­æ‹“å±• ç°åœ¨æ‰€æœ‰ä¸»æµæµè§ˆå™¨éƒ½å®ç°äº†åŸç”Ÿçš„æ‹–æ”¾ï¼Œåœ¨æŸä¸ªå…ƒç´ è¢«æ‹–åŠ¨æ—¶ï¼Œä¼šæŒ‰é¡ºåºè§¦å‘ä»¥ä¸‹äº‹ä»¶ï¼ˆè¢«æ‹–åŠ¨å…ƒç´ çš„äº‹ä»¶ï¼‰ï¼šdragstartã€dragã€dragend dragstartè§¦å‘ä¹‹åï¼Œåªè¦ç›®æ ‡è¿˜åœ¨è¢«æ‹–åŠ¨å°±ä¼šä¸æ–­è§¦å‘dragäº‹ä»¶ï¼Œç±»ä¼¼äºmousemove -&gt; æ‹–åŠ¨åœæ­¢è§¦å‘dragend è‹¥æ˜¯æŠŠå…ƒç´ æ‹–åŠ¨åˆ°ç›®æ ‡ä¸Šï¼ˆæ”¾ç½®ä½ç½®æ‰€åœ¨å…ƒç´ çš„äº‹ä»¶ï¼‰ï¼Œåˆ™ä¾æ¬¡è§¦å‘ï¼šdragenterã€dragoverã€dragleave å¤§ç²¾åº¦æ—¶é—´ const t0 = Date.now(); foo(); const t1 = Date.now(); console.log(t1 - t1); Date.now()åªæœ‰æ¯«ç§’çº§åˆ«çš„ç²¾åº¦ï¼Œå¦‚æœfooæ‰§è¡Œçš„å¤Ÿå¿«ï¼Œåˆ™ä¸¤è€…æ—¶é—´æˆ³ä¼šç›¸ç­‰ å¯ä»¥ä½¿ç”¨ High Resolution Time API : Performance const t0 = performance.now(); const t1 = performance.now(); console.log(t1 - t1); templateæ¨¡æ¿ åœ¨æµè§ˆå™¨æ¸²æŸ“çš„æ—¶å€™ï¼Œä¸ä¼šå§templateçš„å†…å®¹æ¸²æŸ“åˆ°é¡µé¢ä¸Šï¼Œå®ƒä¸å±äºæ´»åŠ¨æ–‡æ¡£ï¼Œå®ƒæ˜¯DocumentFragmentã€‚ å®ƒæ˜¯æ‰¹é‡å‘HTMLæ·»åŠ å…ƒç´ çš„é«˜æ•ˆå·¥å…·ï¼Œä¸ç”¨ä¸€ä¸ªä¸€ä¸ª appendChild ã€‚å¯ä»¥çœ‹å¾—å‡ºVueã€Reactéƒ½æœ‰ä¸å®ƒæœ‰å¼‚æ›²åŒå·¥ä¹‹å¦™åœ¨å…¶ä¸­ å½±å­DOM ä¸»è¦è§£å†³ / ç”¨äº domæ ‘å»ºç«‹æ—¶èƒ½å¤Ÿå®ç°ç»´æŠ¤è‡ªèº«è¾¹ç•Œçš„é—®é¢˜ã€‚è¿™ä¹ˆè¯´æœ‰ç‚¹åƒvueçš„scopeä¿è¯è‡ªèº«ä¸ä¼šè¢«å¤–æ¥ä¿®é¥°å…¥ä¾µæˆ–è€…æ±¡æŸ“ã€‚ å½±å­domå°†å¯¹åº”çš„domä¿¡æ¯éšè—èµ·æ¥ä¾ç„¶èƒ½åœ¨htmlæ–‡æ¡£é‡Œæ¸²æŸ“å‡ºæ¥ã€‚ä½†ä¸èƒ½é€šè¿‡æ™®é€šçš„jsæ–¹æ³•è·å–åˆ°domä¿¡æ¯ å½±å­domäº‹ä»¶æ•è·éµä»å¸¸è§„domäº‹ä»¶ï¼Œåœ¨å½±å­domå†…éƒ¨ä¾ç„¶ä¼ é€’ï¼ŒåŒæ—¶ä¹Ÿéµä»äº‹ä»¶å†’æ³¡ï¼Œå‘æ•´ä¸ªæ–‡æ¡£çš„domä¸Šä¼ é€’äº‹ä»¶ã€‚ modeï¼šè¯¥å¼•ç”¨æ˜¯å¦å¯ä»¥è¢«è·å–ï¼Œopen/closedï¼Œä¸€èˆ¬æ²¡äººé€‰closed const foo = document.querySelector('#foo'); const bar = document.querySelector('#bar'); const = openShadowDOM = foo.attachShadow({mode: 'open'}); const = openShadowDOM2 = bar.attachShadow({mode: 'open'}); console.log(foo.shadowRoot); // shadow-root console.log(bar.shadowRoot); // null console.log(openShadowDOM); // shadow-root console.log(openShadowDOM2); // shadow-root åˆ©ç”¨å½±å­DOMåˆ›é€ ä¸‰ç§ä¸åŒé¢œè‰²å¾—div for(let color of ['red', 'green', 'blue']){ const div = document.createElement('div'); const shadowDOM = div.attachShadow({mode: 'open'}); document.body.appendChild(div); shadowDOM.innerHTML = ` &lt;p> Make me ${color}&lt;/p> &lt;style> p { color: ${color} } &lt;/style> ` } å½±å­DOMæ˜¯ä¸ºäº†è‡ªå®šä¹‰Webç»„ä»¶è®¾è®¡çš„ï¼Œå¯ä»¥ä½¿ç”¨slotæ’æ§½åµŒå¥—domç‰‡æ®µï¼ˆåœ¨å…¶ä¸­åŒæ ·å¯ä»¥çœ‹å¾—å‡ºslotåœ¨Vueã€Reactä¸­çš„åº”ç”¨ï¼‰ document.body.innerHTML = ` &lt;div id=\"foo\"> &lt;p>Foo&lt;/p> &lt;/div> `; document.querySelector('div') .attachShadow({ mode: 'open' }) .innerHTML = ` &lt;div id=\"bar\"> &lt;slot>&lt;/slot> &lt;/div> `; ç»“æœ &lt;div id=\"foo\"> #shadow-root(open) &lt;div id=\"bar\"> &lt;p>Foo&lt;/p> &lt;/div> &lt;/div> ç¬¬21ç« ï¼ˆé”™è¯¯å¤„ç†å’Œè°ƒè¯•ï¼‰finallyå­å¥ try/catchè¯­å¥ä¸­finallyå­å¥å§‹ç»ˆè¿è¡Œï¼Œtry/catchå—æ— æ³•é˜»æ­¢finallyå—æ‰§è¡Œï¼Œå³ä½¿æ˜¯returnè¯­å¥ function test(){ try { return 2; } catch { return 1; } finally { return 0; // å§‹ç»ˆè¿è¡Œï¼Œè¯¥å‡½æ•°å§‹ç»ˆè¿”å›0 } } try/catchè¯­å¥æœ€å¥½ç”¨åœ¨è‡ªå·±æ— æ³•æ§åˆ¶çš„é”™è¯¯ä¸Šï¼Œå‡è®¾ä½ çš„ä»£ç ä¸­ä½¿ç”¨äº†ä¸€ä¸ªå¤§å‹JavaScriptåº“æŸä¸ªå‡½æ•°ï¼Œè€Œè¯¥å‡½æ•°å¯èƒ½ä¼šæœ‰æ„æˆ–è€…å¤„äºé”™è¯¯è€ŒæŠ›å‡ºé”™è¯¯ã€‚å› ä¸ºä¸èƒ½ä¿®æ”¹è¿™ä¸ªåº“çš„ä»£ç ï¼Œå°±æœ‰å¿…è¦é€šè¿‡try / catch è¯­å¥è°ƒç”¨åŒ…è£…èµ·æ¥ï¼Œå¯¹å¯èƒ½çš„é”™è¯¯è¿›è¡Œå¤„ç†ã€‚ å¦‚æœä½ æ˜ç¡®åœ°çŸ¥é“è‡ªå·±çš„ä»£ç ä¼šå‘ç”ŸæŸç§é”™è¯¯ï¼Œé‚£ä¹ˆå°±ä¸é€‚åˆä½¿ç”¨try / catch è¯­å¥ erroräº‹ä»¶ ä»»ä½•æ²¡æœ‰è¢«try / catch æ‰å¤„ç†çš„é”™è¯¯éƒ½ä¼šåœ¨windowå¯¹è±¡ä¸Šè§¦å‘erroräº‹ä»¶ã€‚åœ¨onerroräº‹ä»¶å¤„ç†ç¨‹åºä¸­ï¼Œä»»ä½•æµè§ˆå™¨éƒ½ä¸ä¼šä¼ å…¥eventå¯¹è±¡ã€‚ç›¸åï¼Œä¼šä¼ å…¥ä¸‰ä¸ªå‚æ•°ï¼š é”™è¯¯ä¿¡æ¯ å‘ç”Ÿé”™è¯¯çš„url è¡Œå· window.onerror = (message, url, line) => { console.log(message); } æ³¨æ„ï¼šä¸åŒæµè§ˆå™¨åœ¨ä½¿ç”¨è¿™ä¸ªé”™è¯¯å¤„ç†äº‹ä»¶å­˜åœ¨æ˜æ˜¾çš„å·®å¼‚ è¿™ä¸ªäº‹ä»¶å¤„ç†åº”è¯¥æ˜¯æµè§ˆå™¨æŠ¥å‘Šé”™è¯¯çš„æœ€åä¸€é“é˜²çº¿ï¼Œç†æƒ³çŠ¶æ€ä¸‹ï¼Œæœ€å¥½ä¸è¦ç”¨åˆ°ï¼ˆmessageå…¶å®å°±æ˜¯æ§åˆ¶å°æ‰“å°çš„é”™è¯¯ç½¢äº†ï¼‰ æŠ›å‡ºé”™è¯¯ åœ¨å¤§å‹åº”ç”¨ç¨‹åºä¸­ï¼Œè‡ªå®šä¹‰é”™è¯¯é€šå¸¸åœ¨ä½¿ç”¨assert() å‡½æ•°æŠ›å‡ºé”™è¯¯ã€‚è¿™ä¸ªå‡½æ•°æ¥å—ä¸€ä¸ªåº”è¯¥ä¸ºtrueçš„æ¡ä»¶ï¼Œå¹¶åœ¨æ¡ä»¶ä¸ºfalseæ—¶æŠ›å‡ºé”™è¯¯ï¼Œä¸‹é¢æ˜¯ä¸€ä¸ªåŸºæœ¬çš„assertå‡½æ•° function assert(condition, msg) { if(!condition) { throw new Error(); } } ç¬¬23ç« ï¼ˆJSONï¼‰JSONæ˜¯ä¸€ç§è½»é‡çš„æ•°æ®æ ¼å¼ï¼Œæ–¹ä¾¿åœ°è¡¨ç¤ºå¤æ‚æ•°æ®ç»“æ„ JSONè¯­æ³•æ”¯æŒè¡¨ç¤ºä¸‰ç§ç±»å‹çš„å€¼ï¼ˆä»–è™½ç„¶å€Ÿç”¨äº†JavaScriptçš„è¯­æ³•ï¼Œä½†æ˜¯ä¸è¦å°†ä»–ä»¬æ··æ·†ï¼‰ ç®€å•å€¼ï¼šå­—ç¬¦ä¸²ã€æ•°å€¼ã€å¸ƒå°”å€¼å’Œnullï¼ˆç‰¹æ®Šå€¼undefinedä¸å¯ä»¥ï¼‰ å¯¹è±¡ï¼šç¬¬ä¸€ç§å¤æ‚æ•°æ®ç±»å‹ æ•°ç»„ï¼šç¬¬äºŒç§å¤æ‚æ•°æ®ç±»å‹ JSONçš„æµè¡Œä¸ä»…ä»…å› ä¸ºè¯­æ³•å’ŒJavaScriptç±»ä¼¼ï¼Œå¾ˆå¤§ç¨‹åº¦è¿˜æ˜¯å› ä¸ºJSONå¯ä»¥è¢«åŠè§£ææˆå¯ç”¨çš„JavaScriptå¯¹è±¡ï¼Œä¸è§£æä¸ºDOMçš„XMLç›¸æ¯”ï¼Œæœ‰å¾ˆå¤§ä¼˜åŠ¿ ECMAScript5å¢åŠ äº†JSONå…¨å±€å¯¹è±¡ï¼Œæ­£å¼å¼•å…¥JSONèƒ½åŠ›ï¼Œå¹¶ä¸”å¾—åˆ°æ‰€æœ‰ä¸»æµæµè§ˆå™¨çš„æ”¯æŒ JSONå¯¹è±¡æœ‰ä¸¤ä¸ªæ–¹æ³•ï¼š stringify()ï¼šå°†JavaScriptè§£æä¸ºJSONå­—ç¬¦ä¸² parse()ï¼šå°†JSONè§£æä¸ºJavaScriptå€¼ æœ‰æ—¶å€™æˆ‘ä»¬éœ€è¦åœ¨JSON.stringify() ä¹‹ä¸Šè‡ªå®šä¹‰ JSONåºåˆ—åŒ–ï¼Œå¯ä»¥åœ¨è¦åºåˆ—åŒ–çš„å¯¹è±¡ä¸­æ·»åŠ toJSONæ–¹æ³•ï¼Œåºåˆ—åŒ–æ—¶ä¼šæ ¹æ®è¿™ä¸ªæ–¹æ³•è¿”å›é€‚å½“çš„JSONè¡¨ç¤ºï¼ˆåŸç”Ÿçš„Dateå¯¹è±¡å°±æœ‰toJSONæ–¹æ³•ï¼‰ const book = { title: 'allen', count: 0, toJSON: function () { return this.title; } } console.log(JSON.stringify(book)); //'allen' ç¬¬24ç« ï¼ˆç½‘ç»œè¯·æ±‚å’Œè¿œç¨‹èµ„æºï¼‰Headerså¯¹è±¡ Headerså¯¹è±¡å’Œmapå¯¹è±¡æå…¶ç›¸ä¼¼ï¼ŒåŒ…æ‹¬å®ƒçš„get()ã€set()ã€has()ã€delete()ç­‰å®ä¾‹æ–¹æ³• ä½†ç‰¹æ®Šçš„ç‚¹åœ¨äºï¼š åˆå§‹åŒ–Headerså¯¹è±¡æ—¶ï¼Œå¯ä»¥æ”¾å…¥é”®å€¼å¯¹çš„å¯¹è±¡ const sed = {foo: 'bar'} let h = new Headers(seed); let m = new Map(seed); //error ä¸€ä¸ªHTTPå¤´éƒ¨å­—æ®µå¯ä»¥æœ‰å¤šä¸ªå€¼ï¼Œè€ŒHeaderså¯¹è±¡é€šè¿‡appendæ–¹æ³•æ·»åŠ å¤šä¸ªå€¼ h.append('foo', 'baz'); // æ­¤æ—¶fooæœ‰barã€baz Beacon API å¾ˆå¤šåˆ†æå·¥å…·éœ€è¦åœ¨é¡µé¢ç”Ÿå‘½å‘¨æœŸå°½é‡æ™šä¸€ç‚¹çš„æ—¶å€™å‘æœåŠ¡å™¨å‘é€é¥æµ‹æˆ–è€…åˆ†ææ•°æ®ï¼Œå› æ­¤ç†æƒ³çŠ¶æ€æ˜¯é€šè¿‡æµè§ˆå™¨çš„unloadäº‹ä»¶å‘é€ç½‘ç»œè¯·æ±‚ã€‚ ä½†æ˜¯æœ‰ä¸€ä¸ªé—®é¢˜ï¼Œå› ä¸ºunloadäº‹ä»¶æ„å‘³ç€æµè§ˆå™¨æ²¡æœ‰ä»»ä½•ç†ç”±å‘é€ä»»ä½•ä½ç½®ç»“æœçš„ç½‘ç»œè¯·æ±‚ï¼Œä¾‹å¦‚åœ¨unloadäº‹ä»¶å¤„ç†ç¨‹åºä¸­åˆ›å»ºçš„ä»»ä½•å¼‚æ­¥è¯·æ±‚éƒ½ä¼šè¢«æµè§ˆå™¨å–æ¶ˆï¼Œå› æ­¤XMLHttpRequestæˆ–fetchä¸é€‚åˆè¿™ä¸ªä»»åŠ¡ã€‚åˆ†æå·¥å…·å¯ä»¥å¼ºåˆ¶å‘é€åŒæ­¥è¯·æ±‚ï¼Œä½†æ˜¯è¿™æ ·ä¼šå¯¼è‡´ç”¨æˆ·è¦ç­‰å¾…unloadäº‹ä»¶å¤„ç†å®Œæˆè€Œå»¶è¿Ÿå¯¼èˆªä¸‹ä¸€ä¸ªé¡µé¢ W3Cå¼•å…¥äº† Beacon APIï¼Œå®ƒç»™navigatorå¢åŠ äº†ä¸€ä¸ªsendBeaconæ–¹æ³• navigator.sendBeacon(url, è¯·æ±‚å‚æ•°) sendBeacon() ä¸ä¸€å®šåœ¨é¡µé¢ç”Ÿå‘½å‘¨æœŸæœ«å°¾ä½¿ç”¨ï¼Œå¯ä»¥åœ¨ä»»ä½•æ—¶å€™ä½¿ç”¨ è°ƒç”¨ sendBeacon() åï¼Œæµè§ˆå™¨ä¼šæŠŠè¯·æ±‚æ·»åŠ åˆ°ä¸€ä¸ªå†…éƒ¨çš„è¯·æ±‚é˜Ÿåˆ—ï¼Œæµè§ˆå™¨ä¼šä¸»åŠ¨å‘é€é˜Ÿåˆ—ä¸­çš„è¯·æ±‚ æµè§ˆå™¨ä¿è¯åœ¨åŸå§‹é¡µé¢å·²ç»å…³é—­çš„æƒ…å†µä¸‹ä¹Ÿä¼šå‘é€è¯·æ±‚ çŠ¶æ€ç ã€è¶…æ—¶å’Œå…¶ä»–ç½‘ç»œé—®é¢˜é€ æˆçš„å¤±è´¥å®Œå…¨æ˜¯ä¸é€æ˜çš„ï¼Œä¸èƒ½é€šè¿‡ç¼–ç¨‹è§£å†³ ä¿¡æ ‡ï¼ˆbeaconï¼‰è¯·æ±‚ä¼šæºå¸¦ sendBeacon() æ—¶æ‰€æœ‰ç›¸å…³çš„cookie ç¬¬26ç« ï¼ˆæ¨¡å—ï¼‰ES6æ¨¡å—æ˜¯ä½œä¸ºä¸€æ•´å—JavaScriptä»£ç è€Œå­˜åœ¨çš„ï¼Œå¸¦æœ‰ type-&quot;module&quot;å±æ€§çš„ scriptæ ‡ç­¾ä¼šå‘Šè¯‰æµè§ˆå™¨ç›¸å…³ä»£ç åº”è¯¥ä½œä¸ºæ¨¡å—æ¥æ‰§è¡Œ &lt;script type=\"module\" src=\"xxxx\">&lt;/script> ä¸ä¼ ç»ŸJavaScriptå¤„ç†æ–¹å¼ä¸åŒï¼Œæ‰€æœ‰æ¨¡å—éƒ½ä¼šåƒ &lt;scirpt defer&gt; åŠ è½½è„šæœ¬ä¸€æ ·æŒ‰ç…§é¡ºåºæ‰§è¡Œï¼Œè§£æåˆ° &lt;script type=&quot;module&quot;&gt; æ ‡ç­¾åä¼šç«‹å³ä¸‹è½½æ¨¡å—æ–‡ä»¶ï¼Œä½†æ‰§è¡Œä¼šå»¶è¿Ÿåˆ°æ–‡æ¡£è§£æå®Œæˆã€‚ æ‰€ä»¥æ¨¡å—æ ‡ç­¾çš„ä½ç½®ä¹‹åªå†³å®šäº†æ–‡ä»¶ä»€ä¹ˆæ—¶å€™åŠ è½½ï¼Œå¹¶ä¸ä¼šå½±å“å“ªä¸ªæ¨¡å—ä»€ä¹ˆæ—¶å€™åŠ è½½ ç¬¬27ç« ï¼ˆå·¥ä½œè€…çº¿ç¨‹ï¼‰å·¥ä½œè€…çº¿ç¨‹çš„ä»·å€¼ï¼šåœ¨å•çº¿ç¨‹çš„JavaScripté‡Œï¼Œå…è®¸æŠŠä¸»çº¿ç¨‹çš„å·¥ä½œè½¬å«ç»™ç‹¬ç«‹çš„å®ä½“ï¼Œè€Œä¸æ”¹å˜ç°æœ‰çš„å•çº¿ç¨‹æ¨¡å‹ã€‚ æµè§ˆå™¨æ¯æ‰“å¼€ä¸€ä¸ªé¡µé¢ï¼Œå°±ä¼šåˆ†é…ä¸€ä¸ªä»–è‡ªå·±çš„ç¯å¢ƒï¼Œæ¯ä¸ªé¡µé¢æœ‰è‡ªå·±çš„å†…å­˜ã€DOMã€äº‹ä»¶å¾ªç¯ç­‰ï¼Œæ¯ä¸ªé¡µé¢å°±æ˜¯ä¸€ä¸ªæ²™ç›’ï¼Œä¸ä¼šç›¸äº’å¹²æ‰°ã€‚å¯¹æµè§ˆå™¨æ¥è¯´ï¼Œç®¡ç†å¤šä¸ªç¯å¢ƒæ˜¯éå¸¸ç®€å•çš„ï¼Œæ‰€ä»¥è¿™äº›ç¯å¢ƒéƒ½æ˜¯å¹¶è¡Œæ‰§è¡Œçš„ã€‚ ä½¿ç”¨å·¥ä½œè€…çº¿ç¨‹ï¼Œæµè§ˆå™¨å¯ä»¥åœ¨åŸå§‹é¡µé¢ç¯å¢ƒä¹‹å¤–åœ¨åˆ†é…ä¸€ä¸ªå®Œå…¨ç‹¬ç«‹çš„äºŒçº§å­ç¯å¢ƒï¼Œè¿™ä¸ªå­ç¯å¢ƒä¸èƒ½ä¾èµ–å•çº¿ç¨‹äº¤äº’çš„APIï¼ˆå¦‚DOMï¼‰ç­‰æ“ä½œï¼Œä½†æ˜¯å¯ä»¥ä¸çˆ¶ç¯å¢ƒå¹¶è¡Œæ‰§è¡Œä»£ç ï¼ˆä½†æ˜¯ï¼ŒWorker çº¿ç¨‹å¯ä»¥navigatorå¯¹è±¡å’Œlocationå¯¹è±¡ã€‚ï¼‰ ä¸“ç”¨å·¥ä½œè€…çº¿ç¨‹ï¼šåªèƒ½è¢«åˆ›å»ºå®ƒçš„é¡µé¢ä½¿ç”¨ new Worker() å…±äº«å·¥ä½œè€…çº¿ç¨‹ï¼šå¯ä»¥è¢«å¤šä¸ªä¸åŒçš„ä¸Šä¸‹æ–‡ä½¿ç”¨ï¼ŒåŒ…æ‹¬ä¸åŒçš„é¡µé¢ new ShareWorker() æœåŠ¡å·¥ä½œè€…çº¿ç¨‹ï¼šå®ƒä¸»è¦ç”¨é€”ç”¨äºæ‹¦æˆªã€é‡å®šå‘å’Œä¿®æ”¹é¡µé¢å‘å‡ºçš„è¯·æ±‚ï¼ˆå®ƒå…¶å®å°±æ˜¯Service Workerï¼‰ ä½†æ˜¯ç”±äºå¯ç”¨å·¥ä½œè€…çº¿ç¨‹çš„ä»£ä»·å¾ˆå¤§ï¼Œæ‰€ä»¥æŸäº›æƒ…å†µä¸‹å¯ä»¥è€ƒè™‘å§‹ç»ˆä¿æŒå›ºå®šæ•°é‡çš„çº¿ç¨‹æ´»åŠ¨ï¼Œç„¶åä½¿ç”¨â€œçº¿ç¨‹æ± â€","categories":[{"name":"å‰ç«¯","slug":"å‰ç«¯","permalink":"https://taylor12138.github.io/categories/%E5%89%8D%E7%AB%AF/"}],"tags":[],"author":"Hello"},{"title":"è®¡ç½‘personal note","slug":"è®¡ç½‘personal note","date":"2021-12-15T11:36:34.005Z","updated":"2022-09-27T12:03:57.973Z","comments":true,"path":"2021/12/15/ji-wang-personal-note/","link":"","permalink":"https://taylor12138.github.io/2021/12/15/ji-wang-personal-note/","excerpt":"","text":"1.è®¡ç½‘æ¦‚å¿µæ˜¯å°†ä¸€ä¸ªåˆ†æ•£çš„ï¼Œå…·æœ‰ç‹¬ç«‹åŠŸèƒ½çš„è®¡ç®—æœºç³»ç»Ÿï¼Œé€šè¿‡é€šä¿¡è®¾å¤‡å’Œçº¿è·¯è¿æ¥èµ·æ¥ï¼Œç”±åŠŸèƒ½å®Œå–„çš„è½¯ä»¶å®ç°èµ„æºå…±äº«å’Œä¿¡æ¯ä¼ é€’ è®¡ç®—æœºç½‘ç»œæ˜¯äº’è¿çš„ã€è‡ªæ²»çš„è®¡ç®—æœºé›†åˆ åŠŸèƒ½æ•°æ®é€šä¿¡ï¼ˆè¿é€šæ€§ï¼‰ï¼ˆé€šä¿¡å­ç½‘ï¼šç½‘ç»œå±‚ã€æ•°æ®é“¾è·¯å±‚ã€ç‰©ç†å±‚ï¼‰ï¼ˆæ˜¯ç‚¹åˆ°ç‚¹çš„é€šä¿¡ï¼‰ èµ„æºå…±äº«ï¼ˆèµ„æºå­ç½‘ï¼šåº”ç”¨å±‚ã€è¡¨ç¤ºå±‚ã€ä¼šè¯å±‚ï¼‰ ï¼ˆæ˜¯ç«¯åˆ°ç«¯çš„é€šä¿¡ï¼‰ â€‹ ä¸¤ä¸ªå­ç½‘ä¹‹é—´éš”ç€ä¼ è¾“å±‚ ä¸»æœºåœ¨osiæ¨¡å‹ä¸­æœ‰ä¸ƒå±‚ï¼Œè€Œä¸­é—´ç³»ç»Ÿåªæœ‰ç‰©ç†å±‚ã€æ•°æ®é“¾è·¯å±‚ã€ç½‘ç»œå±‚ä¸‰å±‚ï¼ˆäº¤æ¢æœºå’Œç½‘æ¡¥è¿™ç§ç”šè‡³åªæœ‰ç‰©ç†å±‚ã€æ•°æ®å±‚ä¸¤å±‚ï¼‰ åˆ†å¸ƒå¼å¤„ç†ï¼ˆå¤šå°è®¡ç®—æœºå„è‡ªæ‰¿æ‹…åŒä¸€å·¥ä½œä»»åŠ¡çš„ä¸åŒéƒ¨åˆ†ï¼‰ æé«˜å¯é æ€§ è´Ÿè½½å‡è¡¡ ç»„æˆç¡¬ä»¶ã€è½¯ä»¶ã€åè®®ï¼ˆæ ¸å¿ƒï¼‰ è¾¹ç¼˜éƒ¨åˆ†ï¼ˆç”¨æˆ·å¯ä»¥ç›´æ¥ä½¿ç”¨ï¼‰ã€æ ¸å¿ƒéƒ¨åˆ†ï¼ˆä¸ºè¾¹ç¼˜éƒ¨åˆ†æœåŠ¡ï¼‰ åŠŸèƒ½ç»„æˆï¼šä»ä¸Šåˆ°ä¸‹åˆ†åˆ«æ˜¯ï¼šåº”ç”¨å±‚ã€è¡¨ç¤ºå±‚ã€ä¼šè¯å±‚ã€ä¼ è¾“å±‚ã€ç½‘ç»œå±‚ã€æ•°æ®é“¾è·¯å±‚ã€ç‰©ç†å±‚ åˆ†ç±»åˆ†å¸ƒèŒƒå›´åˆ’åˆ†ï¼šå¹¿åŸŸç½‘WANã€åŸåŸŸç½‘MANã€å±€åŸŸç½‘LANã€ä¸ªäººåŒºåŸŸç½‘PAN ä½¿ç”¨è€…åˆ’åˆ†ï¼šå…¬ç”¨ç½‘ï¼ˆç”µä¿¡ï¼‰ã€ä¸“ç”¨ç½‘ï¼ˆå†›é˜Ÿï¼‰ äº¤æ¢æŠ€æœ¯åˆ’åˆ†ï¼šç”µè·¯äº¤æ¢ã€æŠ¥æ–‡äº¤æ¢ã€åˆ†ç»„äº¤æ¢ æ‹“æ‰‘ç»“æ„åˆ’åˆ†ï¼šæ€»çº¿å‹ã€æ˜Ÿå‹ã€ç¯å‹ã€ç½‘çŠ¶å‹ ä¼ è¾“æŠ€æœ¯åˆ’åˆ†ï¼šå¹¿æ’­å¼ç½‘ç»œï¼ˆå…±äº«å…¬å…±é€šä¿¡é€šé“ï¼‰ã€ç‚¹å¯¹ç‚¹ç½‘ç»œ æ ‡å‡†çš„åˆ’åˆ†æ³•å®šæ ‡å‡†ï¼šOSI äº‹å®æ ‡å‡†ï¼šTCP/IPï¼ˆå¹¶ä¸æ˜¯æŒ‡è¿™ä¸¤ç§åè®®ï¼Œè€Œæ˜¯å¯¹è®¸å¤šå¤§å¤§å°å°çš„åè®®çš„æ³›æŒ‡ï¼‰ é€Ÿç‡ &amp; å¸¦å®½ &amp; ååé‡1.é€Ÿç‡é€Ÿç‡å³æ•°æ®ç‡æˆ–æ•°æ®ä¼ è¾“ç‡ã€æˆ–æ¯”ç‰¹ï¼ˆbitï¼‰ç‡ï¼Œå…¶å®ä¹Ÿå°±æ˜¯é€Ÿåº¦ kb/sâ€¦. å­˜å‚¨å®¹é‡æ˜¯ä»¥ å­—èŠ‚ï¼ˆByteï¼‰ä½œä¸ºå•ä½ 2.å¸¦å®½åŸæœ¬ï¼šæŒ‡æŸä¸ªä¿¡å·å…·æœ‰çš„é¢‘å¸¦å®½åº¦ï¼Œå³æœ€é«˜é¢‘ç‡å’Œæœ€ä½é¢‘ç‡ä¹‹å·®ï¼Œå•ä½æ˜¯èµ«å…¹Hz ç°åœ¨ï¼šå®ƒç”¨æ¥è¡¨ç¤ºç½‘ç»œé€šä¿¡çº¿è·¯ä¼ é€æ•°æ®çš„èƒ½åŠ›ï¼Œé€šå¸¸æŒ‡å•ä½æ—¶é—´å†…ä»ç½‘ç»œæŸä¸€ç‚¹åˆ°å¦å¤–ä¸€ç‚¹çš„â€œæœ€é«˜æ•°æ®ç‡â€ï¼Œå•ä½æ˜¯æ¯”ç‰¹æ¯ç§’ï¼ˆå’Œé€Ÿç‡ä¸€æ ·ï¼‰ï¼ˆå…¶å®å°±æ˜¯è¡¨ç¤ºæ‰€æ”¯æŒæœ€é«˜é€Ÿç‡ä¸ºå¤šå°‘ï¼‰ 3.ååé‡å•ä½æ—¶é—´å†…é€šè¿‡æŸä¸ªç½‘ç»œï¼ˆä¿¡é“ã€æ¥å£ï¼‰çš„æ•°æ®é‡ï¼Œå•ä½æ˜¯ b/sâ€¦â€¦ ååé‡è¿˜å—åˆ°å¸¦å®½æˆ–è€…ç½‘ç»œé¢å®šé€Ÿç‡çš„é™åˆ¶ ååé‡æ›´åƒç¬æ—¶é€Ÿç‡ï¼Œå¸¦å®½åƒæœ€å¤§é€Ÿç‡ æ—¶å»¶æŒ‡æ•°æ®ï¼ˆæŠ¥æ–‡/åˆ†ç»„/æ¯”ç‰¹æµï¼‰ä»ç½‘ç»œï¼ˆæˆ–é“¾è·¯ï¼‰çš„ä¸€ç«¯ä¼ é€åˆ°å¦ä¸€ç«¯æ‰€éœ€è¦çš„æ—¶é—´ï¼Œä¹Ÿå«åšå»¶è¿Ÿæˆ–è¿Ÿå»¶ï¼Œå•ä½æ˜¯ç§’s åˆ†åˆ«ä¸º å‘é€æ—¶å»¶ï¼ˆæŠŠæ‰€æœ‰æ•°æ®ä»å‘é€ç«¯æ¨åˆ°ä¿¡é“ä¸Šï¼Œå‘ç”Ÿåœ¨ä¸»æœºå†…éƒ¨ï¼‰=æ•°æ®é•¿åº¦/ä¿¡é“å¸¦å®½ï¼Œé«˜é€Ÿé“¾è·¯æŒ‡çš„æ˜¯å‘é€é€Ÿç‡çš„æé«˜ï¼Œå³å¸¦å®½çš„æé«˜ï¼Œå¯¼è‡´å‘é€æ—¶å»¶çš„å‡å°‘ ä¼ æ’­æ—¶å»¶ï¼ˆåœ¨ä¿¡é“ä¸Šä¼ æ’­ä¸€æ®µè·ç¦»æ‰€èŠ±è´¹çš„æ—¶é—´ï¼Œå‘ç”Ÿåœ¨ä¿¡é“ä¸Šï¼‰=ä¿¡é“é•¿åº¦/ç”µç£æ³¢é€Ÿç‡ æ’é˜Ÿæ—¶å»¶ï¼ˆç­‰å¾…å¤„ç†ï¼‰ å¤„ç†æ—¶å»¶ï¼ˆæ£€é”™ï¼Œæ‰¾å‡ºå£ï¼‰ æ—¶å»¶å¸¦å®½ç§¯bit = ä¼ æ’­æ—¶å»¶s * å¸¦å®½b/sï¼Œå®ƒåˆç§°ä¸ºä»¥æ¯”ç‰¹ä½å•ä½çš„é“¾è·¯é•¿åº¦ï¼Œé“¾è·¯çš„å®¹é‡ å¾€è¿”æ—¶å»¶RTTï¼šä»å‘é€æ–¹å‘é€æ•°æ®å¼€å§‹ï¼Œåˆ°å‘é€æ–¹æ”¶åˆ°æ¥æ”¶æ–¹çš„ç¡®è®¤ç»å†çš„æ—¶å»¶ï¼ŒRTT = å¾€è¿”ä¼ æ’­æ—¶å»¶ + æœ«ç«¯å¤„ç†æ—¶é—´ = ä¼ æ’­æ—¶å»¶*2 + æœ«ç«¯å¤„ç†æ—¶é—´ åˆ©ç”¨ç‡ä¿¡é“åˆ©ç”¨ç‡ = æœ‰æ•°æ®é€šè¿‡çš„æ—¶é—´ / æ€»æ—¶é—´ é“¾è·¯åˆ©ç”¨ç‡=å‘é€å»¶æ—¶/æ€»ç”¨æ—¶ = å‘é€å»¶æ—¶/ï¼ˆå‘é€æ—¶å»¶+2*ä¼ æ’­æ—¶å»¶+ç¡®è®¤å¸§ä¼ è¾“æ—¶å»¶ï¼‰ ç½‘ç»œåˆ©ç”¨ç‡ = ä¿¡é“åˆ©ç”¨ç‡åŠ æƒå¹³å‡å€¼ åˆ†å±‚å…³äºå®ä½“ã€åè®®ã€æœåŠ¡å’Œæ¥å£ï¼š 1.å®ä½“ï¼šç¬¬nå±‚å…ƒç´ ç§°ä¸ºnå±‚å®ä½“ï¼ŒåŒå±‚å¦å¤–ä¸€ç«¯ä¸»æœºçš„å®ä½“å«å¯¹ç­‰å®ä½“ 2.åè®®ï¼šå¯¹ç­‰å®ä½“ï¼ˆæˆ–å¤šä¸ªå®ä½“ï¼‰é€šä¿¡è§„åˆ™ï¼Œåˆ†ä¸ºè¯­æ³•ã€è¯­ä¹‰ã€åŒæ­¥ï¼ˆæ“ä½œé¡ºåºï¼‰ 3.æ¥å£ï¼šä¸Šå±‚ä½¿ç”¨ä¸‹å±‚æœåŠ¡çš„å…¥å£ 4.æœåŠ¡ï¼šä¸‹å±‚ä¸ºç›¸é‚»ä¸Šå±‚æä¾›åŠŸèƒ½è°ƒç”¨ï¼ˆç›¸é‚»ï¼Œä¸‹å±‚ä¸ºä¸Šå±‚æ‰èƒ½ä¸ºç§°ä¹‹ä¸ºæœåŠ¡ï¼‰ è®¡ç®—æœºç½‘ç»œä½“ç³»ç»“æ„æ˜¯è®¡ç®—æœºç½‘ç»œå„å±‚åŠå…¶åè®®çš„é›†åˆ å„å±‚åŠŸèƒ½ç®€æ´æ¦‚è¿° åº”ç”¨å±‚ï¼šåœ¨æ‰€æœ‰èƒ½å’Œç”¨æˆ·äº¤äº’äº§ç”Ÿç½‘ç»œæµé‡çš„ç¨‹åºï¼Œå®ç°ååŒå·¥ä½œçš„åº”ç”¨è¿›ç¨‹ä¹‹é—´çš„é€šä¿¡è¿‡ç¨‹æ§åˆ¶ã€‚ è¡¨ç¤ºå±‚ï¼šç”¨äºå¤„ç†ä¸¤ä¸ªé€šä¿¡ç³»ç»Ÿä¸­ï¼Œäº¤æ¢ä¿¡æ¯çš„è¡¨ç¤ºæ–¹å¼ï¼ˆè¯­æ³•å’Œè¯­ä¹‰ï¼‰åŠŸèƒ½ï¼šæ•°æ®æ ¼å¼å˜æ¢ï¼ˆç¿»è¯‘ï¼‰ã€æ•°æ®åŠ å¯†å’Œè§£å¯†ã€æ•°æ®çš„å‹ç¼©å’Œæ¢å¤ ä¼šè¯å±‚ï¼šå‘è¡¨ç¤ºå±‚å®ä½“/ç”¨æˆ·è¿›ç¨‹æä¾›å»ºç«‹è¿æ¥å¹¶è¿æ¥ä¸Šæœ‰åºåœ°ä¼ è¾“æ•°æ®ã€‚è¿™æ˜¯ä¼šè¯ï¼Œä¹Ÿæ˜¯å»ºç«‹åŒæ­¥ ä¼ è¾“å±‚ï¼šè´Ÿè´£ä¸»æœºä¸¤ä¸ªè¿›ç¨‹çš„é€šä¿¡ï¼Œå³ç«¯åˆ°ç«¯çš„é€šä¿¡ï¼Œä¼ è¾“å•ä½æ˜¯æŠ¥æ–‡æ®µæˆ–ç”¨æˆ·æ•°æ®æ®µã€‚åŠŸèƒ½ï¼š å¯é ä¼ è¾“ï¼ˆæœ‰ç¡®è®¤æœºåˆ¶ï¼‰ã€ä¸å¯é ä¼ è¾“ï¼› å·®é”™æ§åˆ¶ï¼› æµé‡æ§åˆ¶ï¼ˆå‘é€é€Ÿç‡ï¼Œä½¿ç”¨æ»‘åŠ¨çª—å£ï¼Œæ¯”å¦‚åœç­‰åè®®ã€åé€€Nå¸§çš„æ»‘åŠ¨çª—å£ï¼Œé€‰æ‹©é‡ä¼ çš„æ»‘åŠ¨çª—å£ï¼‰ï¼› æ‹¥å¡æ§åˆ¶ï¼ˆæ…¢å¼€å§‹ã€æ‹¥å¡é¿å…ã€å¿«é‡ä¼ ã€å¿«æ¢å¤ï¼‰ï¼› å¤ç”¨åˆ†ç”¨ï¼ˆå¤ç”¨æ˜¯å¤šä¸ªåº”ç”¨å±‚å¯åŒæ—¶ä½¿ç”¨ä¸‹å±‚è¿è¾“å±‚æœåŠ¡ï¼Œåˆ†ç”¨æ˜¯ç›®çš„ä¸»æœºä¼ è¾“å±‚æŠŠæ”¶åˆ°çš„ä¿¡æ¯åˆ†åˆ«äº¤ä»˜ç»™ä¸Šé¢åº”ç”¨å±‚ä¸­ç›¸åº”è¿›ç¨‹ï¼Œåº”ç”¨ï¼šç«¯å£å·ï¼‰ï¼ˆosié¢å‘è¿æ¥ï¼Œtcp/ipæ— è¿æ¥+é¢å‘è¿æ¥ï¼‰ ç½‘ç»œå±‚ï¼šæŠŠåˆ†ç»„ä»æºç«¯ä¼ åˆ°ç›®çš„ç«¯ï¼Œä¸ºåˆ†ç»„äº¤æ¢ç½‘ä¸Šçš„ä¸åŒä¸»æœºæä¾›é€šä¿¡æœåŠ¡ï¼Œç½‘ç»œå±‚ä¼ è¾“å•ä½æ˜¯æ•°æ®æŠ¥ï¼ˆosiæ— è¿æ¥+é¢å‘è¿æ¥ï¼Œtcp/ipæ— è¿æ¥ï¼‰ï¼Œè·¯ç”±çš„é€‰æ‹©å’Œåˆ†ç»„è½¬å‘ + ç”¨æ‹¥å¡æ§åˆ¶ æ•°æ®é“¾è·¯å±‚ï¼šä¸»è¦ä»»åŠ¡æ˜¯æŠŠç½‘ç»œå±‚ä¼ ä¸‹æ¥çš„æ•°æ®ç»„è£…æˆå¸§ï¼ŒåŒæ—¶åŒ…æ‹¬æµé‡æ§åˆ¶å’Œå·®é”™æ£€æµ‹ï¼Œæ•°æ®é“¾è·¯å±‚çš„ä¼ è¾“å•ä½æ˜¯å¸§ ç‰©ç†å±‚ï¼šä¸»è¦ä»»åŠ¡æ˜¯åœ¨ç‰©ç†åª’ä½“ä¸Šå®ç°æ¯”ç‰¹æµçš„é€æ˜ä¼ è¾“ TCP/IPçš„åº”ç”¨å±‚ï¼šåˆå¹¶åº”ç”¨å±‚ã€è¡¨ç¤ºå±‚ã€ä¼šè¯å±‚ 5å±‚å‚è€ƒæ¨¡å‹æ•°æ®å°è£…ä¸è§£å°è£…åº”ç”¨å±‚ï¼šå•ä½ï¼šæŠ¥æ–‡ ä¼ è¾“å±‚ï¼šå•ä½ï¼šæŠ¥æ–‡æ®µ ç½‘ç»œå±‚ï¼šå•ä½ï¼šæ•°æ®æŠ¥ æ•°æ®é“¾è·¯å±‚ï¼šå•ä½ï¼šå¸§ ç‰©ç†å±‚ï¼šå•ä½ï¼šæ¯”ç‰¹ é¦™å†œå®šç† 2.ç‰©ç†å±‚ç‰©ç†å±‚è§£å†³å¦‚ä½•è¿æ¥å„ç§è®¡ç®—æœºçš„ä¼ è¾“åª’ä½“ä¸Šä¼ è¾“æ•°æ®æ¯”ç‰¹æµï¼Œè€Œä¸æ˜¯æŒ‡å…·ä½“çš„ä¼ è¾“åª’ä½“ï¼ˆä¸åŒå‚å®¶ç”Ÿäº§çš„ä»‹è´¨ï¼‰ï¼Œå®ƒçš„ä»»åŠ¡æ˜¯ç¡®å®šä¼ è¾“åª’ä½“æ¥å£æœ‰å…³çš„ä¸€äº›ç‰¹æ€§ï¼ˆå®šä¹‰æ ‡å‡†ï¼Œç±»ä¼¼äºæ°´æ™¶å¤´è§„æ ¼ï¼Œç”µå‹èŒƒå›´ï¼‰ å®šä¹‰çš„ç‰¹æ€§ï¼šæœºæ¢°ç‰¹æ€§ã€ç”µæ°”ç‰¹æ€§ã€åŠŸèƒ½ç‰¹æ€§ã€è¿‡ç¨‹ç‰¹æ€§ æ•°æ®é€šä¿¡åŸºç¡€çŸ¥è¯† æ•°æ®ï¼šä¼ é€æ¶ˆæ¯çš„å®ä½“ï¼Œé€šå¸¸æ˜¯æœ‰æ„ä¹‰çš„ç¬¦å·åºåˆ— ä¿¡å·ï¼šæ•°æ®åœ¨ä¼ è¾“è¿‡ç¨‹ä¸­çš„å­˜åœ¨å½¢å¼ æ•°å­—ä¿¡å·/ç¦»æ•£ä¿¡å·ï¼Œè®¡é‡å•ä½æ˜¯ç å…ƒ æ¨¡æ‹Ÿä¿¡å·/è¿ç»­ä¿¡å· ä¿¡æºï¼šäº§ç”Ÿå’Œå‘é€æ•°æ®çš„æºå¤´ ä¿¡å®¿ï¼šæ¥æ”¶æ•°æ®çš„ç»ˆç‚¹ ä¿¡é“ï¼šä¿¡å·ä¼ è¾“çš„åª’ä»‹ï¼Œä¸€èˆ¬ç”¨æ¥è¡¨ç¤ºæŸä¸€ä¸ªæ–¹å‘ä¼ é€ä¿¡æ¯çš„ä»‹è´¨ï¼Œå› æ­¤ä¸€æ¡é€šä¿¡çº¿è·¯å¾€å¾€åŒ…å«ä¸€æ¡å‘é€ä¿¡é“å’Œä¸€æ¡æ¥æ”¶ä¿¡é“ ä¸‰ç§é€šä¿¡æ–¹å¼ å•å·¥ä¿¡é“ï¼šåªæœ‰ä¸€ä¸ªæ–¹å‘ï¼Œä»…éœ€ä¸€æ¡ä¿¡é“ åŠåŒå·¥ä¿¡é“ï¼šåŒæ–¹éƒ½å¯ä»¥å‘é€å’Œæ¥æ”¶ï¼Œä½†æ˜¯ä¸èƒ½åŒæ—¶ï¼Œç±»ä¼¼äºå¯¹è®²æœºï¼Œéœ€è¦ä¸¤æ¡ä¿¡é“ å…¨åŒå·¥ä¿¡é“ï¼šåŒæ–¹å¯åŒæ—¶æ”¶å‘ï¼Œéœ€è¦ä¸¤æ¡ä¿¡é“ ä¸¤ç§æ•°æ®ä¼ è¾“æ–¹å¼ä¸²è¡Œä¼ è¾“ å¹¶è¡Œä¼ è¾“ ç¼–ç ä¸è°ƒåˆ¶ä¿¡é“ä¸Šçš„ä¿¡å·é™¤äº†å¯ä»¥åˆ†ä¸ºæ¨¡æ‹Ÿä¿¡é“å’Œæ•°å­—ä¿¡é“ã€æ— çº¿ä¿¡é“å’Œæœ‰çº¿ä¿¡é“ä¹‹å¤–ï¼Œè¿˜å¯ä»¥åˆ†ä¸ºåŸºå¸¦ä¿¡å·å’Œå®½å¸¦ä¿¡å· åŸºå¸¦ä¿¡å·ï¼šå°†æ•°å­—ä¿¡å·1æˆ–0ç›´æ¥ç”¨ä¸¤ç§ä¸åŒçš„ç”µå‹è¡¨ç¤ºï¼Œå†é€åˆ°æ•°å­—ä¿¡é“ï¼ˆåœ¨è®¡ç®—æœºä¸­æ˜¯ä½¿ç”¨æ•°å­—ä¿¡å·ï¼Œäººç±»æ˜¯æ¨¡æ‹Ÿä¿¡å·ï¼‰ä¸Šå»ä¼ è¾“ï¼ˆåŸºå¸¦ä¼ è¾“ï¼‰ï¼ŒåŸºå¸¦ä¿¡å·æœ€é‡è¦çš„ä¸€ç‚¹å°±æ˜¯æ¥è‡ªäºä¿¡æº å®½å¸¦ä¿¡å·ï¼šå°†åŸºå¸¦ä¿¡å·è¿›è¡Œè°ƒåˆ¶æ¨¡æ‹Ÿåå½¢æˆé¢‘åˆ†å¤ï¼ˆè½½æ³¢è°ƒåˆ¶ï¼‰ç”¨æ¨¡æ‹Ÿä¿¡å·ï¼Œå†ä¼ é€åˆ°æ¨¡æ‹Ÿä¿¡é“ä¸Šå»ä¼ è¾“ï¼ˆå®½å¸¦ä¼ è¾“ï¼‰ã€‚è½½æ³¢è°ƒåˆ¶ï¼ˆå¸¦é€šè°ƒåˆ¶ï¼‰æŠŠä¿¡å·é¢‘ç‡èŒƒå›´è°ƒåˆ°è¾ƒé«˜çš„é¢‘æ®µä»¥ä¾¿åœ¨ä¿¡é“ä¸­ä¼ è¾“ ç¼–ç æ–¹å¼éå½’é›¶ç¼–ç ï¼šé«˜1ä½0ï¼Œå®¹æ˜“ï¼Œä½†æ˜¯æ²¡æœ‰æ£€é”™åŠŸèƒ½ï¼Œæ— æ³•åˆ¤æ–­ç å…ƒçš„å¼€å§‹ä¸ç»“æŸï¼Œéš¾ä»¥åŒæ­¥ å½’é›¶ç¼–ç ï¼š1ï¼šä¸­é—´é«˜ï¼Œä¸¤è¾¹ä¸­ç­‰ï¼›0ï¼šä¸­é—´ä½ï¼Œä¸¤è¾¹ä¸­ç­‰ æ›¼å½»æ–¯ç‰¹ç¼–ç ï¼š1ï¼šå‰é«˜åä½ï¼›0ï¼šå‰ä½åé«˜ï¼Œè¿™ç§æ–¹æ³•æ‰€å é¢‘å¸¦å®½åº¦æ˜¯åŸºå¸¦å®½åº¦çš„ä¸¤å€ï¼Œæ‰€ä»¥å®ƒçš„æ•°æ®ä¼ è¾“é€Ÿç‡åªæœ‰è°ƒåˆ¶é€Ÿç‡çš„1/2 å·®åˆ†æ›¼å½»æ–¯ç‰¹ç¼–ç ï¼šåŒ1å¼‚0ï¼Œå³ç å…ƒä¸º1ï¼Œåˆ™å‰åŠæ®µåŠä¸ªç å…ƒå’Œä¸Šä¸€ä¸ªç å…ƒçš„ååŠæ®µçš„ç”µå¹³ç›¸åŒï¼Œ0åˆ™ç›¸åï¼ŒæŠ—å¹²æ‰°æ€§å¼ºäºæ›¼å½»æ–¯ç‰¹ç¼–ç  æ•°å­—æ•°æ®è°ƒåˆ¶ä¸ºæ¨¡æ‹Ÿä¿¡å·è°ƒåˆ¶è§£è°ƒå™¨çš„è°ƒåˆ¶ï¼šæ•°å­—ä¿¡å·-&gt;æ¨¡æ‹Ÿä¿¡å· è°ƒå¹…ï¼š0æ²¡å¹…åº¦ï¼Œ1æœ‰å¹…åº¦ è°ƒé¢‘ï¼š0ä½é¢‘ï¼Œ1é«˜é¢‘ è°ƒç›¸ï¼šè°ƒæˆæ­£å¼¦æ³¢å’Œä½™å¼¦æ³¢ QAMæ­£äº¤æŒ¯å¹…è°ƒåˆ¶ï¼Œç›¸å½“äºè°ƒå¹…+è°ƒå‘ è°ƒåˆ¶è§£è°ƒå™¨çš„è§£è°ƒï¼šæ¨¡æ‹Ÿä¿¡å·-&gt;æ•°å­—ä¿¡å· 3.æ•°æ®é“¾è·¯å±‚ç»“ç‚¹ï¼šä¸»æœºå’Œè·¯ç”±å™¨ ç½‘å¡å®ç°çš„ä¸»è¦åŠŸèƒ½æ˜¯ç‰©ç†å±‚ä¸æ•°æ®é“¾è·¯å±‚çš„åŠŸèƒ½ã€‚ é“¾è·¯ï¼šç½‘ç»œä¸­ä¸¤ä¸ªç»“ç‚¹ä¹‹é—´çš„ç‰©ç†é€šé“ï¼Œä¸»è¦ä»‹è´¨ä¸ºåŒç»çº¿ã€å…‰çº¤ç­‰ æ•°æ®é“¾è·¯ï¼šç½‘ç»œä¸­ä¸¤ä¸ªç»“ç‚¹ä¹‹é—´çš„é€»è¾‘é€šé“ï¼ŒæŠŠå®ç°æ§åˆ¶æ•°æ®ä¼ è¾“åè®®å’Œç¡¬ä»¶å’Œè½¯ä»¶åŠ åˆ°é“¾è·¯ä¸Šå°±æ„æˆæ•°æ®é“¾è·¯ å¸§ï¼šé“¾è·¯å±‚çš„åè®®æ•°æ®å•å…ƒï¼Œå°è£…ç½‘ç»œå±‚æ•°æŠ¥ æ•°æ®é“¾è·¯å±‚ è´Ÿè´£é€šè¿‡ä¸€æ¡é“¾è·¯ä»ä¸€ä¸ªç»“ç‚¹å‘å¦ä¸€ä¸ªç‰©ç†é“¾è·¯ç›´æ¥ç›¸è¿çš„ç›¸é‚»ç»“ç‚¹ä¼ é€æ•°æ®æŠ¥ï¼Œå®ƒæœ€åŸºæœ¬çš„æœåŠ¡æ˜¯å°†æºè‡ªäºç½‘ç»œå±‚çš„æ•°æ®å¯é çš„ä¼ è¾“åˆ°ç›¸é‚»ç»“ç‚¹çš„ç›®æ ‡æœºç½‘ç»œå±‚ï¼ˆç®€å•æ¥è¯´å°±æ˜¯åŠ å¼ºç‰©ç†å±‚ä¼ è¾“åŸå§‹æ¯”ç‰¹æµçš„åŠŸèƒ½ï¼‰ï¼Œå°†ç‰©ç†å±‚æä¾›å¯èƒ½å‡ºç°å·®é”™çš„ç‰©ç†è¿æ¥æ”¹é€ æˆä¸ºé€»è¾‘ä¸Šæ— å·®é”™çš„æ•°æ®é“¾è·¯ åŠŸèƒ½ä¸€ï¼šä¸ºç½‘ç»œå±‚æä¾›ï¼šæ— ç¡®è®¤æ— è¿æ¥æœåŠ¡ã€æœ‰ç¡®è®¤æ— è¿æ¥æœåŠ¡ã€æœ‰ç¡®è®¤é¢å‘è¿æ¥æœåŠ¡ï¼ˆæœ‰è¿æ¥ä¸€å®šæœ‰ç¡®è®¤ï¼‰ åŠŸèƒ½äºŒï¼šé“¾è·¯ç®¡ç†ï¼Œå³è¿æ¥çš„å»ºç«‹ã€ç»´æŒå’Œé‡Šæ”¾ï¼ˆç”¨äºé¢å‘è¿æ¥ï¼‰ åŠŸèƒ½ä¸‰ï¼šç»„å¸§ åŠŸèƒ½å››ï¼šæµé‡æ§åˆ¶ åŠŸèƒ½äº”ï¼šå·®é”™æ§åˆ¶ å°è£…æˆå¸§å®é™…ä¸Šå°±æ˜¯å°†ç½‘ç»œå±‚çš„ipæ•°æ®æŠ¥å½¢æˆå¸§æ•°æ®éƒ¨åˆ†ï¼ŒåŠ ä¸Šå¸§é¦–éƒ¨ï¼Œå¸§å°¾éƒ¨ è¿™æ ·æ¥æ”¶ç«¯åœ¨æ”¶åˆ°ç‰©ç†å±‚ä¸Šäº¤çš„æ¯”ç‰¹æµåï¼Œå°±å¯ä»¥æ ¹æ®é¦–å°¾æ ‡è®°è¿›è¡Œè¯†åˆ« å¸§é¦–éƒ¨å’Œå¸§å°¾éƒ¨åŒ…å«è®¸å¤šä¿¡æ¯ï¼Œå…¶ä¸­æœ‰ä¸ªé‡è¦ä½œç”¨å°±æ˜¯ï¼šå¸§å®šç•Œï¼ˆç¡®å®šå¸§çš„ç•Œé™ï¼‰ï¼› å¸§åŒæ­¥ï¼šæ¥æ”¶æ–¹åº”å½“èƒ½ä»æ¥æ”¶åˆ°çš„äºŒè¿›åˆ¶æ¯”ç‰¹æµåŒºåˆ†å¸§çš„å¼€å§‹å’Œç»“æŸ å››ç§å°è£…æˆå¸§æ–¹æ³•ï¼š 1.å­—ç¬¦è®¡æ•°æ³• 2.å­—ç¬¦å¡«å……æ³•ï¼ˆå¸§é¦–éƒ¨SOHï¼Œå¸§å°¾éƒ¨EOTï¼‰ï¼šä¸ºäº†ä¿éšœå­—ç¬¦å¡«å……çš„é€æ˜ä¼ è¾“ï¼Œåœ¨æ§åˆ¶ä¿¡æ¯çš„å‰é¢+è½¬ä¹‰å­—ç¬¦ 3.é›¶æ¯”ç‰¹å¡«å……æ³•ï¼ˆå¸§çš„é¦–å°¾éƒ¨éƒ½æ˜¯01111110ï¼‰ï¼šä¸ºäº†ä¿éšœå­—ç¬¦å¡«å……çš„é€æ˜ä¼ è¾“ï¼Œä¸­é—´æ•°æ®éƒ¨åˆ†ï¼Œåªè¦æœ‰5ä¸ª1ï¼Œå°±ç«‹åˆ»å¡«å…¥ä¸€ä¸ª0ï¼Œç®€ç§°5110æ–¹æ³• 4.è¿è§„ç¼–ç æ³•ï¼šæ›¼å½»æ–¯ç‰¹ç¼–ç éƒ½æ˜¯â€œé«˜-ä½â€ï¼Œæ‰€ä»¥é¦–å°¾å¸§ç”¨â€œé«˜-é«˜â€ã€â€œä½-ä½â€å®šç•Œå¸§çš„èµ·å§‹å’Œç»“æŸ é€æ˜ä¼ è¾“æŒ‡ä¸ç®¡æ‰€ä¼ çš„æ•°æ®æ˜¯ä»€ä¹ˆæ ·çš„æ¯”ç‰¹ç»„åˆï¼Œéƒ½åº”å½“èƒ½å¤Ÿåœ¨é“¾è·¯ä¸Šä¼ é€ï¼Œå› æ­¤é“¾è·¯å±‚â€œçœ‹ä¸è§â€æœ‰ä»€ä¹ˆå¦¨ç¢æ•°æ®ä¼ è¾“çš„ä¸œè¥¿ï¼ˆä¿è¯ä¼ è¾“é€æ˜ï¼Œä¼ è¾“æ•°æ®çš„æ¯”ç‰¹ç»„åˆå¯èƒ½å’ŒæŸæ§åˆ¶ä¿¡æ¯ä¸€æ ·ï¼ˆæ¯”å¦‚å¯¹æ•°æ®é“¾è·¯å±‚è¿›è¡Œä»€ä¹ˆæ“ä½œï¼‰ï¼Œä½†æ˜¯æ•°æ®é“¾è·¯å±‚ä¸ç®¡å®ƒï¼Œå®Œå…¨æŠŠå®ƒå½“ä½œä¸€ä¸ªä¿¡æ¯ç›´æ¥ä¼ é€’ï¼‰ å·®é”™æ§åˆ¶å·®é”™æœ‰ï¼šä½é”™ï¼ˆæ¯”ç‰¹ä½å‡ºé”™ï¼‰å’Œå¸§é”™ï¼ˆä¸¢å¤±ã€é‡å¤ã€å¤±åºï¼‰ å·®é”™æ§åˆ¶ï¼šæ£€æµ‹ç¼–ç ï¼ˆå¥‡å¶æ ¡éªŒç ã€å¾ªç¯å†—æ‚ç CRCï¼‰å’Œçº é”™ç¼–ç  å†—ä½™ç¼–ç ï¼šåœ¨æ•°æ®å‘é€å‰ï¼Œå…ˆæŒ‰ç…§æŸç§å…³ç³»åŠ ä¸Šä¸€å®šçš„å†—ä½™ä½ï¼ˆæ¯”å¦‚ä½™æ•°ï¼‰ï¼Œæ„æˆä¸€ä¸ªç¬¦åˆæŸä¸€è§„åˆ™çš„ç å­—ååœ¨å‘é€ï¼Œæ ¹æ®è§„åˆ™ï¼Œæ¥æ”¶ç«¯æŸ¥çœ‹æ”¶åˆ°çš„ç å­—æ˜¯å¦ç¬¦åˆåŸè§„åˆ™ï¼Œä»è€Œåˆ¤æ–­å¯¹é”™ CRCå¾ªç¯å†—ä½™ç ï¼š å‘é€ç«¯ï¼šè¦ä¼ çš„æ•°æ® / ç”Ÿæˆå¤šé¡¹å¼ï¼ˆä¸€ä¸ªæ•°å€¼ï¼‰ = å•†â€¦..FCSå†—ä½™ç ï¼ˆä½™æ•°ï¼‰ï¼›æœ€ç»ˆè¦å‘é€çš„æ•°æ®ä¸º è¦ç©¿çš„æ•°æ® + FCSå†—ä½™ç  æ¥æ”¶ç«¯ï¼šæ”¶åˆ°çš„æ•°æ® / ç”Ÿæˆå¤šé¡¹å¼ = å•†â€¦0 ä½™æ•°ä¸º0ï¼Œæ— å·®é”™ è®¡ç®—å†—ä½™ç ï¼šï¼ˆ1ï¼‰åŠ 0ï¼Œç”Ÿæˆå¤šé¡¹å¼G(x)çš„é˜¶ï¼ˆå³ç”Ÿæˆå¤šé¡¹å¼çš„ä½æ•°-1ï¼‰ä¸ºrï¼Œåˆ™åŠ rä¸ª0ï¼›ï¼ˆ2ï¼‰æ¨¡2é™¤æ³•ï¼ŒåŒ0å¼‚1 ä½™æ•°ä¸º0ï¼Œæ¥å—ï¼Œä¸ä¸º0ï¼Œä¸¢å¼ƒ æ­¤æ–¹æ³•åªèƒ½åšåˆ°å¯¹å¸§çš„æ— å·®é”™æ¥æ”¶ï¼Œä½†æ˜¯ä¸èƒ½ç®—ä½œâ€œå¯é ä¼ è¾“â€ï¼Œå› ä¸ºâ€œå¯é ä¼ è¾“â€çš„å®šä¹‰æ˜¯æ•°æ®é“¾è·¯å±‚å‘é€ä»€ä¹ˆï¼Œæ¥æ”¶ç«¯å°±æ¥æ”¶åˆ°ä»€ä¹ˆï¼Œä½†æ˜¯æ­¤æ–¹æ³•ä¸¢å¼ƒäº†éƒ¨åˆ†é”™è¯¯çš„ï¼Œæ²¡æœ‰å®Œå…¨æ¥æ”¶ æ•°æ®é“¾è·¯å±‚æµé‡æ§åˆ¶è¾ƒé«˜å‘é€é€Ÿåº¦å’Œè¾ƒä½æ¥æ”¶èƒ½åŠ›ä¸åŒ¹é…ä¼šå‡ºç°ä¼ è¾“é”™è¯¯ æ•°æ®é“¾è·¯å±‚çš„æµé‡æ§åˆ¶æ˜¯ç‚¹å¯¹ç‚¹çš„ï¼ˆæ¥æ”¶æ–¹æ”¶ä¸ä¸‹å°±ä¸å›å¤ç¡®è®¤ï¼‰ï¼Œä¼ è¾“å±‚çš„æµé‡æ§åˆ¶æ˜¯ç«¯å¯¹ç«¯çš„ï¼ˆæ¥æ”¶ç«¯ç»™å‘é€ç«¯ä¸€ä¸ªçª—å£å…¬å‘Šï¼‰ åœæ­¢ç­‰å¾…åè®®ï¼šæ¯å‘é€å®Œä¸€ä¸ªå¸§ï¼Œç­‰å¾…å¯¹æ–¹ç¡®è®¤å†å‘ä¸‹ä¸€ä¸ªï¼ˆåœæ­¢ç­‰å¾…åè®®ç±»ä¼¼äºç‰¹æ®Šçš„æ»‘åŠ¨çª—å£åè®®ï¼Œä½†åªæ˜¯å‘é€çª—å£å’Œæ¥æ”¶çª—å£éƒ½åªæœ‰ä¸€ä¸ªï¼‰ æ»‘åŠ¨çª—å£åè®®ï¼š å‘é€çª—å£æŒ‡åœ¨å‘é€ç«¯ç»´æŒä¸€æ®µè¿ç»­çš„ï¼Œå…è®¸å‘é€çš„å¸§çš„åºå·ï¼ˆæ­£åœ¨å‘é€çš„æ•°æ®ï¼‰ï¼Œç›¸å¯¹åº”çš„æ˜¯æ¥æ”¶çª—å£ï¼Œæ»‘åŠ¨çª—å£åè®®è§£å†³æµé‡æ§åˆ¶é—®é¢˜å’Œå¯é ä¼ è¾“é—®é¢˜ åé€€Nå¸§åè®®ï¼Œå‘é€çª—å£å¤§å°&gt;1ï¼Œæ¥æ”¶çª—å£å¤§å°=1 é€‰æ‹©é‡ä¼ åè®®ï¼Œå‘é€çª—å£å¤§å°&gt;1ï¼Œæ¥æ”¶çª—å£å¤§å°&gt;1 åœ¨é“¾è·¯å±‚åœ¨å‘é€è¿‡ç¨‹ï¼Œå‘é€çª—å£å’Œæ¥æ”¶çª—å£å¤§å°å›ºå®š åœæ­¢ç­‰å¾…åè®®é™¤äº†æ¯”ç‰¹å‡ºå·®é”™ï¼Œåº•å±‚è¿˜ä¼šå‡ºç°ä¸¢åŒ…é—®é¢˜ï¼ˆçº¿è·¯ã€ç—…æ¯’ç­‰åŸå› å¯¼è‡´æ•°æ®åŒ…çš„ä¸¢å¤±ï¼‰ åœæ­¢ç­‰å¾…åè®®é‡ç”³ï¼šæ¯å‘é€å®Œä¸€ä¸ªå¸§ï¼Œç­‰å¾…å¯¹æ–¹ç¡®è®¤å†å‘ä¸‹ä¸€ä¸ªï¼ˆåœæ­¢ç­‰å¾…åè®®ç±»ä¼¼äºç‰¹æ®Šçš„æ»‘åŠ¨çª—å£åè®®ï¼Œä½†åªæ˜¯å‘é€çª—å£å’Œæ¥æ”¶çª—å£éƒ½åªæœ‰ä¸€ä¸ªï¼‰ æœ‰å·®é”™çš„æƒ…å†µï¼š 1.æ•°æ®å¸§ä¸¢å¤±æˆ–æ£€æµ‹åˆ°å¸§å‡ºé”™ æ¯å‘é€ä¸€ä¸ªå¸§ï¼Œå¯åŠ¨ä¸€ä¸ªè¶…æ—¶è®¡æ—¶å™¨ é‡ä¼ æ—¶é—´&gt;å¾€è¿”ä¼ æ’­æ—¶å»¶RTT è¶…æ—¶é‡ä¼  æ³¨æ„ï¼šï¼ˆ1ï¼‰å‘å®Œä¸€ä¸ªå¸§åï¼Œè¦ä¿ç•™ä»–çš„å‰¯æœ¬ï¼Œï¼ˆ2ï¼‰æ•°æ®å¸§å’Œç¡®è®¤å¸§å¿…é¡»ç¼–å·ã€ï¼ˆ3ï¼‰ 2.ACKä¸¢å¤±ï¼ˆç¡®è®¤ä¸¢å¤±ï¼‰ åŒä¸Šï¼Œä½†æ˜¯æ¥æ”¶æ–¹ä¸¢å¼ƒé‡å¤å¸§ï¼Œé‡ä¼ ç¡®è®¤å¸§ 3.ACKè¿Ÿåˆ° ä»ç„¶æ˜¯è¶…æ—¶é‡ä¼ ï¼Œæ¥æ”¶æ–¹ä¸¢å¼ƒé‡å¤å¸§ï¼Œé‡ä¼ ç¡®è®¤å¸§ï¼ˆå½“åé¢å‘é€æ–¹ç»ˆäºç­‰åˆ°ä¸€å¼€å§‹çš„ç¡®è®¤å¸§æ—¶ï¼Œç›´æ¥æ”¶ä¸‹å¹¶ä¸”ä¸¢å¼ƒï¼‰ åè®®çš„ä¼˜ç‚¹ï¼šç®€å•ï¼Œç¼ºç‚¹ï¼šä¿¡é“åˆ©ç”¨ç‡ä½ï¼ˆå‘é€æ—¶é—´Td / ï¼ˆå‘é€æ—¶é—´Td + RTT + ç¡®è®¤åˆ†ç»„æ—¶é—´Taï¼‰ï¼‰ æ»‘åŠ¨çª—å£åé€€Nå¸§ å‘é€çª—å£é‡ç”³ï¼šå‘é€çª—å£æŒ‡åœ¨å‘é€ç«¯ç»´æŒä¸€æ®µè¿ç»­çš„ï¼Œå…è®¸å‘é€çš„å¸§çš„åºå·ï¼ˆæ­£åœ¨å‘é€çš„æ•°æ®ï¼‰ æ¥æ”¶çª—å£ï¼šæ¥æ”¶æ–¹ç»´æŒä¸€ç»„è¿ç»­çš„å…è®¸æ¥æ”¶å¸§çš„åºå· åé€€Nå¸§åè®®ï¼Œå‘é€çª—å£å¤§å°&gt;1ï¼Œæ¥æ”¶çª—å£å¤§å°=1 ç´¯ç§¯ç¡®è®¤ï¼šæ¥æ”¶æ–¹ä¸ç”¨å¯¹äºæ¯ä¸ªæ•°æ®å¸§è¿”å›ç¡®è®¤å¸§ï¼Œå¯ä»¥éš”ä¸€ä¼šè¿”å›ä¸€ä¸ªç¡®è®¤å¸§ï¼Œå®ƒä¿è¯è¿™ä¸ªå¸§ï¼Œä»¥åŠä¹‹å‰çš„æ‰€æœ‰å¸§éƒ½å¾—åˆ°äº†ç¡®è®¤ è¶…æ—¶äº‹ä»¶ï¼šå‘é€æ–¹ä¼šé‡ä¼ æ‰€æœ‰å·²å‘é€ä½†æ˜¯æœªè¢«ç¡®è®¤çš„å¸§ï¼Œæ¯”å¦‚å†ç­‰å¾…1å·å¸§ï¼Œä½†æ˜¯ä¸€ç›´ç­‰ä¸åˆ°ï¼Œç­‰æ¥2ï¼Œ3å·å¸§ï¼Œä¼šå°†å…¶ä¸¢å¼ƒï¼Œç›´åˆ°é‡ä¼ çš„1å·å¸§çš„åˆ°æ¥ï¼Œå¹¶ä¸”ç»§ç»­é‡ä¼ åˆšæ‰å·²ç»å‘è¿‡çš„2ã€3å·å¸§ æ»‘åŠ¨çª—å£é•¿åº¦ï¼šçª—å£å¤§å°Wå°äºå¸§æ€»ç±»çš„ä¸€åŠ é€‰æ‹©é‡ä¼ åè®®ä¸­çš„æ»‘åŠ¨çª—å£ï¼ˆä¿¡é“åˆ©ç”¨ç‡é«˜ï¼‰ å’Œåé€€Nå¸§ä¸åŒçš„æ˜¯ï¼Œå¦‚æœå¸§æ²¡æœ‰æŒ‰åºåˆ°è¾¾ï¼Œä¹Ÿä¼šå°†ä¹‹ååºå·çš„å¸§æš‚å­˜åœ¨æ¥æ”¶çª—å£ å¦‚æœæ¥æ”¶æ–¹æ”¶åˆ°çš„å¸§åºå·æ˜¯çª—å£çš„ä¸‹ç•Œï¼ˆæœ€å·¦è¾¹çª—å£å¯¹åº”çš„åºå·ï¼‰ï¼Œåˆ™çª—å‘å‰ç§»åŠ¨åˆ°æœ€å°åºå·æœªç¡®è®¤å¸§å¤„ è¶…æ—¶äº‹ä»¶ï¼šä¸€ä¸ªè¶…æ—¶äº‹ä»¶å‘ç”Ÿååªé‡ä¼ ä¸€ä¸ªå¸§ å¦‚æœæ”¶åˆ°äº†çª—å£åºå·å¤–çš„å¸§ï¼ˆå°äºçª—å£ä¸‹ç•Œï¼Œå¯èƒ½å› ä¸ºæŸäº›åŸå› ä¼ çš„æ…¢ï¼Œä½†æ˜¯å·²ç»è¶…æ—¶é‡ä¼ äº†ï¼‰ï¼Œå°±è¿”å›ä¸€ä¸ªack æ»‘åŠ¨çª—å£é•¿åº¦ï¼šå‘é€çª—å£æœ€å¥½ç­‰äºæ¥æ”¶çª—å£ ï¼›çª—å£å¤§å°Wå°äºå¸§æ€»ç±»çš„ä¸€åŠ ä¼ è¾“æ•°æ®çš„é“¾è·¯ç‚¹å¯¹ç‚¹é“¾è·¯åº”ç”¨ï¼špppåè®®ã€å¹¿åŸŸç½‘ å¹¿æ’­å¼é“¾è·¯ï¼šå±€åŸŸç½‘ å¹¿æ’­ä¿¡é“ä»‹è´¨è®¿é—®æ§åˆ¶å°±æ˜¯é‡‡å–ä¸€å®šæªæ–½ï¼Œä½¿å¾—ä¸¤å¯¹èŠ‚ç‚¹ä¹‹é—´é€šä¿¡ï¼ˆå› ä¸ºå¹¿æ’­å¼é“¾è·¯ï¼Œæ˜¯å¤šä¸ªç‚¹å…±äº«ä¿¡é“ï¼‰ä¸ä¼šå‘ç”Ÿäº’ç›¸å¹²æ‰°çš„æƒ…å†µ é™æ€åˆ’åˆ†ä¿¡é“ï¼šé¢‘åˆ†å¤ç”¨ã€æ—¶åˆ†å¤ç”¨ã€æ³¢åˆ†å¤ç”¨ã€ç åˆ†å¤ç”¨ åŠ¨æ€åˆ†é…ä¿¡é“ï¼ˆCSMA/CDåŒ…å«å…¶ä¸­ï¼‰ï¼šåˆ†ä¸ºè½®è¯¢è®¿é—®ä»‹è´¨è®¿é—®æ§åˆ¶ã€éšæœºè®¿é—®ä»‹è´¨è®¿é—®æ§åˆ¶ éšæœºè®¿é—®ä»‹è´¨è®¿é—®æ§åˆ¶ï¼šæ‰€æœ‰ç”¨æˆ·å¯éšæœºå‘ä¿¡æ¯ï¼Œå‘é€ä¿¡æ¯æ—¶å å…¨éƒ¨å¸¦å®½ CSMA/CDåè®®å…ˆå¬å†è¯´ã€è¾¹å¬è¾¹è¯´ è½½æ³¢ç›‘å¬å¤šç‚¹æ¥å…¥/ç¢°æ’æ£€æµ‹ CSMA/CD CSï¼šè½½æ³¢ç›‘å¬ï¼Œæ¯ä¸ªç«™åœ¨å‘é€æ•°æ®ä¹‹å‰ä»¥åŠå‘é€æ•°æ®æ—¶ï¼Œéƒ½è¦æ£€æµ‹ä¸€ä¸‹æ€»çº¿ä¸Šæ˜¯å¦æœ‰å…¶ä»–è®¡ç®—æœºåœ¨å‘é€æ•°æ®ã€‚å…¶å®å°±æ˜¯æ£€æµ‹ä¿¡é“ä¸Šç”µå‹çš„æ‘†åŠ¨å¹…å€¼ï¼ˆåœ¨ç«™ç‚¹çš„ä½ç½®æ£€æµ‹æœ‰æ²¡æœ‰ä¿¡å·è¿›æ¥ï¼‰ï¼Œå¹…å€¼è¾ƒå¤§ï¼Œåˆ™è¯´æ˜ä¿¡é“ä¸Šæœ‰äººåœ¨è¯´è¯ï¼Œå°±ä¸å‘é€ï¼Œç›´åˆ°æ£€æµ‹ä¿¡é“ä¸Šç©ºé—²æ‰å‘é€ MAï¼šå¤šç‚¹æ¥å…¥ï¼Œè¡¨ç¤ºè®¸å¤šè®¡ç®—æœºä»¥å¤šç‚¹æ¥å…¥çš„æ–¹å¼è¿åœ¨ä¸€æ ¹æ€»çº¿ä¸Š ï¼Œå…¶å®ä¹Ÿè¯´æ˜äº†è¯¥åè®®åº”ç”¨äºæ€»çº¿å‹ç½‘ç»œ CDï¼šç¢°æ’æ£€æµ‹ï¼Œâ€œè¾¹å‘é€è¾¹ç›‘å¬â€ï¼Œé€‚é…å™¨è¾¹å‘é€æ•°æ®ï¼Œè¾¹æ£€æµ‹ä¿¡é“ä¸Šä¿¡å·ç”µå‹å˜åŒ–ï¼Œä»¥åˆ¤æ–­è‡ªå·±å‘é€æ•°æ®æ—¶å…¶ä»–ç«™æ˜¯å¦ä¹Ÿåœ¨å‘ï¼Œä¹Ÿè¯´æ˜äº†è¯¥åè®®åº”ç”¨äºåŠåŒå·¥ç½‘ç»œ ä¸ºä»€ä¹ˆå…ˆå¬åè¿˜æ˜¯æœ‰å¯èƒ½å‘ç”Ÿå†²çªï¼Ÿå› ä¸ºç”µç£æ³¢åœ¨æ€»çº¿ä¸Šæ€»æ˜¯ä»¥æœ‰é™é€Ÿç‡è¿›è¡Œä¼ æ’­ï¼Œå³ä¼ æ’­æ—¶å»¶å¯¹è½½æ³¢ç›‘å¬çš„å½±å“ æ£€æµ‹åˆ°æ•°æ®å¸§æœ‰é”™è¯¯ï¼Œåˆ™ç¡®å®šå‘ç”Ÿäº†ç¢°æ’å’Œå†²çªï¼Œåœå‘ åªè¦ç»è¿‡ 2T æ—¶é—´æ²¡æœ‰æ£€éªŒå‡ºç¢°æ’ï¼Œå°±èƒ½è‚¯å®šè¿™æ¬¡ä¸ä¼šå‘ç”Ÿç¢°æ’ï¼ˆTä¸ºå•ç¨‹ç«¯åˆ°ç«¯çš„ä¼ æ’­æ—¶å»¶ï¼‰ é‡‡ç”¨æˆªæ–­äºŒè¿›åˆ¶æŒ‡æ•°è§„é¿ç®—æ³•ç¡®å®šé‡ä¼ æ—¶æœºï¼š 1.ç¡®å®šåŸºæœ¬è§„é¿æ—¶é—´ï¼Œäº‰ç”¨æœŸä¸º2Tï¼Œ2T &lt;= æœ€å°å¸§é•¿ / æ•°æ®ä¼ è¾“é€Ÿç‡ 2.å®šä¹‰å‚æ•°kï¼Œå®ƒç­‰äºé‡ä¼ æ¬¡æ•°ï¼Œä½†kä¸è¶…è¿‡10ï¼Œk = min[é‡ä¼ æ¬¡æ•°, 10] 3.ä»ç¦»æ•£çš„æ•´æ•°é›†åˆ[0, 2^k-1]ä¸­éšæœºå–å‡ºä¸€ä¸ªæ•°rï¼Œé‡ä¼ æ‰€éœ€è¦é€€é¿çš„æ—¶é—´ï¼Œå°±æ˜¯rå€çš„åŸºæœ¬è§„é¿æ—¶é—´ï¼Œå³2r*T 4.å½“é‡ä¼ è¾¾åˆ°16æ¬¡ä»ä¸èƒ½æˆåŠŸï¼Œè¯´æ˜ç½‘ç»œå¤ªæ‹¥æŒ¤ï¼Œåˆ™æŠ›å‡ºæ­¤å¸§å‘é«˜å±‚æŠ¥é”™ ä¸ºäº†é¿å…å¸§å¤ªçŸ­å¯¼è‡´è¯¥åè®®çš„ä½œç”¨æ— æ•ˆï¼ˆä¼ çŸ­å¸§åæ‰çŸ¥é“å‘ç”Ÿç¢°æ’ï¼‰ï¼Œä»¥å¤ªç½‘å®šä¹‰äº†æœ€å°å¸§é•¿64byte = 512bitï¼Œå°äºæ­¤å¤§å°ä¸ºæ— æ•ˆå¸§ MACå±‚åœ¨å±€åŸŸç½‘ä¸­ï¼Œç¡¬ä»¶åœ°å€åˆç§°ä¸ºç‰©ç†åœ°å€æˆ–MACåœ°å€ï¼Œå®ƒæ˜¯æ¯ä¸ªé€‚é…å™¨ï¼ˆç½‘å¡ï¼‰éƒ½æœ‰çš„ä¸€ä¸ªå…¨çƒå”¯ä¸€åœ°48ä½äºŒè¿›åˆ¶åœ°å€ MACå±‚ä¸»è¦åŠŸèƒ½åŒ…æ‹¬æ•°æ®å¸§çš„å°è£…å’Œå¸è£… MACå¸§ï¼šæ˜¯ä»¥ä»¥å¤ªç½‘V2çš„æ ¼å¼ ä»¥å¤ªç½‘ç”±Xeroxç­‰å…¬å¸è”åˆå¼€å‘åœ°åŸºå¸¦æ€»çº¿å±€åŸŸç½‘è§„èŒƒï¼Œæ˜¯å½“ä»Šç°æœ‰å±€åŸŸç½‘æœ€é€šç”¨çš„é€šä¿¡åè®®æ ‡å‡†ï¼Œä½¿ç”¨CSMA/CDæŠ€æœ¯ ä»¥å¤ªç½‘æä¾›æ— è¿æ¥ã€ä¸å¯é æœåŠ¡ PPPåè®®å±€åŸŸç½‘æ™®éé‡‡å–å¤šç‚¹æ¥å…¥æŠ€æœ¯ï¼ˆæ€»çº¿å‹ï¼‰ å¹¿åŸŸç½‘ä¸­é€šå¸¸é‡‡ç”¨ç‚¹å¯¹ç‚¹æŠ€æœ¯ï¼ˆå°†å¤šä¸ªå±€åŸŸç½‘äº’è”ï¼Œèµ„æºå…±äº«ï¼‰ PPPåè®®æ˜¯ç›®å‰ä½¿ç”¨æœ€å¹¿æ³›çš„æ•°æ®é“¾è·¯å±‚åè®®ï¼ˆæ‹¨å·ä¸Šç½‘ï¼‰åªæ”¯æŒå…¨åŒå·¥ pppåè®®çš„ä¸‰ä¸ªç»„æˆéƒ¨åˆ†ï¼š ï¼ˆ1ï¼‰ä¸€ä¸ªå°†ipæ•°æ®æŠ¥å°è£…åˆ°ä¸²è¡Œé“¾è·¯ ï¼ˆ2ï¼‰é“¾è·¯æ§åˆ¶åè®®LCPï¼ˆèº«ä»½éªŒè¯ï¼‰ ï¼ˆ3ï¼‰ç½‘ç»œæ§åˆ¶åè®®NCPï¼Œä¸ºç½‘ç»œå±‚åè®®å»ºç«‹å’Œé…ç½®é€»è¾‘è¿æ¥ PPPå¸§æ ¼å¼ï¼šé›¶æ¯”ç‰¹å¡«å……æ³• 4.ç½‘ç»œå±‚ä¸»è¦ä»»åŠ¡å°±æ˜¯æŠŠåˆ†ç»„ä»æºç«¯ä¼ é€åˆ°ç›®çš„ç«¯ï¼Œä¸ºåˆ†ç»„äº¤æ¢ç½‘ä¸Šçš„ä¸åŒä¸»æœºæä¾›é€šä¿¡æœåŠ¡ï¼Œä¼ è¾“å•ä½æ˜¯æ•°æ®æŠ¥ï¼ˆæ•°æ®æŠ¥æ˜¯æ¯”è¾ƒé•¿çš„æ•°æ®ï¼Œåˆ†ç»„æ˜¯æŠŠæ•°æ®åŒ…è¿›è¡Œåˆ‡å‰²ï¼Œåˆ’åˆ†å‡ºæ¥çš„ç‰‡æ®µï¼‰ åŠŸèƒ½ä¸€ï¼šè·¯ç”±çš„é€‰æ‹©å’Œåˆ†ç»„è½¬å‘ï¼ˆé€‰æœ€ä½³è·¯å¾„ï¼‰ åŠŸèƒ½äºŒï¼šå¼‚æ„ç½‘ç»œäº’è” åŠŸèƒ½ä¸‰ï¼šæ‹¥å¡æ§åˆ¶ æ•°æ®äº¤æ¢æ–¹å¼ä¸¤å°ä¸»æœºé€šè¿‡ç½‘ç»œæ ¸å¿ƒã€è·¯ç”±å™¨ã€‘è¿›è¡Œæ•°æ®è½¬å‘ ï¼ˆ1ï¼‰ç”µè·¯äº¤æ¢ï¼šæ¯”å¦‚ç”µè¯ç½‘ç»œï¼Œç‹¬å èµ„æº ï¼ˆ2ï¼‰æŠ¥æ–‡äº¤æ¢ï¼šæŠ¥æ–‡æ˜¯æºåº”ç”¨å‘é€çš„ä¿¡æ¯æ•´ä½“ï¼Œæ— éœ€å»ºç«‹è¿æ¥ã€å¯é ã€åˆ©ç”¨ç‡é«˜ï¼Œä¸”å¤šç›®æ ‡ï¼Œä½†æŠ¥æ–‡å¤§å°ä¸å®šï¼Œéœ€è¦ç½‘ç»œèŠ‚ç‚¹æœ‰è¾ƒå¤§ç¼“å­˜ç©ºé—´ ï¼ˆ3ï¼‰åˆ†ç»„äº¤æ¢ï¼šå¤§æ•°æ®å—åˆ†å‰²æˆå°æ•°æ®å—ï¼ˆæŠŠæŠ¥æ–‡åˆ‡å‰²æˆå°æ•°æ®å—ï¼‰ï¼Œå®ƒç›¸å¯¹äºæŠ¥æ–‡äº¤æ¢ï¼Œå­˜å‚¨ç®¡ç†æ›´å®¹æ˜“ï¼›ä½†æ˜¯ä¹±åºåˆ°è¾¾ç›®çš„ä¸»æœºæ—¶ï¼Œéœ€è¦åˆ†ç»„æ’åºé‡ç»„ æ•°æ®æŠ¥å’Œè™šç”µè·¯æ•°æ®æŠ¥æ–¹å¼ä¸ºç½‘ç»œå±‚æä¾›æ— è¿æ¥æœåŠ¡ï¼ˆå› ç‰¹ç½‘åœ¨ä½¿ç”¨ï¼‰ï¼ˆæ— è¿æ¥æœåŠ¡ä¸ºä¸äº‹å…ˆä¸ºåˆ†ç»„çš„ä¼ è¾“ç¡®å®šä¼ è¾“è·¯å¾„ï¼Œä¸åŒåˆ†ç»„ä¼ è¾“è·¯å¾„å¯èƒ½ä¸åŒï¼‰ è·¯ç”±å™¨æ ¹æ®åˆ†ç»„ç›®çš„åœ°å€è½¬å‘åˆ†ç»„ï¼ŒåŸºäºç®—æ³•æ„å»ºçš„è½¬å‘è¡¨ï¼Œä¸ºæ¯ä¸ªåˆ†ç»„ç‹¬ç«‹é€‰è·¯ è™šç”µè·¯æ–¹å¼ä¸ºç½‘ç»œå±‚æä¾›è¿æ¥æœåŠ¡ï¼ˆè™šç”µè·¯æ˜¯ä¸€æ¡æºä¸»æœºåˆ°ç›®çš„ä¸»æœºç±»ä¼¼äºç”µè·¯çš„è·¯å¾„ï¼ˆé€»è¾‘è¿æ¥ï¼‰ï¼Œè·¯ä¸Šæ‰€æœ‰ç»“ç‚¹éƒ½è¦ç»´æŒè¿™æ¡è™šç”µè·¯çš„å»ºç«‹ï¼Œå¹¶æœ‰ä¸€å¼ è™šç”µè·¯è¡¨ï¼‰ æ¯ä¸ªåˆ†ç»„æºå¸¦è™šç”µè·¯å·ï¼Œå¯ä»¥ä½¿å¾—ä¸€ç³»åˆ—çš„åˆ†ç»„æ²¿ç€ç›¸åŒè·¯å¾„è½¬å‘å‡ºå» è·¯ç”±ç®—æ³•å’Œè·¯ç”±å™¨æ¦‚è¿°ç®—æ³•çš„â€œæœ€ä½³â€åªèƒ½æ˜¯ç›¸å¯¹äºæŸä¸€ç§ç‰¹å®šè¦æ±‚ä¸‹å¾—å‡ºçš„æ¯”è¾ƒåˆç†çš„é€‰æ‹©è€Œå·² é™æ€è·¯ç”±ç®—æ³•ï¼šéè‡ªé€‚åº”è·¯ç”±é€‰æ‹©ï¼Œå³ç®¡ç†å‘˜æ‰‹åŠ¨é…ç½®ï¼Œä¸é€‚ç”¨äºå¤§å‹ç½‘ç»œï¼Œé€‚åˆå°çš„ã€å®‰å…¨è¦æ±‚é«˜çš„ç½‘ç»œ åŠ¨æ€è·¯ç”±ç®—æ³•ï¼šè‡ªé€‚åº”è·¯ç”±é€‰æ‹© é‡‡ç”¨åˆ†å±‚æ¬¡çš„è·¯ç”±é€‰æ‹©åè®®ï¼šï¼ˆ1ï¼‰å› ç‰¹ç½‘è§„æ¨¡å¤§ï¼ˆ2ï¼‰è®¸å¤šå•ä½ä¸æƒ³è®©å¤–ç•ŒçŸ¥é“è‡ªå·±çš„è·¯ç”±é€‰æ‹©åè®® å› æ­¤æŠŠäº’è”ç½‘åˆ’åˆ†ä¸ºè®¸å¤šè¾ƒå°çš„è‡ªæ²»ç³»ç»ŸASï¼Œä¸€ä¸ªASçš„æ‰€æœ‰è·¯ç”±å™¨åœ¨æœ¬è‡ªæ²»ç³»ç»Ÿå†…éƒ½åº”è¯¥ç›¸äº’è¿é€šï¼›ä¸€ä¸ªASå¯¹å…¶ä»–ASè¡¨ç°å‡ºæ˜¯ä¸€ä¸ªå•ä¸€çš„ä¸€è‡´çš„è·¯ç”±é€‰æ‹©ç­–ç•¥ï¼ˆåˆ†å±‚æ¬¡æ˜¯åˆ†æˆå†…éƒ¨å’Œå¤–éƒ¨ï¼‰ å†…éƒ¨ç½‘å…³åè®®IGPï¼Œä¸€ä¸ªASå†…ä½¿ç”¨ å¤–éƒ¨ç½‘å…³åè®®EGPï¼ŒASä¹‹é—´ä½¿ç”¨ å†…éƒ¨ç½‘å…³åè®® RIPåŸºäºè·ç¦»å‘é‡çš„è·¯ç”±é€‰æ‹©åè®®ï¼Œæœ€å¤§ä¼˜ç‚¹æ˜¯ç®€å•ï¼ˆé€‚ç”¨äºå°è§„æ¨¡ç½‘ç»œï¼‰ å®ƒè¦æ±‚ç½‘ç»œä¸­æ¯ä¸ªè·¯ç”±å™¨ç»´æŠ¤å®ƒä»å…¶ä»–æ¯ä¸ªç›®çš„ç½‘ç»œçš„å”¯ä¸€æœ€ä½³è·ç¦»çºªå½•ï¼ˆç»´æŠ¤çš„æ˜¯è·¯ç”±è¡¨ï¼‰ï¼Œä¹Ÿå°±æ˜¯æœ€çŸ­è·³æ•° RIPå…è®¸ä¸€æ¡è·¯ç”±æœ€å¤šåªèƒ½åŒ…å«15ä¸ªè·¯ç”±å™¨ï¼Œå› æ­¤è·ç¦»ä¸º16è¡¨ç¤ºç½‘ç»œä¸å¯è¾¾ï¼Œæ‰€ä»¥åªé€‚åˆå°è§„æ¨¡äº’è”ç½‘ RIPåè®®çš„ç‰¹ç‚¹ï¼š 1.ä»…å’Œç›¸é‚»çš„è·¯ç”±å™¨äº¤æ¢ä¿¡æ¯ 2.äº¤æ¢çš„ä¿¡æ¯æ—¶è‡ªå·±çš„è·¯ç”±è¡¨ 3.å›ºå®šæ—¶é—´é—´éš”äº¤æ¢è·¯ç”±ä¿¡æ¯ è·¯ç”±å™¨åˆšå¼€å§‹å·¥ä½œæ—¶ï¼ŒåªçŸ¥é“ç›´æ¥ç›¸è¿çš„å‡ ä¸ªç½‘ç»œçš„è·ç¦»ï¼ˆè·ç¦»å®šä¹‰ä¸º1ï¼‰ è·ç¦»å‘é‡ç®—æ³•ï¼š 1.ä¿®æ”¹ç›¸é‚»è·¯ç”±å™¨å‘æ¥çš„RIPæŠ¥æ–‡ä¸­æ‰€æœ‰è¡¨é¡¹ï¼Œå¯¹åœ°å€ä¸ºXçš„ç›¸é‚»è·¯ç”±å™¨å‘æ¥çš„RIPæŠ¥æ–‡ï¼Œä¸‹ä¸€è·³åœ°å€æ”¹ä¸ºXï¼Œå¹¶æŠŠæ‰€æœ‰â€œè·ç¦»â€å­—æ®µ+1 2.å¯¹ä¿®æ”¹åRIPæŠ¥æ–‡çš„æ¯ä¸ªé¡¹ç›®ï¼Œè‹¥åŸè·¯ç”±è¡¨æ²¡æœ‰ç›®çš„ç½‘ç»œNåˆ™æ·»åŠ ï¼›è‹¥å·²ç»å«æœ‰ï¼Œä¸”ä¸‹ä¸€è·³åœ°å€å’ŒåŸæ¥ä¸€æ ·ï¼Œåˆ™å³ä½¿è·³æ•°å¯èƒ½å¢å¤§ï¼Œä½†ä¹Ÿå¿…é¡»å‘ç”Ÿæ›´æ”¹ï¼›è‹¥å·²ç»å«æœ‰ï¼Œä¸”ä¸‹ä¸€è·³åœ°å€ä¸åŒï¼Œåˆ™å°†è·³æ•°ç›¸å¯¹è¾ƒå°çš„é¡¹ç›®æ›´æ–°å…¥è·¯ç”±è¡¨ 3.è‹¥180sæ²¡æ”¶åˆ°ç›¸é‚»è·¯ç”±è¡¨çš„æ›´æ–°ï¼Œåˆ™è®°ä¸ºä¸å¯è¾¾è·¯ç”±å™¨ï¼Œè·ç¦»è®¾ç½®ä¸º16 RIPå…¶å®æ˜¯åº”ç”¨å±‚çš„åè®®ï¼Œä½¿ç”¨UDPä¼ é€æ•°æ®ï¼Œä½¿ç”¨UDPâ€™æ— å¯é ä¿è¯ï¼Œä½†æ˜¯å¼€é”€å° å¥½æ¶ˆæ¯ä¼ å¾—å¿«ï¼Œåæ¶ˆæ¯ä¼ å¾—æ…¢ OSPFåè®®ä½¿ç”¨çš„æ˜¯è¿ªæ°æ–¯ç‰¹æ‹‰æœ€çŸ­è·¯å¾„ç®—æ³•ï¼Œé€‚ç”¨äºå¤§è§„æ¨¡äº’è”ç½‘ å®ƒæœ€ä¸»è¦çš„ç‰¹å¾å°±æ˜¯ä½¿ç”¨äº†åˆ†å¸ƒå¼é“¾è·¯çŠ¶æ€åè®® 30minæ›´æ–°ä¸€æ¬¡ ä¼ é€’åè®®ï¼šIP å¤–éƒ¨ç½‘å…³åè®® BGPå’Œå…¶ä»–ASé‚»ç«™BGPå‘è¨€äººäº¤æ¢ä¿¡æ¯ï¼Œäº¤æ¢ç½‘ç»œå¯è¾¾æ€§ä¿¡æ¯ï¼Œå‘ç”Ÿå˜åŒ–æ—¶æ›´æ–°æœ‰å˜åŒ–éƒ¨åˆ† ä¸ç”¨æ‰¾åˆ°æœ€ä½³è·¯å¾„ï¼Œæ‰¾åˆ°è¾ƒå¥½è·¯ç”±é€‰æ‹©å°±å¤Ÿäº† ä¼ é€’åè®®ï¼šTCPï¼Œä¿è¯å¯é çš„äº¤ä»˜ IPæ•°æ®æŠ¥æ ¼å¼åœ¨TCP/IPæ ‡å‡†ä¸­ï¼Œæ•°æ®æŠ¥æ ¼å¼ä¸­çš„æ•°æ®å¸¸å¸¸ä»¥32ä½ï¼ˆ4Byteï¼‰ä¸ºå•ä½æ¥æè¿° æ•°æ®æŠ¥é•¿åº¦ä¸èƒ½è¶…è¿‡MTUï¼ˆ1500å­—èŠ‚byteï¼‰ï¼Œå¦‚æœè¶…è¿‡äº†å°±åˆ†ç‰‡ åˆ†ç‰‡æµç¨‹ï¼š æ•°æ®æŠ¥ä¸­æœ‰æ ‡è¯†æ•°æ®æ®µï¼ŒåŒä¸€æ•°æ®æŠ¥åˆ†ç‰‡ä½¿ç”¨åŒä¸€æ ‡è¯† æ•°æ®æŠ¥ä¸­æœ‰æ ‡å¿—æ•°æ®æ®µï¼ŒDF = 1ç¦æ­¢åˆ†ç‰‡ï¼›DF = 0ï¼Œå…è®¸åˆ†ç‰‡ï¼Œåœ¨DF = 0çš„æ¡ä»¶ä¸‹ï¼ŒMF = 1åé¢è¿˜æœ‰åˆ†ç‰‡ï¼›MF = 0æœ€åä¸€å—æ²¡åˆ†ç‰‡ æ•°æ®æŠ¥ä¸­æœ‰ç‰‡åç§»æ•°æ®æ®µï¼ŒæŒ‡å‡ºè¾ƒé•¿åˆ†ç»„åˆ†ç‰‡åï¼ŒæŸç‰‡åœ¨åŸåˆ†ç»„ç›¸å¯¹ä½ç½®ï¼Œä»¥8Bä¸ºå•ä½ï¼Œæ‰€ä»¥èƒ½å¾—å‡ºé™¤äº†æœ€åä¸€ä¸ªåˆ†ç‰‡ï¼Œæ¯ä¸ªåˆ†ç‰‡çš„é•¿åº¦éƒ½ä¸€å®šæ˜¯8Bçš„æ•´æ•°å€ ipæ•°æ®æŠ¥å›ºå®šé¦–éƒ¨é•¿åº¦ä¸º20å­—èŠ‚ ipåœ°å€ipåœ°å€ï¼Œåœ¨å…¨ä¸–ç•ŒèŒƒå›´å†…å”¯ä¸€çš„32ä½æ ‡è¯†ç¬¦ï¼Œå¯ä»¥å”¯ä¸€æ ‡è¯†ä¸€ä¸ªä¸»æœºæˆ–è€…è·¯ç”±å™¨ç­‰è®¾å¤‡çš„æ¥å£ ipç¼–åˆ¶å†å²é˜¶æ®µï¼š 1.åˆ†ç±»çš„ipåœ°å€ 2.å­ç½‘çš„åˆ’åˆ† 3.æ„æˆè¶…ç½‘ åˆ†ç±»çš„ipåœ°å€ï¼šipåœ°å€{&lt;ç½‘ç»œå·&gt;, &lt;ä¸»æœºå·&gt;}ï¼Œå¦‚æœä¸»æœºè¿åœ¨ä¸€ä¸ªç½‘ç»œä¸Šï¼Œåˆ™ç½‘ç»œå·æ˜¯ç›¸åŒçš„ï¼Œä¸»æœºå·ä¸ç›¸åŒ åˆ†ç±»åˆ†æˆ5ç±»ï¼Œåˆ†ç±»æ–¹æ³•é å‰é¢çš„å››ä½æ¥åŒºåˆ† ï¼Œåˆ†ç±»å› ä¸ºå„ç½‘ç»œå·®å¼‚æ¯”è¾ƒå¤§ï¼Œæœ‰çš„ç½‘ç»œä¸»æœºæ•°å¤šï¼Œæœ‰çš„å°‘ï¼Œä¸”ipåœ°å€æ˜¯32ä½ï¼Œæˆ‘ä»¬ä¸ºäº†ä¾¿äºä¹¦å†™ï¼Œå¸¸å¸¸æ¯å…«ä½æ’å…¥ä¸€ä¸ªç©ºæ ¼ï¼ˆä½†åœ¨æœºå™¨ä¸­å¹¶æ²¡æœ‰è¿™æ ·çš„ç©ºæ ¼ï¼‰ Aç±»ï¼š2^7-2æ˜¯å› ä¸ºå…¨é›¶æŒ‡æœ¬ç½‘ï¼Œå…¨1ï¼›127æŒ‡å›ç¯ï¼Œ2^24-2æ˜¯å› ä¸ºå…¨é›¶æŒ‡æœ¬æœºï¼Œå…¨1æŒ‡å¹¿æ’­åœ°å€ Bç±»ï¼š128.0.0.0ä¸èƒ½æŒ‡æ´¾ï¼Œ2^14-1 Cç±»ï¼š192.0.0.0ä¸èƒ½åªæ´¾ï¼Œ2^21-1 ç‰¹æ®Šipåœ°å€ï¼š ç½‘ç»œå·å…¨0ï¼Œä¸»æœºå·å…¨0ï¼Œæœ¬ç½‘èŒƒå›´å†…æ ‡è¯†æœ¬ä¸»æœºï¼Œåªèƒ½ä½œä¸ºæºåœ°å€ ç½‘ç»œå·å…¨0ï¼Œä¸»æœºå·ç‰¹å®šå€¼ï¼Œæœ¬ç½‘èŒƒå›´æŸä¸»æœºï¼Œåªèƒ½ä½œä¸ºæºåœ°å€ ç½‘ç»œå·å…¨1ï¼Œä¸»æœºå·å…¨1ï¼Œæœ¬ç½‘å¹¿æ’­åœ°å€ï¼Œåªèƒ½ä½œä¸ºç›®çš„åœ°å€ ç½‘ç»œå·ç‰¹å®šå€¼ï¼Œä¸»æœºå·å…¨0ï¼Œç½‘ç»œåœ°å€ï¼Œè¡¨ç¤ºä¸€ä¸ªç½‘ç»œï¼Œå•¥ä¹Ÿä¸èƒ½ä½œ ç½‘ç»œå·ç‰¹å®šå€¼ï¼Œä¸»æœºå·å…¨1ï¼Œç›´æ¥å¹¿æ’­åœ°å€ï¼Œåªèƒ½ä½œä¸ºç›®çš„åœ°å€ï¼Œè¡¨ç¤ºå¯¹ç‰¹å®šç½‘ç»œä¸Šæ‰€æœ‰ä¸»æœºå¹¿æ’­ ç½‘ç»œå·127ï¼Œä¸»æœºå·ä»»æ„ï¼Œç”¨äºæœ¬åœ°è½¯ä»¶æµ‹è¯• åˆ†ç±»ipåœ°å€ç¼ºç‚¹ï¼šipåœ°å€ç©ºé—´åˆ©ç”¨ç‡æœ‰æ—¶å¾ˆä½ï¼›2çº§åœ°å€ä¸å¤Ÿçµæ´» localhostå’Œ0.0.0.0çš„åŒºåˆ«localhostæœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªåŸŸåï¼Œé€šå¸¸è¢«è§£æä¸º127.0.0.1 127.0.0.1å›ç¯åœ°å€ï¼Œè¡¨è¾¾çš„æ„æ€å…¶å®æ˜¯æˆ‘ä»¬ä¸»æœºå‘å‡ºå»çš„åŒ…ï¼Œç›´æ¥è¢«è‡ªå·±æ¥æ”¶ï¼Œ æ­£å¸¸æ•°æ®åŒ…æµç¨‹ï¼šåº”ç”¨å±‚-ä¼ è¾“å±‚-ç½‘ç»œå±‚-æ•°æ®é“¾è·¯å±‚-ç‰©ç†å±‚ è€Œå›ç¯åœ°å€è¢«ç½‘ç»œå±‚è·å–åˆ°ï¼Œä¸ä¼šå¾€ä¸‹æµ è€Œç›‘å¬127.0.0.1æ—¶ï¼ŒåŒç½‘æ®µä¸‹ä¸»æœºæ— æ³•é€šè¿‡ipåœ°å€è®¿é—® 0.0.0.0ï¼šç›‘å¬IPV4ä¸Šæ‰€æœ‰åœ°å€ï¼Œå†æ ¹æ®ç«¯å£æ‰¾åˆ°ä¸åŒçš„åœ°å€ æ¯”å¦‚æˆ‘ä»¬ç›‘å¬0.0.0.0æ—¶ï¼ŒåŒç½‘æ®µä¸‹çš„ä¸»æœºå¯ä»¥é€šè¿‡ipåœ°å€è®¿é—® å½“ç„¶æˆ‘ä»¬è¾“å…¥127.0.0.1ã€localhostä¹Ÿå¯ä»¥è®¿é—® å­ç½‘çš„åˆ’åˆ†ipåœ°å€{&lt;ç½‘ç»œå·&gt;, &lt;&lt;å­ç½‘å·&gt;ï¼Œ&lt;ä¸»æœºå·&gt;&gt;}ï¼Œä¸‰çº§çš„ipåœ°å€ï¼Œä½†æ˜¯å°±ç®—åˆ’åˆ†å­ç½‘åï¼Œå¯¹å¤–è¡¨ç°ä»ç„¶æ˜¯ä¸€ä¸ªç½‘ç»œï¼Œå³æœ¬å•ä½å¤–ç½‘ç»œçœ‹ä¸è§æœ¬å•ä½å†…å­ç½‘åˆ’åˆ† å­ç½‘å·èƒ½å¦å…¨0ã€å…¨1è¦çœ‹æƒ…å†µï¼Œä¸»æœºå·éƒ¨åˆ†ä»ç„¶ä¸èƒ½å…¨0ã€å…¨1 å­ç½‘æ©ç ï¼šæåŠ›æ¨èå­ç½‘æ©ç ä¸­ä½¿ç”¨è¿ç»­çš„1ï¼šæ¯”å¦‚Bç±» 11111111 11111111 11111111 00000000ï¼Œå­ç½‘æ©ç å’Œipåœ°å€ç›¸ä¸ï¼Œå°±å¯ä»¥å¾—åˆ°å­ç½‘ç½‘ç»œåœ°å€ è·¯ç”±è¡¨ä¸­åŒ…å«ï¼šç›®çš„ç½‘ç»œåœ°å€ã€ç›®çš„ç½‘ç»œå­ç½‘æ©ç ã€ä¸‹ä¸€è·³åœ°å€ ä½¿ç”¨å­ç½‘åˆ†ç»„è½¬å‘ 1.æå–ç›®çš„ipåœ°å€ 2.åˆ¤æ–­æ˜¯å¦å¯ç›´æ¥äº¤ä»˜ï¼Œç”¨ipåœ°å€ä¸å­ç½‘æ©ç ç›¸ä¸ï¼ŒåŒ¹é…åˆ™äº¤ä»˜ 3.è‹¥1-2æ­¥éª¤ä¸è¡Œï¼Œåˆ¤æ–­ç‰¹å®šä¸»æœºè·¯ç”± 4.è‹¥1-3æ­¥éª¤ä¸è¡Œï¼Œæ£€æµ‹è·¯ç”±è¡¨æœ‰æ— è·¯å¾„ï¼Œä¹Ÿæ˜¯ç›¸â€ä¸â€œåˆ¤æ–­ 5.è‹¥1-4æ­¥éª¤ä¸è¡Œï¼Œé»˜è®¤è·¯ç”±å¤„ç† 0.0.0.0 6.æœ€åè¿˜ä¸è¡Œä¸¢å¼ƒåˆ†ç»„ï¼ŒæŠ¥é”™ æ— åˆ†ç±»ç¼–å€CIDRæ˜¯å¦å¯ä»¥ä½¿ç”¨ä¸€ä¸ªå˜é•¿çš„å­ç½‘æ©ç ï¼Œè€Œéå®šé•¿çš„ï¼ŸCIDRæ¶ˆé™¤äº†ä¼ ç»ŸAã€Bã€Cç±»å’Œå­ç½‘åˆ’åˆ†çš„æ¦‚å¿µ ipåœ°å€{&lt;ç½‘ç»œå‰ç¼€&gt;ï¼Œ&lt;ä¸»æœºå·&gt;} CIDRçš„è®°æ³•ï¼šipåœ°å€ååŠ ä¸Š/ï¼Œç„¶åå†™ä¸Šç½‘ç»œå‰ç¼€çš„ä½æ•°å³å¯ 128.14.32.0/20ï¼Œåˆ™è¡¨ç¤ºå‰20ä½ä½ç½‘ç»œå‰ç¼€ CIDRæŠŠç½‘ç»œå‰ç¼€ç›¸åŒçš„è¿ç»­ipåœ°å€ç»„æˆä¸€ä¸ªCIDRåœ°å€å—æ­¤æ—¶æœ€å°åœ°å€ä¸ºï¼šç½‘ç»œå‰ç¼€ä¿æŒä¸å˜ï¼Œä¸»æœºå·å…¨0ï¼Œæœ€å¤§åœ°å€ä¸ºï¼šç½‘ç»œå‰ç¼€ä¿æŒä¸å˜ï¼Œä¸»æœºå·å…¨1 CIDRåœ°å€æ©ç ä¸ºç½‘ç»œå‰ç¼€çš„æ¯ä¸ªä½ï¼Œå¡«å……ä¸º1ï¼Œåé¢çš„ä¸»æœºå·ä½å¡«å……ä¸º0 æ„æˆè¶…ç½‘å®šä¹‰ï¼šå°†å¤šä¸ªå­ç½‘èšåˆæˆä¸€ä¸ªè¾ƒå¤§çš„å­ç½‘ï¼Œå«ä½œæ„æˆè¶…ç½‘æˆ–è·¯ç”±èšåˆï¼Œä½¿å¾—è·¯ç”±å™¨è½¬å‘è¡¨ä¸ç”¨å†™é‚£ä¹ˆå¤šæ•°æ® æ„æˆè¶…ç½‘æ–¹æ³•ï¼šå°†ç½‘ç»œå‰ç¼€ç¼©çŸ­ æœ€é•¿å‰ç¼€åŒ¹é…ï¼šä½¿ç”¨CIDRæ—¶ï¼ŒæŸ¥æ‰¾è·¯ç”±è¡¨å¯èƒ½å¾—åˆ°å‡ ä¸ªåŒ¹é…ç»“æœï¼Œåº”é€‰æ‹©å…·æœ‰æœ€é•¿ç½‘ç»œå‰ç¼€çš„è·¯ç”±ï¼Œå‰ç¼€è¶Šé•¿ï¼Œåœ°å€å—è¶Šå°ï¼Œè·¯ç”±è¶Šå…·ä½“ åœ¨CIDRä¸­å­ç½‘å·å¯å…¨0ã€å…¨1 ARPåè®®ARPé«˜é€Ÿç¼“å­˜ï¼šä¿å­˜çš„æ˜¯ipåœ°å€å’Œmacåœ°å€çš„æ˜ å°„ï¼ˆå¯¹åº”ï¼‰ï¼Œè§£å†³ä¸‹ä¸€è·³èµ°å“ªçš„é—®é¢˜ ï¼ˆDNSï¼‰å®ŒæˆåŸŸååˆ° IP åœ°å€çš„æ˜ å°„ï¼Œï¼ˆRARPï¼‰å®ç°MACåˆ°IPåœ°å€çš„æ˜ å°„;ï¼ˆARPï¼‰å®ç°IPåˆ°MAC. åœ¨å®é™…é“¾è·¯ä¸Šä¼ é€æ•°æ®å¸§æ—¶ï¼Œæœ€ç»ˆå¿…é¡»ä½¿ç”¨macåœ°å€ æ³¨æ„ï¼šç¡¬ä»¶åœ°å€åˆç§°ç‰©ç†åœ°å€ï¼Œä»å±‚æ¬¡çš„è§’åº¦ï¼Œç‰©ç†åœ°å€æ˜¯ç»™ç‰©ç†å±‚å’Œæ•°æ®é“¾è·¯å±‚ä½¿ç”¨çš„åœ°å€ï¼Œè€Œipåœ°å€æ—¶ç½‘ç»œå±‚å’Œä»¥ä¸Šå„å±‚ä½¿ç”¨çš„åœ°å€ï¼Œæ˜¯ä¸€ç§é€»è¾‘åœ°å€ï¼›ä»¥å¤ªç½‘å¸§åœ¨ä¼ è¾“è¿‡ç¨‹ä¸­æœ‰å…³å…¶å†…éƒ¨çš„macåœ°å€å’Œipåœ°å€çš„å˜åŒ–æƒ…å†µï¼šæºipåœ°å€å’Œç›®çš„ipåœ°å€ä¸ä¼šäº§ç”Ÿå˜åŒ–ï¼Œè€Œæºmacåœ°å€å’Œç›®çš„åœ°å€é€ç½‘ç»œï¼ˆæˆ–é€é“¾è·¯ï¼‰éƒ½å‘ç”Ÿå˜åŒ– ARPåè®®çš„ä½¿ç”¨ï¼š æ£€æŸ¥ARPé«˜é€Ÿç¼“å­˜æ˜¯å¦å·²ç»æœ‰å¯¹åº”çš„ipåœ°å€åˆ°macçš„æ˜ å°„è¡¨é¡¹,å¦‚æœæ²¡æœ‰æ‰§è¡Œä»¥ä¸‹æ­¥éª¤ å±€åŸŸç½‘ç»œå†…ï¼šæŸä¸»æœºè¦å‘å°„æ•°æ®å¸§ï¼Œä½†æ˜¯ä¸çŸ¥é“ç›®çš„ä¸»æœºçš„macåœ°å€ï¼Œä½†æ˜¯ç›´åˆ°å‘é€ä¸»æœºã€ç›®çš„ä¸»æœºçš„ipåœ°å€ï¼Œä»¥åŠçŸ¥é“è‡ªèº«çš„ç‰©ç†åœ°å€ï¼Œè¿™æ—¶å‘å°„ä¸»æœºå‘é€å¹¿æ’­è¯·æ±‚åˆ†ç»„ï¼ˆå…¨1ï¼‰ï¼Œæœ€åæ”¶åˆ°ç›®çš„ä¸»æœºçš„å•æ’­å“åº”åˆ†ç»„ï¼Œå¾—åˆ°è¯¥ä¸»æœºçš„macåœ°å€ï¼Œå†™å…¥ARPç¼“å­˜ å±€åŸŸç½‘å¤–ï¼šå¯„å¸Œæœ›äºé»˜è®¤ç½‘å…³ï¼ˆä¸å¤–ç•Œæ²Ÿé€šçš„è·¯ç”±å™¨ï¼‰ï¼Œè·³åˆ°è·¯ç”±å™¨çš„macåœ°å€ï¼Œç„¶åè¯¥è·¯ç”±å™¨å“åº”å‘é€ä¸»æœºçš„å¹¿æ’­è¯·æ±‚ï¼ŒæŠŠè·¯ç”±å™¨çš„macåœ°å€æ˜ å°„è¿”å›ï¼›ç„¶åä¸€ç›´ä¼ åˆ°ç›®çš„ä¸»æœºå±€åŸŸç½‘çš„è·¯ç”±å™¨çš„macåœ°å€ï¼Œè¿™æ—¶è¯¥å±€åŸŸç½‘è·¯ç”±å™¨å‘é€å¹¿æ’­è¯·æ±‚åˆ†ç»„ï¼ˆå…¨1ï¼‰ï¼Œæœ€åæ”¶åˆ°ç›®çš„ä¸»æœºçš„å•æ’­å“åº”åˆ†ç»„ï¼Œå¾—åˆ°è¯¥ä¸»æœºçš„macåœ°å€ ICMPåè®®ICMPå¾ªåºä¸»æœºæˆ–è·¯ç”±å™¨æŠ¥å‘Šå·®é”™æƒ…å†µå’Œæä¾›æœ‰å…³å¼‚å¸¸æƒ…å†µçš„æŠ¥å‘Š ICMPæŠ¥æ–‡ + ipæ•°æ®æŠ¥é¦–éƒ¨ = ipæ•°æ®æŠ¥çš„æ•°æ®éƒ¨ä»½ +ipæ•°æ®æŠ¥é¦–éƒ¨ = ipæ•°æ®æŠ¥ ICMPåˆ†ä¸ºï¼šICMPå·®é”™æŠ¥æ–‡å’ŒICMPè¯¢é—®æŠ¥æ–‡ ICMPå·®é”™æŠ¥æ–‡ï¼š1.ç»ˆç‚¹ä¸å¯è¾¾ï¼ˆæ— æ³•äº¤ä»˜é—®é¢˜ï¼‰ï¼›2.æ—¶é—´è¶…è¿‡ï¼ˆæ•°æ®æŠ¥ç”Ÿå­˜æ—¶é—´ä¸º0æˆ–è€…æ•°æ®æŠ¥ç‰‡æ²¡æœ‰æ”¶é›†å®Œæ•´ï¼Œåº”ç”¨ï¼šTracerouteï¼‰ï¼›3.å‚æ•°é—®é¢˜ï¼ˆé¦–éƒ¨å­—æ®µå‡ºé—®é¢˜ï¼‰ï¼›4.æ”¹å˜è·¯ç”±ï¼ˆé‡å®šå‘ï¼‰ ICMPè¯¢é—®æŠ¥æ–‡ï¼š1.å›é€è¯·æ±‚å’Œå›ç­”ï¼ˆæµ‹è¯•ç›®çš„æ ˆæ˜¯å¦å¯è¾¾ï¼Œåº”ç”¨ï¼šping xxipåœ°å€ï¼Œæµ‹è¯•ä¸¤ä¸ªä¸»æœºçš„è¿é€šæ€§ï¼‰ï¼›2.æ—¶é—´æˆ³è¯·æ±‚å’Œå›ç­” IPV632ä½çš„IPV4åœ°å€ç©ºé—´å·²ç»åˆ†é…æ®†å°½äº†ï¼ŒIPV6ä»æ ¹æœ¬è§£å†³åœ°å€è€—å°½é—®é¢˜ æ›´å¤§çš„åœ°å€ç©ºé—´ï¼šåŸæ¥çš„32ä½ -&gt; 128ä½ æ‹“å±•çš„åœ°å€å±‚æ¬¡ç»“æ„ã€çµæ´»çš„é¦–éƒ¨æ ¼å¼ã€æ”¹è¿›çš„é€‰é¡¹ã€‚ã€‚ã€‚ã€‚ã€‚ IPV6ç”±ä¸¤å¤§æ•°æ®éƒ¨åˆ†ç»„æˆï¼ŒåŸºæœ¬é¦–éƒ¨å’Œæœ‰æ•ˆè½½è· IPV6çš„è¡¨ç¤ºæ–¹æ³•ä¸ºï¼šå†’å·åå…­è¿›åˆ¶è®°æ³•ï¼Œå…è®¸é›¶å‹ç¼© IPV6å‘IPV4è¿‡æ¸¡ç­–ç•¥ï¼šåŒæ ˆåè®®ï¼ˆåŒæ—¶å¯ç”¨IPV4å’ŒIPV6ï¼‰ã€éš§é“æŠ€æœ¯ï¼ˆé‡æ–°å°è£…ï¼‰ 5.ä¼ è¾“å±‚ä¸»æœºæ‰ä¼šæœ‰çš„å±‚æ¬¡ï¼ŒåŠŸèƒ½æœ‰ï¼š æä¾›è¿›ç¨‹å’Œè¿›ç¨‹ä¹‹é—´çš„é€šä¿¡ï¼ˆç½‘ç»œå±‚æä¾›ä¸»æœºå’Œä¸»æœºä¹‹é—´çš„é€»è¾‘é€šä¿¡ï¼‰ å¤ç”¨å’Œåˆ†ç”¨ å¯¹æŠ¥æ–‡è¿›è¡Œå·®é”™æ£€æµ‹ ä¸¤ä¸ªåè®®ï¼ŒTCPå’ŒUDP ç«¯å£å·ä¼ è¾“å±‚æœ‰ä¸€ä¸ªç«¯å£ï¼ˆé€»è¾‘ç«¯å£/è½¯ä»¶ç«¯å£ï¼‰ï¼Œå®ƒå¯ä»¥å”¯ä¸€æ ‡è¯†ä¸€ä¸ªå…·ä½“çš„è¿›ç¨‹ï¼Œç«¯å£å·åªæœ‰æœ¬åœ°æ„ä¹‰ ç«¯å£å·é•¿åº¦ä¸º16bitï¼Œèƒ½è¡¨ç¤º65536ä¸ªä¸åŒç«¯å£å· åˆ†ä¸ºæœåŠ¡ç«¯å£å·å’Œå®¢æˆ·ç«¯å£å· æœåŠ¡ç«¯å£å·ï¼šç†ŸçŸ¥ç«¯å£å·ï¼ˆç»™TCP/IPæœ€é‡è¦çš„ä¸€äº›åº”ç”¨ç¨‹åºï¼Œ0-1023ï¼Œè®©æ‰€æœ‰ç”¨æˆ·éƒ½çŸ¥é“ï¼‰ã€ç™»è®°ç«¯å£å·ï¼ˆ1024-49151ï¼‰ å®¢æˆ·ç«¯å£å·ï¼š49152-65535ï¼Œä»…åœ¨å®¢æˆ·è¿›ç¨‹è¿è¡Œæ—¶æ‰åŠ¨æ€é€‰æ‹© é‡è¦ç«¯å£å·ï¼š ä¼ è¾“å±‚ä¸¤ä¸ªå¥½å…„å¼Ÿï¼Œå¤§å“¥TCPå’ŒäºŒå¼ŸUDPï¼Œå¤§å“¥é è°±ï¼ŒäºŒå¼Ÿä¸é è°± ä¼ è¾“å•å…ƒä¸ºæŠ¥æ–‡æ®µ TCPä¼ é€æ•°æ®å‰å¿…é¡»å»ºç«‹è¿æ¥ï¼Œä¸æä¾›å¹¿æ’­æˆ–å¤šæ’­ï¼Œæ—¶å»¶å¤§ï¼Œé€‚ç”¨å¤§æ–‡ä»¶ 1.é¢å‘è¿æ¥ï¼ˆè™šè¿æ¥ï¼‰çš„ä¼ è¾“æ§åˆ¶åè®® 2.æ¯ä¸€æ¡TCPåªèƒ½æœ‰ä¸¤ä¸ªç«¯ç‚¹ï¼Œç‚¹å¯¹ç‚¹ 3.TCPæä¾›å¯é äº¤ä»˜æœåŠ¡ 4.å…¨åŒå·¥é€šä¿¡ï¼Œå‘é€æ–¹çš„å‘é€ç¼“å­˜ï¼šå‡†å¤‡å‘é€çš„æ•°æ®&amp;å·²å‘é€ä½†å°šæœªæ”¶åˆ°ç¡®è®¤çš„æ•°æ®ï¼›æ¥æ”¶æ–¹çš„æ¥æ”¶ç¼“å­˜ï¼šæŒ‰åºåˆ°è¾¾ä½†è¿èƒŒæ¥å—åº”ç”¨è¯»å–&amp;ä¸æŒ‰åºåˆ°è¾¾çš„æ•°æ® 5.é¢å‘å­—èŠ‚æµ TCPé¦–éƒ¨æ ¼å¼æœ€å°é•¿åº¦ä¸º20å­—èŠ‚ åºå·ä¸ºå‘é€çš„æ•°æ®ï¼ˆæŠ¥æ–‡æ®µï¼‰çš„ç¬¬ä¸€ä¸ªå­—èŠ‚çš„åºå· ç¡®è®¤å·ï¼šç”¨äºæ¥æ”¶æ–¹å‘é€çš„TCPç¡®è®¤æŠ¥æ–‡æ®µï¼Œç¡®è®¤å·æ˜¯æœŸå¾…å‘é€æ–¹ä¸‹ä¸€ä¸ªæŠ¥æ–‡æ®µç¬¬ä¸€ä¸ªæ•°æ®å­—èŠ‚åºå· æ•°æ®åç§»ï¼šå®é™…ä¸Šå°±æ˜¯TCPé¦–éƒ¨é•¿åº¦ ç´§æ€¥URGï¼šURG = 1ï¼Œåœ¨å‘é€æŠ¥æ–‡æ®µæ—¶æ‹¥æœ‰æ’é˜ŸæƒåŠ› åŒæ­¥SYNï¼šå»ºç«‹è¿æ¥æ—¶åŒæ¥åŒæ­¥çš„ TCPè¿æ¥ç®¡ç†è¿æ¥çš„å»ºç«‹ -&gt; æ•°æ®çš„ä¼ é€ -&gt; è¿æ¥çš„é‡Šæ”¾ tcpè¿æ¥å»ºç«‹é‡‡ç”¨å®¢æˆ·æœåŠ¡å™¨æ–¹å¼ï¼Œä¸»åŠ¨å‘èµ·è¿æ¥çš„åº”ç”¨è¿›ç¨‹å«ä½œå®¢æˆ·ï¼Œè¢«åŠ¨ç­‰å¾…è¿æ¥å»ºç«‹çš„åº”ç”¨è¿›ç¨‹å«æœåŠ¡å™¨ è¿æ¥å»ºç«‹è¿‡ç¨‹ï¼šä¸‰æ¬¡æ¡æ‰‹ å®¢æˆ·ç«¯å‘é€æŠ¥æ–‡æ®µï¼Œé‡Œé¢æ— åº”ç”¨å±‚æ•°æ® SYNï¼ˆåŒæ­¥ä½ï¼‰ = 1ï¼ŒACK = 0ï¼Œseqï¼ˆåºå·ï¼‰ = xï¼ˆéšæœºï¼‰ æœåŠ¡å™¨ç«¯ä¸ºè¯¥TCPè¿æ¥åˆ†é…ç¼“å­˜å’Œå˜é‡ï¼Œå¹¶å‘å®¢æˆ·ç«¯è¿”å›ç¡®è®¤æŠ¥æ–‡æ®µï¼Œå…è®¸è¿æ¥ï¼Œæ— åº”ç”¨å±‚æ•°æ® SYN = 1ï¼ŒACKï¼ˆç¡®è®¤ä½ï¼‰ = 1ï¼Œseq = yï¼Œackï¼ˆç¡®è®¤å·ï¼‰ = x + 1. å®¢æˆ·ç«¯ä¸ºTCPè¿æ¥åˆ†é…ç¼“å­˜å’Œå˜é‡ï¼Œå¹¶å‘æœåŠ¡å™¨è¿”å›ç¡®è®¤çš„ç¡®è®¤ï¼Œå¯ä»¥æºå¸¦æ•°æ® SYN = 0ï¼ŒACK = 1ï¼Œseq = x + 1ï¼Œack = y + 1 2æ¬¡ä¸è¡Œï¼š å®¢æˆ·ç«¯å‘æœåŠ¡å™¨å‘é€å»ºç«‹è¿æ¥çš„è¯·æ±‚æŠ¥æ–‡æ®µï¼Œæœ‰å¯èƒ½å› ä¸ºç½‘ç»œæ»ç•™äº†ï¼Œä¹‹åç­‰åˆ°è¿™ä¸ªæ»ç•™æŠ¥æ–‡æ®µåˆ°è¾¾æœåŠ¡ç«¯æ—¶ï¼Œå®¢æˆ·ç«¯æ—©å·²é‡æ–°å‘é€è¯·æ±‚è¿æ¥çš„æŠ¥æ–‡ï¼Œè€ŒæœåŠ¡ç«¯ä¸è¿™ä¹ˆè®¤ä¸ºï¼ŒæœåŠ¡ç«¯ä»–ä»¥ä¸ºä½ å‘äº†æ–°çš„è¿æ¥è¯·æ±‚ï¼Œæ­¤æ—¶æœåŠ¡ç«¯å‘å®¢æˆ·ç«¯å‘é€ç¡®è®¤æŠ¥æ–‡ï¼Œè€Œå®¢æˆ·ç«¯æ”¶åˆ°è¿™ä¸ªå“åº”ï¼Œä½†æ˜¯å‘ç°è¿™ä¸ªè¯·æ±‚åœ¨ä¹‹å‰å°±å‘è¿‡äº†ï¼Œå°±ä¼šå¿½ç•¥ï¼Œè€Œæ­¤æ—¶æœåŠ¡ç«¯è‹¦è‹¦ç­‰å¾…å®¢æˆ·ç«¯çš„å“åº”ï¼Œè¿™æ ·å°±ä¼šé€ æˆèµ„æºæµªè´¹ å½“ç„¶ä¹Ÿå¯ä»¥æ¦‚æ‹¬ä¸ºï¼šå¹¶ä¸çŸ¥é“å®¢æˆ·ç«¯çš„æ¥å—èƒ½åŠ›æ˜¯å¦æ­£å¸¸ 4æ¬¡ä¸è¡Œï¼š æ„ä¹‰ä¸å¤§ï¼Œå› ä¸ºæ­¤æ—¶æˆ‘ä»¬éƒ½çŸ¥é“åŒæ–¹çš„å‘é€å’Œæ¥æ”¶åŠŸèƒ½éƒ½æ˜¯æ­£å¸¸çš„ æ´ªèŒƒæ”»å‡»ï¼šå‘ç”Ÿåœ¨osiç¬¬å››å±‚ï¼Œåˆ©ç”¨ä¸‰æ¬¡æ¡æ‰‹çš„ç‰¹æ€§ï¼Œæ‹¼å‘½å‘æœåŠ¡å™¨å‘é€å¤§é‡çš„TCP SYNï¼Œä¹Ÿå°±æ˜¯ä¸‰æ¬¡æ¡æ‰‹çš„ç¬¬ä¸€æ¬¡æ•°æ®åŒ…ï¼Œå½“æœåŠ¡å™¨è¿”å›ACKåï¼Œè¯¥æ”»å‡»è€…å°±ä¸å¯¹å…¶è¿›è¡Œç¡®è®¤ï¼Œè®©TCPå¤„äºæŒ‚èµ·çŠ¶æ€ï¼ŒæœåŠ¡å™¨æ”¶ä¸åˆ°å†ç¡®è®¤ï¼Œè¿˜ä¼šé‡å¤å‘é€ACKç»™æ”»å‡»è€…ï¼Œç„¶åæµªè´¹æœåŠ¡å™¨èµ„æºï¼Œæ¶ˆè€—CPUå’Œå†…å­˜ï¼Œå¯èƒ½å¯¼è‡´æœåŠ¡å™¨æ­»æœº è¿æ¥é‡Šæ”¾è¿‡ç¨‹ï¼šå››æ¬¡æŒ¥æ‰‹ï¼ˆå‚ä¸ä¸€æ¡TCPè¿æ¥çš„ä¸¤ä¸ªè¿›ç¨‹ä»»ä½•ä¸€ä¸ªéƒ½å¯ä»¥ç»ˆæ­¢è¯¥è¿æ¥ï¼Œè¿æ¥ç»“æŸåä¸»æœºä¸­çš„â€œèµ„æºâ€å°†è¢«é‡Šæ”¾ï¼‰ å®¢æˆ·ç«¯å‘é€è¿æ¥é‡Šæ”¾æŠ¥æ–‡æ®µï¼Œåœæ­¢å‘é€æ•°æ®ï¼Œä¸»åŠ¨å…³é—­TCP FINï¼ˆé‡Šæ”¾ä½ï¼‰ = 1ï¼Œseqï¼ˆåºå·ï¼‰ = u æœåŠ¡å™¨å›é€ç¡®è®¤æŠ¥æ–‡æ®µï¼Œå®¢æˆ·ç«¯åˆ°æœåŠ¡å™¨è¿™ä¸ªæ–¹å‘çš„è¿æ¥å°±é‡Šæ”¾äº†â€”-åŠå…³é—­çŠ¶æ€ ACK = 1ï¼Œseq = vï¼Œack = u+1 æœåŠ¡å™¨ç«¯å‘å®Œæ•°æ®ï¼Œå‘é€é‡Šæ”¾æŠ¥æ–‡æ®µï¼Œä¸»åŠ¨å…³é—­TCPè¿æ¥ FIN = 1ï¼ŒACK = 1ï¼Œseq = wï¼Œack = u+1 å®¢æˆ·ç«¯å›é€ä¸€ä¸ªç¡®è®¤æŠ¥æ–‡æ®µï¼Œå†ç­‰åˆ°æ—¶é—´ç­‰å¾…è®¡æ—¶å™¨è®¾ç½®çš„2MSLï¼ˆæœ€é•¿æŠ¥æ–‡æ®µå¯¿å‘½ï¼Œä¹Ÿå°±æ˜¯TIME_WAITçŠ¶æ€ï¼‰åï¼ˆé˜²æ­¢æœåŠ¡å™¨æœªæ¥æ”¶åˆ°ç¡®è®¤ï¼Œè¿™æ—¶æœåŠ¡å™¨å¯ä»¥åŠæ—¶å†æ¬¡å‘é€é‡Šæ”¾æŠ¥æ–‡æ®µï¼‰ï¼Œè¿æ¥å½»åº•å…³é—­ SYNï¼šåŒæ­¥åºåˆ—å·ï¼Œæ˜¯ç”¨æ¥å»ºç«‹è¿æ¥çš„æ¡æ‰‹ä¿¡å·ã€‚ ackï¼šç¡®è®¤åºå·ï¼Œå½“ACKä¸º1æ—¶ï¼Œackæœ‰æ•ˆï¼Œå½“ACKä¸º0æ—¶ï¼Œackæ— æ•ˆã€‚ seqï¼šåºå·ã€‚ ACKï¼šç¡®è®¤åºå·æœ‰æ•ˆã€‚ FIN: ç»“æŸæ ‡å¿—ï¼Œç”¨æ¥è¡¨ç¤ºæ–­å¼€è¿æ¥ã€‚ MSLï¼šçš„æ—¶é•¿è¢« RFC å®šä¹‰ä¸º 2åˆ†é’Ÿï¼Œä½†åœ¨ä¸åŒçš„ unix å®ç°ä¸Šï¼Œè¿™ä¸ªå€¼ä¸å¹¶ç¡®å®šï¼Œæˆ‘ä»¬å¸¸ç”¨çš„ centOS ä¸Šï¼Œå®ƒè¢«å®šä¹‰ä¸º 30sï¼Œ å½“ TCP è¿æ¥ä¸»åŠ¨å…³é—­æ—¶ï¼Œéƒ½ä¼šç»è¿‡ TIME_WAIT çŠ¶æ€ï¼š TCP å››æ¬¡æ¡æ‰‹ç»“æŸåï¼Œè¿æ¥åŒæ–¹éƒ½ä¸å†äº¤æ¢æ¶ˆæ¯ï¼Œä½†ä¸»åŠ¨å…³é—­çš„ä¸€æ–¹ä¿æŒè¿™ä¸ªè¿æ¥åœ¨ä¸€æ®µæ—¶é—´å†…ä¸å¯ç”¨ã€‚ TCPå¯é ä¼ è¾“ä¿è¯æ¥æ”¶æ–¹ä»ç¼“å­˜åŒºè¯»å‡ºçš„å­—èŠ‚æµä¸å‘é€æ–¹å‘å‡ºçš„å­—èŠ‚æµæ˜¯å®Œå…¨ä¸€æ ·çš„ 1.æ£€éªŒï¼Œä¸UDPä¸€æ ·ï¼Œå¢åŠ ä¼ªé¦–éƒ¨ 2.åºå·ï¼Œå¯¹åº”TCPé¦–éƒ¨æ ¼å¼çš„åºå· 3.ç¡®è®¤å·ï¼Œå¯¹åº”TCPé¦–éƒ¨æ ¼å¼çš„ç¡®è®¤å· 4.é‡ä¼ ï¼ˆè¶…æ—¶é‡ä¼ ï¼‰ï¼ŒTPCé‡‡ç”¨è‡ªé€‚åº”ç®—æ³•ï¼ŒåŠ¨æ€æ”¹å˜é‡ä¼ æ—¶é—´RTTsï¼ˆåŠ æƒå¹³å‡å¾€è¿”æ—¶é—´ï¼‰ 5.å†—ä½™ACKï¼Œå½“æ¯”æœŸæœ›åºå·å¤§çš„å¤±åºæŠ¥æ–‡æ®µåˆ°è¾¾æ—¶ï¼Œå‘é€å†—ä½™ACKï¼ŒæŒ‡æ˜ä¸‹ä¸€ä¸ªæœŸå¾…å­—èŠ‚çš„åºå·ï¼ˆå‘é€æ–¹æ”¶åˆ°3ä¸ªå†—ä½™ACKï¼Œåˆ™è®¤ä¸ºæŠ¥æ–‡æ®µä¸¢å¤±ï¼Œé€‰æ‹©é‡å‘ï¼‰ TCPæµé‡æ§åˆ¶åŒæ•°æ®é“¾è·¯å±‚çš„æ»‘åŠ¨çª—å£è¿›è¡Œæµé‡æ§åˆ¶ ä½†æ˜¯TCPçš„å‘é€çª—å£æ˜¯æ ¹æ®æ¥æ”¶æ–¹çš„æŠ¥æ–‡æ®µï¼ˆrwnd = 400ï¼Œåˆ™çª—å£å¤§å°ä¸º400Bï¼‰ï¼ŒåŠ¨æ€å˜åŒ–å…¶å¤§å°ï¼ˆåœ¨é“¾è·¯å±‚åœ¨å‘é€è¿‡ç¨‹ï¼Œå‘é€çª—å£å’Œæ¥æ”¶çª—å£å¤§å°å›ºå®šï¼‰ï¼Œå¦‚æœè®¾ç½®rwnd = 0ï¼Œåˆ™å‘é€ç«¯ç­‰å¾…æ¥æ”¶æ–¹å†æ¬¡å‘é€rwnnd &gt; 0 çš„æŠ¥æ–‡æ®µï¼Œå¦‚æœä¸€ç›´ç­‰ä¸åˆ°ï¼ˆå¯èƒ½æ¥æ”¶æ–¹è¿”å›çš„æŠ¥æ–‡æ®µä¸¢å¤±äº†ï¼‰ï¼ŒTCPè¿æ¥çš„ä¸€æ–¹ï¼ˆæ­¤æ—¶ä»æ˜¯0çª—å£å¤§å°ï¼‰å¯åŠ¨è®¡æ—¶å™¨å¼€å§‹è®¡æ—¶ï¼Œä¸€æ®µæ—¶é—´ç»“æŸåå‘é€é›¶çª—å£çš„è¯•æ¢æŠ¥æ–‡æ®µï¼Œç„¶åæ¥æ”¶æ–¹ä¼šå†å‘ä¸€æ¬¡åŸæ¥è¦è¿”å›çš„æŠ¥æ–‡æ®µ TCPæ‹¥å¡æ§åˆ¶å‡ºç°æ¡ä»¶ï¼šå¯¹èµ„æºçš„éœ€æ±‚&gt;å¯ç”¨èµ„æº ç½‘ç»œæ€§èƒ½ä¸‹é™ã€ç½‘ç»œååé‡éšè¾“å…¥è´Ÿè·å¢å¤§è€Œä¸‹é™ æ‹¥å¡æ§åˆ¶æ˜¯å…¨å±€æ€§çš„è¿‡ç¨‹ï¼Œé˜²æ­¢è¿‡å¤šæ•°æ®æ³¨å…¥ç½‘ç»œ æ‹¥å¡æ§åˆ¶çš„æ–¹æ³•ï¼š æ…¢å¼€å§‹ï¼šä¸è¦ä¸€å¼€å§‹å°±å‘é€å¤§é‡çš„æ•°æ®ï¼Œå…ˆæ¢æµ‹ä¸€ä¸‹ç½‘ç»œçš„æ‹¥å¡ç¨‹åº¦ï¼Œä¹Ÿå°±æ˜¯è¯´ç”±å°åˆ°å¤§é€æ¸å¢åŠ æ‹¥å¡çª—å£çš„å¤§å° æ‹¥å¡é¿å…ï¼šæ‹¥å¡çª—å£ç¼“æ…¢å¢é•¿ï¼Œå³æ¯ç»è¿‡ä¸€ä¸ªå¾€è¿”æ—¶é—´RTTå°±æŠŠå‘é€æ–¹çš„æ‹¥å¡çª—å£cwndåŠ 1ï¼Œè€Œä¸æ˜¯åŠ å€ã€‚è¿™æ ·æ‹¥å¡çª—å£æŒ‰çº¿æ€§è§„å¾‹ç¼“æ…¢å¢é•¿ã€‚ å¿«é‡ä¼ ï¼šå‘é€æ–¹åªè¦ä¸€è¿æ”¶åˆ°ä¸‰ä¸ªé‡å¤ç¡®è®¤å°±åº”å½“ç«‹å³é‡ä¼ å¯¹æ–¹å°šæœªæ”¶åˆ°çš„æŠ¥æ–‡æ®µï¼Œè€Œä¸å¿…ç»§ç»­ç­‰å¾…è®¾ç½®çš„é‡ä¼ è®¡æ—¶å™¨æ—¶é—´åˆ°æœŸ å¿«æ¢å¤ï¼š ï¼ˆ1ï¼‰å½“å‘é€æ–¹è¿ç»­æ”¶åˆ°ä¸‰ä¸ªé‡å¤ç¡®è®¤æ—¶ï¼Œå°±æ‰§è¡Œâ€œä¹˜æ³•å‡å°â€ç®—æ³•ï¼ŒæŠŠæ…¢å¼€å§‹é—¨é™å‡åŠã€‚è¿™æ˜¯ä¸ºäº†é¢„é˜²ç½‘ç»œå‘ç”Ÿæ‹¥å¡ï¼Œä½†ä¸æ‰§è¡Œæ…¢å¼€å§‹ç®—æ³•ã€‚ ï¼ˆ2ï¼‰ç”±äºå‘é€æ–¹ç°åœ¨è®¤ä¸ºç½‘ç»œå¾ˆå¯èƒ½æ²¡æœ‰å‘ç”Ÿæ‹¥å¡ï¼ˆå¦‚æœç½‘ç»œå‘ç”Ÿäº†ä¸¥é‡æ‹¥å¡ï¼Œå°±ä¸ä¼šä¸€è¿æœ‰å¥½å‡ ä¸ªæŠ¥æ–‡æ®µè¿ç»­åˆ°è¾¾æ¥æ”¶æ–¹ï¼Œä¹Ÿå°±ä¸ä¼šå¯¼è‡´æ¥æ”¶æ–¹è¿ç»­å‘é€é‡å¤ç¡®è®¤ï¼‰ã€‚å› æ­¤ä¸æ…¢å¼€å§‹ä¸åŒä¹‹å¤„å°±æ˜¯ç°åœ¨ä¸æ‰§è¡Œæ…¢å¼€å§‹ç®—æ³•ï¼ˆå³æ‹¥å¡çª—å£ç°åœ¨ä¸è®¾ç½®ä¸º1ï¼‰è€Œæ˜¯æŠŠæ‹¥å¡çª—å£çš„å€¼è®¾ç½®ä¸ºæ…¢å¼€å§‹é—¨é™å‡åŠåçš„å€¼ï¼Œç„¶åå¼€å§‹æ‰§è¡Œæ‹¥å¡é¿å…ç®—æ³•ï¼ˆâ€œåŠ æ³•å¢å¤§â€ï¼‰ï¼Œä½¿æ‹¥å¡çª—å£ç¼“æ…¢åœ°çº¿æ€§å¢å¤§ã€‚ å‘é€çª—å£ = Min{æ¥æ”¶çª—å£ï¼Œæ‹¥å¡çª—å£} æ¥æ”¶çª—å£ï¼šæ¥æ”¶æ–¹æ ¹æ®æ¥æ”¶ç¼“å­˜è®¾ç½®çš„å€¼ï¼Œååº”æ¥æ”¶æ–¹å®¹é‡ æ‹¥å¡çª—å£ï¼šå‘é€æ–¹æ ¹æ®è‡ªå·±ä¼°ç®—çš„ç½‘ç»œæ‹¥å¡ç¨‹åº¦è®¾ç½®çš„å€¼ï¼Œååº”å½“å‰ç½‘ç»œå®¹é‡ ä¸€ä¸ªä¼ è¾“è½®æ¬¡ = ä¸€ä¸ªRTT æ…¢å¼€å§‹ + æ‹¥å¡é¿å… æ…¢å¼€å§‹+æ‹¥å¡é¿å…+å¿«é‡ä¼ +å¿«æ¢å¤ UDPæ— è¿æ¥çš„ç”¨æˆ·æ•°æ®æŠ¥åè®® 1.ä¼ é€æ•°æ®å‰ä¸ç”¨å»ºç«‹è¿æ¥ï¼Œæ”¶åˆ°æŠ¥æ–‡åä¹Ÿä¸éœ€è¦ä»»ä½•ç¡®è®¤ï¼Œä¸ä¿è¯å¯é äº¤ä»˜ 2.UDPæ˜¯é¢å‘æŠ¥æ–‡çš„ï¼ˆé¢å¯¹åº”ç”¨å±‚äº¤ä¸‹æ¥çš„æŠ¥æ–‡ï¼Œä¸æ‹†åˆ†ä¹Ÿä¸åˆå¹¶ï¼Œä¿ç•™æŠ¥æ–‡è¾¹ç•Œï¼‰ï¼Œé€‚åˆä¸€æ¬¡æ€§ä¼ è¾“å°‘é‡æ•°æ®çš„ç½‘ç»œåº”ç”¨ï¼ˆå¤Ÿå°å°±å¯ä»¥å®Œæ•´äº¤ä»˜ï¼Œä¸ç”¨æ‹†åˆ†ï¼‰ï¼Œé€‚ç”¨å°æ–‡ä»¶ 3.æ— æ‹¥å¡æ§åˆ¶ï¼Œé€‚åˆå¾ˆå¤šå®æ—¶åº”ç”¨ 4.UDPé¦–éƒ¨å¼€é”€å°ï¼Œ8Bï¼›TCPåˆ™æ˜¯20Bï¼Œå’Œipæ•°æ®æŠ¥å›ºå®šé¦–éƒ¨é•¿åº¦ å®ƒåªåœ¨ipæ•°æ®æŠ¥æœåŠ¡ä¸Šå¢åŠ äº†å¤ç”¨åˆ†ç”¨ã€å·®é”™æ£€æµ‹åŠŸèƒ½ åœ¨åˆ†ç”¨æ—¶ï¼Œæ‰¾ä¸åˆ°å¯¹åº”ç«¯å£ï¼Œåˆ™å‘å‘é€æ–¹å‘é€ICMPâ€œç«¯å£å·ä¸å¯è¾¾â€å·®é”™æŠ¥æ–‡ æä¾›å…¨åŒå·¥æœåŠ¡ UDPæ ¡éªŒæ—¶ï¼š 1.ä¼šå‘ç°æœ‰â€œä¼ªé¦–éƒ¨â€ï¼Œå®ƒåªåœ¨è®¡ç®—æ ¡éªŒå’Œæ—¶æ‰å‡ºç°ï¼Œä¸å‘ä¸‹ä¼ é€ä¹Ÿä¸å‘ä¸Šé€’äº¤ 2.å…¨0å¡«å……æ•°æ®éƒ¨åˆ†å’Œæ ¡éªŒå’Œå­—æ®µ 3.ä¼ªé¦–éƒ¨+é¦–éƒ¨+æ•°æ®éƒ¨åˆ†é‡‡ç”¨äºŒè¿›åˆ¶åç æ±‚å’Œï¼ŒæŠŠå’Œï¼Œæ±‚å®ƒçš„åç ï¼Œå¡«å…¥æ ¡éªŒå’Œå­—æ®µï¼Œå»æ‰ä¼ªé¦–éƒ¨ï¼Œå‘é€ 4.æ¥æ”¶ç«¯å¡«ä¸Šä¼ªé¦–éƒ¨ï¼Œé‡‡ç”¨ä¼ªé¦–éƒ¨+é¦–éƒ¨+æ•°æ®éƒ¨åˆ†é‡‡ç”¨äºŒè¿›åˆ¶åç æ±‚å’Œï¼Œå…¨1æ— å·®é”™ï¼Œå¦åˆ™ä¸¢å¼ƒæ•°æ®æŠ¥/äº¤ç»™åº”ç”¨å±‚é™„ä¸Šå‡ºå·®é”™çš„è­¦å‘Š äºŒè¿›åˆ¶åç æ±‚å’Œ: è§„åˆ™æ˜¯ä»ä½åˆ°é«˜ä½é€åˆ—è¿›è¡Œbaiè®¡ç®—ï¼Œ0å’Œ0åŠ å¾—0,0å’Œ1åŠ å¾—1,1å’Œ1åŠ å¾—0ä½†è¦äº§ç”Ÿä¸€ä¸ªè¿›ä½1ï¼ŒåŠ åˆ°ä¸‹ä¸€åˆ—ï¼Œè‹¥æœ€é«˜ä½äº§ç”Ÿäº†è¿›ä½ï¼Œåˆ™æœ€åå¾—åˆ°çš„ç»“æœè¦åŠ 1ã€‚ 6.åº”ç”¨å±‚åº”ç”¨å±‚å¯¹åº”ç”¨ç¨‹åºçš„é€šä¿¡æä¾›æœåŠ¡ åº”ç”¨å±‚åè®®çš„å®šä¹‰ï¼š åº”ç”¨è¿›ç¨‹äº¤æ¢çš„æŠ¥æ–‡ç±»å‹ï¼Œè¯·æ±‚è¿˜æ˜¯å“åº” å„ç§æŠ¥æ–‡ç±»å‹çš„è¯­æ³•ï¼Œå¦‚æŠ¥æ–‡ä¸­å„ä¸ªå­—æ®µåŠå…¶è¯¦ç»†æè¿° å­—æ®µè¯­ä¹‰åŠå…¶åŒ…å«çš„ä¿¡æ¯å«ä¹‰ è¿›ç¨‹ä½•æ—¶ï¼Œå¦‚ä½•å‘é€æŠ¥æ–‡ åº”ç”¨å±‚åŠŸèƒ½ï¼š æ–‡ä»¶ä¼ è¾“ã€è®¿é—®å’Œç®¡ç† ç”µå­é‚®ä»¶ è™šæ‹Ÿç»ˆç«¯ æŸ¥è¯¢æœåŠ¡å’Œè¿œç¨‹ä½œä¸šç™»é™† æœ‰ä¸¤ç§æ¨¡å‹ï¼šå®¢æˆ·æœåŠ¡å™¨æ¨¡å‹ï¼ˆC/Sï¼‰ã€P2Pæ¨¡å‹ å®¢æˆ·æœåŠ¡å™¨æ¨¡å‹ï¼ˆC/Sï¼‰ï¼š æœåŠ¡å™¨ï¼šæä¾›è®¡ç®—æœåŠ¡çš„è®¾å¤‡ã€‚1. 24å°æ—¶æ°¸ä¹…æä¾›æœåŠ¡ï¼›2.æ°¸ä¹…æ€§è®¿é—®åœ°å€ å®¢æˆ·æœºï¼šè¯·æ±‚è®¡ç®—æœåŠ¡çš„ä¸»æœºï¼Œ1. ä¸æœåŠ¡å™¨é€šä¿¡ï¼Œä½¿ç”¨æœåŠ¡å™¨æä¾›çš„æœåŠ¡ï¼›2.é—´æ­‡æ€§æ¥å…¥ç½‘ç»œï¼›3.ä½¿ç”¨åŠ¨æ€çš„ipåœ°å€ï¼›4.ä¸ä¸å…¶ä»–å®¢æˆ·æœºç›´æ¥é€šä¿¡ P2Pæ¨¡å‹ï¼š æ— æœåŠ¡å™¨ æ¯ä¸ªä¸»æœºæ—¢å¯ä»¥æä¾›æœåŠ¡ï¼Œä¹Ÿå¯ä»¥è¯·æ±‚æœåŠ¡ï¼Œä»»æ„èŠ‚ç‚¹å¯ä»¥ç›´æ¥é€šè®¯ DNSåŸŸåè§£æç³»ç»ŸåŸŸåï¼šwww.baidu.com DNS: åŸŸå -&gt; ipåœ°å€ï¼ˆè§†ä¸ºä¸€ä¸ªç½‘ç»œç”µè¯ç°¿ï¼‰ åŸŸåè‡ªå·¦å‘å³ï¼Œçº§åˆ«ç”±ä½åˆ°é«˜ï¼Œåˆ†åˆ«å¯¹åº”ä¸‰çº§åŸŸåã€äºŒçº§åŸŸåã€é¡¶çº§åŸŸå äº¤ç»™åŸŸåæœåŠ¡å™¨è§£æåŸŸåï¼ŒåŸŸåæœåŠ¡å™¨åˆ†ä¸ºæ ¹åŸŸåæœåŠ¡å™¨ã€é¡¶çº§åŸŸåæœåŠ¡å™¨ã€æƒé™åŸŸåæœåŠ¡å™¨ã€æœ¬åœ°åŸŸåæœåŠ¡å™¨ï¼ˆæœ€è¿‘ï¼‰ 1.æ£€æŸ¥æµè§ˆå™¨ç¼“å­˜ä¸­æ˜¯å¦ç¼“å­˜è¿‡è¯¥åŸŸåå¯¹åº”çš„ipåœ°å€ 2.æ£€æŸ¥æœ¬æœºç³»ç»Ÿæ˜¯å¦ç¼“å­˜è¿‡è¯¥åŸŸåå¯¹åº”çš„ipåœ°å€ 3.å‘æœ¬åœ°åŸŸåè§£ææœåŠ¡ç³»ç»Ÿå‘èµ·åŸŸåè§£æçš„è¯·æ±‚ æœ¬åœ°åŸŸåç³»ç»Ÿä¸€èˆ¬éƒ½æ˜¯æœ¬åœ°åŒºçš„åŸŸåæœåŠ¡å™¨ï¼Œæ¯”å¦‚ä½ è¿æ¥çš„æ ¡å›­ç½‘ï¼Œé‚£ä¹ˆåŸŸåè§£æç³»ç»Ÿå°±åœ¨ä½ çš„æ ¡å›­æœºæˆ¿é‡Œï¼Œå¦‚æœä½ è¿æ¥çš„æ˜¯ç”µä¿¡ã€ç§»åŠ¨æˆ–è€…è”é€šçš„ç½‘ç»œï¼Œé‚£ä¹ˆæœ¬åœ°åŸŸåè§£ææœåŠ¡å™¨å°±åœ¨æœ¬åœ°åŒºï¼Œç”±å„è‡ªçš„è¿è¥å•†æ¥æä¾›æœåŠ¡ å¤§éƒ¨åˆ†è§£æï¼Œå‰ä¸‰ä¸ªæ­¥éª¤å·²ç»å®Œæˆäº†ï¼Œä¸‹é¢æ˜¯è¿˜æ‰¾ä¸åˆ°è§£æç»“æœçš„æ­¥éª¤ï¼š 4.å‘æ ¹åŸŸåè§£ææœåŠ¡å™¨å‘èµ·åŸŸåè§£æè¯·æ±‚ï¼ˆæ€»å…±13ä¸ªï¼Œç”±äºæ ¹åŸŸåçš„13ä¸ªåœ°å€å‡ ä¹ä¸å‘ç”Ÿå˜åŒ–ï¼Œæ‰€ä»¥åœ¨Local DNSçš„è½¯ä»¶é…ç½®æ–‡ä»¶é‡Œå†…ç½®äº†13ä¸ªæ ¹åŸŸåï¼‰ 5. æ ¹åŸŸåæœåŠ¡å™¨è¿”å›gTLDåŸŸåè§£ææœåŠ¡å™¨åœ°å€ -&gt; å‘gTLDæœåŠ¡å™¨å‘èµ·è§£æè¯·æ±‚ -&gt; gTLDæœåŠ¡å™¨æ¥æ”¶è¯·æ±‚å¹¶è¿”å›Name ServeræœåŠ¡å™¨ -&gt; Name ServeræœåŠ¡å™¨è¿”å›IPåœ°å€ç»™æœ¬åœ°æœåŠ¡å™¨ 6.æœ¬åœ°åŸŸåæœåŠ¡å™¨ç¼“å­˜è§£æç»“æœï¼Œå¹¶è¿”å›ç»“æœç»™ç”¨æˆ· å¤‡æ³¨ï¼šgTLDï¼šå›½é™…é¡¶çº§åŸŸå é¦–å…ˆ åœ¨æœ¬æœºåŸŸåè§£æçš„ç¼“å­˜ä¸­æŸ¥æ‰¾è¯¥åŸŸå ï¼Œè‹¥æ‰¾ä¸åˆ° -&gt; å‘ç»™æœ¬åœ°åŸŸåæœåŠ¡å™¨ï¼Œæ— æ³•è§£å†³-&gt;æ±‚åŠ©æ ¹åŸŸåæœåŠ¡å™¨-&gt; æŸ¥è¯¢é¡¶çº§åŸŸåæœåŠ¡å™¨ -&gt; æŸ¥è¯¢æƒé™åŸŸåæœåŠ¡å™¨ æ ¹åŸŸåæœåŠ¡å™¨ï¼šå…¨çƒå…±æœ‰13ä¸ªæ ¹åŸŸåæœåŠ¡å™¨ï¼Œ1ä¸ªä¸ºä¸»æ ¹æœåŠ¡å™¨åœ¨ç¾å›½ã€‚å…¶ä½™12ä¸ªå‡ä¸ºè¾…æ ¹æœåŠ¡å™¨,å…¶ä¸­9ä¸ªåœ¨ç¾å›½,æ¬§æ´²2ä¸ª,ä½äºè‹±å›½å’Œç‘å…¸,äºšæ´²1ä¸ªä½äºæ—¥æœ¬ é¡¶çº§åŸŸåï¼šæŒ‡çš„æ˜¯.comï¼ˆå•†ä¸šæœºæ„ï¼‰ã€.netï¼ˆç½‘ç»œæä¾›å•†ï¼‰ã€.eduï¼ˆæ•™è‚²æœºæ„ï¼‰ã€.cnï¼ˆä¸­å›½åŸŸåï¼‰ï¼›å…¨çƒå…±æœ‰13ä¸ª.comï¼ˆæˆ–è€…å…¶ä»–å‡ ä¸ªï¼‰é¡¶çº§åŸŸåæœåŠ¡å™¨ã€‚ æƒå¨åŸŸåï¼ˆæƒé™åŸŸåæœåŠ¡å™¨ï¼‰ï¼šä¸€èˆ¬æ˜¯æŒ‡èƒ½å¤Ÿæä¾›æœ€ç»ˆIPåœ°å€è§£æèƒ½åŠ›ï¼ˆæœ€ç»ˆIPåœ°å€æ˜¯ç”±è¿™ä¸ªNSæ¥è§£æçš„ï¼‰çš„ä¸€ç»„æœåŠ¡å™¨ åŸŸåè§£ææŸ¥è¯¢è¿‡ç¨‹ï¼š é€’å½’æŸ¥è¯¢ï¼ˆä¸€èˆ¬ä¸»æœº -&gt; å‘æœ¬åœ°åŸŸåè§£æå™¨æŸ¥è¯¢çš„è¿‡ç¨‹éƒ½æ˜¯é€’å½’æŸ¥è¯¢ï¼‰ å®¢æˆ·ç«¯åªå‘ä¸€æ¬¡è¯·æ±‚ï¼Œè¦æ±‚å¯¹æ–¹ç»™å‡ºæœ€ç»ˆç»“æœã€‚ è¿­ä»£æŸ¥è¯¢ï¼ˆé è‡ªå·±ï¼Œç”±è‡ªå·±æ¥æŸ¥è¯¢æ ¹åŸŸåæœåŠ¡å™¨ï¼Œé¡¶çº§åŸŸåæœåŠ¡å™¨ï¼Œä¸€èˆ¬æœ¬åœ°åŸŸåæœåŠ¡å™¨ -&gt; å‘æ ¹åŸŸåæœåŠ¡å™¨çš„æŸ¥è¯¢çš„è¿­ä»£æŸ¥è¯¢ï¼‰ å®¢æˆ·ç«¯å‘å‡ºä¸€æ¬¡è¯·æ±‚ï¼Œå¯¹æ–¹å¦‚æœæ²¡æœ‰æˆæƒå›ç­”ï¼Œå®ƒå°±ä¼šè¿”å›ä¸€ä¸ªèƒ½è§£ç­”è¿™ä¸ªæŸ¥è¯¢çš„å…¶å®ƒåç§°æœåŠ¡å™¨åˆ—è¡¨ï¼Œå®¢æˆ·ç«¯ä¼šå†å‘è¿”å›çš„åˆ—è¡¨ä¸­å‘å‡ºè¯·æ±‚ï¼Œç›´åˆ°æ‰¾åˆ°æœ€ç»ˆè´Ÿè´£æ‰€æŸ¥åŸŸåçš„åç§°æœåŠ¡å™¨ï¼Œä»å®ƒå¾—åˆ°æœ€ç»ˆç»“æœã€‚ ä¸‡ç»´ç½‘å’Œhttpåè®®ä¸‡ç»´ç½‘æ˜¯å¤§è§„æ¨¡ã€è”æœºå¼ä¿¡æ¯å‚¨è—æ‰€ï¼Œæ— æ•°ä¸ªç½‘ç»œç«™ç‚¹ã€ç½‘é¡µçš„é›†åˆ ç»Ÿä¸€èµ„æºå®šä½ç¬¦URLå¯ä»¥å”¯ä¸€æ ‡è¯†èµ„æºï¼ˆæ–‡å­—ã€è§†é¢‘ã€éŸ³é¢‘ï¼‰ URLï¼š &lt;åè®®&gt;://&lt;ä¸»æœº&gt;:&lt;ç«¯å£&gt;/&lt;è·¯å¾„&gt; httpé»˜è®¤80ç«¯å£å· åè®®ï¼šhttpã€ftp ä¸»æœºï¼šåŸŸåã€ipåœ°å€ ç«¯å£å’Œè·¯å¾„æœ‰æ—¶å¯ä»¥è¢«çœç•¥æ‰ httpåè®®å®šä¹‰äº†æµè§ˆå™¨æ€ä¹ˆå‘ä¸‡ç»´ç½‘æœåŠ¡å™¨è¯·æ±‚ä¸‡ç»´ç½‘æ–‡æ¡£ï¼Œä»¥åŠä¸‡ç»´ç½‘æ€ä¹ˆæŠŠæ–‡æ¡£ä¼ é€ç»™æµè§ˆå™¨ï¼šå»ºç«‹tcpè¿æ¥ -&gt; httpè¯·æ±‚æŠ¥æ–‡-&gt; httpå“åº”æŠ¥æ–‡ -&gt; é‡Šæ”¾TCPè¿æ¥ httpåè®®çš„ç‰¹ç‚¹ httpåè®®æ˜¯æ— çŠ¶æ€çš„ï¼Œä½†æ˜¯åœ¨å®é™…å·¥ä½œä¸­ï¼Œä¸€äº›ä¸‡ç»´ç½‘ç½‘ç«™å¸Œæœ›èƒ½è¯†åˆ«ç”¨æˆ·ï¼ˆç»™ç”¨æˆ·æ¨é”€äº§å“ï¼‰=&gt;è¯ç”Ÿäº†cookieå°é¥¼å¹²ï¼Œcookieæ˜¯å­˜å‚¨åœ¨ç”¨æˆ·ä¸»æœºçš„æ–‡æœ¬æ–‡ä»¶ï¼Œè®°å½•ä¸€æ®µæ—¶é—´å†…æŸç”¨æˆ·çš„è®¿é—®è®°å½•ï¼ˆä¸å¤ªæ•æ„Ÿçš„æ•°æ®ï¼‰ httpé‡‡ç”¨TCPä½œä¸ºè¿è¾“å±‚åè®®ï¼Œä½†æ˜¯httpåè®®æœ¬èº«æ˜¯æ— è¿æ¥çš„ ï¼ˆäº¤æ¢httpæŠ¥æ–‡ä¹‹å‰ä¸éœ€è¦å»ºç«‹è¿æ¥ï¼‰ httpè¿æ¥æ–¹å¼ï¼šæŒä¹…è¿æ¥ï¼ˆéæµæ°´çº¿å¼ï¼ˆæœ‰ç‚¹åƒåœç­‰åè®®ï¼‰ã€æµæ°´çº¿å¼ï¼ˆæœ‰ç‚¹åƒGBNæˆ–SRåè®®ï¼Œå³åé€€Nå¸§åè®®å’Œé€‰æ‹©é‡ä¼ åè®®ï¼‰ï¼‰ã€éæŒä¹…è¿æ¥ï¼ˆæ¯æ¬¡ä¼ è¾“éƒ½è¦ä¸‰æ¬¡æ¡æ‰‹ï¼‰ æ— çŠ¶æ€ï¼š æ‰€è°“çš„æ— çŠ¶æ€æ˜¯æŒ‡åè®®å¯¹äºäº‹åŠ¡å¤„ç†æ²¡æœ‰è®°å¿†èƒ½åŠ›ã€‚æœåŠ¡å™¨å‘å®¢æˆ·æœºå‘é€è¢«è¯·æ±‚çš„æ–‡ä»¶æ—¶ï¼Œå¹¶ä¸å­˜å‚¨ä»»ä½•å…³äºè¯¥å®¢æˆ·æœºçš„çŠ¶æ€ä¿¡æ¯ï¼Œäºæ˜¯ï¼Œä¸¤ç§ç”¨äºä¿æŒHTTPçŠ¶æ€çš„æŠ€æœ¯å°±åº”è¿è€Œç”Ÿäº†ï¼Œä¸€ä¸ªæ˜¯Cookieï¼Œè€Œå¦ä¸€ä¸ªåˆ™æ˜¯Sessionã€‚ ä»–ä¿æŒäº†æ¯æ¬¡è¯·æ±‚çš„ç‹¬ç«‹æ€§ï¼Œæ¯ä¸ªè¯·æ±‚åŒ…å«äº†å¤„ç†è¿™ä¸ªè¯·æ±‚æ‰€éœ€çš„å®Œæ•´çš„æ•°æ®ï¼Œå‘é€è¯·æ±‚ä¸æ¶‰åŠåˆ°çŠ¶æ€å˜æ›´ æ— è¿æ¥ï¼š å°±æ˜¯å‡å¦‚æŸä¸ªå®¢æˆ·æœºåœ¨çŸ­æ—¶é—´å¤šæ¬¡æ¬¡è¯·æ±‚åŒä¸€ä¸ªèµ„æºï¼ŒæœåŠ¡å™¨å¹¶ä¸èƒ½åŒºåˆ«æ˜¯å¦å·²ç»å“åº”è¿‡ç”¨æˆ·çš„è¯·æ±‚ï¼Œåè€Œæ¯æ¬¡éƒ½ä¸è€å…¶çƒ¦é‡æ–°å“åº”è¯·æ±‚ã€‚ 7.å…¶ä»–è‡­åæ˜­è‘—çš„æœ€åä¸€è‹±é‡Œé—®é¢˜ã€‚å…‰çº¤å›ºç„¶å¾ˆå¿«ï¼Œä½†æ˜¯è¦å°†æ‚¨çš„å®¶åº­æˆ–åŠå…¬å®¤è¿æ¥åˆ° Internetï¼Œæ‚¨çš„æœ¬åœ° ISP éœ€è¦åœ¨æ•´ä¸ªç¤¾åŒºå¸ƒçº¿ã€èšåˆä¿¡å·å¹¶å°†å…¶è½¬å‘åˆ°æœ¬åœ°è·¯ç”±èŠ‚ç‚¹ã€‚å®é™…ä¸Šï¼Œæ ¹æ®è¿æ¥ç±»å‹ã€è·¯ç”±æ–¹æ³•å’Œéƒ¨ç½²çš„æŠ€æœ¯ï¼Œä»…è¿™äº›å‰å‡ è·³å°±å¯èƒ½éœ€è¦æ•°åæ¯«ç§’ã€‚ æˆ‘ä»¬éƒ½ç†Ÿæ‚‰ IPv4 å’Œ IPv6ï¼Œä½† IPv{1,2,3,5} å‘ç”Ÿäº†ä»€ä¹ˆï¼ŸIPv4 ä¸­çš„ 4 ä»£è¡¨ TCP/IP åè®®çš„ç¬¬ 4 ç‰ˆï¼Œå®ƒäº 1981 å¹´ 9 æœˆå‘å¸ƒã€‚æœ€åˆçš„ TCP/IP ææ¡ˆè€¦åˆäº†è¿™ä¸¤ä¸ªåè®®ï¼Œè€Œ v4 è‰æ¡ˆæ­£å¼å°†ä¸¤è€…æ‹†åˆ†ä¸ºå•ç‹¬çš„ RFCã€‚å› æ­¤ï¼ŒIPv4 ä¸­çš„ v4 æ˜¯å…¶ä¸ TCP å…³ç³»çš„é—äº§ï¼šæ²¡æœ‰ç‹¬ç«‹çš„ IPv1ã€IPv2 æˆ– IPv3 åè®®ã€‚ å½“å·¥ä½œç»„åœ¨ 1994 å¹´å¼€å§‹ç ”ç©¶â€œä¸‹ä¸€ä»£äº’è”ç½‘åè®®â€ï¼ˆIPngï¼‰æ—¶ï¼Œéœ€è¦ä¸€ä¸ªæ–°çš„ç‰ˆæœ¬å·ï¼Œä½† v5 å·²ç»åˆ†é…ç»™å¦ä¸€ä¸ªå®éªŒåè®®ï¼šäº’è”ç½‘æµåè®®ï¼ˆSTï¼‰ã€‚äº‹å®è¯æ˜ï¼ŒST ä»æœªèµ·é£ï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆå¾ˆå°‘æœ‰äººå¬è¯´è¿‡å®ƒã€‚å› æ­¤æ˜¯ IPv6 ä¸­çš„ 6ã€‚ æ…¢å¯åŠ¨TCPä¸‰æ¬¡æ¡æ‰‹ä¹‹åï¼ŒæœåŠ¡å™¨ä¸ºæ¯ä¸ª TCP è¿æ¥åˆå§‹åŒ–ä¸€ä¸ªæ–°çš„æ‹¥å¡çª—å£ (cwnd) å˜é‡ï¼Œå¹¶å°†å…¶åˆå§‹å€¼è®¾ç½®ä¸ºä¸€ä¸ªä¿å®ˆçš„ã€ç³»ç»ŸæŒ‡å®šçš„å€¼ï¼ˆLinux ä¸Šçš„ initcwndï¼‰ã€‚ æ­¤å¤–ï¼Œå¼•å…¥äº†ä¸€ä¸ªæ–°è§„åˆ™ï¼šå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´ä¼ è¾“ï¼ˆæœªç¡®è®¤ï¼‰çš„æœ€å¤§æ•°æ®é‡æ˜¯ rwnd å’Œ cwnd å˜é‡ä¸­çš„æœ€å°å€¼ã€‚åˆ°ç›®å‰ä¸ºæ­¢ä¸€åˆ‡é¡ºåˆ©ï¼Œä½†æ˜¯æœåŠ¡å™¨å’Œå®¢æˆ·ç«¯å¦‚ä½•ç¡®å®šæ‹¥å¡çª—å£å¤§å°çš„æœ€ä½³å€¼å‘¢ï¼Ÿæ¯•ç«Ÿï¼Œç½‘ç»œæ¡ä»¶ä¸€ç›´åœ¨å˜åŒ–ï¼Œå³ä½¿åœ¨ç›¸åŒçš„ä¸¤ä¸ªç½‘ç»œèŠ‚ç‚¹ä¹‹é—´ï¼Œæ­£å¦‚æˆ‘ä»¬åœ¨å‰é¢çš„ç¤ºä¾‹ä¸­çœ‹åˆ°çš„é‚£æ ·ï¼Œå¦‚æœæˆ‘ä»¬å¯ä»¥ä½¿ç”¨è¯¥ç®—æ³•è€Œä¸å¿…ä¸ºæ¯ä¸ªè¿æ¥æ‰‹åŠ¨è°ƒæ•´çª—å£å¤§å°ï¼Œé‚£å°±å¤ªå¥½äº†ã€‚ è§£å†³æ–¹æ¡ˆæ˜¯ç¼“æ…¢å¯åŠ¨å¹¶åœ¨ç¡®è®¤æ•°æ®åŒ…æ—¶å¢åŠ çª—å£å¤§å°ï¼šæ…¢å¯åŠ¨ï¼åŸæ¥cwndçš„èµ·å§‹å€¼è®¾ç½®ä¸º1ä¸ªç½‘æ®µï¼›RFC 2581 åœ¨ 1999 å¹´ 4 æœˆå°†æ­¤å€¼æ›´æ–°ä¸º 4 ä¸ªæ®µï¼›æœ€è¿‘ï¼ŒRFC 6928 åœ¨ 2013 å¹´ 4 æœˆå†æ¬¡å°†è¯¥å€¼å¢åŠ åˆ° 10 ä¸ªæ®µã€‚ æ–° TCP è¿æ¥çš„æœ€å¤§ä¼ è¾“æ•°æ®é‡æ˜¯ rwnd å’Œ cwnd å€¼ä¸­çš„æœ€å°å€¼ï¼›å› æ­¤ï¼Œç°ä»£æœåŠ¡å™¨æœ€å¤šå¯ä»¥å‘å®¢æˆ·ç«¯å‘é€åä¸ªç½‘æ®µï¼Œæ­¤æ—¶å®ƒå¿…é¡»åœæ­¢å¹¶ç­‰å¾…ç¡®è®¤ã€‚ç„¶åï¼Œå¯¹äºæ¯ä¸ªæ¥æ”¶åˆ°çš„ ACKï¼Œæ…¢å¯åŠ¨ç®—æ³•æŒ‡ç¤ºæœåŠ¡å™¨å¯ä»¥å°†å…¶ cwnd çª—å£å¤§å°å¢åŠ ä¸€ä¸ªæ®µâ€”â€”å¯¹äºæ¯ä¸ª ACK æ•°æ®åŒ…ï¼Œå¯ä»¥å‘é€ä¸¤ä¸ªæ–°æ•°æ®åŒ…ã€‚TCP è¿æ¥çš„è¿™ä¸ªé˜¶æ®µé€šå¸¸è¢«ç§°ä¸ºâ€œæŒ‡æ•°å¢é•¿â€ç®—æ³•ï¼ˆå›¾ 2-3ï¼‰ï¼Œå› ä¸ºå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨æ­£è¯•å›¾åœ¨å®ƒä»¬ä¹‹é—´ç½‘ç»œè·¯å¾„ä¸Šçš„å¯ç”¨å¸¦å®½ä¸Šå¿«é€Ÿæ”¶æ•›ã€‚ ä¼˜åŒ–TCPTCP æ˜¯ä¸€ç§è‡ªé€‚åº”åè®®ï¼Œæ—¨åœ¨å¯¹æ‰€æœ‰ç½‘ç»œå¯¹ç­‰æ–¹å…¬å¹³å¹¶æœ€æœ‰æ•ˆåœ°åˆ©ç”¨åº•å±‚ç½‘ç»œã€‚å› æ­¤ï¼Œä¼˜åŒ– TCP çš„æœ€ä½³æ–¹æ³•æ˜¯è°ƒæ•´ TCP å¦‚ä½•æ„ŸçŸ¥å½“å‰ç½‘ç»œæ¡ä»¶å¹¶æ ¹æ®å…¶ä¸‹å±‚å’Œä¸Šå±‚çš„ç±»å‹å’Œè¦æ±‚è°ƒæ•´å…¶è¡Œä¸ºï¼šæ— çº¿ç½‘ç»œå¯èƒ½éœ€è¦ä¸åŒçš„æ‹¥å¡ç®—æ³•ï¼ŒæŸäº›åº”ç”¨ç¨‹åºå¯èƒ½éœ€è¦è‡ªå®šä¹‰æœåŠ¡è´¨é‡ (QoS) è¯­ä¹‰ä»¥æä¾›æœ€ä½³ä½“éªŒã€‚ è™½ç„¶æ¯ä¸ªç®—æ³•å’Œåé¦ˆæœºåˆ¶çš„å…·ä½“ç»†èŠ‚ä¼šä¸æ–­å‘å±•ï¼Œä½†æ ¸å¿ƒåŸåˆ™åŠå…¶å«ä¹‰ä¿æŒä¸å˜ï¼š TCP ä¸‰å‘æ¡æ‰‹å¼•å…¥äº†å®Œæ•´çš„å¾€è¿”å»¶è¿Ÿã€‚ TCP æ…¢å¯åŠ¨åº”ç”¨äºæ¯ä¸ªæ–°è¿æ¥ã€‚ TCP æµé‡å’Œæ‹¥å¡æ§åˆ¶è°ƒèŠ‚æ‰€æœ‰è¿æ¥çš„ååé‡ã€‚ TCP ååé‡ç”±å½“å‰æ‹¥å¡çª—å£å¤§å°è°ƒèŠ‚ã€‚ æ¨èé˜…è¯»ï¼š å¦‚ä½•å®Œæ•´ä¼˜åŒ–é¡µé¢é€Ÿåº¦(é«˜çº§æŒ‡å—)","categories":[{"name":"ç½‘ç»œ","slug":"ç½‘ç»œ","permalink":"https://taylor12138.github.io/categories/%E7%BD%91%E7%BB%9C/"}],"tags":[],"author":"Hello"},{"title":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","date":"2021-11-20T08:21:10.727Z","updated":"2021-11-20T08:21:10.727Z","comments":true,"path":"2021/11/20/shu-ju-jie-gou/","link":"","permalink":"https://taylor12138.github.io/2021/11/20/shu-ju-jie-gou/","excerpt":"","text":"çº¿æ€§ç»“æ„çº¿æ€§ç»“æ„ä½œä¸ºæœ€å¸¸ç”¨çš„æ•°æ®ç»“æ„ï¼Œå…¶ç‰¹ç‚¹æ˜¯æ•°æ®å…ƒç´ ä¹‹é—´å­˜åœ¨ä¸€å¯¹ä¸€çš„çº¿æ€§å…³ç³» æ¯”å¦‚æ•°ç»„ã€é“¾è¡¨ éçº¿æ€§ç»“æ„ä¸€èˆ¬æœªä¸€å¯¹å¤šçš„å½¢å¼ æ¯”å¦‚æ ‘ã€å¤šç»´æ•°ç»„ã€å›¾ç»“æ„ åŒå‘é“¾è¡¨åŒå‘é“¾è¡¨ï¼Œåˆç¨±ç‚ºåŒé“¾è¡¨ï¼Œæ˜¯é“¾è¡¨çš„ä¸€ç§ï¼Œå®ƒçš„æ¯ä¸ªæ•°æ®ç»“ç‚¹ä¸­éƒ½æœ‰ä¸¤ä¸ªæŒ‡é’ˆï¼Œåˆ†åˆ«æŒ‡å‘ç›´æ¥åç»§å’Œç›´æ¥å‰é©±ã€‚ æ‰€ä»¥ï¼Œä»åŒå‘é“¾è¡¨ä¸­çš„ä»»æ„ä¸€ä¸ªç»“ç‚¹å¼€å§‹ï¼Œéƒ½å¯ä»¥å¾ˆæ–¹ä¾¿åœ°è®¿é—®å®ƒçš„å‰é©±ç»“ç‚¹å’Œåç»§ç»“ç‚¹ã€‚ ä¸€èˆ¬æˆ‘ä»¬éƒ½æ„é€ åŒå‘å¾ªç¯é“¾è¡¨ã€‚ å¾ªç¯é˜Ÿåˆ—é˜Ÿåˆ—ï¼šæ˜¯ä¸€ç§å¯ä»¥åˆ†åˆ«åœ¨ä¸¤ç«¯è¿›è¡Œå¢åˆ çš„ç‰¹æ®Šçº¿æ€§è¡¨ã€‚æ—¢ç„¶æ˜¯çº¿æ€§è¡¨ï¼Œé‚£ä¹ˆå¯ä»¥ä½¿ç”¨é¡ºåºå­˜å‚¨å’Œé“¾å¼å­˜å‚¨æ¥å®ç° å¯¹äºé“¾å¼å­˜å‚¨ç»“æ„ï¼Œåˆ å‡å’Œå¢åŠ å…ƒç´ çš„æ“ä½œæ¯”è¾ƒæ–¹ä¾¿ ä½†æ˜¯å¯¹äºé¡ºåºå­˜å‚¨ç»“æ„ï¼Œåœ¨é˜Ÿå¤´è¿›è¡Œåˆ é™¤çš„æ—¶å€™ï¼Œä¼šæ¶‰åŠåˆ°è¿ç§»æ“ä½œï¼ˆåˆ é™¤é˜Ÿå¤´ï¼Œæ‰€æœ‰å…ƒç´ éƒ½è¦å¾€å‰ç§»åŠ¨ï¼‰ï¼Œæ­¤äº‹çš„è§£å†³æ–¹æ¡ˆå°±æ˜¯å¾ªç¯é˜Ÿåˆ—ï¼ˆåŒæ—¶é¿å…äº†æ—¶é—´å¤æ‚åº¦çš„æå‡å’Œç©ºé—´çš„æµªè´¹ï¼‰ frontæ˜¯æŒ‡å‘å¤´ç»“ç‚¹çš„æŒ‡é’ˆï¼Œrearæ˜¯æŒ‡å‘ä¸‹ä¸€ä¸ªè¦æ’å…¥ç»“ç‚¹çš„æŒ‡é’ˆ å€¼å¾—æ³¨æ„çš„æ˜¯ï¼š æ»¡çš„åˆ¤æ–­æ¡ä»¶åº”ä¸ºï¼š(rear+1)%LENGTH == front ã€‚ ç©ºçš„åˆ¤æ–­æ¡ä»¶ä¸º rear == frontã€‚ é“¾è¡¨VSæ•°ç»„æ•°ç»„ä¼˜ç‚¹ï¼šè®¿é—®é€Ÿåº¦å¿«ï¼Œå†…å­˜ä¸ºè¿ç»­çš„åŒºåŸŸ é“¾è¡¨ä¼˜ç‚¹ï¼šæ’å…¥ã€åˆ é™¤æ–¹ä¾¿ï¼Œå¤§å°ä¸å®šï¼ŒåŠ¨æ€æ·»åŠ  ä¸ºä»€ä¹ˆJSä¸­çš„æ•°ç»„æ—¶å¯ä»¥åŠ¨æ€è½¬å˜å¤§å°ï¼Ÿ JavaScript ä¸­çš„æ•°ç»„ï¼Œæœ¬è´¨ä¸Šè¿˜æ˜¯å¯¹è±¡ï¼Œä¸è¿‡ç”¨äº† Integer Index çš„é”®åè€Œå·²ï¼Œå’Œå¯¹è±¡å¹¶æ²¡æœ‰ä»€ä¹ˆæœ¬è´¨çš„åŒºåˆ« å †å †(Heap)æ˜¯è®¡ç®—æœºç§‘å­¦ä¸­ä¸€ç±»ç‰¹æ®Šçš„æ•°æ®ç»“æ„çš„ç»Ÿç§°ã€‚å †é€šå¸¸æ˜¯ä¸€ä¸ªå¯ä»¥è¢«çœ‹åšä¸€æ£µå®Œå…¨äºŒå‰æ ‘çš„æ•°ç»„å¯¹è±¡ã€‚ æ»¡äºŒå‰æ ‘ï¼šé™¤æœ€åä¸€å±‚æ— ä»»ä½•å­èŠ‚ç‚¹å¤–ï¼Œæ¯ä¸€å±‚ä¸Šçš„æ‰€æœ‰ç»“ç‚¹éƒ½æœ‰ä¸¤ä¸ªå­ç»“ç‚¹çš„äºŒå‰æ ‘ã€‚ å®Œå…¨äºŒå‰æ ‘çš„ç‰¹ç‚¹ï¼šå¶å­ç»“ç‚¹åªèƒ½å‡ºç°åœ¨æœ€ä¸‹å±‚å’Œæ¬¡ä¸‹å±‚ï¼Œä¸”æœ€ä¸‹å±‚çš„å¶å­ç»“ç‚¹é›†ä¸­åœ¨æ ‘çš„å·¦éƒ¨ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæ»¡äºŒå‰æ ‘è‚¯å®šæ˜¯å®Œå…¨äºŒå‰æ ‘ï¼Œè€Œå®Œå…¨äºŒå‰æ ‘ä¸ä¸€å®šæ˜¯æ»¡äºŒå‰æ ‘ã€‚ [1] Min-heap: çˆ¶èŠ‚ç‚¹çš„å€¼å°äºæˆ–ç­‰äºå­èŠ‚ç‚¹çš„å€¼ï¼›Max-heap: çˆ¶èŠ‚ç‚¹çš„å€¼å¤§äºæˆ–ç­‰äºå­èŠ‚ç‚¹çš„å€¼ï¼› å †å’ŒäºŒå‰æœç´¢æ ‘çš„åŒºåˆ« å †å¹¶ä¸èƒ½å–ä»£äºŒå‰æœç´¢æ ‘ï¼Œå®ƒä»¬ä¹‹é—´æœ‰ç›¸ä¼¼ä¹‹å¤„ä¹Ÿæœ‰ä¸€äº›ä¸åŒã€‚æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹ä¸¤è€…çš„ä¸»è¦å·®åˆ«ï¼š èŠ‚ç‚¹çš„é¡ºåºã€‚åœ¨äºŒå‰æœç´¢æ ‘ä¸­ï¼Œå·¦å­èŠ‚ç‚¹å¿…é¡»æ¯”çˆ¶èŠ‚ç‚¹å°ï¼Œå³å­èŠ‚ç‚¹å¿…é¡»å¿…æ¯”çˆ¶èŠ‚ç‚¹å¤§ã€‚ä½†æ˜¯åœ¨å †ä¸­å¹¶éå¦‚æ­¤ã€‚åœ¨æœ€å¤§å †ä¸­ä¸¤ä¸ªå­èŠ‚ç‚¹éƒ½å¿…é¡»æ¯”çˆ¶èŠ‚ç‚¹å°ï¼Œè€Œåœ¨æœ€å°å †ä¸­ï¼Œå®ƒä»¬éƒ½å¿…é¡»æ¯”çˆ¶èŠ‚ç‚¹å¤§ã€‚ å†…å­˜å ç”¨ã€‚æ™®é€šæ ‘å ç”¨çš„å†…å­˜ç©ºé—´æ¯”å®ƒä»¬å­˜å‚¨çš„æ•°æ®è¦å¤šã€‚ä½ å¿…é¡»ä¸ºèŠ‚ç‚¹å¯¹è±¡ä»¥åŠå·¦/å³å­èŠ‚ç‚¹æŒ‡é’ˆåˆ†é…å†…å­˜ã€‚å †ä»…ä»…ä½¿ç”¨ä¸€ä¸ªæ•°æ®æ¥å­˜å‚¨æ•°ç»„ï¼Œä¸”ä¸ä½¿ç”¨æŒ‡é’ˆã€‚ å¹³è¡¡ã€‚äºŒå‰æœç´¢æ ‘å¿…é¡»æ˜¯â€œå¹³è¡¡â€çš„æƒ…å†µä¸‹ï¼Œå…¶å¤§éƒ¨åˆ†æ“ä½œçš„å¤æ‚åº¦æ‰èƒ½è¾¾åˆ°O(log n)ã€‚ä½ å¯ä»¥æŒ‰ä»»æ„é¡ºåºä½ç½®æ’å…¥/åˆ é™¤æ•°æ®ï¼Œæˆ–è€…ä½¿ç”¨ AVL æ ‘æˆ–è€…çº¢é»‘æ ‘ï¼Œä½†æ˜¯åœ¨å †ä¸­å®é™…ä¸Šä¸éœ€è¦æ•´æ£µæ ‘éƒ½æ˜¯æœ‰åºçš„ã€‚æˆ‘ä»¬åªéœ€è¦æ»¡è¶³å †å±æ€§å³å¯ï¼Œæ‰€ä»¥åœ¨å †ä¸­å¹³è¡¡ä¸æ˜¯é—®é¢˜ã€‚å› ä¸ºå †ä¸­æ•°æ®çš„ç»„ç»‡æ–¹å¼å¯ä»¥ä¿è¯O(log n) çš„æ€§èƒ½ã€‚ æœç´¢ã€‚åœ¨äºŒå‰æ ‘ä¸­æœç´¢ä¼šå¾ˆå¿«ï¼Œä½†æ˜¯åœ¨å †ä¸­æœç´¢ä¼šå¾ˆæ…¢ã€‚åœ¨å †ä¸­æœç´¢ä¸æ˜¯ç¬¬ä¸€ä¼˜å…ˆçº§ï¼Œå› ä¸ºä½¿ç”¨å †çš„ç›®çš„æ˜¯å°†æœ€å¤§ï¼ˆæˆ–è€…æœ€å°ï¼‰çš„èŠ‚ç‚¹æ”¾åœ¨æœ€å‰é¢ï¼Œä»è€Œå¿«é€Ÿçš„è¿›è¡Œç›¸å…³æ’å…¥ã€åˆ é™¤æ“ä½œã€‚ æ•°ç»„åç§»é‡æ•°ç»„åç§»é‡ï¼šæ•°ç»„çš„æ ‡å‡†å®šä¹‰ä¸ºï¼šä¸€ä¸ªå­˜å‚¨å…ƒç´ çš„çº¿æ€§é›†åˆï¼ˆcollectionï¼‰ï¼Œå…ƒç´ å¯ä»¥é€šè¿‡ç´¢å¼•æ¥ä»»æ„å­˜å–ï¼Œç´¢å¼•é€šå¸¸ä¸ºæ•°å­—ï¼Œç”¨æ¥è®¡ç®—å…ƒç´ å­˜å‚¨ä½ç½®çš„åç§»é‡ å¦‚æœä½ æœ‰äº†è§£è¿‡å…¶ä»–è¯­è¨€ï¼Œå°±ä¼šçŸ¥é“æ‰€æœ‰ç¼–ç¨‹è¯­è¨€éƒ½æœ‰ç±»ä¼¼çš„æ•°æ®ç»“æ„ã€‚ä½†javascriptçš„æ•°ç»„å’Œå…¶ä»–è¯­è¨€æœ‰æ‰€ä¸åŒã€‚ JavaScriptä¸­çš„æ•°ç»„æ˜¯ä¸€ç§ç‰¹æ®Šçš„å¯¹è±¡ï¼Œç´¢å¼•ä¸ºè¯¥å¯¹è±¡çš„ç´ æ€§ï¼Œç´¢å¼•å¯èƒ½æ˜¯æ•´æ•°ã€‚ç„¶è€Œï¼Œè¿™äº›æ•°å­—ç´¢å¼•åœ¨å†…éƒ¨è¢«è½¬æ¢ä¸ºå­—ç¬¦ä¸²ç±»å‹ï¼Œè¿™æ˜¯å› ä¸ºJavaScriptå¯¹è±¡çš„å±æ€§åå¿…é¡»æ˜¯å­—ç¬¦ä¸²ç±»å‹ã€‚ JSçš„å­˜å‚¨èµ„æ–™åŸºæœ¬æ˜¯è¿™æ ·è¯´çš„: åŸºæœ¬æ•°æ®ç±»å‹ç”¨æ ˆå­˜å‚¨ï¼Œå¼•ç”¨æ•°æ®ç±»å‹ç”¨å †å­˜å‚¨ã€‚ ä½†æ˜¯è¿˜å¾—è¡¥å……ï¼šé—­åŒ…å˜é‡ä¹¦å­˜å‚¨ä¸å †ä¸­çš„ï¼Œæ¯•ç«Ÿå‡½æ•°è¢«è°ƒç”¨å®Œä¹‹åï¼Œæ ˆé¡¶ç©ºé—´é”€æ¯ï¼Œä½†æ˜¯é—­åŒ…è¿˜å¾—å­˜åœ¨ å¯¹äºç³»ç»Ÿæ ˆæ¥è¯´ï¼Œè°ƒç”¨ä»¥ä¸‹å‡½æ•° function f(a) { console.log(a); } function func(a) { f(a); } func(1); func + funcçš„ä¸Šä¸‹æ–‡å‹å…¥æ ˆåº• -&gt; f + fçš„ä¸Šä¸‹æ–‡å‹å…¥æ ˆåº• -&gt; æ‰§è¡Œå®Œæ¯•fï¼Œå¯¹åº”çš„æ ˆé¡¶ç©ºé—´è¢«å›æ”¶ -&gt; æ‰§è¡Œå®Œfuncï¼Œå¯¹åº”çš„æ ˆé¡¶ç©ºé—´è¢«å›æ”¶ ä¿®æ”¹å˜é‡çš„æ—¶å€™ï¼ˆåŸºæœ¬æ•°æ®ç±»å‹ï¼‰ : åœ¨å½“å‰ç©ºé—´æ ˆå¼€è¾Ÿä¸€ä¸ªåœ°å€ï¼Œå¹¶ä¸”èµ‹äºˆä¸€ä¸ªå€¼ï¼Œç„¶åä¿®æ”¹åŸæœ¬å˜é‡çš„çš„åœ°å€ å¦‚ä¸‹é¢çš„fooå˜é‡ let foo = 1; let bar = 2; let obj = { foo: 1, bar: 2 }; let x = foo foo = 'foo' //å°† foo çš„å¼•ç”¨åœ°å€ä¿®æ”¹ä¸º 0x0204ã€‚ å¦‚æœç¢°åˆ°constï¼Œåˆ™ä¼š const foo = 'foo'; foo = 'bar'; // Error æ¨èé“¾æ¥https://blog.csdn.net/weixin_40013817/article/details/103287271 JAVAçš„HashMapHashMapæ˜¯ä¸€ä¸ªæ•°ç»„+é“¾è¡¨çš„ç»“åˆï¼Œé€šè¿‡keyè®¡ç®—å“ˆå¸Œå€¼ï¼Œæ”¾å…¥â€œæ¡¶â€ï¼Œå¦‚æœå½“å‰æ¡¶å·²ç»å­˜æ”¾è¿‡ï¼Œåˆ™å°†ä»¥é“¾è¡¨çš„å½¢å¼åŠ å…¥æ¡¶çš„åé¢ å½“æ¯ä¸ªæ¡¶çš„é“¾è¡¨åªæœ‰ä¸€ä¸ªå…ƒç´ çš„æ—¶å€™ï¼Œåˆ™å­˜å‚¨æ•ˆç‡æœ€é«˜ï¼Œä½†å¦‚æœé“¾è¡¨è¿‡é•¿ï¼ˆç¢°æ’æ¬¡æ•°è¿‡å¤šï¼‰ï¼Œåˆ™ååˆ†ä¸ç†æƒ³ ä¼˜åŒ–hashç®—æ³•ï¼š åˆå§‹åŒ–HashMapä¸­Hashç®—æ³•å‡å°‘ç¢°æ’çš„ä¸¤ä¸ªåšæ³•ï¼š Hashæ–¹æ³•ä¸­å­˜åœ¨å¥‡æ€ªçš„ä½ç§»è¿ç®—ï¼Œä»¥ä½¿æœ€ç»ˆçš„Hashå€¼ä¸­0å’Œ1è¾ƒä¸ºå‡åŒ€ã€‚ ä½¿ç”¨h &amp; ï¼ˆlength-1ï¼‰æ¥è¿›è¡Œæ¡¶çš„å®šä½ï¼Œlengthåº”ä¸º2çš„æŒ‡æ•°å¹‚ã€‚ ä¸ºä»€ä¹ˆå½“HashMapåˆå§‹åŒ–å¤§å°ä¸º2çš„æŒ‡æ•°å¹‚æ—¶ï¼Œæ•ˆç‡æœ€é«˜ï¼Ÿ h&amp;ï¼ˆlength-1ï¼‰åŸç†æ—¶ï¼Œæ¯”å¦‚å’Œ14ï¼ˆ1110ï¼‰ è¿›è¡Œä¸è¿ç®—ï¼Œ0001ã€0011ã€0101ã€1001ã€1011ã€0111ã€1101è¿™å‡ ä¸ªä½ç½®æ°¸è¿œéƒ½ä¸èƒ½å­˜æ”¾å…ƒç´ ï¼Œç©ºé—´æµªè´¹ç›¸å½“å¤§ å›å¤´çœ‹ä¸€ä¸‹ HashMap ä¸­é»˜è®¤çš„æ•°ç»„å¤§å°ï¼ŒæŸ¥çœ‹æºä»£ç å¯ä»¥å¾—çŸ¥æ˜¯16ï¼Œä¸ºä»€ä¹ˆæ˜¯16è€Œä¸æ˜¯15ï¼Œä¹Ÿä¸æ˜¯20å‘¢ï¼Ÿå› ä¸º16æ˜¯2çš„æ•´æ•°æ¬¡å¹‚ï¼Œåœ¨æ•°æ®é‡å°çš„æƒ…å†µä¸‹16æ¯”15å’Œ20æ›´èƒ½å‡å°‘ç¢°æ’ï¼Œè¿›è€Œæé«˜æŸ¥è¯¢çš„æ•ˆç‡ã€‚ æ‰©å®¹å½“HashMapä¸­çš„å…ƒç´ è¶Šæ¥è¶Šå¤šçš„æ—¶å€™ï¼Œç¢°æ’çš„æ¦‚ç‡ä¹Ÿå°±è¶Šæ¥è¶Šé«˜ï¼ˆå› ä¸ºæ•°ç»„çš„é•¿åº¦æ˜¯å›ºå®šçš„ï¼‰ï¼Œæ‰€ä»¥ä¸ºäº†æé«˜æŸ¥è¯¢æ•ˆç‡ï¼Œå°±è¦å¯¹ HashMap çš„æ•°ç»„è¿›è¡Œæ‰©å®¹ å½“HashMapä¸­çš„å…ƒç´ ä¸ªæ•°è¶…è¿‡æ•°ç»„å¤§å°loadFactoræ—¶ï¼Œå°±ä¼šè¿›è¡Œæ•°ç»„æ‰©å®¹ï¼ŒloadFactor çš„é»˜è®¤å€¼ä¸º0.75ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨é»˜è®¤æƒ…å†µä¸‹ï¼Œæ•°ç»„å¤§å°ä¸º16ï¼Œå½“HashMapä¸­å…ƒç´ ä¸ªæ•°è¶…è¿‡16Ã—0.75=12çš„æ—¶å€™ï¼Œå°±æŠŠæ•°ç»„çš„å¤§å°æ‰©å±•ä¸º2Ã—16=32ï¼Œå³æ‰©å¤§ä¸€å€ï¼Œç„¶åé‡æ–°è®¡ç®—æ¯ä¸ªå…ƒç´ åœ¨æ•°ç»„ä¸­çš„ä½ç½®ã€‚","categories":[{"name":"personal","slug":"personal","permalink":"https://taylor12138.github.io/categories/personal/"}],"tags":[],"author":"Hello"},{"title":"Vue3(ä¸Š)","slug":"Vue3(ä¸Š)","date":"2021-11-04T16:00:00.000Z","updated":"2022-03-04T06:49:42.317Z","comments":true,"path":"2021/11/05/vue3-shang/","link":"","permalink":"https://taylor12138.github.io/2021/11/05/vue3-shang/","excerpt":"","text":"1.Vue3 Startä»–åœ¨ä»‹ç»ä¸­è¡¨æ˜çš„æ˜¯ï¼š æ›´å°ã€æ›´å¿«ã€æ›´æ˜“ç»´æŠ¤ï¼Œä¸€äº›å‘½ä»¤çš„å˜åŒ–ã€‚ 3.0 æ–°åŠ å…¥äº† TypeScript ä»¥åŠ PWA çš„æ”¯æŒ æ”¯æŒäº† composiiton API vdomçš„å¯¹æ¯”ç®—æ³•æ›´æ–°ï¼Œåªæ›´æ–°ç»‘å®šäº†åŠ¨æ€æ•°æ®éƒ¨åˆ† å•ç‹¬åŠŸèƒ½å¯ä»¥æŠ½ç¦» å–ä»£äº†mixinï¼ˆå°¤é›¨æºªä½œè€…æœ¬äººæŒ‡å‡ºminxinæ¨¡å—æ¥æºä¸æ¸…æ™°ã€å‘½åé—®é¢˜ã€æ€§èƒ½å¼€é”€é—®é¢˜ï¼‰ æºç æ”¹åŠ¨ å®ƒçš„æºç æ˜¯é€šè¿‡monorepoçš„å½¢å¼ç®¡ç†æºä»£ç çš„ Monoå•ä¸ª Repoï¼šrepositoryä»“åº“ ä¸»è¦æ˜¯å°†è®¸å¤šé¡¹ç›®çš„ä»£ç å­˜å‚¨åœ¨åŒä¸€ä¸ªrepositoryä»“åº“ä¸­ï¼Œï¼Œè¿™æ ·çš„è¯å¯ä»¥è®©å¤šä¸ªåŒ…ç›¸äº’ç‹¬ç«‹çš„åŒæ—¶ï¼Œåˆåœ¨åŒä¸€ä¸ªä»“åº“ä¸‹ç®¡ç† ä½¿ç”¨TypeScriptè¿›è¡Œä»£ç é‡å†™ æ€§èƒ½æ”¹åŠ¨ ä½¿ç”¨Proxyè¿›è¡Œæ•°æ®åŠ«æŒï¼Œè¿™ä¹Ÿåœ¨ä¹‹å‰åšVue2ç¬”è®°çš„æ—¶å€™æåŠè¿‡ï¼Œé¿å…äº†å¾ˆå¤šç´¢å¼•ç±»çš„bug åˆ é™¤äº†ä¸€äº›æ²¡å¿…è¦çš„APIï¼Œå¦‚$onã€$offã€$onceç­‰ï¼Œåˆ é™¤äº†ä¸€äº›ç‰¹æ€§ï¼Œå¦‚filterã€å†…è”æ¨¡æ¿ç­‰ ç¼–è¯‘ä¼˜åŒ–ï¼Œç”Ÿæˆblock treeã€Slotç¼–è¯‘ä¼˜åŒ–ã€diffç®—æ³•ä¼˜åŒ– æ–°çš„API Options API -&gt; Composition API ä½¿ç”¨Hookså‡½æ•°å¢åŠ ä»£ç çš„å¤ç”¨æ€§ åœ¨Vue2çš„æ—¶å€™ä¹Ÿæ˜¯å› ä¸ºOptionså’Œmixinsç›¸äº’å…³è”ï¼Œå¤šä¸ªmixinsè¿˜æœ‰å‘½åå†²çªé—®é¢˜ åŸºç¡€è¯­æ³•åŸºç¡€è¯­æ³•å’ŒVue2å¤§è‡´ç›¸åŒï¼Œé™¤äº† åŸæ¥ const app = new Vue({}) å˜æˆäº† const app = Vue.createApp({}) æŸ¥çœ‹æºç ï¼ˆ2021/11/6ï¼‰ï¼Œåœ¨å®˜ç½‘git cloneé¡¹ç›®ï¼Œä½¿ç”¨pnpmä¸‹è½½ä¾èµ–ï¼Œä½¿ç”¨ yarn devæ‰“åŒ…å‡ºæ–‡ä»¶è¿›è¡Œè°ƒè¯•ï¼Œç„¶ååœ¨é¡¹ç›®ä¸‹å¼•ç”¨è¿™ä¸ªæ‰“åŒ…å¥½çš„åŒ…ï¼ˆ/dist/vue.global.jsï¼‰å³å¯ å¯ä»¥åœ¨webpackçš„è®¾ç½®é‡Œé¢ \"scripts\": { \"dev\": \"node scripts/dev.js --sourcemap\", //... } æ­¤æ—¶å†æ¬¡æ‰“å®ŒåŒ…ä¹‹åä¼šåœ¨distä¸‹å‡ºç°ä¸€ä¸ª vue.global.js.map æ–‡ä»¶ï¼Œæ­¤æ—¶è°ƒè¯•ä»£ç çš„æ—¶å€™ è¿›è¡Œ step into next functionå¯ä»¥è·³è½¬åˆ°è¾¾æ–‡ä»¶å¤¹è€Œéæ‰“åŒ…æ–‡ä»¶ä¸‹å¯¹åº”çš„æ–¹æ³• æ³¨æ„ï¼šéœ€è¦åœ¨chromeçš„settingé‡Œè®¾ç½® Enable JavaScript source map é˜…è¯»æºç æ¨èçš„æ’ä»¶ï¼švscodeçš„æ‹“å±•æ’ä»¶bookmarksï¼Œç„¶åcontrol + option + k é”®å³å¯æ ‡è®°å½“å‰å‡½æ•°ï¼Œä»¥åæ–¹ä¾¿åœ¨æ‹“å±•ä¸­ç›´æ¥æ‰¾åˆ°ï¼ˆè¿˜èƒ½æ˜æ˜æ ‡è®°åç§°ï¼‰ï¼›é‡å¤ control + option + ké”®å¯ä»¥å–æ¶ˆ 2.å›é¡¾VnodeVNodeå…¨ç§°Virtual Nodeï¼Œä¹Ÿå°±æ˜¯è™šæ‹ŸèŠ‚ç‚¹ï¼ˆVNode Treeç»„æˆè™šæ‹ŸDOMï¼‰ï¼›åœ¨Vueä¸­æ— è®ºå¤§å¤§å°å°å…ƒç´ éƒ½å¯ä»¥åœ¨Vueä¸­è¢«VNodeè¡¨ç¤ºå‡ºæ¥ï¼Œ ç±»ä¼¼å¦‚ä¸‹ const vnode = { type: \"div\", props: { class: \"title\" }, children: \"hello world\" } å®ƒæœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œä½œä¸ºä¸€ä¸ªå¯¹è±¡è€Œæœªè½¬åŒ–ä¸ºDOMï¼Œæœ€å¤§çš„å¥½å¤„åœ¨äºå¤šå¹³å°çš„é€‚é… diffvue3çš„diffåšäº†ä¸€ç‚¹ä¼˜åŒ– å¯¹äºdiffç®—æ³•æ¥è¯´ï¼Œå¦‚æœåˆ—è¡¨ä¸­æœ‰keyï¼Œåˆ™æ‰§è¡Œ patchKeyedChildrenæ–¹æ³•ï¼›æ²¡æœ‰ keyï¼Œæ‰§è¡Œ patchUnkeyedChildrenæ–¹æ³• patchUnkeyedChildrenå‡½æ•°ï¼šå–è¾ƒçŸ­çš„èŠ‚ç‚¹è¿›è¡Œéå†ï¼Œä¸€ä¸€å¯¹æ¯”ï¼ˆpatchï¼‰ patchKeyedChildrenå‡½æ•°ï¼šä»å¤´å¼€å§‹whileå¾ªç¯ï¼Œè®©èŠ‚ç‚¹è¿›è¡Œå¯¹æ¯”ï¼ŒèŠ‚ç‚¹ç±»å‹ä¸åŒç›´æ¥breakï¼› ç„¶åä»å°¾éƒ¨å¼€å§‹whileï¼Œè®©èŠ‚ç‚¹è¿›è¡Œå¯¹æ¯”ï¼Œä¸åŒç›´æ¥è·³å‡ºå¾ªç¯ï¼› ç„¶ååˆ¤æ–­æ˜¯å¦æ–°å¢èŠ‚ç‚¹ï¼Œæ‹¿ä¸€ä¸ªnullå’Œæ–°èŠ‚ç‚¹è¿›è¡Œpatchï¼ŒæŒ‚è½½ä¸€ä¸ªæ–°çš„èŠ‚ç‚¹ï¼› ç„¶åå†åˆ¤æ–­å¦‚æœ‰ä»æ®‹ç•™æ—§èŠ‚ç‚¹ï¼Œåˆ™è¿›è¡Œåˆ é™¤ï¼ˆunmountï¼‰ï¼› æœ€åå¤„ç†ä¸­é—´ä¹±åºçš„èŠ‚ç‚¹ï¼Œæ–°å»ºä¸€ä¸ªmapå“ˆå¸Œè¡¨ï¼Œä»¥keyå’ŒèŠ‚ç‚¹ä½œä¸ºé”®å€¼å¯¹å­˜å‚¨ï¼Œä½¿ç”¨keyè¿›è¡ŒåŒ¹é…ã€å¯¹æ¯”ï¼Œæœ€åç­‰ç§»åŠ¨/åˆ é™¤/å¢åŠ  renderçš„ä¼˜åŒ–1.å¯¹äºä¸ä¼šæ”¹åŠ¨çš„é™æ€èŠ‚ç‚¹ï¼Œä¼šè¿›è¡Œä½œç”¨åŸŸçš„æå‡ 2.åªå¯¹åŠ¨æ€çš„èŠ‚ç‚¹è¿›è¡Œdiffç®—æ³•ï¼ˆå°†åŠ¨æ€çš„èŠ‚ç‚¹çš„æ•°æ®æ”¾å…¥dynamicChildrenï¼Œdiffçš„æ—¶å€™æ‰§è¡ŒpatchBlockChildrenå‡½æ•°ï¼‰ &lt;template> &lt;div>Allen&lt;/div> &lt;div>Allen&lt;/div> &lt;div>{{message}}&lt;/div> &lt;button @click=\"changeMessage\">ä¿®æ”¹&lt;/button> &lt;/template> function anonymous{ //é™æ€èŠ‚ç‚¹ const _hoisted_1 =/*#_PURE_*/createVNode( \"div\", null,\"Allen\",-1/* HOISTED */); const _hoisted_2 =/*#_PURE_*/createNode (\"h2\" ,null,\"Allen\" , -1/* HOISTED */); return function render(_ctx, _cache){ with (_ctx) { const { createVNode: _createWNode, toDisplayString: _toDisplayString, Fragment:_Fragment, openBlock: _openBlock, createBlock:_createBlock} = _cache; return (_openBlock(), _createBlock(_Fragment,null,[ _hoisted_1, _hoisted_2, _createVode(\"p\",nullï¼Œ_toDisplayString(message)ï¼Œ1,/* TEXT*/), _createVNode( \"button\", i oncClick: changeMessage }ï¼Œ\"ä¿®æ”¹\" , 8 /* PROPS */ï¼Œ[ \"onClick\"1)],64/*STABLE_FRAGMENT */)) } } } 3.APIå¯¹äº2.xçš„æ”¹åŠ¨å…¨å±€APIè°ƒç”¨ createApp è¿”å›ä¸€ä¸ªåº”ç”¨å®ä¾‹ï¼Œä¸€ä¸ª Vue 3 ä¸­çš„æ–°æ¦‚å¿µã€‚ è®¸å¤šåŸæœ¬ Vue.xxxçš„æ“ä½œï¼Œç°åœ¨æ˜¯é€šè¿‡ const app = Vue.createApp({})åˆ›å»ºå®ä¾‹ï¼Œï¼Œç„¶åå˜æˆäº† app.xxx 2.x å…¨å±€ API 3.x å®ä¾‹ API (app) Vue.config app.config Vue.config.productionTip ç§»é™¤ Vue.config.ignoredElements app.config.compilerOptions.isCustomElement Vue.component app.component Vue.directive app.directive Vue.mixin app.mixin Vue.use app.use Vue.prototype app.config.globalProperties Vue.extend ç§»é™¤ templateåŸæ¥Vue2.xä¸­åªå…è®¸æœ‰ä¸€ä¸ªæ ¹å…ƒç´ ï¼ˆä¸€èˆ¬ä¸ºdivï¼‰ Vue3.xä»¥ä¸Šï¼Œå…è®¸templateæœ‰å¤šä¸ªæ ¹å…ƒç´ ï¼Œä¸”å…è®¸ä¸éœ€è¦divæ ‡ç­¾è¿›è¡ŒåŒ…è£¹ï¼Œä»æºç å¯ä»¥çŸ¥é“ï¼Œå¦‚æœæœ‰å¤šä¸ªæ ¹å…ƒç´ ï¼Œåˆ™ä»–ä¼šåœ¨æœ€å¤–å±‚ç»™ä½ å¤šåŠ ä¸€å±‚ Fragment option API - &gt; Composition API å¹¶ä¸” åœ¨ Vue 2.x ä¸­ï¼Œå½“æŒ‚è½½ä¸€ä¸ªå…·æœ‰ template çš„åº”ç”¨æ—¶ï¼Œè¢«æ¸²æŸ“çš„å†…å®¹ä¼šæ›¿æ¢æˆ‘ä»¬è¦æŒ‚è½½çš„ç›®æ ‡å…ƒç´ ã€‚åœ¨ Vue 3.x ä¸­ï¼Œè¢«æ¸²æŸ“çš„åº”ç”¨ä¼šä½œä¸ºå­å…ƒç´ æ’å…¥ï¼Œä»è€Œæ›¿æ¢ç›®æ ‡å…ƒç´ çš„ innerHTMLã€‚ Vue2.x app.$mount('#app') &lt;body> &lt;div id=\"app\"> Some app content &lt;/div> &lt;/body> &lt;body> &lt;div id=\"rendered\">Hello Vue!&lt;/div> &lt;/body> Vue3 app.mount('#app') &lt;body> &lt;div id=\"app\" data-v-app=\"\"> &lt;div id=\"rendered\">Hello Vue!&lt;/div> &lt;/div> &lt;/body> dataé€‰é¡¹ç»„ä»¶é€‰é¡¹ data çš„å£°æ˜ä¸å†æ¥æ”¶çº¯ JavaScript objectï¼Œè€Œæ˜¯æ¥æ”¶ä¸€ä¸ª functionï¼ˆåªæ¥æ”¶ funciton å½¢å¼äº†ï¼‰ã€‚ å­ç»„ä»¶emitVue 3 ç°åœ¨æä¾›ä¸€ä¸ª emits é€‰é¡¹ï¼Œå’Œç°æœ‰çš„ props é€‰é¡¹ç±»ä¼¼ã€‚è¿™ä¸ªé€‰é¡¹å¯ä»¥ç”¨æ¥å®šä¹‰ä¸€ä¸ªç»„ä»¶å¯ä»¥å‘å…¶çˆ¶ç»„ä»¶è§¦å‘çš„äº‹ä»¶ã€‚ å’Œ prop ç±»ä¼¼ï¼Œç°åœ¨å¯ä»¥é€šè¿‡ emits é€‰é¡¹æ¥å®šä¹‰ç»„ä»¶å¯è§¦å‘çš„äº‹ä»¶ï¼š OK {{ text }} OK export default { props: ['text'], emits: ['accepted'], methods: { increment() { this.$emit('accepted', 'å‚æ•°') } } } è¯¥é€‰é¡¹ä¹Ÿå¯ä»¥æ¥æ”¶ä¸€ä¸ªå¯¹è±¡ï¼Œè¯¥å¯¹è±¡å…è®¸å¼€å‘è€…å®šä¹‰ä¼ å…¥äº‹ä»¶å‚æ•°çš„éªŒè¯å™¨ï¼Œå’Œ props å®šä¹‰é‡Œçš„éªŒè¯å™¨ç±»ä¼¼ã€‚ emitçš„å¯¹è±¡å†™æ³•ï¼Œä¸€èˆ¬é’ˆå¯¹äºå°†ä¼ é€’ç»™çˆ¶ç»„ä»¶çš„å‚æ•°è¿›è¡ŒéªŒè¯ï¼Œå¦‚æœfalseï¼Œåˆ™vueä¼šæŠ¥ä¸€ä¸ªè­¦å‘Šï¼ˆä½†æ˜¯å‚æ•°è¿˜æ˜¯ä¼šä¼ è¿‡å»ï¼‰ export default { emits: { add: null, //ä¸éœ€è¦ä¼ å‚æ•° addn: (payload1, payload2) => { //æœ‰ä¿©å‚æ•° if (payload1 &lt; 10) return false; return true; } } } keep-aliveå†…ç½®ç»„ä»¶å¯ä»¥ä¼ å…¥æ•°ç»„ç±»çš„å€¼ä½œä¸ºincludeã€excludeå±æ€§ include - string | RegExp | Arrayã€‚åªæœ‰åç§°åŒ¹é…çš„ç»„ä»¶ä¼šè¢«ç¼“å­˜ã€‚ exclude - string | RegExp | Arrayã€‚ä»»ä½•åç§°åŒ¹é…çš„ç»„ä»¶éƒ½ä¸ä¼šè¢«ç¼“å­˜ã€‚ max - number | stringã€‚æœ€å¤šå¯ä»¥ç¼“å­˜å¤šå°‘ç»„ä»¶å®ä¾‹ã€‚ &lt;keep-alive include=\"a,b\"> &lt;component :is=\"componentId\">&lt;/component> &lt;/keep-alive> &lt;keep-alive :include=\"/a|b/\"> &lt;component :is=\"componentId\">&lt;/component> &lt;/keep-alive> &lt;keep-alive :include=\"[a,b]\"> &lt;component :is=\"componentId\">&lt;/component> &lt;/keep-alive> å¼‚æ­¥ç»„ä»¶Vue3ä¸­ä½¿ç”¨å¼‚æ­¥ç»„ä»¶å¯ä»¥å¯¼å…¥å†…ç½®çš„ defineAsyncComponent å®ƒæ¥å—ä¸¤ç§å‚æ•° ç±»å‹ä¸€å·¥å‚å‡½æ•°ï¼Œè¯¥å·¥å‚å‡½æ•°éœ€è¦è¿”å›ä¸€ä¸ªPromiseå¯¹è±¡ import {defineAsyncComponent} from vue; // æ­¤æ—¶vueæ‰“åŒ…æ—¶ä¼šå°†è¯¥å¼‚æ­¥ç»„ä»¶å•ç‹¬æ‰“åŒ…åˆ°å¦å¤–ä¸€ä¸ªjsæ–‡ä»¶é‡Œ const AsyncComponent = defineAsyncComponent(() => import('./AsyncTest.vue')) æ¥å—ä¸€ä¸ªå¯¹è±¡ç±»å‹ï¼Œå¯¹å¼‚æ­¥å‡½æ•°è¿›è¡Œé…ç½® const AsyncComponent = defineAsyncComponent({ loader: () => import('./AsyncTest.vue'), loadingComponent: Loading, //åŠ è½½æ—¶å ä½çš„ç»„ä»¶ }) ç»„ä»¶çš„v-modelåœ¨ 3.x ä¸­ï¼Œè‡ªå®šä¹‰ç»„ä»¶ä¸Šçš„ v-model ç›¸å½“äºä¼ é€’äº† modelValue prop å¹¶æ¥æ”¶æŠ›å‡ºçš„ update:modelValue äº‹ä»¶ï¼š &lt;ChildComponent v-model=\"pageTitle\" /> &lt;!-- æ˜¯ä»¥ä¸‹çš„ç®€å†™: --> &lt;ChildComponent :modelValue=\"pageTitle\" @update:modelValue=\"pageTitle = $event\" /> å­ç»„ä»¶åˆ™ç›¸å¯¹å¤„ç† I am Son export default { props: { modelValue: String, }, emit: [\"update:modelValue\"], methods: { changeInput(event) { this.$emit(\"update:modelValue\", event.target.value); }, }, }; å½“ç„¶ä¹Ÿå¯ä»¥ä½¿ç”¨computedï¼Œä»¥è®¡ç®—å±æ€§å…³è”æ•°æ®çš„è®¾ç½®å’Œè·å–ï¼Œå­ç»„ä»¶ç›´æ¥é€šè¿‡v-modelç»‘å®šcomputedï¼Œä¸€ç§æ›´ä¼˜é›…çš„æ–¹å¼ I am Son export default { props: { modelValue: String, }, emit: [\"update:modelValue\"], computed: { value: { set(value) { this.$emit(\"update:modelValue\", value); }, get() { return this.modelValue; }, }, }, }; å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œå¦‚æœv-modelä¼ è¿›å»çš„å€¼æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œè€Œå¯¹è±¡é‡Œé¢å±æ€§å€¼å‘ç”Ÿæ”¹å˜çš„æ—¶å€™ï¼Œå­ç»„ä»¶çš„computedå¹¶ä¸èƒ½åŠæ—¶emitå‘é€æ¶ˆæ¯åˆ°çˆ¶ç»„ä»¶è¿›è¡Œæ›´æ”¹ï¼Œè€Œæ˜¯ç›´æ¥ä¿®æ”¹propsï¼Œä»è€Œè®©æˆ‘ä»¬â€œçœ‹åˆ°â€çˆ¶ç»„ä»¶çš„å¯¹è±¡çš„å±æ€§å€¼ä¿®æ”¹ä»¥åçš„æ ·å­ï¼Œæ‰€ä»¥è¿™ç§æ–¹æ³•é¢å¯¹å¯¹è±¡ç±»å‹çš„propsæ—¶ï¼Œæ˜¯æ— ç”¨çš„ï¼ï¼ï¼ï¼ï¼ï¼ ç»„ä»¶v-modelæ³¨æ„äº‹é¡¹&lt;!-- çˆ¶ç»„ä»¶ä¼ å…¥çš„pageObjæ˜¯ä¸€ä¸ªå¯¹è±¡ --> &lt;child-component v-model=\"pageObj\" /> I am Son export default { props: { modelValue: Object, }, emit: [\"update:modelValue\"], computed: { value: { set(newvalue) { this.$emit(\"update:modelValue\", newvalue); }, get() { return this.modelValue.value; }, }, }, }; å®é™…ä¸Šç›¸å½“äº I am Son export default { props: { modelValue: Object, } }; è€Œé¢å¯¹å¤æ‚æ•°æ®ç±»å‹v-modelçš„è§£å†³æ–¹æ¡ˆä¸º æ–¹æ¡ˆä¸€ï¼šå­ç»„ä»¶ä½¿ç”¨refåŒ…è£¹æµ…æ‹·è´ + watchç›‘å¬ï¼Œå‘çˆ¶ç»„ä»¶å‘é€äº‹ä»¶ export default defineComponent({ props: { modelValue: { type: Object, default: () => ({}) } }, setup(props, { emit }) { const FormField = ref({ ...props.modelValue }) watch( FormField, (newValue) => { emit('update:modelValue', newValue) }, { deep: true } ) return { FormField } } }) è€Œæ­¤æ—¶çˆ¶ç»„ä»¶ä¿®æ”¹è¿™ä¸ªpropsæ—¶è¦è¿™æ ·ä¿®æ”¹æ‰æœ‰æ•ˆ //... export default defineComponent({ props: { FormItems: { type: Array as PropType, require: true } }, setup(props) { const originField: any = {} // åŠ¨æ€è·å–FormFieldå±æ€§å const arr = props.FormItems || [] for (const item of arr) { const field = item.field originField[field] = '' } // è¡¨å•fieldæ•°æ®, è¿™é‡Œç”¨refæ˜¯å› ä¸ºreactiveåœ¨v-modelä½¿ç”¨åŒå‘ç»‘å®šçš„æ—¶å€™æœ‰å¯èƒ½ä¼šæœ‰äº›é—®é¢˜ const FormField = ref(originField) // é‡ç½®å‡½æ•°ï¼ˆä¿®æ”¹propsï¼‰ const ResetHandle = () => { for (const key in FormField.value) { FormField.value[key] = originField[key] } //FormField.value = originField æ‰“å’©ï¼Œæ— æ•ˆæ›´æ”¹ï¼Œå­ç»„ä»¶æ— æ³•å“åº” } return { FormField, ResetHandle } }, components: { ChildComponent } }) æ–¹æ¡ˆäºŒï¼šå­ç»„ä»¶ç›´æ¥ä¸ä½¿ç”¨v-modelï¼Œç›´æ¥ç”¨å€¼æ¥ç»‘å®šå°±å¥½äº†ï¼ˆæ›´å®¹æ˜“ç†è§£ï¼‰ å¯¹inputä½¿ç”¨v-bindåˆ†æ‰¹ç»‘å®šï¼Œç„¶åinputé‡Œé¢çš„ä¿®æ”¹ä½¿ç”¨äº‹ä»¶ç›‘å¬ + å‘é€äº‹ä»¶åˆ°çˆ¶ç»„ä»¶é‚£è¾¹ &lt;!-- å­ç»„ä»¶: --> &lt;el-input :modelValue=\"\" @update:modelValue=\"äº‹ä»¶å¤„ç†\" /> è‡ªå®šä¹‰v-modelå¦‚æœæƒ³è¦åœ¨ä¸€ä¸ªå­ç»„ä»¶ä¸Šç»‘å®šå¤šä¸ªv-modelï¼Œåˆ™å¯ä»¥ä½¿ç”¨ v-model:è‡ªå®šä¹‰åç§°=&quot;xx&quot;æ¥å®šä¹‰å…¶ä»–ç»‘å®šçš„å±æ€§åç§° æ­¤æ—¶å­ç»„ä»¶é€šè¿‡ props: { è‡ªå®šä¹‰åç§°: String, },æ¥æ¥æ”¶ï¼Œé€šè¿‡ this.$emit(&#39;update:è‡ªå®šä¹‰åç§°&#39;, value)æ–¹æ³•æ¥å‘é€ç›‘å¬äº‹ä»¶å‚æ•° ç¤ºä¾‹ï¼š çˆ¶ç»„ä»¶ &lt;child v-model=\"message\" v-model:title=\"title\" /> å­ç»„ä»¶ I am Son export default { props: { modelValue: String, title: String, }, emit: [\"update:modelValue\", \"update:title\"], computed: { value: { set(value) { this.$emit(\"update:modelValue\", value); }, get() { return this.modelValue; }, }, value2: { set(value) { this.$emit(\"update:title\", value); }, get() { return this.title; }, }, }, }; h()å‡½æ•°Vueæ¨èç»å¤§å¤šæ•°æƒ…å†µä¸‹ä½¿ç”¨templateæ¨¡æ¿åˆ›å»ºä½ çš„HTMLï¼Œå¦‚æœä¸€äº›åœºæ™¯ä½ çœŸçš„éœ€è¦JavaScriptçš„å®Œå…¨ç¼–ç¨‹èƒ½åŠ›ï¼Œè¿™æ—¶å€™ä½ å¯ä»¥ä½¿ç”¨æ¸²æŸ“å‡½æ•°ï¼Œä»–æ¯”æ¨¡æ¿æ›´æ¥è¿‘ç¼–è¯‘å™¨ å¯ä»¥ç†è§£ä¸º templateï¼ˆç»è¿‡compileï¼‰ -&gt; render -&gt; vnodeï¼Œæ­¤æ—¶æˆ‘ä»¬ç›´æ¥å†™renderï¼Œè¿‡ç¨‹å¯ä»¥åœ¨Vue(ä¸­)çš„è„šæ‰‹æ¶éƒ¨åˆ†çš„runtime onlyçœ‹åˆ° hå‡½æ•° ç”¨äºåˆ›å»ºä¸€ä¸ªvnodeçš„å‡½æ•° å…¶å®åŸåä¸ºcreateVNodeå‡½æ•°ï¼Œä½†æ˜¯ä¸ºäº†ç®€ä¾¿åœ¨Vueç®€ç§°ä¸ºhå‡½æ•° å‚æ•°ä¼ å…¥ï¼š // @returns {VNode} h( // {String | Object | Function} tag // ä¸€ä¸ª HTML æ ‡ç­¾åã€ä¸€ä¸ªç»„ä»¶ã€ä¸€ä¸ªå¼‚æ­¥ç»„ä»¶ã€æˆ– // ä¸€ä¸ªå‡½æ•°å¼ç»„ä»¶ã€‚ // // å¿…éœ€çš„ã€‚ 'div', // {Object} props // ä¸ attributeã€prop å’Œäº‹ä»¶ç›¸å¯¹åº”çš„å¯¹è±¡ã€‚ // è¿™ä¼šåœ¨æ¨¡æ¿ä¸­ç”¨åˆ°ã€‚ // // å¯é€‰çš„ã€‚ {}, // {String | Array | Object} children // å­ VNodes, ä½¿ç”¨ `h()` æ„å»º, // æˆ–ä½¿ç”¨å­—ç¬¦ä¸²è·å– \"æ–‡æœ¬ VNode\" æˆ–è€… // æœ‰æ’æ§½çš„å¯¹è±¡ã€‚ // // å¯é€‰çš„ã€‚ [ 'Some text comes first.', h('h1', 'A headline'), h(MyComponent, { someProp: 'foobar' }) ] ) æ€»ç»“å°±æ˜¯ï¼š1.æ ‡ç­¾ | ç»„ä»¶ï¼Œ2. å±æ€§ï¼Œ 3. å­ç»„ä»¶ | å­æ ‡ç­¾ æ³¨æ„ï¼šå¦‚æœæ²¡æœ‰propsï¼ˆå±æ€§ï¼‰ï¼Œå¯ä»¥å°†å­ç»„ä»¶ä½œä¸ºç¬¬äºŒä¸ªä¼ å…¥ï¼›è€Œå¦‚æœä¼šäº§ç”Ÿæ­§ä¹‰ï¼Œåˆ™å°†nullä½œä¸ºç¬¬äºŒä¸ªå‚æ•°ä¼ å…¥ import { h } from \"vue\"; export default { render() { return h( \"div\", { class: \"app\", }, \"hello Render\" ); }, }; åœ¨setupä¸­æ›¿ä»£hå‡½æ•° åœ¨setupå‡½æ•°çš„è¿”å›å€¼æ›¿æ¢æˆä¸€ä¸ªå‡½æ•°ï¼Œå‡½æ•°è¿”å›å€¼ä¸ºhå‡½æ•° setup() { const count = ref(0); return () => { return h(\"div\", { class: \"app\" }, [ h(\"h2\", null, `å½“å‰è®¡æ•°${count.value}`), h( \"button\", { onClick: () => count.value++, }, \"+\" ), h( \"button\", { onClick: () => count.value--, }, \"-\" ), h(Child, null, \"\"), ]); }; }, ä½¿ç”¨JSXå’Œhå‡½æ•°åŒç†ï¼Œåªä¸è¿‡åœ¨renderå‡½æ•°ä¸­å†™æˆjsxå½¢å¼ export default { render() { return &lt;h1>hello world&lt;/h1>; }, }; ç”Ÿå‘½å‘¨æœŸbeforeDestroy -&gt; beforeUnmount destroyed -&gt; unmounted setupå‡½æ•°æ‰§è¡Œ -&gt; applyOptionsè°ƒç”¨ï¼ˆbeforeCreateã€Createdç”Ÿå‘½å‘¨æœŸå‡½æ•°è°ƒç”¨ï¼‰-&gt; å‰©ä¸‹çš„ç”Ÿå‘½å‘¨æœŸè½¬æ¢æˆsetupçš„APIï¼ˆonBeforeMountã€onMountedï¼‰ å¯¹äºbeforeMountä¹‹åçš„ç”Ÿå‘½å‘¨æœŸå‡½æ•°ï¼Œå…¶ä¸­beforexxxçš„ç”Ÿå‘½å‘¨æœŸå‡½æ•°ï¼Œéƒ½æ˜¯ç«‹å³è°ƒç”¨ï¼Œè€Œxxxçš„ç”Ÿå‘½å‘¨æœŸå‡½æ•°ï¼Œåˆ™æ”¾å…¥é˜Ÿåˆ—ï¼Œç­‰åˆ°è¯¥å‘¨æœŸå®Œæ¯•ä¹‹åï¼Œå†flushPostFlushCbsåˆ·æ–°é˜Ÿåˆ—ï¼Œæ‰§è¡Œå‡½æ•° æ‰€ä»¥setupæ‰§è¡Œæ—¶æœºæ¯”beforeCreateç”Ÿå‘½å‘¨æœŸè¿˜æ—©ï¼ è·¯ç”±ä½¿ç”¨è‹¥åœ¨æ­å»ºè„šæ‰‹æ¶æ—¶æ²¡æœ‰å®‰è£…ï¼Œåˆ™éœ€è¦æ‰‹åŠ¨å®‰è£…vueè·¯ç”±ç®¡ç† npm i vue-router@next åŸæœ¬å¯¼å‡ºè·¯ç”±ï¼š import Router from 'vue-router' import Vue from 'vue' Vue.use(Router); const routes = []; const router = new Router({ routes }) export default router; ç°åœ¨åŒcreateAppï¼Œå¯¼å‡ºå•ä¸ªæ–¹æ³•createRouter è€Œæ¨¡å¼çš„é€‰æ‹©ä¹Ÿä¸æ˜¯ä¹‹å‰ä½¿ç”¨å­—ç¬¦ä¸²çš„å½¢å¼å¯¹modeå±æ€§èµ‹å€¼ï¼Œè€Œè¦å¯¼å…¥ createWebHistoryã€createWebHashHistory import { createRouter, createWebHistory, createWebHashHistory } from 'vue-router' const router = createRouter({ routes, history: createWebHistory(); }) export default router; ç„¶ååœ¨main.jsä¸­ //... import router from './router' const app = createApp(App) app.use(router); app.mount('#app'); è€Œ router-viewã€router-linkçš„ä½¿ç”¨åŒä¹‹å‰vue2.xä¸€æ · router-link v-slot API (Vue Router3.1.0 æ–°å¢) router-linkçš„æ’æ§½slotï¼ŒåŒæ ·å¯ä»¥ä½¿ç”¨ä½œç”¨åŸŸæ’æ§½ï¼Œä½†æ˜¯å®ƒçš„æ’æ§½è‡ªå®šä¹‰propså¯¹è±¡å…¶ä¸­æœ‰åŒ…å«äº†ä¸€äº›å±æ€§ props: href è·³è½¬çš„é“¾æ¥ props: route routeå¯¹è±¡ props: navigateå¯¼èˆªå‡½æ•°ï¼Œéœ€è¦é…åˆcustomå±æ€§ä½¿ç”¨ props: isActive æ˜¯å¦å½“å‰å¤„äºæ´»è·ƒçŠ¶æ€ &lt;router-link to=\"/home\" v-slot=\"props\"> &lt;h2>{{ props.href }}&lt;/h2> &lt;/router-link> &lt;router-view /> router-view v-slot API (Vue Router3.1.0 æ–°å¢) &lt;!-- é€šè¿‡props.Componentå¾—åˆ°ç›®å‰æ¸²æŸ“å‡ºæ¥çš„ç»„ä»¶ --> &lt;!-- æ­¤æ—¶é€šè¿‡componentæ‹¿åˆ°å¯¹åº”çš„ç»„ä»¶ï¼Œç„¶åå°±å¯ä»¥æ”¾å…¥transition / keep-alive ä¸­ï¼Œä½¿ç”¨åŠ¨ç”» / ç¼“å­˜äº† --> &lt;router-view v-slot=\"props\"> &lt;transition name=\"allen\"> &lt;keep-alive> &lt;component :is=\"props.Component\">&lt;/component> &lt;/keep-alive> &lt;/transition> &lt;/router-view> åŠ¨æ€æ·»åŠ è·¯ç”±æœ‰æ—¶å€™ä¸€äº›åº”ç”¨åœºæ™¯éœ€è¦æˆ‘ä»¬å»åŠ¨æ€æ·»åŠ è·¯ç”±ï¼Œè€Œä¸æ˜¯ä¸€å¼€å§‹å°†routeså†™æ­»ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ router.addRoute addRoute(route: RouteConfig): () =&gt; void æ·»åŠ ä¸€æ¡æ–°è·¯ç”±è§„åˆ™ addRoute(parentName: string, route: RouteConfig): () =&gt; void æ·»åŠ ä¸€æ¡æ–°çš„è·¯ç”±è§„åˆ™è®°å½•ä½œä¸ºç°æœ‰è·¯ç”±çš„å­è·¯ç”± const routes = []; const router = createRouter({ routes, }) if(ç®¡ç†å‘˜){ router.addRoute({ path: \"/order\", component = () => import('../components/order') }) // æ·»åŠ äºŒçº§è·¯ç”± router.addRoute('home', { path:'moment', component: () => import('../components/HomeMoment') }) } export default router; å½“ç„¶ï¼Œé™¤äº†åŠ¨æ€æ·»åŠ è·¯ç”±ï¼Œå½“ç„¶ä¹Ÿæœ‰åŠ¨æ€åˆ é™¤è·¯ç”± æ–¹å¼ä¸€ï¼šæ·»åŠ ä¸€ä¸ªnameç›¸åŒçš„è·¯ç”± æ–¹å¼äºŒï¼šä½¿ç”¨ removeRoute(è·¯ç”±åç§°) æ–¹å¼ä¸‰ï¼šaddRouteè¿”å›ä¸€ä¸ªå‡½æ•°ï¼Œè°ƒç”¨è¿™ä¸ªå‡½æ•°åˆ™ä¼šåˆ é™¤è¯¥è·¯ç”± vuexå®‰è£… npm i vuex@next ä½¿ç”¨å’Œä¹‹å‰ç±»ä¼¼ï¼Œåªæ˜¯ä¾ç„¶è¦å¯¼åŒ… import { createStore } from 'vuex'; const store = createStore({ state() { return { //... } } }); export default store ç„¶ååœ¨main.jsä¸­ //... import store from './store' const app = createApp(App) app.use(store); app.mount('#app'); vueä¸­å…¨å±€å˜é‡ã€å‡½æ•°å¯ä»¥ä½¿ç”¨ app.config.globalProperties è¿›è¡Œå®šä¹‰ï¼ˆvue.prototypeåºŸé™¤ï¼‰ import { createApp } from 'vue' import App from './App.vue' import router from './router' import store from './store' const app = createApp(App) app.use(store) app.use(router) // ä¸ºäº†åŒºåˆ†å…¨å±€å˜é‡ï¼Œåœ¨å‡½æ•°å‰é¢åŠ ä¸€ä¸ª$ app.config.globalProperties.$filter = { formatTime(time: string) { console.log('time', time); } } app.mount('#app') åœ¨ç»„ä»¶ä¸­ä½¿ç”¨ &lt;strong>{{ $filter.formatTime('666') }}&lt;/strong> 4.Composition APIoption API æ¨¡å¼çš„å¼Šç«¯ å½“æˆ‘ä»¬å®ç°ä¸€ä¸ªåŠŸèƒ½æ—¶ï¼Œè¿™ä¸ªåŠŸèƒ½å¯¹åº”çš„ä»£ç é€»è¾‘ä¼šè¢«æ‹†åˆ†åˆ°å„ä¸ªå±æ€§å½“ä¸­ å½“æˆ‘ä»¬çš„ç»„ä»¶å˜å¾—å¾ˆå¤§å¾ˆå¤æ‚çš„æ—¶å€™ï¼Œé€»è¾‘å…³æ³¨ç‚¹çš„åˆ—è¡¨å°±ä¼šå¢é•¿ï¼Œé‚£ä¹ˆåŒä¸€ä¸ªåŠŸèƒ½çš„é€»è¾‘å°±ä¼šè¢«æ‹†åˆ†çš„å¾ˆåˆ†æ•£ å°¤å…¶å¯¹é‚£äº›å¼€å§‹æ²¡æœ‰ç¼–å†™è¿™äº›ç»„ä»¶çš„äººæ¥è¯´ï¼Œä»£ç å˜å¾—éš¾ä»¥é˜…è¯» composition APIä½¿å¾—é€»è¾‘ä»£ç é‡åˆéƒ¨åˆ†å¯ä»¥æ‹†åˆ†ä¸ºä¸€ä¸ªå‡½æ•°ï¼ˆä½¿ç”¨hookï¼Œå’ŒReactä¸€æ ·ï¼Œä½¿ç”¨useXXXå‘½åï¼‰ï¼Œç„¶åå¯¼å…¥ä½¿ç”¨ setupå…¶å®å°±æ˜¯ç»„ä»¶çš„ä¸€ä¸ªé€‰é¡¹ï¼Œåªä¸è¿‡è¿™ä¸ªé€‰é¡¹å¯ä»¥å¼ºå¤§åˆ°æ›¿ä»£ä¹‹å‰çš„æ‰€æœ‰é€‰é¡¹ setupé‡Œé¢æ— æ³•ä½¿ç”¨thisï¼Œæ²¡æœ‰ç»‘å®šï¼ï¼ setupçš„å‚æ•° props è¿˜æ˜¯éœ€è¦å†™propsçš„optionè¿›è¡Œå£°æ˜ çˆ¶ç»„ä»¶è¿˜æ˜¯éœ€è¦å†™componentsé€‰é¡¹ contextï¼Œå®ƒåŒ…å«ä¸‰ä¸ªå±æ€§ attrsï¼šæ‰€æœ‰épropsçš„attributeï¼Œæ¯”å¦‚classã€idä¹‹ç±»çš„ï¼› slotsï¼šçˆ¶ç»„ä»¶ä¼ è¿‡æ¥çš„æ’æ§½ emitï¼šå½“æˆ‘ä»¬ç»„ä»¶å†…éƒ¨éœ€è¦å‘å‡ºäº‹ä»¶æ—¶ä¼šç”¨åˆ°emitï¼ˆå› ä¸ºæˆ‘ä»¬ä¸èƒ½è®¿é—®thisï¼Œæ— æ³•é€šè¿‡this.$emitå‘å‡ºäº‹ä»¶ï¼‰ setupçš„è¿”å›å€¼å¯ä»¥åœ¨æ¨¡æ¿templateä¸­è¢«ä½¿ç”¨ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬å¯ä»¥é€šè¿‡setupçš„è¿”å›å€¼æ¥æ›¿ä»£dataé€‰é¡¹ reactiveä½†æ˜¯åœ¨setupé‡Œå®šä¹‰çš„å˜é‡éå“åº”å¼çš„ï¼Œå› ä¸ºä»–æ²¡æœ‰æ”¾åœ¨dataï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥åŒ…è£¹ä¸€ä¸ª reactiveï¼Œå°†å…¶å˜èº«ç§°ä¸ºå“åº”å¼çš„ï¼ˆæ­¤æ—¶åŒ…è£¹åœ¨reactiveé‡Œé¢çš„æ•°æ®ä¼šè¢«Vueä½¿ç”¨Proxyè¿›è¡Œæ•°æ®åŠ«æŒï¼‰ äº‹å®ä¸Šï¼Œæˆ‘ä»¬ç¼–å†™çš„dataé€‰é¡¹ï¼Œä¹Ÿæ˜¯åœ¨å†…éƒ¨å°±ç»™äº†reactiveå‡½æ•°å°†å…¶å˜æˆå“åº”å¼çš„ æ³¨æ„ï¼šreactive APIå¯¹ä¼ å…¥ç±»å‹æ˜¯æœ‰é™åˆ¶çš„ï¼Œä»–è¦æ±‚æˆ‘ä»¬å¿…é¡»ä¼ å…¥ä¸€ä¸ªå¯¹è±¡æˆ–è€…æ•°ç»„ç±»å‹ {{ state.count }} + import { reactive } from \"vue\"; export default { setup(props, { attrs, slots, emit }) { console.log(props); console.log(attrs); console.log(slots); console.log(emit); // let count = 100; const state = reactive({ count: 100, message: \"hello world\", }); // å±€éƒ¨å‡½æ•° const increment = () => { state.count++; }; return { state, increment, }; }, }; æ³¨æ„ï¼šreactiveåœ¨v-modelä½¿ç”¨åŒå‘ç»‘å®šçš„æ—¶å€™æœ‰å¯èƒ½ä¼šæœ‰äº›é—®é¢˜ï¼Œæ‰€ä»¥å³ä½¿æ•°æ®æ˜¯å¯¹è±¡ï¼Œæ­¤æ—¶ä¹Ÿå»ºè®®ä½¿ç”¨refåŒ…è£¹ Ref API å®˜æ–¹æ¨èï¼ˆå°¤é›¨æºªï¼‰èƒ½ç”¨refå°±ç”¨refï¼Œè€Œä¸æ˜¯reactiveï¼ŒåæœŸæ–¹ä¾¿æŠ½ç¦» å¦‚æœæˆ‘ä»¬å¯¹reactiveä¼ å…¥ä¸€ä¸ªåŸºæœ¬æ•°æ®ç±»å‹ï¼Œå°±ä¼šæŠ¥ä¸€ä¸ªè­¦å‘Šï¼Œæç¤ºæˆ‘ä»¬ä½¿ç”¨ref ref APIä¼šè¿”å›ä¸€ä¸ªå¯å˜çš„å“åº”å¼å¯¹è±¡ï¼Œè¯¥å¯¹è±¡ä½œä¸ºä¸€ä¸ªå“åº”å¼å¼•ç”¨ç»´æŠ¤å®ƒå†…éƒ¨çš„å€¼ï¼Œè¿™å°±æ˜¯refåç§°çš„æ¥æº å®ƒå†…éƒ¨çš„å€¼æ˜¯åœ¨refçš„valueå±æ€§è¢«ç»´æŠ¤çš„ ä½†æ˜¯ï¼Œè™½ç„¶æ˜¯æœ€ä¸ºrefçš„valueè¿›è¡Œå­˜å‚¨ï¼Œä½†æ˜¯æˆ‘ä»¬å¹¶ä¸éœ€è¦åœ¨æ¨¡æ¿ä¸­ä½¿ç”¨ å˜é‡å.value æ¥è·å–å­˜å‚¨çš„æ•°æ®ï¼Œåœ¨tempplateæ¨¡æ¿ä¸­ä½¿ç”¨refå¯¹è±¡ï¼Œå®ƒä¼šè‡ªåŠ¨è¿›è¡Œè§£åŒ…ï¼š æµ…å±‚è§£åŒ…ï¼Œåªèƒ½å¯¹æœªåŒ…è£¹å¤–å±‚ï¼ˆå¦‚æœå¤–å±‚æœ‰åŒ…è£¹ï¼Œå¿…é¡»è¢«reactiveå¯¹è±¡åŒ…è£¹ï¼‰çš„åŸºæœ¬æ•°æ®ç±»å‹è¿›è¡Œè§£åŒ… ä½†æ˜¯å¹¶ä¸ä»£è¡¨åœ¨é€»è¾‘ä»£ç é‡Œï¼Œä¹Ÿå°±æ˜¯setupé‡Œæœ‰è‡ªåŠ¨è§£åŒ…çš„åŠŸèƒ½ï¼Œæ‰€ä»¥åœ¨setupå‡½æ•°é‡Œè¿˜æ˜¯å¾—é€šè¿‡ å˜é‡å.value æ¥æ“ä½œ {{ count }} + import { ref } from \"vue\"; export default { setup() { let count = ref(100); const increment = () => { count.value++; }; return { count, increment, }; }, }; toRefs toRefsï¼šå°† reactiveå¯¹è±¡ä¸­æ‰€æœ‰å±æ€§éƒ½è½¬æ¢ä¸ºrefï¼Œå»ºç«‹é“¾æ¥ toRefï¼šå¯¹ reactiveå¯¹è±¡å…¶ä¸­ä¸€ä¸ªå±æ€§è½¬æ¢refï¼Œå»ºç«‹é“¾æ¥ æ³¨æ„ï¼Œä¸¤è€…éƒ½æ˜¯å»ºç«‹åœ¨ reactive API ä¹‹ä¸Šçš„ æ­£å¸¸æƒ…å†µä¸‹ï¼Œå¯¹reactiveåŒ…è£¹çš„å¯¹è±¡åšè§£æ„æ˜¯æ— æ³•å¾—åˆ°å“åº”å¼æ•°æ®çš„ï¼Œé™¤éä½¿ç”¨ toRefs è¿›è¡ŒåŒ…è£¹ï¼Œå°†é‡Œé¢ç»“æ„çš„æ•°æ®è½¬æ¢ä¸º ref å¦‚æœæ˜¯ä»…ä»…åªéœ€è¦è§£æ„reactiveä¹‹åå¾—åˆ°ä¸€ä¸ªæˆ‘ä»¬éœ€è¦çš„å±æ€§ï¼Œåˆ™ä½¿ç”¨ toRefå°±å¯ä»¥äº†ï¼ˆå¯¹æ¯” toRefsï¼Œæ€§èƒ½å¼€é”€è¾ƒå° ï¼‰ // å¾—ä¸åˆ°å“åº”å¼çš„ Ã— setup() { const info = reactive({count: 100}) let { count } = info const increment = () => { count++; }; return { count, increment, }; }, import { reactive, toRefs } from \"vue\"; //..... //å“åº”å¼çš„count setup() { const info = reactive({ name: 'allen', count: 100 }); //ä¹Ÿå¯ä»¥ //let { name, count } = toRefs(info); let count = toRef(info, \"count\"); const increment = () => { count.value++; }; return { count, increment, }; } è¿˜æœ‰ä¸€ä¸ª unref APIï¼Œç”¨äºåˆ¤æ–­å½“å‰æ˜¯å¦ä¸ºref å®è´¨ä¸Šä¹Ÿä¸è¿‡å°±æ˜¯ unref(val) =&gt; val = isRef(val) ? val.value : val; options APIå’ŒComposition API ä¸­å“åº”å¼æ•°æ®çš„å‘½åå†²çª Vue3å†…éƒ¨å–å€¼çš„æ—¶å€™ï¼Œå¦‚æœæœ‰ $ç¬¦å·ï¼Œåˆ™ å…ˆæ‰¾ç¼“å­˜ï¼Œæ²¡æœ‰çš„è¯å†æ‰¾setupä¸­ä¿å­˜çš„å“åº”å¼æ•°æ®ï¼Œæ‰¾ä¸åˆ°å†æ‰¾dataï¼Œæ‰¾ä¸åˆ°å†æ‰¾propsï¼Œæ‰¾ä¸åˆ°å†æ‰¾ctxé‡Œé¢æœ‰æ²¡æœ‰å€¼ï¼ˆctxé‡Œé¢ä¿å­˜computedã€methodsçš„æ•°æ®ï¼‰ if (key[0] !== '$') { const n = accessCache![key] if (n !== undefined) { switch (n) { case AccessTypes.SETUP: return setupState[key] case AccessTypes.DATA: return data[key] case AccessTypes.CONTEXT: return ctx[key] case AccessTypes.PROPS: return props![key] // default: just fallthrough } } else if (setupState !== EMPTY_OBJ &amp;&amp; hasOwn(setupState, key)) { accessCache![key] = AccessTypes.SETUP return setupState[key] } else if (data !== EMPTY_OBJ &amp;&amp; hasOwn(data, key)) { accessCache![key] = AccessTypes.DATA return data[key] } else if ( // only cache other properties when instance has declared (thus stable) // props (normalizedProps = instance.propsOptions[0]) &amp;&amp; hasOwn(normalizedProps, key) ) { accessCache![key] = AccessTypes.PROPS return props![key] } else if (ctx !== EMPTY_OBJ &amp;&amp; hasOwn(ctx, key)) { accessCache![key] = AccessTypes.CONTEXT return ctx[key] } else if (!__FEATURE_OPTIONS_API__ || shouldCacheAccess) { accessCache![key] = AccessTypes.OTHER //æ‰¾ä¸åˆ°äº† } } refè·å–ç»„ä»¶/å…ƒç´ å¯¹è±¡ import { ref } from \"vue\"; export default { setup() { // åªä¸è¿‡titleè¦åœ¨å…ƒç´ æŒ‚åœ¨å®Œæ¯•ä¹‹åæ‰æœ‰å€¼ const title = ref(null); return { title } }, }; æ— æ³•ä½¿ç”¨thiså®˜æ–¹ï¼š åœ¨ setup() å†…éƒ¨ï¼Œthis ä¸æ˜¯è¯¥æ´»è·ƒå®ä¾‹çš„å¼•ç”¨ï¼Œå› ä¸º setup() æ˜¯åœ¨è§£æå…¶å®ƒç»„ä»¶é€‰é¡¹ä¹‹å‰è¢«è°ƒç”¨çš„ï¼Œæ‰€ä»¥ setup() å†…éƒ¨çš„ this çš„è¡Œä¸ºä¸å…¶å®ƒé€‰é¡¹ä¸­çš„ this å®Œå…¨ä¸åŒã€‚è¿™ä½¿å¾— setup() åœ¨å’Œå…¶å®ƒé€‰é¡¹å¼ API ä¸€èµ·ä½¿ç”¨æ—¶å¯èƒ½ä¼šå¯¼è‡´æ··æ·†ã€‚ coderwhyè€å¸ˆï¼šç»„ä»¶å®ä¾‹è¢«åˆ›å»º -&gt; setupè¢«è°ƒç”¨ -&gt; å…¶ä»–optionå‡ºæ¥ ä¹Ÿå°±æ˜¯è¯´ åœ¨ setup ä¸­thiså¹¶æ²¡æœ‰ç»‘å®šç»„ä»¶å®ä¾‹ å¹¶ä¸”åœ¨ setup è¢«è°ƒç”¨ä¹‹å‰ï¼Œdataã€computedã€methodsç­‰optionéƒ½æ²¡æœ‰è¢«è§£æ readonlyæœ‰æ—¶å€™æˆ‘ä»¬é€šè¿‡reactive æˆ–è€… ref è·å–åˆ°ä¸€ä¸ªå“åº”å¼å¯¹è±¡ï¼Œä½†æ˜¯æˆ‘ä»¬ä¼ å…¥å…¶ä»–åœ°æ–¹ï¼ˆç»„ä»¶ï¼‰çš„æ—¶å€™ï¼Œå¹¶ä¸æƒ³åœ¨å¦å¤–ä¸€ä¸ªåœ°æ–¹ï¼ˆç»„ä»¶ï¼‰è¢«ä¿®æ”¹ï¼Œåªè¯»å°±å¯ä»¥ æ¯”å¦‚è¯´çˆ¶ç»„ä»¶ä¼ å…¥åˆ°å­ç»„ä»¶ï¼Œæˆ‘ä»¬è¦éµå¾ªâ€œå•å‘æ•°æ®æµâ€çš„è§„èŒƒ ä½¿ç”¨readonly readonlyä¼šè¿”å›åŸç”Ÿå¯¹è±¡çš„åªè¯»ä»£ç†ï¼ˆä¹Ÿå°±æ˜¯å®ƒä¾æ—§æ˜¯ä¸€ä¸ªProxyï¼Œè¿™æ˜¯ä¸€ä¸ªproxyçš„setæ–¹æ³•è¢«åŠ«æŒï¼Œè€Œä¸èƒ½å¯¹å…¶è¿›è¡Œä¿®æ”¹ï¼‰ const dataProxy = new Proxy(info, { get(target, key){ return target[key] }, set(target, key, value) { warning(); } }) import { reactive, ref, readonly } from 'vue' //... setup(){ const data = reactive({name: 'allen'}); const data2 = ref(100); const readonlyData = readonly(data); const readonlyData2 = readonly(data2); readonly.name = 'bruce'; //å¤±è´¥ï¼Œè­¦å‘Š } computedé€šè¿‡å¯¼åŒ…çš„æ–¹å¼ï¼Œç›´æ¥å† setup å‡½æ•°ä¸­ä½¿ç”¨ ä¼ å…¥ä¸€ä¸ªå‡½æ•°ä½œä¸ºå‚æ•°ï¼Œè¯¥è¿”å›å€¼ï¼ˆä¹Ÿå˜èº«ä¸ºrefå¯¹è±¡ï¼‰ç›´æ¥ä½œä¸ºç¼“å­˜ or ä¼ å…¥ä¸€ä¸ªå¯¹è±¡ï¼ŒåŒ…å«getå’Œsetæ–¹æ³•ï¼ŒåŒä»¥å‰çš„computed optionï¼ˆä¹Ÿè¿”å›æˆä¸€ä¸ªrefå¯¹è±¡ï¼‰ import { ref, computed } from \"vue\"; export default { setup() { const firstname = ref(\"Allen\"); const lastname = ref(\"bruce\"); const fullname = computed(() => firstname.value + \" \" + lastname.value); return { fullname, }; }, }; watchåœ¨composition APIä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨watchEffectå’Œwatchæ¥å®Œæˆå“åº”å¼æ•°æ®ä¾¦å¬ watchEffectç”¨äºè‡ªåŠ¨æ”¶é›†å“åº”å¼æ•°æ®ä¾èµ–ï¼Œé¦–å±æ¸²æŸ“å°±ä¼šç«‹å³æ‰§è¡Œä¸€æ¬¡ ç«‹å³æ‰§è¡Œä¸€æ¬¡å°±æ˜¯ä¸ºäº†æŸ¥çœ‹å‡½æ•°é‡Œé¢åŒ…å«äº†ä»€ä¹ˆå“åº”å¼çš„æ•°æ®ï¼Œè¿›è¡Œä¾èµ–æ”¶é›† ä¹‹åè‹¥è¯¥ä¾èµ–å‘ç”Ÿæ”¹å˜ï¼Œåˆ™watchEffectå‡½æ•°å°±ä¼šè¢«è§¦å‘ï¼› ç¬¬äºŒä¸ªå‚æ•°æ˜¯optionï¼Œå¯ä»¥æŒ‡å®š flushï¼šâ€preâ€|â€postâ€|â€syncâ€ï¼Œåˆ†åˆ«æ˜¯ é»˜è®¤|domæŒ‚è½½ä¹‹åå†æ‰§è¡Œ|å¼ºåˆ¶åŒæ­¥è§¦å‘ï¼Œä½æ•ˆçš„ function watchEffect( effect: (onInvalidate: InvalidateCbRegistrator) => void, options?: WatchEffectOptions ): StopHandle setup() { const name = ref(\"Allen\"); const age = ref(18); const changeName = () => { name.value = \"Bruce\"; }; const changeAge = () => { age.value++; }; //ä¾èµ–é¡¹å‘ç”Ÿæ”¹å˜è‡ªåŠ¨é‡æ–°æ‰§è¡Œï¼Œä¸ªäººæ„Ÿè§‰æœ‰ç‚¹åƒreactçš„useEffectæ¥ç”¨äº† watchEffect(() => { console.log(\"name:\", name.value); // nameå‘ç”Ÿæ”¹å˜åˆ™è°ƒç”¨ï¼Œå› ä¸ºnameè¢«watchEffectæ”¶é›†äº† }); return { name, age, changeAge, changeName, }; }, watchéœ€è¦æ‰‹åŠ¨æŒ‡å®šä¾¦å¬æ•°æ®æºï¼Œå‡ ä¹ç­‰åŒäºwatch option ä½†æ˜¯åœ¨setupé‡Œé¢ï¼Œæ ¼å¼ä¸Šè¿˜æ˜¯æœ‰å°‘è®¸ä¸åŒ ç¬¬ä¸€ä¸ªå‚æ•°ä¼ å…¥ä¸€ä¸ªgetterå‡½æ•°ï¼ˆreactive æˆ–è€… ref æˆ–è€…ä¸€ä¸ªè£…ç€å¤šä¸ªref/reactiveçš„æ•°ç»„ï¼‰ ç¬¬äºŒä¸ªå‚æ•°ä¼ å…¥ä¸€ä¸ªå‡½æ•°ï¼Œä»£è¡¨ç›‘å¬æ•°æ®å˜åŒ–åè¿›è¡Œçš„æ“ä½œ ç¬¬ä¸‰ä¸ªå‚æ•°å¯é€‰ï¼Œä½œä¸ºwatchçš„optionè®¾ç½®ç›‘å¬ï¼Œæ¯”å¦‚deepï¼ˆæ·±åº¦ä¾¦å¬ï¼‰ã€immediateï¼ˆæ˜¯å¦é¦–å±æ¸²æŸ“å°±ä¼šç«‹å³æ‰§è¡Œä¸€æ¬¡ï¼‰ setup() { const info = reactive({ name: \"allen\", age: 18 }); const changeName = () => (info.name = \"Bruce\"); watch(info, (newval, oldval) => { console.log(newval, oldval); }); /* é¿å…newvalï¼Œoldvalå˜ä¸ºä¸€ä¸ªä»£ç†proxyï¼Œè§£æ„æ‰reactive watch(() => { return {...info}; }, (newval, oldval) => { console.log(newval, oldval); }); */ return { changeName, info, }; }, æ³¨æ„ï¼šå¦‚æœç¬¬ä¸€ä¸ªå‚æ•°æ˜¯reactiveï¼Œåˆ™é»˜è®¤æ·±åº¦ç›‘å¬ åœæ­¢ä¾¦å¬å™¨ and æ¸…é™¤å‰¯ä½œç”¨ watchEffect è¿”å›ä¸€ä¸ª åœæ­¢å™¨ï¼Œè°ƒç”¨è¯¥åœæ­¢å™¨ä¹‹åï¼ŒwatchEffectå°†ä¸ä¼šè¢«è§¦å‘ watchEffectè¿˜æ¥å—ä¸€ä¸ªå‚æ•°ï¼Œè¯¥å‚æ•°ä¼ å…¥çš„å‡½æ•°ä¼šåœ¨watchEffectè¢«é”€æ¯æ—¶è°ƒç”¨ï¼Œä¸ªäººæ„Ÿè§‰å¯ä»¥æŠŠå®ƒå½“æˆReactä¸­ useEffectçš„ è¿”å›å€¼ setup() { const name = ref(\"Allen\"); const age = ref(18); // watchEffect è¿”å›ä¸€ä¸ªåœæ­¢ä¾¦å¬å™¨ï¼Œè°ƒç”¨å³åœæ­¢ const stop = watchEffect((onInvalidate) => { onInvalidate(() => { // ç”¨äºæ¸…é™¤å‡½æ•°ä¸­çš„å‰¯ä½œç”¨ï¼Œæ¯”å¦‚å¯ä»¥æ”¾ä¸€äº›å–æ¶ˆè¯·æ±‚åŠŸèƒ½request.cancel() // å½“ä¾èµ–é¡¹å‘ç”Ÿæ”¹å˜ï¼ŒwatchEffecté‡æ–°æ‰§è¡Œï¼Œåˆ™è¿™é‡Œé¢çš„çš„ä»£ç ä¹Ÿä¼šè¢«æ‰§è¡Œã€‚ console.log(\"æˆ‘è¢«æ‰§è¡Œäº†ï¼\"); }); console.log(\"name:\", age.value); }); const changeAge = () => { age.value++; if (age.value > 25) stop(); }; return { name, age, changeAge, }; }, ç”Ÿå‘½å‘¨æœŸæ›¿ä»£ä½¿ç”¨ï¼šå¯ä»¥ç›´æ¥å¯¼å…¥ onX å‡½æ•°ï¼Œæ³¨å†Œç”Ÿå‘½å‘¨æœŸé’©å­å‡½æ•° option API Hook inside setup beforeCreate no needï¼ˆç”±äºsetupæ¯”å®ƒæ—©ï¼Œæ”¾åœ¨setupæ‰§è¡Œå³å¯ï¼‰ created no needï¼ˆç”±äºsetupæ¯”å®ƒæ—©ï¼Œæ”¾åœ¨setupæ‰§è¡Œå³å¯ï¼‰ beforeMount onBeforeMount mounted onMounted beforeUpdate onBeforeUpdate updated onUpdated beforeUnmount onBeforeUnmount unmounted onUnmounted activated onActivated deactivated onDeactivated import { onMounted, onUpdated, onUnmounted, ref } from \"vue\"; export default { setup() { const counter = ref(100); const increnment = () => counter.value++; onMounted(() => { console.log(\"onMounted\"); }); // å¯ä»¥æ³¨å†Œå¤šä¸ªç”Ÿå‘½å‘¨æœŸ onMounted(() => { console.log(\"onMounted2\"); }); onUpdated(() => { console.log(\"onUpdated\"); }); onUnmounted(() => { console.log(\"onUnmounted\"); }); return { counter, increnment, }; }, }; provide / injectçˆ¶ç»„ä»¶ï¼šå¯¼åŒ…ä¹‹åï¼Œä»¥é”®å€¼å¯¹çš„å½¢å¼ï¼Œå­˜å‚¨äºçˆ¶ç»„ä»¶çš„provideä¸­ å­ç»„ä»¶ï¼šå¯¼åŒ…ä¹‹åï¼Œé€šè¿‡inject(é”®)æ¥è·å–ä¼ å…¥çš„æ•°æ®ï¼›ä¹Ÿå¯ä»¥ç»™injectä¼ å…¥ç¬¬äºŒä¸ªå‚æ•°æ¥æ·»åŠ é»˜è®¤å€¼ // çˆ¶ç»„ä»¶ import { provide, ref, readonly } from \"vue\"; import Child from \"./Child.vue\"; export default { setup() { const name = \"Allen\"; let count = ref(10); provide(\"name\", name); provide(\"count\", readonly(count)); }, components: { Child, }, }; // å­ç»„ä»¶ import { inject } from \"vue\"; export default { setup() { const name = inject(\"name\"); const count = inject(\"count\", 10); return { name, count, }; }, }; script setupscript setup æ˜¯åœ¨å•æ–‡ä»¶ç»„ä»¶ (SFC) ä¸­ä½¿ç”¨ç»„åˆå¼ API çš„ç¼–è¯‘æ—¶è¯­æ³•ç³–ã€‚ 2021.6.21ä¸ºæ­¢è¿˜æ˜¯å®éªŒæ€§ï¼Œä½†æ˜¯åˆ°äº†2021.11.28å¥½åƒå·²ç»è¢«çº³å…¥æ­£å¼ç‰ˆäº† ç›¸æ¯”äºæ™®é€šçš„ &lt;script&gt; è¯­æ³•ï¼Œå®ƒå…·æœ‰æ›´å¤šä¼˜åŠ¿ï¼š æ›´å°‘çš„æ ·æ¿å†…å®¹ï¼Œæ›´ç®€æ´çš„ä»£ç ã€‚ èƒ½å¤Ÿä½¿ç”¨çº¯ Typescript å£°æ˜ props å’ŒæŠ›å‡ºäº‹ä»¶ã€‚ æ›´å¥½çš„è¿è¡Œæ—¶æ€§èƒ½ (å…¶æ¨¡æ¿ä¼šè¢«ç¼–è¯‘æˆä¸å…¶åŒä¸€ä½œç”¨åŸŸçš„æ¸²æŸ“å‡½æ•°ï¼Œæ²¡æœ‰ä»»ä½•çš„ä¸­é—´ä»£ç†)ã€‚ æ›´å¥½çš„ IDE ç±»å‹æ¨æ–­æ€§èƒ½ (å‡å°‘è¯­è¨€æœåŠ¡å™¨ä»ä»£ç ä¸­æŠ½ç¦»ç±»å‹çš„å·¥ä½œ) import MyComponent from './MyComponent.vue' import { ref } from 'vue' const count = ref(0); {{ count }} åœ¨ &lt;script setup&gt; ä¸­å¿…é¡»ä½¿ç”¨ defineProps å’Œ defineEmits API æ¥å£°æ˜ props å’Œ emits è·å–è·¯ç”±å¯¹è±¡ä¾æ—§æ˜¯å› ä¸ºsetupä¸­è·å–ä¸åˆ°thisï¼Œæ­¤æ—¶å¯¼å…¥è·¯ç”±çš„hook æ­¤æ—¶è¿™é‡Œçš„ useRouteè¿”å›çš„route = this.$route import { useRoute } from 'vue-router'; export default { setup() { const route = useRoute(); }, }; åŒæ ·çš„ï¼Œæƒ³è¦è·å– $router å¯¹è±¡ï¼Œä¹Ÿéœ€è¦å¯¼å…¥è·¯ç”±hookï¼Œé€šè¿‡è¿”å›çš„routerå¯¹è±¡ï¼Œä½¿ç”¨åŸæ¥ this.$router.push æ–¹æ³• import { useRouter } from 'vue-router'; export default { setup() { const router = useRouter(); router.push(\"/xxx\") }, }; è·å–vuexä¾æ—§æ˜¯å› ä¸ºsetupä¸­è·å–ä¸åˆ°thisï¼Œæ­¤æ—¶å¯¼å…¥vuexçš„hook è¿™é‡Œå¼•å…¥äº†computedã€Vuexçš„mapStateï¼ˆä¸€ä¸ªå¯¹è±¡ï¼Œä¼ å…¥çš„å±æ€§æ˜¯å¤šä¸ªå‡½æ•°ï¼‰ç®€åŒ–æ¨¡æ¿ä¸­çš„æ•°æ®ç®€å†™ import { useStore, mapState } from 'vuex' import { computed } from 'vue' export default { setup() { const store = useStore(); const sCounter = computed(() => store.state.counter); // é™¤äº†ä¸€ä¸ªä¸€ä¸ªcomputedå£°æ˜ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨mapState const storeStateFns = mapState(['name', 'age']); const storeState = {}; Object.keys(storeStateFns) .forEach(key => { // mapStateé‡Œçš„å‡½æ•°è°ƒç”¨æ—¶return this.$store.state.xxxï¼Œæ‰€ä»¥è¿™é‡Œè¦å¤„ç†this const fn = storeStateFns[key].bind({ $store: store }); storeState[key] = computed(fn); }) return { sCounter, ...storeState } }, }; nextTickimport { nextTick } from \"vue\"; export default { setup() { // ä½¿ç”¨onUpdatedçš„è¯ä¹Ÿå¯ä»¥ï¼Œä½†æ˜¯onUpdatedæ¯”è¾ƒå…¬ç”¨ï¼Œä»»ä½•DOMæ›´æ–°éƒ½ä¼šè§¦å‘ nextTick(() => { //... }); }, }; vueçš„nextTickåŸç†æ€è·¯æœ‰ç‚¹åƒnode.jsä¸­äº‹ä»¶å¾ªç¯çš„nextTick vueæŠŠwatchçš„å›è°ƒã€ç»„ä»¶æ›´æ–°è§¦å‘çš„äº‹ä»¶ã€ç”Ÿå‘½å‘¨æœŸçš„å›è°ƒç­‰ä»»åŠ¡ï¼Œè€Œä»»åŠ¡å…¨éƒ¨è¢«åŠ å…¥åˆ°å¾®ä»»åŠ¡é˜Ÿåˆ—é‡Œé¢å»ï¼ï¼ï¼ï¼ è€Œä½¿ç”¨nextTickï¼Œå°±ä¼šè®©nextTickä¸­çš„å›è°ƒä»»åŠ¡åŠ å…¥åˆ°å¾®ä»»åŠ¡ä»»åŠ¡é˜Ÿåˆ—ä¸­ export function nextTick&lt;T = void>( this: T, fn?: (this: T) => void ): Promise&lt;void> { const p = currentFlushPromise || resolvedPromise return fn ? Promise.resolve().then(this ? fn.bind(this) : fn) : p } 5.åºŸå¼ƒ$childrenå±æ€§åœ¨ 3.x ä¸­ï¼Œ$children property å·²è¢«ç§»é™¤ï¼Œä¸”ä¸å†æ”¯æŒã€‚å¦‚æœä½ éœ€è¦è®¿é—®å­ç»„ä»¶å®ä¾‹ï¼Œæˆ‘ä»¬å»ºè®®ä½¿ç”¨ $refs filters optionæˆ‘ä»¬å»ºè®®ç”¨è®¡ç®—å±æ€§æˆ–æ–¹æ³•ä»£æ›¿è¿‡æ»¤å™¨ï¼Œè€Œä¸æ˜¯ä½¿ç”¨è¿‡æ»¤å™¨ã€‚ è¿ç§»æ„å»ºå¼€å…³ï¼š FILTERS COMPILER_FILTERS router-linkè·¯ç”± router-link çš„ tag å±æ€§ å› ä¸ºç°åœ¨å¯ä»¥ç›´æ¥å† router-link ä¸­å†™å…¥æ ‡ç­¾ï¼Œå½“ä½œslotä½¿ç”¨ å¯é€‰çš„ç¬¬ä¸‰ä¸ªå‚æ•° nextåœ¨ä¹‹å‰çš„ Vue Router ç‰ˆæœ¬ä¸­ï¼ˆå½“å‰2021å¹´ä¸º4.xç‰ˆæœ¬ï¼‰ï¼Œä¹Ÿæ˜¯å¯ä»¥ä½¿ç”¨ ç¬¬ä¸‰ä¸ªå‚æ•° next çš„ã€‚è¿™æ˜¯ä¸€ä¸ªå¸¸è§çš„é”™è¯¯æ¥æºï¼Œå¯ä»¥é€šè¿‡ RFC æ¥æ¶ˆé™¤é”™è¯¯ã€‚ç„¶è€Œï¼Œå®ƒä»ç„¶æ˜¯è¢«æ”¯æŒçš„ï¼Œè¿™æ„å‘³ç€ä½ å¯ä»¥å‘ä»»ä½•å¯¼èˆªå®ˆå«ä¼ é€’ç¬¬ä¸‰ä¸ªå‚æ•°ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œç¡®ä¿ next åœ¨ä»»ä½•ç»™å®šçš„å¯¼èˆªå®ˆå«ä¸­éƒ½è¢«ä¸¥æ ¼è°ƒç”¨ä¸€æ¬¡ã€‚å®ƒå¯ä»¥å‡ºç°å¤šäºä¸€æ¬¡ï¼Œä½†æ˜¯åªèƒ½åœ¨æ‰€æœ‰çš„é€»è¾‘è·¯å¾„éƒ½ä¸é‡å çš„æƒ…å†µä¸‹ï¼Œå¦åˆ™é’©å­æ°¸è¿œéƒ½ä¸ä¼šè¢«è§£ææˆ–æŠ¥é”™ã€‚è¿™é‡Œæœ‰ä¸€ä¸ªåœ¨ç”¨æˆ·æœªèƒ½éªŒè¯èº«ä»½æ—¶é‡å®šå‘åˆ°/loginçš„é”™è¯¯ç”¨ä¾‹ï¼š // BAD router.beforeEach((to, from, next) => { if (to.name !== 'Login' &amp;&amp; !isAuthenticated) next({ name: 'Login' }) // å¦‚æœç”¨æˆ·æœªèƒ½éªŒè¯èº«ä»½ï¼Œåˆ™ `next` ä¼šè¢«è°ƒç”¨ä¸¤æ¬¡ next() }) ä¸‹é¢æ˜¯æ­£ç¡®çš„ç‰ˆæœ¬: // GOOD router.beforeEach((to, from, next) => { if (to.name !== 'Login' &amp;&amp; !isAuthenticated) next({ name: 'Login' }) else next() }) ç°åœ¨æ›´å¤šé€šè¿‡è¿”å›å€¼æ¥æ§åˆ¶è·³è½¬ï¼ˆnextï¼‰ falseï¼šå–æ¶ˆå½“å‰å¯¼èˆª ä¸åæ‚”/ undefinedï¼šé»˜è®¤å¯¼èˆª è¿”å›ä¸€ä¸ªè·¯ç”±åœ°å€ï¼šå¯ä»¥æ˜¯Stringï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼ˆåŒ…å«pathã€paramsã€queryç­‰ä¿¡æ¯ï¼‰ï¼Œè·³åˆ°è¯¥å¯¼èˆªï¼ˆæŠŠè¿™ä¸ªçœ‹æˆ this.$router.push(&quot;/home&quot;); å³å¯ï¼‰ æ¯”å¦‚ router.beforeEach((to) => { if (to.path !== '/login') { const token = LocalCache.getCache('toekn') if (!token) { return '/login' } } }) Vue.extendåœ¨ Vue 2.x ä¸­ï¼ŒVue.extend æ›¾ç»è¢«ç”¨äºåˆ›å»ºä¸€ä¸ªåŸºäº Vue æ„é€ å‡½æ•°çš„â€œå­ç±»â€ï¼Œå…¶å‚æ•°åº”ä¸ºä¸€ä¸ªåŒ…å«ç»„ä»¶é€‰é¡¹çš„å¯¹è±¡ã€‚åœ¨ Vue 3.x ä¸­ï¼Œæˆ‘ä»¬å·²ç»æ²¡æœ‰ç»„ä»¶æ„é€ å™¨çš„æ¦‚å¿µäº†ã€‚åº”è¯¥å§‹ç»ˆä½¿ç”¨ createApp è¿™ä¸ªå…¨å±€ API æ¥æŒ‚è½½ç»„ä»¶ v-on.nativeå®ƒåŸæ¥æ˜¯ç”¨äºç»„ä»¶ä¸­åŸç”Ÿäº‹ä»¶çš„è§¦å‘ åŸæ¥çš„æ ·å­ è€Œç°åœ¨v-on çš„ .native ä¿®é¥°ç¬¦å·²è¢«ç§»é™¤ã€‚åŒæ—¶ï¼Œæ–°å¢çš„ emits é€‰é¡¹å…è®¸å­ç»„ä»¶å®šä¹‰çœŸæ­£ä¼šè¢«è§¦å‘çš„äº‹ä»¶ã€‚ å› æ­¤ï¼Œå¯¹äºå­ç»„ä»¶ä¸­æœªè¢«å®šä¹‰ä¸ºç»„ä»¶è§¦å‘çš„æ‰€æœ‰äº‹ä»¶ç›‘å¬å™¨ï¼ŒVue ç°åœ¨å°†æŠŠå®ƒä»¬ä½œä¸ºåŸç”Ÿäº‹ä»¶ç›‘å¬å™¨æ·»åŠ åˆ°å­ç»„ä»¶çš„æ ¹å…ƒç´ ä¸­ (é™¤éåœ¨å­ç»„ä»¶çš„é€‰é¡¹ä¸­è®¾ç½®äº† inheritAttrs: false)ã€‚ ï¼ˆå¯ä»¥ç†è§£ä¸ºç›´æ¥ç”¨å°±å¥½äº†ï¼Œä¸ç”¨åŠ nativeï¼‰ &lt;my-component v-on:close=\"handleComponentEvent\" v-on:click=\"handleNativeClickEvent\" /> //MyComponent.vue export default { emits: ['close'] } äº‹ä»¶æ€»çº¿Vue3å®˜æ–¹å®ä¾‹ç§»é™¤äº† $on ã€$off ã€$onceæ–¹æ³•ï¼Œæ‰€ä»¥ä¸èƒ½åƒVue2.xä¸€æ ·é€šè¿‡åˆ›å»ºVueå®ä¾‹æ¥è¿›è¡Œäº‹ä»¶æ€»çº¿ã€‚å¦‚æœæˆ‘ä»¬å¸Œæœ›ç»§ç»­ä½¿ç”¨äº‹ä»¶æ€»çº¿ï¼Œå¯ä»¥é€šè¿‡ä¸€äº›ç¬¬ä¸‰æ–¹çš„åº“ï¼ŒVue3å®˜æ–¹æ¨è mittæˆ–è€…tiny-emitter mittåº“çš„ä½¿ç”¨ npm i mitt jsæ–‡ä»¶å°è£… import mitt from 'mitt' const emitter = mitt(); export default emitter; ç»„ä»¶ä½¿ç”¨ï¼ˆç›´æ¥å‘å¸ƒè®¢é˜…å®Œäº‹ï¼‰ import emitter from 'xxx.js' äº‹ä»¶(){ emitter.emit('äº‹ä»¶åç§°', {a: 1, b: 2}) } import emitter from 'xxx.js' //åˆ›å»ºåˆæœŸç›´æ¥ç›‘å¬å‘å¸ƒ created(){ emitter.on('äº‹ä»¶åç§°', data => { //.... })ï¼› emitter.on('*', (type, data) => { console.log(`å¦‚æœæ˜¯*åˆ™ç›‘å¬æ‰€æœ‰äº‹ä»¶,äº‹ä»¶ç±»å‹ï¼š${type}ï¼Œä¼ é€’å‚æ•°ï¼š${data}`); }) } mitäº‹ä»¶ç›‘å¬å–æ¶ˆ //å…¨éƒ¨ä¸€æ¬¡æ€§å–æ¶ˆ emitter.all.clear(); //å•ä¸ªå–æ¶ˆï¼Œå‡½æ•°éœ€è¦å®šä¹‰ function onFoo() {} emitter.on('foo', onFoo); emitter.off('foo', onFoo);","categories":[{"name":"å‰ç«¯","slug":"å‰ç«¯","permalink":"https://taylor12138.github.io/categories/%E5%89%8D%E7%AB%AF/"}],"tags":[],"author":"Hello"},{"title":"Vue3(ä¸‹)","slug":"Vue3(ä¸‹)","date":"2021-11-04T16:00:00.000Z","updated":"2022-08-27T13:07:00.499Z","comments":true,"path":"2021/11/05/vue3-xia/","link":"","permalink":"https://taylor12138.github.io/2021/11/05/vue3-xia/","excerpt":"","text":"6.VueåŠ¨ç”»å¤„ç†vueæœ‰ä¸ªå†…ç½®ç»„ä»¶ transition åŸºæœ¬ä½¿ç”¨ï¼šä½¿ç”¨nameå®šä¹‰è¿‡æ¸¡ç±»åï¼Œç„¶åå¸¸å¸¸ä¸v-ifã€v-showã€åŠ¨æ€ç»„ä»¶è¿›è¡Œæ­é… å®˜æ–¹ï¼š å¯ä»¥ç»™ä»»ä½•å…ƒç´ å’Œç»„ä»¶æ·»åŠ è¿›å…¥/ç¦»å¼€è¿‡æ¸¡ æ¡ä»¶æ¸²æŸ“ (ä½¿ç”¨ v-if) æ¡ä»¶å±•ç¤º (ä½¿ç”¨ v-show) åŠ¨æ€ç»„ä»¶ ç»„ä»¶æ ¹èŠ‚ç‚¹ åŸºæœ¬ä½¿ç”¨ï¼ˆCSSï¼‰&lt;transition name=\"why\"> &lt;h2 v-if=\"isShow\">Hello World&lt;/h2> &lt;/transition> .why-enter-from, .why-leave-to { opacity: 0; } .why-enter-to, .why-leave-from { opacity: 1; } .why-enter-active, .why-leave-active { transition: opacity 2s ease; } classå‡ ä¸ªtransitionçš„ç±»ï¼ˆæˆ‘ä»¬å¯ä»¥é€šè¿‡nameæ¥å®šä¹‰å‰ç¼€ï¼Œæ¯”å¦‚name=â€allenâ€ï¼Œåˆ™ç±»ä¸ºallen-enter-fromï¼‰ v-enter-fromï¼šå®šä¹‰è¿›å…¥è¿‡æ¸¡çš„å¼€å§‹çŠ¶æ€ã€‚åœ¨å…ƒç´ è¢«æ’å…¥ä¹‹å‰ç”Ÿæ•ˆï¼Œåœ¨å…ƒç´ è¢«æ’å…¥ä¹‹åçš„ä¸‹ä¸€å¸§ç§»é™¤ã€‚ï¼ˆæ’å…¥æ—¶æ ·å¼ï¼‰ v-enter-activeï¼šå®šä¹‰è¿›å…¥è¿‡æ¸¡ç”Ÿæ•ˆæ—¶çš„çŠ¶æ€ã€‚åœ¨æ•´ä¸ªè¿›å…¥è¿‡æ¸¡çš„é˜¶æ®µä¸­åº”ç”¨ï¼Œåœ¨å…ƒç´ è¢«æ’å…¥ä¹‹å‰ç”Ÿæ•ˆï¼Œåœ¨è¿‡æ¸¡/åŠ¨ç”»å®Œæˆä¹‹åç§»é™¤ã€‚è¿™ä¸ªç±»å¯ä»¥è¢«ç”¨æ¥å®šä¹‰è¿›å…¥è¿‡æ¸¡çš„è¿‡ç¨‹æ—¶é—´ï¼Œå»¶è¿Ÿå’Œæ›²çº¿å‡½æ•°ã€‚ï¼ˆæ’å…¥ingæ ·å¼ï¼Œå¸¸å­˜æ”¾åŠ¨ç”»ï¼‰ v-enter-toï¼šå®šä¹‰è¿›å…¥è¿‡æ¸¡çš„ç»“æŸçŠ¶æ€ã€‚åœ¨å…ƒç´ è¢«æ’å…¥ä¹‹åä¸‹ä¸€å¸§ç”Ÿæ•ˆ (ä¸æ­¤åŒæ—¶ v-enter-from è¢«ç§»é™¤)ï¼Œåœ¨è¿‡æ¸¡/åŠ¨ç”»å®Œæˆä¹‹åç§»é™¤ã€‚ï¼ˆæ’å…¥åæ ·å¼ï¼‰ v-leave-fromï¼šå®šä¹‰ç¦»å¼€è¿‡æ¸¡çš„å¼€å§‹çŠ¶æ€ã€‚åœ¨ç¦»å¼€è¿‡æ¸¡è¢«è§¦å‘æ—¶ç«‹åˆ»ç”Ÿæ•ˆï¼Œä¸‹ä¸€å¸§è¢«ç§»é™¤ã€‚ï¼ˆç§»é™¤å‰æ ·å¼ï¼‰ v-leave-activeï¼šå®šä¹‰ç¦»å¼€è¿‡æ¸¡ç”Ÿæ•ˆæ—¶çš„çŠ¶æ€ã€‚åœ¨æ•´ä¸ªç¦»å¼€è¿‡æ¸¡çš„é˜¶æ®µä¸­åº”ç”¨ï¼Œåœ¨ç¦»å¼€è¿‡æ¸¡è¢«è§¦å‘æ—¶ç«‹åˆ»ç”Ÿæ•ˆï¼Œåœ¨è¿‡æ¸¡/åŠ¨ç”»å®Œæˆä¹‹åç§»é™¤ã€‚è¿™ä¸ªç±»å¯ä»¥è¢«ç”¨æ¥å®šä¹‰ç¦»å¼€è¿‡æ¸¡çš„è¿‡ç¨‹æ—¶é—´ï¼Œå»¶è¿Ÿå’Œæ›²çº¿å‡½æ•°ã€‚ï¼ˆç§»é™¤ingæ ·å¼ï¼Œå¸¸å­˜æ”¾åŠ¨ç”»ï¼‰ v-leave-toï¼šç¦»å¼€è¿‡æ¸¡çš„ç»“æŸçŠ¶æ€ã€‚åœ¨ç¦»å¼€è¿‡æ¸¡è¢«è§¦å‘ä¹‹åä¸‹ä¸€å¸§ç”Ÿæ•ˆ (ä¸æ­¤åŒæ—¶ v-leave-from è¢«åˆ é™¤)ï¼Œåœ¨è¿‡æ¸¡/åŠ¨ç”»å®Œæˆä¹‹åç§»é™¤ã€‚ï¼ˆç§»é™¤åæ ·å¼ï¼‰ transitionçš„å‡ ä¸ªprops name - string ç”¨äºè‡ªåŠ¨ç”Ÿæˆ CSS è¿‡æ¸¡ç±»åã€‚ä¾‹å¦‚ï¼šname: &#39;fade&#39; å°†è‡ªåŠ¨æ‹“å±•ä¸º .fade-enterï¼Œ.fade-enter-active ç­‰ã€‚ appear - booleanï¼Œæ˜¯å¦åœ¨åˆå§‹æ¸²æŸ“æ—¶ä½¿ç”¨è¿‡æ¸¡ã€‚é»˜è®¤ä¸º falseã€‚ mode - string æ§åˆ¶ç¦»å¼€/è¿›å…¥è¿‡æ¸¡çš„æ—¶é—´åºåˆ—ã€‚æœ‰æ•ˆçš„æ¨¡å¼æœ‰ &quot;out-in&quot; ï¼ˆå…ˆç§»é™¤ï¼Œå†æ’å…¥ï¼‰å’Œ &quot;in-out&quot;ï¼ˆå…ˆæ’å…¥ï¼Œå†ç§»é™¤ï¼‰ï¼›é»˜è®¤åŒæ—¶è¿›è¡Œã€‚ duration - number | { enter: number, leave: number }ã€‚æŒ‡å®šè¿‡æ¸¡çš„æŒç»­æ—¶é—´ï¼ŒæŒ‡å®šä¹‹åcssåŠ¨ç”»é‡ŒåŸæ¥å†™å¥½çš„æ—¶é—´åˆ™æ— æ•ˆ cssï¼ŒæŒ‡å®š :css=&#39;false&#39;å¯ä»¥è®©cssè¿‡æ¸¡å±æ€§å¤±æ•ˆï¼Œæé«˜æ€§èƒ½ï¼ˆç”¨äºåªæ‰§è¡ŒjsåŠ¨ç”»ï¼‰ ç¬¬ä¸‰æ–¹åŠ¨ç”»åº“animate.csså®˜ç½‘ï¼šhttps://animate.style/ npm i animate.css --save ç„¶åç›´æ¥åœ¨main.jsé‡Œé¢å¼•å…¥ import \"animate.css\"; åœ¨å®˜ç½‘æœå¯»è‡ªå·±æƒ³è¦çš„åŠ¨ç”»åç§°ï¼Œå¹¶ä¸”åœ¨transitionç±»ä¸­æ·»åŠ ï¼Œæ¯”å¦‚ .allen-enter-active { animation: bounceInUp 1s linear } .allen-leave-active { animation: bounceInUp 1s linear reverse } gsapåº“ä¸€ä¸ªJSåŠ¨ç”»åº“ï¼ˆvueå®˜æ–¹æœ‰åœ¨ç”¨ï¼‰ï¼Œå®˜ç½‘ï¼šhttps://greensock.com/ é€šè¿‡JavaScriptä¸ºCSSå±æ€§ï¼ŒSVGã€Canvasç­‰è®¾ç½®åŠ¨ç”»ï¼Œå¹¶ä¸”éƒ½æ˜¯æµè§ˆå™¨å…¼å®¹çš„ npm i gsap ä½¿ç”¨gsapåº“é…åˆjsé’©å­ä½¿ç”¨ methods: { enter(el, done) { console.log(\"enter\"); gsap.from(el, { scale: 0, x: 200, onComplete: done }) }, leave(el, done) { console.log(\"leave\"); gsap.to(el, { scale: 0, x: 200, onComplete: done }) } } gsapé™¤äº†å¯¹å…ƒç´ ï¼ˆelementï¼‰è¿›è¡ŒJSåŠ¨ç”»å¤„ç†ï¼Œä¹Ÿå¯ä»¥å¯¹æŸä¸ªæ™®é€šå¯¹è±¡ï¼Œè¿›è¡ŒæŒ‰ç…§æ—¶é—´é—´éš”é€æ­¥æ”¹å˜å±æ€§å€¼ å½“å‰è®¡æ•°: {{showNumber.toFixed(0)}} import gsap from 'gsap'; export default { data() { return { counter: 0, showNumber: 0 } }, watch: { counter(newValue) { gsap.to(this, {duration: 1, showNumber: newValue}) } } } JSé’©å­transitionå†…ç½®ç»„ä»¶é™¤äº†å¯ä»¥ä½¿ç”¨CSSåŠ¨ç”»ï¼Œè¿˜å¯ä»¥é…åˆä¸ŠJSåŠ¨ç”» æ­¤æ—¶ä½¿ç”¨é‡Œé¢å®šä¹‰å¥½çš„JSé’©å­å³å¯ï¼ˆé’©å­ä½œç”¨åˆ†åˆ«æŸ¥çœ‹å­—é¢æ„æ€å³å¯ï¼Œ enter-cancelledå’Œ leave-cancelledå¯¹åº”çš„æ˜¯å–æ¶ˆæ“ä½œ ï¼‰ ç”¨çš„æœ€å¤šæ˜¯enterå’Œleave &lt;transition @before-enter=\"beforeEnter\" @enter=\"enter\" @after-enter=\"afterEnter\" @enter-cancelled=\"enterCancelled\" @before-leave=\"beforeLeave\" @leave=\"leave\" @after-leave=\"afterLeave\" @leave-cancelled=\"leaveCancelled\" :css=\"false\" > &lt;!-- ... --> &lt;/transition> é’©å­å‡½æ•°å¯ä»¥é€‰æ‹©å¸¦å…¥å‚æ•°ï¼š elï¼šå½“å‰å…ƒç´  doneï¼šå½“åªç”¨ JavaScript è¿‡æ¸¡çš„æ—¶å€™ï¼Œåœ¨ enter å’Œ leave é’©ä¸­å¿…é¡»ä½¿ç”¨ done è¿›è¡Œå›è°ƒã€‚å¦åˆ™ï¼Œå®ƒä»¬å°†è¢«åŒæ­¥è°ƒç”¨ï¼Œè¿‡æ¸¡ä¼šç«‹å³å®Œæˆã€‚ // ... methods: { beforeEnter(el) { // ... }, // å½“ä¸ CSS ç»“åˆä½¿ç”¨æ—¶ // å›è°ƒå‡½æ•° done æ˜¯å¯é€‰çš„ enter(el, done) { // ... done() }, afterEnter(el) { // ... }, enterCancelled(el) { // ... }, // -------- // ç¦»å¼€æ—¶ // -------- beforeLeave(el) { // ... }, // å½“ä¸ CSS ç»“åˆä½¿ç”¨æ—¶ // å›è°ƒå‡½æ•° done æ˜¯å¯é€‰çš„ leave(el, done) { // ... done() }, afterLeave(el) { // ... }, // leaveCancelled åªç”¨äº v-show ä¸­ leaveCancelled(el) { // ... } } åˆ—è¡¨æ’å…¥åˆ—è¡¨æ–°å¢ / åˆ é™¤å…ƒç´ çš„æ—¶å€™ï¼Œå¯ä»¥æ¨¡æ‹Ÿæˆv-ifæ—¶ï¼Œæ–°å¢/ åˆ é™¤ å…ƒç´  åªä¸è¿‡é€šè¿‡ transition-group è¿›è¡ŒåŒ…è£¹ propsï¼š tagï¼šå°† transition-groupå˜æˆ xxæ ‡ç­¾ ä¸è¿‡ï¼Œåˆ—è¡¨å¤šå‡ºäº†å…¶ä»–å…ƒç´ ï¼Œè€Œæ·»åŠ  / åˆ é™¤å…ƒç´ æ—¶å½±å“åˆ°å…¶ä»–åˆ—è¡¨å…ƒç´ ä½ç½®æ—¶ï¼Œè°ƒæ•´çš„åŠ¨ç”»è¯¥å¦‚ä½•è®¾ç½®ï¼Ÿ æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ v-moveçš„classæ¥å®ŒæˆåŠ¨ç”»çš„è®¾ç½®ï¼Œå®ƒä¼šåœ¨å…ƒç´ æ”¹å˜ä½ç½®çš„æ—¶å€™åº”ç”¨ï¼Œå’Œä¹‹å‰çš„åå­—ä¸€æ ·ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡nameå®šä¹‰å‰ç¼€ æ·»åŠ  / åˆ é™¤åˆ—è¡¨å…ƒç´ å°æ¡ˆä¾‹ æ·»åŠ æ•°å­— åˆ é™¤æ•°å­— {{item}} export default { data() { return { numbers: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9], numCounter: 10 } }, methods: { addNum() { this.numbers.splice(this.randomIndex(), 0, this.numCounter++) }, removeNum() { this.numbers.splice(this.randomIndex(), 1) }, randomIndex() { return Math.floor(Math.random() * this.numbers.length) } }, } .item { margin-right: 10px; display: inline-block; } .why-enter-from, .why-leave-to { opacity: 0; transform: translateY(30px); } .why-enter-active, .why-leave-active { transition: all 1s ease; } .why-leave-active { position: absolute; /*é˜²æ­¢ç§»é™¤çš„è¿‡ç¨‹ä¸­ä»å æ®åŸæ¥çš„ä½ç½®ï¼Œå¯¼è‡´å…ƒç´ ç§»åŠ¨çš„åŠ¨ç”»ä¸æˆåŠŸ*/ } .why-move { transition: transform 1s ease; } 7.å…¶ä»–è‡ªå®šä¹‰æŒ‡ä»¤ä»£ç çš„å¤ç”¨ä¸»è¦è¿˜æ˜¯é€šè¿‡ç»„ä»¶ï¼Œä½†æ˜¯åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œä½ éœ€è¦å¯¹DOMå…ƒç´ è¿›è¡Œåº•å±‚æ“ä½œï¼Œå°±å¯ä»¥ç”¨åˆ°è‡ªå®šä¹‰æŒ‡ä»¤ è‡ªå®šä¹‰å±€éƒ¨æŒ‡ä»¤ï¼šç»„ä»¶é€šè¿‡directivesé€‰é¡¹ è‡ªå®šä¹‰å…¨å±€æŒ‡ä»¤ï¼šappçš„directivesé€‰é¡¹ æ¡ˆä¾‹ï¼šä¸ºç»„ä»¶è‡ªå®šä¹‰ v-focus æŒ‡ä»¤ export default { // å±€éƒ¨æŒ‡ä»¤ directives:{ focus:{ mounted(el, bindings, vnode, preVnode) { el.focus(); }, } } } è‹¥ä¸ºå…¨å±€æŒ‡ä»¤åˆ™åœ¨main.jsä¸­å®šä¹‰ï¼ˆæ›´å¸¸ç”¨ï¼‰ import { createApp } from 'vue' import App from './App.vue' createApp(App).mount('#app'); // å…¨å±€æŒ‡ä»¤ app.directive(\"focus\", { mounted(el, bindings, vnode, preVnode) { el.focus(); }, }) è‡ªå®šä¹‰æŒ‡ä»¤å†…éƒ¨çš„ç”Ÿå‘½å‘¨æœŸå±æ€§ï¼š åç§° created beforeMount mounted beforeUpdate updated beforeUnmount unmounted ç”Ÿå‘½å‘¨æœŸå‡½æ•°æºå¸¦çš„å‚æ•° elï¼šå…ƒç´  bindingsï¼šä¸€ä¸ªå¯¹è±¡ï¼Œé‡Œé¢å­˜å‚¨ä¼ å…¥çš„å‚æ•°ã€ä¿®é¥°ç¬¦ç­‰ vnodeè™šæ‹ŸèŠ‚ç‚¹ preVnodeï¼ŒæŒ‡å‘ä¸Šä¸€ä¸ªè™šæ‹ŸèŠ‚ç‚¹ teleportåœ¨æŸäº›æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¹¶ä¸æƒ³è¦å°†ç»„å»ºæŒ‚è½½åœ¨ç»„ä»¶æ ‘ä¸Šï¼Œè€Œæ˜¯ç§»åŠ¨åˆ°Vue app ä»¥å¤–çš„åœ°æ–¹ï¼ˆæˆ‘ä»¬æœ‰å…¶ä»–div#appçš„å…ƒç´ ï¼‰ teleportæ˜¯Vueå†…ç½®ç»„ä»¶ï¼Œç±»ä¼¼äºReactçš„Portals å®ƒæœ‰ä¸¤ä¸ªå±æ€§ toï¼šæŒ‡å®šå°†å…¶ä¸­çš„å†…å®¹ç§»åŠ¨åˆ°ç›®æ ‡å…ƒç´ ï¼Œå¯ä»¥ä½¿ç”¨é€‰æ‹©å™¨ disabledï¼šæ˜¯å¦ç¦ç”¨teleportçš„åŠŸèƒ½ è‡ªå®šä¹‰æ’ä»¶å…¨å±€æ’ä»¶æœ‰ä¸ªçº¦å®šä¿—æˆçš„å°è§„èŒƒï¼šå‘½åéƒ½åŠ $, $å¼€å¤´ æ·»åŠ å®Œæ¯•ä¹‹åï¼Œå¯ä»¥é€šè¿‡ this.å‘½åæ¥è·å– ä½†æ˜¯setupæ¯”è¾ƒéº»çƒ¦ï¼Œå› ä¸ºsetupä¸èƒ½é€šè¿‡thisæ‹¿åˆ°ç»„ä»¶å®ä¾‹ export default { install(app) { app.config.globalProperties.$name = \"Allen\" } } åœ¨main.jsä¸­å¯¼å…¥ import { createApp } from 'vue' import App from './App.vue' import plugins_object from './plugins/plugins_object' const app = createApp(App) app.use(plugins_object); // ä½¿ç”¨æ’ä»¶ /* å†…éƒ¨æ‰§è¡Œplugins_object.install(app) */ app.mount('#app'); åœ¨Vue3ä¸­ï¼Œuseæ–¹æ³•å®é™…ä¸Šæ˜¯æŠŠæ’ä»¶æ·»åŠ è¿›Setä¸­ï¼Œç„¶åè°ƒç”¨å…¶installæ–¹æ³• å¦‚æœæ²¡æœ‰installæ–¹æ³•ï¼Œè€Œpluginæœ¬èº«å°±æ˜¯ä¸€ä¸ªæ–¹æ³•ï¼Œåˆ™è°ƒç”¨pluginæ–¹æ³• use(plugin: Plugin, ...options: any[]) { if (installedPlugins.has(plugin)) { __DEV__ &amp;&amp; warn(`Plugin has already been applied to target app.`) } else if (plugin &amp;&amp; isFunction(plugin.install)) { installedPlugins.add(plugin) plugin.install(app, ...options) } else if (isFunction(plugin)) { installedPlugins.add(plugin) plugin(app, ...options) } else if (__DEV__) { warn( `A plugin must either be a function or an object with an \"install\" ` + `function.` ) } return app }, vue3æºç ç›¸å…³ä¸‰å¤§æ ¸å¿ƒ Complieræ¨¡å—ï¼Œç¼–è¯‘æ¨¡æ¿ç³»ç»Ÿï¼ˆtempplate -&gt; hå‡½æ•°å¯è¯†åˆ«çš„å½¢å¼ï¼‰ Runtimeæ¨¡å—ï¼Œç§°ä¹‹ä¸ºRendereræ¨¡å—ï¼ŒçœŸæ­£çš„æ¸²æŸ“æ¨¡å—ï¼ˆhå‡½æ•°å¯è¯†åˆ«çš„å½¢å¼ -&gt; è™šæ‹ŸDOM -&gt; çœŸå®DOMï¼‰ Reactivityæ¨¡å—ï¼Œå“åº”å¼ç³»ç»Ÿ element-plushttps://element-plus.gitee.io/zh-CN/ Element Plusï¼Œä¸€å¥—ä¸ºå¼€å‘è€…ã€è®¾è®¡å¸ˆå’Œäº§å“ç»ç†å‡†å¤‡çš„åŸºäº Vue 3 çš„æ¡Œé¢ç«¯ç»„ä»¶åº“ï¼ˆElementæ˜¯é’ˆå¯¹vue2.xçš„ï¼‰ å¦‚æœæ˜¯ç§»åŠ¨ç«¯çš„æ¨èä½¿ç”¨ VantUI ä½¿ç”¨ï¼š æ–¹æ¡ˆä¸€ï¼šç›´æ¥å…¨å±€å¼•ç”¨ - &gt; æ‰€æœ‰ç»„ä»¶å…¨éƒ¨é›†æˆï¼Œç»„ä»¶å…¨éƒ¨è¿›è¡Œäº†å…¨å±€æ³¨å†Œ ä¼˜ç‚¹ï¼šé›†æˆæ¯”è¾ƒç®€å•ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ ç¼ºç‚¹ï¼šå…¨éƒ¨æ‰“åŒ…â€˜ // main.ts import { createApp } from 'vue' import ElementPlus from 'element-plus' import 'element-plus/dist/index.css' import App from './App.vue' const app = createApp(App) app.use(ElementPlus) app.mount('#app') æ–¹æ¡ˆäºŒï¼šæŒ‰éœ€å¼•ç”¨ ä¼˜ç‚¹ï¼šåŒ…ä¼šæ¯”è¾ƒå° ç¼ºç‚¹ï¼šå¼•ç”¨éº»çƒ¦ æ–¹æ¡ˆä¸‰ï¼šå®˜ç½‘æ¨èçš„è‡ªåŠ¨å¯¼å…¥ 8.åŒå‘ç»‘å®šProxy VS Object.defineProperty Vue2.xç‰ˆæœ¬ä¸­çš„åŒå‘ç»‘å®šä¸èƒ½æ£€æµ‹åˆ°ä¸‹æ ‡çš„å˜åŒ–ï¼Œä¸å­˜åœ¨çš„å±æ€§ä¸èƒ½è¢«æ‹¦æˆªï¼ˆå…¶å®ä¹Ÿæ˜¯å› ä¸º Object.definePropertyæ–¹æ³•å¿…é¡»ä¼ å…¥å¯¹è±¡ã€å±æ€§å‚æ•°ï¼‰ï¼Œå±æ€§ä¸­è¿˜æœ‰å±æ€§åµŒå¥—è¿˜å¾—é€’å½’ï¼›proxyå¯ä»¥åŠ«æŒæ•´ä¸ªå¯¹è±¡ï¼Œå¹¶è¿”å›ä¸€ä¸ªæ–°å¯¹è±¡ï¼Œç®¡ä½ å±æ€§å­˜ä¸å­˜åœ¨éƒ½å¯ä»¥æ‹¦æˆª å“åº”å¼æ–¹é¢ æ€§èƒ½å¾—åˆ°å¾ˆå¤§æå‡ ä¸ç”¨åˆå§‹åŒ–çš„æ—¶å€™å°±é€’å½’éå†å±æ€§ï¼›å“åº”å¼ä¸åŒºåˆ†æ•°ç»„å’Œå¯¹è±¡ ä¿®æ”¹å¯¹è±¡ï¼š ä½¿ç”¨ Object.defineProperty æˆ‘ä»¬ä¿®æ”¹åŸæ¥çš„objå¯¹è±¡å°±è§¦å‘æ‹¦æˆª ä½¿ç”¨proxyè¦ä¿®æ”¹ä»£ç†å¯¹è±¡ï¼Œæ‰è§¦å‘æ‹¦æˆªï¼ˆå³ä½¿åœ¨getteræ–¹æ³•ä¸­ return target[key]ï¼Œä¹Ÿä¸ä¼šè§¦å‘å¾ªç¯è°ƒç”¨ ï¼‰ Proxyèƒ½è§‚å¯Ÿçš„ç±»å‹æ¯”definePropertyæ›´åŠ ä¸°å¯Œï¼Œæ¯”å¦‚hasã€deletePropertyç­‰ Proxyä½œä¸ºæ–°æ ‡å‡†å°†å—åˆ°æµè§ˆå™¨å‚å•†çš„é‡ç‚¹ä¼˜åŒ– more: è¿™é‡ŒProxyç›¸å¯¹ä¸åŸæ¥Vue2.0çš„å“åº”å¼çš„ â€œä¸ç®¡ä¸‰ä¸ƒäºŒåä¸€ï¼Œä¸Šæ¥å°±ç»™ä½ åˆ¤æ–­å¯¹è±¡ + é€’å½’ â€ ä¸ä¸€æ ·ï¼Œåšäº†å°ä¼˜åŒ–ï¼Œä»–åœ¨ä¿®æ”¹æ•°æ®æ—¶å¹¶ä¸æ˜¯ä¸€ä¸Šæ¥å°±é€’å½’ï¼Œè€Œæ˜¯å…ˆé€šè¿‡getæ–¹æ³•è·å–ï¼Œå¦‚æœè·å–åˆ°çš„ç»“æœæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œåˆ™å†åšä¸€å±‚ä»£ç†ï¼Œè¿›è¡Œé€’å½’ï¼Œç„¶åå†é€šè¿‡setä¿®æ”¹ æ—¢ç„¶Proxyå¯ä»¥æ”¹å±æ€§ + æ–°å¢å±æ€§ï¼Œé‚£ä»–æ€ä¹ˆè¯†åˆ«ï¼Ÿé€šè¿‡ if è¯­å¥ + å¯¹è±¡.hasOwnProperty(å±æ€§) åˆ¤æ–­ï¼ŒåŸæ¥æ˜¯å¦æœ‰è¿™ä¸ªå±æ€§ ä¸ºä»€ä¹ˆä»¥å‰ä¸ç”¨Proxyï¼Ÿå…¼å®¹æ€§å·®ã€‚ã€‚ã€‚ie11å°±ä¸å…¼å®¹ ä»£ç†æ¨¡å¼ä»£ç†æ¨¡å¼ï¼ˆè‹±è¯­ï¼šProxy Patternï¼‰æ˜¯ç¨‹åºè®¾è®¡ä¸­çš„ä¸€ç§è®¾è®¡æ¨¡å¼ã€‚ å½“ä¸€ä¸ªå¤æ‚å¯¹è±¡çš„å¤šä»½å‰¯æœ¬é¡»å­˜åœ¨æ—¶ï¼Œä»£ç†æ¨¡å¼å¯ä»¥ç»“åˆäº«å…ƒæ¨¡å¼ä»¥å‡å°‘å†…å­˜ç”¨é‡ã€‚å…¸å‹ä½œæ³•æ˜¯åˆ›å»ºä¸€ä¸ªå¤æ‚å¯¹è±¡åŠå¤šä¸ªä»£ç†è€…ï¼Œæ¯ä¸ªä»£ç†è€…ä¼šå¼•ç”¨åˆ°åŸæœ¬çš„å¤æ‚å¯¹è±¡ã€‚è€Œä½œç”¨åœ¨ä»£ç†è€…çš„è¿ç®—ä¼šè½¬é€åˆ°åŸæœ¬å¯¹è±¡ã€‚ä¸€æ—¦æ‰€æœ‰çš„ä»£ç†è€…éƒ½ä¸å­˜åœ¨æ—¶ï¼Œå¤æ‚å¯¹è±¡ä¼šè¢«ç§»é™¤ã€‚ ProxyProxyä»£ç†Object æ§åˆ¶å’Œä¿®æ”¹Objectçš„åŸºæœ¬è¡Œä¸ºï¼ˆè¦†ç›–å¯¹è±¡çš„åŸºæœ¬æ“ä½œï¼‰ï¼Œæ¯”å¦‚å±æ€§è°ƒç”¨ã€å±æ€§èµ‹å€¼ã€åˆ é™¤å±æ€§ã€æ–¹æ³•è°ƒç”¨ç­‰ targetæ˜¯è¢«ä»£ç†çš„å¯¹è±¡ï¼Œhandleræ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå±æ€§æ˜¯å„ç§æ§åˆ¶æˆ–ä¿®æ”¹targetåŸºæœ¬è¡Œä¸ºçš„æ–¹æ³• ä½ å¯ä»¥æƒ³è±¡æˆproxyå°±æ˜¯ä¸€ä¸ªå£³ const p = new Proxy(target, handler); handleré‡Œé¢çš„get()ã€set()å’ŒObject.defineProperty()çš„getæ–¹æ³•ã€setæ–¹æ³•æœ‰ç‚¹åƒï¼Œé‡æ–°å®šä¹‰äº†å±æ€§çš„è¯»å–ã€è®¾ç½®è¡Œä¸º get()æ‹¦æˆªæŸä¸ªå±æ€§çš„è¯»å–æ“ä½œã€‚å¯ä»¥æ¥å—ä¸‰ä¸ªå‚æ•°ï¼Œä¾æ¬¡ä¸ºç›®æ ‡å¯¹è±¡ã€å±æ€§åå’Œ proxy å®ä¾‹æœ¬èº«ï¼ˆä¸¥æ ¼åœ°è¯´ï¼Œæ˜¯æ“ä½œè¡Œä¸ºæ‰€é’ˆå¯¹çš„å¯¹è±¡ï¼‰ï¼Œå…¶ä¸­æœ€åä¸€ä¸ªå‚æ•°å¯é€‰ã€‚ set()æ‹¦æˆªæŸä¸ªå±æ€§çš„èµ‹å€¼æ“ä½œã€‚å¯ä»¥æ¥å—å››ä¸ªå‚æ•°ï¼Œä¾æ¬¡ä¸ºç›®æ ‡å¯¹è±¡ã€å±æ€§åã€å±æ€§å€¼å’Œ Proxy å®ä¾‹æœ¬èº«ï¼Œå…¶ä¸­æœ€åä¸€ä¸ªå‚æ•°å¯é€‰ã€‚ å…¶å®handleræœ‰13ç§æ–¹æ³• handler.getPrototypeOf() // åœ¨è¯»å–ä»£ç†å¯¹è±¡çš„åŸå‹æ—¶è§¦å‘è¯¥æ“ä½œï¼Œæ¯”å¦‚åœ¨æ‰§è¡Œ Object.getPrototypeOf(proxy) æ—¶ã€‚ handler.setPrototypeOf() // åœ¨è®¾ç½®ä»£ç†å¯¹è±¡çš„åŸå‹æ—¶è§¦å‘è¯¥æ“ä½œï¼Œæ¯”å¦‚åœ¨æ‰§è¡Œ Object.setPrototypeOf(proxy, null) æ—¶ã€‚ handler.isExtensible() // åœ¨åˆ¤æ–­ä¸€ä¸ªä»£ç†å¯¹è±¡æ˜¯å¦æ˜¯å¯æ‰©å±•æ—¶è§¦å‘è¯¥æ“ä½œï¼Œæ¯”å¦‚åœ¨æ‰§è¡Œ Object.isExtensible(proxy) æ—¶ã€‚ handler.preventExtensions() // åœ¨è®©ä¸€ä¸ªä»£ç†å¯¹è±¡ä¸å¯æ‰©å±•æ—¶è§¦å‘è¯¥æ“ä½œï¼Œæ¯”å¦‚åœ¨æ‰§è¡Œ Object.preventExtensions(proxy) æ—¶ã€‚ handler.getOwnPropertyDescriptor() // åœ¨è·å–ä»£ç†å¯¹è±¡æŸä¸ªå±æ€§çš„å±æ€§æè¿°æ—¶è§¦å‘è¯¥æ“ä½œï¼Œæ¯”å¦‚åœ¨æ‰§è¡Œ Object.getOwnPropertyDescriptor(proxy, \"foo\") æ—¶ã€‚ handler.defineProperty() // åœ¨å®šä¹‰ä»£ç†å¯¹è±¡æŸä¸ªå±æ€§æ—¶çš„å±æ€§æè¿°æ—¶è§¦å‘è¯¥æ“ä½œï¼Œæ¯”å¦‚åœ¨æ‰§è¡Œ Object.defineProperty(proxy, \"foo\", {}) æ—¶ã€‚ handler.has() // åœ¨åˆ¤æ–­ä»£ç†å¯¹è±¡æ˜¯å¦æ‹¥æœ‰æŸä¸ªå±æ€§æ—¶è§¦å‘è¯¥æ“ä½œï¼Œæ¯”å¦‚åœ¨æ‰§è¡Œ \"foo\" in proxy æ—¶ã€‚ handler.get() // åœ¨è¯»å–ä»£ç†å¯¹è±¡çš„æŸä¸ªå±æ€§æ—¶è§¦å‘è¯¥æ“ä½œï¼Œæ¯”å¦‚åœ¨æ‰§è¡Œ proxy.foo æ—¶ã€‚ handler.set() // åœ¨ç»™ä»£ç†å¯¹è±¡çš„æŸä¸ªå±æ€§èµ‹å€¼æ—¶è§¦å‘è¯¥æ“ä½œï¼Œæ¯”å¦‚åœ¨æ‰§è¡Œ proxy.foo = 1 æ—¶ã€‚ handler.deleteProperty() // åœ¨åˆ é™¤ä»£ç†å¯¹è±¡çš„æŸä¸ªå±æ€§æ—¶è§¦å‘è¯¥æ“ä½œï¼Œæ¯”å¦‚åœ¨æ‰§è¡Œ delete proxy.foo æ—¶ã€‚ handler.ownKeys() // åœ¨è·å–ä»£ç†å¯¹è±¡çš„æ‰€æœ‰å±æ€§é”®æ—¶è§¦å‘è¯¥æ“ä½œï¼Œæ¯”å¦‚åœ¨æ‰§è¡Œ Object.getOwnPropertyNames(proxy) æ—¶ã€‚ handler.apply() // åœ¨è°ƒç”¨ä¸€ä¸ªç›®æ ‡å¯¹è±¡ä¸ºå‡½æ•°çš„ä»£ç†å¯¹è±¡æ—¶è§¦å‘è¯¥æ“ä½œï¼Œæ¯”å¦‚åœ¨æ‰§è¡Œ proxy() æ—¶ã€‚ handler.construct() // åœ¨ç»™ä¸€ä¸ªç›®æ ‡å¯¹è±¡ä¸ºæ„é€ å‡½æ•°çš„ä»£ç†å¯¹è±¡æ„é€ å®ä¾‹æ—¶è§¦å‘è¯¥æ“ä½œï¼Œæ¯”å¦‚åœ¨æ‰§è¡Œnew proxy() æ—¶ã€‚ é‡Œé¢çš„æ–¹æ³•ä¸€èˆ¬éƒ½éœ€è¦è¿”å›å€¼ var obj = new Proxy({}, { get: function (target, propKey, receiver) { console.log(`getting ${propKey}!`); return Reflect.get(target, propKey, receiver); }, set: function (target, propKey, value, receiver) { console.log(`setting ${propKey}!`); return Reflect.set(...arguments); } }); ç”šè‡³ä½ å¯ä»¥ç”¨proxyåšç¼“å­˜ æœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯åŒæ­¥ä¸€ä¸ªçŠ¶æ€å¯èƒ½ä¼šå‡ºç°é—®é¢˜ï¼Œè¿™å¾ˆå¸¸è§ï¼Œåœ¨æ•´ä¸ªæ“ä½œå‘¨æœŸå†…ï¼Œæ•°æ®éƒ½æœ‰å¯èƒ½è¢«æ”¹å˜ï¼Œå¹¶ä¸”å¾ˆéš¾å»æŒæ¡éœ€è¦é‡æ–°åŒæ­¥çš„æ—¶æœºã€‚proxyæä¾›äº†ä¸€ç§æ–°çš„åŠæ³•ï¼Œå¯ä»¥è®©å±æ€§åœ¨å¿…è¦çš„æ—¶å€™å¤±æ•ˆï¼Œæ‰€æœ‰çš„è®¿é—®æ“ä½œï¼Œéƒ½ä¼šè¢«æ£€æŸ¥åˆ¤æ–­ï¼Œæ˜¯å¦è¿”å›ç¼“å­˜è¿˜æ˜¯è¿›è¡Œå…¶ä»–è¡Œä¸ºçš„å“åº”ã€‚ Copyconst timeExpired = (target, ttl = 60) => { const created_at = Date.now(); const isExpired = () => (Date.now - created_at) > ttl * 1000; return new Proxy(tarvet, { get: (target, k) => isExpired() ? undefined : Reflect.get(target, k); }) } ä¸Šé¢çš„åŠŸèƒ½å¾ˆç®€å•ï¼Œä»–åœ¨ä¸€å®šæ—¶é—´å†…æ­£å¸¸è¿”å›è®¿é—®çš„å±æ€§ï¼Œå½“è¶…å‡ºttlæ—¶é—´åï¼Œä¼šè¿”å›undefinedã€‚ Copylet timeExpired = ephemeral({ balance: 14.93 }, 10) console.log(bankAccount.balance) // 14.93 setTimeout(() => { console.log(bankAccount.balance) // undefined }, 10 * 1000) ä¸Šé¢çš„ä¾‹å­ä¼šè¾“å‡ºundefinedåœ¨åç§’åï¼Œæ›´å¤šçš„éªšæ“ä½œè¿˜è¯·è‡ªè¡Œæ–Ÿé…Œã€‚ Reflecté€šè¿‡Proxyçš„æ•è·å™¨ï¼ˆhandlerï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥å®ŒæˆåŸºäºè‡ªå·±çš„å‚æ•°é‡å»ºåŸå§‹æ“ä½œï¼Œä½†æ˜¯å¹¶éæ‰€æœ‰æ•è·å™¨éƒ½åƒ get ä¸€æ ·é‚£ä¹ˆç®€å•ï¼Œç›´æ¥è¿”å›å°±è¡Œäº†ï¼Œæ‰€ä»¥é€šè¿‡æ‰‹åŠ¨å†™ç å¦‚æ³•ç‚®åˆ¶çš„æƒ³æ³•æ˜¯ä¸ç°å®çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬ä½¿ç”¨åˆ°äº†Reflectå®Œæˆè½»æ¾é‡å»ºï¼Œç¡®ä¿å®ŒæˆåŸæœ‰çš„è¡Œä¸ºï¼Œç„¶åå†éƒ¨ç½²é¢å¤–çš„åŠŸèƒ½ã€‚ Reflect å°†Objectå¯¹è±¡çš„ä¸€äº›æ˜æ˜¾å±äºè¯­è¨€å†…éƒ¨çš„æ–¹æ³•ï¼ˆæ¯”å¦‚Object.definePropertyï¼‰ï¼Œæ”¾åˆ°Reflectå¯¹è±¡ä¸Šï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œä»Reflectå¯¹è±¡ä¸Šå¯ä»¥æ‹¿åˆ°è¯­è¨€å†…éƒ¨çš„æ–¹æ³•ã€‚ Reflectä¿®æ”¹æŸäº›Objectæ–¹æ³•çš„è¿”å›ç»“æœï¼Œè®©å…¶å˜å¾—æ›´åˆç†ã€‚ æ¯”å¦‚ï¼ŒObject.defineProperty(obj, name, desc)åœ¨æ— æ³•å®šä¹‰å±æ€§æ—¶ï¼Œä¼šæŠ›å‡ºä¸€ä¸ªé”™è¯¯ï¼Œè€ŒReflect.defineProperty(obj, name, desc)åˆ™ä¼šè¿”å›falseã€‚ ä¸Šé¢ä¸¤ç‚¹è¡¨æ˜ Reflectå¯èƒ½å°†æˆä¸ºæ—¥åæ›¿ä»£ Objectå¯¹è±¡æ–¹æ³•çš„æ–°çš„ç‹ï¼ è®©Objectæ“ä½œéƒ½å˜æˆå‡½æ•°è¡Œä¸ºã€‚æŸäº›Objectæ“ä½œæ˜¯å‘½ä»¤å¼ï¼Œæ¯”å¦‚name in objå’Œdelete obj[name]ï¼Œè€ŒReflect.has(obj, name)å’ŒReflect.deleteProperty(obj, name)è®©å®ƒä»¬å˜æˆäº†å‡½æ•°è¡Œä¸ºã€‚ // è€å†™æ³• 'assign' in Object // true // æ–°å†™æ³• Reflect.has(Object, 'assign') // true Reflectå¯¹è±¡çš„æ–¹æ³•ä¸Proxyå¯¹è±¡çš„æ–¹æ³•ä¸€ä¸€å¯¹åº”ï¼Œåªè¦æ˜¯Proxyå¯¹è±¡çš„æ–¹æ³•ï¼Œå°±èƒ½åœ¨Reflectå¯¹è±¡ä¸Šæ‰¾åˆ°å¯¹åº”çš„æ–¹æ³•ã€‚è¿™å°±è®©Proxyå¯¹è±¡å¯ä»¥æ–¹ä¾¿åœ°è°ƒç”¨å¯¹åº”çš„Reflectæ–¹æ³•ï¼Œå®Œæˆé»˜è®¤è¡Œä¸ºï¼Œä½œä¸ºä¿®æ”¹è¡Œä¸ºçš„åŸºç¡€ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸ç®¡Proxyæ€ä¹ˆä¿®æ”¹é»˜è®¤è¡Œä¸ºï¼Œä½ æ€»å¯ä»¥åœ¨Reflectä¸Šè·å–é»˜è®¤è¡Œä¸ºã€‚ Proxy(target, { set: function(target, name, value, receiver) { var success = Reflect.set(target, name, value, receiver); if (success) { console.log('property ' + name + ' on ' + target + ' set to ' + value); } return success; } }); ä¸Šé¢ä»£ç ä¸­ï¼ŒProxyæ–¹æ³•æ‹¦æˆªtargetå¯¹è±¡çš„å±æ€§èµ‹å€¼è¡Œä¸ºã€‚å®ƒé‡‡ç”¨Reflect.setæ–¹æ³•å°†å€¼èµ‹å€¼ç»™å¯¹è±¡çš„å±æ€§ï¼Œç¡®ä¿å®ŒæˆåŸæœ‰çš„è¡Œä¸ºï¼Œç„¶åå†éƒ¨ç½²é¢å¤–çš„åŠŸèƒ½ã€‚ ä¸ªäººè®¤ä¸ºï¼šè¿™æ ·å°±å½¢æˆäº†Proxyå’ŒReflectçš„æœ€ä½³æ­é…ï¼Œæ—¢ä¿è¯äº†åŸæ¥ï¼ˆé»˜è®¤ï¼‰çš„è¡Œä¸ºï¼Œåˆå¯ä»¥è‡ªå·±æ·»åŠ é¢å¤–çš„è¡Œä¸º 9.Vue3 + TS é¡¹ç›®æ­å»ºè§„èŒƒé›†æˆeditorconfigé…ç½®editorconfigæœ‰åŠ©äºä¸ºä¸åŒIDEç¼–è¾‘å™¨ä¸ŠåŒä¸€é¡¹ç›®å¤šäººå¼€å‘çš„ç¼–ç é£æ ¼ï¼ˆæ¯”å¦‚æ§åˆ¶tabç¼©è¿›ç©ºæ ¼æ•°é‡ç­‰ï¼‰ åœ¨æ ¹ç›®å½•ä¸‹æ–°å»ºä¸€ä¸ª .editorconfig æ–‡ä»¶ æ³¨æ„ï¼Œé»˜è®¤æƒ…å†µä¸‹vscodeä¸ä¼šè¯»å–è¿™ä¸ªæ–‡ä»¶ï¼Œéœ€è¦å®‰è£…ä¸€ä¸ªæ’ä»¶ EditorConfig for VScode # https://editorconfig.org root = true [*] #æ‰€æœ‰æ–‡ä»¶é€‚ç”¨ charset = utf-8 #æ–‡å­—å­—ç¬¦é›†å•Šuft-8 indent_style = space #ç¼©è¿›é£æ ¼space indent_size = 2 #ç¼©è¿›å¤§å° end_of_line = lf #æ§åˆ¶æ¢è¡Œç±»å‹lfã€crã€crlf insert_final_newline = true #å»é™¤è¡Œé¦–ä»»æ„ç©ºç™½å­—ç¬¦ trim_trailing_whitespace = true #å§‹ç»ˆåœ¨æ–‡ä»¶æœ«å°¾æ’å…¥ä¸€ä¸ªæ–°è¡Œ [*.md] insert_final_newline = false trim_trailing_whitespace = false é…ç½®eslintæ¨èå…ˆåœ¨vscodeå®‰è£…ä¸€ä¸‹eslintæ’ä»¶ ç„¶åå¯ä»¥åœ¨æ ¹ç›®å½•ä¸‹çš„.eslintrc.jsæ–‡ä»¶æŸ¥çœ‹eslintçš„è§„åˆ™é…ç½® ä½†æ˜¯æœ‰æ—¶å€™å‡ºç°æˆ‘ä»¬è‡ªå®šä¹‰prettieré…ç½®ï¼ˆæ ¼å¼åŒ–ï¼‰å’Œæˆ‘ä»¬çš„eslintå¹¶ä¸å…¼å®¹çš„åœºé¢ï¼Œæ­¤æ—¶æˆ‘ä»¬è¦å®‰è£…ä¸¤ä¸ªåº“ï¼ˆå¦‚æœåœ¨åˆ›å»ºè„šæ‰‹æ¶çš„æ—¶å€™æœ‰é…ç½®è¿‡eslint + prettieré€‰é¡¹çš„è¯ï¼Œåˆ™å·²ç»å¸®æˆ‘ä»¬å®‰è£…è¿‡äº†ï¼‰ npm i eslint-plugin-prettier eslint-config-prettier -D ç„¶ååœ¨é…ç½®æ–‡ä»¶ .eslintrc.js ä¸­çš„extendsè®¾ç½®æœ€åä¸€è¡Œ extends: [ 'plugin:vue/vue3-essential', 'eslint:recommended', '@vue/typescript/recommended', '@vue/prettier', '@vue/prettier/@typescript-eslint', 'plugin:prettier/recomended' ] è‹¥æƒ³å…³æ‰ä¸€äº›eslintæ£€æŸ¥ï¼Œå¯ä»¥ rules: { 'no-console': process.env.NODE_ENV === 'production' ? 'warn' : 'off', 'no-debugger': process.env.NODE_ENV === 'production' ? 'warn' : 'off', 'typescirpt-eslint/no-var-require': 'off' // å…³é—­å¯¹requireå¼•ç”¨çš„ç¦ä»¤ } ä¸åŒçš„å¼€å‘ç¯å¢ƒåœ¨å¼€å‘ä¸­ï¼Œæœ‰æ—¶å€™æˆ‘ä»¬éœ€è¦æ ¹æ®ä¸åŒçš„ç¯å¢ƒè®¾ç½®ä¸åŒçš„ç¯å¢ƒå˜é‡ï¼Œå¸¸è§çš„æœ‰ä¸‰ç§ç¯å¢ƒ å¼€å‘ç¯å¢ƒï¼šdevelopment ç”Ÿäº§ç¯å¢ƒï¼šproduction æµ‹è¯•ç¯å¢ƒï¼štest æ–¹æ³•ä¸€ï¼š ä¸ºäº†è®©ä¸åŒç¯å¢ƒä½¿ç”¨ä¸åŒçš„å˜é‡ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ process.env.NODE_ENV è¿™ä¸ªå€¼å®é™…ä¸Šæ˜¯æˆ‘ä»¬ä½¿ç”¨webapackçš„æ—¶å€™ï¼Œé€šè¿‡å®ƒçš„DefinePluginå…¨å±€å˜é‡ï¼Œæ ¹æ®ç¯å¢ƒæ³¨å…¥ä¸åŒçš„å€¼ï¼Œä½¿å¾—åœ¨ä¸åŒç¯å¢ƒä¸‹ process.env.NODE_ENV çš„å€¼åˆ†åˆ«æ˜¯ â€˜developmentâ€™ ã€â€™productionâ€™ã€â€™testâ€™ æ­¤æ—¶æˆ‘ä»¬å…¨å±€æ³¨å…¥çš„å˜é‡é€šè¿‡ if-else æˆ–è€… switch è¿›è¡Œå˜åŒ–å³å¯ï¼ˆæ¯”å¦‚ if(process.env.NODE_ENV === &#39;development&#39;) ï¼‰ æ–¹æ³•äºŒï¼š æ³¨æ„ï¼šæ­¤æ–¹æ³•åˆ›å»ºçš„å˜é‡åä¸èƒ½ä¹±èµ·ï¼Œåªæœ‰èµ·å›ºå®šæ ¼å¼çš„åå­—ï¼Œæ‰ä¼šè¢«å…¨å±€æ³¨å…¥ å®˜ç½‘æ³¨æ˜ï¼šè¯·æ³¨æ„ï¼Œåªæœ‰ NODE_ENVï¼ŒBASE_URL å’Œä»¥ VUE_APP_ å¼€å¤´çš„å˜é‡å°†é€šè¿‡ webpack.DefinePlugin é™æ€åœ°åµŒå…¥åˆ°å®¢æˆ·ç«¯ä¾§çš„ä»£ç ä¸­ã€‚è¿™æ˜¯ä¸ºäº†é¿å…æ„å¤–å…¬å¼€æœºå™¨ä¸Šå¯èƒ½å…·æœ‰ç›¸åŒåç§°çš„ç§é’¥ã€‚ åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹æ–°å»ºä¸‰ä¸ªæ–‡ä»¶ï¼Œæ–‡ä»¶ååˆ†åˆ«æ˜¯ .env.devlopmentã€.env.productionã€.env.test // .env.test VUE_APP_BASE_URL = &#39;&#39; VUE_APP_BASE_NAME = &#39;allen&#39;æ–¹æ¡ˆäºŒæ­¤æ—¶åœ¨å®¢æˆ·ç«¯ä¾§ä»£ç ä¸­ä½¿ç”¨ç¯å¢ƒå˜é‡ åªæœ‰ä»¥ VUE_APP_ å¼€å¤´çš„å˜é‡ä¼šè¢« webpack.DefinePlugin é™æ€åµŒå…¥åˆ°å®¢æˆ·ç«¯ä¾§çš„åŒ…ä¸­ã€‚ä½ å¯ä»¥åœ¨åº”ç”¨çš„ä»£ç ä¸­è¿™æ ·è®¿é—®å®ƒä»¬ï¼š console.log(process.env.VUE_APP_SECRET) Vuexé…åˆTScreateStoreå¯ä»¥ä¼ å…¥ä¸€ä¸ªæ³›å‹ å˜æˆ createStore&lt;T&gt; è¿™ä¸ªæ³›å‹ è§„å®šäº† stateçš„ç±»å‹ import { createStore } from 'vuex' interface IRootState { name: string age: number } export default createStore&lt;IRootState>({ state: () => { return { name: 'allen', age: 18 } }, mutations: {}, actions: {}, modules: {} }) // ä½¿ç”¨ import { useStore } from 'vuex'; import {IRootState} from '@/store/types'; export default defineComponent({ setup() { const store = useStore&lt;IRootState>() return {} } }) ä½†æ˜¯æ­¤æ—¶æˆ‘ä»¬å³ä½¿é‡Œé¢å·²ç»å®šä¹‰äº†ä¸€äº›æ¨¡å—ï¼Œtsè¿˜æ˜¯ä¼šç»™æˆ‘ä»¬æŠ¥é”™ï¼Œæ¯”å¦‚æˆ‘ä»¬çš„storeé‡Œé¢æœ‰ä¸ªloginæ¨¡å— ä½†æ˜¯ä½¿ç”¨çš„æ—¶å€™tsä¼šæŠ¥é”™ store.state.login.name æ­¤æ—¶å°±è¡¨ç°äº†vuexå¯¹TSçš„æ”¯æŒéå¸¸å·®ï¼ˆ4.xç‰ˆæœ¬ï¼‰ ä¸è¿‡piniaå¯¹TSçš„æ”¯æŒå°±ç›¸å¯¹å¥½ä¸€ç‚¹ï¼Œç”¨æ³•ä¹Ÿå’Œvuexç›¸ä¼¼ å½“ç„¶coderwhyè€å¸ˆè¿˜æ˜¯æœ‰è§£å†³çš„æ–¹æ³•ï¼Œæ¯”å¦‚å¯¼å‡ºvuexçš„æ—¶å€™ï¼Œå†™å¤šä¸€ä¸ªå‡½æ•°è¿›è¡Œå¯¼å‡º vuexæ¨¡å—ä½¿ç”¨ï¼ˆnewï¼‰æ¥å£å®šä¹‰ import { ILoginState } from './login/types' export interface IRootState { name: string age: number } export interface IStoreType extends IRootState { login: ILoginState } åœ¨store/index.tsæ–‡ä»¶ä¸­å¯¼å‡ºä¸€ä¸ªå‡½æ•° import { createStore, Store, useStore } from 'vuex' import { IRootState, IStoreType } from './types' //.... //è´Ÿè´£å¯¼å‡ºstoreï¼ˆcoderwhyè€å¸ˆçš„ç‰¹æ®Šå¤„ç†ï¼‰ export function useMyStore(): Store&lt;IStoreType> { return useStore() } export default store æ­¤æ—¶ä½¿ç”¨ import { defineComponent } from 'vue' import { useMyStore } from '@/store' export default defineComponent({ setup() { const store = useMyStore() console.log(store.state.login.name) //æ­¤æ—¶ä½¿ç”¨èµ·æ¥æ²¡é—®é¢˜ï¼ return {} } }) vuexçš„modulesæ¨¡å—å°è£… åœ¨tsä½¿ç”¨vuexä¸­moduleæ¥å°è£…æ¨¡å—çš„æ—¶å€™ï¼Œéœ€è¦å¯¼å…¥çš„Moduleç±»å‹å£°æ˜ä¹Ÿæœ‰è®²ç©¶ Moduleç±»å‹ç±»å‹å£°æ˜éœ€è¦ä¼ å…¥ä¸¤ä¸ªæ³›å‹ Module&lt;S, R&gt; S ä¸º æ¨¡å—ä¸­stateçš„ç±»å‹ï¼ŒRä¸ºæ ¹æ¨¡å—çš„stateç±»å‹ é‡åˆ°ç¹ççš„æ¥å£å®šä¹‰ç™¾åº¦ä¸€ä¸‹ï¼šjson to ts ä¼šè‡ªåŠ¨è½¬æ¢ï¼ŒæŠŠjsonè½¬æ¢æˆtsè¯­æ³•ï¼Œç›´æ¥å¸®ä½ å†™å¥½ ä½†æ˜¯é‡åˆ°å¤æ‚çš„æ•°æ®ç±»å‹ï¼ŒåµŒå¥—ï¼Œå®ƒçš„è½¬æ¢ä»ç„¶æ˜¯æœ‰é—®é¢˜çš„ã€‚æ­¤æ—¶å°±åªèƒ½ç”¨anyäº† TSç»“åˆVue3çš„propsæœ‰æ—¶é¢å¯¹propsä¼ å‚çš„æ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦ç‰¹å®šç±»å‹æ¥è§„èŒƒæˆ‘ä»¬ä¼ å…¥çš„å‚æ•°ï¼Œè€Œå•å•é propsè‡ªèº«çš„typeæˆ‘ä»¬è¿˜ä¸æ»¡è¶³ï¼Œæ­¤æ—¶æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ PropType &lt;script lang=\"ts\"> import { defineComponent, PropType } from 'vue' export default defineComponent({ props: { formItems: { type: Array as PropType&lt;string[]> } }, setup() { return {} } }) &lt;/script> æ­¤æ—¶æˆ‘ä»¬å¯ä»¥åœ¨æ³›å‹é‡Œé¢å®šä¹‰æ¥å£ï¼Œä¹Ÿæ˜¯å¯ä»¥çš„ ä½†æ˜¯ä¼—æ‰€å‘¨çŸ¥ï¼Œåœ¨å®šä¹‰é»˜è®¤å€¼çš„æ—¶å€™ï¼Œå¤æ‚æ•°æ®ç±»å‹è¦å†™æˆä¸€ä¸ªå‡½æ•°çš„å½¢å¼ï¼ˆã€ŠVue(ä¸Š)ã€‹ç¯‡ç« æœ‰æåŠï¼‰ ä½†æ˜¯å¦‚æœæ˜¯vue3 + tsçš„è¯ï¼Œè§„å®šè¦å†™æˆä¸€ä¸ªç®­å¤´å‡½æ•°ï¼ˆä½¿ç”¨thisæ—¶ï¼‰","categories":[{"name":"å‰ç«¯","slug":"å‰ç«¯","permalink":"https://taylor12138.github.io/categories/%E5%89%8D%E7%AB%AF/"}],"tags":[],"author":"Hello"},{"title":"ç½‘ç«™æ€§èƒ½ä¼˜åŒ–","slug":"ç½‘ç«™æ€§èƒ½ä¼˜åŒ–","date":"2021-11-01T16:00:00.000Z","updated":"2022-10-07T08:04:02.246Z","comments":true,"path":"2021/11/02/wang-zhan-xing-neng-you-hua/","link":"","permalink":"https://taylor12138.github.io/2021/11/02/wang-zhan-xing-neng-you-hua/","excerpt":"","text":"1.ç½‘ç«™æ€§èƒ½ä¼˜åŒ–æ¦‚è¿°æˆ‘ä»¬é€šå¸¸çš„æ ‡é‡åŒ– ç™½å± é¦–å± é¡µé¢æ•´ä½“åŠ è½½ é¡µé¢å¯äº¤äº’ åŠŸèƒ½äº¤äº’å“åº” Steve Soudersåœ¨ã€Šé«˜æ€§èƒ½ç½‘ç«™å»ºè®¾æŒ‡å—ã€‹æ€»ç»“çš„12æ¡æé«˜æ€§èƒ½çš„åŸºæœ¬è§„åˆ™ å°½é‡å‡å°‘httpè¯·æ±‚ ä½¿ç”¨CDN é™æ€èµ„æºä½¿ç”¨Cache å¯ç”¨Gzipå‹ç¼© JavaScriptè„šæœ¬å°½é‡æ”¾åœ¨é¡µé¢åº•éƒ¨ CSSæ ·å¼è¡¨æ”¾åœ¨é¡¶éƒ¨ é¿å…CSSè¡¨è¾¾å¼ï¼ˆä¹Ÿå°±æ˜¯ä¸è¦é¢‘ç¹åŠ¨æ€æ”¹åŠ¨CSSï¼‰ å‡å°‘å†…è”çš„CSSå’ŒJavaScript å‡å°‘DNSæŸ¥è¯¢ ç²¾ç®€JavaScript é¿å…é‡å®šå‘ åˆ é™¤é‡å¤è„šæœ¬ 2.ç™½å±ç™½å±æ—¶é•¿æˆ‘ä»¬å¯ä»¥ä»URLåœ°å€çš„è¾“å…¥ -&gt; è¯·æ±‚å‘å‡º -&gt; é¡µé¢æ¸²æŸ“å®Œæˆï¼Œä¹‹ä¸­æ‰¾åˆ°ä¼˜åŒ–çš„æ–¹æ¡ˆ DNS -&gt; TCP -&gt;æœåŠ¡ç«¯å“åº” -&gt; å®¢æˆ·ç«¯ä¸‹è½½ã€è§£æã€æ¸²æŸ“æ˜¾ç¤ºé¡µé¢ DNS LookupDNSçš„ä¼˜åŒ–ç­–ç•¥æœ‰å¾ˆå¤š DNSç¼“å­˜ä¼˜åŒ– DNSé¢„åŠ è½½ç­–ç•¥ é¡µé¢ä¸­èµ„æºåŸŸåçš„åˆç†åˆ†é… ç¨³å®šå¯é çš„DNSæœåŠ¡å™¨ å®¢æˆ·ç«¯ä¸‹è½½å…·ä½“æ­¥éª¤ å¦‚æœæ˜¯GzipåŒ…ï¼Œå…ˆè§£å‹ä¸ºHTML è§£æHTMLå¤´éƒ¨ä»£ç ï¼Œä¸‹è½½ç›¸å…³çš„èµ„æºï¼ˆCSSã€JSç­‰ï¼‰ æ­£å¸¸çš„ç½‘é¡µç»˜åˆ¶æµç¨‹ï¼ˆrenderæ ‘çš„åˆæˆä»¥åŠé¡µé¢çš„ç»˜åˆ¶ï¼‰ è€Œåœ¨çœŸå®çš„æ„ä»¶ä¸­ï¼Œæµè§ˆå™¨ä¼šå› ä¸ºå„ç§å› ç´ è¢«é˜»æ–­ JSä»£ç ä¼šé˜»æ–­DOMæ ‘çš„æ„é€  æµè§ˆå™¨å¿…é¡»ç­‰å¾…æ ·å¼è¡¨åŠ è½½å®Œæˆï¼Œé‡‡è´­ä»¶CSSOMæ ‘ Firefoxåœ¨å­˜åœ¨æ ·å¼è¡¨è¿˜åœ¨åŠ è½½å’Œè§£ææ—¶é˜»å¡æ‰€æœ‰çš„è„šæœ¬ï¼Œè€ŒChromeåªåœ¨å½“è„šæœ¬è¯•å›¾è®¿é—®æŸäº›å¯èƒ½è¢«æœªåŠ è½½çš„æ ·å¼è¡¨æ‰€å½±å“çš„ç‰¹å®šçš„æ ·å¼å±æ€§æ—¶æ‰é˜»å¡è¿™äº›è„šæœ¬ã€‚ï¼ˆå´å†³äºæµè§ˆå™¨çš„ç­–ç•¥ï¼‰ ä»ä¸Šè¿°æˆ‘ä»¬å¯ä»¥å‘ç°HTMLä¸­å†…è”JSä»£ç çš„æ¶åŠ£æ€§è´¨ã€‚å®ƒæœ€å¤§çš„å±å®³åœ¨äºç¬¬ä¸‰ç§ï¼Œå³DOMæ ‘æ„å»ºè¿‡ç¨‹ä¸­è¢«JSé˜»å¡ï¼Œè€ŒJSè¢«CSSé˜»å¡ï¼Œè¿™å¯¼è‡´äº†CSSOMæ ‘å’ŒDOMæ ‘åŒæ—¶ï¼ˆå¹¶è¡Œï¼‰æ„å»ºçš„ç†æƒ³çŠ¶æ€è¢«æ‰“ç ´ ç„¶è€Œå¯¹ä»¥ä¸Šçš„ä¼˜åŒ–ç­–ç•¥ï¼Œæˆ‘ä»¬å¯ä»¥ç€æ‰‹äº ä¼˜åŒ–HTMLä»£ç ç»“æ„ï¼Œç¼©çŸ­ä¸‹è½½æ—¶é—´ + è§£æé€Ÿåº¦ ä¼˜åŒ–CSSæ–‡ä»¶å’Œç»“æ„ åˆç†æ”¾ç½®JSä»£ç  ç½‘ä¸Šå…³äºCSRé¦–å±ä¼˜åŒ–çš„æ–¹æ¡ˆé“¾æ¥https://github.com/BetaSu/fe-hunter/issues/4#issuecomment-1075856575 ä¸€ã€å¦‚ä½•åˆ†æé¦–å±åŠ è½½CSRçš„æ€§èƒ½ï¼Ÿæœ‰ä¸‰ç§æ–¹å¼è¿›è¡Œåˆ†æï¼š networkï¼ˆæµè§ˆå™¨-&gt;DevToolsï¼‰ performance ï¼ˆæµè§ˆå™¨-&gt;DevToolsï¼‰ lighthouseï¼ˆæµè§ˆå™¨-&gt;DevToolsï¼‰ sentryï¼ˆç¬¬ä¸‰æ–¹å¹³å°ï¼‰ webPageTest æ›´å…¨é¢ï¼Œæ›´è¯¦ç»†ï¼Œæ›´å¼ºå¤§çš„é¡µé¢åˆ†æå…·ä½“æ€ä¹ˆæ“ä½œæˆ‘å°±ä¸èµ˜è¿°äº†ï¼Œå„ä½è‡ªè¡Œå»çœ‹ã€‚ äºŒã€åˆ†æåå¦‚ä½•æ‰¾å‡ºCSRæ€§èƒ½ç“¶é¢ˆï¼ŸæŒ‰ç…§ä¸Šé¢çš„5ç§æ–¹å¼æ¥çœ‹å§ ä¸‰ã€å¦‚ä½•è§£å†³CSRæ€§èƒ½ç“¶é¢ˆï¼Ÿä»CSRæ–¹å‘æ¥è®²çš„è¯ï¼ŒåŸºæœ¬å°±ä¸¤ä¸ªæ–¹å‘äº† ç½‘ç»œå±‚é¢ï¼šä»ç½‘ç»œæ–¹é¢æ¥è®²ï¼Œå°±æ˜¯å‡å°‘HTTPè¯·æ±‚çš„æ¬¡æ•°ï¼Œä»¥åŠå‡å°è¯·æ±‚ä½“ç§¯ï¼Œè¿™é‡Œå°±ç®€å•èŠå‡ ç‚¹a). å°†å¤šæ¬¡è¯·æ±‚åˆå¹¶åˆ°ä¸€æ¬¡è¯·æ±‚ï¼ˆajaxã€ç²¾çµå›¾ï¼Œæ–‡ä»¶åˆå¹¶ç­‰ï¼‰b). é¡µé¢æ‡’åŠ è½½åº”è¯¥ä¹Ÿå¯ä»¥ç®—åœ¨è¿™ä¸ªæ–¹é¢ã€‚c). ç¼“å­˜ä½ä¸€äº›ä¸ç»å¸¸æ”¹åŠ¨çš„æ–‡ä»¶æˆ–å†…å®¹å°†è¯·æ±‚æ‹¦æˆªï¼ˆservice workerï¼‰b). æ–‡ä»¶å†…å®¹å‹ç¼©e). é™æ€èµ„æºCDNä¹Ÿæ˜¯æ–¹å¼ä¹‹ä¸€f). å‡çº§åˆ° http2 æ¸²æŸ“å±‚é¢a). éª¨æ¶å±ï¼Œèµ·ç èƒ½è®©ç”¨æˆ·æœ‰æ‰“å¼€äº†ç½‘é¡µçš„æ„Ÿè§‰b). å›¾ç‰‡æ‡’åŠ è½½c). é˜²æŠ–èŠ‚æµd). ä»£ç å±‚é¢çš„æ”¹å–„å§ï¼Œå¾ˆæœ‰å¯èƒ½æ˜¯æŸäº›åä»£ç äº§ç”Ÿçš„ å››ã€æœ‰æ²¡æœ‰å…¶ä»–æ¸²æŸ“æ–¹æ¡ˆå¯ä»¥è§£å†³CSRå½“å‰é—®é¢˜ï¼Œä»–çš„åŸç†æ˜¯ä»€ä¹ˆï¼ŸSSRã€‚å°±æ˜¯å°†æ¡†æ¶ä»£ç æå‰åœ¨æœåŠ¡ç«¯è·‘ä¸€éï¼Œä¸è¿‡ä¸€èˆ¬é™¤éå¯¹SEOè¦æ±‚æ¯”è¾ƒé«˜æˆ–è€…ä½ ä»¬å…¬å¸æ¯”è¾ƒæœ‰é’±ï¼Œå¦åˆ™ä¸å¤ªä¼šå»ä½¿ç”¨ï¼Œå› ä¸ºæ¯”è¾ƒå ç”¨æœåŠ¡å™¨çš„èµ„æºã€‚ 3.é¡µé¢æ•´ä½“åŠ è½½å®Œæˆåˆè¢«ç§°ä¸ºPageLoadï¼Œé¡¾åæ€ä¹‰æ‰€æœ‰é¡µé¢ç›¸å…³èµ„æºå…¨éƒ¨åŠ è½½å®Œæˆçš„æ—¶é—´ï¼Œè€Œå…¶ä¸­è¿™ä¸ªæ—¶é—´ç‚¹ä¸ºæˆ‘ä»¬ç†ŸçŸ¥çš„â€œ8sâ€åŸåˆ™ éšååœ¨2006å¹´ï¼Œä¸€ä¸ªæ¥è‡ªAkamaiçš„æ–°ç ”ç©¶ï¼Œå‘è¡¨äº†æ–°çš„è§‚ç‚¹ï¼šé€šå¸¸4så·¦å³çš„å¹³å‡åŠ è½½æ—¶é—´ï¼Œæ˜¯ç”¨æˆ·å¯èƒ½ä¼šç­‰å¾…é¡µé¢åŠ è½½çš„æœ€é•¿æ—¶é—´ã€‚ å°½æ—©å»ºç«‹ç¬¬ä¸‰æ–¹è¿æ¥å¯¹ç¬¬ä¸‰æ–¹åŸŸçš„æœåŠ¡å™¨è¯·æ±‚ä¹Ÿä¼šå½±å“ LCPï¼Œå°¤å…¶æ˜¯å½“æµè§ˆå™¨éœ€è¦è¿™äº›è¯·æ±‚æ¥åœ¨é¡µé¢ä¸Šæ˜¾ç¤ºå…³é”®å†…å®¹çš„æƒ…å†µä¸‹ã€‚ä½¿ç”¨rel=&quot;preconnect&quot;æ¥å‘ŠçŸ¥æµè§ˆå™¨æ‚¨çš„é¡µé¢æ‰“ç®—å°½å¿«å»ºç«‹è¿æ¥ã€‚ &lt;link rel=\"preconnect\" href=\"https://example.com\" /> æ‚¨è¿˜å¯ä»¥ä½¿ç”¨dns-prefetchæ¥æ›´å¿«åœ°å®Œæˆ DNS æŸ¥æ‰¾ã€‚ &lt;link rel=\"dns-prefetch\" href=\"https://example.com\" /> å°½ç®¡ä¸¤ç§æç¤ºçš„åŸç†ä¸åŒï¼Œä½†å¯¹äºä¸æ”¯æŒpreconnectçš„æµè§ˆå™¨ï¼Œå¯ä»¥è€ƒè™‘å°†dns-prefetchåšä¸ºåå¤‡ã€‚ &lt;head> â€¦ &lt;link rel=\"preconnect\" href=\"https://example.com\" /> &lt;link rel=\"dns-prefetch\" href=\"https://example.com\" /> &lt;/head> é¢„åŠ è½½é‡è¦èµ„æº #æœ‰æ—¶ï¼Œåœ¨æŸä¸ª CSS æˆ– JavaScript æ–‡ä»¶ä¸­å£°æ˜æˆ–ä½¿ç”¨çš„é‡è¦èµ„æºå¯èƒ½ä¼šæ¯”æ‚¨æ‰€æœŸæœ›çš„è¦æ™šä¸€ç‚¹è¢«è·å–ï¼Œä¾‹å¦‚æ·±è—åœ¨åº”ç”¨ç¨‹åºä¼—å¤š CSS æ–‡ä»¶ä¸­çš„æŸä¸ªå­—ä½“ã€‚ å¦‚æœæ‚¨çŸ¥é“æŸä¸ªç‰¹å®šèµ„æºåº”è¯¥è¢«ä¼˜å…ˆè·å–ï¼Œè¯·ä½¿ç”¨&lt;link rel=&quot;preload&quot;&gt;æ¥æ›´åŠ åŠæ—¶åœ°è·å–è¯¥èµ„æºã€‚ å¤šç§ç±»å‹çš„èµ„æºéƒ½å¯ä»¥è¿›è¡Œé¢„åŠ è½½ï¼Œä½†æ‚¨åº”è¯¥é¦–å…ˆä¾§é‡äºé¢„åŠ è½½å…³é”®èµ„äº§ï¼Œä¾‹å¦‚å­—ä½“ã€é¦–å±å›¾åƒæˆ–è§†é¢‘ï¼Œä»¥åŠå…³é”®è·¯å¾„ CSS æˆ– JavaScriptã€‚ &lt;link rel=\"preload\" as=\"script\" href=\"script.js\" /> &lt;link rel=\"preload\" as=\"style\" href=\"style.css\" /> &lt;link rel=\"preload\" as=\"image\" href=\"img.png\" /> &lt;link rel=\"preload\" as=\"video\" href=\"vid.webm\" type=\"video/webm\" /> &lt;link rel=\"preload\" href=\"font.woff2\" as=\"font\" type=\"font/woff2\" crossorigin /> 4.åŠ å¿«é¦–æ¬¡æ¸²æŸ“æ–¹æ¡ˆé¦–å±æ¸²æŸ“æ—¶renderæ ‘çš„åˆæˆæ—¶é•¿ä¹‹ä¸€ï¼ŒDOMæ ‘ä¸DOMèŠ‚ç‚¹æ•°é‡æ¯æ¯ç›¸å…³ï¼Œè€Œå¦‚æœä½¿ç”¨ TextAreaå­˜æ”¾HTMLä»£ç ï¼Œè€Œæµè§ˆå™¨è§£æçš„æ—¶å€™ä¸ä¼šè¯†åˆ«ï¼Œä¸è¢«å½“åšDOMå»è§£æï¼Œä¼šè®©é¦–å±æ¸²æŸ“DOMæ ‘åŒ…å«çš„èŠ‚ç‚¹å¤§å¹…å‡å°‘ï¼Œä»è€Œæé«˜é¦–æ¬¡æ¸²æŸ“é€Ÿåº¦ åœ¨æœåŠ¡ç«¯ï¼šå°†ä¸€äº›ç‰¹æ®Šå­—ç¬¦ï¼ˆ&amp;ä¹‹ç±»çš„ï¼‰è¿›è¡ŒHTMLEncodeè½¬ä¹‰ï¼Œåœ¨æµè§ˆå™¨ç«¯ï¼Œåˆ™éœ€è¦åœ¨é¦–å±åŒºåŸŸå¤„äºå¯è§çŠ¶æ€æ—¶ï¼Œå°†TextAreaçš„HTMLä»£ç å–å‡ºï¼Œå°†å…¶æ¢å¤åˆ°DOMæ ‘è¿›è¡Œæ¸²æŸ“ï¼Œè¿™ä¸€è¡Œä¸ºåœ¨ ã€Šå¤§å‹ç½‘ç«™æ€§èƒ½ä¼˜åŒ–å®æˆ˜ã€‹ä¸­è¢«ç§°ä¸ºå»¶è¿Ÿæ¸²æŸ“ å¤§è§„æ¨¡å†…è”å…³é”® CSSä½ éœ€è¦ä¸€ä¸ªè‡ªåŠ¨åŒ–ç³»ç»Ÿï¼Œè€Œä¸æ˜¯å¯¹æ¯ä¸ªé¡µé¢éƒ½è¿™æ ·åšã€‚ä»…å†…è” WordPress ä¸»é¢˜ä¸»é¡µçš„ CSS æ˜¯æœ‰æ„ä¹‰çš„ï¼Œå› ä¸ºå®ƒé€šå¸¸ä¸å…¶ä»–é¡µé¢æ˜¯ä¸åŒçš„æ ·å¼è¡¨ã€‚é€šå¸¸ä¼šæœ‰ä¸€äº›æ’ä»¶/æ¨¡å—/åŒ…ã€ä¸€ä¸ªå…³é”®ç‰ˆæœ¬æˆ–å…³é”® CSSã€‚è¿™äº›åŒ…(packages)å¯èƒ½é€‚ç”¨äºä½ ä½¿ç”¨çš„ä»»ä½• taskrunner æˆ–æ˜¯å¦‚ Gruntã€Gulpã€Webpack æˆ–æ¡†æ¶å¦‚ Reactã€Angularã€Vueï¼Œä½ è¿˜å¯ä»¥æ‰¾åˆ°ç‰¹å®šå…³äº WordPress æˆ– Drupal çš„æ•™ç¨‹ï¼Œç”šè‡³æ˜¯æ‰‹å·¥ç¼–ç çš„é¡µé¢ã€‚ä»–ä»¬å°†å‘é¡µé¢å‘é€ä¸€ä¸ªæ— å¤´(headless)æµè§ˆå™¨ï¼Œä»¥ç¡®å®šå“ªäº› CSS å¯¹äºä¸åŒå¤§å°çš„é¡µé¢åŠ è½½ä¸Šæ˜¯å…³é”®ï¼Œå¹¶ä¸ºä½ æä¾›ä»£ç æˆ–å°†ä»£ç æ‹†åˆ†ä¸ºå…³é”®å’Œéå…³é”®å…ƒç´ ï¼Œä»¥ä¾¿å¯ä»¥é€‚å½“åœ°åŠ è½½å®ƒä»¬ï¼Œä¸¾å‡ ä¸ªä¾‹å­ï¼š Grunt: https://github.com/filamentgroup/grunt-criticalcss https://www.npmjs.com/package/grunt-critical-css https://github.com/bezoerb/grunt-critical Gulp: https://github.com/addyosmani/critical https://www.npmjs.com/package/gulp-critical-css Webpack: https://github.com/anthonygore/html-critical-webpack-plugin https://github.com/GoogleChromeLabs/critters https://github.com/anthonygore/html-critical-webpack-plugin https://www.npmjs.com/package/critical-css-webpack-plugin React: https://www.npmjs.com/package/react-critical-css https://github.com/addyosmani/critical-path-css-tools https://github.com/sergei-zelinsky/react-critical-css Angular: https://github.com/addyosmani/critical-path-angular-demo Vue: https://github.com/anthonygore/vue-cli-plugin-critical https://vuejsdevelopers.com/2017/07/24/critical-css-webpack/ Drupal: https://www.fourkitchens.com/blog/article/use-gulp-automate-your-critical-path-css/ WordPress: https://joe-watkins.io/javascript/inline-critical-css-with-wordpress/ https://wordpress.org/plugins/wp-criticalcss/ Hand-coded: https://www.sitelocity.com/critical-path-css-generator https://jonassebastianohlsson.com/criticalpathcssgenerator/ é¢„åŠ è½½ Preloadå¦‚æœä¸æ‰“ç®—å†…è”å…³é”® CSSï¼Œé‚£ä¹ˆä¸‹ä¸€ä¸ªæœ€ä½³é€‰æ‹©å¯ä»¥æ˜¯ä½¿ç”¨é¢„åŠ è½½ Preloadã€‚é¢„åŠ è½½åœ¨åŠ è½½æ—©æœŸææ—©è·å–è¯·æ±‚ï¼Œæ¯”å¹³æ—¶æ›´å¿«åœ°è·å–æ˜¾ç¤ºé¡µé¢æ‰€éœ€çš„åŸºæœ¬èµ„æºã€‚Preload å°†é¢„åŠ è½½èµ„æºåœ¨æµè§ˆå™¨ä¼˜å…ˆçº§è®¾ç½®ä¸ºé«˜å¹¶å¼‚æ­¥åŠ è½½å®ƒä»¬ï¼Œå› æ­¤å®ƒä»¬ä¸ä¼šé˜»å¡æ¸²æŸ“ï¼Œä¹Ÿé€‚ç”¨äºè·¨åŸŸ â€œæ–°å¢å†…å®¹ï¼šChrome ä¸­å¯¹äº&lt;link rel=&quot;preload&quot;&gt;ã€é¢„å–(prefetch)åŠä¼˜å…ˆçº§ä¸“ä¸šæç¤ºï¼šhttps://medium.com/reloading/preload-prefetch-and-priorities-in-chrome-776165961bbfâ€ 5.æµ‹è¯•æ€§èƒ½å·¥å…·YSlowæ€§èƒ½æ£€æµ‹æ’ä»¶ï¼Œä»¥firefoxæ’ä»¶çš„å½¢å¼ PageSpeedå’ŒYSlowç±»ä¼¼çš„ï¼ŒGoogleçš„ä¼˜åŒ–å·¥å…·PageSpeedé™¤äº†æœ‰ç½‘ç«™çš„å…¥å£ï¼Œä¹Ÿèƒ½ä»¥æ’ä»¶çš„å½¢å¼åœ¨Firefoxå’ŒGoogleä¸Šè¿è¡Œï¼Œä¹Ÿæ˜¯åŸºäºåŸºç¡€æ€§èƒ½ä¼˜åŒ–å®è·µè§„åˆ™åˆ†æä»£ç ï¼Œæä¾›ä¸€ç³»åˆ—é¡µé¢ä¼˜åŒ–å»ºè®® WebPageteståŒæ ·ä¹Ÿä½¿ç”¨å’Œå®ƒä»¬ç›¸ä¼¼çš„ä¸€ç»„æœ€ä½³æ€§èƒ½å®è·µæ¥åˆ†æç½‘é¡µï¼Œå®ƒé€šè¿‡æµè§ˆå™¨è®¿é—®ï¼ŒåŸºäºè¾“å…¥çš„Website URLï¼Œä»¥åŠé€‰æ‹©çš„å›½å®¶åŸå¸‚ã€æµè§ˆå™¨ç±»å‹ã€ç½‘ç»œå¸¦å®½ç­‰ä¿¡æ¯ï¼Œå¯åŠ¨å¯¹åº”çš„è¿œç¨‹æœåŠ¡å™¨ä¸Šçš„æµè§ˆå™¨è¿›è¡Œæ€§èƒ½åˆ†ææµ‹è¯•ã€‚ï¼ˆæ®å®˜ç½‘ä»‹ç»ï¼Œä»–ä»¬æä¾›çš„ä¸åŒåŸå¸‚çš„æ€§èƒ½åˆ†ææµ‹è¯•ï¼Œæ˜¯é€šè¿‡çœŸå®çš„éƒ¨ç½²åœ¨å¯¹åº”åŸå¸‚çš„ç‰©ç†æœåŠ¡å™¨æ¥å®ç°çš„ï¼Œè€Œä¸æ˜¯é€šè¿‡å…¶ä»–ç±»ä¼¼ä»£ç†æˆ–è€…è™šæ‹Ÿæœºç­‰æ–¹å¼æ¨¡æ‹Ÿå®ç°çš„ï¼‰ window.performanceå¯ä»¥ç›´æ¥åœ¨æ§åˆ¶å°æ‰“å° window.performanceï¼ŒæŸ¥çœ‹è¯¸å¤šçš„æ€§èƒ½æŒ‡æ ‡ EventCountï¼šä»ç½‘é¡µæ‰“å¼€åˆ°ç°åœ¨ï¼Œæ‰§è¡Œçš„äº‹ä»¶æ•°é‡ memoryï¼šå †å†…å­˜å ç”¨å¤§å° timingï¼šæ‰§è¡Œå„é˜¶æ®µæ‰€å¤„çš„æ—¶é—´æˆ³ DNSæŸ¥è¯¢è€—æ—¶= domainLookupEnd - domainLookupStart TCPé“¾æ¥è€—æ—¶= connectEnd - connectStart requestè¯·æ±‚è€—æ—¶= responseEnd - responseStart è§£ædomæ ‘è€—æ—¶= domComplete - domInteractive ç™½å±æ—¶é—´= domloadng - fetchStart domreadyæ—¶é—´= domContentLoadedEventEnd - fetchStart onloadæ—¶é—´= loadEventEnd - fetchStart chrome-devtoolæŸ¥çœ‹LCPï¼š åœ¨ Chrome å¼€å‘è€…å·¥å…·ä¸­ï¼Œæ‰§è¡Œä»¥ä¸‹æ­¥éª¤ï¼š Performance &gt; å‹¾é€‰ â€œScreenshotsâ€ ç‚¹å‡» å·¦ä¸Šæ–¹ä¸€ä¸ªâ€œé»‘è‰²åœ†ç‚¹â€ LCP ä¼šæ˜¾ç¤ºåœ¨æ—¶åºå›¾ä¸Š ç‚¹å‡»èŠ‚ç‚¹ï¼› è¿™æ˜¯å°±æ˜¯ LCP çš„å…ƒç´  æŸ¥çœ‹åŠ¨ç”»å¸§æ•°ï¼Œæ¯å½“ä½ çœ‹åˆ° FPS ä¸Šæ–¹çš„çº¢è‰²æ¡ï¼Œè¿™æ„å‘³ç€å¸§ç‡ä¸‹é™å¦‚æ­¤ä¹‹ä½ï¼Œå®ƒå¯èƒ½ä¼šæŸå®³ç”¨æˆ·ä½“éªŒã€‚ä¸€èˆ¬æ¥è¯´ï¼Œç»¿æ¡è¶Šé«˜ï¼ŒFPS è¶Šé«˜ã€‚ æŸ¥çœ‹å¸§æ•° é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜æä¾›å½“å‰å¸§æ•°FPSçš„æŸ¥çœ‹ ï¼ˆç‚¹å‡»å³ä¸Šè§’å·¥å…·æ ï¼Œæ‰¾åˆ°More toolsä¸­çš„renderingï¼Œå‹¾é€‰ä¸ŠFPS meterï¼‰ 6.æ€§èƒ½æŒ‡æ ‡Core Web Vitals ï¼ˆæ ¸å¿ƒé¡µé¢æŒ‡æ ‡ï¼‰æ˜¯ä¸€ç§é€Ÿåº¦æŒ‡æ ‡ï¼Œæ˜¯ Google ç”¨äºè¡¡é‡ç”¨æˆ·ä½“éªŒçš„é¡µé¢ä½“éªŒä¿¡å·çš„ä¸€éƒ¨åˆ† ä»¥ä¸‹æ˜¯ Core Web Vitals çš„ä¸‰ä¸ªç»„æˆéƒ¨åˆ†åŠå…¶è¡¡é‡çš„å†…å®¹ï¼š æœ€å¤§å†…å®¹ç»˜åˆ¶ (LCP) â€“ è§†è§‰è´Ÿè½½ ç´¯ç§¯å¸ƒå±€åç§» (CLS) â€“ è§†è§‰ç¨³å®šæ€§ é¦–æ¬¡è¾“å…¥å»¶è¿Ÿ (FID) â€“ äº¤äº’æ€§ æ€§èƒ½æŒ‡æ ‡ä¹‹LCP and FCPLCPæœ€å¤§å†…å®¹ç»˜åˆ¶ (LCP)ï¼šhttps://web.dev/lcp/#what-elements-are-considered æŸ¥çœ‹æ–¹æ³•å¯ä»¥ä½¿ç”¨chromeçš„performance ä¼˜åŒ–LCP è¶Šå°è¶Šå¿«ï¼Œæˆ‘ä»¬å¯ä»¥é€‰æ‹©åˆ é™¤ä¸å¿…è¦çš„ä»£ç ï¼ˆå¯¹äºæˆ‘ä»¬è‡ªå·±é¡¹ç›®åæœŸç»´æŠ¤ä¹Ÿæ¯”è¾ƒå‹å¥½ï¼Œæˆ–è€…äº¤ç»™æ‰“åŒ…å·¥å…·tree shakingä¸‹ï¼‰ï¼Œæ‰“åŒ…å·¥å…·çš„å‹ç¼©ï¼Œæˆ‘ä»¬å¯¹imgçš„å‹ç¼© CDNåˆ†å‘å’Œç¼“å­˜çš„ä½¿ç”¨ èµ„æºåŠ è½½çš„ä¼˜å…ˆé¡ºåºè€ƒè™‘ï¼šå›¾ç‰‡æ‡’åŠ è½½ã€cssé¢„åŠ è½½ï¼ŒSSRç­‰ FCPé¦–æ¬¡å†…å®¹ç»˜åˆ¶ (FCP)ï¼šhttps://web.dev/fcp/ æˆ‘ä»¬å¯ä»¥çœ‹åˆ°FCPå®é™…ä¸Šå°±æ˜¯ç©ºç™½ -&gt; éª¨æ¶å± -&gt; ç¬¬ä¸€å¼ å›¾/éç©ºç™½çš„canvas/svg/æ–‡å­—çš„å‡ºç°çš„æ—¶é—´ç‚¹ï¼Œè¿™æ—¶å€™è€ƒéªŒçš„å°±ä¸æ˜¯æ€§èƒ½å°±ä¸èƒ½æ€ªå›¾ç‰‡äº†ï¼Œä¸»è¦è€ƒéªŒçš„æ˜¯js/cssåŠ è½½é€Ÿåº¦ä¸ºäº†æä¾›è‰¯å¥½çš„ç”¨æˆ·ä½“éªŒï¼Œç½‘ç«™åº”è¯¥åŠªåŠ›å°†é¦–æ¬¡å†…å®¹ç»˜åˆ¶æ§åˆ¶åœ¨1.8 ç§’æˆ–ä»¥å†…ï¼Œè€Œæˆ‘ä»¬wapmå®éªŒç«¯å¾—åˆ°ç»¿è‰²ï¼Œä¹Ÿå°±æ˜¯â€œä»¤äººæ»¡æ„çš„FCPâ€åº”è¯¥æ§åˆ¶åœ¨&lt; 1000ï¼ˆ1s)èŒƒå›´å†… CLSCLS æµ‹é‡å…ƒç´ å¦‚ä½•ç§»åŠ¨æˆ–é¡µé¢å¸ƒå±€çš„ç¨³å®šæ€§ã€‚ å®ƒè€ƒè™‘äº†å†…å®¹çš„å¤§å°å’Œç§»åŠ¨çš„è·ç¦» FIDFirst Input Delay å¯ä»¥ç†è§£ä¸ºç”¨æˆ·ç¬¬ä¸€æ¬¡ä¸ç½‘é¡µäº¤äº’ï¼Œï¼ˆä¾‹å¦‚é»æ“Šé€£çµã€æŒ‰éˆ•ç­‰ç­‰ï¼‰ï¼Œç€è¦½å™¨å¯¦éš›ä¸Šèƒ½å¤ å›æ‡‰æ­¤æ¬¡äº’å‹•çš„æ™‚é–“é» é€šå¸¸ï¼Œè¾“å…¥å»¶è¿Ÿï¼ˆæˆ–è¾“å…¥å»¶è¿Ÿï¼‰å‘ç”Ÿæ˜¯å› ä¸ºæµè§ˆå™¨çš„ä¸»çº¿ç¨‹å¿™äºæ‰§è¡Œå…¶ä»–æ“ä½œï¼Œå› æ­¤å®ƒæ— æ³•ï¼ˆå°šæœªï¼‰å“åº”ç”¨æˆ·ã€‚ å¯èƒ½å‘ç”Ÿè¿™ç§æƒ…å†µçš„ä¸€ä¸ªå¸¸è§åŸå› æ˜¯æµè§ˆå™¨æ­£å¿™äºè§£æå¹¶æ‰§è¡Œåº”ç”¨ç¨‹åºåŠ è½½çš„å¤§å‹JavaScriptæ–‡ä»¶ / CSSæ–‡ä»¶ã€‚ è™½ç„¶å®ƒæ­£åœ¨è¿™æ ·åšï¼Œå®ƒä¸èƒ½è¿è¡Œä»»ä½•äº‹ä»¶ç›‘å¬å™¨ï¼Œå› ä¸ºå®ƒåŠ è½½çš„JavaScriptå¯èƒ½ä¼šå‘Šè¯‰å®ƒåšå…¶ä»–äº‹æƒ…ã€‚ è¾ƒé•¿çš„é¦–æ¬¡è¾“å…¥å»¶è¿Ÿé€šå¸¸å‘ç”Ÿåœ¨é¦–æ¬¡å†…å®¹ç»˜åˆ¶ (FCP)å’ŒTime to Interactive å¯äº¤äº’æ—¶é—´ (TTI)ä¹‹é—´ï¼Œå› ä¸ºåœ¨æ­¤æœŸé—´ï¼Œé¡µé¢å·²ç»æ¸²æŸ“å‡ºéƒ¨åˆ†å†…å®¹ï¼Œä½†äº¤äº’æ€§è¿˜å°šä¸å¯é ã€‚ä¸ºäº†è¯´æ˜è¿™ç§æƒ…å†µçš„å‘ç”Ÿç¼˜ç”±ï¼Œæˆ‘ä»¬åœ¨æ—¶é—´è½´ä¸­åŠ å…¥äº† FCP å’Œ TTI æ‚¨å¯èƒ½å·²ç»æ³¨æ„åˆ° FCP å’Œ TTI ä¹‹é—´æœ‰ç›¸å½“é•¿çš„ä¸€æ®µæ—¶é—´ï¼ˆåŒ…æ‹¬ä¸‰æ®µé•¿ä»»åŠ¡ï¼‰ï¼Œå¦‚æœç”¨æˆ·åœ¨è¿™æ®µæ—¶é—´å†…å°è¯•ä¸é¡µé¢è¿›è¡Œäº¤äº’ï¼ˆä¾‹å¦‚å•å‡»ä¸€ä¸ªé“¾æ¥ï¼‰ï¼Œé‚£ä¹ˆä»æµè§ˆå™¨æ¥æ”¶åˆ°å•å‡»ç›´è‡³ä¸»çº¿ç¨‹èƒ½å¤Ÿå“åº”ä¹‹å‰å°±ä¼šæœ‰ä¸€æ®µå»¶è¿Ÿã€‚ å› ä¸ºæµè§ˆå™¨æ­£åœ¨è¿è¡Œä»»åŠ¡çš„è¿‡ç¨‹ä¸­ï¼Œæ‰€ä»¥æµè§ˆå™¨å¿…é¡»ç­‰åˆ°ä»»åŠ¡å®Œæˆåæ‰èƒ½å¯¹è¾“å…¥ä½œå‡ºå“åº”ã€‚æµè§ˆå™¨å¿…é¡»ç­‰å¾…çš„è¿™æ®µæ—¶é—´å°±æ˜¯è¿™ä½ç”¨æˆ·åœ¨è¯¥é¡µé¢ä¸Šä½“éªŒåˆ°çš„ FID å€¼ FIDé‡è¦æ€§ï¼šé¦–æ¬¡è¾“å…¥å»¶è¿Ÿå°†ä¼šæ˜¯ç”¨æˆ·å¯¹æ‚¨ç½‘ç«™å“åº”åº¦çš„ç¬¬ä¸€å°è±¡ï¼Œè€Œç¬¬ä¸€å°è±¡å¯¹äºå¡‘é€ æˆ‘ä»¬å¯¹ç½‘ç«™è´¨é‡å’Œå¯é æ€§çš„æ•´ä½“å°è±¡è‡³å…³é‡è¦ã€‚ é™¤äº†æœ€å¤§çš„å†…å®¹ç»˜åˆ¶(LCP) å’Œç´¯ç§¯å¸ƒå±€åç§»(CLS)ï¼Œé¦–æ¬¡è¾“å…¥å»¶è¿Ÿæ˜¯è°·æ­Œåœ¨ 2021 å¹´å¤å­£æ¨å‡ºçš„é¡µé¢ä½“éªŒæ›´æ–°ä¸­å¼ºè°ƒçš„ä¸‰ä¸ªæ ¸å¿ƒ Web è¦ç´ ä¹‹ä¸€ã€‚ ç”±äº FID æ˜¯ä»…é€šè¿‡çœŸå®ç”¨æˆ·äº¤äº’æµ‹é‡çš„ç»Ÿè®¡æ•°æ®ï¼Œå› æ­¤æ— æ³•åœ¨å®éªŒå®¤ç¯å¢ƒä¸­å¤åˆ¶ã€‚ ç„¶è€Œï¼Œæ€»é˜»å¡æ—¶é—´ (TBT) æ˜¯ä¸€ä¸ªè¡¡é‡æµè§ˆå™¨è¢«é˜»å¡æ—¶é—´çš„æŒ‡æ ‡ï¼Œå› æ­¤å¯ä»¥è¿‘ä¼¼åœ°ä¼°è®¡ FIDã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆæ‚¨ä¼šåœ¨ Semrush çš„ Core Web Vitals æŠ¥å‘Šä¸­çœ‹åˆ° TBT è€Œä¸æ˜¯ FID çš„åŸå› ã€‚ æ”¹å–„FID æ¸›å°‘JavaScriptç­‰ç¶²é ç¨‹å¼ç¢¼çš„é‹ä½œæ™‚é–“ ç·¨æ’è‰¯å¥½çš„ä¸»ç·šç¨‹ï¼Œèƒ½æœ‰æ•ˆæ±ºå®šå“ªäº›å…ƒç´ ç‡å…ˆè¼‰å…¥ï¼Œè€Œé¿å…éå¤§è€Œæ…¢çš„ä»£ç¢¼é˜»ç¤™å…¶ä»–å…ƒç´ è¼‰å…¥ã€‚ JavaScriptä»»åŠ¡ä¼šæ¶ˆè€—å¤§é‡çš„èµ„æºï¼Œä¼šå½±å“ä½ çš„ç½‘ç«™é€Ÿåº¦æ€§èƒ½ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œè¯·åˆ é™¤å®ƒä»¬æˆ–å°†é•¿çš„ä»»åŠ¡åˆ†æˆå°çš„ã€å¼‚æ­¥çš„ä»»åŠ¡ã€‚è‡³å°‘ï¼Œä¸€ä¸ªä»»åŠ¡åº”è¯¥åœ¨50æ¯«ç§’ä»¥ä¸‹ã€‚ï¼ˆé•¿ä»»åŠ¡æ˜¯ä¸»çº¿ç¨‹è¢«é˜»å¡è¶…è¿‡ 50 æ¯«ç§’çš„ä»»ä½•ä»»åŠ¡ã€‚ ï¼‰ ä½ å¯ä»¥ä½¿ç”¨setTimeoutå‡½æ•°å°†é•¿ä»»åŠ¡åˆ†æˆå°ä»»åŠ¡ï¼Œå› ä¸ºè¿™å°†ä½¿ä¸»çº¿ç¨‹å¯¹ç”¨æˆ·è¾“å…¥çš„å“åº”æ²¡æœ‰å»¶è¿Ÿã€‚ æª¢æŸ¥ä¸€ä¸‹æœ‰æ²’æœ‰å·²ç¶“å¤±æ•ˆæˆ–ä¸å†ç”¨çš„ç·¨ç¢¼ä¸¦åˆªé™¤ æ¸›ä½ç¶²é çš„è«‹æ±‚æ•¸å’Œæª”æ¡ˆå¤§å° é©åº¦å£“ç¸®åœ–åƒ æ¸›å°‘ä¸»åŸ·è¡Œç·’çš„å·¥ä½œ æ¸›ä½ç¬¬ä¸‰æ–¹ç¨‹å¼ç¢¼çš„å½±éŸ¿ æ£€æŸ¥é•¿ä»»åŠ¡ ä¸Šå›¾æ˜¯ä¸»çº¿ç¨‹çš„æ ·å­ï¼ŒChrome å¼€å‘å·¥å…·ä¸­ Performance é¡µç­¾ä¸­çš„é‚£äº›çº¢è‰²åˆ»åº¦çº¿è¡¨ç¤ºå¯èƒ½å­˜åœ¨é—®é¢˜çš„åœ°æ–¹ã€‚ é€šå¸¸åœ¨ä¸»çº¿ç¨‹ä¸Šè¿è¡Œå¤ªå¤šæ—¶é—´çš„ä»»åŠ¡å°±ä¼šè¢«æ ‡è®°ï¼Œæ¯ä¸€ä¸ªåœ°æ–¹éƒ½æ˜¯è¶…å‡ºé¡µé¢è´Ÿè·çš„å·¥ä½œå¹¶ä¸”æ— æ³•åŠæ—¶å“åº”ç”¨æˆ·è¾“å…¥ã€‚ æ¥æºï¼šhttps://web.dev/long-tasks-devtools å½“ä»»åŠ¡æ­£åœ¨è¿è¡Œæ—¶ï¼Œé¡µé¢æ— æ³•å“åº”ç”¨æˆ·è¾“å…¥ï¼Œè¿™æ˜¯æ„Ÿå—ä¸Šçš„å»¶è¿Ÿã€‚ä»»åŠ¡è¶Šé•¿ï¼Œç”¨æˆ·ç»å†çš„å»¶è¿Ÿå°±è¶Šé•¿ã€‚ä»»åŠ¡ä¸ä»»åŠ¡ä¹‹é—´çš„ä¸­æ–­æ˜¯ä¸ªæœºä¼šï¼Œé¡µé¢å¿…é¡»åˆ‡æ¢åˆ°ç”¨æˆ·è¾“å…¥çš„ä»»åŠ¡å¹¶å“åº”ä»–ä»¬æƒ³è¦çš„å†…å®¹ã€‚ æˆ‘ä»¬è¿˜å¯ä»¥é€šè¿‡chromeçš„Lighthouse å¯åŠ¨æ€§èƒ½å®¡è®¡ï¼ˆä½†æ˜¯å»ºè®®åœ¨æ¯æ¬¡æäº¤ä»£ç çš„æ—¶å€™å®¡è®¡ä¸€æ¬¡ä¸ç„¶ç­‰åˆ°åŒ…å¤ªå¤§äº†ï¼Œå·¥ç¨‹é¡¹ç›®å¤æ‚åŒ–ï¼Œå¾ˆéš¾çœ‹å‡ºä»£ç å“ªé‡Œæ€§èƒ½å¼€å§‹å˜å·®ï¼‰ ç”ŸæˆæŠ¥å‘Šåï¼Œæ‚¨å¯ä»¥å‘ä¸‹æ»šåŠ¨ä»¥æ·±å…¥äº†è§£ Lighthouse çš„å»ºè®®ï¼Œè¿™äº›å»ºè®®å°†æ ‡è®°ä¸ºæœºä¼šå’Œè¯Šæ–­ã€‚ é€šè¿‡è¯Šæ–­å‡ºæ¥çš„ â€˜â€™Avoid long main-thread tasks â€œ æ‰¾åˆ°é•¿ä»»åŠ¡çš„å‘ç”Ÿç‚¹ 7.çº¢å®ä¹¦æœ€ä½³å®è·µé¿å…å…¨å±€æŸ¥æ‰¾ function updateUI() { let imgs = document.getElementsBtTagName(\"img\"); for(let i = 0; i &lt; imgs.length; i++) { imgs[i].title = `${document.title} imge ${i}`; } let msg = document.getElementById(\"msg\"); msg.innerHTML = \"Update complete\"; } è¿™ä¸ªåœ°æ–¹ä¸‰æ¬¡å¼•ç”¨äº†å…¨å±€documentå¯¹è±¡ï¼Œè€Œforç”šè‡³è¦å¼•ç”¨æˆç™¾ä¸Šåƒæ¬¡ï¼Œæ¯æ¬¡éƒ½è¦éå†ä½œç”¨åŸŸé“¾ï¼Œæˆ‘ä»¬åº”è¯¥ä¿å­˜å¯¹documentå¯¹è±¡çš„å¼•ç”¨ï¼Œæ˜æ˜¾æå‡è¯¥å‡½æ•°çš„æ€§èƒ½ function updateUI() { const doc = document; let imgs = doc.getElementsBtTagName(\"img\"); for(let i = 0; i &lt; imgs.length; i++) { imgs[i].title = `${doc.title} imge ${i}`; } let msg = doc.getElementById(\"msg\"); msg.innerHTML = \"Update complete\"; } ä¸ä½¿ç”¨withï¼Œä»–ä¸»è¦ç”¨é€”æ˜¯å‡å°‘ä»£ç é‡ function updateBody() { with(document.body) { console.log(tagName); } } ä¸ä½¿ç”¨eval æœ€æ‚²è§‚çš„æƒ…å†µæ˜¯ï¼Œå¦‚æœå‡ºç°äº†evalå’Œwithï¼Œæ‰€æœ‰çš„ä¼˜åŒ–å¯èƒ½æ˜¯æ— æ„ä¹‰çš„ï¼Œå› æ­¤å¦‚æœä½¿ç”¨å®ƒä»¬æœ€ç®€å•çš„åšæ³•å°±æ˜¯å®Œå…¨ä¸åšä¼˜åŒ– å‡å°‘å±æ€§æŸ¥æ‰¾çš„è¿­ä»£æ¬¡æ•°ï¼Œå±æ€§æŸ¥æ‰¾ä¼šå¢åŠ è®¿é—®å¯¹è±¡å±æ€§çš„ç®—æ³•å¤æ‚åº¦ ä¸‹é¢æ˜¯é”™è¯¯ç¤ºèŒƒ let query = window.location.href.substring(window.location.href.indexOf(\"?\")) ä¸‹é¢æ˜¯æ­£ç¡®ç¤ºèŒƒ const url = window.location.href; const query = url.substring(url.indexOf(\"?\")); æ¯”ä¹‹å‰çœäº†33% æ€§èƒ½æå‡å…¶ä»–æ³¨æ„äº‹é¡¹ åŸç”Ÿæ–¹æ³•å¾ˆå¿«ï¼Œåº”è¯¥å°½å¯èƒ½ä½¿ç”¨åŸç”Ÿæ–¹æ³•ï¼Œè€Œä¸æ˜¯ä½¿ç”¨JavaScriptå†™çš„æ–¹æ³•ã€‚åŸç”Ÿæ–¹æ³•æ˜¯ä½¿ç”¨Cæˆ–è€…C++ç­‰ç¼–è¯‘å‹è¯­è¨€å†™çš„ã€‚å› æ­¤æ¯”JavaScriptå†™çš„æ–¹æ³•è¦å¿«å¾—å¤šã€‚JavaScriptç»å¸¸è¢«å¿½è§†çš„æ˜¯Mathå¯¹è±¡ä¸Šé‚£äº›æ‰§è¡Œå¤æ‚æ•°å­¦è¿ç®—çš„æ–¹æ³•ã€‚è¿™äº›æ–¹æ³•æ€»æ˜¯æ¯”æ‰§è¡Œç›¸åŒä»»åŠ¡çš„JavaScriptå‡½æ•°å¿«å¾—å¤šï¼Œæ¯”å¦‚æ­£å¼¦ã€ä½™å¼¦ç­‰ switchè¯­å¥å¾ˆå¿« ä½æ“ä½œå¾ˆå¿« å‚è€ƒä¹¦ç± ã€Šå¤§å‹ç½‘ç«™æ€§èƒ½ä¼˜åŒ–å®æˆ˜ã€‹â€”å‘¨æ¶›æ˜ã€å¼ è£åã€å¼ æ–°å…µ ã€ŠJavaScripté«˜çº§ç¨‹åºè®¾è®¡ã€‹ ã€Šä½ ä¸çŸ¥é“çš„çš„JavaScriptï¼ˆä¸Šå·ï¼‰ã€‹ æé«˜ä½ çš„ç½‘ç«™é€Ÿåº¦","categories":[{"name":"å‰ç«¯","slug":"å‰ç«¯","permalink":"https://taylor12138.github.io/categories/%E5%89%8D%E7%AB%AF/"}],"tags":[],"author":"Hello"},{"title":"Serverless","slug":"Serverless","date":"2021-10-23T16:00:00.000Z","updated":"2023-03-26T05:38:52.164Z","comments":true,"path":"2021/10/24/serverless/","link":"","permalink":"https://taylor12138.github.io/2021/10/24/serverless/","excerpt":"","text":"ServerlessServerlessï¼ˆæ— æœåŠ¡è®¡ç®—ï¼‰æ˜¯æŒ‡æ„å»ºå’Œè¿è¡Œä¸éœ€è¦æœåŠ¡å™¨ç®¡ç†çš„åº”ç”¨ç¨‹åºå’Œæ¦‚å¿µ æ— æœåŠ¡å™¨è®¡ç®—æ˜¯ä¸€ç§æŒ‰éœ€æä¾›åç«¯æœåŠ¡çš„æ–¹æ³•ã€‚æ— æœåŠ¡å™¨æä¾›ç¨‹åºå…è®¸ç”¨æˆ·ç¼–å†™å’Œéƒ¨ç½²ä»£ç ï¼Œè€Œä¸å¿…æ‹…å¿ƒåº•å±‚åŸºç¡€ç»“æ„ã€‚ä»æ— æœåŠ¡å™¨ä¾›åº”å•†å¤„è·å¾—åç«¯æœåŠ¡çš„å…¬å¸å°†æ ¹æ®å…¶è®¡ç®—è´¹ç”¨ï¼Œè€Œä¸å¿…ä¿ç•™å’Œæ”¯ä»˜å›ºå®šæ•°é‡çš„å¸¦å®½æˆ–æœåŠ¡å™¨æ•°é‡ï¼Œå› ä¸ºè¯¥æœåŠ¡æ˜¯è‡ªåŠ¨æ‰©å±•çš„ã€‚è¯·æ³¨æ„ï¼Œå°½ç®¡ç§°ä¸ºæ— æœåŠ¡å™¨ï¼Œä½†ä»ä½¿ç”¨ç‰©ç†æœåŠ¡å™¨ï¼Œä½†å¼€å‘äººå‘˜æ— éœ€äº†è§£å®ƒä»¬ã€‚ ç›®å‰è¡Œä¸šå¯èƒ½æ›´å¤šå¤„äºå®¹å™¨Docker + Kubernetesï¼Œåˆ©ç”¨Iaasã€Paaså’ŒSaasæ¥å¿«é€Ÿæ­å»ºéƒ¨ç½²åº”ç”¨ Dockeræ˜¯ä¸€ä¸ªå¹³å°ï¼Œå®ƒä¸»è¦æ˜¯æä¾›ä¸€äº›æœåŠ¡ï¼Œä»»ä½•ä¸€å°è£…æœ‰dockerçš„æœºå™¨ä½ éƒ½å¯ä»¥å»ºç«‹ã€å‘å¸ƒã€è¿è¡Œä½ çš„åº”ç”¨ç¨‹åºï¼Œä½¿ç”¨dockerå¾ˆçœé’±çœæ—¶ã€‚ ç®€å•çš„ä»‹ç»Kubernetesã€‚å®ƒå°±æ˜¯ä¸€å¥—æˆç†Ÿçš„å•†ç”¨æœåŠ¡ç¼–æ’è§£å†³æ–¹æ¡ˆã€‚Kuberneteså®šä½åœ¨Paaså±‚ï¼Œé‡ç‚¹è§£å†³äº†å¾®æœåŠ¡å¤§è§„æ¨¡éƒ¨ç½²æ—¶çš„æœåŠ¡ç¼–æ’é—®é¢˜ã€‚ ç²¾ç¡®å®šä¹‰åŒ–å®é™…ä¸Šï¼Œä¸šç•Œå¯¹Serverlesså°šæ— ä¸€è‡´è®¤å¯çš„å®šä¹‰ï¼Œä½†æ˜¯æˆ‘ç›¸ä¿¡å¤§éƒ¨åˆ†å¼€å‘è€…åœ¨å¬åˆ° Serverlessæ—¶ï¼Œä¼šè”æƒ³åˆ°Lambdaï¼Œå¹¶ä¸”å†’å‡ºâ€œå‡½æ•°â€ã€â€œæŒ‰éœ€ï¼ˆè°ƒç”¨æ¬¡æ•°ï¼‰æ”¶è´¹â€ã€â€œäº‹ä»¶é©±åŠ¨â€ç­‰å…³é”®è¯ã€‚ç¡®å®å½“å¹´åˆšåˆšè¯ç”Ÿçš„Serverlesså°±åƒä¸‹é¢å¯çˆ±çš„â€œç´«è–¯äººâ€ï¼Œç´«è‰²å……æ»¡ç¥ç§˜æ„Ÿï¼ˆå½“å¹´åˆšæ¨å‡ºçš„æ—¶å€™ç»å¯¹æ˜¯é»‘ç§‘æŠ€ï¼‰ï¼Œè®©äººå°è±¡æ·±åˆ»ã€‚ åœ¨ã€Šserverless-æ¶æ„åº”ç”¨å¼€å‘æŒ‡å—ã€‹çš„å®šä¹‰æ˜¯ï¼š Serverless æ¶æ„æ˜¯æŒ‡å¤§é‡ä¾èµ–ç¬¬ä¸‰æ–¹æœåŠ¡ï¼ˆä¹Ÿå«åšåç«¯å³æœåŠ¡ï¼Œå³â€œBaaSâ€ï¼‰æˆ–æš‚å­˜å®¹å™¨ä¸­è¿è¡Œçš„è‡ªå®šä¹‰ä»£ç ï¼ˆå‡½æ•°å³æœåŠ¡ï¼Œå³â€œFaaSâ€ï¼‰çš„åº”ç”¨ç¨‹åºï¼Œå‡½æ•°æ˜¯æ— æœåŠ¡å™¨æ¶æ„ä¸­æŠ½è±¡è¯­è¨€è¿è¡Œæ—¶çš„æœ€å°å•ä½ã€‚ æŒ‰ AWS å®˜æ–¹å¯¹äº Serverless çš„å®šä¹‰ï¼š æœåŠ¡å™¨æ¶æ„æ˜¯åŸºäºäº’è”ç½‘çš„ç³»ç»Ÿï¼Œå…¶ä¸­åº”ç”¨å¼€å‘ä¸ä½¿ç”¨å¸¸è§„çš„æœåŠ¡è¿›ç¨‹ã€‚ç›¸åï¼Œå®ƒä»¬ä»…ä¾èµ–äºç¬¬ä¸‰æ–¹æœåŠ¡ï¼ˆä¾‹å¦‚AWS LambdaæœåŠ¡ï¼‰ï¼Œå®¢æˆ·ç«¯é€»è¾‘å’ŒæœåŠ¡æ‰˜ç®¡è¿œç¨‹è¿‡ç¨‹è°ƒç”¨çš„ç»„åˆã€‚â€2 åœ¨ä¸€ä¸ªåŸºäº AWS çš„ Serverless åº”ç”¨é‡Œï¼Œåº”ç”¨çš„ç»„æˆæ˜¯ï¼š ç½‘å…³ API Gateway æ¥æ¥å—å’Œå¤„ç†æˆåƒä¸Šä¸‡ä¸ªå¹¶å‘ API è°ƒç”¨ï¼ŒåŒ…æ‹¬æµé‡ç®¡ç†ã€æˆæƒå’Œè®¿é—®æ§åˆ¶ã€ç›‘æ§ç­‰ è®¡ç®—æœåŠ¡ Lambda æ¥è¿›è¡Œä»£ç ç›¸å…³çš„ä¸€åˆ‡è®¡ç®—å·¥ä½œï¼Œè¯¸å¦‚æˆæƒéªŒè¯ã€è¯·æ±‚ã€è¾“å‡ºç­‰ç­‰ åŸºç¡€è®¾æ–½ç®¡ç† CloudFormation æ¥åˆ›å»ºå’Œé…ç½® AWS åŸºç¡€è®¾æ–½éƒ¨ç½²ï¼Œè¯¸å¦‚æ‰€ä½¿ç”¨çš„ S3 å­˜å‚¨æ¡¶çš„åç§°ç­‰ é™æ€å­˜å‚¨ S3 ä½œä¸ºå‰ç«¯ä»£ç å’Œé™æ€èµ„æºå­˜æ”¾çš„åœ°æ–¹ æ•°æ®åº“ DynamoDB æ¥å­˜å‚¨åº”ç”¨çš„æ•°æ® ç­‰ç­‰ Serverless ä¸ FaaSï¼ˆå‡½æ•°å³æœåŠ¡ï¼‰é€šå¸¸è¢«è§†ä¸ºå¯ä»¥äº’æ¢çš„æœ¯è¯­ï¼Œä½†è¿™å¹¶ä¸å‡†ç¡®ã€‚Serverless æ˜¯ä¸€ç§æŠ½è±¡å±‚æ¬¡æ›´é«˜çš„æ¶æ„æ¨¡å¼ï¼Œè€Œâ€œFaaS + BaaSâ€åªæ˜¯ Serverless è¿™ç§æ¶æ„æ¨¡å¼çš„ä¸€ç§å®ç°ã€‚ è€Œæˆ‘è‡ªå·±æ›´å¤šçš„ç†è§£ï¼š ä¸ºServerlesså¹¶ä¸æ˜¯ä¸€å®šè¦ä½¿ç”¨äº‘æœåŠ¡ï¼Œè€Œæ˜¯ä¸€ç§ä¾èµ–äºæŒ‰éœ€ä¾èµ–ç¬¬ä¸‰æ–¹æœåŠ¡çš„æ¶æ„æ€æƒ³ ç‰¹ç‚¹ Serverless æ˜¯çœŸæ­£çš„æŒ‰éœ€ä½¿ç”¨ï¼Œè¯·æ±‚åˆ°æ¥æ—¶æ‰å¼€å§‹è¿è¡Œ å¼€å‘è€…åªéœ€è¦ä¸“æ³¨äºä¸šåŠ¡ï¼ŒæŒ‰å†…å­˜å’Œæ—¶é—´ç®—é’±å³å¯ é™ä½å¯åŠ¨æˆæœ¬ï¼ˆå¯¹äºå¤§å…¬å¸è€Œè¨€ï¼Œè¿™äº›éƒ½æ˜¯ç°æˆçš„åŸºç¡€è®¾æ–½ã€‚å¯å¯¹äºæ–°åˆ›ä¼ä¸šæ¥è¯´ï¼Œè¿™éƒ½æ˜¯ä¸€äº›å¯åŠ¨æˆæœ¬ã€‚ï¼‰ã€å‡å°‘è¿è¥æˆæœ¬ï¼Œå®ç°å¿«é€Ÿä¸Šçº¿ å­˜åœ¨çš„é—®é¢˜ï¼š ä¸é€‚åˆé•¿æ—¶é—´è¿è¡Œåº”ç”¨ï¼ˆå¯ä»¥ç†è§£ä¸ºé•¿æœŸç§Ÿè½¦çš„æˆæœ¬è‚¯å®šæ¯”ä¹°è½¦è´µï¼Œä½†æ˜¯ä½ å°±å°‘æ‰äº†ä¸€éƒ¨åˆ†çš„ç»´æŠ¤æˆæœ¬ã€‚å› æ­¤ï¼Œè¿™ä¸ªé—®é¢˜å®é™…ä¸Šæ˜¯ä¸€ä¸ªå€¼å¾—æ·±å…¥è®¡ç®—çš„é—®é¢˜ã€‚ï¼‰ å®Œå…¨ä¾èµ–äºç¬¬ä¸‰æ–¹ï¼Œå¯æ§æ€§ä¸å¼ºï¼ˆäº‘æä¾›å•†å¯èƒ½å¯¹å…¶ç»„ä»¶çš„äº¤äº’æ–¹å¼æœ‰ç€ä¸¥æ ¼çš„é™åˆ¶ï¼Œä»è€Œå½±å“æ‚¨ç³»ç»Ÿçš„çµæ´»æ€§å’Œå®šåˆ¶èƒ½åŠ›ã€‚é‡‡ç”¨ BaaS ç¯å¢ƒæ—¶ï¼Œå¼€å‘äººå‘˜å¯èƒ½è¦ä¸ºä»£ç ä¸å—å…¶æ§åˆ¶çš„æœåŠ¡è´Ÿè´£ï¼›å¹¶ä¸”å¦‚æœå†³å®šè¦æ›´æ¢æä¾›å•†ï¼Œä¹Ÿå¯èƒ½éœ€è¦å‡çº§ç³»ç»Ÿä»¥ç¬¦åˆæ–°ä¾›åº”å•†çš„è§„èŒƒï¼Œè€Œè¿™æ— ç–‘ä¼šå¢åŠ æˆæœ¬ã€‚ï¼‰ ç¼ºä¹è°ƒè¯•å’Œå¼€å‘å·¥å…· å†å²2006 å¹´ AWS æ¨å‡º EC2ï¼ˆElastic Compute Cloudï¼‰ï¼Œä½œä¸ºç¬¬ä¸€ä»£ IaaSï¼ˆInfrastructure as a Serviceï¼‰ PaaSï¼ˆPlatform as a Serviceï¼‰æ˜¯æ„å»ºåœ¨ IaaS ä¹‹ä¸Šçš„ä¸€ç§å¹³å°æœåŠ¡ï¼Œæä¾›æ“ä½œç³»ç»Ÿå®‰è£…ã€ç›‘æ§å’ŒæœåŠ¡å‘ç°ç­‰åŠŸèƒ½ï¼Œç”¨æˆ·åªéœ€è¦éƒ¨ç½²è‡ªå·±çš„åº”ç”¨å³å¯ï¼Œæœ€æ—©çš„ä¸€ä»£æ˜¯ Herokuã€‚ å†å²ä¸Šç¬¬ä¸€ä¸ª Serverless å¹³å°å¯ä»¥è¿½æº¯åˆ° 2006 å¹´ï¼Œåä¸º Zimkiï¼ˆè¯¥å…¬å¸å·²å€’é—­ï¼‰ï¼Œè¿™ä¸ªå¹³å°æä¾›æœåŠ¡ç«¯ JavaScript åº”ç”¨ï¼Œè™½ç„¶ä»–ä»¬æ²¡æœ‰ä½¿ç”¨Serverless è¿™ä¸ªåè¯ï¼Œä½†æ˜¯ä»–ä»¬æ˜¯ç¬¬ä¸€ä¸ªâ€œæŒ‰ç…§å®é™…è°ƒç”¨ä»˜è´¹â€çš„å¹³å°ã€‚ç¬¬ä¸€ä¸ªä½¿ç”¨ Serverless åè¯çš„æ˜¯ iron.ioã€‚ 2006å¹´AWSæ¨å‡ºäº†IaaSçš„äº‘è®¡ç®—ï¼ŒGoogleè®¤ä¸ºäº‘è®¡ç®—ä¸åº”è¯¥æ˜¯IaaSè¿™æ ·çš„åº•å±‚å½¢æ€ï¼Œæ‰€ä»¥åœ¨2008å¹´æ¨å‡ºäº†è‡ªå·±çš„äº‘è®¡ç®—ä»£è¡¨äº§å“GAEï¼ˆPaaSçš„å…·ä½“äº§å“ï¼‰ åˆ°åæ¥çš„PaaSäº§å“æ¯”å¦‚Cloud Foundryï¼Œè¿™ç±»PaaSäº§å“ç›¸å¯¹æ›´å®é™…ä¸€äº›ï¼Œåº•å±‚IaaSè¿˜æ˜¯äº‘å‚å•†æä¾›ï¼Œä¸Šå±‚æä¾›ä¸€å¥—åº”ç”¨ç®¡ç†ç”Ÿæ€ï¼ŒèƒŒåçš„æ€æƒ³è¿˜æ˜¯ä¸å¸Œæœ›å¼€å‘è€…é€šè¿‡IaaSè¿™ä¹ˆåº•å±‚çš„æ–¹å¼å»ä½¿ç”¨äº‘è®¡ç®—ï¼Œè€Œæ˜¯ä»PaaSå¼€å§‹ï¼Œä¸è¿‡å®ƒä¹Ÿä¸æ˜¯ServerlessåŒ–çš„ï¼Œä½ è¿˜æ˜¯è¦è€ƒè™‘æœåŠ¡å™¨çš„ç»´æŠ¤ã€æ›´æ–°ã€æ‰©å±•å’Œå®¹é‡è§„åˆ’ç­‰ç­‰ã€‚ éšç€å®¹å™¨æŠ€æœ¯çš„æˆç†Ÿï¼Œä»¥åŠServerlessç†å¿µçš„è¿›ä¸€æ­¥å‘å±•ï¼ŒPaaSå’ŒServerlessç†å¿µä¹Ÿå¼€å§‹èåˆï¼Œå…¸å‹çš„äº§å“ä»£è¡¨å°±æ˜¯é˜¿é‡Œäº‘åœ¨2019å¹´æ¨å‡ºçš„äº§å“ï¼šSAEï¼š é¦–å…ˆï¼Œå®ƒæ˜¯ä¸€ä¸ªPaaSï¼Œå†å…·ä½“ä¸€ç‚¹è¯´ï¼Œæ˜¯ä¸€ä¸ªåº”ç”¨PaaSã€‚è¿™æ„å‘³ç€å¤§éƒ¨åˆ†å¼€å‘è€…ä½¿ç”¨èµ·æ¥éƒ½ä¼šéå¸¸è‡ªç„¶ï¼Œå› ä¸ºé‡Œé¢çš„æ¦‚å¿µä½ ä¼šéå¸¸ç†Ÿæ‚‰ï¼Œæ¯”å¦‚åº”ç”¨å‘å¸ƒã€é‡å¯ã€ç°åº¦ã€ç¯å¢ƒå˜é‡ã€é…ç½®ç®¡ç†ç­‰ç­‰ã€‚ åŒæ—¶ï¼Œå®ƒä¹Ÿæ˜¯ServerlessåŒ–çš„ã€‚è¿™æ„å‘³ç€ä½ ä¸å¿…å†å…³å¿ƒæœåŠ¡å™¨ï¼Œä¸ç”¨å†ç”³è¯·æœºå™¨ï¼Œç»´æŠ¤æœåŠ¡å™¨ï¼Œè£…ä¸€å †å·¥å…·ï¼Œè€Œæ˜¯æŒ‰éœ€ä½¿ç”¨ï¼ŒæŒ‰åˆ†é’Ÿè®¡è´¹ï¼Œç»“åˆå¼ºå¤§çš„å¼¹æ€§èƒ½åŠ›ï¼ˆå®šæ—¶å¼¹æ€§ã€æŒ‡æ ‡å¼¹æ€§ï¼‰å®ç°æè‡´æˆæœ¬ã€‚ æœ€åï¼Œå¾—ç›ŠäºDockerä¸ºä»£è¡¨çš„å®¹å™¨æŠ€æœ¯çš„å‘å±•ï¼ŒSAEè§£å†³äº†ç»å…¸PaaSçš„çªå‡ºé—®é¢˜ï¼ˆå„ç§é™åˆ¶å’Œå¼ºç»‘å®šï¼‰ï¼Œä¾æ‰˜äºå®¹å™¨é•œåƒï¼Œåœ¨ä¸Šé¢å¯ä»¥è·‘ä»»æ„çš„è¯­è¨€çš„åº”ç”¨ Faas and Baas FaaSï¼ˆFunction as a Serviceï¼Œ å‡½æ•°å³æœåŠ¡ï¼‰ æ„åœ¨æ— é¡»è‡ªè¡Œç®¡ç†æœåŠ¡å™¨ç³»ç»Ÿæˆ–è‡ªå·±çš„æœåŠ¡å™¨åº”ç”¨ç¨‹åºï¼Œå³å¯ç›´æ¥è¿è¡Œåç«¯ä»£ç ï¼›å®ƒå¯ä»¥å–ä»£ä¸€äº›æœåŠ¡å¤„ç†æœåŠ¡å™¨ï¼ˆå¯èƒ½æ˜¯ç‰©ç†è®¡ç®—æœºï¼Œä½†ç»å¯¹éœ€è¦è¿è¡ŒæŸç§åº”ç”¨ç¨‹åºï¼‰ï¼Œè¿™æ ·ä¸ä»…ä¸éœ€è¦è‡ªè¡Œä¾›åº”æœåŠ¡å™¨ï¼Œä¹Ÿä¸éœ€è¦å…¨æ—¶è¿è¡Œåº”ç”¨ç¨‹åºã€‚ å®è´¨ä¸Šå°±æ˜¯ä¸€äº›è¿è¡Œå‡½æ•°çš„å¹³å°ï¼Œæ¯”å¦‚AWS çš„ Lambdaã€é˜¿é‡Œäº‘å‡½æ•°è®¡ç®—å’Œè…¾è®¯äº‘äº‘å‡½æ•°ç­‰ã€‚ æŒ‰ç…§é€šä¿—çš„è§’åº¦æ¥è¯´ï¼Œå°±æ˜¯èŠ±é’±è®©åˆ«äººçš„æœåŠ¡å™¨ï¼Œæä¾›ä¸€ä¸ªå‡½æ•°ï¼Œå¸®ä½ è°ƒç”¨ï¼Œå¹¶ä¸”å°†ç»“æœè¿”å›ç»™ä½  BaaSï¼ˆBackend as a Serviceï¼Œåç«¯å³æœåŠ¡ï¼‰æ˜¯æŒ‡æˆ‘ä»¬ä¸å†ç¼–å†™æˆ–ç®¡ç†æ‰€æœ‰æœåŠ¡ç«¯ç»„ä»¶ï¼Œå¯ä»¥ä½¿ç”¨é¢†åŸŸé€šç”¨çš„è¿œç¨‹ç»„ä»¶ï¼ˆè€Œä¸æ˜¯è¿›ç¨‹å†…çš„åº“ï¼‰æ¥æä¾›æœåŠ¡ å®è´¨ä¸Šæ˜¯ä¸€äº›åç«¯äº‘æœåŠ¡ï¼Œæ¯”å¦‚äº‘æ•°æ®åº“ã€å¯¹è±¡å­˜å‚¨ã€æ¶ˆæ¯é˜Ÿåˆ—ï¼Œ ä½¿ç”¨åºå¤§çš„äº‘å¯è®¿é—®æ•°æ®åº“ç”Ÿæ€ç³»ç»Ÿï¼ˆä¾‹å¦‚ï¼ŒParseï¼ŒFirebaseï¼‰ï¼Œèº«ä»½éªŒè¯æœåŠ¡ï¼ˆä¾‹å¦‚ï¼ŒAuth0ï¼ŒAWS Cognitoï¼‰ç­‰ã€‚åˆ©ç”¨ BaaSï¼Œå¯ä»¥æå¤§ç®€åŒ–æˆ‘ä»¬çš„åº”ç”¨å¼€å‘éš¾åº¦ã€‚ Serverless åˆ™å¯ä»¥ç†è§£ä¸ºè¿è¡Œåœ¨ FaaS ä¸­ï¼Œä½¿ç”¨äº† BaaS çš„å‡½æ•°ã€‚ IaaSï¼ŒPaaSï¼ŒSaaS IaaSï¼šåŸºç¡€è®¾æ–½æœåŠ¡ï¼ŒInfrastructure-as-a-service PaaSï¼šå¹³å°æœåŠ¡ï¼ŒPlatform-as-a-service SaaSï¼šè½¯ä»¶æœåŠ¡ï¼ŒSoftware-as-a-service è¿™ä¸‰è€…çš„åŒºåˆ«è¢«IBM çš„è½¯ä»¶æ¶æ„å¸ˆ Albert Barron æ›¾ç»ä½¿ç”¨æŠ«è¨ä½œä¸ºæ¯”å–» è®¾æƒ³ä½ æ˜¯ä¸€ä¸ªé¤é¥®ä¸šè€…ï¼Œè‡ªå·±ç”Ÿäº§æŠ«è¨ï¼Œä½†æ˜¯è¿™æ ·æ¯”è¾ƒéº»çƒ¦ï¼Œå› æ­¤ä½ å†³å®šå¤–åŒ…ä¸€éƒ¨åˆ†å·¥ä½œï¼Œé‡‡ç”¨ä»–äººçš„æœåŠ¡ã€‚ä½ æœ‰ä¸‰ä¸ªæ–¹æ¡ˆã€‚ ï¼ˆ1ï¼‰æ–¹æ¡ˆä¸€ï¼šIaaS IaaS è¡¨ç¤ºå°†ç”±æä¾›å•†é€šè¿‡äº‘ä¸ºæ‚¨ç®¡ç†åŸºç¡€æ¶æ„ï¼ŒåŒ…æ‹¬å®é™…çš„æœåŠ¡å™¨ã€ç½‘ç»œã€è™šæ‹ŸåŒ–å’Œå­˜å‚¨ã€‚ç”¨æˆ·å¯é€šè¿‡åº”ç”¨ç¼–ç¨‹æ¥å£ï¼ˆAPIï¼‰ æˆ–æ§åˆ¶é¢æ¿è¿›è¡Œè®¿é—®ï¼Œå¹¶ä¸”åŸºæœ¬ä¸Šæ˜¯ç§Ÿç”¨åŸºç¡€æ¶æ„ã€‚æ“ä½œç³»ç»Ÿã€åº”ç”¨å’Œä¸­é—´ä»¶ç­‰å†…å®¹ç”±ç”¨æˆ·ç®¡ç†ï¼Œè€Œæä¾›å•†åˆ™æä¾›ç¡¬ä»¶ã€ç½‘ç»œã€ç¡¬ç›˜é©±åŠ¨å™¨ã€å­˜å‚¨å’ŒæœåŠ¡å™¨ï¼Œå¹¶è´Ÿè´£å¤„ç†ä¸­æ–­ã€ç»´ä¿®åŠç¡¬ä»¶é—®é¢˜ã€‚ é‡‡ç”¨IaaSæœåŠ¡ï¼Œé‚£ä¹ˆæ„å‘³ç€ä½ å°±ä¸ç”¨è‡ªå·±ä¹°æœåŠ¡å™¨äº†ï¼Œéšä¾¿åœ¨å“ªå®¶è´­ä¹°è™šæ‹Ÿæœºï¼Œä½†æ˜¯è¿˜æ˜¯éœ€è¦è‡ªå·±è£…æœåŠ¡å™¨è½¯ä»¶ æ¯”å–»ï¼šä»–äººæä¾›å¨æˆ¿ã€ç‚‰å­ã€ç…¤æ°”ï¼Œä½ ä½¿ç”¨è¿™äº›åŸºç¡€è®¾æ–½ï¼Œæ¥çƒ¤ä½ çš„æŠ«è¨ã€‚ æ¯”å¦‚é˜¿é‡Œäº‘æœåŠ¡å™¨ä¹‹ç±»çš„ ï¼ˆ2ï¼‰æ–¹æ¡ˆäºŒï¼šPaaS ä½¿ç”¨ PaaS ç¯å¢ƒçš„ä¼˜åŠ¿åŒ…æ‹¬è½¬ç§»éƒ¨åˆ†èŒè´£ï¼Œå¦‚ç»´æŠ¤æœåŠ¡å™¨ã€æ›´æ–°åŸºç¡€æ¶æ„è½¯ä»¶ä»¥åŠè®¾ç½®ç”¨äºæ„å»ºåº”ç”¨çš„è‡ªå®šä¹‰å¹³å°ã€‚PaaS æä¾›å•†å¯æ‰˜ç®¡å¹³å°ï¼Œå¹¶ä¸ºæ­£åœ¨è¿è¡Œçš„åº”ç”¨æä¾›ç¯å¢ƒã€‚ é‡‡ç”¨PaaSçš„æœåŠ¡ï¼Œé‚£ä¹ˆæ„å‘³ç€ä½ æ—¢ä¸éœ€è¦ä¹°æœåŠ¡å™¨ï¼Œä¹Ÿä¸éœ€è¦è‡ªå·±è£…æœåŠ¡å™¨è½¯ä»¶ï¼Œåªéœ€è¦è‡ªå·±å¼€å‘ç½‘ç«™ç¨‹åº æ¯”å–»ï¼šé™¤äº†åŸºç¡€è®¾æ–½ï¼Œä»–äººè¿˜æä¾›æŠ«è¨é¥¼çš®ï¼›ä½ åªè¦æŠŠè‡ªå·±çš„é…æ–™æ´’åœ¨é¥¼çš®ä¸Šï¼Œè®©ä»–å¸®ä½ çƒ¤å‡ºæ¥å°±è¡Œäº†ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä½ è¦åšçš„å°±æ˜¯è®¾è®¡æŠ«è¨çš„å‘³é“ï¼ˆæµ·é²œæŠ«è¨æˆ–è€…é¸¡è‚‰æŠ«è¨ï¼‰ï¼Œä»–äººæä¾›å¹³å°æœåŠ¡ï¼Œè®©ä½ æŠŠè‡ªå·±çš„è®¾è®¡å®ç°ã€‚ æ¯”å¦‚ï¼šç½‘é¡µåº”ç”¨ç®¡ç†ï¼Œåº”ç”¨è®¾è®¡ï¼Œåº”ç”¨è™šæ‹Ÿä¸»æœºï¼Œå­˜å‚¨ï¼Œå®‰å…¨ä»¥åŠåº”ç”¨å¼€å‘åä½œå·¥å…·ç­‰ã€‚ç›®å‰ç½‘ä¸Šå¸¸è¯´çš„ä¸­é—´ä»¶å°±æ˜¯ä¸€ç§å…¸å‹çš„PaaSæœåŠ¡ ï¼ˆ3ï¼‰æ–¹æ¡ˆä¸‰ï¼šSaaS SaaS æ˜¯æŒ‡ç”±æä¾›å•†ä¸ºæ‚¨ç®¡ç†åº”ç”¨ã€‚æä¾›å•†å°†è´Ÿè´£å¤„ç†è½¯ä»¶æ›´æ–°ã€æ¼æ´ä¿®å¤åŠå…¶ä»–å¸¸è§„è½¯ä»¶ç»´æŠ¤å·¥ä½œï¼Œè€Œæ‚¨åªç”¨é€šè¿‡ Web æµè§ˆå™¨æˆ– API è¿æ¥è‡³è½¯ä»¶ã€‚è¿™æ ·ä¸€æ¥ï¼Œæ‚¨å°±æ— éœ€åœ¨æ¯å°è®¡ç®—æœºä¸Šå®‰è£…åº”ç”¨ã€‚ å¦‚æœä½ å†è¿›ä¸€æ­¥ï¼Œè´­ä¹°æŸäº›åœ¨çº¿è®ºå›æˆ–è€…åœ¨çº¿ç½‘åº—çš„æœåŠ¡,è¿™æ„å‘³ç€ä½ ä¹Ÿä¸ç”¨è‡ªå·±å¼€å‘ç½‘ç«™ç¨‹åºï¼Œåªéœ€è¦ä½¿ç”¨å®ƒä»¬å¼€å‘å¥½çš„ç¨‹åºï¼Œè€Œä¸”ä»–ä»¬ä¼šè´Ÿè´£ç¨‹åºçš„å‡çº§ã€ç»´æŠ¤ã€å¢åŠ æœåŠ¡å™¨ç­‰ï¼Œè€Œä½ åªéœ€è¦ä¸“å¿ƒè¿è¥å³å¯ æ¯”å–»ï¼šä»–äººç›´æ¥åšå¥½äº†æŠ«è¨ï¼Œä¸ç”¨ä½ çš„ä»‹å…¥ï¼Œåˆ°æ‰‹çš„å°±æ˜¯ä¸€ä¸ªæˆå“ã€‚ä½ è¦åšçš„å°±æ˜¯æŠŠå®ƒå–å‡ºå»ï¼Œæœ€å¤šå†åŒ…è£…ä¸€ä¸‹ï¼Œå°ä¸Šä½ è‡ªå·±çš„ Logoã€‚ æ¯”å¦‚ï¼šå¹³æ—¶ä½¿ç”¨çš„è‹¹æœæ‰‹æœºäº‘æœåŠ¡ï¼Œç½‘é¡µä¸­çš„ä¸€äº›äº‘æœåŠ¡ç­‰ã€‚ ä»å·¦åˆ°å³ï¼Œè‡ªå·±æ‰¿æ‹…çš„å·¥ä½œé‡ï¼ˆä¸Šå›¾è“è‰²éƒ¨åˆ†ï¼‰è¶Šæ¥è¶Šå°‘ï¼ŒIaaS &gt; PaaS &gt; SaaSã€‚ SaaSï¼šé¢å‘æ™®é€šç”¨æˆ· PaaSï¼šé¢å‘å¼€å‘è€… IaaSï¼šé¢å‘åº•å±‚å¼€å‘è€…ï¼ˆäº‘æœåŠ¡çš„æœ€åº•å±‚ï¼‰ ä½¿ç”¨å¯¹äºæ–°æ‰‹ï¼Œå¯ä»¥ä¼˜å…ˆé€‰æ‹©äº† Serverless æ¡†æ¶ï¼ŒGitHub: https://github.com/serverless/serverlessã€‚ npm install -g serverless ç„¶åå°±æ˜¯å…³äºAWSç”¨æˆ·è´¦å·çš„æ·»åŠ å’Œæƒé™çš„æ·»åŠ  ç„¶åç”Ÿæˆè®¿é—®å¯†é’¥ ID å’Œ ç§æœ‰è®¿é—®å¯†é’¥ã€‚è¯·å¦¥å–„ä¿å­˜å¥½ã€‚ ç„¶åå¯¼å‡ºè¯ä¹¦ï¼Œå¹¶ä½¿ç”¨ serverless depoy ä¿å­˜åˆ°æœ¬åœ°ã€‚ æ›´å¤šè¯·çœ‹ï¼š(éƒ½æ˜¯åŒä¸€ä¸ªä½œè€…) Serverless åº”ç”¨å¼€å‘æŒ‡å—ï¼šserverless çš„ hello, world Serverless åº”ç”¨å¼€å‘æŒ‡å—ï¼š Node.js ç¼–ç¨‹è¿”å›åŠ¨æ€ HTML Serverless åº”ç”¨å¼€å‘æŒ‡å—ï¼šAPI Gateway + S3 + AWS Lambda æ‰“é€  CRUD Serverless åº”ç”¨å¼€å‘æŒ‡å—ï¼šServerless + Express çš„ React æœåŠ¡ç«¯æ¸²æŸ“ â€¦. Serverless å’Œå‰ç«¯å‰ç«¯ç»è¿‡äº†Ajaxã€Nodejsã€Reactç­‰æŠ€æœ¯è¿­ä»£åï¼Œå·²ç»å½¢æˆäº†ç›¸å¯¹æˆç†Ÿçš„æŠ€æœ¯ä½“ç³»ï¼Œç‰¹åˆ«æ˜¯Nodejsï¼Œä½¿å‰ç«¯å’ŒæœåŠ¡ç«¯äº§ç”Ÿäº†è”ç³»ã€‚ å‰ç«¯å’Œåç«¯çš„åˆ†å·¥å‘æŒ¥äº†å„ä¸ªçš„ä¼˜ç‚¹ï¼Œä½†æ˜¯åœ¨åä½œçš„è¿‡ç¨‹ä¸­ä¹Ÿä¸€ç›´å­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼Œåç«¯åŒå­¦é€šå¸¸æ˜¯é¢å‘é¢†åŸŸå’ŒæœåŠ¡æä¾›æ¥å£ï¼Œä½†æ˜¯å‰ç«¯æ˜¯é¢å‘ç”¨æˆ·å…·ä½“çš„æ•°æ®æ¥å£ï¼Œæœ‰æ—¶å€™ä¸€ä¸ªç®€å•çš„éœ€æ±‚ä¼šå› ä¸ºä¸¤è¾¹çš„å®šä¹‰å’Œè”è°ƒæåŠå¤©ã€‚æ‰€ä»¥ä¹Ÿè¯ç”Ÿäº†BFFï¼ˆBackends For Frontendsï¼‰è¿™æ ·ä¸€å±‚ï¼Œè°ä½¿ç”¨è°å¼€å‘ï¼Œä¸“é—¨è§£å†³é¢†åŸŸæ¨¡å‹ - UI æ¨¡å‹çš„è½¬æ¢ã€‚ ç†æƒ³å¾ˆç¾å¥½ï¼Œç°å®ä¹Ÿå¾ˆéª¨å¹²ï¼Œå¦‚æœå‰ç«¯åŒå­¦å»åšBFFè¿™ä¸€å±‚ï¼Œå‘ç°è¦å­¦ä¹ åç«¯çš„DevOpsã€é«˜å¯ç”¨ã€å®¹é‡è§„åˆ’ç­‰ç­‰ï¼Œè¿™äº›å…¶å®æ˜¯å‰ç«¯åŒå­¦ä¸æƒ³å…³å¿ƒçš„ï¼Œè¿™ç§è¯‰æ±‚åœ¨Serverlessæ—¶ä»£å¾—åˆ°äº†å¾ˆå¥½çš„è§£å†³ï¼Œç”±BFFå˜ä¸ºäº†SFFï¼ˆServerless For Frontendï¼‰,è®©å‰ç«¯åŒå­¦åªè¦å†™å‡ ä¸ª Functionï¼Œå…¶ä»–éƒ½äº¤ç»™Serverlesså¹³å° ç±»ä¼¼çš„è¿˜æœ‰æœåŠ¡ç«¯æ¸²æŸ“ SSRï¼ˆServer Side Renderingï¼‰ï¼Œæœ¬æ¥å‰åç«¯åˆ†å·¥åï¼Œåç«¯åªéœ€è¦å†™æ¥å£ï¼Œå‰ç«¯è´Ÿè´£æ¸²æŸ“ï¼Œä½†æ˜¯åœ¨SEOå‹å¥½ä»¥åŠå¿«é€Ÿé¦–å±æ¸²æŸ“ç­‰éœ€æ±‚èƒŒæ™¯ä¸‹ï¼Œæœ‰æ—¶å€™ä¼šç”¨åˆ°æœåŠ¡ç«¯æ¸²æŸ“çš„æ–¹æ¡ˆï¼ŒåŒæ ·ï¼Œä½¿ç”¨Serverless å‰ç«¯åŒå­¦åˆå¯ä»¥æ„‰å¿«çš„ç©è€äº†ã€‚ å‚è€ƒæ–‡ç« ï¼š ã€Šserverless-æ¶æ„åº”ç”¨å¼€å‘æŒ‡å—ã€‹ Serverless åº”ç”¨å¼€å‘æŒ‡å—ï¼šserverless çš„ hello, world IaaSï¼ŒPaaSï¼ŒSaaSçš„åŒºåˆ«ï¼ˆé˜®ä¸€å³°ï¼‰ 6å²ï¼æ˜¯æ—¶å€™é‡æ–°è®¤è¯†ä¸‹Serverlessäº† ä½ å­¦BFFå’ŒServerlessäº†å—","categories":[{"name":"å‰ç«¯","slug":"å‰ç«¯","permalink":"https://taylor12138.github.io/categories/%E5%89%8D%E7%AB%AF/"}],"tags":[],"author":"Hello"},{"title":"æ’åºç®—æ³•","slug":"æ’åºç®—æ³•","date":"2021-10-16T06:32:38.586Z","updated":"2021-10-16T06:32:38.586Z","comments":true,"path":"2021/10/16/pai-xu-suan-fa/","link":"","permalink":"https://taylor12138.github.io/2021/10/16/pai-xu-suan-fa/","excerpt":"","text":"å¿«é€Ÿæ’åºè®¾ç½®ä¸ªå…³é”®å­—ï¼Œå°†å¤§çš„æ”¾åœ¨å®ƒåé¢ï¼Œå°çš„æ”¾åœ¨å‰é¢ï¼Œåˆ†æˆä¸¤ä¸ªå­è¡¨ï¼Œå¹¶ä¸”é‡å¤ä¸Šè¿°è¿‡ç¨‹ï¼Œç›´åˆ°æ¯ä¸€ä¸ªå­è¡¨åªæœ‰ä¸€ä¸ªè®°å½•ä¸ºæ­¢ const quickSort = function(arr){ if(arr.length &lt;= 0)return arr; const index = Math.floor(arr.length / 2); const key = arr.splice(index, 1)[0]; const left = []; const right = []; for(let i = 0; i &lt; arr.length; i++){ if(arr[i] &lt; key)left.push(arr[i]); else right.push(arr[i]); } return quickSort(left).concat([key], quickSort(right)); } console.log(quickSort([2, 5, 1, 9, 6, 1, 4])); console.log(['Jan', 'March', 'April', 'June'].splice(1, 1, 'Feb')); 1.ä¸ç¨³å®šæ’åº 2.å¤šç”¨äºé¡ºåºç»“æ„ 3.æ—¶é—´å¤æ‚åº¦O(nlog2 n)ã€‚ ç©ºé—´å¤æ‚åº¦ä¸ºO(log2 n), æœ€åO(n). æœ€åæƒ…å†µæ˜¯é€†åºï¼Œæˆ–åŸºæœ¬æœ‰åºï¼ˆé¡ºåºï¼‰ ç›´æ¥æ’å…¥æ’åºè¿™é‡Œé‡‡ç”¨çš„æ˜¯ä»åå‘å‰çš„æ¯”è¾ƒæ–¹å¼ï¼Œï¼ˆä»å‰å‘åå…¶å®ä¹Ÿå¯ä»¥ï¼‰ æœ‰ç‚¹åƒæ‰“ç‰Œï¼ŒæŠ½ç‰Œï¼Œç„¶åé€‰æ‹©åœ°æ–¹æ”¾å¥½ function insertion(array) { checkArray(array); for (let i = 1; i &lt; array.length; i++) { for (let j = i - 1; j >= 0 &amp;&amp; array[j] > array[j + 1]; j--) swap(array, j, j + 1); } return array; } 1.ç¨³å®šæ’åº 2.é€‚ç”¨äºé¡ºåºè¡¨å’Œé“¾è¡¨ 3.æ—¶é—´å¤æ‚åº¦ä¸ºO(n^2) ç©ºé—´å¤æ‚åº¦ä¸ºO(1),åªéœ€è¦ä¸€ä¸ªr[0] ä¼˜åŒ–æ’å…¥æ’åºå˜é‡è¦†ç›– const insertSort = (arr, start = 0, end) => { end = end || arr.length; for(let i = start; i &lt; end; i++) { let e = arr[i]; let j; for(j = i; j > start &amp;&amp; arr[j - 1] > e; j --) arr[j] = arr[j-1]; arr[j] = e; } return; } æŠ˜åŠæ’å…¥æ’åºå…¶å®å°±æ˜¯ç›´æ¥æ’å…¥æ’åºå¼•å…¥äº†æŠ˜åŠçš„æ€æƒ³ //ç®—æ³•8.2 æŠ˜åŠæ’å…¥æ’åº #include &lt;iostream> using namespace std; #define MAXSIZE 20 //é¡ºåºè¡¨çš„æœ€å¤§é•¿åº¦ typedef struct { int key; char *otherinfo; }ElemType; //é¡ºåºè¡¨çš„å­˜å‚¨ç»“æ„ typedef struct { ElemType *r; //å­˜å‚¨ç©ºé—´çš„åŸºåœ°å€ int length; //é¡ºåºè¡¨é•¿åº¦ }SqList; //é¡ºåºè¡¨ void BInsertSort(SqList &amp;L){ //å¯¹é¡ºåºè¡¨LåšæŠ˜åŠæ’å…¥æ’åº int i,j,low,high,m; for(i=2;i&lt;=L.length;++i) { L.r[0]=L.r[i]; //å°†å¾…æ’å…¥çš„è®°å½•æš‚å­˜åˆ°ç›‘è§†å“¨ä¸­ low=1; high=i-1; //ç½®æŸ¥æ‰¾åŒºé—´åˆå€¼ while(low&lt;=high) { //åœ¨r[low..high]ä¸­æŠ˜åŠæŸ¥æ‰¾æ’å…¥çš„ä½ç½® m=(low+high)/2; //æŠ˜åŠ if(L.r[0].key&lt;L.r[m].key) high=m-1; //æ’å…¥ç‚¹åœ¨å‰ä¸€å­è¡¨ else low=m+1; //æ’å…¥ç‚¹åœ¨åä¸€å­è¡¨ }//while for(j=i-1;j>=high+1;--j) L.r[j+1]=L.r[j]; //è®°å½•åç§» L.r[high+1]=L.r[0]; //å°†r[0]å³åŸr[i]ï¼Œæ’å…¥åˆ°æ­£ç¡®ä½ç½® } //for } //BInsertSort void Create_Sq(SqList &amp;L) { int i,n; cout&lt;&lt;\"è¯·è¾“å…¥æ•°æ®ä¸ªæ•°ï¼Œä¸è¶…è¿‡\"&lt;&lt;MAXSIZE&lt;&lt;\"ä¸ªã€‚\"&lt;&lt;endl; cin>>n; //è¾“å…¥ä¸ªæ•° cout&lt;&lt;\"è¯·è¾“å…¥å¾…æ’åºçš„æ•°æ®ï¼š\\n\"; while(n>MAXSIZE) { cout&lt;&lt;\"ä¸ªæ•°è¶…è¿‡ä¸Šé™ï¼Œä¸èƒ½è¶…è¿‡\"&lt;&lt;MAXSIZE&lt;&lt;\"ï¼Œè¯·é‡æ–°è¾“å…¥\"&lt;&lt;endl; cin>>n; } for(i=1;i&lt;=n;i++) { cin>>L.r[i].key; L.length++; } } void show(SqList L) { int i; for(i=1;i&lt;=L.length;i++) cout&lt;&lt;L.r[i].key&lt;&lt;endl; } void main() { SqList L; L.r=new ElemType[MAXSIZE+1]; L.length=0; Create_Sq(L); BInsertSort(L); cout&lt;&lt;\"æ’åºåçš„ç»“æœä¸ºï¼š\"&lt;&lt;endl; show(L); } 1.ç¨³å®šæ’åº 2.ä»…é€‚ç”¨äºé¡ºåºè¡¨ 3.æ—¶é—´å¤æ‚åº¦ä¸ºO(n^2)ï¼Œä½†æ˜¯å¹³å‡æ€§èƒ½&gt;ç›´æ¥æ’å…¥ã€‚ ç©ºé—´å¤æ‚åº¦ä¸ºO(1),åªéœ€è¦ä¸€ä¸ªr[0] å¸Œå°”æ’åºé€šè¿‡åˆ†ç»„è¿›è¡Œå¤§æµ®åŠ¨è·³è·ƒæ€§æ’åºï¼Œå¹¶ä¸”åˆ†ç»„çš„å½¢å¼æ˜¯ä»¥è®¾å®šçš„å¢é‡ä¸ºåŸºå‡† //ç®—æ³•8.3 å¸Œå°”æ’åº #include using namespace std; #define MAXSIZE 20 //é¡ºåºè¡¨çš„æœ€å¤§é•¿åº¦ typedef struct { int key; char *otherinfo; }ElemType; //é¡ºåºè¡¨çš„å­˜å‚¨ç»“æ„ typedef struct { ElemType *r; //å­˜å‚¨ç©ºé—´çš„åŸºåœ°å€ int length; //é¡ºåºè¡¨é•¿åº¦ }SqList; //é¡ºåºè¡¨ç±»å‹ void ShellInsert(SqList &L,int dk) { //å¯¹é¡ºåºè¡¨Låšä¸€è¶Ÿå¢é‡æ˜¯dkçš„å¸Œå°”æ’å…¥æ’åº int i,j; for(i=dk+1;i","categories":[{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"https://taylor12138.github.io/categories/%E7%AE%97%E6%B3%95/"}],"tags":[],"author":"Hello"},{"title":"ç‰›å®¢personal note","slug":"ç‰›å®¢personal note","date":"2021-09-16T15:28:25.809Z","updated":"2021-09-16T15:28:25.809Z","comments":true,"path":"2021/09/16/niu-ke-personal-note/","link":"","permalink":"https://taylor12138.github.io/2021/09/16/niu-ke-personal-note/","excerpt":"","text":"å°åŸºç¡€floor(x) å°äºç­‰äºxçš„æœ€å¤§å€¼æ•´æ•°ï¼ˆå‘ä¸‹å–æ•´ï¼‰ ceil(x) å¤§äºç­‰äºxçš„æœ€å°æ•´æ•°ï¼ˆå‘ä¸Šå–æ•´ï¼‰( #include&lt;math.h&gt; ) int 32ä½äºŒè¿›åˆ¶ ç¬¬ä¸€ä¸ªæ˜¯ç¬¦å·ä½æ­£æ•°ä¸º0ï¼Œè´Ÿæ•°ä¸º1ï¼Œåé¢æ˜¯æ•°å€¼ä½ -2^31â€”â€”2^31-1 long long 64ä½äºŒè¿›åˆ¶ double 64ä½äºŒè¿›åˆ¶ ï¼ˆfloatåˆ«ç”¨äº†ï¼Œå¤ªåƒåœ¾äº†ï¼‰ ~ å–å &gt;&gt;å³ç§» &lt;&lt;å·¦ç§» pow(a,b) açš„bæ¬¡æ–¹ ä¸€ç»´å‰ç¼€å’Œæ‹¥æœ‰æ•°ç»„xå’Œæ•°ç»„yï¼Œæ»¡è¶³ï¼š y0=x0; y1=x0+x1; y2=x0+x1+x2; å³æƒ³è¦æ±‚æŸåŒºé—´å’Œï¼Œå¯ç”¨yæ•°ç»„æ¥ç›¸å‡å¾—åˆ°ç»“æœ æšä¸¾ä¸€ä¸€ä¸¾ä¾‹ï¼Œä¸é‡å¤ å…ˆåˆ—ä¸¾å‡ºï¼ˆæ±‚ç¬¬xæ•°åˆ°ç¬¬yæ•°çš„å’Œï¼Œå…ˆæ±‚æ•°ç»„æ‰€æœ‰å’Œï¼Œç›´æ¥å‡ï¼‰ï¼Œï¼ˆæ±‚å››ä¸ªç‚¹çš„ä½ç½®ï¼Œå¹¶ä¸”å››ä¸ªç‚¹ç»„æˆæ­£æ–¹å½¢ï¼Œå…ˆæ±‚å››ä¸ªç‚¹ä¸­çš„ä¸¤ä¸ªç‚¹ï¼Œï¼‰ï¼Œï¼ˆæ±‚ä¸€æ’æ ‘æ•°é‡ï¼Œéƒ¨ä»½æ ‘è¢«æ•´æ®µç§»èµ°ï¼ˆå¯èƒ½é‡å ï¼‰ï¼Œç›´æ¥æ ‡è®°1ï¼Œç§»èµ°çš„æ ‘éƒ¨åˆ†-1ï¼‰ å–å°ºæ³•åˆ†Lï¼ŒRä¸¤ä¸ªæŒ‡é’ˆï¼Œæ±‚æ•°ç»„åŒºåŸŸ&lt;=sçš„è¿ç»­æ•°ç»„çš„ä¸ªæ•°ï¼Œ&lt;s Rå³ç§»ï¼Œ &gt;=s Lå³ç§» ä½¿ç”¨å‰æï¼š 1.èƒ½å¤Ÿç»´æŠ¤ä¸€ä¸ªåŒºé—´ï¼Œä¿è¯è¿™ä¸ªåŒºé—´èƒ½å¤Ÿè·å¾—ç­”æ¡ˆã€‚ 2.ç»´æŠ¤çš„å…·ä½“æ“ä½œå¯ä»¥å·¦è¾¹ç§»åŠ¨ä¸€ä½ã€å³è¾¹ç§»åŠ¨ä¸€ä½ã€‚ 3.åŒºé—´çš„å˜åŒ–æ˜¯è¿ç»­çš„è€Œä¸æ˜¯è·³è·ƒçš„ã€‚é—®é¢˜1å°±æ˜¯æ¯”è¾ƒè·³è·ƒçš„ï¼ŒåŒæŒ‡é’ˆæ¯”è¾ƒå¥½ï¼Œé—®é¢˜2ä¸èƒ½è·³è·ƒã€‚ è´ªå¿ƒç®—æ³•å±€éƒ¨æœ€ä¼˜è§£ï¼Œç„¶åå‘ç°å±€éƒ¨æœ€ä¼˜=æ•´ä½“æœ€ä¼˜è§£ æ¡¶æ’åºåˆ—å‡ºæ•°ç»„ï¼Œ å°†æ•°ç»„åˆ†åˆ°æœ‰é™æ•°é‡çš„æ¡¶é‡Œï¼Œå°†æ•°æ®å¯¹æ¯”ï¼Œæœ‰åˆ™è®©æ•°ç»„å¯¹åº”çš„æ•°æ®+1ï¼Œæ¯ä¸ªæ¡¶å†ä¸ªåˆ«æ’åº ï¼Œç„¶åä¾æ¬¡è¾“å‡º æ¡¶è¶Šå¤šï¼Œæ—¶é—´æ•ˆç‡å°±è¶Šé«˜ï¼Œè€Œæ¡¶è¶Šå¤šï¼Œç©ºé—´å°±è¶Šå¤§ è¿™é‡Œæœ‰ä½å¤§ä½¬æˆ‘è§‰å¾—å†™å¾—å¾ˆå¥½ï¼Œå¤–åŠ åŠ¨æ¼«é…å›¾ï¼Œå¯ä»¥çœ‹ä¸€ä¸‹ï¼ˆç®€å•æ¡¶æ’åºï¼‰ https://www.cnblogs.com/bqwzx/p/11029264.html è®¡æ•°æ’åºåŸºæ•°æ’åºå’Œè®¡æ•°æ’åºéƒ½å¯ä»¥çœ‹åšæ¡¶æ’åºï¼Œè®¡æ•°æ’åºçš„æ€è·¯æ˜¯å¼€ä¸€ä¸ªé•¿åº¦ä¸º maxValue-minValue+1 çš„æ•°ç»„ï¼Œè¿›è¡Œåˆ†é…+æ”¶é›†: åˆ†é…ã€‚æ‰«æä¸€éåŸå§‹æ•°ç»„ï¼Œä»¥å½“å‰å€¼- minValue ä½œä¸ºä¸‹æ ‡ï¼Œå°†è¯¥ä¸‹æ ‡çš„è®¡æ•°å™¨å¢1ã€‚ æ”¶é›†ã€‚æ‰«æä¸€éè®¡æ•°å™¨æ•°ç»„ï¼ŒæŒ‰é¡ºåºæŠŠå€¼æ”¶é›†èµ·æ¥ã€‚ è®¡æ•°æ’åºæœ¬è´¨ä¸Šæ˜¯ä¸€ç§ç‰¹æ®Šçš„æ¡¶æ’åºï¼Œå½“æ¡¶çš„ä¸ªæ•°æœ€å¤§çš„æ—¶å€™ï¼Œå°±æ˜¯è®¡æ•°æ’åº ï¼Œ è®¡æ•°æ’åºéå¸¸æµªè´¹ç©ºé—´ VECTORvectoræ˜¯ä¸€ä¸ªä¸é™åˆ¶æ•°ç»„é•¿åº¦çš„æ•°ç»„ top()è¿”å›ç¬¬ä¸€ä¸ªå…ƒç´  back()è¿”å›æœ€åä¸€ä¸ªå…ƒç´  eraseï¼ˆint index,int sizeï¼‰åˆ é™¤ vector a; è¿­ä»£å™¨Iteratorç”¨äºè®¿é—®é—®ä¸€ä¸ªå®¹å™¨å†…çš„æ•°æ®çš„æŒ‡é’ˆ vector:: iterator it; C++ STLçš„äºŒåˆ†æŸ¥æ‰¾binary search è¿”å›boolï¼Œæ˜¯å¦å­˜åœ¨ low_bound è¿”å›å¯æ’å…¥çš„æœ€å°ä½ç½®çš„è¿­ä»£å™¨ï¼Œå³è¿”å›ç¬¬ä¸€ä¸ªç¬¦åˆæ¡ä»¶çš„å…ƒç´ ä½ç½®ï¼Œlow_bound(a,a+11,55), a[0]åˆ°a[10]æ‰¾55ï¼Œè¿”å›è¿­ä»£å™¨ï¼Œå¯å°†ç»“æœ -a å¾—åˆ°å®ƒçš„ä¸‹æ ‡ ç¬¬ä¸€ä¸ª&lt;=xçš„ä½ç½® upper_bound è¿”å›å¯æ’å…¥çš„æœ€å¤§ä½ç½®çš„è¿­ä»£å™¨ï¼Œå³è¿”å›æœ€åä¸€ä¸ªç¬¦åˆæ¡ä»¶çš„å…ƒç´ ä½ç½® ç¬¬ä¸€ä¸ª&gt;xçš„ä½ç½®","categories":[{"name":"personal","slug":"personal","permalink":"https://taylor12138.github.io/categories/personal/"}],"tags":[],"author":"Hello"},{"title":"React Fiber","slug":"React Fiber","date":"2021-09-14T16:00:00.000Z","updated":"2021-11-04T09:56:29.925Z","comments":true,"path":"2021/09/15/react-fiber/","link":"","permalink":"https://taylor12138.github.io/2021/09/15/react-fiber/","excerpt":"","text":"React FiberReact Fiberä»‹ç»è¿›ç¨‹ï¼ˆProcessï¼‰å’Œçº¿ç¨‹ï¼ˆThreadï¼‰ï¼Œåœ¨è®¡ç®—æœºç§‘å­¦ä¸­è¿˜æœ‰ä¸€ä¸ªæ¦‚å¿µå«åšFiberï¼Œè‹±æ–‡å«ä¹‰å°±æ˜¯â€œçº¤ç»´â€ï¼Œæ„æŒ‡æ¯”Threadæ›´ç»†çš„çº¿ï¼Œä¹Ÿå°±æ˜¯æ¯”çº¿ç¨‹(Thread)æ§åˆ¶å¾—æ›´ç²¾å¯†çš„å¹¶å‘å¤„ç†æœºåˆ¶ã€‚ ç„¶è€Œè™½ç„¶Fiberå’ŒReact Fiberæ˜¯ä¸¤ä¸ªä¸åŒçš„æ¦‚å¿µï¼Œä½†å–åå´æœ‰å¼‚æ›²åŒå·¥ä¹‹å¦™ è€Œå®˜æ–¹è§£é‡Šåˆ°ï¼šReact Fiberæ˜¯å¯¹æ ¸å¿ƒç®—æ³•çš„ä¸€æ¬¡é‡æ–°å®ç° React å®ç°äº†ä¸€ä¸ªè™šæ‹Ÿå †æ ˆå¸§ã€‚å®é™…ä¸Šï¼Œè¿™ä¸ªæ‰€è°“çš„è™šæ‹Ÿå †æ ˆå¸§æœ¬è´¨ä¸Šæ˜¯å»ºç«‹äº†å¤šä¸ªåŒ…å«èŠ‚ç‚¹å’ŒæŒ‡é’ˆçš„é“¾è¡¨æ•°æ®ç»“æ„ã€‚æ¯ä¸€ä¸ªèŠ‚ç‚¹å°±æ˜¯ä¸€ä¸ª fiber åŸºæœ¬å•å…ƒï¼Œè¿™ä¸ªå¯¹è±¡å­˜å‚¨äº†ä¸€å®šçš„ç»„ä»¶ç›¸å…³çš„æ•°æ®åŸŸä¿¡æ¯ã€‚è€ŒæŒ‡é’ˆçš„æŒ‡å‘ï¼Œåˆ™æ˜¯ä¸²è”èµ·æ•´ä¸ª fibers æ ‘ã€‚é‡æ–°è‡ªå®šä¹‰å †æ ˆå¸¦æ¥æ˜¾è€Œæ˜“è§çš„ä¼˜ç‚¹æ˜¯ï¼Œå¯ä»¥å°†å †æ ˆä¿ç•™åœ¨å†…å­˜ä¸­ï¼Œåœ¨éœ€è¦æ‰§è¡Œçš„æ—¶å€™æ‰§è¡Œå®ƒä»¬ï¼Œè¿™ä½¿å¾—æš‚åœéå†å’Œåœæ­¢å †æ ˆé€’å½’æˆä¸ºå¯èƒ½ã€‚ æ‰€ä»¥æˆ‘ä¸ªäººåå‘ç†è§£fiberä¸ºä¸€ä¸ªå·¥ä½œå•å…ƒï¼ˆunits of workï¼‰ fiberå¯¹è±¡ä¸»è¦å±æ€§ä¸€è§ˆ Fiber = { // æ ‡è¯† fiber ç±»å‹çš„æ ‡ç­¾ï¼Œè¯¦æƒ…å‚çœ‹ä¸‹è¿° WorkTag tag: WorkTag, // èŠ‚ç‚¹çš„è¿æ¥ // æŒ‡å‘çˆ¶èŠ‚ç‚¹ return: Fiber | null, // æŒ‡å‘å­èŠ‚ç‚¹ child: Fiber | null, // æŒ‡å‘å…„å¼ŸèŠ‚ç‚¹ sibling: Fiber | null, // åŠ¨æ€å·¥ä½œå•å…ƒ // åœ¨å¼€å§‹æ‰§è¡Œæ—¶è®¾ç½® props å€¼ pendingProps: any, // åœ¨ç»“æŸæ—¶è®¾ç½®çš„ props å€¼ memoizedProps: any, // å½“å‰ state memoizedState: any, // Effect ç±»å‹ï¼Œè¯¦æƒ…æŸ¥çœ‹ä»¥ä¸‹ effectTag effectTag: SideEffectTag, // effect èŠ‚ç‚¹æŒ‡é’ˆï¼ŒæŒ‡å‘ä¸‹ä¸€ä¸ª effect nextEffect: Fiber | null, // effect list æ˜¯å•å‘é“¾è¡¨ï¼Œç¬¬ä¸€ä¸ª effect firstEffect: Fiber | null, // effect list æ˜¯å•å‘é“¾è¡¨ï¼Œæœ€åä¸€ä¸ª effect lastEffect: Fiber | null, // è°ƒåº¦ä¼˜å…ˆçº§ç›¸å…³ // work çš„è¿‡æœŸæ—¶é—´ï¼Œå¯ç”¨äºæ ‡è¯†ä¸€ä¸ª work ä¼˜å…ˆçº§é¡ºåºï¼Œåœ¨2020å¹´5æœˆï¼Œè°ƒåº¦ä¼˜å…ˆçº§ç­–ç•¥ç»å†äº†æ¯”è¾ƒå¤§çš„é‡æ„ã€‚ä»¥expirationTimeå±æ€§ä¸ºä»£è¡¨çš„ä¼˜å…ˆçº§æ¨¡å‹è¢«laneå–ä»£ expirationTime: ExpirationTime, this.lanes = NoLanes; this.childLanes = NoLanes; }; React Fiberå‡ºç°ç¼˜ç”±fiberå‡ºç°ä¹‹å‰çš„React -&gt; å½“ç»„ä»¶æ ‘å¾ˆå¤§çš„æ—¶å€™å°±ä¼šå‡ºç°è¿™ç§é—®é¢˜ï¼Œå› ä¸ºæ›´æ–°è¿‡ç¨‹æ˜¯åŒæ­¥åœ°ä¸€å±‚ç»„ä»¶å¥—ä¸€å±‚ç»„ä»¶ï¼Œé€æ¸æ·±å…¥çš„è¿‡ç¨‹ï¼Œåœ¨æ›´æ–°å®Œæ‰€æœ‰ç»„ä»¶ä¹‹å‰ä¸åœæ­¢ï¼Œè€Œä¸”å¾ˆé•¿æ—¶é—´ä¸ä¼šè¿”å›ã€‚ å› ä¸ºJavaScriptå•çº¿ç¨‹çš„ç‰¹ç‚¹ï¼Œæ¯ä¸ªåŒæ­¥ä»»åŠ¡ä¸èƒ½è€—æ—¶å¤ªé•¿ï¼Œä¸ç„¶å°±ä¼šè®©ç¨‹åºä¸ä¼šå¯¹å…¶ä»–è¾“å…¥ä½œå‡ºç›¸åº”ï¼ŒReactçš„æ›´æ–°è¿‡ç¨‹å°±æ˜¯çŠ¯äº†è¿™ä¸ªç¦å¿Œï¼Œè€ŒReact Fiberå°±æ˜¯è¦æ”¹å˜ç°çŠ¶ã€‚ æ¯”å¦‚ JSå¼•æ“è§£æJSä»£ç  -&gt; æ ·å¼å¸ƒå±€ -&gt; æ ·å¼ç»˜åˆ¶ å½“JSæ‰§è¡Œæ—¶é—´è¿‡é•¿ï¼Œè¶…å‡ºäº†16.6msï¼ˆä¸»æµæµè§ˆå™¨1000ms / 60å¸§ï¼‰ï¼Œè¿™æ¬¡åˆ·æ–°å°±æ²¡æœ‰æ—¶é—´æ‰§è¡Œæ ·å¼å¸ƒå±€å’Œæ ·å¼ç»˜åˆ¶äº†ã€‚ç”±æ­¤åœ¨åŒæ­¥å·¥ä½œè€Œè¿‡ç¨‹å½“ä¸­ï¼Œå¯èƒ½æ— æ³•ç»˜åˆ¶å®Œå…¨ï¼Ÿï¼(å›¾ç‰‡æºè‡ªå¡ä½¬çš„https://react.iamkasong.com/) ç„¶è€Œè§£å†³åŒæ­¥æ›´æ–°æ•´ä¸ªå·¨å¤§çš„DOMçš„æ–¹æ¡ˆï¼Œå°±æ˜¯åˆ†ç‰‡æ“ä½œï¼ˆå†…å¿ƒosï¼šè®©æˆ‘æƒ³èµ·äº†cpuçš„æ—¶é—´åˆ†ç‰‡ï¼‰ æŠŠå½“å‰ä»»åŠ¡è¿›è¡Œåˆ†ç‰‡ï¼Œæ¯ä¸€ä¸ªå°ç‰‡æŒ‰ç…§ä¸€å®šç®—æ³•æ‰§è¡Œï¼Œè¿™æ ·å­çº¿ç¨‹å°±ä¸ä¼šè¢«ç‹¬å ï¼Œè®©å…¶ä»–ä»»åŠ¡æœ‰å¯ä¹˜ä¹‹æœºï¼ React FiberæŠŠæ›´æ–°è¿‡ç¨‹ç¢ç‰‡åŒ–ï¼ˆåˆ†ç‰‡æ•°æ®ç»“æ„ç»´æŠ¤çš„leaderï¼‰ï¼Œæ¯æ‰§è¡Œå®Œä¸€æ®µæ›´æ–°è¿‡ç¨‹ï¼Œå°±æŠŠæ§åˆ¶æƒäº¤è¿˜ç»™Reactè´Ÿè´£ä»»åŠ¡åè°ƒçš„æ¨¡å—ï¼Œçœ‹çœ‹æœ‰æ²¡æœ‰å…¶ä»–ç´§æ€¥ä»»åŠ¡è¦åšï¼Œå¦‚æœæ²¡æœ‰å°±ç»§ç»­å»æ›´æ–°ï¼Œå¦‚æœæœ‰ç´§æ€¥ä»»åŠ¡ï¼Œé‚£å°±å»åšç´§æ€¥ä»»åŠ¡ã€‚ React16æ¶æ„React16æ¶æ„å¯ä»¥åˆ†ä¸ºä¸‰å±‚ï¼ˆä¹‹å‰æ˜¯åªæœ‰ä¸¤å±‚ï¼Œæ²¡æœ‰ Schedulerï¼‰ï¼š Schedulerï¼ˆè°ƒåº¦å™¨ï¼‰â€”â€” è°ƒåº¦ä»»åŠ¡çš„ä¼˜å…ˆçº§ï¼Œé«˜ä¼˜ä»»åŠ¡ä¼˜å…ˆè¿›å…¥Reconciler Reconcilerï¼ˆåè°ƒå™¨ï¼‰â€”â€” è´Ÿè´£æ‰¾å‡ºå˜åŒ–çš„ç»„ä»¶ Rendererï¼ˆæ¸²æŸ“å™¨ï¼‰â€”â€” è´Ÿè´£å°†å˜åŒ–çš„ç»„ä»¶æ¸²æŸ“åˆ°é¡µé¢ä¸Š FiberåŒ…å«ä¸‰å±‚å«ä¹‰ï¼š ä½œä¸ºæ¶æ„æ¥è¯´ï¼Œä¹‹å‰React15çš„Reconcileré‡‡ç”¨é€’å½’çš„æ–¹å¼æ‰§è¡Œï¼Œæ•°æ®ä¿å­˜åœ¨é€’å½’è°ƒç”¨æ ˆä¸­ï¼Œæ‰€ä»¥è¢«ç§°ä¸ºstack Reconcilerã€‚React16çš„ReconcileråŸºäºFiberèŠ‚ç‚¹å®ç°ï¼Œè¢«ç§°ä¸ºFiber Reconcilerã€‚ ä½œä¸ºé™æ€çš„æ•°æ®ç»“æ„æ¥è¯´ï¼Œæ¯ä¸ªFiberèŠ‚ç‚¹å¯¹åº”ä¸€ä¸ªReact elementï¼Œä¿å­˜äº†è¯¥ç»„ä»¶çš„ç±»å‹ï¼ˆå‡½æ•°ç»„ä»¶/ç±»ç»„ä»¶/åŸç”Ÿç»„ä»¶â€¦ï¼‰ã€å¯¹åº”çš„DOMèŠ‚ç‚¹ç­‰ä¿¡æ¯ã€‚ ä½œä¸ºåŠ¨æ€çš„å·¥ä½œå•å…ƒæ¥è¯´ï¼Œæ¯ä¸ªFiberèŠ‚ç‚¹ä¿å­˜äº†æœ¬æ¬¡æ›´æ–°ä¸­è¯¥ç»„ä»¶æ”¹å˜çš„çŠ¶æ€ã€è¦æ‰§è¡Œçš„å·¥ä½œï¼ˆéœ€è¦è¢«åˆ é™¤/è¢«æ’å…¥é¡µé¢ä¸­/è¢«æ›´æ–°â€¦ï¼‰ã€‚ React Fiberçš„å½±å“å…ˆè¯´ä¸€ä¸‹Reactçš„æ¸²æŸ“è¿‡ç¨‹ Renderé˜¶æ®µï¼ˆ1ï¼‰Reconciliation Phaseï¼ˆRenderé˜¶æ®µï¼Œä½ä¼˜å…ˆçº§ï¼‰ï¼šReactå°†æ›´æ–°åº”ç”¨äºé€šè¿‡setStateæˆ–renderæ–¹æ³•è§¦å‘çš„ç»„ä»¶ï¼Œå¹¶ç¡®å®šéœ€è¦åœ¨ç”¨æˆ·å±å¹•ä¸Šåšå“ªäº›æ›´æ–°â€“å“ªäº›èŠ‚ç‚¹éœ€è¦æ’å…¥ï¼Œæ›´æ–°æˆ–åˆ é™¤ï¼ˆåˆ©ç”¨effectTagæ¥æ ‡è¯†ï¼Œæ¯”å¦‚ï¼‰ // DOMéœ€è¦æ’å…¥åˆ°é¡µé¢ä¸­ export const Placement = /* */ 0b00000000000010; // DOMéœ€è¦æ›´æ–° export const Update = /* */ 0b00000000000100; // DOMéœ€è¦æ’å…¥åˆ°é¡µé¢ä¸­å¹¶æ›´æ–° export const PlacementAndUpdate = /* */ 0b00000000000110; // DOMéœ€è¦åˆ é™¤ export const Deletion = /* */ 0b00000000001000; å“ªäº›ç»„ä»¶éœ€è¦è°ƒç”¨å…¶ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ã€‚ï¼ˆæ‰¾å‡ºéœ€è¦æ›´æ–°å“ªäº›DOMï¼‰æœ€ç»ˆçš„è¿™äº›æ›´æ–°ä¿¡æ¯è¢«ä¿å­˜åœ¨ä¸€ä¸ªå«effect listçš„fiber èŠ‚ç‚¹æ ‘ä¸Šï¼Œç„¶ååœ¨è¿™ä¸ªé˜¶æ®µåˆ›å»ºå‡ºworkInProgress Fiber Treeã€‚ ä½†æ˜¯å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œé¦–å±æ¸²æŸ“æ—¶æœŸï¼Œä¹Ÿå°±æ˜¯mountæ—¶é—´æ®µï¼ŒreconcileChildrenä¸­è°ƒç”¨çš„mountChildFibersä¸ä¼šä¸ºFiberèŠ‚ç‚¹èµ‹å€¼effectTagï¼Œè€Œæ˜¯åœ¨ completeWorké˜¶æ®µå½“ä¸­åˆ›å»º fiber.stateNodeã€‚å› ä¸ºé¦–æ¬¡æ¸²æŸ“çš„æ—¶å€™æ¯«æ— ç–‘é—®æ•´æ£µfiberæ ‘ä¸ºç©ºï¼Œåˆ™æ¯ä¸ªèŠ‚ç‚¹éƒ½ä¼šè¢«èµ‹å€¼ä¸Šï¼ŒPlacement effectTagï¼Œæ­¤æ—¶æ¯ä¸ªèŠ‚ç‚¹éƒ½ä¼šæ‰§è¡Œä¸€æ¬¡æ’å…¥æ“ä½œï¼Œæ•ˆæœæ˜¯æä½çš„ï¼Œè€Œåªæœ‰rootFiberä¼šèµ‹å€¼Placement effectTag åœ¨æ–°ç”Ÿå‘½å‘¨æœŸå›¾ä¸­renderé˜¶æ®µè¢«æ ‡è®°ä¸ºçº¯çš„ã€æ²¡æœ‰å‰¯ä½œç”¨çš„ï¼Œå¯èƒ½ä¼šè¢«Reactæš‚åœã€ç»ˆæ­¢æˆ–è€…é‡æ–°æ‰§è¡Œã€‚ä¹Ÿå°±æ˜¯è¯´ï¼ŒReactä¼šæ ¹æ®äº§ç”Ÿçš„ä»»åŠ¡çš„ä¼˜å…ˆçº§ï¼Œå®‰æ’ä»»åŠ¡çš„è°ƒåº¦ï¼ˆscheduleï¼‰ã€‚åˆ©ç”¨ç±»ä¼¼requestIdleCallbackçš„åŸç†åœ¨æµè§ˆå™¨ç©ºé—²é˜¶æ®µè¿›è¡Œæ›´æ–°è®¡ç®—ï¼Œè€Œä¸ä¼šé˜»å¡åŠ¨ç”»ï¼Œäº‹ä»¶ç­‰çš„æ‰§è¡Œã€‚ é€šä¿—æ¥è¯´ï¼Œä¹Ÿå°±æ˜¯è®²æˆ‘ä»¬æƒ³è¦åšçš„æ“ä½œï¼Œåšä»€ä¹ˆä»»åŠ¡ï¼Œä»¥åŠä¼šè°ƒç”¨åˆ°çš„ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ä½œä¸ºä¿¡æ¯ä¿å­˜åœ¨ fiberèŠ‚ç‚¹æ ‘ä¸Š å¹¶ä¸”ä¸€æ¬¡æ›´æ–°è¿‡ç¨‹ä¼šåˆ†æˆå¤šä¸ªåˆ†ç‰‡å®Œæˆï¼Œæ‰€ä»¥å®Œå…¨æœ‰å¯èƒ½ä¸€ä¸ªæ›´æ–°ä»»åŠ¡è¿˜æ²¡æœ‰å®Œæˆï¼Œå°±è¢«å¦ä¸€ä¸ªæ›´é«˜ä¼˜å…ˆçº§çš„æ›´æ–°è¿‡ç¨‹æ‰“æ–­ï¼ˆæ¯”å¦‚ç”¨æˆ·äº¤äº’çš„ä¼˜å…ˆçº§ &gt; æ•°æ®è¯·æ±‚ï¼‰ï¼Œè¿™æ—¶å€™ï¼Œä¼˜å…ˆçº§é«˜çš„æ›´æ–°ä»»åŠ¡ä¼šä¼˜å…ˆå¤„ç†å®Œï¼Œè€Œä½ä¼˜å…ˆçº§æ›´æ–°ä»»åŠ¡æ‰€åšçš„å·¥ä½œåˆ™ä¼šå®Œå…¨ä½œåºŸï¼Œç„¶åç­‰å¾…æœºä¼šé‡å¤´å†æ¥ã€‚ Commité˜¶æ®µï¼ˆ2ï¼‰Commit Phaseï¼ˆCommité˜¶æ®µï¼Œé«˜ä¼˜å…ˆçº§ï¼‰ï¼šä¼šéå†effect listï¼ŒæŠŠæ‰€æœ‰æ›´æ–°éƒ½commitåˆ°DOMæ ‘ä¸Šã€‚åœ¨pre-commité˜¶æ®µï¼Œä¸»è¦æ˜¯æ‰§è¡ŒgetSnapshotBeforeUpdateæ–¹æ³•ï¼Œå¯ä»¥è·å–å½“å‰DOMçš„å¿«ç…§ï¼ˆsnapï¼Œè¯¦æƒ…å¯ä»¥æ”¶çœ‹æ–°ç”Ÿå‘½å‘¨æœŸå›¾ä¸­çš„ getSnapshotBeforeUpdate ï¼‰ï¼Œç„¶åç»™éœ€è¦å¸è½½çš„ç»„ä»¶æ‰§è¡ŒcomponentWillUnmountæ–¹æ³•ã€‚æ¥ç€ä¼šæŠŠcurrent fiber tree æ›¿æ¢ä¸ºworkInProgress fiber treeã€‚æœ€åæ‰§è¡ŒDOMçš„æ’å…¥ã€æ›´æ–°å’Œåˆ é™¤ï¼ˆmutationé˜¶æ®µï¼‰ï¼Œç»™æ›´æ–°çš„ç»„ä»¶æ‰§è¡ŒcomponentDidUpdateï¼Œç»™æ’å…¥çš„ç»„ä»¶æ‰§è¡ŒcomponentDidMountã€‚ è¿™ä¸€é˜¶æ®µæ— æ³•ç»ˆæ­¢ï¼ˆä¸€é¼“ä½œæ°”ï¼Œå†è€Œè¡°ï¼Œä¸‰è€Œç«­åœ°æ›´æ–°DOMï¼Œneveræ‰“æ–­ï¼‰ åœ¨ commit é˜¶æ®µï¼Œwork æ‰§è¡Œæ€»æ˜¯åŒæ­¥çš„ï¼Œè¿™æ˜¯å› ä¸ºåœ¨æ­¤é˜¶æ®µæ‰§è¡Œçš„å·¥ä½œå°†å¯¼è‡´ç”¨æˆ·å¯è§çš„æ›´æ”¹ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆåœ¨ commit é˜¶æ®µï¼Œ React éœ€è¦ä¸€æ¬¡æ€§æäº¤å¹¶å®Œæˆè¿™äº›å·¥ä½œçš„åŸå› ã€‚ è¿›å…¥åˆ°commité˜¶æ®µçš„æ—¶å€™ï¼Œä¼šéå†effect list æ’å…¥DOM -&gt; fiberèŠ‚ç‚¹ä¸Šå¢åŠ Placementçš„effect æ›´æ–°DOM -&gt; fiberèŠ‚ç‚¹ä¸Šå¢åŠ Updateçš„effect åˆ é™¤DOM -&gt; fiberèŠ‚ç‚¹ä¸Šå¢åŠ Deletionçš„effect æ›´æ–°Ref -&gt; fiberèŠ‚ç‚¹ä¸Šå¢åŠ Refçš„effect useEffectå›è°ƒæ‰§è¡Œ -&gt; fiberèŠ‚ç‚¹ä¸Šå¢åŠ Passiveçš„effect ç„¶ååœ¨renderé˜¶æ®µ -&gt; commité˜¶æ®µçš„æ—¶å€™ï¼Œä¼šä¼ é€’ä¸€æ¡effecté“¾è¡¨ï¼Œé‡Œé¢å¯èƒ½åŒ…å«äº†Placementã€Passiveç­‰ commité˜¶æ®µå¤„ç†é“¾è¡¨ä¸Šçš„æ¯ä¸ªeffect commité˜¶æ®µæœ‰ä¸‰ä¸ªå°æ®µï¼ˆå…¨ç¨‹éƒ½åœ¨éå†effectListï¼‰ï¼š 1.beforeMutationé˜¶æ®µ å¤„ç†DOMèŠ‚ç‚¹æ¸²æŸ“/åˆ é™¤åçš„ autoFocusã€blur é€»è¾‘ã€‚ è°ƒç”¨getSnapshotBeforeUpdateç”Ÿå‘½å‘¨æœŸé’©å­ã€‚ è°ƒåº¦useEffectã€‚ 2.mutationé˜¶æ®µ æ ¹æ®ContentReset effectTagé‡ç½®æ–‡å­—èŠ‚ç‚¹ æ›´æ–°ref æ ¹æ®effectTagåˆ†åˆ«è¿›è¡ŒDOMçš„å¤„ç†ï¼Œå¢åˆ æ”¹DOMï¼Œæ‰§è¡ŒuseLayoutEffect hookçš„é”€æ¯å‡½æ•°ï¼Œæ‰§è¡Œ componentWillUnmountç”Ÿå‘½å‘¨æœŸå‡½æ•° 3.layouté˜¶æ®µ commitLayoutEffectOnFiberï¼ˆè°ƒç”¨ç”Ÿå‘½å‘¨æœŸé’©å­å’Œhookç›¸å…³æ“ä½œï¼‰ componentDidMountã€ComponentDidUpdate æ‰§è¡ŒuseLayoutEffect hookçš„å›è°ƒ commitAttachRefï¼ˆèµ‹å€¼ refï¼‰ ä»¥ä¸Šä¸‰ä¸ªåœ¨ä»¥ä¸Šä¸‰ä¸ªå­é˜¶æ®µéƒ½æ‰§è¡Œå®Œæ¯•åï¼Œå¼‚æ­¥è°ƒç”¨æˆ‘ä»¬çš„useEffectçš„å›è°ƒ æ‘˜å½•è‡ªReactæ–‡æ¡£effect çš„æ‰§è¡Œæ—¶æœº (opens new window)ï¼š ä¸ componentDidMountã€componentDidUpdate ä¸åŒçš„æ˜¯ï¼Œåœ¨æµè§ˆå™¨å®Œæˆå¸ƒå±€ä¸ç»˜åˆ¶ä¹‹åï¼Œä¼ ç»™ useEffect çš„å‡½æ•°ä¼šå»¶è¿Ÿè°ƒç”¨ã€‚è¿™ä½¿å¾—å®ƒé€‚ç”¨äºè®¸å¤šå¸¸è§çš„å‰¯ä½œç”¨åœºæ™¯ï¼Œæ¯”å¦‚è®¾ç½®è®¢é˜…å’Œäº‹ä»¶å¤„ç†ç­‰æƒ…å†µï¼Œå› æ­¤ä¸åº”åœ¨å‡½æ•°ä¸­æ‰§è¡Œé˜»å¡æµè§ˆå™¨æ›´æ–°å±å¹•çš„æ“ä½œã€‚ å¯è§ï¼ŒuseEffectå¼‚æ­¥æ‰§è¡Œçš„åŸå› ä¸»è¦æ˜¯é˜²æ­¢åŒæ­¥æ‰§è¡Œæ—¶é˜»å¡æµè§ˆå™¨æ¸²æŸ“ã€‚ æ¸²æŸ“å¤§è‡´this.setStateè¢«è§¦å‘ -&gt; ï¼ˆRenderé˜¶æ®µï¼‰reconcileç®—æ³•ï¼ˆdiffç®—æ³•ï¼‰ï¼Œè®¡ç®—çŠ¶æ€å˜åŒ– -&gt; ï¼ˆCommité˜¶æ®µï¼‰ç„¶åè¿›å…¥ReactDOMæ¸²æŸ“å™¨ï¼Œå°†çŠ¶æ€å˜åŒ–æ¸²æŸ“åœ¨è§†å›¾ä¸­ã€‚ è¿™ä¸¤ä¸ªé˜¶æ®µå¯ä»¥å¸®åŠ©æˆ‘ä»¬æ›´åŠ è®¤æ¸…ç”Ÿå‘½å‘¨æœŸå‡½æ•° è°ƒç”¨ReactDOM.renderï¼ˆæ­¤æ—¶æœªè¿›å…¥ReactDOMæ¸²æŸ“å™¨ï¼Œæ˜¯Renderé˜¶æ®µï¼‰ï¼Œä¼šé‡‡ç”¨æ·±åº¦ä¼˜å…ˆéå†åˆ›å»ºfiberæ ‘ï¼ˆä¹Ÿå°±æ˜¯è™šæ‹ŸDOMæ ‘ï¼‰ï¼Œå¹¶ä¸”ä»¥æ·±åº¦ä¼˜å…ˆéå†ï¼ˆä»çˆ¶åˆ°å­ï¼ŒAPP -&gt; P1 -&gt; C1 -&gt; C2 -&gt; P2ï¼‰çš„å½¢å¼è°ƒç”¨å®ƒä»¬çš„ç”Ÿå‘½å‘¨æœŸå‡½æ•°ï¼ˆconstructorã€renderç­‰ï¼‰ è¿›å…¥Commité˜¶æ®µåï¼Œä»å­èŠ‚ç‚¹å›é€€ï¼ˆä»å­åˆ°çˆ¶,C1-&gt; C2 -&gt; P1 -&gt; P2 -&gt; APPï¼‰ï¼Œæ‰§è¡Œç”Ÿå‘½å‘¨æœŸå‡½æ•°ï¼ˆComponentDidMountã€CoponentDidUpdateç­‰ï¼‰ è€Œå…¶ä¸­Diffç®—æ³•å¸®åŠ©æˆ‘ä»¬å†³å®šè¯¥ç»„ä»¶æ˜¯å¦é‡æ–°æ¸²æŸ“/ é‡æ–°æ‰§è¡Œç”Ÿå‘½å‘¨æœŸå‡½æ•° ï¼ˆVueçš„ç”Ÿå‘½å‘¨æœŸäº¦æ˜¯å¦‚æ­¤ã€‚ï¼‰ Reactæ¸²æŸ“åçš„ç»“æ„é¦–æ¬¡æ¸²æŸ“ä¹‹åï¼ŒReact ä¼šç”Ÿæˆä¸€ä¸ªå¯¹åº”äº UI æ¸²æŸ“çš„ fiber æ ‘ï¼Œç§°ä¹‹ä¸º current æ ‘ï¼Œä¹Ÿå°±æ˜¯åˆšæ‰æˆ‘ä»¬åœ¨renderé˜¶æ®µæ‰€è®²çš„ï¼Œæˆ‘ä»¬æƒ³è¦åšçš„æ“ä½œï¼Œåšä»€ä¹ˆä»»åŠ¡ï¼Œä»¥åŠä¼šè°ƒç”¨åˆ°çš„ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ä½œä¸ºä¿¡æ¯ä¿å­˜åœ¨ fiberèŠ‚ç‚¹æ ‘ä¸Šã€‚ å½“ React éå† current æ ‘æ—¶ï¼Œå®ƒä¼šä¸ºæ¯ä¸€ä¸ªå­˜åœ¨çš„ fiber èŠ‚ç‚¹åˆ›å»ºäº†ä¸€ä¸ªæ›¿ä»£èŠ‚ç‚¹ï¼Œè¿™äº›æ›¿ä»£èŠ‚ç‚¹å½¢æˆ workInProgress æ ‘ï¼Œåç»­çš„å˜æ›´åœ¨workInProgress æ ‘ä¸Šæ‰§è¡Œï¼Œå½“ workInProgress æ ‘è¢«æäº¤åå°†ä¼šåœ¨ commit é˜¶æ®µçš„æŸä¸€å­é˜¶æ®µè¢«æ›¿æ¢æˆä¸º current æ ‘ã€‚ æ¯æ¬¡çŠ¶æ€æ›´æ–°éƒ½ä¼šäº§ç”Ÿæ–°çš„workInProgress Fiberæ ‘ï¼Œé€šè¿‡currentä¸workInProgressçš„æ›¿æ¢ï¼Œå®ŒæˆDOMæ›´æ–°ã€‚ å¤šå»ºä¸€æ£µæ ‘æ˜¯ä¸ºäº†åšç¼“å­˜ï¼Œä¿éšœæ„å»ºå’Œç»˜åˆ¶çš„æµç•…æ€§ Effect List React é‡‡ç”¨DFSï¼Œåœ¨ render é˜¶æ®µéå† fiber æ ‘æ—¶ï¼ŒæŠŠæ¯ä¸€ä¸ªæœ‰å‰¯ä½œç”¨çš„ fiber ç­›é€‰å‡ºæ¥ï¼Œæœ€åæ„å»ºç”Ÿæˆä¸€ä¸ªåªå¸¦å‰¯ä½œç”¨çš„ effect list é“¾è¡¨ã€‚ ä¸ºä»€ä¹ˆæœ‰Effect Listå‘¢ï¼Œå› ä¸ºMountç”Ÿå‘½å‘¨æœŸå¯¹åº”çš„æ˜¯HooksDispatcherOnMountï¼Œé‡Œé¢æœ‰å®ƒè‡ªå·±çš„useStateã€useEffectï¼›updateç”Ÿå‘½å‘¨æœŸå¯¹åº”çš„æ˜¯HooksDispatcherOnUpdateï¼Œé‡Œé¢ä¹Ÿæœ‰å®ƒè‡ªå·±çš„useStateã€useEffectï¼Œè€Œå…¶ä¸­ä»–ä»¬çš„useEffectå½¢æˆçš„é“¾è¡¨å°±å½¢æˆeffect list è¿™é‡Œæœ‰ä»fiberæ ‘åˆ°Effect Listæ„å»ºè¿‡ç¨‹çš„è§†é¢‘ https://www.bilibili.com/video/av48384879/ å€Ÿç”¨Reactå›¢é˜Ÿæˆå‘˜Dan Abramovçš„è¯ï¼šeffectListç›¸è¾ƒäºFiberæ ‘ï¼Œå°±åƒåœ£è¯æ ‘ä¸ŠæŒ‚çš„é‚£ä¸€ä¸²å½©ç¯ã€‚ åˆ†ç‰‡æ›´æ–°çš„å½±å“è¿™ä¼šå¯¼è‡´å•¥? ä¸€æ¬¡æ›´æ–°åˆ†æˆå¤šä¸ªåˆ†ç‰‡ï¼Œæ‰€ä»¥å®Œå…¨æœ‰å¯èƒ½ä¸€ä¸ªæ›´æ–°ä»»åŠ¡è¿˜æ²¡å®Œæˆï¼Œå°±è¢«é«˜ä¼˜å…ˆçº§çš„ä»»åŠ¡æ‰“æ–­ï¼Œä»è€Œä¹‹å‰çš„å·¥ä½œä½œåºŸã€‚ å› æ­¤å¦‚æœä½ ä½¿ç”¨çš„æ˜¯ç±»å¼ç»„ä»¶ï¼ˆå¸¦ç”Ÿå‘½å‘¨æœŸå‡½æ•°ï¼‰ï¼Œä½ ä¼šå‘ç°ï¼šåœ¨React Fiberä¸­ï¼Œä¸å†æ˜¯è¿™æ ·äº†ï¼Œç¬¬ä¸€é˜¶æ®µä¸­çš„ç”Ÿå‘½å‘¨æœŸå‡½æ•°ï¼ˆrenderé˜¶æ®µçš„ç”Ÿå‘½å‘¨æœŸå‡½æ•°ï¼‰åœ¨ä¸€æ¬¡åŠ è½½å’Œæ›´æ–°è¿‡ç¨‹ä¸­å¯èƒ½ä¼šè¢«å¤šæ¬¡è°ƒç”¨ï¼ React Diffæ­£å¸¸çš„å®Œå…¨å¯¹æ¯”ç®—æ³•æ˜¯O(n^3) Reactå¯¹diffçš„ä¸‰ä¸ªé™åˆ¶ï¼ˆä¼˜åŒ–ï¼‰ï¼š åªå¯¹æ¯”åŒå±‚çº§èŠ‚ç‚¹ å…ƒç´ ç±»å‹æ”¹å˜ä¹‹åï¼Œå°†æœ¬èº«åŠå…¶å­å­™ä¸€åŒé”€æ¯ é€šè¿‡keyã€propä¿æŒdiffçš„ç¨³å®šæ€§ çœ‹å®Œä¹‹åæ„Ÿè§‰å’ŒVueçš„å·®ä¸å¤šï¼Œä½†æ˜¯ç”±äºfiberæ˜¯å•é“¾è¡¨ï¼Œæ‰€ä»¥å¥½åƒä¸èƒ½å’ŒVueä¸€æ ·ä½¿ç”¨åŒæŒ‡é’ˆçš„ä¼˜åŒ–æ–¹æ¡ˆ å‚è€ƒé“¾æ¥ï¼š https://zhuanlan.zhihu.com/p/26027085 https://zhuanlan.zhihu.com/p/179934120 https://react.iamkasong.com/","categories":[{"name":"å‰ç«¯","slug":"å‰ç«¯","permalink":"https://taylor12138.github.io/categories/%E5%89%8D%E7%AB%AF/"}],"tags":[],"author":"Hello"},{"title":"JSå†…ç½®å¯¹è±¡å’ŒåŒ…è£…","slug":"JSå†…ç½®å¯¹è±¡å’ŒåŒ…è£…","date":"2021-08-31T16:00:00.000Z","updated":"2023-04-17T06:54:51.394Z","comments":true,"path":"2021/09/01/js-nei-zhi-dui-xiang-he-bao-zhuang/","link":"","permalink":"https://taylor12138.github.io/2021/09/01/js-nei-zhi-dui-xiang-he-bao-zhuang/","excerpt":"","text":"1.å†…ç½®å¯¹è±¡JavaScriptä¸­å¯¹è±¡åˆ†ä¸ºè‡ªå®šä¹‰å¯¹è±¡ï¼Œå†…ç½®å¯¹è±¡ï¼Œæµè§ˆå™¨å¯¹è±¡ï¼Œå‰ä¸¤ç§å±äºECMAScriptï¼›ç¬¬ä¸‰ä¸ªæµè§ˆå™¨å¯¹è±¡æ˜¯jsç‰¹æœ‰çš„ Javascriptæä¾›äº†å¤šä¸ªå’Œå†…ç½®å¯¹è±¡ï¼šMathã€Dateã€Arrayã€String å¯ä»¥é€šè¿‡MDN/W3Cæ¥æŸ¥è¯¢å†…ç½®å¯¹è±¡çš„ä½¿ç”¨ MDNçš„ç½‘å€ï¼šhttps://developer.mozilla.org/zh-CN/ ï¼ˆ1ï¼‰Mathå¯¹è±¡ æ–¹æ³• å‚æ•° æ•ˆæœ Math.abs(x) ä¸€ä¸ªæ•°å€¼ å¾—åˆ°ç»å¯¹å€¼ï¼Œå¹¶ä¸”ä¼šéšå¼è½¬æ¢æ¯”å¦‚â€™-1â€™ -&gt; 1, â€˜pink -&gt; NANâ€™ Math.PI åœ†å‘¨ç‡ Math.floor(x) ä¸€ä¸ªæ•°å€¼ å‘ä¸‹å–æ•´ Math.ceil(x) ä¸€ä¸ªæ•°å€¼ å‘ä¸Šå–æ•´ Math.round(x) ä¸€ä¸ªæ•°å€¼ å››èˆäº”å…¥ Math.max(value1[,value2, ...]) ä¸€ç»„æ•°å€¼ æœ€å¤§å€¼, xä¸º0æˆ–å¤šä¸ªå€¼ã€‚åœ¨ ECMASCript v3 ä¹‹å‰ï¼Œè¯¥æ–¹æ³•åªæœ‰ä¸¤ä¸ªå‚æ•°ã€‚ Math.min(value1[,value2, ...) ä¸€ç»„æ•°å€¼ æœ€å°å€¼ï¼ŒåŒä¸Š Math.random() è¿”å›ä¸€ä¸ªæµ®ç‚¹æ•°, ä¼ªéšæœºæ•°åœ¨èŒƒå›´ä»0åˆ°å°äº1 Math.sqrt(x) ä¸€ä¸ªæ•°å€¼ è¿”å›ä¸€ä¸ªæ•°çš„å¹³æ–¹æ ¹ Math.pow(x, y) ä¸¤ä¸ªæ•°å€¼ è¿”å›åŸºæ•°ï¼ˆxï¼‰çš„æŒ‡æ•°ï¼ˆyï¼‰æ¬¡å¹‚ //å®ç°ä¸¤ä¸ªæ•°ä¹‹é—´çš„éšæœºæ•´æ•° Math.floor(Math.random()*(x_max-x_min+1))+x_min å‡½æ•° toFixed(n) å°†æ•°å­—èˆå…¥ï¼ˆå››èˆäº”å…¥ï¼‰åˆ°å°æ•°ç‚¹å n ä½ï¼Œå¹¶ä»¥å­—ç¬¦ä¸²å½¢å¼è¿”å›ç»“æœã€‚å¦‚æœåç»­è¿˜æƒ³å†ç”¨è¯¥æ•°å­—ï¼Œè®°å¾—è½¬å›number let num = 12.34; alert( num.toFixed(1) ); // \"12.3\" ï¼ˆ2ï¼‰Dateå¯¹è±¡æ˜¯ä¸€ä¸ªæ„é€ å‡½æ•°ï¼Œå¯ä»¥ä½¿ç”¨newè°ƒç”¨ï¼ˆä½†ä¹Ÿå¯ä»¥ç›´æ¥è°ƒç”¨å…¶æ–¹æ³•ï¼‰ æ–¹æ³• æ•ˆæœ new Date() è¿”å›ä¸€ä¸ªæ ‡å‡†æ—¶é—´ï¼ˆå¤æ‚çš„å­—ç¬¦ä¸²ç»“æ„ï¼‰ Date.now() è¿”å›ä¸€ä¸ªnumberï¼Œè‡ª 1970 å¹´ 1 æœˆ 1 æ—¥ 00:00:00 (UTC) åˆ°å½“å‰æ—¶é—´çš„æ¯«ç§’æ•°ï¼ŒH5æ–°å¢ new Date(xx).getFullYear() è¿”å›å¹´ä»½ new Date(xx).getMonth()+1 è¿”å›æœˆä»½ new Date(xx).getDate() è¿”å›æ—¥æœŸ new Date(xx).getHours() è¿”å›æ—¶ new Date(xx).getMinutes() è¿”å›åˆ† new Date(xx).getSeconds() è¿”å›ç§’ new Date(xx).valueOf() è¿”å›ä»1970å¹´1æœˆ1æ—¥0æ—¶0åˆ†0ç§’ï¼ˆUTCï¼Œå³åè°ƒä¸–ç•Œæ—¶ï¼‰åˆ°è¯¥æ—¥æœŸçš„æ¯«ç§’æ•°ã€‚ new Date(xx).getTime() åŒä¸Š var date = new Date(); //æ— å‚æ•°ï¼Œè¿”å›å½“å‰ç³»ç»Ÿçš„æ—¶é—´,å¤æ‚çš„å­—ç¬¦ä¸²ç»“æ„ //å¸¸ç”¨çš„ä¸¤ç§æ—¶é—´å†™æ³• var date = new Date(2020, 10, 1); //æŒ‡å®šå›ºå®šæ—¥æœŸ var date = new Date('2020-10-1 8:8:8'); var d=new Date().toLocaleTimeString() //æœ¬åœ°æ—¶é—´æŠŠ Date å¯¹è±¡çš„æ—¶é—´éƒ¨åˆ†è½¬æ¢ä¸ºå­—ç¬¦ä¸² ç”±äºå¼€å‘ä¸­æ—¶é—´æˆ³è½¬æ¢ä¸ºæ—¥æœŸå¤ªè¿‡äºå¸¸è§ï¼Œæ‰€ä»¥ç½‘ä¸Šæœ‰ç›´æ¥å°è£…å¥½çš„ï¼ˆä½¿ç”¨çš„æ˜¯æ­£åˆ™è¡¨è¾¾å¼ï¼‰çš„å‡½æ•°ï¼Œç›´æ¥æ ¼å¼åŒ–å³å¯ æ—¥æœŸç±»è½¬æ¢åˆ°åŸå§‹å€¼èƒ½ä½¿ç”¨ toString() æ³¨æ„ï¼šconst date = new Date(&#39;2020-10-1 8:8:8&#39;);è¿™ç§å†™æ³•ï¼Œä¼šå¯¼è‡´å®‰å“ç«¯å’Œiosç«¯çš„æ—¶é—´ä¸Šæœ‰æ‰€ä¸åŒï¼Œå¹¶ä¸”æœ‰æ˜æ˜¾çš„å·®å¼‚ï¼ï¼æœ€å¥½ä»¥ const birthday = new Date(1995, 11, 17, 3, 24, 0);çš„å½¢å¼è¿›è¡Œå‘½å const date = new Date(&#39;2020/10/1 8:8:8&#39;);ä¹Ÿå¯ä»¥ï¼Œä½†æ˜¯å…¼å®¹æ€§å¥½è±¡ä¸å¦‚é€—å·åˆ†éš”çš„å½¢å¼ æ·±ç©¶ 1.è¯¥é—®é¢˜ä»è¡¨é¢ä¸Šçœ‹ï¼Œæ˜¯Chromeæµè§ˆå™¨å’ŒSafariå¯¹åŒä¸€JavaScriptä»£ç ç‰‡æ®µè§£æä¸åŒé€ æˆ 2.å‘ç°ç»è¿‡è°ƒæŸ¥å‘ç°ï¼Œ iOS ä¸Šä½¿ç”¨çŸ­æ¨ªæ åˆ†å‰²æ—¥æœŸæ—¶ï¼ŒJS å¼•æ“ä¼šè‡ªåŠ¨ä»¥ ISO 8601 æ—¥æœŸæ—¶é—´è¡¨ç¤ºæ–¹æ³•å»è§£æè¿™ä¸ªå­—ç¬¦ä¸²ï¼Œä½†å› ä¸º ISO 8601 çš„æ ‡å‡†æ ¼å¼ä¸º YYYY-MM-DDTHH:mm:ss.sssZï¼ˆå‚è€ƒ ECMAScript Language Specification)ï¼Œæ‰€ä»¥å°±å¯¼è‡´äº†è§£æå¤±è´¥çš„æƒ…å†µå‡ºç°ã€‚ 3.å¯¹äº iOS ä¸‹çš„å‰ç«¯é¡¹ç›®ï¼Œæ— è®ºæ˜¯æ™®é€šçš„ç½‘é¡µé¡¹ç›®è¿˜æ˜¯å°ç¨‹åºé¡¹ç›®ï¼Œéƒ½è¦å°å¿ƒå¤„ç† Date å­—ç¬¦ä¸²ï¼Œå®ƒä»¬ä½¿ç”¨ iOS çš„ webkit å†…æ ¸ï¼Œæ‰€æœ‰éƒ½å­˜åœ¨åŒæ ·çš„å…¼å®¹æ€§é—®é¢˜ã€‚ å¹³æ—¶æˆ‘ä»¬çœ‹åˆ°çš„çš„æ˜¯RFC2822 æ ¼å¼ ECMAScriptåŸºäºISO 8601 çš„æ ‡å‡†æ ¼å¼ä¸º YYYY-MM-DDTHH:mm:ss.sssZ æ‰€ä»¥æˆ‘ä»¬ç¡¬è¦å†™â€œ-â€ï¼Œåº”è¯¥å†™ä¸ºï¼ˆåŒ—äº¬æ—¶åŒºæ˜¯GMT+08:00ï¼Œä¹Ÿå°±æ˜¯æœ¬åˆå­åˆçº¿ + 8å°æ—¶ï¼‰ new Date(&#39;2021-08-26T12:00:00+08:00&#39;) å®˜æ–¹æ¨èï¼šå› æ­¤æœ€å¥½è¿˜æ˜¯æ‰‹åŠ¨è§£ææ—¥æœŸå­—ç¬¦ä¸²ï¼ˆåœ¨éœ€è¦é€‚åº”ä¸åŒæ ¼å¼æ—¶åº“èƒ½èµ·åˆ°å¾ˆå¤§å¸®åŠ©ï¼‰ã€‚* æ¨èçš„ä¸€ä¸ªæ—¶é—´åº“ï¼šhttp://momentjs.cn/docs/ ï¼ˆ3ï¼‰Arrayå¯¹è±¡å¡«å……æ•°ç»„ æ•°ç»„çš„æ¯ä¸ªæ§½ä½å¯ä»¥å‚¨å­˜ä»»æ„ç±»å‹æ•°æ® var arr1 = new Array(2,3); //ç›¸å½“äº[2,3]çš„æ•°ç»„ var arr = new Array(5).fill(); //åˆ›é€ ä¸€ä¸ªæ•°ç»„é•¿åº¦ä¸º5çš„æ•°ç»„ï¼Œä½†æ˜¯æ­¤æ–¹æ³•ä¼šè‡ªåŠ¨å¾€é‡Œé¢å¡«undefinedå€¼ï¼Œè®©æ•°ç»„æœ€èµ·ç æœ‰å€¼äº†ï¼ var arr = new Array(5).fill(0);//ä¹Ÿå¯ä»¥å¡«å†™ä½ æƒ³è¦çš„å€¼ï¼Œæ¯”å¦‚0 ä½†æ˜¯å¦‚æœæƒ³åˆ›å»ºä¸€ä¸ªç”¨ç©ºå¯¹è±¡å¡«å……çš„æ•°ç»„è¯ï¼Œå®é™…ä¸Šæˆ‘ä»¬åœ¨ä½¿ç”¨åŒä¸€ä¸ª ç©ºå¯¹è±¡ / ç©ºæ•°ç»„è¿›è¡ŒæåŸƒå¡«å……ï¼Œè¿™æ ·ä¼šé€ æˆä»–ä»¬éƒ½æ˜¯è”åŠ¨çš„ï¼Œç‰µä¸€å‘è€ŒåŠ¨å…¨èº« let a = new Array(5).fill({}); console.log(a); // [{}, {}, {}, {}, {}] a[0].name = 'å¼ ä¸‰'; console.log(a); // [{name: \"å¼ ä¸‰\"}, {name: \"å¼ ä¸‰\"}, {name: \"å¼ ä¸‰\"}, {name: \"å¼ ä¸‰\"}, {name: \"å¼ ä¸‰\"}] ä½†æ˜¯å¯ä»¥ä½¿ç”¨è¿™ä¸ªæ–¹æ³•åˆ›å»ºäºŒç»´æ•°ç»„ï¼ˆæ¥æ”¶ä¸€ä¸ªå‡½æ•°ï¼Œç”¨æ¥å¯¹æ¯ä¸ªå…ƒç´ è¿›è¡Œå¤„ç†ï¼Œå°†å¤„ç†åçš„å€¼æ”¾å…¥è¿”å›çš„æ•°ç»„ï¼‰ const arr = Array.from(Array(n), () => Array(m).fill(0)); const arr2 = new Array(n).fill(0).map(() => new Array(m).fill(0)); //fromçš„ä½¿ç”¨ console.log(Array.from('foo')); // expected output: Array [\"f\", \"o\", \"o\"] console.log(Array.from([1, 2, 3], x => x + x)); // expected output: Array [2, 4, 6] åˆ é™¤ / è¿æ¥æ•°ç»„ arr.splice(2,1,\"William\"); //ä»indexåºå·ä¸º2åœ°å¼€å§‹ï¼Œåˆ é™¤æ‰ä¸€ä¸ªï¼Œå¹¶æ·»åŠ williamå…ƒç´  arr.concat(arrayX, arrayX, arryX) //concat()å‚æ•°å¯ä»¥ä¼ å…¥æ•°ç»„æˆ–è€…å€¼ã€‚ // å®ƒå¯ä»¥è¿æ¥ä¸¤ä¸ªæˆ–å¤šä¸ªæ•°ç»„ æ’åºarr1.sort(function(a,b) { return a-b; //ä»å°åˆ°å¤§ }); //è¯¥æ’åºå¯èƒ½æ˜¯å¿«æ’ç­‰ç»“åˆçš„å¾ˆä¼˜ç®—æ³•ã€‚å‡åº å¦‚æœä¸åŠ functionåˆ™ä¸ºæŒ‰ç…§å­—ç¬¦ä¸²æ’åº arr.sort([compareFunction])ï¼Œå›å½±å“åˆ°åŸæ¥çš„æ•°ç»„ compareFunction å¯é€‰ ç”¨æ¥æŒ‡å®šæŒ‰æŸç§é¡ºåºè¿›è¡Œæ’åˆ—çš„å‡½æ•°ã€‚å¦‚æœçœç•¥ï¼Œå…ƒç´ æŒ‰ç…§è½¬æ¢ä¸ºçš„å­—ç¬¦ä¸²çš„å„ä¸ªå­—ç¬¦çš„Unicodeä½ç‚¹è¿›è¡Œæ’åºã€‚ firstEl ç¬¬ä¸€ä¸ªç”¨äºæ¯”è¾ƒçš„å…ƒç´ ã€‚ secondEl ç¬¬äºŒä¸ªç”¨äºæ¯”è¾ƒçš„å…ƒç´ ã€‚ å¦‚æœ compareFunction(a, b) å°äº 0 ï¼Œé‚£ä¹ˆ a ä¼šè¢«æ’åˆ—åˆ° b ä¹‹å‰ï¼› å¦‚æœ compareFunction(a, b) ç­‰äº 0 ï¼Œ a å’Œ b çš„ç›¸å¯¹ä½ç½®ä¸å˜ã€‚å¤‡æ³¨ï¼š ECMAScript æ ‡å‡†å¹¶ä¸ä¿è¯è¿™ä¸€è¡Œä¸ºï¼Œè€Œä¸”ä¹Ÿä¸æ˜¯æ‰€æœ‰æµè§ˆå™¨éƒ½ä¼šéµå®ˆï¼ˆä¾‹å¦‚ Mozilla åœ¨ 2003 å¹´ä¹‹å‰çš„ç‰ˆæœ¬ï¼‰ï¼› å¦‚æœ compareFunction(a, b) å¤§äº 0 ï¼Œ b ä¼šè¢«æ’åˆ—åˆ° a ä¹‹å‰ã€‚ compareFunction(a, b) å¿…é¡»æ€»æ˜¯å¯¹ç›¸åŒçš„è¾“å…¥è¿”å›ç›¸åŒçš„æ¯”è¾ƒç»“æœï¼Œå¦åˆ™æ’åºçš„ç»“æœå°†æ˜¯ä¸ç¡®å®šçš„ã€‚ V8æ’åºç­–ç•¥æ’åºç­–ç•¥å¤§æ¦‚æ˜¯ï¼š è®¾è¦æ’åºçš„å…ƒç´ ä¸ªæ•°æ˜¯nï¼š å½“ n &lt;= 10 æ—¶ï¼Œé‡‡ç”¨ä¼˜åŒ–çš„æ’å…¥æ’åº å½“ n &gt; 10 æ—¶ï¼Œé‡‡ç”¨ ä¸‰è·¯å¿«é€Ÿæ’åº 10 &lt; n &lt;= 1000, é‡‡ç”¨ä¸­ä½æ•°ä½œä¸ºå“¨å…µå…ƒç´  n &gt; 1000, æ¯éš” 200~215 ä¸ªå…ƒç´ æŒ‘å‡ºä¸€ä¸ªå…ƒç´ ï¼Œæ”¾åˆ°ä¸€ä¸ªæ–°æ•°ç»„ï¼Œç„¶åå¯¹å®ƒæ’åºï¼Œæ‰¾åˆ°ä¸­é—´ä½ç½®çš„æ•°ï¼Œä»¥æ­¤ä½œä¸ºä¸­ä½æ•° å…¶ä»– æ–¹æ³• å‚æ•° æ•ˆæœ arr instanceof Array æ£€éªŒæ˜¯å¦ä¸ºæ•°ç»„ï¼Œæ˜¯è¿”å›trueï¼Œå¦åˆ™false Array.isArray(x); æ•°ç»„ åŒä¸Š,H5æ–°å¢,ä½†è¿™ä¸ªæ•ˆæœå¥½ï¼Œé˜²æ­¢å¤šä¸ªä¸åŒç‰ˆæœ¬çš„Arrayæ„é€ å‡½æ•° arr.push(xx); nä¸ªå…ƒç´  åœ¨æ•°ç»„æœ«å°¾å¢åŠ æ•°ç»„å…ƒç´ ï¼Œè¿”å›ç»“æœæ˜¯æ–°æ•°ç»„çš„é•¿åº¦ arr.unshift(xx); nä¸ªå…ƒç´  åœ¨æ•°ç»„å¼€å¤´å¢åŠ æ•°ç»„å…ƒç´ ï¼Œè¿”å›ç»“æœæ˜¯æ–°æ•°ç»„çš„é•¿åº¦ arr.pop(); åˆ é™¤æ•°ç»„çš„æœ€åä¸€ä¸ªå…ƒç´  è¿”å›å€¼ä¸ºè¢«åˆ é™¤çš„å…ƒç´ å€¼ arr.shift(); åˆ é™¤æ•°ç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´  è¿”å›å€¼ä¸ºè¢«åˆ é™¤çš„å…ƒç´ å€¼ arr.reverse() ç¿»è½¬æ•°ç»„ï¼Œè¿”å›é¢ å€’åçš„æ•°ç»„ï¼Œè¯¥æ–¹æ³•ä¼šæ”¹å˜åŸæ•°ç»„ã€‚ arr.indexOf(xx) 1.æŸ¥æ‰¾çš„å…ƒç´ ï¼›2.æŸ¥æ‰¾å¼€å§‹å¤„ï¼ˆå¯é€‰ï¼‰ è¿”å›è¯¥æ•°ç»„å…ƒç´ çš„ç´¢å¼•å·ï¼ˆç¬¬ä¸€ä¸ªæ»¡è¶³æ¡ä»¶çš„ç´¢å¼•å·ï¼‰ï¼Œæ‰¾ä¸åˆ°è¿”å›-1ã€‚ arr.includes(xx) 1.æŸ¥æ‰¾çš„å…ƒç´ ï¼›2.æŸ¥æ‰¾å¼€å§‹å¤„ï¼ˆå¯é€‰ï¼‰ è¿”å›å¸ƒå°”å€¼æ˜¯å¦å«æœ‰è¯¥å…ƒç´ ï¼Œåˆ¤æ–­å…ƒç´ æ˜¯å¦å­˜åœ¨ arr.lastindexOf(xx) 1.æŸ¥æ‰¾çš„å…ƒç´ ï¼›2.æŸ¥æ‰¾å¼€å§‹å¤„ï¼ˆå¯é€‰ï¼Œä»æ­¤ä½ç½®å¼€å§‹é€†å‘æŸ¥æ‰¾ï¼‰ è¿”å›è¯¥æ•°ç»„å…ƒç´ çš„ç´¢å¼•å·ï¼ˆæœ€åä¸€ä¸ªæ»¡è¶³æ¡ä»¶çš„ç´¢å¼•å·ï¼‰ï¼Œä»åå¾€å‰æ‰¾ï¼Œæ‰¾ä¸åˆ°è¿”å›-1ã€‚ arr.toString() è½¬æ¢æˆå­—ç¬¦ä¸²ï¼Œé€—å·åˆ†éš” arr.join(x); åˆ†éš”ç¬¦ ç”¨æŒ‡å®šåˆ†éš”ç¬¦åˆ†å‰²ä¸åŒçš„æ•°ç»„å…ƒç´ ï¼Œå¹¶è½¬æ¢æˆå­—ç¬¦ä¸² arr.splice(i, n, [x3, x4]) 1.å¼€å§‹ä¸‹æ ‡ï¼›2.åˆ é™¤çš„å…ƒç´ ä¸ªæ•°ï¼›3.æ·»åŠ è¿›æ•°ç»„çš„å…ƒç´ ï¼ˆå¯é€‰ï¼Œå¯ä»¥å¤šä¸ªï¼Œæ·»åŠ çš„ç¬¬ä¸€ä¸ªä¸ºå¼€å§‹ä¸‹æ ‡ï¼‰ ç”¨äºåˆ é™¤å¤šç»„å…ƒç´ å¹¶ä¸”æ·»åŠ æ–°å…ƒç´ ï¼Œè¿”å›ä¸€ä¸ªæ•°ç»„ä¿å­˜å†…å®¹ï¼ˆæ­¤æ–¹æ³•ä¼šæ”¹å˜åŸæ•°ç»„ã€‚ï¼‰ arr.slice([begin[, end]]) 1.æå–èµ·å§‹å¤„çš„ç´¢å¼•ï¼Œ2.ç»ˆæ­¢ç´¢å¼•ï¼ˆä¸åŒ…å«endï¼‰ è¿”å›ä¸€ä¸ªæ–°çš„æ•°ç»„å¯¹è±¡ï¼Œè¿™ä¸€å¯¹è±¡æ˜¯ä¸€ä¸ªç”± begin å’Œ end å†³å®šçš„åŸæ•°ç»„çš„æµ…æ‹·è´ï¼ˆä» beginåˆ° end-1 ï¼Œä¸åŒ…æ‹¬endï¼‰ï¼›å¯ä»¥ä¼ å…¥è´Ÿæ•°ï¼Œè¿™æ˜¯ä»ç»“å°¾å¼€å§‹æˆªå–ã€‚åŸå§‹æ•°ç»„ä¸ä¼šè¢«æ”¹å˜ã€‚ arr.concat(value1[, value2[, ...[, valueN]]]) å¯ä¼ å…¥1ä¸ª/å¤šä¸ªæ•°ç»„æˆ–è€…å€¼ ç”¨äºåˆå¹¶ä¸¤ä¸ªæˆ–å¤šä¸ªæ•°ç»„ã€‚æ­¤æ–¹æ³•ä¸ä¼šæ›´æ”¹ç°æœ‰æ•°ç»„ï¼Œè€Œæ˜¯è¿”å›ä¸€ä¸ªæ–°æ•°ç»„ã€‚ arr.from(.from(arrayLike[, mapFn[, thisArg]])); æƒ³è¦è½¬æ¢æˆæ•°ç»„çš„ä¼ªæ•°ç»„å¯¹è±¡æˆ–å¯è¿­ä»£å¯¹è±¡ã€‚ ä»ä¸€ä¸ªç±»ä¼¼æ•°ç»„æˆ–å¯è¿­ä»£å¯¹è±¡åˆ›å»ºä¸€ä¸ªæ–°çš„ï¼Œæµ…æ‹·è´çš„æ•°ç»„å®ä¾‹ã€‚ arr.flat() ç›´æ¥æ‰å¹³åŒ–å¤šç»´æ•°ç»„ -&gt; ä¸€ç»´æ•°ç»„ arr.find(callback[,thisArg]) callbackä¸ºæ¯ä¸€é¡¹æ‰§è¡Œçš„å‡½æ•°ï¼Œå¯ä»¥ç±»æ¯”åˆ°forEachçš„callbackï¼Œå‡½æ•°ä¸­è¿”å›trueåˆ™è¿”å›è¯¥element è¿”å›æ•°ç»„ä¸­æ»¡è¶³æ¡ä»¶çš„ç¬¬ä¸€ä¸ªå…ƒç´ çš„å€¼ï¼Œå¦‚æœæ²¡æœ‰ï¼Œè¿”å›undefined arr.findIndex() åŒä¸Š åŒä¸Šï¼Œæ‰¾çš„æ˜¯ç´¢å¼•å€¼ 2.Objectéƒ¨åˆ†æ–¹æ³•Object.createObject.create(proto[, propertiesObject]) protoå¿…å¡«å‚æ•°ï¼Œæ˜¯æ–°å¯¹è±¡çš„åŸå‹å¯¹è±¡ã€‚æ³¨æ„ï¼Œå¦‚æœè¿™ä¸ªå‚æ•°æ˜¯nullï¼Œé‚£æ–°å¯¹è±¡å°±å½»å½»åº•åº•æ˜¯ä¸ªç©ºå¯¹è±¡ï¼Œæ²¡æœ‰ç»§æ‰¿Object.prototypeä¸Šçš„ä»»ä½•å±æ€§å’Œæ–¹æ³•ï¼Œå¦‚hasOwnProperty()ã€toString()ç­‰ã€‚ propertiesObjectæä¾›ä¸€ç³»åˆ—é™„åŠ åŠŸèƒ½ï¼ŒæŒ‡æ˜æ¯ä¸ªå±æ€§å¯¹åº”çš„ç‰¹æ€§ const person = { isHuman: false, printIntroduction: function () { console.log(`My name is ${this.name}. Am I human? ${this.isHuman}`); } }; const me = Object.create(person); // me.__proto__ === person me.name = \"Matthew\"; // nameå±æ€§è¢«è®¾ç½®åœ¨æ–°å¯¹è±¡meä¸Šï¼Œè€Œä¸æ˜¯ç°æœ‰å¯¹è±¡personä¸Š me.isHuman = true; // ç»§æ‰¿çš„å±æ€§å¯ä»¥è¢«é‡å†™ me.printIntroduction(); // My name is Matthew. Am I human? true ä½¿ç”¨ Object.create()å®ç°å®Œç¾ç»§æ‰¿æœºåˆ¶ // å­ç±»ç»­æ‰¿çˆ¶ç±» Rectangle.prototype = Object.create(Shape.prototype); Rectangle.prototype.constructor = Rectangle; æ‰‹å†™Object.create() Object.mycreate = function(proto, properties) { function F() {}; F.prototype = proto; if(properties) { Object.defineProperties(F, properties); } return new F(); } /*å…¶å®ä¹Ÿå¯ä»¥ç®€åŒ–æˆ Object.mycreate = function(proto, properties) { function F() {}; F.prototype = proto; F.prototype.constructor = F; return new F(); } */ var hh = Object.mycreate({a: 11}, {mm: {value: 10}}); console.dir(hh); Object.keys(obj)Object.keys(obj) å‚æ•° obj è¦è¿”å›å…¶æšä¸¾è‡ªèº«å±æ€§çš„å¯¹è±¡ã€‚ è¿”å›å€¼ ä¸€ä¸ªè¡¨ç¤ºç»™å®šå¯¹è±¡çš„æ‰€æœ‰å¯æšä¸¾å±æ€§çš„å­—ç¬¦ä¸²æ•°ç»„ã€‚ å¦‚æœä½ æƒ³è·å–ä¸€ä¸ªå¯¹è±¡çš„æ‰€æœ‰å±æ€§,ï¼Œç”šè‡³åŒ…æ‹¬ä¸å¯æšä¸¾çš„ï¼Œè¯·æŸ¥çœ‹Object.getOwnPropertyNamesã€‚ï¼ˆçº¢å®ä¹¦ï¼‰ Object.is()Object.is()ç¡®å®šä¸¤ä¸ªå€¼æ˜¯å¦ç›¸åŒã€‚å¦‚æœä»¥ä¸‹æ¡ä»¶ä¹‹ä¸€æˆç«‹ï¼Œåˆ™ä¸¤ä¸ªå€¼ç›¸åŒï¼š ä¸¤è€… undefined ä¸¤è€… null ä¸¤è€…trueæˆ–ä¸¤è€…false ç›¸åŒé•¿åº¦çš„ä¸¤ä¸ªå­—ç¬¦ä¸²ä»¥ç›¸åŒçš„é¡ºåºå…·æœ‰ç›¸åŒçš„å­—ç¬¦ ä¸¤è€…éƒ½æ˜¯åŒä¸€ä¸ªå¯¹è±¡ï¼ˆæ„å‘³ç€ä¸¤ä¸ªå€¼éƒ½å¼•ç”¨äº†å†…å­˜ä¸­çš„åŒä¸€ä¸ªå¯¹è±¡ï¼‰ æ•°å­—å’Œ ä¸¤è€… +0 ä¸¤è€… -0 ä¸¤è€… NaN æˆ–ä¸¤è€…éƒ½éé›¶ä¸”ä¸¤è€…éƒ½ä¸æ˜¯NaNä¸”ä¸¤è€…éƒ½å…·æœ‰ç›¸åŒçš„å€¼ è¿™æ˜¯ä¸ä¸€æ ·æ ¹æ®ç­‰äº ==è¿ç®—ç¬¦ã€‚è¯¥ ==è¿è¥å•†åº”ç”¨å„ç§å¼ºåˆ¶è½¬æ¢åŒæ–¹ï¼ˆå¦‚æœå®ƒä»¬ä¸æ˜¯åŒä¸€ç±»å‹ï¼‰æµ‹è¯•ç›¸ç­‰ï¼ˆå¯¼è‡´è¿™ç§è¡Œä¸ºåƒä»¥å‰ä¸€æ · &quot;&quot; == falseæ˜¯trueï¼‰ï¼Œä½†Object.isä¸å¼ºè¿«ä»»ä½•ä¸€ä¸ªå€¼ã€‚ è¿™ä¹Ÿä¸åŒäºæ ¹æ®===è¿è¥å•†çš„å¹³ç­‰ ã€‚Object.is()å’Œä¹‹é—´çš„å”¯ä¸€åŒºåˆ«åœ¨äº===å®ƒä»¬å¯¹å¸¦ç¬¦å·é›¶å’Œ NaN çš„å¤„ç†ã€‚ä¾‹å¦‚ï¼Œ=== è¿ç®—ç¬¦ï¼ˆå’Œ==è¿ç®—ç¬¦ï¼‰å°†æ•°å€¼-0 å’Œ+0è§†ä¸ºç›¸ç­‰ã€‚æ­¤å¤–ï¼Œ===è¿ç®—ç¬¦å°† Number.NaNå’ŒNaNè§†ä¸ºä¸ç›¸ç­‰ã€‚ console.log(Object.is(true, 1)); //false console.log(Object.is({}, {})); //false console.log(Object.is(\"2\", 2)); //false console.log(Object.is(+0, -0)); //false console.log(Object.is(+0, 0)); //false console.log(Object.is(-0, 0)); //false console.log(Object.is(NaN, NaN)); //true Object.assgin()Object.assign() æ–¹æ³•ç”¨äºå°†æ‰€æœ‰å¯æšä¸¾å±æ€§çš„å€¼ä»ä¸€ä¸ª æˆ–. å¤šä¸ª. æºå¯¹è±¡åˆ†é…åˆ°ç›®æ ‡å¯¹è±¡ã€‚å®ƒå°†è¿”å›ç›®æ ‡å¯¹è±¡ã€‚ Object.assign æ–¹æ³•åªä¼šæ‹·è´æºå¯¹è±¡è‡ªèº«çš„å¹¶ä¸”å¯æšä¸¾çš„å±æ€§åˆ°ç›®æ ‡å¯¹è±¡(æµ…æ‹·è´) const target = { a: 1, b: 2 }; const source = { b: 4, c: 5 }; const source2 = { d: 4, e: 5 }; const returnedTarget = Object.assign(target, source); console.log(target); // expected output: Object { a: 1, b: 4, c: 5 } console.log(returnedTarget); // expected output: Object { a: 1, b: 4, c: 5 } console.log(source); // expected output: Object { b: 4, c: 5 } console.log(Object.assign({}, source, source2, target)) //{ b: 4, c: 5, d: 4, e: 5, a: 1 } å¯¹è±¡å’Œæ•°ç»„çš„å±æ€§ååœ¨å¯¹è±¡ä¸­ï¼Œå±æ€§åæ°¸è¿œæ˜¯å­—ç¬¦ä¸²ï¼Œå¦‚æœä½ ä½¿ç”¨å­—ç¬¦ä¸²ä»¥å¤–çš„å…¶ä»–å€¼ä½œä¸ºå±æ€§åï¼Œå®ƒé¦–å…ˆä¼šè¢«è½¬åŒ–ä¸ºä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå³ä½¿æ˜¯æ•°å­—ä¹Ÿä¸ä¾‹å¤–ã€‚è™½ç„¶æ•°ç»„ä¸‹æ ‡ä¸­ä½¿ç”¨çš„ç¡®å®æ˜¯æ•°å­—ï¼Œä½†æ˜¯åœ¨å¯¹è±¡å±æ€§å‘½ä¸­æ•°å­—ä¼šè¢«è½¬åŒ–ä¸ºå­—ç¬¦ä¸²ï¼Œæ‰€ä»¥ä¸è¦ææ··å¯¹è±¡å’Œæ•°ç»„ä¸­æ•°å­—çš„ç”¨æ³•ã€‚ const obj = {}; obj[true] = \"foo\"; obj[3] = \"bar\"; obj[obj] = \"baz\"; console.log(obj[\"true\"]); //foo console.log(obj[\"3\"]); //bar console.log(obj[\"[object Object]\"]); //baz å¯¹è±¡å±æ€§å­˜åœ¨æ€§è®¿é—®å¯¹è±¡å±æ€§ï¼š const obj = { a: 2, }; console.log(\"a\" in obj); console.log(\"b\" in obj); console.log(obj.hasOwnProperty(\"a\")); console.log(obj.hasOwnProperty(\"b\")); in æ“ä½œç¬¦ ä¼šæ£€æŸ¥å±æ€§æ˜¯å¦åœ¨å¯¹è±¡ or å…¶ [[Prototype]] åŸå‹é“¾ä¸­ï¼Œå¹¶ä¸”å®ƒå¯ä»¥åœ¨ for inå¾ªç¯ä¸­ä½¿ç”¨ï¼Œä¹Ÿå¯ä»¥å•ç‹¬ä½¿ç”¨ hasOwnProperty åªä¼šæ£€æŸ¥æ˜¯å¦åœ¨å¯¹è±¡ä¸­ 3.StringåŸºæœ¬æ•°æ®ç±»å‹æ˜¯æ²¡æœ‰å±æ€§å’Œæ–¹æ³•çš„ï¼Œè€Œå¯¹è±¡æ‰æœ‰å±æ€§å’Œæ–¹æ³• var str = 'andy'; ä½†æ˜¯strå¯ä»¥ä½¿ç”¨str.length,å› ä¸ºjshuiæŠŠåŸºæœ¬æ•°æ®ç±»å‹åŒ…è£…æˆå¤æ‚æ•°æ®ç±»å‹ var temp = new String('andy'); str = temp; temp = null; å­—ç¬¦ä¸²æ‹¼æ¥ å› ä¸ºå­—ç¬¦ä¸²ä¸å¯å˜ï¼Œæ‰€ä»¥æ¯æ¬¡str += i ï¼Œæ‹¼æ¥å­—ç¬¦ä¸²ä¼šå¼€è¾Ÿå¦å¤–ä¸€ä¸ªå†…å­˜ç©ºé—´ï¼Œå­—ç¬¦ä¸²èµ‹å€¼åŒç† Stringæ–¹æ³• æ–¹æ³• å‚æ•° æ•ˆæœ str.indexOf(searchValue [, fromIndex]) 1.è¦è¢«æŸ¥æ‰¾çš„å­—ç¬¦ä¸²å€¼ï¼›2.æŸ¥æ‰¾å¼€å§‹å¤„ï¼ˆå¯é€‰ï¼‰ è¿”å›è°ƒç”¨å®ƒçš„ String å¯¹è±¡ä¸­ç¬¬ä¸€æ¬¡å‡ºç°çš„æŒ‡å®šå€¼çš„ç´¢å¼•ï¼Œä» fromIndex å¤„è¿›è¡Œæœç´¢ã€‚å¦‚æœæœªæ‰¾åˆ°è¯¥å€¼ï¼Œåˆ™è¿”å› -1ã€‚ str.lastIndexOf(searchValue[, fromIndex]) åŒä¸Š è¿”å›è°ƒç”¨String å¯¹è±¡çš„æŒ‡å®šå€¼æœ€åä¸€æ¬¡å‡ºç°çš„ç´¢å¼•ï¼Œåœ¨ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­çš„æŒ‡å®šä½ç½® fromIndexå¤„ä»åå‘å‰æœç´¢ã€‚å¦‚æœæ²¡æ‰¾åˆ°è¿™ä¸ªç‰¹å®šå€¼åˆ™è¿”å›-1 str.charAt(index) ç´¢å¼•å€¼ charAt() æ–¹æ³•ä»ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­è¿”å›æŒ‡å®šçš„å­—ç¬¦ã€‚ str.charCodeAt(index) ç´¢å¼•å€¼ è¿”å›è¡¨ç¤ºç»™å®šç´¢å¼•å¤„çš„ UTF-16 ä»£ç å•å…ƒï¼ˆASCIIç ï¼‰ str[index] åŒstr.charAtï¼ŒH5æ–°å¢ `str.replace(regexp substr, newSubStr)` 1.ä¸€ä¸ªæ­£åˆ™å€¼æˆ–è€…ä¸€ä¸ªå­—ç¬¦ä¸² 2.ç”¨äºæ›¿æ¢æ‰ç¬¬ä¸€ä¸ªå‚æ•°åœ¨åŸå­—ç¬¦ä¸²ä¸­çš„åŒ¹é…éƒ¨åˆ†çš„å­—ç¬¦ä¸² str.includes(searchString[, position]) 1.æœç´¢çš„å­—ç¬¦ä¸² 2.å¯é€‰ï¼Œä»å½“å‰å­—ç¬¦ä¸²çš„å“ªä¸ªç´¢å¼•ä½ç½®å¼€å§‹æœå¯»å­å­—ç¬¦ä¸² ç”¨äºåˆ¤æ–­ä¸€ä¸ªå­—ç¬¦ä¸²æ˜¯å¦åŒ…å«åœ¨å¦ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­ï¼Œæ ¹æ®æƒ…å†µè¿”å› true æˆ– falseã€‚ str.trim() æ–¹æ³•ä¼šä»ä¸€ä¸ªå­—ç¬¦ä¸²çš„ä¸¤ç«¯åˆ é™¤ç©ºç™½å­—ç¬¦ï¼Œå®ƒå¹¶ä¸å½±å“æœ¬èº«çš„å­—ç¬¦ä¸²ï¼Œå®ƒè¿”å›çš„æ˜¯ä¸€ä¸ªæ–°çš„å­—ç¬¦ä¸² str.startsWith(xx) è¦è¢«æŸ¥æ‰¾çš„å­—ç¬¦ä¸²å€¼ ç”¨æ¥åˆ¤æ–­å½“å‰å­—ç¬¦ä¸²æ˜¯å¦ä»¥å¦å¤–ä¸€ä¸ªç»™å®šçš„å­å­—ç¬¦ä¸²å¼€å¤´ï¼Œå¹¶æ ¹æ®åˆ¤æ–­ç»“æœè¿”å› true æˆ– falseã€‚ str.endsWith() åŒä¸Š è¡¨ç¤ºå‚æ•°å­—ç¬¦ä¸²æ˜¯å¦ä»¥åŸå­—ç¬¦ä¸²ç»“å°¾ï¼Œè¿”å›å¸ƒå°”å€¼ str.repeat() é‡å¤æ¬¡æ•° å°†åŸå­—ç¬¦ä¸²é‡å¤næ¬¡ï¼Œè¿”å›ä¸€ä¸ªæ–°å­—ç¬¦ä¸² str.match(regexp) ä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼å¯¹è±¡ã€‚å¦‚æœä¼ å…¥ä¸€ä¸ªéæ­£åˆ™è¡¨è¾¾å¼å¯¹è±¡ï¼Œåˆ™ä¼šéšå¼åœ°ä½¿ç”¨ new RegExp(obj) å°†å…¶è½¬æ¢ä¸ºä¸€ä¸ª RegExp å¦‚æœä½¿ç”¨ g æ ‡å¿—ï¼Œåˆ™å°†è¿”å›ä¸å®Œæ•´æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…çš„æ‰€æœ‰ç»“æœï¼Œä½†ä¸ä¼šè¿”å›æ•è·ç»„ã€‚ å¦‚æœæœªä½¿ç”¨ g æ ‡å¿—ï¼Œåˆ™ä»…è¿”å›ç¬¬ä¸€ä¸ªå®Œæ•´åŒ¹é…åŠå…¶ç›¸å…³çš„æ•è·ç»„ï¼ˆArrayï¼‰ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œè¿”å›çš„é¡¹ç›®å°†å…·æœ‰å¦‚ä¸‹æ‰€è¿°çš„å…¶ä»–å±æ€§ã€‚ æˆªå–å­—ç¬¦ä¸²ï¼ˆå’Œconcatä¸€æ ·ï¼Œä»–ä»¬ä¸ä¼šå½±å“åŸæ¥çš„å­—ç¬¦ä¸²ï¼Œåªä¼šè¿”å›æå–åˆ°çš„åŸå§‹æ–°å­—ç¬¦ä¸²å€¼ï¼‰ è¿™ä¸‰ä¸ªæ–¹æ³•åœ¨é¢å¯¹è´Ÿå€¼å‚æ•°æ—¶åˆæœ‰ä¸‰ä¸ªä¸åŒçš„æ•ˆæœ str.substr(start,length); //startä½ç½®å¼€å§‹ï¼Œlengthå–çš„ä¸ªæ•°ï¼Œçœç•¥lengthåˆ™é»˜è®¤å–åˆ°æœ€å str.slice(start,end); //startå¼€å§‹ï¼Œæˆªå–åˆ°endï¼Œä½†æ˜¯endæˆªå–ä¸åˆ°ï¼Œçœç•¥endåˆ™é»˜è®¤å–åˆ°æœ€å str.substring(start,end); //startå¼€å§‹ï¼Œæˆªå–åˆ°endï¼Œendå¯ä»¥æˆªå–åˆ°,çœç•¥endåˆ™é»˜è®¤å–åˆ°æœ€å arr.slice(start,end); //æ•°ç»„ä¹Ÿæœ‰sliceæ–¹æ³• æ•°ç»„å¯¹è±¡è½¬å­—ç¬¦ç”¨join()ï¼Œå­—ç¬¦è½¬æ•°ç»„ç”¨split var str = 'red, pink, blue'; console.log(str.spilt(',')); //ç”¨é€—å·åˆ†éš” var arr = [1, 2, 3]; console.log(arr.join(' ')); //ç”¨' 'åˆ†éš” str.toUpperCase() è½¬æ¢å¤§å†™ï¼Œ str.toLowerCase() è½¬æ¢å°å†™ ES2017 å¼•å…¥äº†å­—ç¬¦ä¸²è¡¥å…¨é•¿åº¦çš„åŠŸèƒ½ã€‚å¦‚æœæŸä¸ªå­—ç¬¦ä¸²ä¸å¤ŸæŒ‡å®šé•¿åº¦ï¼Œä¼šåœ¨å¤´éƒ¨æˆ–å°¾éƒ¨è¡¥å…¨ã€‚padStart()ç”¨äºå¤´éƒ¨è¡¥å…¨ï¼ŒpadEnd()ç”¨äºå°¾éƒ¨è¡¥å…¨ã€‚ 'x'.padStart(5, 'ab') // 'ababx' 'x'.padStart(4, 'ab') // 'abax' 'x'.padEnd(5, 'ab') // 'xabab' 'x'.padEnd(4, 'ab') // 'xaba' å¦‚æœåŸå­—ç¬¦ä¸²çš„é•¿åº¦ï¼Œç­‰äºæˆ–å¤§äºæŒ‡å®šçš„æœ€å°é•¿åº¦ï¼Œåˆ™è¿”å›åŸå­—ç¬¦ä¸²ã€‚ 4.å†…ç½®å¯¹è±¡å’ŒåŸºæœ¬æ•°æ®ç±»å‹å…ˆçœ‹ä¸€çœ‹å†…ç½®å¯¹è±¡å’ŒåŸºæœ¬æ•°æ®ç±»å‹çš„åŒºåˆ« var strPrimitive = \"I am string\";//ä¸€ä¸ªå­—é¢é‡ typeof strPrimitive; // string strPrimitive instanceof String; // false var strObject = new String(\"I am string\");//ä¸€ä¸ªStringå¯¹è±¡ typeof strPrimitive; // object strPrimitive instanceof String; // true ä¸è¿‡å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œä¸€èˆ¬æˆ‘ä»¬è¯´çš„è½¬æ¢åªåŒ…å«å­—ç¬¦ä¸²å’Œæ•°å€¼ä¸Šï¼ˆstring and Stringï¼Œnumber and Numberï¼‰ null å’Œ undefinedæ²¡æœ‰å¯¹åº”çš„æ„é€ å½¢å¼ï¼Œå®ƒä»¬åªæœ‰æ–‡å­—å½¢å¼ï¼›ç›¸åï¼ŒDateåªæœ‰æ„é€ ï¼Œæ²¡æœ‰æ–‡å­—å½¢å¼ã€‚ å¯¹äºObjectã€Arrayã€Functionã€RegExpæ¥è¯´ï¼Œæ— è®ºæ˜¯æ–‡å­—å½¢å¼è¿˜æ˜¯æ„é€ å½¢å¼ï¼Œä»–ä»¬éƒ½æ˜¯å¯¹è±¡ï¼Œè€Œä¸æ˜¯å­—é¢é‡ è€ŒErrorå¯¹è±¡ä¸€èˆ¬åœ¨æŠ›å‡ºå¼‚å¸¸è‡ªåŠ¨åˆ›å»ºï¼Œä¹Ÿå¯ä»¥é€šè¿‡newçš„æ–¹å¼åˆ›å»ºï¼Œä¸€èˆ¬éƒ½ç”¨ä¸ç€ 5.æ‹†ç®±å¤æ‚ -&gt; ç®€å• å¤æ‚æ•°æ®ç±»å‹è½¬ç®€å•æ•°æ®ç±»å‹ï¼Œä¹Ÿå°±æ˜¯å’Œè£…ç®±ç›¸åçš„æ“ä½œ è°ƒç”¨ x.valueOf()ï¼Œå¦‚æœè½¬æ¢ä¸ºåŸºç¡€ç±»å‹ï¼Œå°±è¿”å›è½¬æ¢çš„å€¼ JavaScriptè°ƒç”¨valueOfæ–¹æ³•å°†å¯¹è±¡è½¬æ¢ä¸ºåŸå§‹å€¼ã€‚ä½ å¾ˆå°‘éœ€è¦è‡ªå·±è°ƒç”¨valueOfæ–¹æ³•ï¼›å½“é‡åˆ°è¦é¢„æœŸçš„åŸå§‹å€¼çš„å¯¹è±¡æ—¶ï¼ŒJavaScriptä¼šè‡ªåŠ¨è°ƒç”¨å®ƒã€‚ è°ƒç”¨ x.toString()ï¼Œå¦‚æœè½¬æ¢ä¸ºåŸºç¡€ç±»å‹ï¼Œå°±è¿”å›è½¬æ¢çš„å€¼ toString() æ–¹æ³•è¿”å›ä¸€ä¸ªè¡¨ç¤ºè¯¥å¯¹è±¡çš„å­—ç¬¦ä¸²ã€‚ toString ã€ valueOf æ–¹æ³•éƒ½æ˜¯å­˜åœ¨äºObject.prototype å¯¹è±¡ä¸Š Symbol.toPrimitive Symbol.toPrimitive æ˜¯ä¸€ä¸ªå†…ç½®çš„ Symbol å€¼ï¼Œå®ƒæ˜¯ä½œä¸ºå¯¹è±¡çš„å‡½æ•°å€¼å±æ€§å­˜åœ¨çš„ï¼Œå½“ä¸€ä¸ªå¯¹è±¡è½¬æ¢ä¸ºå¯¹åº”çš„åŸå§‹å€¼æ—¶ï¼Œä¼šè°ƒç”¨æ­¤å‡½æ•°ã€‚ å…¥å‚ï¼šè¯¥å‡½æ•°è¢«è°ƒç”¨æ—¶ï¼Œä¼šè¢«ä¼ é€’ä¸€ä¸ªå­—ç¬¦ä¸²å‚æ•° hint ï¼Œè¡¨ç¤ºè¦è½¬æ¢åˆ°çš„åŸå§‹å€¼çš„é¢„æœŸç±»å‹ã€‚ hint å‚æ•°çš„å–å€¼æ˜¯ &quot;number&quot;ã€&quot;string&quot; å’Œ &quot;default&quot; ä¸­çš„ä»»æ„ä¸€ä¸ªã€‚ const object1 = { [Symbol.toPrimitive](hint) { if (hint === 'number') { return 42; } return null; } }; é‡å†™ Symbol.toPrimitive ï¼Œè¯¥æ–¹æ³•åœ¨å¯¹è±¡è½¬åŸå§‹ç±»å‹æ—¶è°ƒç”¨ä¼˜å…ˆçº§æœ€é«˜ã€‚ let a = { valueOf() { return 0 }, toString() { return '1' }, [Symbol.toPrimitive]() { return 2 } } 1 + a // => 3 6.è£…ç®±å…¶å®ä¹Ÿå°±æ˜¯ ç®€å•æ•°æ®ç±»å‹ -&gt; å¤æ‚æ•°æ®ç±»å‹ï¼ˆå¯¹åº”çš„å¼•ç”¨ç±»å‹çš„æ“ä½œï¼‰ å…¶ä¸­è£…ç®±åˆåˆ†ä¸ºéšå¼è£…ç®±å’Œæ˜¾å¼è£…ç®± éšå¼è£…ç®±const s1 = 'str'; const s2 = s1.substring(2); å®é™…ä¸Šä¼šåˆ›å»ºä¸€ä¸ªStringç±»å‹çš„å®ä¾‹ï¼Œç„¶åè°ƒç”¨StringåŸå‹çš„æ–¹æ³•ï¼Œè°ƒç”¨æ–¹æ³•åä¼šè¢«ç«‹å³é”€æ¯ const s1 = new String('str'); const s2 = s1.substring(2); s1 = null; å› ä¸ºå®ƒä¼šåœ¨ç«‹å³é”€æ¯ï¼Œè¿™ä¹Ÿå°±è§£é‡Šäº†ä¸ºå•¥ä»ç„¶ä¸èƒ½å†åŸºæœ¬æ•°æ®ç±»å‹ä¸Šæ·»åŠ å±æ€§å’Œæ–¹æ³• const s1 = 'str'; s1.job = 'engineer'; console.log(s1.job); // undefined æ˜¾å¼è£…ç®±åˆ«é—®ï¼Œé—®å°±æ˜¯ç›´æ¥è£…ï¼ const name = new String('str'); // ç›´æ¥newä¸€ä¸ªStringçš„å®ä¾‹å¯¹è±¡ æ­¤æ—¶å¯ä»¥ç›´æ¥æ·»åŠ å±æ€§å’Œæ–¹æ³• var objStr = new String('str'); objStr.job = 'engineer'; console.log(objStr.job); // engineer 6.imageå›¾ç‰‡åŠ è½½ const image = new Image() image.onload = () => { console.log('åŠ è½½å®Œæ¯•') } image.src = './texutre/img.png' ç›‘å¬å›¾ç‰‡åŠ è½½å®Œæˆæ–¹æ³• const loadImage = (url) => new Promise((resolve, reject) => { const image = new Image(); image.crossOrigin = 'Anonymous'; image.src = url; image.onload = () => resolve(image); image.onerror = reject; });","categories":[{"name":"å‰ç«¯","slug":"å‰ç«¯","permalink":"https://taylor12138.github.io/categories/%E5%89%8D%E7%AB%AF/"}],"tags":[],"author":"Hello"},{"title":"CSSç‚«é…·åŠ¨ç”»","slug":"CSSç‚«é…·åŠ¨ç”»","date":"2021-08-30T16:00:00.000Z","updated":"2022-05-10T15:35:54.324Z","comments":true,"path":"2021/08/31/css-xuan-ku-dong-hua/","link":"","permalink":"https://taylor12138.github.io/2021/08/31/css-xuan-ku-dong-hua/","excerpt":"","text":"CSSç€‘å¸ƒæµç€‘å¸ƒæµä¼˜ç‚¹ï¼šè‰ºæœ¯æ€§å¼ºï¼Œè§‚èµæ€§é«˜ ç¼ºç‚¹ï¼šç›®çš„æ€§å·® æ–¹æ³•ä¸€multi-columnå¸ƒå±€å…ˆäº†è§£ä»¥ä¸‹å‡ ä¸ªå±æ€§ column-count: è®¾ç½®å…±æœ‰å‡ åˆ— ï¼ˆæŠŠå½“å‰Blockã€containersã€exceptã€tableã€wrapperã€boxesåˆ†æˆåˆ—æ‹œè®¿ï¼‰ column-width: è®¾ç½®æ¯åˆ—å®½åº¦ï¼Œåˆ—æ•°ç”±æ€»å®½åº¦ä¸æ¯åˆ—å®½åº¦è®¡ç®—å¾—å‡º column-gap: è®¾ç½®åˆ—ä¸åˆ—ä¹‹é—´çš„é—´è· demoæ ·å¼ï¼š .container { column-count: 2; column-gap: 10px; padding: 10px; .item { //... img { //... } } } ç¼ºç‚¹ï¼š multi-columnå¸ƒå±€ï¼ˆä¹Ÿå°±æ˜¯ä¸Šæ–¹çš„å¸ƒå±€æ–¹æ³•ï¼‰ä¼šå°†å…¶å†…çš„å…ƒç´ è‡ªåŠ¨è¿›è¡ŒæµåŠ¨å’Œå¹³è¡¡ï¼Œå°½å¯èƒ½ä¿è¯æ¯åˆ—çš„é«˜åº¦è¶‹äºç›¸åŒï¼Œæ‰€ä»¥ä¼šå°†å…¶å†…çš„æ–‡æœ¬é˜¶æ®µåˆ†å¸ƒåœ¨ä¸¤åˆ—å†…ã€‚ å› æ­¤å¯èƒ½å¯¼è‡´æ–‡æœ¬å†…å®¹è¢«åˆ‡æ–­ ä½†æ˜¯å¯ä»¥ä½¿ç”¨ break-insideä¸­æ–­è¿™ç§å¹³è¡¡ï¼Œä¿æŒæ¯ä¸ªå…ƒç´ çš„ç‹¬ç«‹æ€§ .container { column-count: 2; column-gap: 10px; padding: 10px; .item { break-inside: avoid; img { //... } } } ä½†è¿˜æœ‰ç¼ºç‚¹ï¼š è¿™ç§æ–¹å¼ä»…é€‚ç”¨äºæ•°æ®å›ºå®šä¸å˜çš„æƒ…å†µï¼Œå¯¹äºæ»šåŠ¨åŠ è½½æ›´å¤šç­‰å¯åŠ¨æ€æ·»åŠ æ•°æ®çš„æƒ…å†µå°±å¹¶ä¸é€‚ç”¨äº†ã€‚ æ–¹æ³•äºŒGridå¸ƒå±€é¦–å…ˆè¦æ˜ç¡®çš„gridå¸ƒå±€ä¸­çš„ä¸€äº›å±æ€§ ä¸»è¦è®¾ç½®åœ¨çˆ¶å…ƒç´  display:è®¾ç½®ä¸ºgridæŒ‡æ˜å½“å‰å®¹å™¨ä¸ºGridå¸ƒå±€ grid-template-columns: å®šä¹‰æ¯ä¸€åˆ—çš„åˆ—å®½ grid-template-rows: å®šä¹‰æ¯ä¸€è¡Œçš„è¡Œé«˜ column-gapï¼šç”¨äºè®¾ç½®åˆ—é—´è· grid-auto-rowsï¼šç”¨æ¥è®¾ç½®å¤šä½™ç½‘æ ¼çš„è¡Œé«˜ ä¸»è¦è®¾ç½®åœ¨å­å…ƒç´  grid-row-startï¼šä¸Šè¾¹æ¡†æ‰€åœ¨çš„æ°´å¹³ç½‘æ ¼çº¿ grid-row-endï¼šä¸‹è¾¹æ¡†æ‰€åœ¨çš„æ°´å¹³ç½‘æ ¼çº¿ grid-column-startï¼šå·¦è¾¹æ¡†æ‰€åœ¨çš„å‚ç›´ç½‘æ ¼çº¿ grid-column-endï¼šå³è¾¹æ¡†æ‰€åœ¨çš„å‚ç›´ç½‘æ ¼çº¿ ä»¥ä¸Šå››ä¸ªå±æ€§çš„å±æ€§å€¼ä¸º auto | ç½‘æ ¼çº¿çš„è‡ªå®šä¹‰åç§° | ç½‘æ ¼çº¿çš„ç´¢å¼•å€¼ï¼ˆä»1å¼€å§‹ï¼‰ | span + æ•°å­—ï¼Œè¡¨ç¤ºè¾¹æ¡†è·¨åŸŸå¤šå°‘ç½‘æ ¼ ç”±æ­¤ï¼Œæˆ‘ä»¬åªéœ€è¦ä¸è®¾ç½®è¡Œé«˜(grid-template-rows)ï¼Œæ­¤æ—¶è®¾ç½®grid-auto-rowsåï¼Œæ‰€æœ‰å•å…ƒæ ¼çš„é«˜åº¦å‡ä¸ºgrid-auto-rowsæŒ‡å®šçš„å€¼ã€‚å°†grid-auto-rowsè®¾ç½®ä¸€ä¸ªå¾ˆå°çš„å€¼ï¼Œæ¯”å¦‚10pxï¼Œç„¶åå¯¹å…¶è¿›è¡Œæ‹‰ä¼¸å°†å…¶é«˜åº¦æŒ‡å®šä¸ºçœŸå®é«˜åº¦ï¼Œæ¯ä¸€ä¸ªå•å…ƒæ ¼éƒ½åšå¦‚ä¸‹æ“ä½œï¼Œé‚£ä¹ˆç€‘å¸ƒæµå°±å®ç°äº†~ .container { display: grid; grid-template-columns: 1fr 1fr 1fr; // åˆ†ä¸º3åˆ— column-gap:5px; // åˆ—é—´è·5px grid-auto-rows: 10px; .item{ grid-row-start: auto; } } æ–¹æ³•ä¸‰Flexå¸ƒå±€ä½¿ç”¨flexï¼Œå°†å®¹å™¨åˆ†æˆå›ºå®šæ•°é‡ç­‰åˆ—ï¼Œæ¯åˆ—åœ¨æ·»åŠ flexå¸ƒå±€ï¼Œä¿®æ”¹å…¶ flex-directionå³å¯å®ç° å‚è€ƒé“¾æ¥https://juejin.cn/post/6844904004720263176 CSSç‚«é…·æŒ‰é’®&lt;!DOCTYPE html> &lt;html lang=\"en\"> &lt;head> &lt;meta charset=\"UTF-8\"> &lt;meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\"> &lt;meta http-equiv=\"X-UA-Compatible\" content=\"ie=edge\"> &lt;title>å¸…æ°”çš„æµå…‰ç¯ï¼Œæƒ³å­¦å—ï¼Ÿ&lt;/title> &lt;style> *{ margin: 0; padding: 0; } body{background-color:#000;} .w{ width: 400px; position: absolute; top: 50%; left: 50%; transform: translate(-50%,-100%); } p{ color: #fff; text-align: center; font-size: 40px; font-weight: bolder; } span{ color: #fff; text-align: center; display: block; } a{ text-decoration: none; position: absolute; /* left:50%; top:50%; transform: translate(-50%,-50%); */ font-size:24px; width: 400px; height: 100px; line-height: 100px; text-align: center; color: #fff; background: linear-gradient(90deg,#9370DB,#AFEEEE,#FFA500,#9370DB); /* background:linear-gradient(90deg,#03a9f4,#f441a5,#ffeb3b,#03a9f4); */ border-radius:50px; text-transform: uppercase; background-size: 400%; z-index: 1; } a::before{ content: \"\"; position: absolute; left:-5px; top: -5px; right: -5px; bottom: -5px; background: linear-gradient(90deg,#9370DB,#AFEEEE,#FFA500,#9370DB); /* background:linear-gradient(90deg,#03a9f4,#f441a5,#ffeb3b,#03a9f4); */ background-size:400%; border-radius:50px; filter: blur(20px); z-index: -1; } a:hover{ animation: sun 7s infinite; } a:hover::before{ animation: sun 7s infinite; } @keyframes sun { 100%{ background-position: -400% 0; } } &lt;/style> &lt;/head> &lt;body> &lt;div class=\"w\"> &lt;p>æµå…‰ç¯&lt;/p> &lt;span>é¼ æ ‡åœåœ¨ä¸Šé¢ä¼šåŠ¨~æƒ³å­¦å—&lt;/span> &lt;a href=\"javascript:;\">sunbutton&lt;/a> &lt;/div> &lt;/body> &lt;/html> åŸæ–‡é“¾æ¥ï¼šhttps://blog.csdn.net/rainbow0518/article/details/106017086 CSSèµ›åšæœ‹å…‹&lt;!doctype html> &lt;html> &lt;head> &lt;meta charset=\"utf-8\"> &lt;title>CSSå®ç°èµ›åšæœ‹å…‹é£æ ¼æŒ‰é’®&lt;/title> &lt;/head> &lt;style> button, button::after { width: 300px; height: 86px; font-size: 40px; background: linear-gradient(45deg, transparent 5%, #FF013C 5%); border: 0; color: #fff; letter-spacing: 3px; line-height: 88px; box-shadow: 6px 0px 0px #00E6F6; outline: transparent; position: relative; } button::after { --slice-0: inset(50% 50% 50% 50%);//è®¾ç½®å…­ä¸ªåˆ†ç‰‡ --slice-1: inset(80% -6px 0 0); --slice-2: inset(50% -6px 30% 0); --slice-3: inset(10% -6px 85% 0); --slice-4: inset(40% -6px 43% 0); --slice-5: inset(80% -6px 5% 0); content: 'ç«‹å³åŠ å…¥'; display: block; position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: linear-gradient(45deg, transparent 3%, #00E6F6 3%, #00E6F6 5%, #FF013C 5%); text-shadow: -3px -3px 0px #F8F005, 3px 3px 0px #00E6F6; clip-path: var(--slice-0); } button:hover::after { animation: 1s glitch;//è®¾ç½®å»¶æ—¶1ç§’ï¼Œå®šä¹‰glitchå˜é‡åœ¨åœ¨é‡Œé¢è®¾ç½®åŠ¨ç”» animation-timing-function: steps(2, end); } @keyframes glitch { 0% { clip-path: var(--slice-1); transform: translate(-20px, -10px); } 10% { clip-path: var(--slice-3); transform: translate(10px, 10px); } 20% { clip-path: var(--slice-1); transform: translate(-10px, 10px); } 30% { clip-path: var(--slice-3); transform: translate(0px, 5px); } 40% { clip-path: var(--slice-2); transform: translate(-5px, 0px); } 50% { clip-path: var(--slice-3); transform: translate(5px, 0px); } 60% { clip-path: var(--slice-4); transform: translate(5px, 10px); } 70% { clip-path: var(--slice-2); transform: translate(-10px, 10px); } 80% { clip-path: var(--slice-5); transform: translate(20px, -10px); } 90% { clip-path: var(--slice-1); transform: translate(-10px, 0px); } 100% { clip-path: var(--slice-1); transform: translate(0); } } &lt;/style> &lt;body> &lt;button>ç«‹å³åŠ å…¥&lt;/button> &lt;/body> &lt;/html> åŸæ–‡ï¼šhttps://blog.csdn.net/TBDBTUO/article/details/118070710 äº¦æˆ–è€…å‚è€ƒè¿™ä¸ªhttps://github.com/zxuqian/html-css-examples/tree/master/27-glitch-effect CSSæ•°å­—æ»šåŠ¨ç»„ä»¶å®è´¨ä¸Šæ›´å¤šçš„æ˜¯jsé€»è¾‘ï¼Œcssåªæ˜¯ä½¿ç”¨äº†transform: translateY https://juejin.cn/post/6995086139484799006","categories":[{"name":"å‰ç«¯","slug":"å‰ç«¯","permalink":"https://taylor12138.github.io/categories/%E5%89%8D%E7%AB%AF/"}],"tags":[],"author":"Hello"},{"title":"Chromeçš„æ¢ç´¢","slug":"Chromeçš„æ¢ç´¢","date":"2021-08-21T16:00:00.000Z","updated":"2022-09-13T02:50:44.789Z","comments":true,"path":"2021/08/22/chrome-de-tan-suo/","link":"","permalink":"https://taylor12138.github.io/2021/08/22/chrome-de-tan-suo/","excerpt":"","text":"æµè§ˆå™¨ç»“æ„ ç”¨æˆ·ç•Œé¢ - åŒ…æ‹¬åœ°å€æ ã€å‰è¿›/åé€€æŒ‰é’®ã€ä¹¦ç­¾èœå•ç­‰ã€‚é™¤äº†æµè§ˆå™¨ä¸»çª—å£æ˜¾ç¤ºçš„æ‚¨è¯·æ±‚çš„é¡µé¢å¤–ï¼Œå…¶ä»–æ˜¾ç¤ºçš„å„ä¸ªéƒ¨åˆ†éƒ½å±äºç”¨æˆ·ç•Œé¢ã€‚ æµè§ˆå™¨å¼•æ“ - åœ¨ç”¨æˆ·ç•Œé¢å’Œå‘ˆç°å¼•æ“ä¹‹é—´ä¼ é€æŒ‡ä»¤ã€‚ å‘ˆç°å¼•æ“ - è´Ÿè´£æ˜¾ç¤ºè¯·æ±‚çš„å†…å®¹ã€‚å¦‚æœè¯·æ±‚çš„å†…å®¹æ˜¯ HTMLï¼Œå®ƒå°±è´Ÿè´£è§£æ HTML å’Œ CSS å†…å®¹ï¼Œå¹¶å°†è§£æåçš„å†…å®¹æ˜¾ç¤ºåœ¨å±å¹•ä¸Šã€‚ ç½‘ç»œ - ç”¨äºç½‘ç»œè°ƒç”¨ï¼Œæ¯”å¦‚ HTTP è¯·æ±‚ã€‚å…¶æ¥å£ä¸å¹³å°æ— å…³ï¼Œå¹¶ä¸ºæ‰€æœ‰å¹³å°æä¾›åº•å±‚å®ç°ã€‚ ç”¨æˆ·ç•Œé¢åç«¯ - ç”¨äºç»˜åˆ¶åŸºæœ¬çš„çª—å£å°éƒ¨ä»¶ï¼Œæ¯”å¦‚ç»„åˆæ¡†å’Œçª—å£ã€‚å…¶å…¬å¼€äº†ä¸å¹³å°æ— å…³çš„é€šç”¨æ¥å£ï¼Œè€Œåœ¨åº•å±‚ä½¿ç”¨æ“ä½œç³»ç»Ÿçš„ç”¨æˆ·ç•Œé¢æ–¹æ³•ã€‚ JavaScript è§£é‡Šå™¨ã€‚ç”¨äºè§£æå’Œæ‰§è¡Œ JavaScript ä»£ç ã€‚ æ•°æ®å­˜å‚¨ã€‚è¿™æ˜¯æŒä¹…å±‚ã€‚æµè§ˆå™¨éœ€è¦åœ¨ç¡¬ç›˜ä¸Šä¿å­˜å„ç§æ•°æ®ï¼Œä¾‹å¦‚ Cookieã€‚æ–°çš„ HTML è§„èŒƒ (HTML5) å®šä¹‰äº†â€œç½‘ç»œæ•°æ®åº“â€ï¼Œè¿™æ˜¯ä¸€ä¸ªå®Œæ•´ï¼ˆä½†æ˜¯è½»ä¾¿ï¼‰çš„æµè§ˆå™¨å†…æ•°æ®åº“ã€‚ å‘ˆç°å¼•æ“ï¼šç”¨äºCSSæ ¼å¼åŒ–HTMLå†…å®¹å’Œå›¾ç‰‡ Firefox ä½¿ç”¨çš„æ˜¯ Geckoï¼Œè¿™æ˜¯ Mozilla å…¬å¸â€œè‡ªåˆ¶â€çš„å‘ˆç°å¼•æ“ã€‚è€Œ Safari å’Œ Chrome æµè§ˆå™¨ä½¿ç”¨çš„éƒ½æ˜¯ WebKitã€‚ Chromeæ¸²æŸ“æµç¨‹å¤šè¿›ç¨‹ä¸€èˆ¬ä¸€ä¸ªåº”ç”¨å¯¹åº” -&gt; ä¸€ä¸ªè¿›ç¨‹ å¼€å‘ä¸€ä¸ªæµè§ˆå™¨ï¼Œå®ƒå¯ä»¥æ˜¯å•è¿›ç¨‹å¤šçº¿ç¨‹çš„åº”ç”¨ï¼Œä¹Ÿå¯ä»¥æ˜¯ä½¿ç”¨ IPC é€šä¿¡çš„å¤šè¿›ç¨‹åº”ç”¨ã€‚ Chrome é‡‡ç”¨å¤šè¿›ç¨‹æ¶æ„ï¼Œå…¶é¡¶å±‚å­˜åœ¨ä¸€ä¸ª Browser process ç”¨ä»¥åè°ƒæµè§ˆå™¨çš„å…¶å®ƒè¿›ç¨‹ chromeå¤šè¿›ç¨‹çš„ä¼˜ç‚¹ æŸä¸€æ¸²æŸ“è¿›ç¨‹å‡ºé—®é¢˜ä¸ä¼šå½±å“å…¶ä»–è¿›ç¨‹ æ›´ä¸ºå®‰å…¨ï¼Œåœ¨ç³»ç»Ÿå±‚é¢ä¸Šé™å®šäº†ä¸åŒè¿›ç¨‹çš„æƒé™ ç¼ºç‚¹ï¼šç”±äºä¸åŒè¿›ç¨‹é—´çš„å†…å­˜ä¸å…±äº«ï¼Œä¸åŒè¿›ç¨‹çš„å†…å­˜å¸¸å¸¸éœ€è¦åŒ…å«ç›¸åŒçš„å†…å®¹ã€‚ï¼ˆæ„æ€å°±æ˜¯å†…å­˜å ç”¨å¤§å‘—ï¼‰ å¦‚æœ Chrome è¿è¡Œåœ¨å¼ºå¤§çš„ç¡¬ä»¶ä¸Šï¼Œå®ƒä¼šåˆ†å‰²ä¸åŒçš„æœåŠ¡åˆ°ä¸åŒçš„è¿›ç¨‹ï¼Œè¿™æ · Chrome æ•´ä½“çš„è¿è¡Œä¼šæ›´åŠ ç¨³å®šï¼Œä½†æ˜¯å¦‚æœ Chrome è¿è¡Œåœ¨èµ„æºè´«ç˜ çš„è®¾å¤‡ä¸Šï¼Œè¿™äº›æœåŠ¡åˆä¼šåˆå¹¶åˆ°åŒä¸€ä¸ªè¿›ç¨‹ä¸­è¿è¡Œï¼Œè¿™æ ·å¯ä»¥èŠ‚çœå†…å­˜ Site IsolationSite Isolation æœºåˆ¶å…è®¸åœ¨åŒä¸€ä¸ª Tab ä¸‹çš„è·¨ç«™ iframe ä½¿ç”¨å•ç‹¬çš„è¿›ç¨‹æ¥æ¸²æŸ“ï¼Œè¿™æ ·ä¼šæ›´ä¸ºå®‰å…¨ã€‚ï¼ˆç›¸å½“äºç½‘é¡µä¸­å†…åµŒiframeï¼Œä½¿å¾—è¿›ç¨‹ä¹‹é—´ä¿æŒç‹¬ç«‹æ€§ï¼‰ chromeå¯¼èˆªtabä»¥å¤–çš„å·¥ä½œä¹Ÿéƒ½æ˜¯ç”±Browser Processæ§åˆ¶ï¼Œè€Œå®ƒå¯¹äºå¯¼èˆªæ ï¼Œç”¨ä¸åŒçš„çº¿ç¨‹è¿›è¡Œå¤„ç†ï¼ˆè¿™äº›çº¿ç¨‹åŒ…å«åœ¨Browser Processä¸­ï¼‰ UI thread ï¼š æ§åˆ¶æµè§ˆå™¨ä¸Šçš„æŒ‰é’®åŠè¾“å…¥æ¡†ï¼› network thread: å¤„ç†ç½‘ç»œè¯·æ±‚ï¼Œä»ç½‘ä¸Šè·å–æ•°æ®ï¼› storage thread: æ§åˆ¶æ–‡ä»¶ç­‰çš„è®¿é—® å¯¼èˆªæ è¾“å…¥å…³é”®å­—ä¹‹åï¼š UI thread åˆ¤æ–­è¾“å…¥ -&gt; network thread è·å–è¯·æ±‚ï¼Œæ‰§è¡ŒDNSæŸ¥è¯¢ï¼Œå»ºç«‹TLSè¿æ¥ -&gt; æ ¹æ®ç›¸åº”çš„æ ¼å¼è¿›è¡Œå¤„ç† -&gt; è§¦å‘Safe Browsingï¼Œ å¦‚æœå½“å‰åŒ¹é…åˆ°çš„æ˜¯æ¶æ„ç«™ç‚¹ï¼Œåˆ™ä¼šå‘å‡ºè­¦å‘Š -&gt; ä¸€åˆ‡å‡†å¤‡å°±ç»ªï¼Œnetwork threadï¼šæˆ‘ä»¬æ•°æ®okäº†ï¼ŒUI threadï¼šæ”¶åˆ°ï¼Œç„¶åUI threadæ‰¾åˆ°ä¸€ä¸ªrender processè¿›è¡Œç½‘é¡µæ¸²æŸ“ï¼ˆæ‰€æœ‰çš„ JS ä»£ç å…¶å®éƒ½ç”± renderer Process æ§åˆ¶çš„ï¼‰ -&gt; Browser Process æ”¶åˆ° renderer process çš„æ¸²æŸ“ç¡®è®¤æ¶ˆæ¯ï¼Œé¡µé¢åŠ è½½å¼€å§‹ï¼Œhistory tab è¿›è¡Œæ›´æ–° æ¸²æŸ“å·¥ä½œåœ¨Render Processä¸­ï¼ŒåŒ…å«ä»¥ä¸‹çº¿ç¨‹ ä¸»çº¿ç¨‹ Main thread å·¥ä½œçº¿ç¨‹ Worker thread æ’ç‰ˆçº¿ç¨‹ Compositor thread å…‰æ …çº¿ç¨‹ Raster thread æ¸²æŸ“è¿‡ç¨‹ï¼š ä¸»çº¿ç¨‹main threadæ„å»ºDOM -&gt; è‹¥æœŸé—´å­˜åœ¨ &lt;img&gt; &lt;link&gt; ç­‰æ ‡ç­¾ï¼Œåˆ™ä¼ é€’ç»™Browser Process çš„network threadè¿›è¡Œä¸‹è½½ -&gt; ç¢°åˆ°&lt;script&gt; æ ‡ç­¾ä¼šé˜»å¡ï¼Œé™¤éå¸¦æœ‰deferæˆ–è€…async -&gt; å½¢æˆCSSOMæ ‘å’ŒDOMæ ‘å†åˆæˆrenderæ ‘ï¼Œè®¡ç®—å¸ƒå±€ã€æ ·å¼ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬å¸¸è§çš„layoutå’Œpaintï¼Œæœ€ååˆæˆå¸§ï¼Œå…¶ä¸­å¦‚æœæ·»åŠ äº† will-change CSS å±æ€§çš„å…ƒç´ ï¼Œä¼šè¢«çœ‹åšå•ç‹¬çš„ä¸€å±‚ï¼Œï¼ˆç±»ä¼¼äºCSSçš„ç¼“å­˜æ•ˆæœï¼‰ chromeå¯¹äº‹ä»¶çš„ä¼˜åŒ–ä¸€èˆ¬æˆ‘ä»¬å±å¹•çš„åˆ·æ–°é€Ÿç‡ä¸º 60fpsï¼Œä½†æ˜¯æŸäº›äº‹ä»¶çš„è§¦å‘é‡ä¼šä¸æ­¢è¿™ä¸ªå€¼ï¼Œå‡ºäºä¼˜åŒ–çš„ç›®çš„ï¼ŒChrome ä¼šåˆå¹¶è¿ç»­çš„äº‹ä»¶(å¦‚ wheel, mousewheel, mousemove, pointermove, touchmove )ï¼Œå¹¶å»¶è¿Ÿåˆ°ä¸‹ä¸€å¸§æ¸²æŸ“æ—¶å€™æ‰§è¡Œ ã€‚ ä¸è¿‡å€¼å¾—ä¸€æçš„æ˜¯ï¼Œé‚£äº›éè¿ç»­æ€§çš„äº‹ä»¶ï¼Œä¹Ÿå°±æ˜¯clickä¹‹ç±»çš„ï¼ˆæ¯•ç«Ÿä½ ä¹Ÿç‚¹ä¸äº†é‚£ä¹ˆå¿«ï¼‰ï¼Œåˆ™ä¼šç«‹å³è¢«è§¦å‘ AMPAMPï¼ˆåŠ é€Ÿç§»åŠ¨é¡µé¢ï¼‰æ˜¯ä¸€ä¸ªç”±Googleä¸Twitteråˆä½œå¼€å‘çš„å¼€æºæ¡†æ¶ï¼Œå®ƒæä¾›äº†ä¸€ç§ç›´æ¥çš„æ–¹å¼æ¥åˆ›å»ºè½»é‡çº§çš„ç½‘é¡µï¼Œä»¥ä¾¿ç”¨æˆ·å³æ—¶ä½¿ç”¨ï¼Œè·å¾—äº†æå¤§æ”¹å–„çš„ä½“éªŒï¼šå†…å®¹æ›´å¿«ï¼Œæ›´å…·å¸å¼•åŠ›ï¼Œæ›´æ˜“äºé˜…è¯»ã€‚ AMPé¡µé¢çš„3ä¸ªæ ¸å¿ƒç»„ä»¶AMP HTMLï¼šä¸€ä¸ªæ¯”å¸¸è§„HTMLæ›´ç²¾ç®€çš„HTMLç‰ˆæœ¬ï¼Œå¯¹å¯ä»¥ä½¿ç”¨çš„HTMLæ ‡ç­¾æœ‰ä¸¥æ ¼çš„è§„èŒƒ AMP JSï¼šä¸ºäº†ç¡®ä¿ç§»åŠ¨å¹³å°ä¸Šçš„å¿«é€Ÿé¡µé¢åŠ è½½ï¼ŒAMPé™åˆ¶ä½¿ç”¨ä»»ä½•Javascriptï¼Œå”¯ä¸€çš„ä¾‹å¤–æ˜¯AMPè„šæœ¬ AMP CDNï¼šé€šå¸¸ç§°ä¸ºAMPç¼“å­˜ï¼ŒAMPå¹³å°çš„ä¸€ä¸ªå…³é”®ç»„ä»¶æ˜¯å…¶åŸºäºä»£ç†çš„å†…å®¹åˆ†å‘ç½‘ç»œï¼ˆCDNï¼‰ï¼Œå¯æä¾›åŠ é€Ÿç§»åŠ¨é¡µé¢ã€‚ AMPçš„ä¼˜ç¼ºç‚¹ä¼˜ç‚¹ï¼š 1ã€å†…å®¹çš„åŠ è½½é€Ÿåº¦éå¸¸å¿«ï¼Œç”¨å¾ˆå¥½çš„ç§»åŠ¨ä½“éªŒæ„Ÿï¼Œæé«˜äº†å‚ä¸åº¦å’Œè½¬åŒ–ç‡ã€‚ 2ã€é€šè¿‡ç§»åŠ¨æœç´¢ç»“æœï¼Œå¯ä»¥åœ¨AMPè½®æ’­ä¸­çªå‡ºæ˜¾ç¤ºå†…å®¹ã€‚ 3ã€å‡å°‘æœåŠ¡å™¨ä¸Šçš„è´Ÿè½½ï¼Œå› ä¸ºAMP CDNç¼“å­˜å¹¶å“åº”å¤§å¤šæ•°æœç´¢ç»“æœã€‚ ç¼ºç‚¹ï¼š 1ã€JavaScriptæœ‰é™åˆ¶ï¼Œç”¨æˆ·æ— æ³•è‡ªå·±åˆ›å»ºï¼Œæ‰€ä»¥å®ƒå¯èƒ½å¾ˆéš¾ç¼–ç ã€‚ 2ã€æ²¡æœ‰é›†æˆæ’ä»¶ï¼Œä¸€äº›æ•ˆæœå¾ˆéš¾åœ¨é¡µé¢ä¸­å®ç°ã€‚ 3ã€ç®€åŒ–äº†HTMLï¼Œcssæœ‰é™åˆ¶ï¼Œä¸èƒ½å¾ˆå¥½çš„è‡ªå®šä¹‰ç½‘ç«™æ ·å¼ï¼Œå¤§å¤šæ˜¯Googleçš„é»˜è®¤æ ¼å¼ã€‚ å‚è€ƒé“¾æ¥https://zhuanlan.zhihu.com/p/47407398 å‚è€ƒé“¾æ¥https://developer.mozilla.org/zh-CN/docs/Web/Performance/How_browsers_work å‚è€ƒé“¾æ¥https://zhuanlan.zhihu.com/p/139506473","categories":[{"name":"å‰ç«¯","slug":"å‰ç«¯","permalink":"https://taylor12138.github.io/categories/%E5%89%8D%E7%AB%AF/"}],"tags":[],"author":"Hello"},{"title":"React-native(other)","slug":"React-native(other)","date":"2021-06-24T16:00:00.000Z","updated":"2022-08-10T12:45:05.319Z","comments":true,"path":"2021/06/25/react-native-other/","link":"","permalink":"https://taylor12138.github.io/2021/06/25/react-native-other/","excerpt":"","text":"4.ç§»åŠ¨ç«¯æœåŠ¡å™¨éƒ¨ç½²&amp;æ³¨æ„äº‹é¡¹å®‰å“è®¿é—®æœ¬åœ°æœåŠ¡å™¨åœ°å€ä¸º 10.0.2.2:ç«¯å£å·ï¼Œæˆ‘ä»¬å¹³æ—¶æµè§ˆå™¨è®¿é—®æœåŠ¡å™¨éƒ½æ˜¯ localhost:ç«¯å£å· å…³äºReact Nativeçš„è°ƒè¯•1.ä½¿ç”¨è°·æ­Œæµè§ˆå™¨æ¥è°ƒè¯• ä½¿ç”¨è°·æ­Œæµè§ˆå™¨å³å¯ ä¸èƒ½æŸ¥çœ‹æ ‡ç­¾ç»“æ„ ä¸èƒ½æŸ¥çœ‹ç½‘ç»œè¯·æ±‚ 2.ä½¿ç”¨rnæ¨èçš„å·¥å…· react-native-debuggeræ¥è°ƒè¯• (è€å¸ˆæ¨èä½¿ç”¨è¿™ç§æ–¹å¼) å¯ä»¥æŸ¥çœ‹æ ‡ç­¾ç»“æ„ ä¸èƒ½æŸ¥çœ‹ç½‘ç»œè¯·æ±‚ 3.æƒ³è¦æŸ¥çœ‹ç½‘ç»œè¯·æ±‚ æ‰¾åˆ°é¡¹ç›®çš„å…¥å£æ–‡ä»¶ index.js åŠ å…¥ä»¥ä¸‹ä»£ç å³å¯ GLOBAL.XMLHttpRequest = GLOBAL.originalXMLHttpRequest || GLOBAL.XMLHttpRequest ç§»åŠ¨ç«¯è·¯ç”±å¯¼èˆªã€å¯¼èˆªæ å¯ä»¥ç”¨ä»¥ä¸‹çš„react-navigationæ¡†æ¶ react-nativeä»å¼€æºè‡³ä»Šï¼Œä¸€ç›´å­˜åœ¨å‡ ä¸ªæ— æ³•è§£å†³çš„æ¯›ç—…ï¼Œå¶å°”å°±ä¼šå¤å‘è®©äººéšéšä½œç—›ï¼Œæé†’ä½ ç”¨çš„ä¸æ˜¯åŸç”Ÿï¼Œå…¶ä¸­åŒ…æ‹¬åˆ—è¡¨çš„å¤ç”¨é—®é¢˜ï¼Œå¯¼èˆªè·³è½¬ä¸æµç•…çš„é—®é¢˜ç­‰ç­‰ã€‚ ç»ˆäºfacebookåä¸ä½äº†ï¼Œåœ¨å‰ä¸€æ®µæ—¶é—´å¼€å§‹æ¨èä½¿ç”¨react-navigationï¼Œå¹¶ä¸”åœ¨0.44å‘å¸ƒçš„æ—¶å°†ä¹‹å‰ä¸€ç›´å­˜åœ¨çš„NavigatoråºŸå¼ƒäº†ã€‚ react-navigationæ˜¯è‡´åŠ›äºè§£å†³å¯¼èˆªå¡é¡¿ï¼Œæ•°æ®ä¼ é€’ï¼ŒTabbarå’Œnavigatorå¸ƒå±€ï¼Œæ”¯æŒreduxã€‚è™½ç„¶ç°åœ¨åŠŸèƒ½è¿˜ä¸å®Œå–„ï¼Œä½†åŸºæœ¬æ˜¯å¯ä»¥åœ¨é¡¹ç›®ä¸­æ¨èä½¿ç”¨çš„ã€‚ import { createAppContainer } from 'react-navigation'; import { createStackNavigator } from 'react-navigation-stack' React navigationçš„éƒ¨åˆ†ä½¿ç”¨è§„èŒƒ é¡µé¢è·³è½¬å’Œè½¬åœºåŠ¨ç”» å®‰è£…ï¼ˆåœ¨é¡¹ç›®ä¸­ä½¿ç”¨ï¼‰ yarn add @react-navigation/native yarn add react-native-screens react-native-safe-area-context å¦‚æœæ‚¨åœ¨ Mac ä¸Šä¸º iOS å¼€å‘ï¼Œåˆ™éœ€è¦å®‰è£… podï¼ˆé€šè¿‡Cocoapodsï¼‰ä»¥å®Œæˆé“¾æ¥ã€‚ npx pod-install ios react-native-screensåŒ…éœ€è¦ä¸€ä¸ªé¢å¤–çš„é…ç½®æ­¥éª¤æ‰èƒ½åœ¨ Android è®¾å¤‡ä¸Šæ­£å¸¸å·¥ä½œã€‚ç¼–è¾‘MainActivity.javaä½äºandroid/app/src/main/java/&lt;your package name&gt;/MainActivity.java. å°†ä»¥ä¸‹ä»£ç æ·»åŠ åˆ°MainActivityç±»çš„ä¸»ä½“ä¸­ï¼š @Override protected void onCreate(Bundle savedInstanceState) { super.onCreate(null); } å¹¶ç¡®ä¿åœ¨æ­¤æ–‡ä»¶é¡¶éƒ¨æ·»åŠ å¯¼å…¥è¯­å¥ï¼š import android.os.Bundle; å®‰è£… native stackã€navigator library yarn add @react-navigation/native-stack ä»£ç  import * as React from 'react'; import { Button, View, Text } from 'react-native'; import { NavigationContainer } from '@react-navigation/native'; import { createStackNavigator } from '@react-navigation/stack'; function HomeScreen({ navigation }) { return ( &lt;View style={{ flex: 1, alignItems: 'center', justifyContent: 'center' }}> &lt;Text>Home Screen&lt;/Text> &lt;Button title=\"Go to Details\" onPress={() => navigation.navigate('Details')} /> &lt;/View> ); } function DetailsScreen() { return ( &lt;View style={{ flex: 1, alignItems: 'center', justifyContent: 'center' }}> &lt;Text>Details Screen&lt;/Text> &lt;/View> ); } const Stack = createStackNavigator(); function App() { return ( &lt;NavigationContainer> &lt;Stack.Navigator initialRouteName=\"Home\" screenOptions={{ headerShown: false, }}> &lt;Stack.Screen name=\"Home\" component={HomeScreen} /> &lt;Stack.Screen name=\"Details\" component={DetailsScreen} /> &lt;/Stack.Navigator> &lt;/NavigationContainer> ); } export default App; è·¯ç”±è¦åœ¨ Stack.Navigator ä¸­ä»¥Stack.Screenç»„ä»¶çš„æ ¼å¼è¿›è¡Œå­˜æ”¾ Screençš„å±æ€§componentå±æ€§ç›´æ¥æ”¾å…¥è·¯ç”±ç»„ä»¶ Navigatorçš„å±æ€§headerMode=&quot;none&quot;éšè—é¡µé¢è·¯ç”±çš„æ ‡é¢˜ åé¢å±æ€§æ”¹æˆ ä»¥ä¸‹æ‰èƒ½ä½¿ç”¨äº†ï¼Œä»¥ä¸Šçš„ headerMode=&quot;none&quot; ä¸ç®¡ç”¨äº†ï¼ˆ2022å¹´ï¼‰ screenOptions={{ headerShown: false, }} å½“ç„¶ï¼Œå¯ä»¥å’ŒVueè„šæ‰‹æ¶ä¸€æ ·ï¼Œåœ¨srcä¸‹æ–°å»ºä¸€ä¸ª nav.jsæ–‡ä»¶ï¼Œä¸“é—¨ç”¨äºå­˜æ”¾è·¯ç”±ï¼Œæ­¤æ—¶æˆ‘ä»¬å°†ä¸Šå›¾ä»£ç æ”¾å…¥è¿™ä¸ªnav.jsæ–‡ä»¶ï¼ˆAppæ”¹é—®Navï¼‰ ç„¶åå†App.jsæ–‡ä»¶å†™å…¥Navç»„ä»¶å³å¯ import React from 'react' import { View, Text } from 'react-native' import Nav from './src/nav' export default function App() { return ( &lt;View style={{ flex: 1 }}> &lt;Nav>&lt;/Nav> &lt;/View> ) } å¯ä»¥åœ¨ createStackNavigatoré‡Œä¸€ä¸€æ”¾ç½®ç»„ä»¶ï¼Œæœ‰ç‚¹ç±»ä¼¼è·¯ç”±çš„ä½œç”¨ï¼› å®˜æ–¹è§£é‡Šï¼šä¸€æ¬¡æ¸²æŸ“ä¸€ä¸ªå±å¹•å¹¶æä¾›å±å¹•ä¹‹é—´çš„è½¬æ¢ã€‚å½“ä¸€ä¸ªæ–°å±å¹•æ‰“å¼€æ—¶ï¼Œå®ƒè¢«æ”¾ç½®åœ¨å †æ ˆçš„é¡¶éƒ¨ æ ¼å¼ä¸º ä¼ å…¥çš„ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºç»„ä»¶ ï¼ˆä»¥å¯¹è±¡çš„å½¢å¼ï¼‰ è·¯ç”±å: {screen: ç»„ä»¶å, navigationOptions: é…ç½®é€‰æ‹©ï¼ˆä¹Ÿå¯ä»¥è‡ªå®šä¹‰titleã€tabBarLabelç­‰ï¼‰} ä¸»é¡µé¢ä½¿ç”¨äº†createStackNavigatorï¼Œå­ç»„ä»¶å°±ä¼šé»˜è®¤ä¼ å…¥this.props.navigationã€‚ navigationç”¨äºè·³è½¬é¡µé¢å’Œè·å–å¯¼èˆªä¿¡æ¯ ç„¶åï¼Œæˆ‘ä»¬å°±å¯ä»¥åœ¨ç»„ä»¶å†…è¿›è¡Œè·¯ç”±è·³è½¬ this.props.navigation.navigate(&#39;è·¯ç”±å&#39;)å¯è¿›è¡Œè·³è½¬ (è·³è½¬åˆ° Brief é¡µé¢ + ä¼ å…¥åä¸º â€˜bookâ€™ çš„å‚æ•° )ï¼Œæ¥æ”¶çš„ Briefé¡µé¢å¯ä»¥é€šè¿‡ this.props.navigation.state.params.bookè¿›è¡Œè·å– this.props.navigation.goBack() è¿”å› const {navigation} = this.props reutrn( &lt;TouchableOpacity onPress={() => { navigation.navigate('Brief', { book: item }) }}> &lt;/TouchableOpacity> &lt;TouchableOpacity onPress={() => { navigation.goBack()}> &lt;/TouchableOpacity> ) //app.js import { createAppContainer } from 'react-navigation'; import { createStackNavigator } from 'react-navigation-stack' //è¿™é‡Œåˆ†åˆ«å¼•å…¥äº†4ä¸ªé¡µé¢ç»„ä»¶ import BottomNavigator from './page/root/rootPage' import BriefPage from './page/brief/briefPage' import ImgPage from './page/brief/ImgPage' import ListPage from './page/cate/ListPage' const AppStack = createStackNavigator( { // é¦–é¡µç»„ä»¶è®¾ç½®ï¼šä»rootPageå¼•å…¥çš„å¹¶ä¸”å‘½åä¸ºBottomNavigator BottomNavigator: { screen: BottomNavigator, navigationOptions: { headerShown: false, } }, Login: { screen: Login }, Register: { screen: Register }, Brief: { screen: BriefPage }, ImgPage: { screen: ImgPage }, ListPage: { screen: ListPage } }, { mode: 'modal', headerMode: 'none', } ); export default createAppContainer(AppStack); UIæ¡†æ¶æ¡†æ¶æ¨è react-native-elements ä¸‹è½½ éœ€è¦ä½¿ç”¨åˆ°å›¾æ ‡ å› æ­¤ä¹Ÿéœ€è¦å®‰è£… react-native-vector-icons yarn add react-native-elements react-native-vector-icons æˆ–è€… npm i react-native-elements react-native-vector-icons å¼•å…¥å’Œä½¿ç”¨ import { Icon } from 'react-native-elements' &lt;Icon name='rowing' /> react-native-vector-icons çš„å…¶ä»–ä½¿ç”¨ï¼ˆä½¿ç”¨UIåº“çš„iconæ—¶éœ€è¦è¿›è¡Œé…ç½®ï¼‰ ç¼–è¾‘ android/app/build.gradle æ·»åŠ ä»¥ä¸‹é…ç½® project.ext.vectoricons = [ iconFontNames: [ 'MaterialIcons.ttf', 'EvilIcons.ttf' ] // Name of the font files you want to copy ] //è¿™ä¸ªæ—¶è‡ªå®šä¹‰æ·»åŠ å­—ä½“æ—¶æ‰é…ç½® apply from: \"../../node_modules./React-native-vector-icons/fonts.gradle\" //è¿™ä¸ªæ˜¯ä¸€å®šè¦é…ç½®çš„ é‡å¯é¡¹ç›® æ·»åŠ ä»£ç  å¦‚ import FontAwesome5 from 'react-native-vector-icons/FontAwesome5'; const icon = &lt;FontAwesome5 name={'comments'} />; å…³é—­é»„è‰²è­¦å‘Šç²˜è´´åˆ°index.jsæ–‡ä»¶ä¸‹ console.ignoredYellowBox = ['Warning: BackAndroid is deprecated. Please use BackHandler instead.','source.uri should not be an empty string','Invalid props.style key']; console.disableYellowBox = true // å…³é—­å…¨éƒ¨é»„è‰²è­¦å‘Š æ¸å˜è‰²å®¹å™¨react-native-linear-gradient ä¸‹è½½ yarn add react-native-linear-gradient npm i react-native-linear-gradient ç®€å•ä½¿ç”¨ import LinearGradient from 'react-native-linear-gradient'; &lt;LinearGradient colors={['#4c669f', '#3b5998', '#192f6a']} style={styles.linearGradient}> &lt;Text style={styles.buttonText}> Sign in with Facebook &lt;/Text> &lt;/LinearGradient> var styles = StyleSheet.create({ linearGradient: { flex: 1, paddingLeft: 15, paddingRight: 15, borderRadius: 5 }, buttonText: { fontSize: 18, fontFamily: 'Gill Sans', textAlign: 'center', margin: 10, color: '#ffffff', backgroundColor: 'transparent', }, }); éªŒè¯ç è¾“å…¥æ¡†react-native-confirmation-code-field ä¸‹è½½ yarn add react-native-confirmation-code-field npm i react-native-confirmation-code-field ä»£ç  import React, {useState} from 'react'; import {SafeAreaView, Text, StyleSheet} from 'react-native'; import { CodeField, Cursor, useBlurOnFulfill, useClearByFocusCell, } from 'react-native-confirmation-code-field'; const styles = StyleSheet.create({ root: {flex: 1, padding: 20}, title: {textAlign: 'center', fontSize: 30}, codeFiledRoot: {marginTop: 20}, cell: { width: 40, height: 40, lineHeight: 38, fontSize: 24, borderWidth: 2, borderColor: '#00000030', textAlign: 'center', }, focusCell: { borderColor: '#000', }, }); //éªŒè¯ç æ ¼å­ä¸ªæ•° const CELL_COUNT = 6; const App = () => { const [value, setValue] = useState(''); const ref = useBlurOnFulfill({value, cellCount: CELL_COUNT}); const [props, getCellOnLayoutHandler] = useClearByFocusCell({ value, setValue, }); return ( &lt;SafeAreaView style={styles.root}> &lt;Text style={styles.title}>Verification&lt;/Text> &lt;CodeField ref={ref} {...props} value={value} onChangeText={setValue} cellCount={CELL_COUNT} rootStyle={styles.codeFiledRoot} keyboardType=\"number-pad\"//å¼¹çª—æ˜¾ç¤ºæ•°ç»„é”®ç›˜ textContentType=\"oneTimeCode\" renderCell={({index, symbol, isFocused}) => ( &lt;Text key={index} style={[styles.cell, isFocused &amp;&amp; styles.focusCell]} onLayout={getCellOnLayoutHandler(index)}> {symbol || (isFocused ? &lt;Cursor /> : null)} &lt;/Text> )} /> &lt;/SafeAreaView> ); }; export default App; react-native SVGæ¨è(å°±æ˜¯æˆ‘ä»¬å¸¸ç”¨çš„é˜¿é‡Œå·´å·´çŸ¢é‡å›¾æ ‡) yarn add react-native-svg react-native-svg-uri æ—¥æœŸç»„ä»¶æ¨èreact-native-datepiker ç”¨äºæ—¥æœŸå¡«å†™ yarn add react-native-datepicker åŸºæœ¬ä½¿ç”¨ï¼ˆæ”¾å‡ºåŸºæœ¬ä½¿ç”¨çš„ä»£ç å±…ç„¶ä½¿å¾—hexoæœ¬èº«å‘½ä»¤startprocessingå¡æ­»ã€‚ã€‚ã€‚ï¼‰ å®šä½ç»„ä»¶æ¨èä½¿ç”¨ react-native-amap-geolocation ä½¿ç”¨é«˜å¾·åœ°å›¾è¿›è¡Œå®šä½ é«˜å¾·åœ°å›¾ç»„ä»¶ åˆ†åˆ«ä½¿ç”¨äº†ä¸¤ä¸ªåŠŸèƒ½ï¼Œä¸€ä¸ªæ˜¯AndroidSDKå’Œä¸€ä¸ªwebæœåŠ¡ ç”³è¯· é«˜åº¦åœ°å›¾çš„keyï¼ˆå¯ä»¥åœ¨bç«™https://www.bilibili.com/video/BV1e5411L7VV?p=49 ï¼‰ ï¼ˆè¿™é‡Œæˆ‘ä¸ªäººè®¾ç½®å¯†é’¥åº“å£ä»¤ä¸ºtaylorï¼‰ è¸©å‘ä¹‹è·¯ï¼š å…¶ä¸­å…³äºPackageName, å¦‚æœé…ç½®äº† build.gradle æ–‡ä»¶ï¼ŒPackageName åº”è¯¥ä»¥ applicaionId ä¸ºå‡†ï¼Œé˜²æ­¢ build.gradle ä¸­çš„ applicationId ä¸ AndroidMainfest.xml ä¸­çš„ PackageName ä¸åŒï¼Œå¯¼è‡´ key é‰´æƒä¸è¿‡ã€‚ è°ƒè¯•ç‰ˆæœ¬ä½¿ç”¨ debug.keystoreï¼Œå‘½ä»¤ä¸ºï¼škeytool -list -v -keystore debug.keystore å‘å¸ƒç‰ˆæœ¬ä½¿ç”¨ apk å¯¹åº”çš„ keystoreï¼Œå‘½ä»¤ä¸ºï¼škeytool -list -v -keystore é¡¹ç›®ä¸‹çš„debug.keystore æ‰‹æœºç«¯æ‰“å¼€GPSï¼Œä¸ç„¶ä¼šæ²¡æœ‰æƒé™ æ‰‹åŠ¨é…ç½®ï¼š ä¸‹è½½ä¾èµ– yarn add react-native-amap-geolocation é…ç½®æ–‡ä»¶ ç¼–è¾‘ android/settings.gradleï¼Œè®¾ç½®é¡¹ç›®è·¯å¾„ï¼š ï¼ˆ+ å·è¡¨ç¤ºè¦æ–°å¢ï¼‰ + include ':react-native-amap-geolocation' + project(':react-native-amap-geolocation').projectDir = new File(rootProject.projectDir, '../node_modules./React-native-amap-geolocation/lib/android') ç¼–è¾‘ android/app/build.gradleï¼Œæ–°å¢ä¾èµ–ï¼š dependencies { + implementation project(':react-native-amap-geolocation') } ç¼–è¾‘ MainApplication.javaï¼šï¼ˆæ³¨æ„rn0.61ä¹‹åçš„ç‰ˆæœ¬é‡Œé¢ï¼Œæˆ‘ä»¬ä¸å†éœ€è¦é…ç½®è¿™ä¸ªï¼Œä¹Ÿå°±æ˜¯0.61ç‰ˆæœ¬ä»¥ä¸Šçš„ä¸ç”¨é…ç½®ï¼‰ + import cn.qiuxiang.react.geolocation.AMapGeolocationPackage; public class MainApplication extends Application implements ReactApplication { @Override protected List&lt;ReactPackage> getPackages() { @SuppressWarnings(\"UnnecessaryLocalVariable\") List&lt;ReactPackage> packages = new PackageList(this).getPackages(); // Packages that cannot be autolinked yet can be added manually here, for example: + packages.add(new AMapGeolocationPackage()); return packages; } } è‡ªåŠ¨é…ç½®ï¼ˆèˆ’æœï¼Œæ‡‚çš„éƒ½æ‡‚ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ react-native link å³å¯å®Œæˆé…ç½®ï¼Œå¦‚æœå› ç‰¹æ®ŠåŸå› æ— æ³•ä½¿ç”¨ react-native link æˆ– link å¤±è´¥ï¼Œåˆ™å¯å‚ç…§ä»¥ä¸‹æ­¥éª¤æ£€æŸ¥å¹¶è¿›è¡Œæ‰‹åŠ¨é…ç½®ã€‚ï¼‰ react-native link react-native-amap-geolocation åŸºæœ¬ä½¿ç”¨ import { PermissionsAndroid, Platform } from \"react-native\"; import { init, Geolocation } from \"react-native-amap-geolocation\"; import axios from \"axios\"; class Geo { //åˆå§‹åŒ– async initGeo() { if (Platform.OS === \"android\") { await PermissionsAndroid.request(PermissionsAndroid.PERMISSIONS.ACCESS_COARSE_LOCATION); } //è¿™é‡Œè¦æ”¾ç½®åœ¨é«˜å¾·åœ°å›¾ä¸Šï¼Œæ”¾ç½®çš„æœåŠ¡å¹³å°ä½androidçš„keyï¼Œåˆå§‹åŒ– await init({ ios: \"891d0cf9dfba7fd2e99b509640f46644\", android: \"891d0cf9dfba7fd2e99b509640f46644\" }); return Promise.resolve(); } //è·å–ç»çº¬åº¦ async getCurrentPosition() { return new Promise((resolve, reject) => { console.log(\"å¼€å§‹å®šä½\"); Geolocation.getCurrentPosition(({ coords }) => { resolve(coords); }, reject); }) } //è·å–åœ°åŒºä¿¡æ¯ async getCityByLocation() { const { longitude, latitude } = await this.getCurrentPosition(); const res = await axios.get(\"https://restapi.amap.com/v3/geocode/regeo\", { // è¿™é‡Œçš„keyå¯¹åº”çš„æ˜¯é«˜å¾·åœ°å›¾ä¸Šwebç«¯çš„key params: { location: `${longitude},${latitude}`, key: \"b63b60478b9fe5e0498c9a6913097056\", } }); return Promise.resolve(res.data); } } export default new Geo(); æ­¤å¤–ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥é…åˆreact-native-pickeræ–¹ä¾¿åœ¨é¡¹ç›®ä¸­ä½¿ç”¨ (ç»™Inputæ ‡ç­¾æ·»åŠ ç‚¹å‡»äº‹ä»¶çš„æ•ˆæœï¼Œç‚¹å‡»åå¯ä»¥å¼¹å‡ºé€‰æ‹©åœ°ç‚¹å…·ä½“æ–¹ä½çš„äº‹ä»¶ï¼Œä¸è¿‡è¿™é‡Œæˆ‘è¿˜åœ¨é¡¹ç›®ä¸­æ·»åŠ äº†citys.jsonæ–‡ä»¶æ‰èƒ½è¿›è¡Œé€‰æ‹©) react-native-picker è‡ªå®šä¹‰picker å®‰è£… yarn add react-native-picker æˆ–è€… npm i react-native-picker --save ä»£ç  import Picker from 'react-native-picker'; import CityJson from '../../../res/citys.json'//æ·»åŠ äº†citys.jsonæ–‡ä»¶ Picker.init({ pickerData: CityJson, //æ˜¾ç¤ºå“ªäº›åŸå¸‚çš„æ•°æ® selectedValue: [\"åŒ—äº¬\", \"åŒ—äº¬\"],//é»˜è®¤é€‰æ‹©çš„æ•°æ® wheelFlex: [1, 1, 0], // æ˜¾ç¤ºçœå’Œå¸‚ pickerConfirmBtnText: \"ç¡®å®š\", pickerCancelBtnText: \"å–æ¶ˆ\", pickerTitleText: \"é€‰æ‹©åŸå¸‚\", onPickerConfirm: data => { // data = [å¹¿ä¸œï¼Œå¹¿å·ï¼Œå¤©æ²³] this.setState( { city: data[1] } ); } }); Picker.show(); æ•ˆæœå›¾ï¼š 5.Mobxmobxæ˜¯reactä¸­çš„å…¨å±€æ•°æ®ç®¡ç†åº“ï¼Œå¯ä»¥ç®€å•å®ç°æ•°æ®çš„è·¨ç»„ä»¶å…±äº«ï¼Œæœ‰ç‚¹ç±»ä¼¼äºvueä¸­çš„vuexæˆ–è€…æ˜¯reactçš„reduxï¼Œæ›´åƒvuexï¼Œä¹Ÿæœ‰åˆ©ç”¨getterã€setteræ”¶é›†ç»„ä»¶çš„æ•°æ®ä¾èµ– å¯ä»¥ç”¨åœ¨RNæˆ–è€…Reactç½‘é¡µå¼€å‘ç­‰ Mobx VS redux å†™æ³•ä¸Šæ›´åå‘äºOOP ç›´æ¥å¯¹å¤æ‚æ•°æ®ä¿®æ”¹ å¹¶éå•ä¸€storeï¼Œè€Œæ˜¯å¤šstore reduxé»˜è®¤ä»¥JavaScriptåŸç”Ÿå¯¹è±¡å½¢å¼å­˜å‚¨ï¼Œè€ŒMobxç”¨å¯è§‚å¯Ÿå¯¹è±¡ ä¼˜ç¼ºç‚¹ å­¦ä¹ æˆæœ¬å‘¢å°ï¼Œé¢å‘å¯¹è±¡ï¼Œå¤šTSå‹å¥½ï¼ˆä¼˜ï¼‰ è¿‡äºè‡ªç”±ï¼Œæä¾›çš„çº¦å®šæ¯”è¾ƒå°‘ï¼Œå®¹æ˜“å¯¼è‡´å›¢é˜Ÿå¼€å‘é£æ ¼ä¸ä¸€ç»Ÿä¸€ï¼ˆç¼ºï¼‰ ç›¸å…³ä¸­é—´ä»¶å°‘ï¼Œé€»è¾‘å±‚ä¸šåŠ¡æ•´åˆæ˜¯ä¸ªé—®é¢˜ï¼ˆç¼ºï¼‰ ä½¿ç”¨æ­¥éª¤ å®‰è£…ä¾èµ– mobx æ ¸å¿ƒåº“ mobx-react æ–¹ä¾¿åœ¨reactä¸­ä½¿ç”¨mobxæŠ€æœ¯çš„åº“ @babel/plugin-proposal-decorators è®© rn é¡¹ç›®æ”¯æŒ es7 çš„è£…é¥°å™¨è¯­æ³•çš„åº“ yarn add mobx mobx-react @babel/plugin-proposal-decorators åœ¨ babel.config.jsæ·»åŠ ä»¥ä¸‹é…ç½® plugins: [ ['@babel/plugin-proposal-decorators', { 'legacy': true }] ] æ–°å»ºæ–‡ä»¶ mobx\\index.js ç”¨æ¥å­˜æ”¾ å…¨å±€æ•°æ® @observableæ˜¯es7è£…é¥°å™¨çš„è¯­æ³•ï¼ˆä½¿ç”¨åˆ°äº†Object.definepropertyï¼‰ import { observable, action } from \"mobx\"; class RootStore { // observable è¡¨ç¤ºæ•°æ®å¯ç›‘æ§ è¡¨ç¤ºæ˜¯å…¨å±€æ•°æ® @observable name = \"hello\"; // actionè¡Œä¸º è¡¨ç¤º changeNameæ˜¯ä¸ªå¯ä»¥ä¿®æ”¹å…¨å±€å…±äº«æ•°æ®çš„æ–¹æ³• @action changeName(name) { this.name = name; } } export default new RootStore(); åœ¨æ ¹ç»„ä»¶ä¸­æŒ‚è½½ é€šè¿‡ Provider æ¥æŒ‚è½½å’Œä¼ é€’ï¼ŒåŒ…è£¹åœ¨å…¶ä¸­çš„ç»„ä»¶å¯ä»¥æ‹¿åˆ°å…¨å±€æ•°æ® import React, { Component } from 'react'; import { View} from 'react-native'; import rootStore from \"./mobx\"; import { Provider} from \"mobx-react\"; class Index extends Component { // æ­£å¸¸ render() { return ( &lt;View > &lt;Provider rootStore={rootStore} > &lt;Sub1>&lt;/Sub1> &lt;/Provider> &lt;/View> ); } } ç»„ä»¶ä¸­ä½¿ç”¨ import React, { Component } from 'react'; import { View, Text } from 'react-native'; import {inject,observer } from \"mobx-react\"; @inject(\"rootStore\") // æ³¨å…¥ä¼ å…¥çš„å±æ€§ç”¨æ¥è·å– å…¨å±€æ•°æ®çš„ @observer // å½“å…¨å±€å‘ç”Ÿæ”¹å˜äº† ç»„ä»¶çš„é‡æ–°æ¸²æŸ“ ä»è€Œæ˜¾ç¤ºæœ€æ–°çš„æ•°æ®ï¼Œæœ‰ç‚¹ç±»ä¼¼setState class Sub1 extends Component { changeName = () => { // ä¿®æ”¹å…¨å±€æ•°æ® this.props.rootStore.changeName(Date.now()); } render() { console.log(this); return ( &lt;View>&lt;Text onPress={this.changeName}>{this.props.rootStore.name}&lt;/Text>&lt;/View> ); } } export default Index; reactä¸­ä½¿ç”¨mobxnpm i mobx@5 import React from 'react' import {observable, autorun} from 'mobx' // å¯¹æ•°æ®è¿›è¡Œç›‘å¬ const obNumber = observable.box(0) const obObject = observable({name: \"allen\"}) const obArr = observable([]) // è·å–æ•°æ® console.log(obNumber.get()) console.log(obObject.name) //ä¿®æ”¹æ•°æ® obNumber.set(20) obObject.name = \"Mikasa\" // ç¬¬ä¸€æ¬¡ä¼šè‡ªåŠ¨æ‰§è¡Œï¼Œæ¯æ¬¡ç›‘å¬çš„æ•°æ®ï¼ˆè¿™é‡Œæ˜¯obNumberï¼‰ //å‘ç”Ÿæ”¹å˜éƒ½ä¼šå›è°ƒè¯¥å‡½æ•°ï¼Œæœ‰ç‚¹åƒvue3çš„watchEffect autorun(() => { console.log(obNumber.get()); }) export default function test() { return ( &lt;div>test&lt;/div> ) } é¡¹ç›®ä¸­ä½¿ç”¨ åœ¨srcä¸‹æ–°å»ºä¸€ä¸ªmobxç›®å½• æ–°å»º store.js //store.js import {observable} from 'mobx' const store = observable({ isShow: true, list: [], cityName: 'beijing' }) export default store; ä½¿ç”¨ä¸­é€šè¿‡useEffectç»‘å®šå¥½ autorun å’Œ storeæŸä¸ªå€¼çš„æ”¹å˜å³å¯ï¼Œååˆ†fast å¦‚æœå¼€å¯äº†ä¸¥æ ¼æ¨¡å¼ï¼Œåœ¨å¤–é¢é€šè¿‡ store.fn()è°ƒç”¨actionæ¥æ›´æ”¹storeä¸­çš„çŠ¶æ€å³å¯ import { observable, configure, action } from 'mobx' //è®¾ç½®ä¸¥æ ¼æ¨¡å¼ï¼Œå¿…é¡»é€šè¿‡actionsçš„æ–¹å¼ä¿®æ”¹æ•°æ® configure({ enforceActions: 'always' }) const store = observable({ isShow: true, list: [], cityName: 'beijing', Show() { this.isShow = true }, Hide() { this.isShow = false } }, { // æ ‡è®°ä¸¤ä¸ªæ–¹æ³•æ˜¯actionï¼Œä¸“é—¨ç”¨æ¥ä¿®æ”¹ Show: action, Hide: action }) export default store; create-react-appä¸­æ”¯æŒES7ä½†æ˜¯å®˜æ–¹çš„å†™æ³•ä»ç„¶æ˜¯æŒ‰ç…§ä¸Šé¢RNç”¨çš„å“ªé‚£ç§æ–¹æ³•ä¸€æ ·çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥è‡ªå·±å®šå¤ºä½¿ç”¨å“ªç§æ–¹æ³• @observable name = \"hello\"; // actionè¡Œä¸º è¡¨ç¤º changeNameæ˜¯ä¸ªå¯ä»¥ä¿®æ”¹å…¨å±€å…±äº«æ•°æ®çš„æ–¹æ³• @action changeName(name) { this.name = name; } ä¸è¿‡ç›®å‰vscodeå’Œreacté¡¹ç›®å¹¶ä¸æ”¯æŒè¿™ç§@çš„es7è¯­æ³•ï¼Œéœ€è¦æˆ‘ä»¬å»è¿›è¡Œè®¾ç½®ï¼š vscodeçš„è®¾ç½®ä¸­å‹¾ä¸­ experimentalDecorators é€‰é¡¹ ç„¶åå®‰è£…ä¾èµ– npm i @babel/core @babel/plugin-proposal-decorators @babel/preset-env æ ¹ç›®å½•ä¸‹åˆ›å»º .babelrcæ–‡ä»¶ //.babelrc { \"presets\": [ \"@babel/preset-env\" ], \"plugins\": [ [ \"@babel/plugin-proposal-decorators\", { \"legacy\": true } ] ] } æ ¹ç›®å½•ä¸‹åˆ›å»ºconfig-override.js const path = require('path') const { override, addDecoratorsLegacy } = require('customize-cra') function resolve(dir) { return path.join(__dirname, dir) } const customize = () => (config, env) => { config.resolve.alias['@'] = resolve('src') if (env === 'production') { config.externals = { 'react': 'React', 'react-dom': 'ReactDOM' } } return config }; module.exports = override(addDecoratorsLegacy(), customize()) å®‰è£…ä¾èµ– npm i customize-cra react-app-rewired ä¿®æ”¹package.json ... \"scripts\": { \"start\": \"react-app-rewired start\", \"build\": \"react-app-rewired build\", \"test\": \"react-app-rewired test\", \"eject\": \"react-app-rewired eject\" }, ... 6.RN &amp; FlutterRN ä¼˜ç‚¹ï¼š RNçš„æ•ˆç‡ç”±äºæ˜¯å°†Viewç¼–è¯‘æˆäº†åŸç”ŸView,æ‰€ä»¥æ•ˆç‡ä¸Šè¦æ¯”åŸºäºCordovaçš„HTML5é«˜å¾ˆå¤šã€‚ ç¨‹åºç»„ä»¶çœ‹èµ·æ¥å°±åƒåŸç”Ÿç»„ä»¶ï¼ˆä¾‹å¦‚ï¼ŒiOSè®¾å¤‡ä¸Šçš„æŒ‰é’®çœ‹èµ·æ¥å°±åƒåŸç”Ÿ iOS æŒ‰é’®ï¼ŒAndroid ä¸Šä¹Ÿæ˜¯å¦‚æ­¤ï¼‰ ä»¥JSä¸ºç¼–ç¨‹è¯­è¨€ ç¨³å®šæ€§ï¼ˆä¸Šå¸‚ 5 å¹´ä»¥ä¸Šï¼‰ ç¼ºç‚¹ï¼š ä½†æ˜¯å¦‚æœæˆ‘ä»¬ç¢°ä¸Šäº†å¤æ‚çš„ç»„ä»¶æ¸²æŸ“ç»“æ„æ¯”å¦‚æˆ‘ä»¬æ¸²æŸ“ä¸€ä¸ªå¤æ‚çš„ListView,æ¯ä¸€ä¸ªå°çš„æ§ä»¶,éƒ½æ˜¯ä¸€ä¸ªnativeçš„view,ç„¶åç›¸äº’ç»„åˆå åŠ .æƒ³æƒ³æ­¤æ—¶å¦‚æœæˆ‘ä»¬çš„listå†éœ€è¦æ»‘åŠ¨åˆ·æ–°,ä¼šæœ‰å¤šå°‘ä¸ªå¯¹è±¡éœ€è¦æ¸²æŸ“.æ‰€ä»¥ä¹Ÿå°±æœ‰äº†å‰é¢æ‰€è¯´çš„RNçš„åˆ—è¡¨æ–¹æ¡ˆä¸å‹å¥½ React Native ä½¿ç”¨æ¡¥æ¥å’ŒåŸç”Ÿå…ƒç´ ï¼Œå› æ­¤å¯èƒ½éœ€è¦é’ˆå¯¹æ¯ä¸ªå¹³å°å•ç‹¬ä¼˜åŒ–ï¼Œå®ƒå¯èƒ½ä¼šä½¿ä½¿ç”¨ React Nativeçš„åº”ç”¨ç¨‹åºå¼€å‘æ—¶é—´æ›´é•¿ã€‚ Flutter ä¼˜ç‚¹ï¼š å¸æ”¶äº†å‰ä¸¤è€…çš„æ•™è®­ä¹‹å,åœ¨æ¸²æŸ“æŠ€æœ¯ä¸Š,é€‰æ‹©äº†è‡ªå·±å®ç°(GDI),ç”±äºæœ‰æ›´å¥½çš„å¯æ§æ€§ï¼Œæ‰€ä»¥åœ¨æ€§èƒ½æ–¹é¢æ¯”RNæ›´é«˜ä¸€ç­¹ å…±äº«åŸŸæ›´å¹¿ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ç›¸åŒçš„ä»£ç åº“å°†æœ¬æœºåº”ç”¨ç¨‹åºä¼ é€åˆ°äº”ä¸ªæ“ä½œç³»ç»Ÿï¼šiOSã€Androidã€Windowsã€macOS å’Œ Linuxï¼›ä»¥åŠé’ˆå¯¹ Firefoxã€Chromeã€Safari æˆ– Edge ç­‰æµè§ˆå™¨çš„ç½‘ç»œä½“éªŒã€‚Flutter ç”šè‡³å¯ä»¥åµŒå…¥åˆ°æ±½è½¦ã€ç”µè§†å’Œæ™ºèƒ½å®¶ç”µä¸­ï¼ˆè°·æ­Œå®˜æ–¹è¯´çš„ï¼‰ ç¼ºç‚¹ï¼š ä½†æ˜¯Dartæ˜¯AOTç¼–è¯‘çš„ï¼ŒDartè¯­è¨€å—ä¼—å°ï¼Œä¸”Flutterçš„ç¬¬ä¸‰æ–¹åº“ç›¸å¯¹è¾ƒå°‘","categories":[{"name":"å‰ç«¯","slug":"å‰ç«¯","permalink":"https://taylor12138.github.io/categories/%E5%89%8D%E7%AB%AF/"}],"tags":[],"author":"Hello"},{"title":"React-native","slug":"React-native","date":"2021-06-24T16:00:00.000Z","updated":"2022-03-04T09:35:15.759Z","comments":true,"path":"2021/06/25/react-native/","link":"","permalink":"https://taylor12138.github.io/2021/06/25/react-native/","excerpt":"","text":"1.React Nativeæ¦‚è¿°å¼•å…¥å…³äºReact Nativeä¸€äº›äººçš„è¯„ä»· ä¼˜ç‚¹ï¼š 1.å®Œå…¨é‡‡ç”¨JavaScript 2.è·¨å¹³å°ï¼ŒWrite Once, Run anywhereå˜å¾—å¯èƒ½ï¼Œå°¤å…¶æ˜¯Androidå’ŒIOSä¸¤ç«¯ 3.ç¤¾åŒºç»™åŠ›ï¼ŒReact Nativeæœ‰ç€å¼ºå¤§çš„ç¤¾åŒºï¼Œä¼—å¤šå¼€å‘è€…æä¾›äº†å„ç§ç±»å‹çš„ç»„ä»¶ï¼ˆå¯¹æ¯”å›½å†…é˜¿é‡Œç³»ï¼Œçœ‹èµ·æ¥å°±æ˜¯æŸä¸ªäººçš„ç»©æ•ˆï¼‰ ç¼ºç‚¹ï¼š 1.å¤æ‚çš„çŠ¶æ€ç®¡ç†ï¼ˆè®©æˆ‘æƒ³èµ·é‡Œè¢«reduxæ”¯é…çš„ææƒ§ï¼‰ï¼Œå³ä½¿ä½ ä¼šä½¿ç”¨Reactï¼Œä½†ä¹Ÿè§‰å¾—å®ƒçš„é¡µé¢åˆ‡æ¢æœ‰ç‚¹ç»• 2.åˆ›å»ºæ–°çš„åŸç”Ÿç»„ä»¶å¤æ‚ã€‚å¦‚æœè¦åˆ›å»ºä¸€ä¸ªä¹‹å‰ä»æœªå‡ºç°è¿‡çš„åŸç”Ÿç»„ä»¶ï¼Œä¸ä»…éœ€è¦æ‡‚å¾—Androidå¼€å‘ï¼Œè¿˜å¾—æ‡‚å¾—IOSå¼€å‘ å®‰è£…ä¾èµ–Nodeã€JDK å’Œ Android Studioã€‚ è™½ç„¶ä½ å¯ä»¥ä½¿ç”¨ä»»ä½•ç¼–è¾‘å™¨æ¥å¼€å‘åº”ç”¨ï¼ˆç¼–å†™ js ä»£ç ï¼‰ï¼Œä½†ä½ ä»ç„¶å¿…é¡»å®‰è£… Android Studio æ¥è·å¾—ç¼–è¯‘ Android åº”ç”¨æ‰€éœ€çš„å·¥å…·å’Œç¯å¢ƒã€‚(è®°å¾—JDKä¸€å®šè¦è£…1.8ç‰ˆæœ¬çš„ï¼ˆ2021å¹´ï¼‰ï¼ï¼ï¼) è‹¹æœå…¬å¸ç›®å‰åªå…è®¸åœ¨ Mac ç”µè„‘ä¸Šå¼€å‘ iOS åº”ç”¨ã€‚å¦‚æœä½ æ²¡æœ‰ Mac ç”µè„‘ï¼Œé‚£ä¹ˆåªèƒ½è€ƒè™‘ä½¿ç”¨æ²™ç›’ç¯å¢ƒï¼Œæˆ–è€…å…ˆå¼€å‘ Android åº”ç”¨äº†ã€‚ è·Ÿç€å®˜ç½‘æ­å»ºç¯å¢ƒ https://reactnative.cn/docs/environment-setup ç„¶åå¯ä»¥åœ¨vscodeä¸Šè¿è¡Œå‘½ä»¤åˆ›å»ºreact-nativeé¡¹ç›® npx react-native init AwesomeProject ï¼ˆä½¿ç”¨ React Native å†…å»ºçš„å‘½ä»¤è¡Œå·¥å…·æ¥åˆ›å»ºä¸€ä¸ªåä¸ºâ€AwesomeProjectâ€çš„æ–°é¡¹ç›®ã€‚è¿™ä¸ªå‘½ä»¤è¡Œå·¥å…·ä¸éœ€è¦å®‰è£…ï¼Œå¯ä»¥ç›´æ¥ç”¨ node è‡ªå¸¦çš„npxå‘½ä»¤æ¥ä½¿ç”¨ï¼šï¼‰ äº¦æˆ–è€…é€šè¿‡ npx create-react-native-app æ­å»ºé¡¹ç›® æ­å»ºé¡¹ç›®çš„ä¸åŒreal diff between â€œcreate-react-native-app myprojectâ€ and â€œreact-native init myprojectâ€ overflowä¸Šçš„å›ç­”ï¼š ( create-react-native-appâ€œCRNAâ€) CLI åŸºäºExpoæ„å»ºé¡¹ç›®æ¨¡æ¿ï¼ŒExpoæ˜¯ä¸€ä¸ªç¬¬ä¸‰æ–¹å·¥å…·åŒ…ï¼Œå…è®¸æ‚¨ä»…ä½¿ç”¨ JavaScriptç¼–å†™è·¨å¹³å°çš„ React Native åº”ç”¨ç¨‹åºï¼Œå¹¶ä¸ºè®©åº”ç”¨ç¨‹åºåœ¨çœŸå®è®¾å¤‡ä¸Šè¿è¡Œæä¾›æ›´æµç•…çš„å·¥ä½œæµç¨‹ã€‚æ­¤å¤–ï¼ŒExpo æä¾›å¯¹å¤§é‡åŸç”Ÿ APIçš„è®¿é—®ï¼Œæ‚¨é€šå¸¸éœ€è¦åº“æˆ–è‡ªå®šä¹‰åŸç”Ÿä»£ç ã€‚ Expo å¾ˆæ£’ï¼Œåœ¨ç†æƒ³æƒ…å†µä¸‹ï¼Œå®ƒæ˜¯å¤§å¤šæ•°åº”ç”¨ç¨‹åºå¼€å‘äººå‘˜å¯èƒ½æ›´å–œæ¬¢ä½¿ç”¨çš„ï¼Œä½† Expo çš„æ¶æ„è®¾ç½®äº†ä¸€ä¸ªä¸å¹¸çš„é™åˆ¶ï¼šæ‚¨æ— æ³•ç¼–å†™è‡ªå®šä¹‰ Native Modulesï¼Œæˆ–é›†æˆä¾èµ–äºè‡ªå®šä¹‰ Native ä»£ç çš„ç¬¬ä¸‰æ–¹åº“æ²¡æœ‰å†…ç½®åˆ°Expoã€‚è¿™æ„å‘³ç€ä½ åªèƒ½è®¿é—® React Native å’Œ Expo æä¾›çš„åŸç”ŸåŠŸèƒ½ï¼Œè€Œä¸èƒ½è½»æ˜“æ‰©å±•å®ƒã€‚ ç›¸æ¯”ä¹‹ä¸‹ï¼Œreact-nativeCLI çš„initå‘½ä»¤åˆ›å»ºä¸€ä¸ªç®€å•çš„ React Native åº”ç”¨ç¨‹åºæ¨¡æ¿ï¼Œæ‚¨å¯ä»¥ä¿®æ”¹åŸç”Ÿ iOS å’Œ Android é¡¹ç›®ã€‚è¿™ç§æ–¹æ³•çš„ç¼ºç‚¹æ˜¯æ‚¨éœ€è¦åœ¨æ‚¨çš„è®¡ç®—æœºä¸Šè®¾ç½®æœ¬æœº iOS å’Œ Android æ„å»ºé“¾ï¼Œå¹¶ä¸”å¼€å§‹å¼€å‘å’Œéƒ¨ç½²æ‚¨çš„åº”ç”¨ç¨‹åºè¦éº»çƒ¦å¾—å¤šã€‚ å¹¸è¿çš„æ˜¯ï¼ŒExpo æä¾›äº†ä¸€ç§å°† CRNAåº”ç”¨ç¨‹åºä¸å…¶åŸç”Ÿåº”ç”¨ç¨‹åºå¤–å£³åˆ†ç¦»çš„æ–¹æ³•ã€‚è¿™ä¼šå°† CRNA é¡¹ç›®è½¬æ¢ä¸ºç±»ä¼¼äºç”± åˆ›å»ºçš„æ™®é€šé¡¹ç›®çš„ä¸œè¥¿react-native initï¼Œä½†å¯ä»¥è®¿é—®æ‰€æœ‰ Expo SDK åŠŸèƒ½ã€‚ åœ¨å®è·µä¸­ï¼Œå¯¹äºå¤§å¤šæ•°åˆå­¦è€…å’Œæ–°é¡¹ç›®æ¥è¯´ï¼Œæœ€å¥½çš„æ–¹æ³•æ˜¯ä» å¼€å§‹create-react-native-appï¼Œç„¶åè¯„ä¼°æ‚¨ä»¥åæ˜¯å¦éœ€è¦åˆ†ç¦»ã€‚Expoæä¾›äº†ä¸€ä¸ªæ–¹ä¾¿çš„æŒ‡å—æ¥å¸®åŠ©åšå‡ºè¿™ä¸ªå†³å®šã€‚ è€Œä¸”ä¹Ÿæ¨èè£…Yarnï¼Œå®ƒæ˜¯Facebookæä¾›çš„æ›¿ä»£npmçš„å·¥å…·ï¼Œå¯ä»¥åŠ é€Ÿnodeæ¨¡å—çš„ä¸‹è½½ npm install yarn -g // ä½¿ç”¨npmå…¨å±€å®‰è£…yarn æ£€æŸ¥æ˜¯å¦å®‰è£…æˆåŠŸ yarn -v å®‰å“æ¨¡æ‹Ÿå™¨ä¸è¿‡å¬è¯´Android studioæœ¬èº«è‡ªå¸¦çš„æ¨¡æ‹Ÿå™¨åˆå¡åˆæ…¢ï¼Œé™„ä¸Šæ¨¡æ‹Ÿå™¨æ¨èçš„ç½‘å€ https://blog.csdn.net/huanhuan59/article/details/80281509 æ¯”å¦‚ä¸‹è½½å¤œç¥æ¨¡æ‹Ÿå™¨ï¼Œç„¶ååœ¨ç›®å½•çš„binæ–‡ä»¶å¤¹ä¸‹ï¼ˆè¿æ¥Android studioï¼ˆå¤œç¥çš„ç«¯å£å·æ˜¯62001ï¼‰ï¼‰ nox_adb.exe connect 127.0.0.1:62001 ä¹‹åè¿æ¥å°±å¯ä»¥è¾“å…¥adb connect 127.0.0.1:62001å‘½ä»¤è¿æ¥ä¸Šæ¨¡æ‹Ÿå™¨ adb connect 127.0.0.1:62001 è¸©å‘ä¹‹è·¯ï¼šè¿æ¥åè¿è¡Œ npx react-native run-androidï¼Œç»™æˆ‘æŠ¥äº†No connected devicesçš„é”™è¯¯ï¼Œï¼Œè€Œä¸”æˆ‘åœ¨è¿æ¥adbçš„æ—¶å€™å‡ºç°è¿™ç§æƒ…å†µ è¿™ç§æƒ…å†µä¸‹è¯´æ˜ä½ çš„æ¨¡æ‹Ÿå™¨çš„adbç‰ˆæœ¬å¤ªä½ï¼Œè¢«æ€æ­»äº†(æ— è¯­ï¼Œç ”ç©¶äº†å¥½ä¹…è¿™ä¸ªé—®é¢˜) å¤„ç†æ–¹å¼ï¼šå…ˆæŠŠä½ å¤œç¥æ¨¡æ‹Ÿå™¨ä¸­çš„nox_adb.exeåˆ é™¤ï¼Œç„¶ååœ¨ä½ çš„SDKé‡Œé¢çš„platform-toolsä¸­æ‰¾åˆ°adb.exe,æŠŠä½ çš„SDKé‡Œé¢çš„adbå¤åˆ¶åˆ°å¤œç¥æ¨¡æ‹Ÿå™¨çš„binä¸­ï¼Œè®°å¾—è¦æ”¹åå­—ï¼ˆæ³¨æ„è¦æŠŠadb.exeæ”¹ä¸ºnox_adb.exeï¼‰ çœŸæœº å‡†å¤‡ä¸€å° Android æ‰‹æœº, é€šè¿‡æ•°æ®çº¿ è¿æ¥ åˆ°ç”µè„‘ï¼Œè®¾ç½®å¯ç”¨ USBè°ƒè¯• ä¸€èˆ¬çš„æ‰‹æœºåœ¨ è®¾ç½® ä¸­å¯ä»¥ç›´æ¥æ‰¾åˆ° å¼€å‘è€…é€‰é¡¹ è¿›è¡Œå¼€å¯, å¦‚æœ æ‰¾ä¸åˆ° , å°±è‡ªè¡Œç™¾åº¦æŸ¥ä¸€ä¸‹ æ‰‹æœºè¿æ¥ç”µè„‘æˆåŠŸåè¿è¡Œæ£€æµ‹å‘½ä»¤ adb devices , å¦‚æœæœ‰è¾“å‡ºè®¾å¤‡åˆ—è¡¨ä¸ ID ç›¸å…³çš„å­—ç¬¦ä¸²å°±è¯æ˜æ‰‹æœºå’Œç”µè„‘æ˜¯è¿æ¥æˆåŠŸäº†ï¼Œå¦‚æœæ²¡æœ‰æ˜¾ç¤ºè®¾å¤‡å·ï¼Œåˆ™è¯´æ˜è¿æ¥æœ‰é—®é¢˜ï¼Œä¸€å®šè¦ä¿è¯æ‰‹æœºå’Œç”µè„‘æ˜¯æ­£å¸¸è¿æ¥çŠ¶æ€ ä¸‹è½½æŠ•å½±å·¥å…·scrcpy è§£å‹ä¹‹åï¼Œæ‰“å¼€scrpy.exeå³å¯ è¸©å‘ä¹‹è·¯ï¼šä½¿ç”¨å°ç±³æ‰‹æœºå®‰è£…RNçš„é¡¹ç›®ä¼šæŠ¥é”™ï¼šTask :app:installDebug FAILED è§£å†³æ–¹æ³•ï¼šå…ˆæ£€æŸ¥äº†ä¸€ä¸‹å¼€å‘è€…é€‰é¡¹ï¼ŒUSBè°ƒè¯•ã€æœªçŸ¥æº éƒ½æ˜¯å¼€å¯çš„ï¼› ç„¶åå‘ç° â€œå¯ç”¨MIUIä¼˜åŒ–â€è¿™ä¸€é¡¹æ˜¯å¼€å¯çš„ï¼ŒæŠŠå®ƒå…³æ‰ï¼ˆè®¾ç½®â€”-æ›´å¤šè®¾ç½®â€”-å¼€å‘è€…é€‰é¡¹â€”-å¯ç”¨MIUIä¼˜åŒ– å…³é—­ï¼‰ ç¡®ä¿ä½ å…ˆè¿è¡Œäº†æ¨¡æ‹Ÿå™¨æˆ–è€…è¿æ¥äº†çœŸæœºï¼Œç„¶ååœ¨ä½ çš„é¡¹ç›®ç›®å½•ä¸­è¿è¡Œyarn androidæˆ–è€…yarn react-native run-androidï¼š cd AwesomeProject yarn android # æˆ–è€… npm run android # æˆ–è€… yarn react-native run-android # æˆ–è€… npx react-native run-android è¸©å‘ä¹‹è·¯ï¼šCould not receive a message from the daemon è§£å†³æ–¹æ³•ï¼šå…³é—­ç”µè„‘çš„ç§»åŠ¨çƒ­ç‚¹ï¼Œé—®é¢˜å³è§£å†³ã€‚ è¿è¡ŒæˆåŠŸ é¡¹ç›®ç›®å½•ä»‹ç»App.jsï¼šé¡¹ç›®æ ¹ç»„ä»¶ index.jsï¼šé¡¹ç›®å…¥å£æ–‡ä»¶ _tests_ï¼šæµ‹è¯•æ–‡ä»¶ app.jsonï¼šé…ç½®æ–‡ä»¶ metro.config.jsï¼šfacebookçš„å·¥ç¨‹æ„å»ºå·¥å…· .prettierrc.jsï¼šæ§åˆ¶ä»£ç æ ¼å¼åŒ–çš„é£æ ¼ é¡ºä¾¿æ¨èä¸¤ä¸ªVScodeå¸¸ç”¨çš„RNæ’ä»¶ Prettier - Code formatterï¼ˆè´Ÿè´£æ ¼å¼åŒ–ï¼‰ã€React-Native snippetsï¼ˆå¿«æ·è¾“å…¥ï¼‰ jsxæ¨¡æ¿ç”Ÿæˆçš„å¿«æ·é”®ï¼ˆç±»å¼ç»„ä»¶ï¼‰ï¼š rnc jsxæ¨¡æ¿ç”Ÿæˆçš„å¿«æ·é”®ï¼ˆå‡½æ•°å¼ç»„ä»¶ï¼‰ï¼š rnf 2.React NativeåŸºæœ¬è¯­æ³•ä¸‰ä¸ªå¯¹è±¡è¿™é‡Œä»‹ç»ä¸‰ä¸ªå¯¹è±¡ StyleSheetï¼Œæˆ‘ä»¬å»ºè®®ä½¿ç”¨StyleSheet.createæ¥é›†ä¸­å®šä¹‰ç»„ä»¶çš„æ ·å¼ï¼Œé€šè¿‡ create å¦å¤–å®šä¹‰styleæ ·å¼å¹¶ä¸”å¯¼å…¥ï¼Œé‡Œé¢çš„å±æ€§åè¦ä½¿ç”¨é©¼å³°å‘½åæ³• Viewï¼Œè§†å›¾ç»„ä»¶,ç›¸å½“äºdivæ ‡ç­¾ï¼Œä¸èƒ½æ”¾æ–‡æœ¬ï¼Œä¸èƒ½ç»‘å®šç‚¹å‡»äº‹ä»¶ ï¼ˆç‚¹å‡»äº‹ä»¶å¿…é¡»ç”± TouchableOpacityæ›¿ä»£ ï¼‰ Textï¼Œæ–‡æœ¬ç»„ä»¶ï¼Œç›¸å½“äºpæ ‡ç­¾ï¼Œæ–‡å­—ä¸€å®šè¦æ”¾åœ¨å…¶ä¸­ï¼Œæ”¯æŒç»‘å®šç‚¹å‡»äº‹ä»¶ numberOfLineså±æ€§ï¼Œç”¨äºé™åˆ¶æ–‡æœ¬è¡Œæ•° ellipsizeModeå±æ€§ï¼Œä¸€è¡Œå†™ä¸å®Œï¼Œä»¥ â€¦ çš„å½¢å¼çœç•¥ import React from 'react' import { StyleSheet, View, Text } from 'react-native' const App = () => { //ç©ºæ ‡ç­¾ï¼Œå®ƒä¹Ÿå¯ä»¥å®ç°fragmentçš„æ•ˆæœ return ( &lt;> &lt;View style={styles.view}> &lt;Text>helloWorld&lt;/Text> &lt;/View> &lt;/> ) } // å®šä¹‰å¯¹è±¡æ ·å¼ const styles = StyleSheet.create({ view: { height: 200, width: 200, backgroundColor: \"rgba(200, 255, 0, 0.5)\", color: 'red' //hello worldä¸ä¼šå˜æˆçº¢è‰² } }); export default App; React Nativeçš„æ ·å¼RNçš„é»˜è®¤æ ·å¼ï¼š flexå¸ƒå±€ æ–¹å‘ flex-direction: column åœ¨react-nativeä¸­æ²¡æœ‰æ ·å¼ç»§æ‰¿ï¼Œæ¯ä¸€ä¸ªç»„ä»¶éƒ½è¦å•ç‹¬è®¾ç½®æ ·å¼ å•ä½ä¸èƒ½åŠ  &#39;px&#39;ã€&#39;vw&#39;ã€&#39;vh&#39;ï¼Œä¸èƒ½ä½¿ç”¨fontSize: &#39;100px&#39;çš„å½¢å¼ï¼Œå¿…é¡»ä½¿ç”¨ fontSize: 100ï¼›ä½†æ˜¯å¯ä»¥åŠ ç™¾åˆ†æ¯” &#39;%&#39;ï¼Œwidth:&quot;100%&quot; æ—¢ç„¶ä¸èƒ½åŠ &#39;vw&#39;ã€&#39;vh&#39;ï¼Œå¦‚ä½•å®ç°ä¾æ®å±å¹•çš„å®½åº¦ / é«˜åº¦ï¼Ÿ import { Dimensions } from 'react-native'; const windowWidth = Dimensions.get('window').width; const windowHeight = Dimensions.get('window').height; transfromçš„ä½¿ç”¨ &lt;Text style={{transfrom:[{translateY:300}, {scale:2}]}}>&lt;/Text> å®‰å“å†…éƒ¨å•ä½ä¸æ˜¯pxï¼Œæ˜¯dpã€‚æ‰€ä»¥éœ€è¦æŠŠpxè½¬å˜ä¸ºå®‰å“å†…éƒ¨çš„dpã€‚æ­¤æ—¶å¯ä»¥åœ¨srcæ–‡ä»¶ä¸‹æ–°å»ºä¸€ä¸ªutilsæ–‡ä»¶å¤¹ï¼Œç„¶åæ–°å»ºstyleKits.jsæ–‡ä»¶ //è®¾è®¡ç¨¿å®½åº¦ / å…ƒç´ å®½åº¦ = æ‰‹æœºå±å¹• / æ‰‹æœºä¸­å…ƒç´ çš„å®½åº¦ //æ‰‹æœºä¸­å…ƒç´ çš„å®½åº¦ = å…ƒç´ å®½åº¦ * æ‰‹æœºå±å¹• / è®¾è®¡ç¨¿å®½åº¦ //è®¾è®¡ç¨¿çš„å®½åº¦ç”±ç¾å·¥å†³å®šï¼Œè¿™é‡Œæš‚å®šä¸º375 import { Dimensions } from \"react-native\" export const screenHeight = Dimensions.get('window').height; export const screenWidth = Dimensions.get('window').width; export const pxToDp = (elePx) => screenWidth * elePx / 375; æŒ‰ç…§ä»¥ä¸Šå…¬å¼ï¼Œå½“ä½¿ç”¨åˆ°æ ·å¼ï¼ˆpxï¼‰æ—¶ï¼Œç›´æ¥å¥—ç”¨è¯¥æ–¹æ³•å³å¯ ç›¸å¯¹ä¹‹å‰å­¦ä¹ çš„Reactæ”¹åŠ¨å¯¹äºå±æ€§stateã€propsçš„ä½¿ç”¨ï¼Œå’Œåœ¨Reacté‡Œé¢å¦‚å‡ºä¸€è¾™ï¼ˆå‡½æ•°ç»„ä»¶çš„stateã€refè¿˜æ˜¯ä½¿ç”¨Hookï¼‰ ç§»åŠ¨ç«¯çš„ç‚¹å‡»äº‹ä»¶ï¼šonPress import React from \"react\"; import { View, Text } from \"react-native\"; //ç±»å¼ç»„ä»¶çš„state export default class MyComponent extends React.Component { state = { isHot: true } change = () => { const { isHot } = this.state; this.setState({ isHot: !isHot }) } render() { const { isHot } = this.state return ( &lt;View> &lt;Text onPress={this.change}>today is {isHot ? 'hot' : 'cold'}&lt;/Text> &lt;/View> ) } } ç±»å¼ç»„ä»¶çš„propsï¼Œç›´æ¥ this.props.å±æ€§åä½¿ç”¨ å‡½æ•°å¼ç»„ä»¶çš„props const MyComponent = (props) => { const { name, sex, age } = props; return ( &lt;ul> &lt;li>æ€§åï¼š{name}&lt;/li> &lt;li>æ€§åˆ«ï¼š{sex}&lt;/li> &lt;li>å¹´é¾„ï¼š{age}&lt;/li> &lt;/ul> ) } æ‰€ä»¥ç»“è®ºï¼šå…¶å®æ²¡æœ‰ä»€ä¹ˆæ”¹åŠ¨ï¼Œåªæ˜¯å¤šäº†å¾ˆå¤šReact Nativeå¸¦çš„ç§»åŠ¨ç«¯ç»„ä»¶ç½¢äº† 3.React Nativeç»„ä»¶TouchableOpacity(ç‚¹å‡»)TouchableOpacityï¼Œç‚¹å‡»è§¦æ‘¸æ—¶ä¼šåé¦ˆç»™ç”¨æˆ·ä¸€ä¸ªé€æ˜åº¦çš„å˜åŒ–ï¼Œå®ƒæ˜¯ä¸€ä¸ªç»‘å®šç‚¹å‡»äº‹ä»¶çš„å—çº§æ ‡ç­¾ æœ‰ activeOpacityå±æ€§ï¼Œç”¨äºè°ƒèŠ‚ç‚¹å‡»æ—¶çš„é€æ˜åº¦ import {TouchableOpacity } from \"react-native\"; Text-Input(è¾“å…¥æ¡†)Text-Inputç»„ä»¶æ—¶React nativeçš„å†…ç½®ç»„ä»¶ï¼Œä¸éœ€è¦é¢å¤–å®‰è£… å¼•å…¥ç»„ä»¶ import {TextInput } from \"react-native\"; é€šè¿‡ onChangeTextäº‹ä»¶æ¥è·å–è¾“å…¥æ¡†çš„å€¼ Text-Inputå±æ€§ å±æ€§å å€¼ æè¿° autoCapitalize â€œnoneâ€, â€œsentenceâ€, â€œwordsâ€, â€œcharactersâ€ å­—æ¯å¤§å†™æ¨¡å¼ autoCorrent bool è®¾ç½®æ‹¼å†™è‡ªåŠ¨ä¿®æ­£åŠŸèƒ½ï¼Œé»˜è®¤ä¸ºå¼€å¯(true) autoFocus bool è®¾ç½®æ˜¯å¦é»˜è®¤è·å–åˆ°ç„¦ç‚¹ï¼Œé»˜è®¤ä¸ºå…³é—­(false) keyboardType â€œdefaultâ€, â€œnumber-padâ€, â€œdecimal-padâ€, â€œphone-padâ€ ç­‰ é”®ç›˜ç±»å‹ returnKeyType â€œdoneâ€, â€œgoâ€, â€œnextâ€, â€œsearchâ€, â€œsendâ€ é”®ç›˜ä¸Šè¿”å›é”®ç±»å‹ placeholder string å ä½ç¬¦ underlineColorAndroid string ä¸‹åˆ’çº¿é¢œè‰² secureTextEntry bool è®¾ç½®æ˜¯å¦ä¸ºå¯†ç å®‰å…¨è¾“å…¥æ¡† onChange function ç›‘å¬æ–¹æ³•,æ–‡æœ¬æ¡†å†…å®¹å‘ç”Ÿæ”¹å˜å›è°ƒæ–¹æ³• onChangeText function ç›‘å¬æ–¹æ³•ï¼Œæ–‡æœ¬æ¡†å†…å®¹å‘ç”Ÿæ”¹å˜å›è°ƒæ–¹æ³•ï¼Œè¯¥æ–¹æ³•ä¼šè¿›è¡Œä¼ é€’æ–‡æœ¬å†…å®¹ï¼ˆä¹Ÿå°±æ˜¯é»˜è®¤ä¼ å…¥æ–‡æœ¬å†…å®¹ä½œä¸ºé»˜è®¤å‚æ•°ï¼‰ onSubmitEditing function ç›‘å¬æ–¹æ³•ï¼Œå½“ç¼–è¾‘æäº¤çš„æ—¶å€™å›è°ƒæ–¹æ³•ï¼ˆæäº¤ï¼‰ã€‚ä¸è¿‡å¦‚æœmultiline={true}çš„æ—¶å€™ï¼Œè¯¥å±æ€§å°±ä¸ç”Ÿæ•ˆ æ›´å¤š Text-Input å±æ€§å¯ä»¥æŸ¥çœ‹è¿™ä¸ªé¡µé¢https://blog.csdn.net/u014484863/article/details/51732074 æ¡ˆä¾‹ï¼š import React from \"react\"; import { View, Text, TextInput, TouchableOpacity } from \"react-native\"; export default () => { const [email, setEmail] = React.useState('') const [password, setPassword] = React.useState('') const [intro, setIntro] = React.useState('') // onChangeTexté»˜è®¤ä¼ å…¥æ–‡æœ¬å†…å®¹ä½œä¸ºé»˜è®¤å‚æ•° function handleEmail(text) { setEmail(text); } function handlePassword(text) { setPassword(text); } function handleIntro(text) { setIntro(text); } function register() { alert('email' + email + '\\npassword' + password + '\\nintro' + intro); } return ( &lt;> &lt;View> &lt;TextInput underlineColorAndroid=\"transparent\" placeholder=\"è¯·è¾“å…¥é‚®ç®±\" placeholderTextColor=\"#ccc\" autoCapitalize=\"none\" keyboardType=\"email-address\" returnKeyType=\"next\" onChangeText={handleEmail} >&lt;/TextInput> &lt;TextInput onChangeText={handlePassword} placeholder=\"è¯·è¾“å…¥å¯†ç \" secureTextEntry={true}>&lt;/TextInput> &lt;TextInput onChangeText={handleIntro} placeholder=\"è¯·è¾“å…¥ä¿¡æ¯\">&lt;/TextInput> {/* æäº¤æŒ‰é’® */} &lt;TouchableOpacity onPress={register}> &lt;Text>æ³¨å†Œ&lt;/Text> &lt;/TouchableOpacity> &lt;/View> &lt;/> ) } Image(å›¾ç‰‡)Imageç»„ä»¶æ—¶React nativeçš„å†…ç½®ç»„ä»¶ï¼Œä¸éœ€è¦é¢å¤–å®‰è£… å¼•å…¥ç»„ä»¶ import {Image } from \"react-native\"; å…¶å®è¿˜æœ‰2ä¸ªç»„ä»¶æ¨èï¼Œ ScrollViewï¼Œç”¨äºæ»‘åŠ¨çš„æ“ä½œ import {ScrollView } from \"react-native\"; å®ƒå®é™…ä¸Šæ‰€åšçš„å°±æ˜¯å°†ä¸€ç³»åˆ—ä¸ç¡®å®šé«˜åº¦çš„å­ç»„ä»¶è£…è¿›ä¸€ä¸ªç¡®å®šé«˜åº¦çš„å®¹å™¨ï¼ˆé€šè¿‡æ»šåŠ¨æ“ä½œï¼‰ ImageBackground,ç›¸å½“äºä»¥å‰çš„ div + èƒŒæ™¯å›¾ç‰‡ï¼Œå› ä¸ºåœ¨RNå½“ä¸­ï¼Œæ˜¯ä¸å­˜åœ¨èƒŒæ™¯å›¾ç‰‡è¿™ä¸ªå±æ€§çš„ æ ‡ç­¾ä¸€å®šè¦é…å¥—å•† styleå±æ€§ï¼Œä¸ç„¶ä¼šæŠ¥é”™ ï¼ˆè‡³å°‘é…å¥—ä¸Šï¼‰style={{}} import {ImageBackground } from \"react-native\"; &lt;ImageBackground source={...} style={{width:100%, height:100%}}> &lt;/ImageBackground> Image å¸¸ç”¨å±æ€§ source èµ„æºå®šä½ ä½¿ç”¨ç½‘ç»œå›¾ç‰‡è¦ç”¨ uriï¼Œä¸”ä¸€å®šè¦è®¾ç½®å®½é«˜ å¦‚æœé…ç½®ç±»åˆ«åï¼Œç›´æ¥å’Œæ­£å¸¸åœ¨jså¯¼å…¥ä¸­ä½¿ç”¨åˆ«åçš„å½¢å¼å³å¯ï¼Œä¸éœ€è¦å˜æˆ ~@ ä¹‹ç±»çš„ å›¾ç‰‡æ˜¾ç¤ºæ¨¡å¼resizeMode containï¼ˆæ•´ä½“ç¼©æ”¾ï¼‰,æŒ‰ç…§æ­£å¸¸çš„æ¯”ä¾‹ç¼©æ”¾åˆ°å¯ä»¥åˆšå¥½æ”¾è¿›æ¥ coverä¸ä¼šå˜å½¢(æˆªå±)ï¼Œæ”¾å¤§å›¾ç‰‡è‡³åˆšå¥½è¦†ç›–ä½æ•´ä¸ªå†…å®¹ stretchä¼šå˜å½¢ï¼ˆå±€éƒ¨å‹ç¼©ï¼‰ï¼Œç›´æ¥æ‹‰ä¼¸è‡³è®¾ç½®çš„å¤§å° blurRadius(æ¨¡ç³ŠåŠå¾„)ï¼šä¸ºå›¾ç‰‡æ·»åŠ ä¸€ä¸ªæŒ‡å®šåŠå¾„çš„æ¨¡ç³Šæ»¤é•œã€‚ æ¡ˆä¾‹ import React from \"react\"; import { Image, ScrollView } from \"react-native\"; export default () => { return ( &lt;> &lt;ScrollView> {/* æ™®é€šå›¾ç‰‡è®¾ç½® */} &lt;Image source={require('./assets/1.png')}>&lt;/Image> {/* ç½‘ç»œå›¾ç‰‡è®¾ç½®,ä¸€å®šè¦è®¾ç½®å®½é«˜ï¼Œä¸ç„¶ä¸æ˜¾ç¤º */} &lt;Image style={{ margin: 10, width: 200, height: 200 }} source={{ uri: 'https://img2.baidu.com/it/u=3963436481,1344394108&amp;fm=26&amp;fmt=auto&amp;gp=0.jpg' }}>&lt;/Image> &lt;Image style={{ margin: 10, width: 200, height: 200, resizeMode: 'contain' }} source={require('./assets/1.png')} >&lt;/Image> &lt;Image style={{ margin: 10, width: 200, height: 200, resizeMode: 'cover' }} source={require('./assets/1.png')} >&lt;/Image> &lt;Image style={{ margin: 10, width: 200, height: 200, resizeMode: 'stretch' }} source={require('./assets/1.png')} >&lt;/Image> &lt;/ScrollView> &lt;/> ) } åœ¨ Android ä¸Šæ”¯æŒ GIF å’Œ WebP æ ¼å¼å›¾ç‰‡ é»˜è®¤æƒ…å†µä¸‹ Android æ˜¯ä¸æ”¯æŒ GIF å’Œ WebP æ ¼å¼çš„ã€‚ä½ éœ€è¦åœ¨android/app/build.gradleæ–‡ä»¶ä¸­æ ¹æ®éœ€è¦æ‰‹åŠ¨æ·»åŠ ä»¥ä¸‹æ¨¡å—ï¼š dependencies { // å¦‚æœä½ éœ€è¦æ”¯æŒAndroid4.0(API level 14)ä¹‹å‰çš„ç‰ˆæœ¬ implementation 'com.facebook.fresco:animated-base-support:1.3.0' // å¦‚æœä½ éœ€è¦æ”¯æŒGIFåŠ¨å›¾ implementation 'com.facebook.fresco:animated-gif:2.0.0' // å¦‚æœä½ éœ€è¦æ”¯æŒWebPæ ¼å¼ï¼ŒåŒ…æ‹¬WebPåŠ¨å›¾ implementation 'com.facebook.fresco:animated-webp:2.1.0' implementation 'com.facebook.fresco:webpsupport:2.0.0' // å¦‚æœåªéœ€è¦æ”¯æŒWebPæ ¼å¼è€Œä¸éœ€è¦åŠ¨å›¾ implementation 'com.facebook.fresco:webpsupport:2.0.0' } ActivityIndicator(åŠ è½½)æ´»åŠ¨æŒ‡ç¤ºå™¨ç»„ä»¶ï¼Œä¹Ÿå¯ä»¥å«å®ƒLoadingï¼Œæœ‰ä¸€äº›æ¯”è¾ƒè€—æ—¶çš„æ“ä½œï¼Œå¯èƒ½éœ€è¦ç”¨æˆ·ç­‰å¾…ï¼Œé‚£ä¹ˆå¯ä»¥ä½¿ç”¨æ´»åŠ¨æŒ‡ç¤ºå™¨ç»„ä»¶ ActivityIndicatorå‘Šè¯‰ç”¨æˆ·ä½ éœ€è¦ç­‰å¾…ï¼ˆç±»ä¼¼äºä¸€ä¸ªåœˆåœˆåœ¨ä¸åœæ—‹è½¬ï¼‰ ActivityIndicatorç»„ä»¶æ—¶React nativeçš„å†…ç½®ç»„ä»¶ï¼Œä¸éœ€è¦é¢å¤–å®‰è£… å¸¸ç”¨å±æ€§ animatingï¼Œæ˜¯å¦æ˜¾ç¤ºè½¬åœˆåŠ è½½ colorï¼Œæ»šè½®çš„å‰æ™¯é¢œè‰² æ¡ˆä¾‹ import React, { Component } from \"react\"; import { TouchableOpacity, ActivityIndicator, Button } from \"react-native\"; export default class App extends Component { state = { animating: true } closeActivityIndicator = () => { this.setState({ animating: !this.state.animating }) } componentDidMount = () => this.closeActivityIndicator(); render() { const { animating } = this.state return ( &lt;> &lt;ActivityIndicator animating={animating} color=\"blue\" /> &lt;TouchableOpacity> &lt;Button onPress={this.closeActivityIndicator} title=\"åˆ‡æ¢æ˜¾ç¤ºloading\">&lt;/Button> &lt;/TouchableOpacity> &lt;/> ) } } Alert(æç¤ºæ¡†) Reactçš„å¼¹çª—ç»„ä»¶ï¼Œå¯åŠ¨ä¸€ä¸ªæç¤ºå¯¹è¯æ¡†ï¼ŒåŒ…å«å¯¹åº”çš„æ ‡é¢˜å’Œä¿¡æ¯ã€‚ä½ è¿˜å¯ä»¥æŒ‡å®šä¸€ç³»åˆ—çš„æŒ‰é’®ï¼Œç‚¹å‡»å¯¹åº”çš„æŒ‰é’®ä¼šè°ƒç”¨å¯¹åº”çš„ onPress å›è°ƒå¹¶ä¸”å…³é—­æç¤ºæ¡†ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œå¯¹è¯æ¡†ä¼šä»…æœ‰ä¸€ä¸ªâ€™ç¡®å®šâ€™æŒ‰é’®ã€‚ iOS# åœ¨ iOS ä¸Šä½ å¯ä»¥æŒ‡å®šä»»æ„æ•°é‡çš„æŒ‰é’®ã€‚æ¯ä¸ªæŒ‰é’®è¿˜éƒ½å¯ä»¥æŒ‡å®šè‡ªå·±çš„æ ·å¼ï¼Œæ­¤å¤–è¿˜å¯ä»¥æŒ‡å®šæç¤ºçš„ç±»åˆ«ã€‚å‚é˜…AlertButtonStyleæ¥äº†è§£æ›´å¤šç»†èŠ‚ã€‚ Android# åœ¨ Android ä¸Šæœ€å¤šèƒ½æŒ‡å®šä¸‰ä¸ªæŒ‰é’®ï¼Œè¿™ä¸‰ä¸ªæŒ‰é’®åˆ†åˆ«å…·æœ‰â€œä¸­é—´æ€â€ã€â€œæ¶ˆææ€â€å’Œâ€œç§¯ææ€â€çš„æ¦‚å¿µï¼š å¦‚æœä½ åªæŒ‡å®šä¸€ä¸ªæŒ‰é’®ï¼Œåˆ™å®ƒå…·æœ‰â€œç§¯ææ€â€çš„å±æ€§ï¼ˆæ¯”å¦‚â€œç¡®å®šâ€ï¼‰ï¼›ä¸¤ä¸ªæŒ‰é’®ï¼Œåˆ™åˆ†åˆ«æ˜¯â€œæ¶ˆææ€â€å’Œâ€œç§¯ææ€â€ï¼ˆæ¯”å¦‚â€œå–æ¶ˆâ€å’Œâ€œç¡®å®šâ€ï¼‰ï¼›ä¸‰ä¸ªæŒ‰é’®åˆ™æ„å‘³ç€â€œä¸­é—´æ€â€ã€â€œæ¶ˆææ€â€å’Œâ€œç§¯ææ€â€ï¼ˆæ¯”å¦‚â€œç¨å€™å†è¯´â€ï¼Œâ€œå–æ¶ˆâ€ï¼Œâ€œç¡®å®šâ€ï¼‰ã€‚ åœ¨ Android ä¸Šå¯ä»¥é€šè¿‡ç‚¹å‡»æç¤ºæ¡†çš„å¤–é¢æ¥å–æ¶ˆæç¤ºæ¡†ï¼Œä½†è¿™ä¸€è¡Œä¸ºé»˜è®¤æ²¡æœ‰å¯ç”¨ã€‚ä½ å¯ä»¥åœ¨Optionsé¢å¤–å‚æ•°æ¥å¯ç”¨è¿™ä¸€è¡Œä¸ºï¼š{ cancelable: true }ã€‚ æ–¹æ³• alert() ï¼šstatic alert(title, message?, buttons?, options?) åç§° ç±»å‹ è¯´æ˜ title string Required The dialogâ€™s title. Passing null or empty string will hide the title. message string An optional message that appears below the dialogâ€™s title. buttons Buttons An optional array containg buttons configuration. options Options Android An optional Alert configuration for the Android. æ¡ˆä¾‹ import React from \"react\"; import { Alert, TouchableOpacity, View, Text } from \"react-native\"; export default () => { const showAlert1 = () => Alert.alert(\"å‘é€æ•°æ®æˆåŠŸ\") const showTip = () => Alert.alert(\"åˆ é™¤æ•°æ®æˆåŠŸ\") const showAlert2 = () => { // ä¼ å…¥å†…å®¹ï¼Œä¼ å…¥çš„æ•°ç»„å¯¹åº”ä¸åŒçš„æŒ‰é’®ï¼Œå¼•å‘ä¸åŒçš„äº‹ä»¶ Alert.alert(\"è­¦å‘Š\", 'ç¡®è®¤åˆ é™¤?', [ { text: 'ç¡®è®¤', onPress: () => showTip() }, { text: 'å–æ¶ˆ', style: 'cancel' } ], //ä¸èƒ½ç‚¹å‡»æç¤ºæ¡†çš„å¤–é¢æ¥å–æ¶ˆæç¤ºæ¡† { cancelable: false } ) } return ( &lt;> &lt;View style={{ alignItems: 'center' }}> &lt;TouchableOpacity onPress={showAlert1}> &lt;Text>å‘é€&lt;/Text> &lt;/TouchableOpacity> &lt;TouchableOpacity onPress={showAlert2}> &lt;Text>åˆ é™¤&lt;/Text> &lt;/TouchableOpacity> &lt;/View> &lt;/> ) } Animating(åŠ¨ç”»)Animatedæ˜¯ä¸€ä¸ªåŠ¨ç”»ç»„ä»¶ï¼Œæ—¨åœ¨ä½¿åŠ¨ç”»å˜å¾—æµç•…ï¼Œå¼ºå¤§å¹¶æ˜“äºæ„å»ºå’Œç»´æŠ¤ã€‚Animatedä¾§é‡äºè¾“å…¥å’Œè¾“å‡ºä¹‹é—´çš„å£°æ˜æ€§å…³ç³»ï¼Œä»¥åŠä¸¤è€…ä¹‹é—´çš„å¯é…ç½®å˜æ¢ï¼Œæ­¤å¤–è¿˜æä¾›äº†ç®€å•çš„ start/stopæ–¹æ³•æ¥æ§åˆ¶åŸºäºæ—¶é—´çš„åŠ¨ç”»æ‰§è¡Œã€‚ åˆ›å»ºåŠ¨ç”»æœ€åŸºæœ¬çš„å·¥ä½œæµç¨‹æ˜¯å…ˆåˆ›å»ºä¸€ä¸ª Animated.Value ï¼Œå°†å®ƒè¿æ¥åˆ°åŠ¨ç”»ç»„ä»¶çš„ä¸€ä¸ªæˆ–å¤šä¸ªæ ·å¼å±æ€§ï¼Œç„¶åä½¿ç”¨Animated.timing()é€šè¿‡åŠ¨ç”»æ•ˆæœå±•ç¤ºæ•°æ®çš„å˜åŒ–ï¼š å¸¸ç”¨å±æ€§ï¼š Value é©±åŠ¨åŠ¨ç”»è¿è¡Œçš„ä¸€ç»´æ ‡é‡å€¼ã€‚ä¸€èˆ¬ä½¿ç”¨new Animated.Value(0);æ¥åˆå§‹åŒ–ã€‚ å¸¸ç”¨æ–¹æ³•ï¼š timing() æ¨åŠ¨ä¸€ä¸ªå€¼æŒ‰ç…§ä¸€ä¸ªç¼“åŠ¨æ›²çº¿è€Œéšæ—¶é—´å˜åŒ–ã€‚Easingæ¨¡å—å®šä¹‰äº†ä¸€å¤§å †æ›²çº¿ï¼Œä½ ä¹Ÿå¯ä»¥ä½¿ç”¨ä½ è‡ªå·±çš„å‡½æ•°ã€‚ Config å‚æ•°æœ‰ä»¥ä¸‹è¿™äº›å±æ€§ï¼š duration: åŠ¨ç”»çš„æŒç»­æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰ã€‚é»˜è®¤å€¼ä¸º 500. easing: ç¼“åŠ¨å‡½æ•°ã€‚ é»˜è®¤ä¸ºEasing.inOut(Easing.ease)ã€‚ delay: å¼€å§‹åŠ¨ç”»å‰çš„å»¶è¿Ÿæ—¶é—´ï¼ˆæ¯«ç§’ï¼‰ã€‚é»˜è®¤ä¸º 0. isInteraction: æŒ‡å®šæœ¬åŠ¨ç”»æ˜¯å¦åœ¨InteractionManagerçš„é˜Ÿåˆ—ä¸­æ³¨å†Œä»¥å½±å“å…¶ä»»åŠ¡è°ƒåº¦ã€‚é»˜è®¤å€¼ä¸º trueã€‚ useNativeDriver: å¯ç”¨åŸç”ŸåŠ¨ç”»é©±åŠ¨ã€‚é»˜è®¤ä¸å¯ç”¨(false)ã€‚ .start()æ–¹æ³•ç”¨äºå¼€å§‹ä¸€ä¸ªåŠ¨ç”» æ¡ˆä¾‹ import React from 'react' import { Animated, TouchableOpacity, StyleSheet } from 'react-native' export default () => { // é»˜è®¤å®½é«˜ const animatedWidth = new Animated.Value(50) const animatedHeight = new Animated.Value(100) function animatedBox() { // ç‚¹å‡»åï¼Œè®¾ç½®åŠ¨ç”»å˜åŒ– Animated.timing(animatedWidth, { toValue: 200, //å€¼åˆ°200 duration: 1000,//æŒç»­æ—¶é—´ useNativeDriver: false //ä¸è®¾ç½®è¿™ä¸ªä¼šæœ‰é»„è‰²çš„warn }).start() Animated.timing(animatedHeight, { toValue: 300, duration: 500, useNativeDriver: false }).start() } const animatedStyle = { width: animatedWidth, height: animatedHeight } return ( &lt;> &lt;TouchableOpacity onPress={animatedBox} style={styles.container}> &lt;Animated.View style={[styles.box, animatedStyle]}>&lt;/Animated.View> &lt;/TouchableOpacity> &lt;/> ) } const styles = StyleSheet.create({ container: { justifyContent: 'center', alignItems: 'center' }, box: { backgroundColor: 'blue', width: 50, height: 100 } }) Switch(å¼€å…³)Switchæ˜¯ä¸€ä¸ªå¼€å…³ç»„ä»¶ï¼Œä¸€ä¸ªâ€œå—æ§ç»„ä»¶â€ï¼ˆcontrolled componentï¼‰ã€‚å¿…é¡»ä½¿ç”¨onValueChangeå›è°ƒæ¥æ›´æ–°valueå±æ€§ä»¥å“åº”ç”¨æˆ·çš„æ“ä½œã€‚å¦‚æœä¸æ›´æ–°valueå±æ€§ï¼Œç»„ä»¶åªä¼šæŒ‰ä¸€å¼€å§‹ç»™å®šçš„valueå€¼æ¥æ¸²æŸ“ä¸”ä¿æŒä¸å˜ï¼Œçœ‹ä¸Šå»å°±åƒå®Œå…¨ç‚¹ä¸åŠ¨ã€‚ ä¸»è¦å±æ€§ï¼š onValueChangeï¼Œåˆ‡æ¢å¼€å…³å›è°ƒçš„äº‹ä»¶ valueï¼Œå¼€å…³æŒ‡å®šçš„å€¼ æ¡ˆä¾‹ï¼š import React, { useState } from 'react' import { View, Text, Switch } from 'react-native' export default () => { const label = { false: 'å…³', true: 'å¼€' }; const [switchValue, setSwitchValue] = useState(true); const toggleSwitch = () => setSwitchValue(preState => !preState); return ( &lt;> &lt;View> &lt;Switch trackColor={{ false: \"#767577\", true: \"#81b0ff\" }} thumbColor={switchValue ? \"#f5dd4b\" : \"#f4f3f4\"} ios_backgroundColor=\"#3e3e3e\" onValueChange={toggleSwitch} value={switchValue}> &lt;/Switch> &lt;View>&lt;Text>å½“å‰çŠ¶æ€æ˜¯: {label[switchValue]}&lt;/Text>&lt;/View> &lt;/View> &lt;/> ) } StatusBar(çŠ¶æ€æ )StatusBarç»„ä»¶æ˜¯æ‰‹æœºå±å¹•æœ€ä¸Šæ–¹çš„åŒºåŸŸï¼ŒåŒ…å«è¿è¥å•†åç§°ã€ç½‘ç»œæƒ…å†µã€æ‰‹æœºç”µæ±  å¯ä»¥é€šè¿‡å®ƒå®šåˆ¶ç™½å¤©/å¤œæ™š ä¸»é¢˜æ¨¡å¼ ç”±äºStatusBarå¯ä»¥åœ¨ä»»æ„è§†å›¾ä¸­åŠ è½½ï¼Œå¯ä»¥æ”¾ç½®å¤šä¸ªä¸”ååŠ è½½çš„ä¼šè¦†ç›–å…ˆåŠ è½½çš„ã€‚å› æ­¤åœ¨é…åˆå¯¼èˆªå™¨ä½¿ç”¨æ—¶ï¼Œè¯·åŠ¡å¿…è€ƒè™‘æ¸…æ¥šStatusBarçš„æ”¾ç½®é¡ºåºã€‚ å¸¸ç”¨å±æ€§ barStyleï¼Œä¸»é¢˜é¢œè‰²ï¼Œenum(â€˜defaultâ€™, â€˜light-contentâ€™, â€˜dark-contentâ€™) hiddenï¼Œéšè—æ˜¾ç¤º backgroundColorï¼ŒçŠ¶æ€æ çš„èƒŒæ™¯è‰²ï¼Œå¯ä»¥ä¸ºtransparentï¼ˆé€æ˜ï¼‰ã€‚ translucentï¼Œè®¾ç½®ä¸ºtrueï¼Œé…åˆbackgroundColor: transparentå¯ä»¥æŠŠèƒŒæ™¯å›¾ç‰‡æä¸ŠçŠ¶æ€æ  animatedï¼ŒæŒ‡å®šçŠ¶æ€æ çš„å˜åŒ–æ˜¯å¦åº”ä»¥åŠ¨ç”»å½¢å¼å‘ˆç°ã€‚ç›®å‰æ”¯æŒè¿™å‡ ç§æ ·å¼ï¼šbackgroundColor, barStyle å’Œ hiddenã€‚ æ¡ˆä¾‹ import React, { useState } from 'react' import { Text, StatusBar, TouchableOpacity } from 'react-native' export default () => { const [hidden, sethidden] = useState(false) const [barStyle, setbarStyle] = useState('default'); const changeHidden = () => { sethidden(preState => !preState); } const changeBarStyle = () => { const temp = barStyle === 'light-content' ? 'dark-content' : 'light-content'; setbarStyle(temp); } return ( &lt;> &lt;StatusBar barStyle={barStyle} hidden={hidden}>&lt;/StatusBar> &lt;TouchableOpacity onPress={changeHidden}> &lt;Text>æ˜¾ç¤º/éšè—&lt;/Text> &lt;/TouchableOpacity> &lt;TouchableOpacity onPress={changeBarStyle}> &lt;Text>æ”¹å˜ä¸»é¢˜é¢œè‰²&lt;/Text> &lt;/TouchableOpacity> &lt;/> ) }","categories":[{"name":"å‰ç«¯","slug":"å‰ç«¯","permalink":"https://taylor12138.github.io/categories/%E5%89%8D%E7%AB%AF/"}],"tags":[],"author":"Hello"},{"title":"éŸ³é¢‘åŠŸèƒ½ä½¿ç”¨è®°å½•","slug":"éŸ³é¢‘åŠŸèƒ½ä½¿ç”¨è®°å½•","date":"2021-06-14T16:00:00.000Z","updated":"2022-05-29T06:46:39.551Z","comments":true,"path":"2021/06/15/yin-pin-gong-neng-shi-yong-ji-lu/","link":"","permalink":"https://taylor12138.github.io/2021/06/15/yin-pin-gong-neng-shi-yong-ji-lu/","excerpt":"","text":"1.éŸ³é¢‘å½•åˆ¶åˆ©ç”¨æ’ä»¶è¿›è¡Œç½‘é¡µå†…çš„éŸ³è§†é¢‘å½•åˆ¶å…¶å®éå¸¸ç®€å•ï¼Œåªéœ€è¦ chrome.tabCapture API å³å¯å®ç°ç½‘é¡µæœ¬èº«çš„éŸ³é¢‘å½•åˆ¶ï¼Œè·å–åˆ°çš„æµæ•°æ®æˆ‘ä»¬éœ€è¦é’ˆå¯¹éŸ³é¢‘æ•°æ®è¿›è¡Œé‡‡æ ·ï¼Œä¿è¯è®¡ç®— HASH çš„è§„åˆ™å’Œæ•°æ®åº“æ•°æ®ä¿æŒä¸€è‡´ã€‚ é’ˆå¯¹è·å–çš„ stream æµå¯ä»¥è¿›è¡ŒéŸ³é¢‘çš„è½¬å½•é‡‡æ ·ï¼Œä¸€èˆ¬æœ‰ä¸‰ç§å¤„ç†æ–¹å¼ï¼š createScriptProcessorï¼šæ­¤æ–¹æ³•ç”¨äºéŸ³é¢‘å¤„ç†æœ€ä¸ºç®€å•ï¼Œä½†æ˜¯æ­¤æ–¹æ³•å·²ç»åœ¨ W3C æ ‡å‡†é‡Œæ ‡è®°ä¸ºåºŸå¼ƒã€‚ä¸å»ºè®®ä½¿ç”¨ MediaRecorderï¼šå€ŸåŠ©åª’ä½“ API ä¹Ÿå¯ä»¥å®ŒæˆéŸ³é¢‘çš„è½¬å½•ï¼Œä½†æ˜¯æ²¡æœ‰åŠæ³•åšåˆ°ç²¾ç»†å¤„ç†ã€‚ AudioWorkletNodeï¼šç”¨äºæ›¿ä»£ createScriptProcessor è¿›è¡ŒéŸ³é¢‘å¤„ç†ï¼Œå¯ä»¥è§£å†³åŒæ­¥çº¿ç¨‹å¤„ç†å¯¼è‡´å¯¼è‡´çš„å¯¹ä¸»çº¿ç¨‹çš„å‹åŠ›ï¼ŒåŒæ—¶å¯ä»¥æŒ‰ bit è¿›è¡ŒéŸ³é¢‘ä¿¡å·å¤„ç†ï¼Œè¿™é‡Œä¹Ÿé€‰æ‹©æ­¤ç§æ–¹å¼è¿›è¡ŒéŸ³é¢‘é‡‡æ ·ã€‚ ä½¿ç”¨ WebAssembly çš„æ—¶å€™éœ€è¦éµå¾ªä¸¥æ ¼çš„ CSP å®šä¹‰ï¼Œå¯¹äº Chrome MV2 å¯ä»¥é€šè¿‡è¿½åŠ  &quot;content_security_policy&quot;:&quot;script-src &#39;self&#39; &#39;unsafe-eval&#39;;&quot; è¿›è¡Œå£°æ˜è§£å†³ã€‚è€Œåœ¨ MV3 ä¸­ï¼Œç”±äºæ›´åŠ ä¸¥æ ¼çš„éšç§åŠå®‰å…¨é™åˆ¶ï¼Œä½†æ˜¯å¯ä»¥ä½¿ç”¨æ²™ç›’ç¯å¢ƒä¸‹è§£å†³ CSP modifications for sandbox have no such new restrictions. â€”â€” Chromeæ’ä»¶å¼€å‘æ–‡æ¡£ æ’ä»¶æœ¬èº«å¯ä»¥å®šä¹‰ sandbox é¡µé¢ï¼Œè¿™ç§é¡µé¢è™½ç„¶æ— æ³•è®¿é—® web/chrome APIï¼Œä½†æ˜¯å®ƒå¯ä»¥è¿è¡Œä¸€äº›æ‰€è°“â€œä¸å®‰å…¨â€çš„æ–¹æ³•ï¼Œä¾‹å¦‚ evalã€new Functionã€WebAssembly.instantiate ç­‰ã€‚æ‰€ä»¥å¯ä»¥å€ŸåŠ©æ²™ç›’é¡µé¢è¿›è¡Œ WASM æ¨¡å—çš„åŠ è½½åŠè¿è¡Œï¼Œå°†è®¡ç®—çš„ç»“æœï¼ˆå¬æ­Œè¯†æ›²çš„ï¼‰è¿”å›ç»™ä¸»é¡µé¢ https://zhuanlan.zhihu.com/p/509496365 2.vue-aplayerç®€å•ä»‹ç»ä¸º Easy-to-use music player for Vue 2.xï¼Œä¸€æ¬¾åŸºäºVue2.0çš„éŸ³ä¹æ’­æ”¾å™¨ï¼Œä¼ å…¥ç›¸å…³çš„propå‚æ•°å¯è¿›è¡Œè‡ªå®šä¹‰ä¿®æ”¹ å› ä¸ºåœ¨é¡¹ç›®ä¸­ä½¿ç”¨åˆ°äº†ï¼Œåœ¨è¿™é‡Œè®°å½•ç›¸å…³çš„ç”¨æ³• å®‰è£…npm install vue-aplayer --save ä½¿ç”¨&lt;aplayer autoplay :music=\"{ title: 'secret base~å›ãŒãã‚ŒãŸã‚‚ã®~', artist: 'Silent Siren', src: 'https://moeplayer.b0.upaiyun.com/aplayer/secretbase.mp3', pic: 'https://moeplayer.b0.upaiyun.com/aplayer/secretbase.jpg' }\" /> å®è·µ&lt;aplayer :music=\"audio[0]\" :list=\"audio\" :showlrc=\"true\">&lt;/aplayer> Propsï¼ˆå‚æ•°ï¼‰ åç§° ç±»å‹ é»˜è®¤å€¼ è¯´æ˜ music Object å¿…éœ€ å½“å‰æ’­æ”¾çš„éŸ³ä¹ã€‚ å…·ä½“è¯·çœ‹éŸ³ä¹ä¿¡æ¯ list Array [] æ’­æ”¾åˆ—è¡¨ã€‚å¦‚æœ list ä¸æ˜¯ç©ºæ•°ç»„ï¼Œæ’­æ”¾åˆ—è¡¨å°±ä¼šæ˜¾ç¤ºå‡ºæ¥ï¼Œå³ä½¿ list ä¸­åªæœ‰ä¸€é¦–æ­Œå¹¶ä¸”å®ƒå’Œ music ä¸€æ · mini Boolean false è¿·ä½ æ¨¡å¼ float Boolean false æµ®åŠ¨æ¨¡å¼ã€‚ä½ å¯ä»¥åœ¨é¡µé¢ä¸Šéšæ„æ‹–æ”¾ä½ çš„æ’­æ”¾å™¨ showLrc Boolean false æ˜¯å¦æ˜¾ç¤ºæ­Œè¯ mutex Boolean true æ˜¯å¦åœ¨è¯¥æ’­æ”¾å™¨æ’­æ”¾æ—¶æš‚åœå…¶ä»–æ’­æ”¾å™¨ theme String &#39;#41b883&#39; ä¸»é¢˜è‰²ã€‚å¦‚æœå½“å‰æ­Œæ›²ä¹Ÿè®¾ç½®äº† theme åˆ™ä»¥æ­Œæ›²çš„ä¸ºå‡† shuffle Boolean false éšæœºæ’­æ”¾ repeat String &#39;no-repeat&#39; è½®æ’­æ¨¡å¼ã€‚å€¼å¯ä»¥æ˜¯ &#39;repeat-one&#39;ï¼ˆå•æ›²å¾ªç¯ï¼‰&#39;repeat-all&#39;ï¼ˆåˆ—è¡¨å¾ªç¯ï¼‰æˆ–è€… &#39;no-repeat&#39;ï¼ˆä¸å¾ªç¯ï¼‰ã€‚ä¸ºäº†å¥½è®°ï¼Œè¿˜å¯ä»¥ä½¿ç”¨å¯¹åº”çš„ &#39;music&#39; &#39;list&#39; &#39;none&#39; listMaxHeight String none æ’­æ”¾åˆ—è¡¨é¢æ¿æœ€å¤§é«˜åº¦ listFolded Boolean false é»˜è®¤æ”¶èµ·æ’­æ”¾åˆ—è¡¨ narrow DEPRECATED, è¯·ä½¿ç”¨ mini listmaxheight DEPRECATED, è¯·ä½¿ç”¨ listMaxHeight showlrc DEPRECATED, è¯·ä½¿ç”¨ showLrc å¦‚æœä½ æ˜¯ç”¨çš„æ˜¯ Vue@2.3.0+, ä½ å¯ä»¥åœ¨ music shuffle å’Œ repeat ä¸Šä½¿ç”¨ .syncä¿®é¥°ç¬¦ å°† Audio å±æ€§ä½œä¸º propsä» v1.4.0 å¼€å§‹ï¼Œæˆ‘ä»¬é€‰å–äº†ä¸€äº› &lt;audio&gt; å±æ€§å¹¶å°†å®ƒä»¬è¿ç”¨ä¸º propsï¼ˆå…¶å®ä¹Ÿå°±æ˜¯ä¸Šæ–¹propså‚æ•°çš„æ‹“å±•ï¼‰ åç§° ç±»å‹ é»˜è®¤å€¼ æ˜¯å¦å¯å˜ è¯´æ˜ autoplay Boolean false false è‡ªåŠ¨æ’­æ”¾ã€‚å¦‚æœå¤šä¸ª mutex æ’­æ”¾å™¨è®¾ç½®äº† autoplayï¼Œåªæœ‰ç¬¬ä¸€ä¸ªä¼šè‡ªåŠ¨æ’­æ”¾ controls Boolean false true æ˜¾ç¤ºåŸç”Ÿ audio å…ƒç´ ï¼ˆåœ¨æ’­æ”¾å™¨é¢æ¿å’Œæ’­æ”¾åˆ—è¡¨é¢æ¿ä¹‹é—´ï¼‰ muted Boolean false true é™éŸ³ preload String none true The way to load music, can be â€˜noneâ€™ â€˜metadataâ€™ or â€˜autoâ€™ volume Number 0.8 true æ’­æ”¾éŸ³é‡ muted å’Œ volume ä¹Ÿå¯ä»¥ä½¿ç”¨ .sync ä¿®é¥°ç¬¦ï¼Œä½ å¯ä»¥åˆ©ç”¨è¿™ä¸€ç‚¹åšä¸€äº›è‡ªå®šä¹‰çš„æ§åˆ¶ éŸ³ä¹ä¿¡æ¯å¯¹åº”propsé‡Œé¢çš„musicï¼Œå½“å‰æ’­æ”¾éŸ³ä¹ï¼Œmusic props åŒ…å«äº†å½“å‰æ’­æ”¾æ­Œæ›²çš„å¦‚ä¸‹ä¿¡æ¯ã€‚ å±æ€§ é»˜è®¤å€¼ è¯´æ˜ src å¿…éœ€ éŸ³é¢‘æ–‡ä»¶çš„ URL title &#39;Untitled&#39; æ­Œæ›²åç§° artist &#39;Unknown&#39; æ¼”å”±è€… pic none å°é¢å›¾ç‰‡ URL lrc none LRC æ­Œè¯æˆ–è€…æ­Œè¯æ–‡ä»¶çš„ URL theme none æ­Œæ›²çš„ä¸»é¢˜è‰²ï¼Œä¼šè¦†ç›–æ’­æ”¾å™¨çš„ä¸»é¢˜è‰² url DEPRECATED, è¯·ä½¿ç”¨ src author DEPRECATED, è¯·ä½¿ç”¨ artist å®è·µï¼š music: { // å½“å‰æ’­æ”¾çš„éŸ³ä¹ title: \"æ™´å¤©\", artist: \"å‘¨æ°ä¼¦\", src: require(\"@/assets/music/å‘¨æ°ä¼¦ - æ™´å¤©.mp3\"), pic: require(\"...\"), // å°é¢å›¾ç‰‡ }, äº‹ä»¶ä» v1.4.0 å¼€å§‹, Vue-APlayer ä¼šæŠ›å‡ºå®ƒå†…éƒ¨çš„ &lt;audio&gt; å…ƒç´ ä¸Šè§¦å‘çš„æ‰€æœ‰åª’ä½“äº‹ä»¶. ä½ å¯ä»¥æŸ¥é˜… MDN ä¸Šçš„è¿™å¼ å®Œæ•´åˆ—è¡¨. åœ¨ v1.4.0 ä»¥å‰, æˆ‘ä»¬æœ‰ä¸€äº›è‡ªå®šä¹‰äº‹ä»¶ï¼Œå¦‚ play pause canplay playing ended error, å®ƒä»¬ç°åœ¨å·²å…¨éƒ¨è¢«åºŸå¼ƒã€‚ è‡ªé€‚åº”ä¸»é¢˜è‰²ä» v1.3.0 å¼€å§‹, å¦‚æœä½ å°†ä¸€é¦–æ­Œçš„ theme å€¼è®¾ä¸º &#39;pic&#39;, Vue-APlayer ä¼šä»å®ƒçš„å°é¢å›¾ç‰‡ä¸­æå–é¢œè‰²ä½œä¸ºä¸»é¢˜è‰². ä½ ä¹Ÿå¯ä»¥ç›´æ¥å°† Vue-APlayer çš„ theme prop è®¾ä¸º &#39;pic&#39;, è¿™æ ·æ‰€æœ‰çš„æ­Œæ›²éƒ½ä¼šä½¿ç”¨è‡ªé€‚åº”ä¸»é¢˜è‰² ä½ åªéœ€å°† color-thief åº“åŠ å…¥é¡µé¢ä¸­. æ³¨æ„ color-thief æ— æ³•æ­£å¸¸ä½¿ç”¨ npm å®‰è£… ä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬åªèƒ½å¯¼å…¥ï¼Œä¸èƒ½ç”¨npmè£… &lt;!-- æˆ–è€…ä½ é€‰æ‹©çš„å…¶ä»– CDN --> &lt;script src=\"https://cdn.jsdelivr.net/npm/colorthief@2.0.2/src/color-thief.js\">&lt;/script> æŸ¥è¯¢æ›´å¤šå¯ä»¥çœ‹ https://github.com/SevenOutman/vue-aplayer/blob/develop/docs/README.zh-CN.md","categories":[{"name":"å‰ç«¯","slug":"å‰ç«¯","permalink":"https://taylor12138.github.io/categories/%E5%89%8D%E7%AB%AF/"}],"tags":[],"author":"Hello"},{"title":"React(ä¸­)","slug":"React(ä¸­)","date":"2021-05-09T16:00:00.000Z","updated":"2023-05-22T04:44:31.645Z","comments":true,"path":"2021/05/10/react-zhong/","link":"","permalink":"https://taylor12138.github.io/2021/05/10/react-zhong/","excerpt":"","text":"6.Reactè·¯ç”±Reactå’ŒVueä¸€æ ·ï¼Œéƒ½æ˜¯é‡‡å–å•é¡µé¢å¯Œåº”ç”¨çš„æ–¹å¼é…ç½®ç½‘é¡µï¼ˆSPAï¼‰ï¼Œå³å•ä¸ªé¡µé¢é€šè¿‡è·¯ç”±çš„åˆ‡æ¢ï¼Œå±•ç¤ºä¸åŒçš„æ•°æ®ä¿¡æ¯ï¼Œ è€Œä¸”æ”¹å˜urlï¼Œä¾ç„¶æ˜¯é¡µé¢ä¸å‘ç”Ÿæ•´ä½“åˆ·æ–°ï¼ˆåªåšé¡µé¢çš„å±€éƒ¨åˆ·æ–°ï¼‰ï¼Œå¯¹äºif elseã€switchä¸åŒçš„åœ°æ–¹åœ¨äºï¼Œä»–ä»¬åªè½¬å˜ç»„ä»¶ï¼Œä½†æ˜¯urlè·¯å¾„æ²¡å‘ç”Ÿå˜åŒ–ï¼Œè€Œä¸”ä»–ä»¬æ— æ³•å®šä½åˆ°ä¸Šä¸€æ¬¡æµè§ˆçš„é¡µé¢ï¼Œè¦é‡æ–°åœ¨é¦–é¡µæ–°æ‰“å¼€ React-routeræœ‰ä¸‰ç§å®ç°æ–¹å¼ï¼Œåˆ†åˆ«å¯¹åº”ä¸‰ç§å¹³å° 1.web 2.native 3.anwhere åˆ†åˆ«å¯¹åº” react-router-dom : å…·ä½“å®ç°æµè§ˆå™¨ç›¸å…³çš„è·¯ç”±ç›‘å¬å’Œè·³è½¬ react-router-native : å…·ä½“å®ç°RNç›¸å…³çš„è·¯ç”±ç›‘å¬å’Œè·³è½¬ react-router : æ ¸å¿ƒé€»è¾‘å¤„ç†ï¼Œæä¾›ä¸€äº›å…¬ç”¨çš„åŸºç±» åœ¨å®é™…ä½¿ç”¨æ—¶ï¼Œæˆ‘ä»¬ä¸€èˆ¬ä¸éœ€è¦å¼•ç”¨react-routerï¼Œè€Œæ˜¯ç›´æ¥ç”¨react-router-domå°±è¡Œï¼Œå› ä¸ºå®ƒè‡ªå·²ä¼šå»å¼•ç”¨react-routerã€‚ä¸‹é¢æˆ‘ä»¬åœ¨é¡¹ç›®é‡Œé¢å¼•å…¥react-router-domã€‚ é’ˆå¯¹Webçš„è·¯ç”±é’ˆå¯¹Webï¼Œæˆ‘ä»¬ä½¿ç”¨çš„æ˜¯react-router-domï¼Œå½“å‰è®²è¿°çš„æ˜¯react-router-dom@5ï¼Œ6.xç‰ˆæœ¬æˆªæ­¢åˆ°2022å¹´2æœˆä»½ä¸ºæ­¢ä»å¯ä»¥åœ¨issueä¸Šçœ‹åˆ°è®¸å¤šbug reactçš„ä¸€ä¸ªæ’ä»¶åº“ ä¸“é—¨ç”¨æ¥å®ç°ä¸€ä¸ªSPAåº”ç”¨ åŸºäºreactçš„é¡¹ç›®åŸºæœ¬ä¼šç”¨åˆ°è¿™ä¸ªåº“ è„šæ‰‹æ¶å¹¶æ²¡æœ‰è‡ªåŠ¨å¸®ä½ ä¸‹è½½ react-router-dom npm i react-router-dom@5 é¦–å…ˆéœ€è¦åŒ…è£¹è·¯ç”±ï¼Œè®©å•é¡µé¢çš„æ‰€æœ‰ç»„ä»¶ä½¿ç”¨ç»Ÿä¸€è·¯ç”±ï¼Œè€å¸ˆæ¨èçš„æ–¹å¼æ˜¯ç›´æ¥åœ¨åŒ…è£¹åœ¨æ¸²æŸ“APPç»„ä»¶é‚£ä¸€å— StartBrowserRouter &amp; HashRouter BrowserRouterä½¿ç”¨H5çš„history APIï¼Œä¸å…¼å®¹IE9ä»¥ä¸‹ç‰ˆæœ¬ï¼›HashRouterä½¿ç”¨URLçš„å“ˆå¸Œå€¼ HashRouterè·¯å¾„å¸¦ # å¯¹äºBrowserRouterï¼Œåˆ·æ–°åstateå‚æ•°èƒ½å¾—ä»¥ä¿å­˜ï¼Œä½†æ˜¯HashRouterä¼šä¸¢å¤±stateå‚æ•° HashRouterå¯ä»¥è§£å†³ä¸€äº›å…³äºè·¯å¾„é—®é¢˜ï¼ˆå¯ä»¥çœ‹è·¯ç”±åµŒå¥—å°èŠ‚çš„è·¯å¾„å‘éƒ¨åˆ†ï¼‰ import { BrowserRouter } from 'react-router-dom' //index.js ReactDOM.render( &lt;BrowserRouter> &lt;App /> &lt;/BrowserRouter>, document.querySelector('#root')) åœ¨æ–°å»ºä¸€ä¸ªrouteræ–‡ä»¶ï¼Œåœ¨å…¶ä¸­çš„æ–°å»ºçš„index.jsä¸­å¼•å…¥ + ä½¿ç”¨ï¼Œä¹‹åå†æŠŠè¿™ä¸ªè·¯ç”±ç»„ä¹‹é—´æ”¾åˆ°appç»„ä»¶å³å¯ import React from 'react' import { BrowserRouter, Route } from 'react-router-dom' import Home from '@/views/home' import List from '@/views/list' export default function Router() { return ( &lt;div> &lt;BrowserRouter> &lt;Route path=\"/home\" component={Home}>&lt;/Route> &lt;Route path=\"/list\" component={List}>&lt;/Route> &lt;/BrowserRouter> &lt;/div> ) } åœ¨Vueä¸­æ˜¯ä½¿ç”¨ &lt;router-link&gt;å®šå‘è·¯ç”±ï¼Œè€Œè¿™é‡Œåˆ™æ˜¯ &lt;Link to=\"/about\">About&lt;/Link> &lt;Link to=\"/home\">Home&lt;/Link> LinkNavLink å¦‚æœæƒ³è¦ä½¿å¾—linkæ ‡ç­¾ç‚¹å‡»å®Œåæœ‰é«˜äº®æ•ˆæœï¼Œå¯ä»¥å¼•å…¥ + ä½¿ç”¨ &lt;NavLink&gt;ï¼Œå®é™…ä¸Šå†…éƒ¨è¿˜æ˜¯ &lt;link&gt;ï¼Œåªæ˜¯ä½ ç‚¹å‡»äº†å“ªä¸€ä¸ª Linkï¼Œå°±ä¼šè‡ªåŠ¨ç»™è¯¥ Linkæ·»åŠ ä¸€ä¸ª æ ·å¼ï¼Œç±»åä¸ºactiveï¼Œå½“ç„¶ä¹Ÿå¯ä»¥å®šä¹‰ç±»åï¼ˆä½¿ç”¨activeClassNameï¼‰ï¼Œè‡ªå®šä¹‰linkæ ‡ç­¾ç‚¹å‡»åçš„æ ·å¼ ï¼ˆåœ¨Vueä¸­æ˜¯é€šè¿‡å®šä¹‰Routerå®ä¾‹LinkActiveClasså±æ€§è¿›è¡Œè‡ªå®šä¹‰ç±»åçš„ï¼‰ &lt;NavLink activeClassName=\"è‡ªå®šä¹‰ç±»å\" to=\"/home\">Home&lt;/NavLink> Linkçš„å…¶ä»–å±æ€§çš„è¡¥å…… é»˜è®¤pushæ–¹å¼è¿›å…¥è·¯ç”±ï¼Œå¯ä»¥æ›¿æ¢æˆreplaceï¼šreplace={true}ï¼Œæˆ–è€…ç›´æ¥ &lt;Link replace to=\"/home\">Home&lt;/Link> æ’æ§½ ä½¿ç”¨ä¸Šè¿° NavLinkã€Link æ–¹æ³•æ¥å†™è·¯ç”±é“¾æ¥æ—¶ï¼Œæœ‰è®¸å¤šå†—ä½™çš„åœ°æ–¹ï¼Œæ¯”å¦‚å¤šä¸ªNavLinkä½¿ç”¨ç›¸åŒç±»åã€activeç±»åæ—¶ï¼Œæœ‰å¾ˆé«˜çš„é‡å¤æ€§ &lt;NavLink activeClassName=\"è‡ªå®šä¹‰ç±»å\" to=\"/home\">Home&lt;/NavLink> &lt;NavLink activeClassName=\"è‡ªå®šä¹‰ç±»å\" to=\"/about\">About&lt;/NavLink> &lt;NavLink activeClassName=\"è‡ªå®šä¹‰ç±»å\" to=\"/other\">Other&lt;/NavLink> æˆ‘ä»¬å¯ä»¥è‡ªå·±å°è£…MyLinkï¼(å¤–åŠ å°æ’æ§½) æ ‡ç­¾ä½“å†…å®¹çš„æ¥æ”¶å¯ä»¥ä½¿ç”¨æ’æ§½ï¼Œåœ¨å­ç»„ä»¶æ¥æ”¶çš„propsé‡Œï¼Œå¦‚æœæ’æ§½æœ‰å†…å®¹ï¼Œåˆ™è‡ªåŠ¨ä½¿ç”¨childrenå±æ€§è¿›è¡Œæ¥æ”¶ &lt;MyLink to=\"/about\" >About&lt;/MyLink> &lt;MyLink to=\"/home\" >Home&lt;/MyLink> å®šä¹‰å°è£…çš„å­ç»„ä»¶ export default class MyLink extends Component { render() { return ( &lt;div> &lt;NavLink className=\"list-group-item\" {...this.props}}>{this.props.children}&lt;/NavLink> &lt;/div> ) } } å®é™…ä¸Šï¼Œä¸ä»…linkæ ‡ç­¾å¯ä»¥ä»¥è¿™ç§æ–¹å¼æ˜¯ç”¨æ’æ§½ï¼Œå­ç»„ä»¶éƒ½å¯ä»¥è¿™æ ·ä½¿ç”¨ï¼Œè¿™æ—¶çˆ¶å­ç»„ä»¶æ’æ§½çš„é€šç”¨æ–¹æ³• è·¯ç”±åŒ¹é…æ¨¡ç³ŠåŒ¹é…å’Œç²¾ç¡®åŒ¹é… è·¯ç”±åŒ¹é…éµä»æ¨¡ç³ŠåŒ¹é…ï¼Œæ¯”å¦‚ä¸‹æ–¹linkçš„toåœ¨åŒ¹é…è·¯ç”±æ—¶ï¼Œä»¥ /home/a/b è¿›è¡ŒåŒ¹é… ï¼ŒHomeç»„ä»¶ä¾ç„¶èƒ½å¾—åˆ°å±•ç¤ºã€‚ ä½†æ˜¯ä¸€å®šè¦æŒ‰ç…§é¡ºåºï¼Œæ¯”å¦‚link çš„ toé‡Œä¸º /a/home/bå°±ä¸å¯ä»¥ &lt;Link to=\"/about\">About&lt;/Link> &lt;Link to=\"/home/a/b\">Home&lt;/Link> &lt;Route path=\"/about\" component={About}>&lt;/Route> &lt;Route path=\"/home\" component={Home}>&lt;/Route> {/* å¯ä»¥å±•ç¤º */} å¦‚æœæƒ³è¦ç²¾å‡†åŒ¹é…ï¼ˆä¸¥æ ¼åŒ¹é…ï¼‰ï¼Œä¸è¦ææ¨¡ç³ŠåŒ¹é…ï¼Œåˆ™éœ€è¦æ·»åŠ  exact å±æ€§ï¼ˆä½†æ˜¯è¿™ä¸ªå±æ€§åœ¨å¼€å‘ä¸­å°‘ç”¨ï¼Œå¯èƒ½å¼•å‘ä¸€äº›é—®é¢˜ï¼Œæ¯”å¦‚ä¸èƒ½å¼€å¯äºŒçº§è·¯ç”±ï¼Œéè¦ç”¨åˆ°æ—¶æ‰è¦ç”¨ï¼‰ &lt;Route exact path=\"/home\" component={Home}>&lt;/Route> è·¯ç”±åŒ¹é… åœ¨è¿›è¡Œè·¯ç”±æ³¨å†Œæ—¶ï¼Œæˆ‘ä»¬ä¸éš¾å‘ç°ï¼Œå¦‚æœæ˜¯è¿›å…¥ /home è·¯ç”±ï¼Œåˆ™Homeã€Otherç»„ä»¶éƒ½ä¼šå±•ç¤º è¿™è¯´æ˜è·¯ç”±åŒ¹é…å®Œæˆåè¿˜ä¼šå‘ä¸‹åŒ¹é…ï¼Œå¦‚æœæœ‰å¾ˆå¤šè·¯ç”±ï¼Œåˆ™ä¼šé€ä¸ªåŒ¹é…ï¼Œå¯¼è‡´æ•ˆç‡ä¸é«˜ å¹¶ä¸”å¦‚æœä½¿ç”¨äº† / è·¯å¾„æ¥é‡å®šå‘ï¼Œç”±äºæ¨¡ç³ŠåŒ¹é…ï¼Œæ›´æ˜¯ä¼šè®©æµè§ˆå™¨æ— è®ºå“ªä¸ªåœ°å€éƒ½è·³è½¬åˆ°é‡å®šå‘çš„ç»„ä»¶ &lt;Route path=\"/about\" component={About}>&lt;/Route> &lt;Route path=\"/home\" component={Home}>&lt;/Route> &lt;Route path=\"/home\" component={Other}>&lt;/Route> æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ Switchï¼Œç”¨Switchç»„ä»¶åŒ…è£¹æ‰€æœ‰æ³¨å†Œè·¯ç”±ï¼Œè¿™æ—¶åŒ¹é…åˆ°è·¯ç”±åå°±ä¸ä¼šç»§ç»­å‘ä¸‹åŒ¹é… import {Switch} from 'react-router-dom'; &lt;Switch> &lt;Route path=\"/about\" component={About}>&lt;/Route> &lt;Route path=\"/home\" component={Home}>&lt;/Route> &lt;Route path=\"/home\" component={Other}>&lt;/Route> &lt;/Switch> è·¯ç”±é‡å®šå‘ | 404import { Redirect } from 'react-router-dom' é»˜è®¤ç½‘é¡µå¯¹äºæ¯ä¸ªè·¯ç”±éƒ½ä¸åŒ¹é…ï¼ˆæ²¡æœ‰ç‚¹å‡»Linkè¿›è¡Œè·¯åŒ¹é…æ—¶ï¼‰ï¼Œæ­¤æ—¶æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ Redirectç»„ä»¶è¿›è¡Œé‡å®šå‘ï¼Œè®©é»˜è®¤ç½‘é¡µè·³è½¬åˆ°æŸä¸ªè·¯ç”±ï¼ˆRedirectä¸€èˆ¬å†™åœ¨è·¯ç”±æ³¨å†Œçš„æœ€ä¸‹æ–¹ï¼Œå½“æ‰€æœ‰è·¯ç”±éƒ½æ— æ³•åŒ¹é…æ—¶ï¼Œè·³è½¬åˆ°RedirectæŒ‡å®šè·¯ç”±ï¼‰ &lt;Switch> &lt;Route path=\"/home\" component={Home}>&lt;/Route> &lt;Route path=\"/list\" component={List}>&lt;/Route> &lt;Redirect to=\"/home\" /> {/* è°éƒ½åŒ¹é…ä¸ä¸Šäº†å°±å»home */} &lt;/Switch> å¦‚æœè¦é…åˆä¸Šç”¨æˆ·èƒ¡ä¹±å†™åŒ¹é…çš„404é¡µé¢ï¼Œåˆ™æ­¤æ—¶ Redirect æœ€å¥½å¼€å¯ç²¾å‡†åŒ¹é…ï¼Œä¸ç„¶æ— è®ºå¦‚ä½•éƒ½æ˜¯ä¼šè¿›å…¥ Redirect æŒ‡å®šçš„è·¯ç”±ç»„ä»¶å½“ä¸­å» &lt;Switch> &lt;Route path=\"/home\" component={Home}>&lt;/Route> &lt;Route path=\"/list\" component={List}>&lt;/Route> &lt;Redirect from=\"/\" to=\"/home\" exact /> &lt;Route component={NotFound}>&lt;/Route> &lt;/Switch> è·¯ç”±åµŒå¥—è·¯å¾„å‘ å¦‚æœReactç›´æ¥åœ¨è·¯å¾„å¤´åµŒå¥—ï¼Œæœ‰å¯èƒ½å¯¼è‡´å¼•å…¥æ–‡ä»¶è·¯å¾„ä¹Ÿç›¸å¯¹å‘ç”Ÿé”™è¯¯ &lt;Link to=\"/something/about\">About&lt;/Link> &lt;Link to=\"/something/home\">Home&lt;/Link> &lt;Route path=\"/something/about\" component={About}>&lt;/Route> &lt;Route path=\"/something/home\" component={Home}>&lt;/Route> åŸæœ¬å¼•å…¥cssæ ·å¼çš„è·¯å¾„ä¸º &lt;link rel=\"stylesheet\" href=\"./css/bootstrap.css\"> åœ¨åˆ‡æ¢è·¯ç”± + F5åˆ·æ–°åè·¯å¾„ä¼šéšä¹‹æ›´æ”¹ è§£å†³æ–¹æ³•ä¸€ï¼š æ”¹å˜è·¯å¾„ï¼Œå»æ‰å½“å‰è·¯å¾„ ./ï¼Œç›´æ¥ /æ˜¯å»åˆ°urlçš„publicç›®å½•ä¸‹ &lt;link rel=\"stylesheet\" href=\"/css/bootstrap.css\"> è§£å†³æ–¹æ³•äºŒï¼šä¸ä¸Šæ–¹åŒç† &lt;link rel=\"stylesheet\" href=\"%PUBLIC_URL%/css/bootstrap.css\"> è§£å†³æ–¹æ³•ä¸‰ï¼šä½¿ç”¨HashRouter å› ä¸ºå®ƒæœ‰ä¸€ä¸ªé”šç‚¹ #ï¼Œè¿™æ ·å­å‘é€è¯·æ±‚æ—¶ä¼šå¿½ç•¥ #åé¢çš„ç›¸å…³å“ˆå¸Œå€¼ï¼ˆè·¯ç”±ï¼‰ è·¯ç”±åµŒå¥—äºŒçº§è·¯ç”± å’ŒVueä¸€æ ·ï¼Œä½¿ç”¨å¤šé‡è·¯ç”±åµŒå¥—åªéœ€åœ¨è·¯ç”±ç»„ä»¶é‡Œï¼Œå†æ”¾ç½®è·¯ç”±ç»„ä»¶ï¼ˆLink + Route ç»„åˆï¼‰ï¼Œåˆ‡è®°ï¼Œè¿™é‡Œå’ŒVueä¸€æ ·ï¼Œlinké‡Œçš„toå¿…é¡»è¦å†™å®Œæ•´è·¯å¾„ï¼ˆå¸¦ä¸Šçˆ¶çº§è·¯ç”±ï¼‰ï¼Œè¿™æ ·å­è®¡ç®—å­è·¯ç”±ç»„ä»¶æœªæ˜¾ç¤ºï¼Œè·¯ç”±ä¹Ÿèƒ½éµä»æ¨¡ç³ŠåŒ¹é…è‡³å°‘å±•ç¤ºä¸€çº§è·¯ç”±çš„é¡µé¢æ•ˆæœ æ¯”å¦‚åœ¨æˆ‘ä»¬homeç»„ä»¶å†… {/* è¿™é‡Œéœ€è¦ç»™å®Œæ•´çš„è·¯å¾„ï¼Œ ä¸èƒ½ç›´æ¥to=\"/news\" */} &lt;MyLink to=\"/home/news\">News&lt;/MyLink> &lt;MyLink to=\"/home/messages\">Messages&lt;/MyLink> {/* è·¯ç”±æ³¨å†Œ */} &lt;Switch> &lt;Route path=\"/home/Messages\" component={Messages} /> &lt;Route path=\"/home/News\" component={News }/> &lt;Redirect to=\"/home/Messages\" /> &lt;/Switch> ä½†æ˜¯å®è´¨ä¸Šä»æœ‰ä¸€ä¸ªbugï¼Œå°±æ˜¯åœ¨urlåœ°å€æ ï¼Œå•å•è¾“å…¥ä¸€çº§è·¯ç”±çš„åœ°å€ï¼Œå°±åªä¼šå‡ºç°ä¸€çº§è·¯ç”±çš„ç»„ä»¶ï¼ŒåµŒå¥—è·¯ç”±çš„ç»„ä»¶å…¨éƒ¨æ¶ˆå¤± è·¯ç”±ä¼ å‚ä¼ é€’å‚æ•°ä¸»è¦æœ‰ä¸¤ç§ç±»å‹ï¼šparamså’Œqueryï¼ˆåŒVueï¼‰ paramsï¼šéœ€è¦åœ¨Routeé‡Œè¿›è¡Œå£°æ˜ï¼ˆåªæœ‰paramsæ‰éœ€è¦å£°æ˜æ¥æ”¶å‚æ•°ï¼‰ï¼Œç„¶ååœ¨Linkä¸­è·³è½¬urlçš„æ—¶å€™è®°å¾—å¸¦ä¸Šå‚æ•°å°±å¥½äº† åœ¨Routeé€šè¿‡/è·¯å¾„/:è‡ªå®šä¹‰å‚æ•°åæ¥å£°æ˜ &lt;Route path=\"/home/Messages/Detail/:id/:title\" component={Detail} /> return ( &lt;div> &lt;ul> { messageArr.map(item => { return ( &lt;li key={item.id}> {/* å‘è·¯ç”±ç»„ä»¶ä¼ é€’paramså‚æ•° */} &lt;Link to={`/home/Messages/Detail/${item.id}/${item.title}`}>{item.title}&lt;/Link> &lt;/li> ) }) } &lt;/ul> &lt;/div> ) æ­¤æ—¶ä½ æŸ¥çœ‹å­è·¯ç”±ç»„ä»¶ Detail çš„ propsä¸Šæ¥æ”¶çš„å‚æ•°ä¼šæœ‰æ‰€å˜åŒ–ï¼Œç¨ç¨æŸ¥çœ‹å¯å¾—çŸ¥ï¼Œåœ¨this.props.match.paramså¯æ‰¾åˆ°ä½ ä¼ é€’çš„å‚æ•° searchä¼ å‚ searchä¼ å‚çš„æ–¹å¼å®é™…ä¸Šä¹Ÿå°±æ˜¯queryå‚æ•° æ— éœ€åœ¨Routeé‡Œè¿›è¡Œå£°æ˜ messageArr.map(item => { return ( &lt;li key={item.id}> {/* å‘è·¯ç”±ç»„ä»¶ä¼ é€’searchå‚æ•° */} &lt;Link to={`/home/messages/detail/?id=${item.id}&amp;title=${item.title}`}>{item.title}&lt;/Link> &lt;/li> ) }) æ­¤æ—¶ä½ æŸ¥çœ‹å­è·¯ç”±ç»„ä»¶ Detail çš„ propsä¸Šæ¥æ”¶çš„å‚æ•°ä¼šæœ‰æ‰€å˜åŒ–ï¼Œç¨ç¨æŸ¥çœ‹å¯å¾—çŸ¥ï¼Œåœ¨this.props.location.searchå¯æ‰¾åˆ°ä½ ä¼ é€’çš„å‚æ•° å¯æ˜¯ï¼ ä½†æ˜¯å‚æ•°çš„å½¢å¼æ˜¯ â€œ?id=01&amp;titile=message1â€ å¯¹äºqueryå‚æ•° ï¼škey=value&amp;key=valueå…¶å®æ˜¯ä¸€ç§å«urlencodedçš„ç¼–ç å½¢å¼ æˆ‘ä»¬å¯ä»¥ä½¿ç”¨Reactè„šæ‰‹æ¶å¸®æˆ‘ä»¬ä¸‹è½½å¥½çš„åº“ querystringç›´æ¥è½¬æ¢ import qs from 'querystring' qs.stringify(obj)//å¯¹è±¡è½¬urlencoded qs.parse(str)//urlencodedè½¬å¯¹è±¡ ç„¶åæˆ‘ä»¬å¯ä»¥è¿›è¡Œæ­£å¼çš„æ ¼å¼è½¬æ¢äº† const { search } = this.props.location; const { id, title } = qs.parse(search.slice(1)); //æˆªå–æ‰å¼€å¤´çš„\"?\" console.log(this.props, id, search); ä¼šä¸ä¼šæ„Ÿè§‰æœ‰ç‚¹åƒjsonå’Œstringçš„ç›¸äº’è½¬æ¢ï¼Ÿï¼š JSON.stringify(å¯¹è±¡) JavaScript å€¼(å¯¹è±¡æˆ–æ•°ç»„)è½¬æ¢ä¸º JSON å­—ç¬¦ä¸² JSON.parse(data) å­—ç¬¦è½¬å¯¹è±¡ stateä¼ å‚ è¿™ä¸ªæ˜¯è·¯ç”±ç»„ä»¶ç‹¬æœ‰çš„çŠ¶æ€ï¼Œå’Œä¸€èˆ¬ç»„ä»¶é‡Œçš„stateæ˜¯ä¸ä¸€æ ·çš„ stateä¼ å‚ä½ åœ¨urlåœ°å€æ æ˜¯çœ‹ä¸åˆ°çš„ï¼Œè€Œparamså’Œsearchä¼ å‚åœ¨åœ°å€æ å¯ä»¥çœ‹åˆ°æ˜æ˜¾çš„æ”¹å˜ æ— éœ€åœ¨Routeé‡Œè¿›è¡Œå£°æ˜ messageArr.map(item => { return ( &lt;li key={item.id}> {/* å‘è·¯ç”±ç»„ä»¶ä¼ é€’stateå‚æ•° */} {/* toè¦å†™æˆä¸€ä¸ªå¯¹è±¡çš„å½¢å¼ */} &lt;Link to={{ pathname: '/home/messages/detail', state: { id: item.id, title: item.title } }}>{item.title}&lt;/Link> &lt;/li> ) }) ï¼ˆMaybeä½ ä¼šå‘ç°å’ŒVueçš„queryä¼ å‚æœ‰ç‚¹åƒï¼Ÿï¼‰ æ­¤æ—¶ä½ æŸ¥çœ‹å­è·¯ç”±ç»„ä»¶ Detail çš„ propsä¸Šæ¥æ”¶çš„å‚æ•°ä¼šæœ‰æ‰€å˜åŒ–ï¼Œç¨ç¨æŸ¥çœ‹å¯å¾—çŸ¥ï¼Œåœ¨this.props.location.stateå¯æ‰¾åˆ°ä½ ä¼ é€’çš„å‚æ•° è™½ç„¶ä½¿ç”¨stateä¼ å‚æ–¹å¼ï¼Œåˆ·æ–°é¡µé¢ä¸ä¼šä¸¢å¤±å‚æ•°ï¼ˆå®é™…ä¸Šæ˜¯å› ä¸ºhistoryå¯¹è±¡å¸®ä½ ç¼“å­˜äº†ï¼‰ï¼Œä½†æ˜¯å¦‚æœä½ å¼ºè¡Œæ¸…é™¤ç¼“å­˜ï¼Œåœ¨æ¥æ”¶æ—¶å°±ä¼šâ€œä¸è§äº†â€ ç¼–ç¨‹å¼è·¯ç”±æ›¿æ¢linkåœ¨ä¸å€ŸåŠ© Linkçš„æ¡ä»¶ä¸‹è¿›è¡Œè·¯ç”±åˆ‡æ¢ï¼Œè‡ªå·±å®šä¹‰å‡½æ•°è¿›è¡Œè·³è½¬åˆ‡æ¢ï¼Œè¿™ç§æ–¹å¼å«åšç¼–ç¨‹å¼è·¯ç”±å¯¼èˆª æ„Ÿè§‰æœ‰ç‚¹åƒVueä¸­å¯¹router-linkåŸç†çš„å»¶ä¼¸ ï¼šthis.$router.push(&quot;/home&quot;); è®°å¾—ç¼–ç¨‹å¼è·¯ç”±ä¼ å‚çš„æ—¶å€™ï¼Œä½¿ç”¨paramsçš„æ–¹å¼ï¼ŒRouteè¦å£°æ˜å‚æ•°ï¼ˆä¸Šé¢è·¯ç”±ä¼ å‚éƒ¨åˆ†æœ‰è®²è¿°åˆ°ï¼‰ //ç¼–ç¨‹å¼è·¯ç”±å¯¼èˆª + paramsä¼ å‚ replaceCheck = (id, title) => { return () => { this.props.history.replace(`/home/messages/detail/${id}/${title}`); } } //ç¼–ç¨‹å¼è·¯ç”±å¯¼èˆª + queryä¼ å‚ pushcheck = (id, title) => { return () => { this.props.history.push(`/home/messages/detail?id=${id}&amp;title=${title}`); //this.props.history.push(\"/home/messages/detail?\", query: {id: id, title: title}); } } //ç¼–ç¨‹å¼è·¯ç”±å¯¼èˆª + stateä¼ å‚ pushcheck = (id, title) => { return () => { this.props.history.push(`/home/messages/detail`, {id:id, title:title}); } } åŒæ ·çš„ï¼Œå¦‚æœæƒ³å®ç°ç½‘é¡µå‰è¿› + åé€€åŠŸèƒ½ï¼›ä¹Ÿå¯ä»¥ä½¿ç”¨ this.props.history.goForward()ã€this.props.history.goBack() å¯¹äºå‡½æ•°å¼ç»„ä»¶ï¼Œå¯ä»¥é€šè¿‡ç»„ä»¶æ¥æ”¶çš„propsï¼Œé€šè¿‡ props.history.push()æ¥è·³è½¬è·¯ç”±ï¼Œè¿˜å¯ä»¥é€šè¿‡history Hookæ¥è·³è½¬ V6ä¹‹åæ˜¯useNavigate import { useHistory } from 'react-router-dom' export default function Index(){ const history = useHistory(); const pushcheck = () => { return () => { history.push(`/home/messages/detail?id=${id}&amp;title=${title}`); } } } withRouterä¸€èˆ¬ç»„ä»¶å’Œè·¯ç”±ç»„ä»¶ ä¸Šæ–¹é˜è¿°çš„æ˜¯è·¯ç”±ç»„ä»¶çš„ä½¿ç”¨ï¼Œä»–ä»¬æœ‰å„è‡ªçš„ä¸åŒä¹‹å¤„ 1.ä¸€èˆ¬ç»„ä»¶ç›´æ¥ä½¿ç”¨ï¼Œè·¯ç”±ç»„ä»¶é€šè¿‡è·¯ç”± linkåˆ‡æ¢ï¼Œç„¶åä¾é è·¯ç”±ï¼ˆ&lt;Route component=xxx&gt;ï¼‰åŒ¹é…å†³å®šæ¸²æŸ“å“ªä¸€ä¸ª 2.ä¸€èˆ¬ç»„ä»¶å¦‚æœçˆ¶ç»„ä»¶æ²¡ä¼ propsï¼Œåˆ™æ”¶åˆ°ç©ºå¯¹è±¡ï¼Œè·¯ç”±ç»„ä»¶é»˜è®¤ä¼šæ¥æ”¶åˆ°propsï¼šhistoryã€locationã€match 3.ä¼ å‚æ–¹å¼ä¸ä¸€æ ·ï¼Œä¸€èˆ¬ç»„ä»¶ç›´æ¥å±æ€§ä¼ å€¼ï¼Œpropsæ¥æ”¶ï¼Œè·¯ç”±ç»„ä»¶æœ‰ä¸‰ç§ä¼ å‚æ–¹å¼ ä¸Šæ–¹è®²è¿°äº†è®¸å¤šå…³äºè·¯ç”±ç»„ä»¶çš„apiï¼Œä½†æ˜¯è¿™äº›éƒ½ä»…é™äºè·¯ç”±ç»„ä»¶ï¼Œå¦‚æœæƒ³è¦åœ¨ä¸€èˆ¬ç»„ä»¶ä½¿ç”¨ï¼Œå¯ä»¥ä½¿ç”¨åˆ° withRouter withRouter(ä¸€èˆ¬ç»„ä»¶) å°±ä¼šæ·»åŠ ä¸Šè·¯ç”±ç»„ä»¶èº«ä¸Šç‰¹æœ‰çš„ä¸‰ä¸ªå±æ€§ï¼šhistoryã€locationã€matchï¼ import { withRouter } from 'react-router-dom' class Header extends Component{ // } export default withRouter(Header); è·¯ç”±å®ˆå«åŒvueï¼Œç”¨äºæ‹¦æˆªæ¯ä¸€æ¬¡è·¯ç”±è·³è½¬ä¹‹å‰çš„ä¸€æ¬¡å›è°ƒå‡½æ•°ï¼Œä½¿ç”¨æ–¹æ³•ï¼š &lt;Route path=\"home\" render={() => &lt;Home />}>&lt;/Route> //å®è´¨ä¸Šï¼Œè¿™ä¸ªå†™æ³•å’Œ&lt;Route path=\"/home\" component={Home}>&lt;/Route>ä¸€æ · æ­¤æ—¶ï¼Œåªéœ€è¦æˆ‘ä»¬åœ¨renderçš„å‡½æ•°é‡Œå†™ä¸Šè‡ªå·±éœ€è¦çš„æ‹¦æˆªé€»è¾‘å³å¯ &lt;Route path=\"/\" render={() => æ˜¯å¦æˆæƒ ? (&lt;SandBox />) : (&lt;Redirect to=\"/login\" />); }>&lt;/Route> ä½†æ˜¯æ­¤æ—¶ä¼ å…¥çš„ç»„ä»¶æ˜¯è¢«å½“åšæ™®é€šç»„ä»¶æ¥ä½¿ç”¨ï¼Œå¹¶ä¸æ˜¯è·¯ç”±ç»„ä»¶ï¼ˆä¸ä¼šå¸¦ä¸Šè·¯ç”±ç»„ä»¶çš„apiï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡renderå¸¦çš„propså‚æ•°æ”¾å…¥ç»„ä»¶ä¸­ï¼ˆæˆ–è€…åœ¨ç»„ä»¶å¯¼å‡ºçš„æ—¶å€™ç›´æ¥æŠ¥è¿‡withRouterï¼‰ï¼Œæ­¤æ—¶ç»„ä»¶å°±å¯ä»¥ä½¿ç”¨è·¯ç”±ç»„ä»¶çš„apiäº† &lt;Route path=\"home\" render={(props) => { æ˜¯å¦æˆæƒ ? &lt;Home {...props}/> : &lt;Redirect to=\"/login\"/> }>&lt;/Route> åœ¨vueä¸­ï¼Œä»–æœ‰è‡ªå·±ä¸€å¥—ä¸¥æ ¼çš„è·¯ç”±æ‹¦æˆªä½“ç³»ï¼Œä½†æ˜¯åœ¨reactåªæ˜¯è¿™ç§ç®€å•çš„ï¼Œå®è´¨ä¸Šå‹æ ¹æ²¡æœ‰æ‹¦æˆªè¿™ä¸ªæ¦‚å¿µ ä¸è¿‡å’‹v6ä¹‹åï¼Œå¯ä»¥ç›´æ¥ä¼ ï¼Œä¸ç”¨render &lt;Route path=\":userId\" element={&lt;Profile animate={true} />} /> keep-alivereactä¸­æ²¡æœ‰ç±»ä¼¼äºvue router çš„ keep aliveåŠŸèƒ½ï¼Œkeep aliveç”¨äºç¼“å­˜ä¹‹å‰é¡µé¢æ‰“å¼€çš„ç»„ä»¶æ•°æ®å’Œå†…å®¹ æ›¾ç»æœ‰äººåœ¨å®˜æ–¹æè¿‡åŠŸèƒ½ issues ï¼Œä½†å®˜æ–¹è®¤ä¸ºè¿™ä¸ªåŠŸèƒ½å®¹æ˜“é€ æˆå†…å­˜æ³„éœ² keep-aliveçš„åº“æ¨èï¼š æ—©æœŸçš„react-keep-alive åŸç†ï¼š ä½¿ç”¨React.createPortal APIå®ç°äº†è¿™ä¸ªæ•ˆæœã€‚ ç¼ºç‚¹ï¼š è¿™ä¸ªåº“å­˜åœ¨æ–­å±‚ç°è±¡ï¼Œè™½ç„¶å¯ä»¥ç¼“å­˜æœ€åä¸€æ¬¡çŠ¶æ€æ¸²æŸ“ç»“æœï¼Œä½†æ˜¯åé¢æ•°æ®å˜åŒ–æ— æ³•å†è¿›è¡Œæ•°æ®é©±åŠ¨ã€‚è€Œä¸”æ˜¯å€ŸåŠ©React.createPortal å€ŸåŠ©å®ç° æ€»ä½“æ¥è¯´ï¼Œreact-keep-aliveè¿™ä¸ªåº“æ¯”è¾ƒé‡ï¼Œå®ç°åŸç†ä¹Ÿä¸éš¾ï¼Œå°±æ˜¯ç¬¨é‡ï¼Œæ–­å±‚ï¼Œæºç è·³æ¥è·³å»ï¼ŒçœŸçš„ç†æ¸…æ¥šäº†å°±å¥½ ç°åœ¨ï¼šreact-activation åŸç† æŠ½å–childrenå±æ€§ï¼Œå†å°è£…ä¸€æ¬¡HOCé«˜é˜¶ç»„ä»¶å³å¯ã€‚ å»ºè®®å…³æ³¨ React 18.x ä¸­çš„å®˜æ–¹å®ç° &lt;Offscreen /&gt; å‚è€ƒï¼šhttps://segmentfault.com/a/1190000023263395 å‚è€ƒï¼šhttps://github.com/CJY0208 7.React UIåº“material-uiï¼ˆå›½å¤–ï¼‰ å®˜ç½‘ï¼šhttps://material-ui.com/zh/ GitHubï¼šhttps://github.com/mui-org/material-ui ant-designï¼ˆå›½å†…èš‚èšé‡‘æœï¼‰ï¼ˆæ¨èï¼‰ å®˜ç½‘ï¼šhttps://ant.design/index-cn GitHubï¼šhttps://github.com/ant-design/ant-design ä¸‹è½½antd npm i antd --save åœ¨å¼•å…¥çš„æ—¶å€™ï¼Œä¸è¦å¿˜è®°ä¹Ÿè¦å¼•å…¥ antd/dist/antd.cssï¼ˆå®˜ç½‘æ˜¾ç¤ºä»£ç å±…ç„¶æ²¡æœ‰æç¤ºè¦å¼•å…¥cssï¼‰ï¼Œä¸è¿‡æœ€å¥½è¦æŒ‰éœ€å¼•å…¥ï¼Œimport &#39;antd/dist/antd.css&#39;åŠ è½½äº†å…¨éƒ¨çš„ antd ç»„ä»¶çš„æ ·å¼ ã€‚ ä¸è¿‡ç°åœ¨å¥½åƒç»“åˆwebpackçš„tree shakingï¼Œè‡ªåŠ¨æŒ‰éœ€å¼•å…¥äº†ï¼Œä¸ç”¨ç®¡ æ­¤æ—¶æˆ‘ä»¬å¯ä»¥è¿›å…¥å®˜ç½‘ -&gt; æ–‡æ¡£-&gt; åœ¨create-react-app -&gt;é«˜çº§é…ç½®ä¸­ä½¿ç”¨è¿›è¡ŒæŸ¥çœ‹ï¼ˆçœ‹ä¸åˆ°å°±çœ‹3.xç‰ˆæœ¬ï¼‰ å‡å¦‚æˆ‘åªæ˜¯ç”¨äº†Buttonç»„ä»¶ //å¼•å…¥Buttonç»„ä»¶ import { Button } from 'antd' import 'antd/dist/antd.css' Vueçš„è¯æ¨èä½¿ç”¨element-UIåº“ï¼Œåé¢åå“ä¸é”™ï¼Œä¹Ÿå‡ºäº†reactçš„UI å…³äºejectä¹‹åantdçš„ä¸»é¢˜é¢œè‰²é…ç½®ç”±äºç§è‡ªejectäº†ï¼Œå®˜ç½‘æ²¡æœ‰ç›¸å…³ejectåçš„ä¸»é¢˜é…ç½®çš„ä»£ç ï¼Œåœ¨ç½‘ä¸Šç¿»æ¥è¦†å»ï¼Œç»ˆäºæ‰¾åˆ°çœŸæ­£åˆé€‚çš„æ–‡ç«  https://blog.csdn.net/f980815/article/details/109385835 å¯¹äºReact Nativeçš„æŒ‰éœ€å¯¼å…¥ï¼Œè¿˜å¾—å†babel.config.jsè¿›è¡Œé…ç½® npm i ant-design/react-native module.exports = { presets: ['module:metro-react-native-babel-preset'], // æŒ‰éœ€åŠ è½½ \"plugins\": [ [\"import\", { libraryName: \"@ant-design/react-native\" }] // ä¸ Web å¹³å°çš„åŒºåˆ«æ˜¯ä¸éœ€è¦è®¾ç½® style ] }; 8.reduxreduxæ˜¯ä¸€ä¸ªä¸“é—¨åšçŠ¶æ€ç®¡ç†çš„JSåº“ï¼ˆé›†ä¸­å¼ç®¡ç†ï¼‰ å®ƒå¯ä»¥åœ¨Reactã€Angularã€Vueç­‰é¡¹ç›®ä¸­ï¼Œä½†åŸºæœ¬å’ŒReacté…åˆä½¿ç”¨ ä½œç”¨ï¼šé›†ä¸­å¼ç®¡ç†reactåº”ç”¨ä¸­å¤šä¸ªç»„ä»¶å…±äº«çŠ¶æ€ å½“éœ€è¦å¤§é‡å…±äº«å¯ä»¥ä½¿ç”¨ï¼Œä½†æ˜¯èƒ½ä¸ç”¨å°±ä¸ç”¨ï¼Œæ¯•ç«Ÿæ˜¯å…¨å±€çš„ä¸œè¥¿ ï¼ˆå®é™…ä¸Šæœ‰ç‚¹åƒVuexï¼ŒVueäººå®¶å°±å¾ˆå°‘ç”¨è¿™ä¸ªï¼Œç”¨è‡ªå·±å†…éƒ¨çš„Vuexï¼‰ ä»¥ä¸Šä¸ºreduxåŸç†å›¾ reduxä¸‰ä¸ªæ ¸å¿ƒæ¦‚å¿µ action æœ‰åŒæ­¥action ï¼ˆsyncï¼‰å’Œå¼‚æ­¥action ï¼ˆasyncï¼‰ åŠ¨ä½œå¯¹è±¡ åŒ…å«ä¸¤ä¸ªå±æ€§ï¼š typeï¼šæ ‡è¯†å±æ€§ï¼Œå€¼ä¸ºå­—ç¬¦ä¸²ï¼Œå”¯ä¸€ï¼Œå¿…è¦å±æ€§ dataï¼šæ•°æ®å±æ€§ï¼Œä»»æ„ç±»å‹ï¼Œå¯é€‰å±æ€§ reducer Reducersä¸ä»…èƒ½åŠ å·¥çŠ¶æ€ï¼ˆåŠ å·¥çŠ¶æ€é‚£ä¹ˆéƒ¨åˆ†æœ‰ç‚¹åƒVueé‡Œçš„mutationsï¼‰ï¼Œè¿˜èƒ½åˆå§‹åŒ–çŠ¶æ€ åŠ å·¥æ—¶ï¼Œæ ¹æ®æ—§çš„stateå’Œactionï¼Œäº§ç”Ÿæ–°çš„stateçº¯å‡½æ•° åœ¨åˆå§‹åŒ–æ—¶ï¼Œreducerå¾—åˆ°çš„previousStateã€actionåˆ†åˆ«ä¸º undefinedã€type:&#39;@@init&#39; + éšæœºå­—ç¬¦,data: æ—  store å°†stateã€actionã€reducerè”ç³»åœ¨ä¸€èµ·çš„å¯¹è±¡ï¼Œè´Ÿè´£å¯¹å¤–æš´éœ² åŸºæœ¬ä½¿ç”¨åˆå§‹åŒ– npm i redux æ–°å»ºä¸€ä¸ªreduxæ–‡ä»¶å¤¹ æ–°å»º store.js æ–°å»ºä¸€ä¸ªå¤„ç†xxxç»„ä»¶çš„ xxx-reducer.js å¯é€‰ï¼Œæ–°å»ºä¸€ä¸ªå¤„ç†xxç»„å»ºçš„xxx-action.js å»ºç«‹storestore.jsæ˜¯ä¸“é—¨ç”¨äºæš´éœ²ä¸€ä¸ªstoreå¯¹è±¡ï¼Œæ•´ä¸ªä¸€åº”ç”¨åªæœ‰ä¸€ä¸ªstoreå¯¹è±¡ï¼Œé…åˆreduxçš„createStore API å¯ä»¥åˆ›å»ºä¸€ä¸ªstoreå¯¹è±¡ //store.js //createStoreä¸“é—¨ç”¨äºåˆ›å»ºstoreå¯¹è±¡ import { createStore } from 'redux' // å¼•å…¥reducer import countReducer from './count_reducer' // æš´éœ²store export default createStore(countReducer) createStore ç¬¬ä¸€ä¸ªå‚æ•°ä¼ å…¥reducer ç¬¬äºŒä¸ªå‚æ•°å¯é€‰ï¼Œä¼ å…¥stateçš„é»˜è®¤çŠ¶æ€ï¼Œå½“ç„¶stateçš„é»˜è®¤å€¼ä¹Ÿå¯ä»¥é€šè¿‡ç»™reducerçš„ç¬¬ä¸€ä¸ªå‚æ•°èµ‹å€¼ä¸Šé»˜è®¤å€¼æ¥ç¡®å®š å…³äºstoreçš„å°bugç”±äºå…¨å±€çŠ¶æ€storeæ˜¯ä¿å­˜åœ¨å†…å­˜ä¸­çš„ï¼Œå¦‚æœåˆ·æ–°å½“å‰é¡µé¢ï¼Œåˆ™æˆ‘ä»¬ä¹‹å‰é€šè¿‡actionè°ƒç”¨reducerå¯¹storeåšçš„ä¿®æ”¹éƒ½ä»é›¶å¼€å§‹ å»ºç«‹reducerè¿™é‡Œæˆ‘æ¨¡æ‹Ÿä¸€ä¸ªå¤„ç†countæ•°æ®çš„reducer xxx_reducer.jsæ˜¯ç”¨äºåˆ›å»ºä¸€ä¸ªä¸ºCountç»„ä»¶æœåŠ¡çš„reducerï¼Œreducerçš„æœ¬è´¨å°±æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œreducerå‡½æ•°ä¼šæ¥åˆ°ä¸¤ä¸ªå‚æ•°ï¼Œåˆ†åˆ«ä¸ºï¼šä¹‹å‰çš„å¯¹è±¡preStateã€åŠ¨ä½œå¯¹è±¡action // reducerç”¨äºæœ€åŸºæœ¬çš„æ•°æ®å¤„ç†ï¼Œæ˜¯ä¸€ä¸ªçº¯å‡½æ•°ï¼Œå…¶å®æ˜¯ä¸ºäº†diffç®—æ³• const initState = 0; //å¦‚æœä½ è¦å­˜å¤šä¸ªæ•°æ®ï¼Œå¯ä»¥åˆå§‹åŒ–æˆä¸€ä¸ªå¯¹è±¡ export default function countReducer(preState = initState, action) { console.log(preState); const { type, data } = action; let newState = preState; switch (type) { case 'increment': return newState + data * 1; case 'decrement': return newState - data * 1; default: // ä¸åŠ ä¹Ÿä¸å‡ï¼Œè¯´æ˜æ˜¯åˆå§‹åŒ– return newState } } åœ¨é¢å¯¹å¤šäººå¼€å‘æ—¶ï¼Œå¦‚æœåªç”¨ä¸€ä¸ªreducerï¼Œå¯èƒ½ä¼šå †ç§¯å¤§é‡çš„çŠ¶æ€ï¼Œæˆ‘ä»¬å¯ä»¥æ‹†åˆ†reducerå‡½æ•° import { combineReducers, createStore } from 'redux' import CityReducer from './reducer/CityReducer' import TabbarReducer from './reducer/TabbarReducer' const reducer = combineReducers({ CityReducer, TabbarReducer }) export default createStore(reducer) è€Œæ­¤æ—¶æˆ‘ä»¬è·å–Storeçš„æ—¶å€™ï¼Œä¸èƒ½ç›´æ¥é€šè¿‡ getStateï¼Œéœ€è¦ console.log(store.getState().CityReducer) console.log(store.getState().TabbarReducer) å…³äºreducerçš„å°bug åœ¨reduxåº•å±‚ä¼šåšä¸€ä¸ªåˆ¤æ–­ï¼Œå¦‚æœè¿”å›çš„ä¸œè¥¿ï¼Œå’Œä¹‹å‰çš„preStateæ˜¯ä¸€æ ·çš„ï¼Œé‚£å°±ä¸ä¼šè¿›è¡Œé¡µé¢æ›´æ–°ã€‚ æ³¨æ„reduxçš„reducerå¿…é¡»æ˜¯ä¸€ä¸ªçº¯å‡½æ•°ï¼ˆçº¯å‡½æ•°çš„æ¦‚å¿µæˆ‘åœ¨ES5ç¯‡ç« æœ‰æåŠåˆ°ï¼‰ è€Œå¯¹æ¯”vueï¼Œç”±äºä»–ç”¨çš„æ˜¯ä»£ç†ï¼Œæ‰€ä»¥å¤æ‚æ•°æ®ç±»å‹æ€ä¹ˆæ”¹ä¹Ÿä¸ä¼šå½±å“åˆ°åŸæ¥çš„æ•°æ® export default function personReducer(preState = initState, action) { const { type, data } = action; switch (type) { case ADD_PERSON: // åšäº†ä¸€ä¸ªæµ…æ¯”è¾ƒï¼Œè¿”å›çš„preStateçš„åœ°å€å€¼å’Œä¹‹å‰çš„æ˜¯ä¸€æ ·çš„ï¼Œé‚£å°±ä¸è¿›è¡Œé¡µé¢æ›´æ–°äº† //é”™Ã—ï¼špreState.unshift(data); return preState; return [data, ...preState] default: return preState; } } æ‰€ä»¥å¯ä»¥åœ¨Reactã€Reduxé‡Œé¢ï¼Œæˆ‘ä»¬å¾ˆå°‘ä½¿ç”¨pushã€unshiftè¿™äº›æ•°ç»„æ–¹æ³•ï¼Œè€Œä¸”è¿™æ ·ä¼šå¯¼è‡´å‡½æ•°ä¸å†æ˜¯çº¯å‡½æ•°äº†ã€‚ å…³äºstoreçš„æ›´æ–°// å¼•å…¥storeï¼Œç”¨äºè·å–reduxä¸­ä¿å­˜çš„çŠ¶æ€ import store from '../redux/store' //å¯ä»¥ç›´æ¥è·å–storeå­˜å‚¨çš„æ•°æ® console.log(store.getState()) è¿™é‡Œæˆ‘ç›´æ¥åœ¨ç»„ä»¶å†…è‡ªå®šä¹‰incrementå‡½æ•°æ¨¡æ‹Ÿactionå‘storeå‘é€æ›´æ”¹ æ•°æ®çš„ç±»å‹type å’Œ ä¼ å…¥çš„æ•°æ®data increment = () => { const { value } = this.selectNumber; // dispatchä¼ å…¥typeå’Œdata store.dispatch({ type: 'increment', data: value }); } ä½†æ˜¯å¹³æ—¶æˆ‘ä»¬ä½¿ç”¨setStateä¼šè‡ªåŠ¨å¸®æˆ‘ä»¬è°ƒç”¨ä¸€æ¬¡renderæ›´æ–°é¡µé¢ï¼Œä½†æ˜¯storeæ›´æ–°æ²¡æœ‰è°ƒç”¨render è§£å†³æ–¹æ³•ä¸€ï¼šåœ¨ç»„ä»¶å†…ï¼Œåœ¨componentDidMountç”Ÿå‘½å‘¨æœŸé’©å­åä½¿ç”¨ redux å¸¦çš„ subscribe API ï¼Œç”¨äºè®¢é˜…çŠ¶æ€æ›´æ”¹ï¼Œç›‘å¬storeæ•°æ®çš„å˜åŒ–ï¼Œå‘ç”Ÿå˜åŒ–åˆ™æ‰§è¡Œä¼ å…¥çš„å›è°ƒå‡½æ•°ï¼ˆ this.setState({}) -&gt; render ï¼‰ // DOMæŒ‚åœ¨å®Œæ¯•åï¼Œç›‘å¬reduxä¸­çŠ¶æ€çš„å˜åŒ–ï¼Œåªè¦å˜åŒ–å°±è°ƒç”¨render componentDidMount() { store.subscribe(() => { //è™šæ™ƒä¸€æªï¼Œè®©å®ƒå¸®æˆ‘ä»¬è°ƒç”¨ä¸€æ¬¡renderï¼ˆè‡ªå·±è°ƒç”¨this.renderä¸ç®¡ç”¨ï¼‰ //ä¸è¿‡æˆ‘æ„Ÿè§‰ä½¿ç”¨forceUpdate()å¥½åƒä¹Ÿè¡Œ this.setState({}); }) } å¦‚æœæ˜¯hookç»„ä»¶ï¼Œåˆ™ useEffect(() => { const unSubscribe = store.subscribe(() => { setState(store.getState()) }) return () => { unSubscribe() } }, []) ä½†æ˜¯è¿™ç§è®¢é˜…æ–¹å¼ï¼Œå¿…é¡»è®©ç»„ä»¶é”€æ¯æ—¶ï¼Œå°†å…¶ä¹Ÿå–æ¶ˆè®¢é˜…ï¼Œä¸ç„¶ä¼šé‡å¤è®¢é˜…ï¼Œå› ä¸ºstore.subscribeä¸ä¼šéšç€ç»„ä»¶è¢«é”€æ¯è€Œæ¶ˆå¤±ï¼Œè€Œæ˜¯é»˜é»˜ä¿å­˜åœ¨reduxçš„å†…éƒ¨è®¢é˜…è€…æ•°ç»„ä¸­ store.subscribeä¼šè¿”å›ä¸€ä¸ªå‡½æ•°ï¼Œè¯¥å‡½æ•°æ—¶å–æ¶ˆè®¢é˜…çš„ï¼ˆåœ¨ç±»å¼ç»„ä»¶ä¸­å¯ä»¥åœ¨ componentWillUnmount ä¸­å–æ¶ˆè®¢é˜… ï¼‰ useEffect(() => { const unSubscribe = store.subscribe(() => {}) return () => { unSubscribe() } }, []) è§£å†³æ–¹æ³•äºŒï¼šå¯¹äºæ•´ä¸ªç»„ä»¶ï¼Œç›´æ¥ç”¨redux å¸¦çš„ subscribe API è¿›è¡ŒåŒ…è£¹ï¼Œï¼ˆè¿™é‡Œè€å¸ˆè¯´æœ‰äº†diffç®—æ³•ï¼Œå®é™…ä¸Šæ•´ä½“æ€§èƒ½å½±å“ä¸ä¼šç‰¹åˆ«å¤§ï¼‰ //ReactDOM.render(&lt;App />, document.querySelector('#root')); store.subscribe(() => { ReactDOM.render(&lt;App />, document.querySelector('#root')) }) è§£å†³æ–¹æ³•ä¸‰ï¼šä½¿ç”¨react-redux è¡¥å……Actionæ­¤æ—¶å¯ä»¥è¡¥å……actionæäº¤ä¿®æ”¹ï¼šå‘storeå‘é€æ›´æ”¹ æ•°æ®çš„ç±»å‹type å’Œ ä¼ å…¥çš„æ•°æ®data åœ¨reduxæ–‡ä»¶å¤¹ä¸‹åˆ›å»ºxxx_action.jsï¼Œå¯¼å‡ºactionæ–¹æ³• export const createIncrementAction = data => ({ type: 'increment', data }); export const createdecrementAction = data => ({ type: 'decrement', data }); ç„¶åå¯ä»¥ç›´æ¥åœ¨ç»„ä»¶ä¸­å¯¼å…¥ + ä½¿ç”¨ï¼Œå¯ä»¥åƒå®˜æ–¹reduxåŸç†å›¾ä¸€æ ·ï¼Œä¸éœ€è¦è‡ªå·±æ¥ å‘storeå‘é€æ›´æ”¹ æ•°æ®çš„ç±»å‹type å’Œ ä¼ å…¥çš„æ•°æ®data å’ŒVueä¸€æ ·ï¼Œå¼€å‘æ—¶å®šä¹‰å¸¸é‡æ˜¯å‡å°‘é”™è¯¯çš„åŸºæœ¬æ–¹æ³•ï¼ˆå®é™…ä¸Šä¹Ÿæ˜¯é˜²æ­¢å•è¯å†™é”™ï¼‰ ç„¶åå†ç»„ä»¶ä¸­ä½¿ç”¨Actionæ–¹æ³• import { createIncrementAction } from '../redux/count_action' increment = () => { const { value } = this.selectNumber; // dispatchä¸ºactionä¼ å…¥å‚æ•° store.dispatch(createIncrementAction(value)); } async Actionactionå¯ä»¥ä¸ºå¯¹è±¡ï¼ˆtypeã€dataå±æ€§ï¼‰ï¼Œä¹Ÿå¯ä»¥ä¸ºå‡½æ•° æˆ‘ä»¬è¿”å›ä¸€ä¸ªå‡½æ•°ï¼ŒæŠŠå¼‚æ­¥æ“ä½œå­˜æ”¾åœ¨è¿™ä¸ªå‡½æ•°é‡Œï¼Œå†è°ƒç”¨åŒæ­¥actionï¼ˆå¼‚æ­¥Actionä¸­ä¸€èˆ¬éƒ½ä¼šè°ƒç”¨ä¸€ä¸ªåŒæ­¥actionï¼‰ï¼Œç”±æ­¤å½¢æˆä¸€ä¸ªå¼‚æ­¥æ“ä½œï¼Œ å› ä¸ºstoreåªè®¤actionä½œä¸ºä¸€ä¸ªå¯¹è±¡æ¥è¿”å›ï¼Œæ­¤æ—¶æˆ‘ä»¬éœ€è¦ç”¨åˆ°ä¸€ä¸ªä¸­é—´ä»¶ï¼Œè®©storeæ„¿æ„æ¥æ”¶ä¸€ä¸ªå‡½æ•°ï¼Œå¹¶ä¸”è°ƒç”¨å®ƒï¼šï¼ˆå³ä½¿æˆ‘ä»¬åœ¨å¼‚æ­¥actionä¸­å†™æ˜äº†ç›´æ¥returnå¯¹è±¡ï¼Œä½†æ˜¯ä¹Ÿç”±äºå¼‚æ­¥çš„åŸå› ï¼Œå‡½æ•°ä½“æ‰§è¡Œå®Œæ¯•äº†ï¼Œç›´æ¥è¿”å›ä¸€ä¸ªundefinedï¼‰ é™¤äº†redux-thunkä¹‹å¤–ï¼Œredux-promiseä¸­é—´ä»¶ä¹Ÿæ˜¯ä¸€ç§å®ç°å¼‚æ­¥actionçš„æ–¹å¼ï¼Œç›´æ¥è¿”å›ä¸€ä¸ªpromise npm i redux-thunk ç„¶åå†store.jsé‡Œ //store.js //applyMiddlewareä¸ºstoreä½¿ç”¨ä¸­é—´ä»¶çš„API import { createStore, applyMiddleware } from 'redux' // å¼•å…¥reducerï¼Œthunkä¸ºæ¥æ”¶å‡½æ•°å¼actionå¿…é¡»çš„ä¸­é—´ä»¶ import Reducer from './reducer' import thunk from 'redux-thunk' // æš´éœ²storeï¼Œ export default createStore(Reducer, applyMiddleware(thunk)) ç„¶ååœ¨action.jsè¿™ä¸ªæ–‡ä»¶é‡Œå®šä¹‰å¼‚æ­¥actionï¼ˆä½œä¸ºä¸€ä¸ªå‡½æ•°è¿”å›ï¼Œç»è¿‡ä¸­é—´ä»¶çš„å¤„ç†ï¼Œæ¥æ”¶ä¸€ä¸ªdispatchæ–¹æ³•ï¼Œå¯å¸®åŠ©ä½ è°ƒç”¨åŒæ–‡ä»¶ä¸‹çš„åŒæ­¥actionæ–¹æ³•ï¼‰ export const asyncIncrement = (data) => { return (dispatch) => { setTimeout(() => { dispatch(createIncrementAction(data)) }, 1000); } } åœ¨ç»„ä»¶ä¸­ä½¿ç”¨ï¼š import store from '../redux/store' import {asyncIncrement } from '../redux/count_action' store.dispatch(asyncIncrement(value, 500)); å¼‚æ­¥actionï¼šå®ƒä¸æ˜¯ä¸€ä¸ªå¿…é¡»çš„ä¸œè¥¿ï¼Œå®é™…ä¸Šæˆ‘ä»¬å¯ä»¥åœ¨è‡ªå·±çš„ç»„ä»¶å‡½æ•°é‡Œå®šä¹‰å¼‚æ­¥æ“ä½œï¼Œåªæ˜¯å½“ä½ ä¸æƒ³è¦æŠŠå¼‚æ­¥æ“ä½œæ”¾åœ¨ç»„ä»¶é‡Œæ˜¯ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸Šå¼‚æ­¥actionæ–¹æ³• redux-thunkåŸç† export default function thunkMiddleware({ dispatch, getState }) { return (next) => (action) => typeof action === \"function\" ? action(dispatch, getState) : next(action); } redux-sagaredux-sagaè§£å†³å¼‚æ­¥actionsé—®é¢˜ maybeçœ‹ä¸æƒ¯äº†æŠŠåŸæ¥ä½œä¸ºå¯¹è±¡çš„actionå˜æˆäº†å…¶ä»–å½¢å¼ï¼Œäºæ˜¯åé¢å‡ºäº†ä¸€ä¸ªredux-sagaï¼Œå…¶åŸç†æ˜¯ä½¿ç”¨äº†ç”Ÿæˆå™¨ï¼ˆgeneratorï¼‰ åœ¨sagaä¸­ï¼Œå…¨å±€ç›‘å¬å’Œæ¥æ”¶å™¨ä½¿ç”¨Generatorå‡½æ•°å’Œsagaè‡ªèº«ä¸€äº›è¾…åŠ©å‡½æ•°å®ç°å¯¹æ•´ä¸ªæµç¨‹çš„ç®¡æ§ npm i redux-saga åœ¨reduxä¸‹æ–°å»ºä¸€ä¸ªsaga.jsæ–‡ä»¶ import { take, fork, call, put } from \"redux-saga/effects\"; /* function* watchaSaga() { while (true) { //takeç›‘å¬ç»„ä»¶ yield take(\"getList\"); //forkåŒæ­¥æ‰§è¡Œå¼‚æ­¥å¤„ç†å‡½æ•°(éé˜»å¡å¼) yield fork(GetList); } } */ //watchSagaå¦å¤–ä¸€ç§å†™æ³• function* watchaSaga() { yield takeEvery(\"getList\", GetList) } function* GetList() { // å¼‚æ­¥å¤„ç† //callå‡½æ•°å‘å¼‚æ­¥è¯·æ±‚,ä¼ å…¥ä¸€ä¸ªè¿”å›å€¼ä¸ºpromiseå¯¹è±¡çš„å‡½æ•°ï¼Œé˜»å¡å¼è°ƒç”¨ let res = yield call(asyncGetList); // putå‡½æ•°å‘å‡ºæ–°çš„action yield put({ type: \"changeList\", payload: res, }); } function asyncGetList() { return new Promise((res, rej) => { setTimeout(() => { res(\"è¿”å›ç»“æœ\"); }, 2000); }); } export default watchaSaga; æ­¤æ—¶åœ¨store.jsä¸­ï¼ŒåµŒå…¥ä¸­é—´ä»¶ï¼Œå¹¶ä¸”åœ¨å¯¼å‡ºstoreä¹‹å‰è°ƒç”¨watchSagaè¿›è¡Œå®æ—¶ç›‘å¬ import { createStore, applyMiddleware } from \"redux\"; import createSagaMiddleWare from \"redux-saga\"; import countReducer from \"./reducer\"; import watchSaga from \"./saga\"; // å’Œredux-thunkä¸€æ ·ï¼Œéƒ½è¦å¥—å…¥ä¸­é—´ä»¶ const SagaMiddleWare = createSagaMiddleWare(); const store = createStore(countReducer, applyMiddleware(SagaMiddleWare)); SagaMiddleWare.run(watchSaga); export default store; ç„¶åå†reducerä¸­ç…§å¸¸ç›‘å¬dispatchä¼ è¿‡æ¥çš„typeå’Œpayload interface IAction { type: string; payload?: any; } interface IPreState { isShow: boolean; list: string; } export default function countReducer( preState: IPreState = { isShow: true, list: \"\", }, action: IAction ) { const { type, payload } = action; let newState = preState; //... switch (type) { case \"changeList\": console.log(\"enter changelist\"); newState.list = payload; return newState; default: return preState; } } æœ€ååœ¨ç»„ä»¶ä¸­ä½¿ç”¨æ—¶ï¼Œç›´æ¥dispatchåœ¨saga.jsä¸­ç›‘å¬çš„type store.dispatch({type: 'getList', payload: 'nothing'}) ï¼ˆå¤§ç«çœ‹åˆ°redux-thunkçš„å¥½äº†å§ï¼Ÿã€‚ã€‚ï¼‰ å°reduxä¸ªäººå°å°å°ç‰ˆreduxèµæ function createStore(reducer, initialState = {}) { //ç”¨äºå­˜æ”¾è®¢é˜…è€… const list = []; let state = reducer() | initialState; function subscribe(callback) { list.push(callback); } function dispatch(action) { reducer(state, action); for (let i in list) { list[i] &amp;&amp; list[i](); } } function getState() { return state } return { subscribe, dispatch, getState, }; } 9.react-reduxfacebookä¸ºäº†è®©å¼€å‘äººå‘˜æ›´åŠ èˆ’æœä½¿ç”¨reduxï¼Œå¼€å‘äº†react-redux ï¼ˆå…¶å®æˆ‘ä¸ªäººè§‰å¾—å¯ä»¥ç†è§£ä¸ºï¼Œreactè®©ç»„ä»¶å’Œreduxä¹‹é—´çš„äº¤äº’å¤šäº†ä¸€ä¸ªä¸­é—´äººï¼ˆå¥—äº†ä¸ªå¤–å£³ï¼‰ï¼šcontainerï¼Œä½¿å¾—æˆ‘ä»¬ä»¥åéƒ½ä¸éœ€è¦å…³å¿ƒè®¢é˜…å’Œå–æ¶ˆè®¢é˜…çš„é—®é¢˜ï¼‰ å¯ä»¥çœ‹å¾—å‡ºå¤–é¢è¦äº†ä¸€å±‚å®¹å™¨ï¼Œé˜²æ­¢UIç»„ä»¶ç›´æ¥å¯¹æ¥redux componentsæ–‡ä»¶å¤¹å­˜æ”¾çš„æ˜¯UIç»„ä»¶ï¼ˆä¸èƒ½ä½¿ç”¨ä»»ä½•çš„redux APIï¼Œåªè´Ÿè´£é¡µé¢çš„å‘ˆç°ï¼‰ æˆ‘ä»¬è¦åˆ›å»ºä¸€ä¸ªcontainerçš„æ–‡ä»¶å¤¹ï¼Œç„¶åæ–°å»ºä¸€ä¸ªå®¹å™¨ç»„ä»¶ï¼Œå®¹å™¨ç»„ä»¶ä½œä¸ºUIç»„ä»¶ å’Œ react-reduxçš„æ¡¥æ¢ï¼Œä¸èƒ½ç›´æ¥rccè‡ªå®šä¹‰ç»„ä»¶ï¼Œè€Œæ˜¯ä½¿ç”¨react-reduxåº“åˆ›å»ºã€‚ npm i react-redux è¿æ¥UIè¿æ¥UIç»„ä»¶çš„æ–¹å¼ï¼šæ–°å»ºä¸€ä¸ªcontainersæ–‡ä»¶å¤¹ï¼Œindex.jsxæ–‡ä»¶ // å¼•å…¥CountUIç»„ä»¶,CountUIç»„ä»¶ä¸ºcomponentsæ–‡ä»¶å¤¹ä¸‹çš„è‡ªå®šä¹‰ç»„ä»¶ import Count from '../../components/Count' // å¼•å…¥connectç”¨äºè¿æ¥UIç»„ä»¶å’Œredux import { connect } from 'react-redux' // ä½¿ç”¨connect()()åˆ›å»ºå¹¶ä¸”æš´éœ²ä¸€ä¸ªCountå®¹å™¨ç»„ä»¶ export default connect()(Count) äº¦æˆ–è€…åœ¨å¯¼å‡ºUIç»„ä»¶çš„æ—¶å€™ï¼Œç›´æ¥ import { connect } from 'react-redux' export default connect()(ç»„ä»¶å) è¿æ¥storeæ­¤æ—¶æŠŠåŸæ¥å¼•å…¥UIç»„ä»¶æ›¿æ¢æˆå®¹å™¨çš„è‡ªå®šä¹‰ç»„ä»¶ è¿æ¥storeçš„æ–¹å¼ï¼šåœ¨appç»„ä»¶ä½¿ç”¨å®¹å™¨ç»„ä»¶æ—¶ï¼Œé€šè¿‡å®šä¹‰å±æ€§propsæ–¹å¼å¯¹ Count å®¹å™¨ ä¼ å…¥storeï¼ˆä¹‹å‰æ˜¯å¯¼å…¥ storeå ï¼Œé€šè¿‡ store.getState()è·å–æ•°æ®çš„ ï¼‰ import React, { Component } from 'react' //import Count from './components/Count' //ç°åœ¨ä¸éœ€è¦åœ¨app.jsxæ–‡ä»¶é‡Œç›´æ¥å¯¼å…¥UIç»„ä»¶ import Count from './containers/Count' //è€Œæ˜¯éœ€è¦å¯¼å…¥containerç»„ä»¶ import store from './redux/store' export default class App extends Component { render() { return ( &lt;div> &lt;Count store={store} /> &lt;/div> ) } } ä¼˜åŒ– è¿æ¥storeçš„æ–¹å¼ä¸º åœ¨ç»„ä»¶ä¸­ä¼ å…¥storeä½œä¸ºpropså±æ€§&lt;Count store={store}ï¼Œå¦‚æœå¤šä¸ªå®¹å™¨ç»„ä»¶ï¼Œå²‚ä¸æ˜¯è¦ä¸€ä¸ªä¸€ä¸ªä¼ ï¼Ÿä¸ç”¨ï¼Œreact-reduxé‡Œæœ‰ä¸ª Providerç»„ä»¶ï¼Œç”¨ providerç»„ä»¶ å°†å¤–å£³appç»„ä»¶åŒ…è£¹ä½ï¼Œåˆ™åœ¨æ•´ä¸ªåº”ç”¨é‡Œé¢ï¼Œä½†å‡¡éœ€è¦storeçš„å®¹å™¨ç»„ä»¶ï¼Œéƒ½ä¼šä¼ è¿‡å» //æ€»çš„index.jsæ–‡ä»¶ import React from 'react' import ReactDOM from 'react-dom' import App from './App' import { Provider } from 'react-redux' import store from './redux/store' //æ­¤å¤„ä½¿ç”¨Providerï¼Œä½¿å¾—APPçš„æ‰€æœ‰åä»£å®¹å™¨ç»„ä»¶éƒ½èƒ½æ¥æ”¶store ReactDOM.render( &lt;Provider store={store}> &lt;App /> &lt;/Provider>, document.querySelector('#root')); æ­¤æ—¶æˆ‘ä»¬åœ¨uiç»„ä»¶å¯ä»¥ç›´æ¥é€šè¿‡propsæ¥æ”¶ connectçš„ç¬¬ä¸€ä¸ªå‚æ•°å¯ä»¥æ¥æ”¶ä¸€ä¸ªå›è°ƒå‡½æ•°ï¼ˆmapDispatchToPropsï¼‰ï¼Œå›è°ƒå‡½æ•°åˆ™ä¼šä¼ å…¥storeçš„æ•°æ®ä½œä¸ºå‚æ•°ï¼Œåœ¨å›è°ƒå‡½æ•°è¿”å›å€¼ä¸­ï¼Œäº¦å¯ä»¥è‡ªå®šä¹‰ä¸€äº›propsçš„å‚æ•° import { connect } from 'react-redux' function Index(props) { console.log(props.isShow) } export default connect((state) => { return { a: 1, isShow: state.TabbarReducer.show } })(Count) å®¹å™¨å’ŒUIçš„äº¤äº’ç”±äºå®¹å™¨ç»„ä»¶çš„åˆ›å»ºæ¯”è¾ƒä¸èµ°å¯»å¸¸è·¯ï¼Œæ‰€ä»¥å®ƒä¼ é€’ç»™å­ç»„ä»¶ï¼ˆUIç»„ä»¶ï¼‰propsçš„æ–¹å¼ä¹Ÿæœ‰ç‚¹ä¸å¯»å¸¸ åœ¨è¿æ¥UIç»„ä»¶æ—¶ä½¿ç”¨åˆ°çš„connect APIï¼Œå¯ä»¥ä¼ å…¥ä¸¤ä¸ªå‚æ•°ï¼Œå¹¶ä¸”å¾—ä¼ ä¸¤ä¸ªå‡½æ•°ï¼ˆmapStateToPropså‡½æ•°ã€mapDispatchToPropså‡½æ•°ï¼‰ä½œä¸ºå‚æ•° ã€‚ï¼ˆåœ¨ä¸Šæ–¹react-reduxæ¨¡å‹å›¾å¯ä»¥çœ‹åˆ°ç¬¬ä¸€ä¸ªå‚æ•°ä¼ çŠ¶æ€ï¼Œç¬¬äºŒä¸ªå‚æ•°ä¼ æ–¹æ³•ï¼‰ mapStateToPropsï¼ˆå‡½æ•°ï¼‰ 1.mapStateToPropså‡½æ•°çš„è¿”å›å€¼æ˜¯ä¸€ä¸ªå¯¹è±¡2.ä½œä¸ºçŠ¶æ€(key: value ç»„åˆçš„å¯¹è±¡)ä¼ é€’ç»™UIç»„ä»¶3.é€šè¿‡propsä¼ å…¥storeï¼Œä½¿å¾—ç¬¬ä¸€ä¸ªå‚æ•°çš„å‡½æ•°é»˜è®¤ä¼ å…¥storeçš„stateçŠ¶æ€ä½œä¸ºå‚æ•°ï¼ˆstate = store.getState()ï¼‰ mapDispatchToPropsï¼ˆå‡½æ•°ï¼‰ 1.mapDispatchToPropså‡½æ•°çš„è¿”å›å€¼æ˜¯ä¸€ä¸ªå¯¹è±¡2.ä½œä¸ºæ“ä½œçŠ¶æ€çš„æ–¹æ³•ï¼ˆkey: func åŒ…å«å‡½æ•°çš„å¯¹è±¡ï¼‰ä¼ é€’ç»™UIç»„ä»¶3.é€šè¿‡propsä¼ å…¥storeï¼Œä½¿å¾—ç¬¬äºŒä¸ªå‚æ•°çš„å‡½æ•°é»˜è®¤ä¼ å…¥storeçš„dispatchæ–¹æ³•ï¼Œç›´æ¥ä½¿ç”¨dispatchå‘Šè¯‰actionä½ è¦æ‰§è¡Œçš„äº‹ä»¶ //countç»„ä»¶çš„çˆ¶å®¹å™¨çš„indexæ–‡ä»¶ // å¼•å…¥CountUIç»„ä»¶ import CountUI from '../../components/Count' // å¼•å…¥connectç”¨äºè¿æ¥UIç»„ä»¶å’Œredux import { connect } from 'react-redux' // å¼•å…¥reduxä¸­çš„actionæäº¤å¯¹çŠ¶æ€çš„ä¿®æ”¹ import { createIncrementAction, asyncIncrement, createdecrementAction } from '../../redux/count_action' function mapStateToProps(state) { return { count: state } //å‡å¦‚state = 900,ç›¸å½“äºæ­£å¸¸çˆ¶å­ç»„ä»¶ä¼ å€¼ &lt;CountUI count={900}> } function mapDispatchToProps(dispatch) { return { increment: (number) => { dispatch(createIncrementAction(number)) }, decrement: (number) => { dispatch(createdecrementAction(number)) }, asyncIncrement: (number, time) => { dispatch(asyncIncrement(number, time)) } } } export default connect(mapStateToProps, mapDispatchToProps)(CountUI) ç„¶åæˆ‘ä»¬åœ¨å­ç»„ä»¶ï¼ˆUIç»„ä»¶ï¼‰ï¼Œå°±å¯ä»¥ç›´æ¥é€šè¿‡props.xxè·å¾—ä¼ å…¥çš„çŠ¶æ€/ä¿®æ”¹çŠ¶æ€çš„æ–¹æ³•ï¼Œå¯¹å­ç»„ä»¶è¿›è¡Œæ“ä½œä¿®æ”¹ ä¼˜åŒ–ï¼š .å¯¹äºä¸Šè¿°mapDispatchToProps çš„ç²¾ç®€å†™æ³•ï¼š åœ¨å†™mapDispatchToPropséƒ¨åˆ†çš„æ—¶å€™ï¼Œreact-reduxä¼šå¸®ä½ åšä¸€ä¸ªè‡ªå®šåˆ†å‘çš„åŠ¨ä½œï¼ˆè‡ªåŠ¨dispatchï¼‰ ä¹Ÿå°±æ˜¯åˆ¤æ–­å½“å‰æ˜¯å¦ä¸ºactionï¼Œå¦‚æœæ˜¯å°±è‡ªåŠ¨è·‘åˆ†å‘dispatchçš„é€»è¾‘ï¼›å¦‚æœä¸æ˜¯æŒ‰ç…§ä»¥å¾€çš„ä»£ç é€»è¾‘æ‰§è¡Œ export default connect( state => ({count:state}), //åŸæœ¬mapDispatchToPropså‡½æ•°å˜æˆä¸€ä¸ªå¯¹è±¡ï¼ˆkey: actionï¼‰ { increment: createIncrementAction, decrement: createdecrementAction, asyncIncrement: asyncIncrement, } )(CountUI) //uiç»„ä»¶ä¸­ä½¿ç”¨ const { count } = this.props; increment = () => { const value = parseInt(this.selectNumber.value); this.props.increment(value); } æˆ‘ä»¬è‡ªå·±å¯¹æ–‡ä»¶çš„ä¼˜åŒ–ï¼š ç”±äºæ¯ä¸ªUIç»„ä»¶ä¸ºäº†å¯¹æ¥reduxå­˜å‚¨çš„çŠ¶æ€ï¼Œéƒ½ä¼šå¤šä¸€ä¸ªå®¹å™¨ç»„ä»¶ï¼Œå¯¼è‡´æ–‡ä»¶é‡æˆå€å¢é•¿ã€‚ æ‰€ä»¥æˆ‘ä»¬å¯ä»¥è‡ªå·±æŠŠå®¹å™¨ç»„ä»¶å’ŒUIç»„ä»¶å†™åœ¨åŒä¸€ä¸ªjsxæ–‡ä»¶é‡Œï¼Œå¯¹å¤–æš´éœ²å®¹å™¨ç»„ä»¶ react-reduxåŸç†connectæ˜¯HOCï¼Œé«˜é˜¶ç»„ä»¶ Providerç»„ä»¶ï¼Œå¯ä»¥è®©å®¹å™¨ç»„ä»¶æ‹¿åˆ°stateï¼Œä½¿ç”¨äº†context å°react-readuxçš„connect function myConnect(mapStateToProps, mapDispatchToProps) { return (myComponent) => { return (props) => { return &lt;div> &lt;myComponent {...mapStateToProps} {...props} {...mapDispatchToProps}>&lt;/myComponent> &lt;/div> } } } 10.å…¶ä»–Redux DevToolsè¿™é‡Œé¡ºä¾¿æ¨èä¸€ä¸‹reduxçš„ç›¸å…³å¼€å‘è€…å·¥å…·ï¼šRedux DevToolsï¼ˆè¿™ä¸ªå·¥å…·å¾ˆé¡¶é˜¿ï¼ï¼‰ï¼ˆReactçš„å¼€å‘è€…å·¥å…·React Developer Toolsä¹Ÿæ¨èå®‰è£…ï¼‰ï¼Œåœ¨è°·æ­Œå•†åº—æ·»åŠ æ‹“å±•æ’ä»¶å³å¯ ä½†æ˜¯ä½¿ç”¨è¿™ä¸ªå·¥å…·è¿˜å¾—å®‰è£…æ‹“å±•åº“ npm i redux-devtools-extension åˆ«å¿˜äº†è¿˜è¦å†store.jsæ–‡ä»¶ä¸­å¯¼å…¥ + ä½¿ç”¨ å¯ä»¥åœ¨å®˜ç½‘æŸ¥çœ‹https://github.com/zalmoxisus/redux-devtools-extension å…³äºreact-reduxæ•°æ®æŒä¹…åŒ–ï¼Œå¯ä»¥ä½¿ç”¨redux-persisthttps://github.com/rt2zz/redux-persist immutableé™¤æ­¤ä¹‹å¤–ï¼Œæˆ‘åœ¨ã€ŠJavaScriptè¿›é˜¶ES5ã€‹ä¸­è¿˜æåŠåˆ°å…³äºå¾ˆé€‚ç”¨äºreducerçº¯å‡½æ•°ç³»åˆ—çš„jsåº“ immutable.jsï¼Œå®ƒçš„å®ç°åŸç†æ˜¯persistent data structureï¼ˆæŒä¹…åŒ–æ•°æ®ç»“æ„ï¼‰ï¼Œä¹Ÿå°±æ˜¯ä½¿ç”¨æ—§æ•°æ®åˆ›å»ºæ–°æ•°æ®æ—¶ï¼Œä¿è¯æ—§æ•°æ®åŒæ—¶å¯ç”¨ä¸”ä¸å˜ï¼ŒåŒæ—¶é¿å…äº†deepcopyæŠŠæ‰€æœ‰çš„èŠ‚ç‚¹éƒ½å¤åˆ¶ä¸€éå¸¦æ¥çš„æ€§èƒ½æŸè€—ï¼Œimmutableä½¿ç”¨äº†structural sharingï¼ˆç»“æ„å…±äº«ï¼‰ï¼Œå³å¦‚æœå¯¹è±¡æ ‘ä¸­ä¸€ä¸ªèŠ‚ç‚¹å‘ç”Ÿå˜åŒ–ï¼Œåªä¿®æ”¹è¿™ä¸ªèŠ‚ç‚¹å’Œå—ä»–å½±å“çš„çˆ¶èŠ‚ç‚¹ï¼Œåˆ™å…¶ä»–èŠ‚ç‚¹è¿›è¡Œå…±äº« å…·ä½“ä½¿ç”¨ npm i immutable immutableå¯¹æ•°ç»„åçˆ±ï¼Œå¯ä»¥ç›´æ¥è®©Listå½“æ•°ç»„æ¥ä½¿ç”¨ï¼Œä¸€èˆ¬éƒ½å¯ä»¥è°ƒç”¨æ•°ç»„ä¸Šçš„æ‰€æœ‰æ–¹æ³•ï¼ŒåŒ…æ‹¬mapã€filterã€shiftä¹‹ç±»çš„ import { Map, List } from 'immutable' const obj = { name: \"allen\", age: 18 } const arr = [] const oldImmuObj = Map(obj) //è½¬åŒ–ä¸ºä¸€ä¸ªä¸å¯å˜å¯¹è±¡ const oldImmuArr = List(arr) //è½¬åŒ–ä¸ºä¸€ä¸ªä¸å¯å˜å¯¹è±¡ï¼Œæ•°ç»„ç”¨Listï¼Œå¯¹è±¡ç”¨Map const newImmuObj = oldImmuObj.set(\"name\", \"Mikasa\")//æ­¤æ—¶æ–°å€¼çš„æ”¹åŠ¨ä¸ä¼šå½±å“åˆ°è€çš„å€¼ const newImmuArr = oldImmuArr.push(1)//æ•°ç»„ç›´æ¥æ”¹å°±å¥½äº† åœ¨ immutableè¿™ç§ä¸å¯å˜å¯¹è±¡ä¸­ï¼Œè·å–å±æ€§å€¼å¯ä»¥ä½¿ç”¨ getæ–¹æ³•ç›´æ¥è·å– oldImmuObj.get(&quot;name&quot;) ä¸å¯å˜å¯¹è±¡å†è½¬æ¢å›æ™®é€šå¯¹è±¡ oldImmuObj.toJS() æ•°ç»„ä¸å¯å˜å¯¹è±¡è½¬æ¢å›æ•°ç»„ oldImmuArr.toJS() å¦‚æœæ•°æ®ç±»å‹æ›´åŠ å¤æ‚äº†ï¼Œè¿˜å¾—å¾€é‡Œé¢ç»§ç»­åŒ…è£¹ï¼Œæ‰èƒ½æ‰“é€ æˆé‚£ç§æ‹·è´åä»å…±äº«çš„ç»“æ„ import { Map } from 'immutable' const a = Map({ name: \"allen\", hobbies:Map({ name: 'killing' }) }) æ—¢ç„¶å¦‚æ­¤ï¼Œæ¯ä¸€æ¬¡å¤æ‚æ•°æ®ç±»å‹éƒ½è¦åŒ…è£¹ä¸€æ¬¡è¿™ä¹ˆéº»çƒ¦å¹²å˜›è¿˜è¦ç”¨å®ƒï¼Ÿæœ‰ä»€ä¹ˆæ„ä¹‰ï¼Ÿ æ¯”å¦‚ä¸Šæ–¹çš„nameç»™ç»„ä»¶Aä½¿ç”¨ï¼Œå¦‚æœnameå‘ç”Ÿæ”¹å˜ï¼ŒshouldComponentUpdateåº”è¯¥è¿”å›trueï¼›è€Œhobbiesç»™ç»„ä»¶Bç”¨ï¼Œé€šè¿‡è‡ªå·±å†™ä»£ç ï¼ˆç”¨ifè¯­å¥ï¼‰åˆ¤æ–­æ— å˜åŒ–ï¼Œè®©shouldComponentUpdateè¿”å›falseï¼Œé¿å…äº†diffé‡å¤å¯¹æ¯”ï¼ˆä¸è¿‡æˆ‘ä¸ªäººæ„Ÿè§‰è¿™æœ‰ç‚¹å¤ªå¿’éº»çƒ¦ã€‚ã€‚ã€‚ï¼‰ é™¤äº†æ¯ä¸€æ¬¡å¯¹å¤æ‚æ•°æ®ç±»å‹ä½¿ç”¨ Mapã€ListåŒ…è£¹ï¼Œè¿˜èƒ½ä½¿ç”¨fromJSï¼Œç›´æ¥æ·±åº¦éå†ï¼Œä¸€æ¬¡æ€§è½¬æ¢å¥½ å®ƒçš„æ•ˆæœå’Œä½¿ç”¨Mapã€Listä¸€å±‚ä¸€å±‚åŒ…è£¹æ˜¯ä¸€æ ·çš„ import { fromJS } from 'immutable' const a = fromJS({ name: \"allen\", hobbies:{ name: 'killing' } }) ä¿®æ”¹æ·±å±‚å±æ€§å€¼çš„æ—¶å€™ä½¿ç”¨ setIn æ–¹æ³• a.setIn([\"hobbies\", \"name\"], 'swimming') ä¿®æ”¹æ•°ç»„çš„è¯æ˜¯è¿™æ · arr.updateIn([\"favor\"], (list) => list.splice(index, 1)) æ­¤æ—¶å†ç»“åˆreducerï¼Œè¿™æ ·çš„è¯react UIéƒ¨åˆ†å°±ä¸ç”¨ä¿®æ”¹äº† export default function Reducer(preState = { name: \"allen\", hobbies:{ name: 'killing' } }, action) { const { type, data } = action; const newState = fromJS(preState) switch (type) { case \"changeHobbies\": return newState.setIn([\"hobbies\", \"name\"], 'swimming').toJS() default: return preState; } }","categories":[{"name":"å‰ç«¯","slug":"å‰ç«¯","permalink":"https://taylor12138.github.io/categories/%E5%89%8D%E7%AB%AF/"}],"tags":[],"author":"Hello"},{"title":"Vue(ä¸‹)","slug":"Vue(ä¸‹)","date":"2021-03-21T16:00:00.000Z","updated":"2022-08-14T06:56:22.184Z","comments":true,"path":"2021/03/22/vue-xia/","link":"","permalink":"https://taylor12138.github.io/2021/03/22/vue-xia/","excerpt":"","text":"7.å…¶ä»–äº‹ä»¶æ€»çº¿äº‹ä»¶æ€»çº¿å’Œvuexçš„ä½œç”¨å¾ˆåƒï¼Œåªä¸è¿‡vuexç”¨äºç®¡ç†çŠ¶æ€ï¼ˆå˜é‡ï¼‰ï¼Œè€Œäº‹ä»¶æ€»çº¿ç”¨äºç®¡ç†äº‹ä»¶ï¼Œåˆ©ç”¨äº‹ä»¶ä¼ å‚ï¼ˆæ„Ÿè§‰vuexæœ‰ç‚¹é¢å‘å—æ§ç»„ä»¶ï¼Œè€Œeventbusé¢å‘éå—æ§ç»„ä»¶ï¼‰ 1.åœ¨main.js æ–‡ä»¶ä¸­ åˆ›å»ºä¸€ä¸ªæ–°çš„Vueå®ä¾‹ï¼Œä»¥å¾—åˆ°ä¸€ä¸ªbus Vue.prototype.$bus = new Vue(); 2.å‘å°„ this.$bus.$emit(&#39;äº‹ä»¶å&#39;[, å‚æ•°]) 3.æ¥å— this.$bus.$on(&quot;äº‹ä»¶å&quot;, å›è°ƒå‡½æ•°(å‚æ•°)) 4.å¯ä»¥åœ¨deactivatedé‡Œè®¾ç½®ç¦»å¼€æ—¶ä¸æ¥å—è¯¥äº‹ä»¶çš„ä¼ é€’ï¼ˆå–æ¶ˆå…¨å±€äº‹ä»¶ç›‘å¬ï¼‰ï¼šthis.$bus.$off(&quot;äº‹ä»¶å&quot;, æ¥æ”¶æ—¶çš„å›è°ƒå‡½æ•°(å‚æ•°));ï¼Œå›è°ƒå‡½æ•°è¦å’Œæ¥æ”¶æ—¶å‘ç”Ÿçš„å›è°ƒå‡½æ•°ä¿æŒä¸€è‡´ provide / injectå¯ä»¥ç†è§£ä¸ºç¥–çˆ¶ä¸å­™å­ç»„ä»¶ä»¬çš„é€šä¿¡æ–¹æ³• è¿™å¯¹é€‰é¡¹éœ€è¦ä¸€èµ·ä½¿ç”¨ï¼Œä»¥å…è®¸ä¸€ä¸ªç¥–å…ˆç»„ä»¶å‘å…¶æ‰€æœ‰å­å­™åä»£æ³¨å…¥ä¸€ä¸ªä¾èµ–ï¼Œä¸è®ºç»„ä»¶å±‚æ¬¡æœ‰å¤šæ·±ï¼Œå¹¶åœ¨å…¶ä¸Šä¸‹æ¸¸å…³ç³»æˆç«‹çš„æ—¶é—´é‡Œå§‹ç»ˆç”Ÿæ•ˆã€‚å¦‚æœä½ ç†Ÿæ‚‰ Reactï¼Œè¿™ä¸ React çš„ä¸Šä¸‹æ–‡ï¼ˆContextï¼‰ç‰¹æ€§å¾ˆç›¸ä¼¼ã€‚ provide é€‰é¡¹ï¼ˆoptionï¼‰åº”è¯¥æ˜¯ä¸€ä¸ªå¯¹è±¡æˆ–è¿”å›ä¸€ä¸ªå¯¹è±¡çš„å‡½æ•°ã€‚è¯¥å¯¹è±¡åŒ…å«å¯æ³¨å…¥å…¶å­å­™çš„ propertyã€‚åœ¨è¯¥å¯¹è±¡ä¸­ä½ å¯ä»¥ä½¿ç”¨ ES2015 Symbols ä½œä¸º keyï¼Œä½†æ˜¯åªåœ¨åŸç”Ÿæ”¯æŒ Symbol å’Œ Reflect.ownKeys çš„ç¯å¢ƒä¸‹å¯å·¥ä½œã€‚ inject é€‰é¡¹ï¼ˆoptionï¼‰åº”è¯¥æ˜¯ï¼š ä¸€ä¸ªå­—ç¬¦ä¸²æ•°ç»„ï¼Œæˆ– ä¸€ä¸ªå¯¹è±¡ï¼Œå¯¹è±¡çš„ key æ˜¯æœ¬åœ°çš„ç»‘å®šåï¼Œvalue æ˜¯ï¼š åœ¨å¯ç”¨çš„æ³¨å…¥å†…å®¹ä¸­æœç´¢ç”¨çš„ key (å­—ç¬¦ä¸²æˆ– Symbol)ï¼Œæˆ– ä¸€ä¸ªå¯¹è±¡ï¼Œè¯¥å¯¹è±¡çš„ï¼š from property æ˜¯åœ¨å¯ç”¨çš„æ³¨å…¥å†…å®¹ä¸­æœç´¢ç”¨çš„ key (å­—ç¬¦ä¸²æˆ– Symbol) default property æ˜¯é™çº§æƒ…å†µä¸‹ä½¿ç”¨çš„ value æç¤ºï¼šprovide å’Œ inject ç»‘å®šå¹¶ä¸æ˜¯å¯å“åº”çš„ã€‚è¿™æ˜¯åˆ»æ„ä¸ºä¹‹çš„ã€‚ç„¶è€Œï¼Œå¦‚æœä½ ä¼ å…¥äº†ä¸€ä¸ªå¯ç›‘å¬çš„å¯¹è±¡ï¼Œé‚£ä¹ˆå…¶å¯¹è±¡çš„ property è¿˜æ˜¯å¯å“åº”çš„ã€‚ // çˆ¶çº§ç»„ä»¶æä¾› 'foo' var Provider = { provide: { foo: 'bar' }, //ä¹Ÿæ”¯æŒå†™æˆä¸€ä¸ªå‡½æ•°ï¼Œæ­¤æ—¶æ‰å¯ä»¥ä½¿ç”¨thisï¼šprovide(){ return { foo: 'bar' } } } // å­ç»„ä»¶æ³¨å…¥ 'foo' var Child = { inject: ['foo'], created () { console.log(this.foo) // => \"bar\" } // ... } æ—¢ç„¶ä¸æ˜¯å“åº”å¼çš„ï¼Œé‚£å¦‚æœç”¨åˆ°éœ€è¦å“åº”å¼æ€ä¹ˆåŠï¼Ÿï¼ï¼ å¸¸è§„åšæ³• var Provider = { data(){ return { foo: 'bar' } }, provide: { fooProvide: this.fooFn // ä¼ é€’ä¸€ä¸ªå¼•ç”¨ç±»å‹å‡½æ•°è¿‡å» }, methods:{ fooFn() { return this.foo } } } å…¶ä»–åšæ³•ï¼š é…åˆä¸Šè®¡ç®—å±æ€§computed var Provider = { provide() { return { length: computed(() => this.names.length).value; //computedè¿”å›çš„æ˜¯ä¸€ä¸ªrefå¯¹è±¡ï¼Œå¦‚æœæ‹¿åˆ°å€¼å¿…é¡»å¾—.value } } } mixinï¼ˆæ··å…¥ï¼‰Vueä¸­ç›¸åŒé€»è¾‘çš„ä»£ç å¦‚ä½•æŠ½ç¦»ï¼Ÿ ä¸ºäº†å‡å°‘ä¸¤ä¸ªå¯¹è±¡ä¹‹é—´é‡å¤çš„ä»£ç ï¼ŒVueå®˜æ–¹æä¾›äº† minxinï¼ˆè¾ƒå°‘ç±»é‡å¤çš„ä»£ç å¯ä»¥ç”¨es6çš„ç»§æ‰¿ï¼‰ å…¨å±€æ··å…¥ mixin ç”¨äºå…¨å±€æ··å…¥ï¼Œä¼šå½±å“åˆ°æ¯ä¸ªç»„ä»¶å®ä¾‹ï¼Œé€šå¸¸æ’ä»¶éƒ½æ˜¯è¿™æ ·åšåˆå§‹åŒ–çš„ã€‚ Vue.mixin({ beforeCreate() { // ...é€»è¾‘ // è¿™ç§æ–¹å¼ä¼šå½±å“åˆ°æ¯ä¸ªç»„ä»¶çš„ beforeCreate é’©å­å‡½æ•° } }) æ‹“å±•ç»„ä»¶çš„å±€éƒ¨æ··å…¥ var mixin = { created: function () { console.log(1) } } var vm = new Vue({ created: function () { console.log(2) }, mixins: [mixin] }) // => 1 // => 2 mixinåˆå¹¶è§„åˆ™ï¼š æ¯”å¦‚Mixinå¯¹è±¡ä¸­é€‰é¡¹å’Œç»„ä»¶å¯¹è±¡ä¸­çš„é€‰é¡¹å‘ç”Ÿå†²çªæ—¶ å¦‚æœæ˜¯dataï¼Œåˆ™é€‰æ‹©ç»„ä»¶å¯¹è±¡ä¸­çš„é€‰é¡¹ å¦‚æœæ˜¯ç”Ÿå‘½å‘¨æœŸï¼Œåˆ™ä¼šæŠŠä¸¤è€…ï¼ˆç”Ÿå‘½å‘¨æœŸå‡½æ•°ï¼‰éƒ½æ”¾åœ¨ä¸€ä¸ªæ•°ç»„é‡Œï¼Œç­‰åˆ°åˆé€‚çš„ç”Ÿå‘½å‘¨æœŸæ‹¿å‡ºæ¥ï¼Œéƒ½è°ƒç”¨ï¼ˆéƒ½ä¼šæ‰§è¡Œï¼‰ å¦‚æœæ˜¯å¯¹è±¡ç±»å‹ï¼ˆæ¯”å¦‚methodsã€componentsã€watchç­‰ï¼‰ï¼Œå°†è¢«åˆå¹¶æˆä¸€ä¸ªå¯¹è±¡ å¦‚æœå¯¹è±¡çš„keyç›¸åŒï¼Œåˆ™ä¼šé€‰æ‹©ç»„ä»¶å¯¹è±¡çš„é”®å€¼å¯¹ ï¼ˆç†è®ºä¸Šåˆå¹¶ï¼Œéƒ½ä¼šæ‰§è¡Œï¼Œå®é™…ä¸Šæœ‰å†²çªè¿˜æ˜¯é€‰æ‹©ç»„ä»¶å¯¹è±¡ï¼‰ Vueæ’ä»¶æœºåˆ¶æ’ä»¶é€šå¸¸ç”¨æ¥ä¸º Vue æ·»åŠ å…¨å±€åŠŸèƒ½ã€‚æ’ä»¶çš„åŠŸèƒ½èŒƒå›´æ²¡æœ‰ä¸¥æ ¼çš„é™åˆ¶ï¼Œä¸€èˆ¬æœ‰ä¸‹é¢å‡ ç§ï¼š æ·»åŠ å…¨å±€æ–¹æ³•æˆ–è€… propertyã€‚å¦‚ï¼švue-custom-element æ·»åŠ å…¨å±€èµ„æºï¼šæŒ‡ä»¤/è¿‡æ»¤å™¨/è¿‡æ¸¡ç­‰ã€‚å¦‚ vue-touch é€šè¿‡å…¨å±€æ··å…¥æ¥æ·»åŠ ä¸€äº›ç»„ä»¶é€‰é¡¹ã€‚å¦‚ vue-router æ·»åŠ  Vue å®ä¾‹æ–¹æ³•ï¼Œé€šè¿‡æŠŠå®ƒä»¬æ·»åŠ åˆ° Vue.prototype ä¸Šå®ç°ã€‚ ä¸€ä¸ªåº“ï¼Œæä¾›è‡ªå·±çš„ APIï¼ŒåŒæ—¶æä¾›ä¸Šé¢æåˆ°çš„ä¸€ä¸ªæˆ–å¤šä¸ªåŠŸèƒ½ã€‚å¦‚ vue-router è€Œä½¿ç”¨æ’ä»¶çš„æ“ä½œï¼Œéœ€è¦ä½ åœ¨è°ƒç”¨ new Vueä¹‹å‰å®ç° // è°ƒç”¨ `MyPlugin.install(Vue)` Vue.use(MyPlugin) new Vue({ // ...ç»„ä»¶é€‰é¡¹ }) Vue.use ä¼šè‡ªåŠ¨é˜»æ­¢å¤šæ¬¡æ³¨å†Œç›¸åŒæ’ä»¶ï¼Œå±Šæ—¶å³ä½¿å¤šæ¬¡è°ƒç”¨ä¹Ÿåªä¼šæ³¨å†Œä¸€æ¬¡è¯¥æ’ä»¶ã€‚ è€Œåœ¨useçš„æ—¶å€™ï¼ˆå®‰è£…æ’ä»¶çš„æ—¶å€™ï¼‰ï¼Œä¼šè°ƒç”¨installæ–¹æ³•å’Œvueæ··å…¥æœºåˆ¶ export function install (_Vue) { if (Vue &amp;&amp; _Vue === Vue) { if (process.env.NODE_ENV !== 'production') { console.error( '[vuex] already installed. Vue.use(Vuex) should be called only once.' ) } return } Vue = _Vue applyMixin(Vue) } åœ¨beforeCreateé’©å­å‡½æ•°å‰è¿›è¡Œæ··å…¥vuexInitï¼ˆmixinï¼‰ // æ··å…¥æœºåˆ¶ Vue.mixin({ beforeCreate: vuexInit }); function vuexInit () { const options = this.$options // store injection if (options.store) { this.$store = typeof options.store === 'function' ? options.store() : options.store } else if (options.parent &amp;&amp; options.parent.$store) { this.$store = options.parent.$store } } è‡ªå®šä¹‰æ’ä»¶æ­£å¸¸æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬éƒ½å¯ä»¥ä½¿ç”¨ç»„ä»¶å®Œæˆå¯¹åº”çš„æ¨¡å—åŠŸèƒ½ï¼Œä½¿ç”¨ç»„ä»¶éœ€è¦ 1.åœ¨æ¨¡æ¿ä¸­å¼•ç”¨ 2.å¼•å…¥æ¨¡å— 3.ç»„ä»¶çš„componentsä¸­å£°æ˜ ä½†æ˜¯å¦‚æœæƒ³è¦åœ¨è¯¥ç»„ä»¶å®Œæˆå›ºå®šåŠŸèƒ½ï¼Œå¯èƒ½è¿˜éœ€è¦ 4.å£°æ˜å¯¹åº”çš„data 5.å†™å…¥å¯¹åº”çš„æ–¹æ³• 6.ç»„ä»¶ä¹‹é—´ä¼ é€’å˜é‡ 4ã€5ã€6æ­¥éª¤å¦‚æœæ”¾åœ¨ä¸åŒçš„ç»„ä»¶ä½¿ç”¨ä¸€æ ·çš„åŠŸèƒ½ï¼Œå¯èƒ½è¦å£°æ˜å¾ˆå¤šæ¬¡ï¼Œè¿™æ—¶æˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ’ä»¶æ¥ç®€åŒ–ï¼ˆé™ä½è€¦åˆï¼‰æ“ä½œ ä¸‹é¢ä»¥åˆ¶ä½œ Toast è‡ªå®šä¹‰æ’ä»¶ä¸ºä¾‹å­ï¼ˆå†’æ³¡æç¤ºæ’ä»¶ï¼‰ å…ˆå»ºç«‹toastç»„ä»¶ &lt;template> &lt;div class=\"toast\" v-show=\"isShow\"> {{ message }} &lt;/div> &lt;/template> &lt;script> export default { name: \"Toast\", data() { return { message: \"\", isShow: false, }; }, methods: { //durationæ—¶é—´é—´éš”é»˜è®¤2s showMessage(message, duration = 2000) { this.message = message; this.isShow = true; setTimeout(() => { this.isShow = false; this.message = \"\"; }, duration); }, }, }; &lt;/script> &lt;style scoped> &lt;/style> åœ¨toastç»„ä»¶çš„æ–‡ä»¶å¤¹ä¸‹ï¼Œæ–°å»ºindex.jsæ–‡ä»¶ //å¼•å…¥toastç»„ä»¶ import Toast from \"./Toast\"; const obj = {}; // å¯ä»¥é€‰æ‹©ä¼ è¿›æ¥ä¸€ä¸ªVueï¼Œå¯¹Vueå¯¹è±¡è¿›è¡Œæ“ä½œ obj.install = function (Vue) { // 1.åˆ›å»ºç»„ä»¶æ„é€ å™¨ï¼ˆåœ¨vueå¤–é¢ä½¿ç”¨ç»„ä»¶å°±è¦ç”¨åˆ°ç»„ä»¶æ„é€ å™¨ï¼‰ const toastConstructor = Vue.extend(Toast); // 2.ä½¿ç”¨newçš„æ–¹å¼åˆ›å»ºç»„ä»¶å¯¹è±¡ const toast = new toastConstructor(); // 3.å°†ç»„ä»¶å¯¹è±¡æŒ‚è½½åˆ°æŸå…ƒç´ ä¸Š,å’Œç»„ä»¶ä½¿ç”¨ä¹Ÿä¸€æ ·ï¼Œå†…éƒ¨ä¹Ÿè°ƒç”¨äº†$mount()è¿›è¡ŒæŒ‚è½½ toast.$mount(document.createElement('div')); // 4.toast.$el å¯¹åº”çš„å°±æ˜¯ div document.body.appendChild(toast.$el); // 5.è®¾ç½®prototypeä¹‹åï¼Œä»¥åè°ƒç”¨æ’ä»¶æ–¹æ³•åªéœ€è¦$toastå³å¯ Vue.prototype.$toast = toast; } export default obj åœ¨å…¨å±€çš„main.jsä¸­ä½¿ç”¨è¯¥æ’ä»¶ import toast from \"@/components/common/toast\" Vue.use(toast); è¿™æ—¶æˆ‘ä»¬å°±å¯ä»¥å†å„ä¸ªç»„ä»¶ä¸­ç›´æ¥ä½¿ç”¨è¯¥æ’ä»¶äº†ï¼ˆæ­¤æ—¶åªéœ€è¦æ‰§è¡Œä»¥ä¸‹ä»£ç ï¼Œå³å¯å‡ºç°å†’æ³¡æç¤ºï¼‰ this.$toast.showMessage(\"ä½ æƒ³è¦è¾“å…¥çš„ä¿¡æ¯\", 2000); //2000ä¸ºè‡ªå®šä¹‰çš„æ—¶é—´é—´éš” Vue.nextTick[Vue.nextTick( [callback, context] )] Vueä¸­DOMæ›´æ–°æ˜¯å¼‚æ­¥çš„ï¼Œè€ŒnextTickåœ¨ä¸‹æ¬¡ DOM æ›´æ–°å¾ªç¯ç»“æŸä¹‹åæ‰§è¡Œå»¶è¿Ÿå›è°ƒã€‚åœ¨ä¿®æ”¹æ•°æ®ä¹‹åç«‹å³ä½¿ç”¨è¿™ä¸ªæ–¹æ³•ï¼Œè·å–æ›´æ–°åçš„ DOMã€‚ // ä¿®æ”¹æ•°æ® vm.msg = 'Hello' // DOM è¿˜æ²¡æœ‰æ›´æ–° Vue.nextTick(function () { // DOM æ›´æ–°äº† }) // ä½œä¸ºä¸€ä¸ª Promise ä½¿ç”¨ï¼Œå¦‚æœæ²¡æœ‰æä¾›å›è°ƒä¸”åœ¨æ”¯æŒ Promise çš„ç¯å¢ƒä¸­ï¼Œåˆ™è¿”å›ä¸€ä¸ª Promise Vue.nextTick() .then(function () { // DOM æ›´æ–°äº† }) ä¸»è¦åº”ç”¨ï¼šéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨ created å’Œ mounted é˜¶æ®µï¼Œå¦‚æœéœ€è¦æ“ä½œæ¸²æŸ“åçš„è§†å›¾ï¼Œä¹Ÿè¦ä½¿ç”¨ nextTick æ–¹æ³•ã€‚ å®˜æ–¹æ–‡æ¡£è¯´æ˜ï¼š æ³¨æ„ mounted ä¸ä¼šæ‰¿è¯ºæ‰€æœ‰çš„å­ç»„ä»¶ä¹Ÿéƒ½ä¸€èµ·è¢«æŒ‚è½½ã€‚å¦‚æœä½ å¸Œæœ›ç­‰åˆ°æ•´ä¸ªè§†å›¾éƒ½æ¸²æŸ“å®Œæ¯•ï¼Œå¯ä»¥ç”¨ vm.$nextTick æ›¿æ¢æ‰ mounted vueå›¾ç‰‡æ‡’åŠ è½½å¯ä»¥ä½¿ç”¨vue-lazyloadæ’ä»¶ $ npm i vue-lazyload -S ï¼ˆåœ¨main.jsé‡Œï¼‰å¼•ç”¨æ—¶å¯ä»¥ä¼ é€’ä¸€äº›æƒ³è¦çš„å‚æ•°ï¼Œæ¯”å¦‚åŠ è½½å‰çš„å›¾ç‰‡æ˜¾ç¤ºç­‰ import VueLazyload from 'vue-lazyload' Vue.use(VueLazyload) Vue.use(VueLazyload, { preLoad: 1.3, error: errorimage, loading: loadimage, attempt: 1 }) å®‰è£…å’Œå¼•ç”¨ä¹‹åï¼Œå°†åŸæ¥çš„ &lt;img :src=&quot;img.src&quot; &gt; â€“&gt; &lt;img v-lazy=&quot;img.src&quot; &gt;å³å¯ Vueå’ŒReactç›¸åŒä¹‹å¤„ï¼š Reactä¸Vueå­˜åœ¨å¾ˆå¤šç›¸ä¼¼ä¹‹å¤„ï¼Œä¾‹å¦‚ä»–ä»¬éƒ½æ˜¯JavaScriptçš„UIæ¡†æ¶ï¼Œä¸“æ³¨äºåˆ›é€ å‰ç«¯çš„å¯Œåº”ç”¨ã€‚ä¸åŒäºæ—©æœŸçš„JavaScriptæ¡†æ¶â€œåŠŸèƒ½é½å…¨â€ï¼ŒReatä¸Vueåªæœ‰æ¡†æ¶çš„éª¨æ¶ï¼Œå…¶ä»–çš„åŠŸèƒ½å¦‚è·¯ç”±ã€çŠ¶æ€ç®¡ç†ç­‰æ˜¯æ¡†æ¶åˆ†ç¦»çš„ç»„ä»¶ã€‚ Vue.js(2.0ç‰ˆæœ¬)ä¸Reactçš„å…¶ä¸­æœ€å¤§ä¸€ä¸ªç›¸ä¼¼ä¹‹å¤„ï¼Œå°±æ˜¯ä»–ä»¬éƒ½ä½¿ç”¨äº†â€™Virtual DOMâ€™ï¼ˆè™šæ‹ŸDOMï¼‰ï¼Œå¦‚æœéœ€è¦æ”¹å˜ä»»ä½•å…ƒç´ çš„çŠ¶æ€ï¼Œé‚£ä¹ˆæ˜¯å…ˆåœ¨Virtual DOMä¸Šè¿›è¡Œæ”¹å˜ï¼Œè€Œä¸æ˜¯ç›´æ¥æ”¹å˜çœŸå®çš„DOMï¼Œè¿™æ ·å¯ä»¥å‡å°‘å¼€é”€ï¼›å½“æœ‰å˜åŒ–äº§ç”Ÿæ—¶ï¼Œä¸€ä¸ªæ–°çš„Virtual DOMå¯¹è±¡ä¼šè¢«åˆ›å»ºå¹¶è®¡ç®—æ–°æ—§Virtual DOMä¹‹é—´çš„å·®åˆ«ã€‚ä¹‹åè¿™äº›å·®åˆ«ä¼šåº”ç”¨åœ¨çœŸå®çš„DOMä¸Šã€‚ ä¸åŒä¹‹å¤„ï¼š Reactä¸Vueæœ€å¤§çš„ä¸åŒæ˜¯æ¨¡æ¿çš„ç¼–å†™ã€‚Vueé¼“åŠ±ä½ å»å†™è¿‘ä¼¼å¸¸è§„HTMLçš„æ¨¡æ¿ï¼ˆtemplateï¼‰ï¼Œå†™èµ·æ¥å¾ˆæ¥è¿‘æ ‡å‡†HTMLå…ƒç´ ï¼Œåªæ˜¯å¤šäº†ä¸€äº›å±æ€§ï¼Œç„¶åç”¨ç±»ä¼¼äºAngularé£æ ¼çš„æ–¹æ³•å»åŠ¨æ€è¾“å‡ºå†…å®¹ï¼›è€ŒReactæ¨èä½ ä½¿ç”¨ JSX æ¥å†™æ¨¡æ¿ï¼ŒJSXåªæ˜¯JavaScriptæ··åˆç€XMLè¯­æ³•ï¼Œæœ‰éƒ¨åˆ†äººä½¿ç”¨èµ·æ¥ä¼šè§‰å¾—å¾ˆç•…å¿«ã€‚å€¼å¾—ä¸€æçš„æ˜¯ï¼Œä¸Reactä¸€æ ·ï¼ŒVueåœ¨æŠ€æœ¯ä¸Šä¹Ÿæ”¯æŒrenderå‡½æ•°å’ŒJSXï¼Œä½†åªæ˜¯ä¸æ˜¯é»˜è®¤çš„è€Œå·² åœ¨Vueä¸­ï¼Œstateå¯¹è±¡å¹¶ä¸æ˜¯å¿…é¡»çš„ï¼Œæ•°æ®ç”±dataå±æ€§åœ¨Vueå¯¹è±¡ä¸­è¿›è¡Œç®¡ç†ï¼Œè€ŒVueæä¾›å“åº”å¼çš„æ•°æ®ï¼Œå½“æ•°æ®æ”¹åŠ¨æ—¶ï¼Œç•Œé¢å°±ä¼šè‡ªåŠ¨æ›´æ–°ï¼›Reactçš„æ•°æ®ä½¿ç”¨stateå¯¹è±¡ï¼ˆçŠ¶æ€ï¼‰ä¿å­˜ï¼Œåœ¨Reactä¸­ä½ éœ€è¦ä½¿ç”¨setState()æ–¹æ³•å»æ›´æ–°çŠ¶æ€ ï¼ˆæˆ‘åœ¨è§‚çœ‹è§†é¢‘è€å¸ˆå¯¹æ¯”React and Vueçš„æ—¶å€™çœ‹åˆ°çš„ç»“æœï¼ˆè™šæ‹ŸDOMä¸DOM Diff çš„åŸç†ï¼Œä½œè€…é¥¥äººè°·ï¼Œç¬¬äºŒé›†ï¼‰ï¼‰åœ¨æµ‹è¯•æ’å…¥10wä¸ªdivæ ‡ç­¾çš„æ—¶å€™ï¼ŒDOMçš„åŸç”Ÿæ¸²æŸ“é€Ÿåº¦æ˜¯å¤§æ¦‚2sï¼›Reactçš„é€Ÿåº¦å¤§æ¦‚æ¥è¿‘30sï¼›Vueç«Ÿç„¶æ˜¯æ¥è¿‘åŸç”ŸDOMï¼Œ1s-3s è‡ªæˆ‘å­¦ä¹ æ„Ÿå—ï¼ŒReactå¾ˆå¤šæ“ä½œè¦æ¯”Vueéº»çƒ¦ï¼ˆå¯èƒ½ä¹Ÿæ˜¯å› ä¸ºä¸ç†Ÿç»ƒï¼‰ï¼Œå­¦ä¹ Reactæœ‰æ‰å®çš„JSåŸºç¡€è¦æ±‚ åŸç”Ÿå’Œæ¡†æ¶è¯¦æƒ…å¯ä»¥è§å°¤å¤§å¤§çš„ç­”æ¡ˆhttps://www.zhihu.com/question/31809713/answer/53544875 Vueå¸¸è§æ€§èƒ½ä¼˜åŒ– ä¸è¦æŠŠæ‰€æœ‰æ•°æ®æ”¾åœ¨dataï¼Œdataçš„æ•°æ®ä¼šå¢åŠ  getter å’Œ setterï¼Œä¼šæ”¶é›†å¯¹åº”çš„ watcher vueåœ¨v-foræ—¶ç»™æ¯é¡¹å…ƒç´ ç»‘å®šäº‹ä»¶éœ€è¦ç”¨äº‹ä»¶ä»£ç† SPAé‡‡ç”¨keep-alive æ‹†åˆ†ç»„ä»¶ï¼Œå‡å°‘è€¦åˆåº¦ï¼Œæé«˜ç»´æŠ¤åº¦ åˆç†åˆ†é… v-if å’Œ v-show keyä¿è¯å”¯ä¸€æ€§ Object.freeze å†»ç»“æ•°æ® åˆç†ä½¿ç”¨è·¯ç”±æ‡’åŠ è½½ å°½é‡é‡‡ç”¨ runtimeè¿è¡Œæ—¶ç‰ˆæœ¬ åˆç†è¿ç”¨é˜²æŠ–èŠ‚æµ 8.ElementElementï¼Œä¸€å¥—ä¸ºå¼€å‘è€…ã€è®¾è®¡å¸ˆå’Œäº§å“ç»ç†å‡†å¤‡çš„åŸºäº Vue çš„æ¡Œé¢ç«¯ç»„ä»¶åº“ è¯¦æƒ…å¯ä»¥å»å®˜æ–¹æ–‡æ¡£è¿›è¡Œå­¦ä¹  Element-ui çš„validateæ–¹æ³•validate() æ˜¯elment-uiå°è£…å¥½çš„ç”¨äºå¯¹æ•´ä¸ªè¡¨å•è¿›è¡ŒéªŒè¯ï¼Œè‹¥ä¸ä¼ å…¥å›è°ƒå‡½æ•°ï¼Œåˆ™ä¼šè¿”å›ä»¥promise =&gt; Function(callback : Function(boolean,obj))ï¼Œå½“ç¬¬ä¸€ä¸ªå‚æ•°ä½trueï¼Œåˆ™æ ¡éªŒé€šè¿‡ Elementç»„ä»¶æ—¶æ ·å¼ä¿®æ”¹çš„é—®é¢˜é€šå¸¸åœ¨vueç»„ä»¶æ ·å¼ä¸­æ·»åŠ scopedï¼Œè¯¥ç»„ä»¶æ ·å¼åªèƒ½å¤Ÿåœ¨æœ¬ç»„ä»¶æ‰èƒ½æ‰§è¡Œï¼Œè¿™æ ·æˆ‘ä»¬å°±æ— æ³•æ›´æ”¹Elementç»„ä»¶æ ·å¼äº†ã€‚ å¦‚æœæˆ‘ä»¬å–æ¶ˆäº†scopedçš„è¯ï¼Œå…¨å±€çš„æ ·å¼æœ‰å¯èƒ½å°±ä¼šå‘ç”Ÿå†²çªã€‚ è§£å†³æ–¹æ³•æ˜¯ï¼š å¦‚æœä½¿ç”¨styleä¿®æ”¹æ ·å¼ï¼Œå¯ä»¥æ·»åŠ  &gt;&gt;&gt;çš„å‰ç¼€ å¦‚æœä½¿ç”¨sassæˆ–è€…lessä¿®æ”¹æ ·å¼ï¼Œå¯ä»¥æ·»åŠ /deep/çš„å‰ç¼€ æ€è·¯æä¾›ï¼šhttps://zhuanlan.zhihu.com/p/58942147 9.åŸç†ç›¸å…³åŒå‘ç»‘å®šObject.defineProperty( )çš„ get ï¼ˆè¯»å–å±æ€§å€¼è§¦å‘çš„å‡½æ•°ï¼‰å’Œ setï¼ˆsetå°±æ˜¯åœ¨è®¾ç½®å±æ€§å€¼è§¦å‘çš„å‡½æ•°ï¼‰ï¼Œæ‰€ä»¥Vueä¼šæ ¹æ®æ•°æ®å˜åŒ–ï¼Œé‡æ–°æ¸²æŸ“åˆ°è™šæ‹ŸDOMï¼Œç„¶åæ ¹æ®è™šæ‹ŸDOMï¼ŒæŠŠçœŸå®DOMè¿›è¡Œä¿®æ”¹ Object.defineProperty(å¯¹è±¡å, å±æ€§å, desciptor) Object.defineProperty(obj, key, { set(newValue) { console.log(\"ç›‘å¬\" + key + \"æ”¹å˜\"); value = newValue; }, get() { console.log(\"è·å–\" + key + \"çš„å€¼\"); return value; } }) Object.freeze()ä¼šé˜»æ­¢ä¿®æ”¹ç°æœ‰çš„ propertyï¼Œä¹Ÿæ„å‘³ç€å“åº”ç³»ç»Ÿæ— æ³•å†è¿½è¸ªåŒå‘ç»‘å®šå˜åŒ–ã€‚ å½“æ•°æ®å‘ç”Ÿæ”¹å˜ï¼ŒVueæ˜¯å¦‚ä½•é€šçŸ¥å“ªä¸€éƒ¨åˆ†å‘ç”Ÿåˆ·æ–°ï¼Ÿ(set() {} é‡Œé¢è¯¥å¦‚ä½•è¿›è¡Œæ“ä½œï¼Ÿ) å‘å¸ƒè®¢é˜…è€…æ¨¡å¼// å‘å¸ƒè€…ç±» class Dep { constructor() { // ç”¨äºå­˜å‚¨è®¢é˜…è€…çš„æ•°ç»„ this.subs = []; } // å¢åŠ è®¢é˜…è€…æ–¹æ³• addSub(watcher) { this.subs.push(watcher); } // è°ƒç”¨ä¹‹åï¼Œæ¯ä¸ªè®¢é˜…è€…éƒ½ä¼šè¿›è¡Œæ›´æ–° notify(){ this.subs.forEach(item => { item.update() }) } } // è®¢é˜…è€…ç±» class Watcher { constructor(name) { this.name = name; } update(){ console.log(this.name, \"å‘ç”Ÿæ›´æ–°\"); } } const dep = new Dep(); const watcher1 = new Watcher(\"item1\"); const watcher2 = new Watcher(\"item2\"); const watcher3 = new Watcher(\"item3\"); dep.addSub(watcher1); dep.addSub(watcher2); dep.addSub(watcher3); dep.notify(); dataä¸­æ¯ä¸€ä¸ªå±æ€§ï¼Œéƒ½æ·»åŠ ä¸€ä¸ªå‘å¸ƒè€…ç±»ï¼ˆnew ä¸€ä¸ª å‘å¸ƒè€…å®ä¾‹ï¼‰ è°é€šè¿‡ get(){}å¯¹æ•°æ®è¿›è¡Œè·å–ï¼Œåˆ™å¯¹å…¶æ·»åŠ è®¢é˜…è€…ç±»ï¼ˆnew ä¸€ä¸ª è®¢é˜…è€…å®ä¾‹ï¼‰ï¼Œç„¶åå°†è®¢é˜…è€…pushè¿›å‘å¸ƒè€…çš„subsæ•°ç»„ä¸­ å½“æ•°æ®å‘ç”Ÿä¿®æ”¹ï¼Œå³è§¦å‘ set(){}å‡½æ•°ï¼Œåœ¨é‡Œé¢ä½¿ç”¨notifyï¼š set(){ dep.notify(); } è®©æ‰€æœ‰è®¢é˜…è€…éšä¹‹å‘ç”Ÿæ›´æ–°ï¼ˆè°ƒç”¨äº†æ‰€æœ‰è®¢é˜…è€…çš„updateæ–¹æ³•ï¼‰ ï¼ˆå®é™…ä¸Šwatcheræœ‰å¾ˆå¤šç§ï¼Œæ­£å¸¸çš„dataå±æ€§çš„æ¸²æŸ“é¡µé¢watcherï¼ˆä¸‹é¢è¿™ä¸ªï¼‰ã€computedçš„watcherã€watchï¼ˆç”¨æˆ·è‡ªå®šä¹‰ï¼‰çš„watcherï¼‰ Observerï¼šæ¯ä¸ªå±æ€§åˆ›å»ºä¸€ä¸ªDepå¯¹è±¡ï¼ˆå‘å¸ƒè€…ï¼‰ï¼Œè‹¥dataæ•°æ®å‘ç”Ÿæ”¹åŠ¨ï¼Œåˆ™è°ƒç”¨Depå¯¹è±¡çš„notifyæ–¹æ³• Compileï¼šè§£æelä¸­çš„æŒ‡ä»¤ï¼Œæ¯æ¬¡ä½¿ç”¨åˆ°dataçš„æ•°æ®ï¼Œå°±åˆ›å»ºä¸€ä¸ªWatcherï¼ˆè®¢é˜…è€…ï¼‰ï¼Œç„¶ååŠ å…¥åˆ°è¯¥å±æ€§å¯¹åº”çš„å‘å¸ƒè€… Vue2.0åŒå‘ç»‘å®šçš„ç¼ºç‚¹1.å¿…é¡»åœ¨ data å¯¹è±¡ä¸Šå­˜åœ¨æ‰èƒ½è®© Vue å°†å®ƒè½¬æ¢ä¸ºå“åº”å¼çš„ var vm = new Vue({ data:{ a:1 } }) // `vm.a` æ˜¯å“åº”å¼çš„ vm.b = 2 // `vm.b` æ˜¯éå“åº”å¼çš„ 2.è‹¥åŸæ¥å±æ€§ä¸å­˜åœ¨ï¼Œå¯¹è±¡æ–°å¢å±æ€§ï¼ŒVueä¹Ÿæ£€æµ‹ä¸åˆ° 3.Vue ä¸èƒ½æ£€æµ‹ä»¥ä¸‹æ•°ç»„çš„å˜åŠ¨ï¼š 1.å½“ä½ åˆ©ç”¨ç´¢å¼•ç›´æ¥è®¾ç½®ä¸€ä¸ªæ•°ç»„é¡¹æ—¶ï¼Œä¾‹å¦‚ï¼švm.items[indexOfItem] = newValueï¼ˆä½†æ˜¯Vueæä¾›äº†APIè¿›è¡Œé‡å†™ï¼Œè¿˜é‡å†™äº†æ•°ç»„æ–¹æ³•ï¼‰ 2.å½“ä½ ä¿®æ”¹æ•°ç»„çš„é•¿åº¦æ—¶ï¼Œä¾‹å¦‚ï¼švm.items.length = newLength ä¸Šè¿°æ•°ç»„çš„æ”¹å˜æ— æ³•æ£€æµ‹å¾—åˆ°ï¼Œä½¿ç”¨Vue.set()æ‰èƒ½æ–°å¢ä¸€ä¸ªå±æ€§ å®é™…ä¸Šå°¤å¤§å·²ç»å›ç­”äº†ï¼Œæ˜¯è€ƒè™‘åˆ°æ€§èƒ½åŸå› ï¼Œæ‰ä¸ç”¨Object.defineProperty å¯¹å¯¹è±¡å±æ€§è¿›è¡Œç›‘å¬ 4.è¿˜æœ‰ä¸ªå°ç¼ºé™·ï¼Œå°±æ˜¯é»˜è®¤ä¼šé€’å½’ï¼Œé€’å½’ä½ dataé‡Œçš„å±æ€§ï¼Œå¯èƒ½å¯¼è‡´æ€§èƒ½ä¸é«˜ æ³¨æ„ 2020å¹´å Vue3.0å·²ç»æ¢æˆç”¨proxyä»£ç†äº† æ‰‹å†™æ—¥å¸¸ç‰ˆå‘å¸ƒè®¢é˜…è€…æ¨¡å¼class EventBus { map = {} //å¦‚æœæœ‰äººå‘å¸ƒäº†è¯¥æ¶ˆæ¯åtypeåˆ™è¿›è¡Œå›è°ƒ on(type, handler) { this.map[type] = (this.map[type] || []).concat(handler) } //å‘é€æ¶ˆæ¯ emit(type, data) { this.map[type] &amp;&amp; this.map[type].forEach(handler => handler(data)) } //å–æ¶ˆè®¢é˜… off(type, handler) { if(this.map[type]) { if(!handler) { delete this.map[type] } else { let index = this.map[type].indexOf(handler) this.map[type].splice(index, 1) } } } } æˆ–è€… class EventBusClass { constructor() { this.eventMap = {}; } on(eventName, callback) { const cbs = this.eventMap[eventName] || []; if (cbs.indexOf(callback) === -1) { cbs.push(callback); } this.eventMap[eventName] = cbs; } off(eventName, callback = null) { const cbs = this.eventMap[eventName]; if (!cbs) return; if (callback) { const idx = cbs.indexOf(callback); if (idx !== -1) { cbs.splice(idx, 1); } this.eventMap[eventName] = cbs; } else { this.eventMap[eventName] = undefined; } } emit(eventName, ...args) { const cbs = this.eventMap[eventName] || []; if (!cbs) return; cbs.forEach((cb) => cb.apply(this, args)); } } const eventBus = new EventBus() eventBus.on('click:btn', data => { console.log(data) }) eventBus.emit('click:btn', {a: 1, b: 2}) eventBus.off('click:btn') eventBus.emit('click:btn', {a: 1, b: 2}) VueåŸç†å°çŸ¥è¯†Vueæ£€æµ‹æ•°ç»„ä¸­çš„å˜åŒ– æˆ‘ä»¬éƒ½çŸ¥é“æ•°ç»„æœ‰pushã€shiftã€popè¿™äº›æ–¹æ³• è€ŒVueå¯¹dataé‡Œæ•°ç»„çš„åŸå‹æ–¹æ³•ï¼ˆprototypeï¼‰è¿›è¡Œäº†é‡å†™ï¼Œ__proto__æŒ‡å‘æ–°çš„åŸå‹å¯¹è±¡ï¼Œ é€šè¿‡åŸå‹é“¾å®šä¹‰å‡½æ•°ï¼Œè¿™æ ·çš„è¯æˆ‘ä»¬å°±å¯ä»¥åœ¨å…¶ä¸­è®¾ç½®å“åº”å¼ï¼ˆåŸæ¥çš„å‡½æ•°.apply + è°ƒç”¨æ›´æ–°è§†å›¾æ–¹æ³• notify()ï¼‰ ç„¶åï¼Œåˆ©ç”¨observerå¯¹æ•°ç»„é‡Œçš„æ¯ä¸€é¡¹è¿›è¡Œç›‘æ§ Vueé‡‡ç”¨å¼‚æ­¥æ¸²æŸ“ ä¸ºä½•Vueé‡‡ç”¨å¼‚æ­¥æ¸²æŸ“ï¼ˆæ•°æ®ï¼‰ï¼Ÿ é˜²æ­¢ä¸€æ›´æ”¹æ•°æ®å°±æ›´æ–°è§†å›¾ ï¼Œå¤šä¸ªæ•°æ®å‘ç”Ÿæ›´æ”¹åï¼Œå¯ä»¥å…ˆè¿‡æ»¤æ‰åŒä¸€ä¸ªè®¢é˜…è€…ï¼ˆå†…ç½®diï¼Œæ ¹æ®idè¿‡æ»¤åŒä¸€watcherï¼Œå³ä¸ç”¨å¯¼è‡´watcherè¿›è¡Œå¤šæ¬¡updateï¼‰ï¼Œæé«˜æ€§èƒ½ è™šæ‹ŸDOMDOMå®é™…æ“ä½œæ˜¯æŒºå¿«çš„ï¼Œä»»ä½•åŸºäºDOMçš„åº“ï¼ˆVue/Reactï¼‰éƒ½ä¸å¯èƒ½æ“ä½œDOMæ—¶æ¯”DOMå¿« è™šæ‹ŸDOMï¼šä¸€ä¸ªèƒ½ä»£è¡¨DOMæ ‘çš„å¯¹è±¡ï¼Œé€šå¸¸å«æœ‰æ ‡ç­¾åã€æ ‡ç­¾ä¸Šå±æ€§ã€äº‹ä»¶ç›‘å¬å’Œå­å…ƒç´ ä»¬ï¼Œä»¥åŠå…¶å®ƒå±æ€§ åœ¨æ§åˆ¶å°ä¸Šæ‰“å°å¯ä»¥çœ‹å¾—å‡ºå®ƒæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå®ƒå¯¹æ¯”çœŸå®DOMæ›´åŠ è½»é‡çº§ï¼Œä½¿ç”¨ debuggerå¯ä»¥åœ¨æµè§ˆå™¨çš„ Sources çœ‹å¾—åˆ°å®ƒçš„å±æ€§å¯¹æ¯”çœŸå®DOMå°‘å¾—å¤šï¼Œå®ƒæœ€ç»ˆä¼šè¢«Vue / React è½¬åŒ–ä¸ºçœŸå®DOMï¼Œå‘ˆç°åœ¨é¡µé¢ä¸Š ä¸ºä»€ä¹ˆè™šæ‹ŸDOMæ¯”çœŸå®DOMå¿«ï¼Ÿ å‡å°‘DOMæ“ä½œï¼šå¯ä»¥å°†å¤šæ¬¡DOMæ“ä½œåˆå¹¶ä¸ºä¸€æ¬¡æ“ä½œï¼Œæ¯”å¦‚æ·»åŠ 100ä¸ªèŠ‚ç‚¹åŸæ¥æ˜¯ä¸€ä¸ªä¸€ä¸ªæ·»åŠ ï¼Œç°åœ¨æ˜¯ä¸€æ¬¡æ€§æ·»åŠ ï¼Œå‡å°‘æµè§ˆå™¨å›æµ è™šæ‹ŸDOMå€ŸåŠ©DOM diff å¯ä»¥æŠŠå¤šä½™çš„æ“ä½œçœç•¥æ‰ï¼Œæ¯”å¦‚å¦‚æœå®ƒå‘ç°æœ‰ä¸€äº›èŠ‚ç‚¹å·²ç»åœ¨é¡µé¢é‡Œï¼Œå°±ä¸é€‰æ‹©æ›´æ–°ï¼Œåªæ›´æ–°ä¸ä¸€æ ·çš„éƒ¨åˆ†ï¼ˆæ¯”å¦‚ä¸Šé¢â€œè™šæ‹ŸDOMæ¸²æŸ“ç‰¹æ®Šæ¡ˆä¾‹â€æåŠåˆ°çš„ï¼‰ è·¨å¹³å°ï¼Œè™šæ‹ŸDOMä¸ä»…å¯ä»¥å˜æˆDOMï¼Œè¿˜å¯ä»¥å˜æˆå°ç¨‹åºã€iosåº”ç”¨ã€å®‰å“åº”ç”¨ï¼Œå› ä¸ºè™šæ‹ŸDOMæœ¬è´¨ä¸Šåªæ˜¯ä¸€ä¸ªJSå¯¹è±¡ ï¼ˆå›¾ç‰‡æºè‡ªé¥¥äººè°·ï¼‰ åˆ›å»ºè™šæ‹ŸDOMï¼ˆåŸå§‹æ–¹æ³•ï¼‰ï¼ˆåˆ†åˆ«å¯¹åº”Reactå’ŒVueï¼‰ ï¼ˆå°† h ä½œä¸º createElement çš„åˆ«åæ˜¯ Vue ç”Ÿæ€ç³»ç»Ÿä¸­çš„ä¸€ä¸ªé€šç”¨æƒ¯ä¾‹ï¼Œå®é™…ä¸Šä¹Ÿæ˜¯ JSX æ‰€è¦æ±‚çš„ï¼‰ è™šæ‹ŸDOMçš„ç¼ºç‚¹ï¼šéœ€è¦é¢å¤–åˆ›å»ºå‡½æ•°ï¼Œå¦‚createElementæˆ–hï¼Œä½†æ˜¯æœ‰è§£å†³æ–¹æ³•ï¼Œå¦‚ä¸‹ï¼šï¼ˆé€šè¿‡babelã€vue-loaderè½¬æ¢ï¼‰ ç°åœ¨åˆ›å»ºDOMçš„æ–¹æ³•ï¼š è™½ç„¶å…‹æœäº†è™šæ‹ŸDOMçš„ç¼ºç‚¹ï¼Œä½†æ˜¯æ–°å¢äº†å¦å¤–ä¸€ä¸ªç¼ºç‚¹ï¼Œä¹Ÿå°±æ˜¯ä¸¥é‡ä¾èµ–æ‰“åŒ…å·¥å…·ï¼ï¼ ä½†å…¶å®å½“è§„æ¨¡æ¯”è¾ƒåˆç†çš„æ—¶å€™ï¼Œæ¯”å¦‚å‡ åƒçš„æ—¶å€™ï¼Œä½¿ç”¨è™šæ‹ŸDOMæ˜¯å¾ˆå¥½çš„ï¼Œä»–å¯ä»¥é€šè¿‡ç®—æ³•ä¼˜åŒ–å¾ˆå¤šå¤šä½™çš„æ“ä½œï¼Œä½†æ˜¯å½“è§„æ¨¡å¤§åˆ°ä¸€å®šçš„ç¨‹åº¦ï¼Œ10wä»¥ä¸Šç­‰ç­‰ï¼Œåœ¨è¿™ä¸ªæƒ…å†µä¸‹åŸç”ŸDOMèƒ½ä¿æŒç¨³å®šæ€§ï¼Œè€ŒReactå°±å´©äº†ï¼ˆæˆ‘åœ¨Vueå’ŒReactçš„å¯¹æ¯”é‡Œé¢æåŠåˆ°ï¼‰ DOM diffdiffå°±æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸ºpatchï¼› pathces= patch(oldVNode, newVNode)ï¼Œåˆ†åˆ«å¯¹åº”æ—§èŠ‚ç‚¹å’Œæ–°èŠ‚ç‚¹ï¼Œpatcheså°±æ˜¯è¿è¡Œçš„DOMæ“ä½œ æŠŠè™šæ‹ŸDOMæƒ³è±¡æˆæ ‘å‹ï¼Œè®©æ–°çš„è™šæ‹ŸDOMå’Œæ—§çš„è™šæ‹ŸDOMè¿›è¡Œå¯¹æ¯” åªæ›´æ–°ä¸ä¸€æ ·çš„éƒ¨åˆ†ï¼ˆæ¯”å¦‚ä¸Šé¢â€œè™šæ‹ŸDOMæ¸²æŸ“ç‰¹æ®Šæ¡ˆä¾‹â€æåŠåˆ°çš„ï¼‰ Tree diffé€å±‚å¯¹æ¯”ï¼ŒæŸ¥çœ‹å“ªé‡Œéœ€è¦æ›´æ–°ï¼›çœ‹èŠ‚ç‚¹ï¼ˆElement diffï¼‰/ç»„ä»¶ï¼ˆComponent diffï¼‰ï¼ŒæŸ¥çœ‹æ ‡ç­¾å/ç»„ä»¶ç±»å‹ è‹¥æ ‡ç­¾ç±»å‹æ²¡å˜ï¼Œåªæ›´æ–°divå¯¹åº”çš„DOMå±æ€§ï¼Œå˜äº†çš„è¯ç›´æ¥æ›¿æ¢ / åˆ é™¤ è‹¥æ²¡æœ‰å‘ç”Ÿæ›¿æ¢æˆ–è€…åˆ é™¤çš„è¯ï¼Œè¿›å…¥æ ‡ç­¾åä»£/æ·±å…¥ç»„ä»¶ åç»§ç»­åš Tree diff é€’å½’ ä½†DOM diffä¹Ÿæœ‰ bug æ›´æ–°çš„æ—¶å€™ï¼Œç›´æ¥çœ‹ç¬¬ä¸€ä¸ªchildrenï¼Œ æŠŠ hello -&gt; worldï¼Œç„¶åå†åˆ é™¤æ‰åŸæ¥çš„ span -&gt; worldï¼›è€Œä¸æ˜¯ç›´æ¥åˆ é™¤æ‰helloçš„children æ‰€ä»¥æˆ‘ä¸ªäººç†è§£ ä¼˜ç‚¹å°±æ˜¯ï¼šå¤ç”¨æ€§æé«˜ï¼› ç¼ºç‚¹å°±æ˜¯ç”±äºdiffç®—æ³•ï¼Œå¯¼è‡´äº†å®é™…ä¸Šæ¯”è¾ƒç®€ä¾¿çš„æ“ä½œå˜å¾—å¤æ‚äº†ï¼ˆå¯ä»¥ä½¿ç”¨keyé¿å…ï¼‰ æ—¶é—´å¤æ‚åº¦ï¼šä¸¤æ£µæ ‘çš„diffæ—¶é—´å¤æ‚åº¦ä¸ºO(n^3)ï¼Œä½†æ˜¯Vueä¼˜åŒ–äº†ï¼ˆåŒæŒ‡é’ˆï¼‰ï¼ŒO(n^3) -&gt; O(n)ï¼Œå³4ä¸ªæŒ‡é’ˆåˆ†åˆ«æŒ‡å‘æ–°èŠ‚ç‚¹å¤´ï¼Œæ–°èŠ‚ç‚¹å°¾ã€æ—§èŠ‚ç‚¹å¤´ã€æ—§èŠ‚ç‚¹å°¾ï¼Œä¸¤ä¸¤è¿›è¡Œæ¯”è¾ƒ è™šæ‹ŸDOMæ¸²æŸ“ç‰¹æ®Šæ¡ˆä¾‹è¿™é‡Œåœ¨è¾“å…¥inputæ•°æ®ä¹‹åï¼Œå†ç‚¹å‡»åˆ‡æ¢æŒ‰é’®ï¼Œä¼šå‡ºç°å¦å¤–ä¸€ä¸ªinputæ¡†å†…ä»ä¿ç•™ä¹‹å‰è¾“å…¥çš„æ•°æ®çš„æƒ…å†µ è¿™æ˜¯å› ä¸ºVueåœ¨è¿›è¡ŒDOMæ¸²æŸ“çš„æ—¶å€™ï¼Œä¼šå…ˆæŠŠæ‰€æœ‰å…ƒç´ æ ‡ç­¾é€šè¿‡ä¸€ä¸ªè™šæ‹ŸDOMï¼ˆvirtual DOMï¼‰æ”¾åˆ°å†…å­˜é‡Œï¼Œç„¶åå†æ¸²æŸ“åˆ°æµè§ˆå™¨ä¸Šï¼›æ‰€ä»¥å‡ºäºæ€§èƒ½è€ƒè™‘ï¼Œä¼šå°½å¯èƒ½å¤ç”¨å·²ç»å­˜åœ¨çš„å…ƒç´ ï¼Œè€Œä¸æ˜¯åˆ›å»ºæ–°å…ƒç´ ï¼›å¤ç”¨çš„æ—¶å€™å¯¹æ¯”æ¯ä¸ªå±‚çº§ï¼ŒæŠŠä¿®æ”¹ä¹‹åçš„å¥—åœ¨åŸæ¥çš„å…ƒç´ ä¸Šï¼ˆæ¯”å¦‚å±æ€§ç±»å‹ï¼Œå±æ€§idç­‰ï¼‰ åœ¨ä»¥ä¸‹çš„æ¡ˆä¾‹ä¸­ï¼ŒVueå†…éƒ¨ä¼šå‘ç°åŸæ¥çš„inputå…ƒç´ ä¸å†ä½¿ç”¨ï¼Œç›´æ¥ä½œä¸ºelseä¸­çš„inputæ¥ä½¿ç”¨ï¼ˆç±»ä¼¼äºè®©ç°ä»»ç©¿å‰ä»»çš„è¡£æœï¼‰ ä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨ç¬¬ä¸€ä¸ªinputè¾“å…¥å­—ç¬¦ï¼Œç„¶åâ€œåˆ‡æ¢ç±»å‹â€ï¼Œè½¬ä¸ºç¬¬äºŒä¸ªinputåï¼Œä½ ä¾æ—§å¯ä»¥çœ‹åˆ°åˆšæ‰è¾“å…¥çš„å­—ç¬¦ è§£å†³æ–¹æ³•ï¼šå¢åŠ keyå±æ€§ï¼Œä½œä¸ºå”¯ä¸€çš„æ ‡è¯†ï¼Œkeyä¸åŒä¸è¿›è¡Œå¤ç”¨ &lt;input type=&quot;text&quot; placeholder=&quot;ç”¨æˆ·å&quot; key=&quot;username&quot;&gt; &lt;div id=\"app\"> &lt;div v-if=\"loginType\"> &lt;label for=\"email\">ç”¨æˆ·é‚®ç®±&lt;/label> &lt;input type=\"text\" placeholder=\"ç”¨æˆ·é‚®ç®±\"> &lt;/div> &lt;div v-else> &lt;label for=\"nickname\">ç”¨æˆ·å&lt;/label> &lt;input type=\"text\" placeholder=\"ç”¨æˆ·å\"> &lt;/div> &lt;button @click=\"loginType=!loginType\">åˆ‡æ¢ç±»å‹&lt;/button> &lt;/div> &lt;script src=\"./js/vue.js\">&lt;/script> &lt;script> const app = new Vue({ el: '#app', data: { loginType: true } });","categories":[{"name":"å‰ç«¯","slug":"å‰ç«¯","permalink":"https://taylor12138.github.io/categories/%E5%89%8D%E7%AB%AF/"}],"tags":[],"author":"Hello"},{"title":"æ·±å…¥JavaScriptå†…å­˜","slug":"æ·±å…¥JavaScriptå†…å­˜","date":"2021-03-20T16:00:00.000Z","updated":"2023-03-28T09:06:47.023Z","comments":true,"path":"2021/03/21/shen-ru-javascript-nei-cun/","link":"","permalink":"https://taylor12138.github.io/2021/03/21/shen-ru-javascript-nei-cun/","excerpt":"","text":"å†…å­˜æ¦‚è¿°å†…å­˜ä¹Ÿæ˜¯æœ‰ç”Ÿå‘½å‘¨æœŸçš„ï¼Œä¸ç®¡ä»€ä¹ˆç¨‹åºè¯­è¨€ï¼Œä¸€èˆ¬å¯ä»¥æŒ‰é¡ºåºåˆ†ä¸ºä¸‰ä¸ªå‘¨æœŸï¼š åˆ†é…æœŸ åˆ†é…æ‰€éœ€è¦çš„å†…å­˜ ä½¿ç”¨æœŸ ä½¿ç”¨åˆ†é…åˆ°çš„å†…å­˜ï¼ˆè¯»ã€å†™ï¼‰ é‡Šæ”¾æœŸ ä¸éœ€è¦æ—¶å°†å…¶é‡Šæ”¾å’Œå½’è¿˜ å®šä¹‰å˜é‡è‡ªåŠ¨åˆ†é…å†…å­˜ ç»å¤§éƒ¨åˆ†æƒ…å†µä¸‹ä¹Ÿä¸éœ€è¦æ‰‹åŠ¨é‡Šæ”¾å†…å­˜ è€Œæˆ‘ä»¬ç¨‹åºå‘˜å¤§å¤šåªéœ€å…³æ³¨ä½¿ç”¨å†…å­˜ å†…å­˜æ³„æ¼å½“ä¸€ä¸ªå¯¹è±¡å·²ç»ä¸éœ€è¦å†ä½¿ç”¨æœ¬è¯¥è¢«å›æ”¶æ—¶ï¼Œå¦å¤–ä¸€ä¸ªæ­£åœ¨ä½¿ç”¨çš„å¯¹è±¡æŒæœ‰å®ƒçš„å¼•ç”¨ï¼ˆæˆ–è€…ç”±äºè®¾è®¡é”™è¯¯ï¼‰è€Œå¯¼è‡´å®ƒä¸èƒ½è¢«å›æ”¶ï¼Œè¿™å¯¼è‡´æœ¬è¯¥è¢«å›æ”¶çš„å¯¹è±¡ä¸èƒ½è¢«å›æ”¶è€Œåœç•™åœ¨å †å†…å­˜ä¸­ï¼Œè¿™å°±äº§ç”Ÿäº†å†…å­˜æ³„æ¼ã€‚ è€Œå†…å­˜æ³„æ¼ä¹Ÿæ˜¯é€ æˆåº”ç”¨ç¨‹åºOOMï¼ˆå†…å­˜ä¸¥é‡ä¸è¶³ï¼‰çš„ç½ªé­ç¥¸é¦–ä¹‹ä¸€ å†…å­˜æ³„éœ²çš„é—®é¢˜å…¶å›°éš¾åœ¨äº 1.ç¼–è¯‘å™¨ä¸èƒ½å‘ç°è¿™äº›é—®é¢˜ã€‚ 2.è¿è¡Œæ—¶æ‰èƒ½æ•è·åˆ°è¿™äº›é”™è¯¯ï¼Œè¿™äº›é”™è¯¯æ²¡æœ‰æ˜æ˜¾çš„ç—‡çŠ¶ï¼Œæ—¶éšæ—¶ç°ã€‚ 3.å¯¹äºæ‰‹æœºç­‰ç»ˆç«¯å¼€å‘ç”¨æˆ·æ¥è¯´ï¼Œå°¤ä¸ºå›°éš¾ã€‚ è§£å†³æ–¹æ³•ï¼š é¿å…åˆ›å»ºå…¨å±€å˜é‡ï¼Œå¼€å¯ä¸¥æ ¼æ¨¡å¼ ä¸èƒ½æ»¥ç”¨é—­åŒ… æ¸…é™¤æ²¡æœ‰ç”¨çš„DOMå…ƒç´ å¼•ç”¨ (document.body.removeChild(DOMå…ƒç´ )) å®šæ—¶å™¨ç”¨å®Œç¦»å¼€é¡µé¢è®°å¾—æ‰‹åŠ¨åˆ é™¤ï¼ˆclearInterval()ï¼‰ ä½¿ç”¨Vueçš„æ—¶å€™ï¼Œåœ¨é¡µé¢é”€æ¯æ—¶è®°å¾—å¯¹äº‹ä»¶è§£ç»‘ï¼Œå¯¹EventBusè¿›è¡Œè§£ç»‘ beforeDestory () { window.removeEventListener('äº‹ä»¶å', æ¥æ”¶æ—¶çš„å›è°ƒå‡½æ•°(å‚æ•°)) } destroyed () { this.$bus.$off(\"äº‹ä»¶å\", æ¥æ”¶æ—¶çš„å›è°ƒå‡½æ•°(å‚æ•°)); } åœ¨ES6 é‡Œå¯ä»¥ä½¿ç”¨ WeakMapã€WeakSet JavaScriptçš„åƒåœ¾å›æ”¶æœºåˆ¶ï¼ˆGCï¼‰æ ‡è®°æ¸…é™¤ç®—æ³•è®¾ç½®ä¸€ä¸ªæ ¹å¯¹è±¡ï¼ˆrootï¼‰ï¼ˆåœ¨Javascripté‡Œï¼Œæ ¹æ˜¯å…¨å±€å¯¹è±¡ï¼‰ï¼‰ï¼Œç„¶ååƒåœ¾å›æ”¶å™¨ä¼šå®šæœŸä»æ ¹ï¼ˆrootï¼‰æ‰«æå†…å­˜ä¸­çš„å¯¹è±¡ï¼Œå‡¡æ˜¯èƒ½ä»æ ¹åˆ°è¾¾çš„å¯¹è±¡ï¼Œå°±æ˜¯è¿˜éœ€è¦ç”¨çš„ï¼Œåˆ°è¾¾ä¸äº†çš„è¿›è¡Œæ ‡è®°ï¼Œç¨åå›æ”¶ æ‰€æœ‰æ ‡è®°æ¸…é™¤ç®—æ³•æœ‰ä¸¤ä¸ªé˜¶æ®µï¼š æ ‡è®°é˜¶æ®µ æ¸…é™¤é˜¶æ®µ ç®—æ³•ç¼ºé™·ï¼šæ— æ³•ä»æ ¹å¯¹è±¡æŸ¥è¯¢åˆ°çš„å¯¹è±¡éƒ½ä¼šè¢«æ¸…é™¤ï¼Œåƒåœ¾æ”¶é›†å®Œæ¯•åä¼šé€ æˆå¤§é‡å†…å­˜ç¢ç‰‡ï¼Œä¹Ÿå°±æ˜¯é€ æˆå†…å­˜ç©ºé—´ä¸è¿ç»­çš„é—®é¢˜ï¼ˆç¼ºé™·è¯¦æƒ…å¯ä»¥åœ¨ä¸‹é¢çš„V8è€ç”Ÿä»£åƒåœ¾å›æ”¶æœºåˆ¶æŸ¥çœ‹ï¼‰ ä»2012å¹´èµ·ï¼Œæ‰€æœ‰ç°ä»£æµè§ˆå™¨éƒ½ä½¿ç”¨äº†æ ‡è®°-æ¸…é™¤åƒåœ¾å›æ”¶ç®—æ³•ã€‚æ‰€æœ‰å¯¹JavaScriptåƒåœ¾å›æ”¶ç®—æ³•çš„æ”¹è¿›éƒ½æ˜¯åŸºäºæ ‡è®°-æ¸…é™¤ç®—æ³•çš„æ”¹è¿› å¼•ç”¨è®¡æ•°ç®—æ³•å¤è€çš„åƒåœ¾å›æ”¶ç®—æ³•ï¼Œæ²¡é‚£ä¹ˆå¸¸ç”¨äº† åŸç†æ˜¯è·Ÿè¸ªè®°å½•æ¯ä¸ªå€¼è¢«å¼•ç”¨çš„æ¬¡æ•°ï¼Œè¢«å¼•ç”¨ä¸€æ¬¡ï¼Œåˆ™count + 1ï¼ˆé™¤äº†å¼±å¼•ç”¨ç±»å‹WeakMapã€WeakSetï¼‰ åƒåœ¾å›æ”¶ç¨‹åºä¸‹æ¬¡è¿è¡Œçš„æ—¶å€™å°±ä¼šé‡Šæ”¾å¼•ç”¨æ•°ä¸º0çš„å†…å­˜ å®ƒæœ‰å¾ˆå¤šè®¡æ•°é—®é¢˜ï¼Œæ¯”å¦‚å¼•ç”¨å¾ªç¯ï¼Œå¯¹è±¡Aæœ‰ä¸€ä¸ªæŒ‡é’ˆæŒ‡å‘å¯¹è±¡Bï¼Œè€Œå¯¹è±¡Bä¹Ÿå¼•ç”¨äº†Aï¼Œä»–ä»¬çš„å¼•ç”¨ä¹¦æ°¸è¿œä¸ä¼šå˜æˆ0 V8çš„å†…å­˜åˆ†ä»£å’Œå›æ”¶ç®—æ³•Chrome æµè§ˆå™¨æ‰€ä½¿ç”¨çš„ V8 å¼•æ“å°±æ˜¯é‡‡ç”¨çš„åˆ†ä»£å›æ”¶ç­–ç•¥ã€‚è¿™ä¸ªå’Œ Java å›æ”¶ç­–ç•¥æ€æƒ³æ˜¯ä¸€è‡´çš„ã€‚ç›®çš„æ˜¯é€šè¿‡åŒºåˆ†ã€Œä¸´æ—¶ã€ä¸ã€ŒæŒä¹…ã€å¯¹è±¡ï¼›å¤šå›æ”¶ã€Œä¸´æ—¶å¯¹è±¡åŒºã€ï¼ˆæ–°ç”Ÿä»£young generationï¼‰ï¼Œå°‘å›æ”¶ã€ŒæŒä¹…å¯¹è±¡åŒºã€ï¼ˆè€ç”Ÿä»£ tenured generationï¼‰ï¼Œå‡å°‘æ¯æ¬¡éœ€éå†çš„å¯¹è±¡ï¼Œä»è€Œå‡å°‘æ¯æ¬¡GCçš„è€—æ—¶ã€‚ æ–°ç”Ÿä»£ä¸­çš„å¯¹è±¡å­˜æ´»æ—¶é—´è¾ƒçŸ­çš„å¯¹è±¡ï¼Œè€ç”Ÿä»£ä¸­çš„å¯¹è±¡å­˜æ´»æ—¶é—´è¾ƒé•¿ï¼Œæˆ–å¸¸é©»å†…å­˜çš„å¯¹è±¡ã€‚ æ–°ç”Ÿä»£æ–°ç”Ÿä»£ä¸­çš„å¯¹è±¡ä¸»è¦é€šè¿‡Scavengeç®—æ³•è¿›è¡Œåƒåœ¾å›æ”¶ å®ƒå°†å †å†…å­˜ä¸€åˆ†ä¸ºäºŒåˆ‡å¼€ï¼Œè®©æ¯ä¸€ä¸ªç©ºé—´æˆä¸ºä¸€ä¸ªsemispaceï¼Œè€Œè¿™ä¸¤ä¸ªç©ºé—´ä¸­ï¼Œä¸€ä¸ªå¤„äºä½¿ç”¨ä¸­ï¼ˆFromç©ºé—´ï¼‰ï¼Œå¦ä¸€ä¸ªå¤„äºé—²ç½®çŠ¶æ€ï¼ˆToç©ºé—´ï¼‰ã€‚ç”±äºæ–°ç”Ÿä»£ç”Ÿå‘½å‘¨æœŸçŸ­ï¼Œæ‰€ä»¥æ¯”è¾ƒé€‚åˆè¿™ä¸ªé¢‘ç¹å¯¹æ¢ + é‡Šæ”¾çš„ç®—æ³• æ­¤æ—¶åƒåœ¾å›æ”¶å¼€å§‹ï¼š 1.æ£€æŸ¥Fromç©ºé—´ä¸­å­˜æ´»å¯¹è±¡ï¼Œç„¶åå¤åˆ¶åˆ°Toç©ºé—´ä¸­ï¼Œè€Œéå­˜æ´»å¯¹è±¡ç©ºé—´ä¼šè¢«é‡Šæ”¾æ‰ï¼ŒFromç©ºé—´å’ŒToç©ºé—´çš„èº«ä»½å¯¹æ¢ã€‚ 2.å½“ä¸€ä¸ªå¯¹è±¡å¤šæ¬¡å¤åˆ¶ä¹‹åä¾ç„¶å­˜æ´»ï¼Œè¯´æ˜äººå®¶æ¯”è¾ƒé•¿å¯¿ï¼Œå°±ä¼šè¢«è¿ç§»è‡³è€ç”Ÿä»£ä¹‹ä¸­ 3.Toé—²ç½®ç©ºé—´å†…å­˜å ç”¨è¶…è¿‡25%ï¼Œä¹Ÿä¼šè¢«è¿ç§»è‡³è€ç”Ÿä»£ä¹‹ä¸­ è€ç”Ÿä»£è€ç”Ÿä»£ä½¿ç”¨çš„æ˜¯æ ‡è®°æ¸…é™¤æ³•ï¼Œæ´»å¯¹è±¡åœ¨æ–°ç”Ÿä»£ä¸­åªå å«å°éƒ¨åˆ†ï¼Œæ­»å¯¹è±¡åœ¨è€ç”Ÿä»£ä¸­åªå è¾ƒå°éƒ¨åˆ†ï¼Œè¿™æ˜¯ä¸ºä»€ä¹ˆé‡‡ç”¨æ ‡è®°æ¸…é™¤ç®—æ³•çš„åŸå› ã€‚ ä»ä¸Šæ–‡æˆ‘ä»¬ä¹Ÿå¯ä»¥æ¸…æ¥šæ ‡è®°æ¸…é™¤æ³•çš„ç¼ºé™·é—®é¢˜ï¼ˆå†…å­˜ç¢ç‰‡é—®é¢˜ï¼Œå†…å­˜ç©ºé—´ä¸è¿ç»­ï¼‰ æ­¤æ—¶å¦‚æœéœ€è¦åˆ†é…ä¸€ä¸ªå¤§å¯¹è±¡ï¼Œè¿™æ—¶æ‰€æœ‰çš„ç¢ç‰‡ç©ºé—´éƒ½æ— æ³•å®Œæˆæ­¤æ¬¡åˆ†é…ï¼Œå°±ä¼šæå‰è§¦å‘åƒåœ¾å›æ”¶ï¼Œè€Œè¿™æ¬¡å›æ”¶æ˜¯ä¸å¿…è¦çš„ã€‚ ä¸ºäº†è§£å†³ç¢ç‰‡é—®é¢˜ï¼Œæ ‡è®°æ•´ç†è¢«æå‡ºæ¥ã€‚å°±æ˜¯åœ¨å¯¹è±¡è¢«æ ‡è®°æ­»äº¡åï¼Œåœ¨æ•´ç†çš„è¿‡ç¨‹ä¸­ï¼Œå°†æ´»ç€çš„å¯¹è±¡å¾€ä¸€ç«¯ç§»åŠ¨ï¼Œç§»åŠ¨å®Œæˆåï¼Œç›´æ¥æ¸…ç†æ‰è¾¹ç•Œå¤–çš„å†…å­˜ã€‚ å‚è€ƒé“¾æ¥https://juejin.cn/post/6844903951742025736 å‡å°‘åƒåœ¾å›æ”¶å¯¹æ€§èƒ½çš„å½±å“ï¼š1.è®©åƒåœ¾å›æ”¶å°½é‡å°‘åœ°è¿›è¡Œ 2.é¿å…å†…å­˜æ³„éœ² æå‡æ€§èƒ½é¿å…JavaScriptçš„å…ˆåˆ›å»ºå†è¡¥å……çš„åŠ¨æ€å±æ€§èµ‹å€¼ï¼Œè€Œæ˜¯ä¸€æ¬¡æ€§å£°æ˜æ‰€æœ‰å±æ€§ï¼Œè®©å®ä¾‹ä»¬å…±äº«ä¸€ä¸ªéšè—ç±» //é”™è¯¯ç¤ºèŒƒâŒ function Article(){ this.title = 'my name is title'; } let a1 = new Article(); let a2 = new Article(); a1.author = 'Allen'; //æ­£ç¡®ç¤ºèŒƒâˆš function Article(author){ this.title = 'my name is title'; this.name = author; } let a1 = new Article('Allen'); let a2 = new Article(); ç”±äºJavaScriptæ•°ç»„å¤§å°æ˜¯åŠ¨æ€å¯å˜çš„ï¼Œï¼Œå¼•æ“ä¼šåˆ é™¤å¤§å°ä¸º100çš„æ•°ç»„ï¼Œåœ¨åˆ›å»ºä¸€ä¸ªæ–°çš„å¤§å°ä¸º200çš„æ•°ç»„ï¼Œåƒåœ¾å›æ”¶ç¨‹åºçœ‹åˆ°è¿™ä¸ªåˆ é™¤æ“ä½œï¼Œè¯´ä¸å®šçœ‹ä½ å¯¹è±¡æ›´æ›¿é€Ÿåº¦é‚£ä¹ˆå¿«ï¼Œå°±åŠ å¿«å¯¹ä½ è¿™é‡Œåƒåœ¾å›æ”¶çš„é¢‘ç‡ï¼Œä»è€Œé™ä½æ€§èƒ½ã€‚è¦é¿å…è¿™ç§åŠ¨æ€åˆ†é…çš„æ“ä½œï¼Œå¯ä»¥åœ¨åˆå§‹åŒ–æ—¶å°±åˆ›å»ºä¸€ä¸ªå¤§å°å¤Ÿç”¨çš„æ•°ç»„ï¼Œä»è€Œé¿å…ä¸Šè¿°å…ˆåˆ é™¤å†åˆ›å»ºçš„æ“ä½œï¼Œä¸è¿‡ï¼Œä½ å¿…é¡»äº‹å…ˆæƒ³å¥½è¿™ä¸ªæ•°ç»„æœ‰å¤šå¤§ã€‚ ï¼ˆå®é™…ä¸Šé™æ€åˆ†é…æ˜¯ä¼˜åŒ–çš„ä¸€ç§æç«¯æ–¹å¼ï¼Œå¦‚æœä½ çš„åº”ç”¨ç¨‹åºè¢«åƒåœ¾å›æ”¶ä¸¥é‡æ‹–äº†åè…¿ï¼Œå¯ä»¥åˆ©ç”¨å®ƒæ¥æå‡æ€§èƒ½ï¼Œä½†è¿™ç§æƒ…å†µå¹¶ä¸å¤šè§ï¼Œå¤§å¤šæƒ…å†µä¸‹ï¼Œè¿™éƒ½å±äºè¿‡æ—©ä¼˜åŒ–ã€‚ï¼‰ V8æ€§èƒ½ä¼˜åŒ–åœ¨ V8 å¼•æ“ä¸‹ï¼Œåˆå¼•å…¥äº† TurboFan ç¼–è¯‘å™¨ï¼Œä»–ä¼šåœ¨ç‰¹å®šçš„æƒ…å†µä¸‹è¿›è¡Œä¼˜åŒ–ï¼Œå°†ä»£ç ç¼–è¯‘æˆæ‰§è¡Œæ•ˆç‡æ›´é«˜çš„ Machine Code ç„¶è€Œä»€ä¹ˆæƒ…å†µä¸‹ä¼šè½¬æ¢æˆä¸ºmachine codeï¼Ÿ 1. function test(x) { return x + x } test(1) test(2) test(3) test(4) ä»¥ä¸Šå‡½æ•°è¢«å¤šæ¬¡è°ƒç”¨å¹¶ä¸”å‚æ•°ä¸€ç›´ä¼ å…¥ number ç±»å‹ï¼Œé‚£ä¹ˆ V8 å°±ä¼šè®¤ä¸ºè¯¥æ®µä»£ç å¯ä»¥ç¼–è¯‘ä¸º Machine Codeï¼Œå› ä¸ºä½ å›ºå®šäº†ç±»å‹ï¼Œä¸éœ€è¦å†æ‰§è¡Œå¾ˆå¤šåˆ¤æ–­é€»è¾‘äº†ã€‚ æ‰€ä»¥æˆ‘ä»¬è¦å°½å¯èƒ½ä¿è¯ä¼ å…¥ç±»å‹ä¸€è‡´ è¿™ä¹Ÿç»™æˆ‘ä»¬å¸¦æ¥äº†ä¸€ä¸ªæ€è€ƒï¼Œè¿™æ˜¯ä¸æ˜¯ä¹Ÿæ˜¯ä½¿ç”¨ TypeScript èƒ½å¤Ÿå¸¦æ¥çš„å¥½å¤„ä¹‹ä¸€ 2. å¦å¤–ï¼Œç¼–è¯‘å™¨è¿˜æœ‰ä¸ªéªšæ“ä½œ Lazy-Compileï¼Œå½“å‡½æ•°æ²¡æœ‰è¢«æ‰§è¡Œçš„æ—¶å€™ï¼Œä¼šå¯¹å‡½æ•°è¿›è¡Œä¸€æ¬¡é¢„è§£æï¼Œç›´åˆ°ä»£ç è¢«æ‰§è¡Œä»¥åæ‰ä¼šè¢«è§£æç¼–è¯‘ã€‚ç„¶è€Œæœ‰æ—¶å€™ï¼Œæˆ‘ä»¬çš„å‡½æ•°åªéœ€è¦è¢«é¢„è§£æä¸€æ¬¡ï¼Œç„¶ååœ¨è°ƒç”¨çš„æ—¶å€™å†è¢«è§£æç¼–è¯‘ã€‚ä½†æ˜¯å¯¹äºè¿™ç§å‡½æ•°é©¬ä¸Šå°±è¢«è°ƒç”¨çš„æƒ…å†µæ¥è¯´ï¼Œé¢„è§£æè¿™ä¸ªè¿‡ç¨‹å…¶å®æ˜¯å¤šä½™çš„ï¼Œé‚£ä¹ˆæœ‰ä»€ä¹ˆåŠæ³•èƒ½å¤Ÿè®©ä»£ç ä¸è¢«é¢„è§£æå‘¢ï¼Ÿ ç«‹å³æ‰§è¡Œå‡½æ•° (function test(obj) { return x + x })() ä½†æ˜¯ä¸å¯èƒ½æˆ‘ä»¬ä¸ºäº†æ€§èƒ½ä¼˜åŒ–ï¼Œç»™æ‰€æœ‰çš„å‡½æ•°éƒ½å»å¥—ä¸Šæ‹¬å·ï¼Œå¹¶ä¸”ä¹Ÿä¸æ˜¯æ‰€æœ‰å‡½æ•°éƒ½éœ€è¦è¿™æ ·åšã€‚ ç¼“å­˜é›ªå´©ç¼“å­˜é›ªå´©å°±æ˜¯æŒ‡ç¼“å­˜ç”±äºæŸäº›åŸå› ï¼ˆæ¯”å¦‚ å®•æœºã€cacheæœåŠ¡æŒ‚äº†æˆ–è€…ä¸å“åº”ï¼‰ï¼Œå¯¼è‡´å¤§é‡è¯·æ±‚åˆ°è¾¾åç«¯æ•°æ®åº“ï¼Œä»è€Œå¯¼è‡´æ•°æ®åº“å´©æºƒï¼Œæ•´ä¸ªç³»ç»Ÿå´©æºƒï¼Œå‘ç”Ÿç¾éš¾ã€‚ å…¶å®ä¹Ÿå¯ä»¥è§£é‡Šä¸ºcache crashä¹‹åï¼Œç‰µä¸€å‘è€ŒåŠ¨å…¨èº«ï¼Œå¯¼è‡´åç«¯çš„å„å¤§åŒºåŸŸæ¥è€Œæ— æ³•è¿›è¡ŒæœåŠ¡è€Œå´©æºƒï¼Œå…¨éƒ¨æ‹–æ­» å‰æƒ…æè¦ï¼šredisæ˜¯ä¸€ä¸ªå¼€æºçš„ã€ä½¿ç”¨Cè¯­è¨€ç¼–å†™çš„ã€æ”¯æŒç½‘ç»œäº¤äº’çš„ã€å¯åŸºäºå†…å­˜ä¹Ÿå¯æŒä¹…åŒ–çš„Key-Valueæ•°æ®åº“ã€‚ ç±»ä¼¼äºï¼š 1ã€redisé›†ç¾¤å½»åº•å´©æºƒ 2ã€ç¼“å­˜æœåŠ¡å¤§é‡å¯¹redisçš„è¯·æ±‚hangä½ï¼Œå ç”¨èµ„æº 3ã€ç¼“å­˜æœåŠ¡å¤§é‡çš„è¯·æ±‚æ‰“åˆ°æºå¤´æœåŠ¡å»æŸ¥è¯¢mysqlï¼Œç›´æ¥æ‰“æ­»mysql 4ã€æºå¤´æœåŠ¡å› ä¸ºmysqlè¢«æ‰“æ­»ä¹Ÿå´©æºƒï¼Œå¯¹æºæœåŠ¡çš„è¯·æ±‚ä¹Ÿhangä½ï¼Œå ç”¨èµ„æº 5ã€ç¼“å­˜æœåŠ¡å¤§é‡çš„èµ„æºå…¨éƒ¨è€—è´¹åœ¨è®¿é—®rediså’ŒæºæœåŠ¡æ— æœï¼Œæœ€åè‡ªå·±è¢«æ‹–æ­»ï¼Œæ— æ³•æä¾›æœåŠ¡ 6ã€nginxæ— æ³•è®¿é—®ç¼“å­˜æœåŠ¡ï¼Œrediså’ŒæºæœåŠ¡ï¼Œåªèƒ½åŸºäºæœ¬åœ°ç¼“å­˜æä¾›æœåŠ¡ï¼Œä½†æ˜¯ç¼“å­˜è¿‡æœŸåï¼Œæ²¡æœ‰æ•°æ®æä¾› 7ã€ç½‘ç«™å´©æºƒ äº§ç”ŸåŸå› 1ã€ä¾‹å¦‚ â€œç¼“å­˜å¹¶å‘â€ï¼Œâ€œç¼“å­˜ç©¿é€â€ï¼Œâ€œç¼“å­˜é¢ ç°¸â€ ç­‰é—®é¢˜ï¼Œè¿™äº›é—®é¢˜ä¹Ÿå¯èƒ½ä¼šè¢«æ¶æ„æ”»å‡»è€…æ‰€åˆ©ç”¨ã€‚ ç¼“å­˜ç©¿é€ æŒ‡æŸ¥è¯¢ä¸€ä¸ªç¼“å­˜å’Œæ•°æ®åº“éƒ½æ²¡æœ‰çš„æ•°æ®ï¼Œä¾‹å¦‚æˆ‘ä»¬æ•°æ®åº“çš„idéƒ½æ˜¯ä»1å¼€å§‹è‡ªå¢çš„ï¼Œå¦‚æœä¼ å…¥çš„å‚æ•°ä¸º-1æˆ–è€…ç‰¹åˆ«å¤§ä¸å­˜åœ¨çš„æ•°æ®ï¼Œå°±ä¼šæ¯æ¬¡éƒ½å»æŸ¥è¯¢æ•°æ®åº“ï¼Œè€Œæ¯æ¬¡æŸ¥è¯¢éƒ½æ˜¯ç©ºï¼Œæ¯æ¬¡åˆéƒ½ä¸ä¼šè¿›è¡Œç¼“å­˜ ç¼“å­˜å‡»ç©¿ æŒ‡ä¸€ä¸ªkeyéå¸¸çƒ­ç‚¹ï¼Œåœ¨ä¸åœçš„æ‰›ç€å¤§å¹¶å‘ï¼Œå¤§å¹¶å‘é›†ä¸­å¯¹è¿™ä¸€ä¸ªç‚¹è¿›è¡Œè®¿é—®ï¼Œå½“è¿™ä¸ªkeyåœ¨å¤±æ•ˆçš„ç¬é—´ï¼ŒæŒç»­çš„å¤§å¹¶å‘å°±ç©¿ç ´ç¼“å­˜ï¼Œç›´æ¥è¯·æ±‚æ•°æ®åº“ 2ã€ä¾‹å¦‚ æŸä¸ªæ—¶é—´ç‚¹å†…ï¼Œç³»ç»Ÿé¢„åŠ è½½çš„ç¼“å­˜å‘¨æœŸæ€§é›†ä¸­å¤±æ•ˆäº†ï¼Œä¾‹å¦‚ï¼šæˆ‘ä»¬è®¾ç½®ç¼“å­˜æ—¶é‡‡ç”¨äº†ç›¸åŒçš„è¿‡æœŸæ—¶é—´ï¼Œåœ¨åŒä¸€æ—¶åˆ»å‡ºç°å¤§é¢ç§¯çš„ç¼“å­˜è¿‡æœŸã€‚ è§£å†³æ–¹æ³•ï¼šå¯ä»¥é€šè¿‡è®¾ç½®ä¸åŒçš„è¿‡æœŸæ—¶é—´ï¼Œæ¥é”™å¼€ç¼“å­˜è¿‡æœŸï¼Œä»è€Œé¿å…ç¼“å­˜é›†ä¸­å¤±æ•ˆã€‚ é¢„é˜²å’Œè§£å†³ ä¿è¯ç¼“å­˜å±‚æœåŠ¡é«˜å¯ç”¨æ€§ï¼Œå¦‚æœç¼“å­˜å±‚è®¾è®¡æˆé«˜å¯ç”¨çš„ï¼Œå³ä½¿ä¸ªåˆ«èŠ‚ç‚¹ã€ä¸ªåˆ«æœºå™¨ã€ç”šè‡³æ˜¯æœºæˆ¿å®•æ‰ï¼Œä¾ç„¶å¯ä»¥æä¾›æœåŠ¡ï¼Œä¾‹å¦‚ Redis Sentinel å’Œ Redis Cluster éƒ½å®ç°äº†é«˜å¯ç”¨ã€‚ éƒ¨ç½²æ–¹å¼ä¸€ï¼šåŒæœºæˆ¿éƒ¨ç½²ï¼Œä¸€å¥—Redis Clusterï¼Œéƒ¨åˆ†æœºå™¨åœ¨ä¸€ä¸ªæœºæˆ¿ï¼Œå¦ä¸€éƒ¨åˆ†æœºå™¨åœ¨å¦å¤–ä¸€ä¸ªæœºæˆ¿ã€‚ éƒ¨ç½²æ–¹å¼äºŒï¼šåŒæœºæˆ¿éƒ¨ç½²ï¼Œä¸¤å¥—Redis Clusterï¼Œä¸¤å¥—Redis Clusterä¹‹é—´åšä¸€ä¸ªæ•°æ®åŒæ­¥ã€‚ Redisæ•°æ®å¤‡ä»½å’Œæ¢å¤ã€å¿«é€Ÿç¼“å­˜é¢„çƒ­ å¯¹æºæœåŠ¡è®¿é—®è¿›è¡Œ é™æµã€èµ„æºéš”ç¦»ï¼ˆç†”æ–­ï¼‰ã€Stubbed é™çº§ã€‚ å¯¹ç¼“å­˜è®¿é—®è¿›è¡Œ èµ„æºéš”ç¦»ï¼ˆç†”æ–­ï¼‰ã€Fail Silent é™çº§ ï¼ˆé™çº§ï¼šæŸäº›ç‰¹æ®Šæƒ…å†µä¸‹ï¼Œåœ¨å‡ºç°å¤§é‡å ç”¨äº†ä¸€äº›ç¨€ç¼ºæœåŠ¡èµ„æºï¼Œåœ¨ç´§æ€¥æƒ…å†µä¸‹å¯ä»¥å¯¹å…¶æ•´ä¸ªé™çº§ï¼Œä»¥è¾¾åˆ°ä¸¢å’ä¿å¸…ï¼›é™çº§çš„æœ€ç»ˆç›®çš„æ˜¯ä¿è¯æ ¸å¿ƒæœåŠ¡å¯ç”¨ï¼Œå³ä½¿æ˜¯æœ‰æŸçš„ï¼‰","categories":[{"name":"å‰ç«¯","slug":"å‰ç«¯","permalink":"https://taylor12138.github.io/categories/%E5%89%8D%E7%AB%AF/"}],"tags":[],"author":"Hello"},{"title":"å®‰å…¨é—®é¢˜æ±‡æ€»","slug":"å®‰å…¨é—®é¢˜æ±‡æ€»","date":"2021-03-14T16:00:00.000Z","updated":"2022-07-17T07:54:56.965Z","comments":true,"path":"2021/03/15/an-quan-wen-ti-hui-zong/","link":"","permalink":"https://taylor12138.github.io/2021/03/15/an-quan-wen-ti-hui-zong/","excerpt":"","text":"1.XSSä»€ä¹ˆæ˜¯XSSCross-Site Scriptingï¼ˆè·¨ç«™è„šæœ¬æ”»å‡»ï¼‰ç®€ç§° XSSï¼Œæ˜¯ä¸€ç§ä»£ç æ³¨å…¥æ”»å‡»ï¼Œé€šè¿‡æ³¨å…¥æ¶æ„è„šæœ¬ï¼Œï¼Œä½¿ä¹‹åœ¨ç”¨æˆ·æµè§ˆå™¨ä¸Šè¿è¡Œï¼Œç„¶ååˆ©ç”¨è¿™äº›æ¶æ„è„šæœ¬ï¼Œæ”»å‡»è€…å¯ä»¥è·å–ç”¨æˆ·çš„æ•æ„Ÿä¿¡æ¯Cookieã€SessionIDç­‰ webå®‰å…¨æ¨¡å‹æ˜¯åŸºäºåŒæºç­–ç•¥çš„ï¼Œä½†æ˜¯XSSæ”»å‡»é€šè¿‡è¯±ä½¿ç«™ç‚¹ä¸é¢„æœŸå†…å®¹ä¸€èµ·æä¾›æ¶æ„ä»£ç æ¥ç»•è¿‡åŒæºç­–ç•¥ã€‚è¿™æ˜¯ä¸€ä¸ªå·¨å¤§çš„é—®é¢˜ï¼Œå› ä¸ºæµè§ˆå™¨ç›¸ä¿¡é¡µé¢ä¸Šæ˜¾ç¤ºçš„æ‰€æœ‰ä»£ç éƒ½æ˜¯è¯¥é¡µé¢å®‰å…¨æ¥æºçš„åˆæ³•éƒ¨åˆ†ã€‚ XSS å¸¸è§çš„æ³¨å…¥æ–¹æ³•ï¼š åœ¨ HTML ä¸­å†…åµŒçš„æ–‡æœ¬ä¸­ï¼Œæ¶æ„å†…å®¹ä»¥ script æ ‡ç­¾å½¢æˆæ³¨å…¥ã€‚ åœ¨å†…è”çš„ JavaScript ä¸­ï¼Œæ‹¼æ¥çš„æ•°æ®çªç ´äº†åŸæœ¬çš„é™åˆ¶ï¼ˆå­—ç¬¦ä¸²ï¼Œå˜é‡ï¼Œæ–¹æ³•åç­‰ï¼‰ã€‚ åœ¨æ ‡ç­¾å±æ€§ä¸­ï¼Œæ¶æ„å†…å®¹åŒ…å«å¼•å·ï¼Œä»è€Œçªç ´å±æ€§å€¼çš„é™åˆ¶ï¼Œæ³¨å…¥å…¶ä»–å±æ€§æˆ–è€…æ ‡ç­¾ã€‚ åœ¨æ ‡ç­¾çš„ hrefã€src ç­‰å±æ€§ä¸­ï¼ŒåŒ…å« javascript: (ä¼ªåè®®)ç­‰å¯æ‰§è¡Œä»£ç ã€‚ ç­‰ç­‰ã€‚ã€‚ã€‚ã€‚ XSSæ”»å‡»ç±»å‹ å­˜å‚¨å‹XSSï¼Œå®ƒæ˜¯æœ€å±é™©çš„ä¸€ç§è·¨ç«™è„šæœ¬ï¼Œç›¸æ¯”åå°„å‹XSSå’ŒDOMå‹XSSå…·æœ‰æ›´é«˜çš„éšè”½æ€§ï¼Œæ‰€ä»¥å±å®³æ›´å¤§ æ”»å‡»è€…å°†æ¶æ„ä»£ç æäº¤åˆ°ç›®æ ‡ç½‘ç«™æ•°æ®åº“ä¸­ å®¢æˆ·ç«¯æœ€åä»æœåŠ¡å™¨å¾—åˆ°çš„å°±æ˜¯æ¶æ„ä»£ç ï¼Œåœ¨æµè§ˆå™¨æ‰§è¡Œçš„ä¹Ÿæ˜¯è¯¥æ¶æ„ä»£ç  æ¶æ„ä»£ç å°†ç”¨æˆ·æ•°æ®å‘é€è‡³æ”»å‡»è€…ç½‘ç«™ åå°„å‹XSSï¼ˆæœ‰ç‚¹åƒé‚£ç§è‰²æƒ…å°å¹¿å‘Šï¼Œç‚¹è¿›å»ä½ å°±æ²¡äº†ï¼‰ æ”»å‡»è€…æ„å»ºç‰¹æ®ŠURLï¼Œé‡Œé¢åŒ…å«æ¶æ„ä»£ç  å½“ç”¨æˆ·æ‰“å¼€æ­¤URLæ—¶ï¼Œç½‘ç«™çš„æœåŠ¡ç«¯å°†æ¶æ„ä»£ç ä»ä¸­å–å‡ºï¼Œå¹¶ä¸”æ‹¼æ¥åœ¨HTMLè¿”å›ç»™æµè§ˆå™¨ï¼ˆè¿™åº”è¯¥å±äºåç«¯æ¸²æŸ“èŒƒå›´ï¼‰ æ¶æ„ä»£ç è¢«æµè§ˆå™¨æ‰§è¡Œï¼Œç„¶åå°†ç”¨æˆ·æ•°æ®å‘é€ç»™æ”»å‡»è€…ç½‘ç«™ DOMå‹XSSï¼ˆæ„Ÿè§‰å’Œåå°„å‹XSSå¾ˆåƒï¼Œåªä¸è¿‡è¿™ä¸ªæ˜¯å±äºJavaScriptçš„å®‰å…¨æ¼æ´ï¼ˆæµè§ˆå™¨çš„DOMè§£æï¼‰ï¼Œåå°„å‹XSSæ—¶å±äºæœåŠ¡ç«¯çš„å®‰å…¨æ¼æ´ï¼‰ï¼Œæ‰€ä»¥é˜²èŒƒDOMå‹XSSæ˜¯å‰ç«¯çš„è´£ä»» åŒæ ·çš„ï¼Œæ”»å‡»è€…æ„é€ ç‰¹æ®ŠURLï¼Œå…¶ä¸­åŒ…å«æ¶æ„ä»£ç  ç”¨æˆ·æ‰“å¼€åï¼Œæµè§ˆå™¨è§£æï¼ŒJavaScriptå–å‡ºURLç„¶åæ‰§è¡Œ æ¶æ„ä»£ç è¢«æµè§ˆå™¨æ‰§è¡Œï¼Œç„¶åå°†ç”¨æˆ·æ•°æ®å‘é€ç»™æ”»å‡»è€…ç½‘ç«™ å®é™…æ¡ˆä¾‹ï¼š &lt;a href\\=\"javascript:alert('xss')\"\\>click me&lt;/a\\> &lt;p onclick=\"alert('xss')\">this is a text&lt;/p> &lt;img src=\"xxx.com/test.jpg\" onerror=\"alert('xss')\"/> ç”šè‡³æ˜¯CSS &lt;div style=\"background:url(javacript:alert('xss'))\"> é˜²èŒƒXSSå¸¸ç”¨çš„é˜²èŒƒæ‰‹æ®µï¼š httpOnly: åœ¨ cookie ä¸­è®¾ç½® HttpOnly å±æ€§åï¼Œjsè„šæœ¬å°†æ— æ³•è¯»å–åˆ° cookie ä¿¡æ¯ã€‚ è¾“å…¥è¿‡æ»¤: ä¸€èˆ¬æ˜¯ç”¨äºå¯¹äºè¾“å…¥æ ¼å¼çš„æ£€æŸ¥ï¼Œä¾‹å¦‚ï¼šé‚®ç®±ï¼Œç”µè¯å·ç ï¼Œç”¨æˆ·åï¼Œå¯†ç â€¦â€¦ç­‰ï¼ŒæŒ‰ç…§è§„å®šçš„æ ¼å¼è¾“å…¥ã€‚ è½¬ä¹‰ HTML: å¦‚æœæ‹¼æ¥ HTML æ˜¯å¿…è¦çš„ï¼Œå°±éœ€è¦å¯¹äºå¼•å·ï¼Œå°–æ‹¬å·ï¼Œæ–œæ è¿›è¡Œè½¬ä¹‰ï¼ˆæ¯”å¦‚ å°† &gt; è½¬è¯‘ä¸º &amp;gt;ï¼‰ æ·»åŠ ç™½åå•ï¼šå¯¹äºæ˜¾ç¤ºå¯Œæ–‡æœ¬æ¥è¯´ï¼Œä»¥ä¸Šæ–¹æ³•å¯èƒ½ä¼šå°†éœ€è¦çš„æ ¼å¼ä¹Ÿè¿‡æ»¤æ‰ï¼Œè¿™æ—¶æˆ‘ä»¬å¯ä»¥æ·»åŠ ç™½åå•çš„æ–¹å¼ï¼Œå…¶å®ä¹Ÿå°±æ˜¯å¯¹åŒ¹é…åˆ°çš„å­—æ®µè¿›è¡Œå¤„ç† é¢„é˜²å­˜å‚¨å‹XSSå’Œåå°„å‹XSSæ”»å‡»ï¼š çº¯å‰ç«¯æ¸²æŸ“ï¼ˆè¿™æ ·å°±ä¸ä¼šæ‹¼æ¥htmlè¿”å›äº†ï¼‰ åŒä¸Šé¢å¸¸ç”¨çš„é˜²èŒƒæ‰‹æ®µä¸€æ ·çš„è½¬ä¹‰html é¢„é˜²DOMå‹XSSæ”»å‡» DOMå‹XSSæ”»å‡»å®é™…ä¸Šæ˜¯JavaScriptä»£ç æœ¬èº«ä¸å¤Ÿä¸¥è°¨ï¼Œ .innerHTMLã€.outerHTMLã€document.write() æ—¶è¦ç‰¹åˆ«å°å¿ƒï¼Œä¸è¦æŠŠä¸å¯ä¿¡çš„æ•°æ®ä½œä¸º HTML æ’åˆ°é¡µé¢ä¸Šï¼Œè€Œåº”å°½é‡ä½¿ç”¨ .textContentã€.setAttribute() ç­‰ã€‚ï¼ˆå°½é‡é¿å…è¿™ç§ç›´æ¥æ’å…¥å¼çš„å†™æ³•ï¼‰ Vueçš„ v-htmlä¹Ÿå®¹æ˜“å¯¼è‡´xssæ”»å‡»ï¼ˆåŸç†ä¹Ÿæ˜¯innerHTMLï¼‰ï¼Œä¸æ­¤åŒæ—¶ï¼Œv-htmlä¹Ÿä¼šæ›¿æ¢æ‰æ ‡ç­¾å†…éƒ¨å­å…ƒç´ ï¼Œæ‰€ä»¥ v-htmlå°½é‡åˆ«ç”¨ å‡å°‘eval()çš„ä½¿ç”¨ æ·»åŠ ç™½åå•é˜²èŒƒXSShttps://jsxss.com/zh/index.html ä¸€ä¸ªæ·»åŠ ç™½åå•è¿›è¡Œè¿‡æ»¤é˜²èŒƒXSSæ”»å‡»çš„å·¥å…·ï¼Œå®ƒçš„åå­—ä¹Ÿå«åšXSS å®‰è£…å’Œä½¿ç”¨ $ npm install xss --save nodeç«¯ä½¿ç”¨ var xss = require('xss'); console.log(xss('&lt;a href=\"#\" onclick=\"alert(/xss/)\">click me&lt;/a>')); æµè§ˆå™¨ç«¯ä½¿ç”¨ console.log(filterXSS('&lt;a href=\"#\" onclick=\"alert(/xss/)\">click me&lt;/a>')); å½“ç„¶é™¤äº†XSSè¿‡æ»¤å·¥å…·ï¼Œè¿˜æœ‰Sanitizerè¿™ä¸ªAPIï¼Œå¯ä»¥é…ç½®ç™½åå•ï¼Œé»‘åå•ï¼Œä½†å…¼å®¹æ€§å¾ˆå·® 1.5 CSPå†…å®¹å®‰å…¨ç­–ç•¥( CSP ) å†…å®¹å®‰å…¨ç­–ç•¥ (CSP) æ˜¯ä¸€ä¸ªé¢å¤–çš„å®‰å…¨å±‚ï¼Œç”¨äºæ£€æµ‹å¹¶å‰Šå¼±æŸäº›ç‰¹å®šç±»å‹çš„æ”»å‡»ï¼ŒåŒ…æ‹¬è·¨ç«™è„šæœ¬ (XSS (en-US)) å’Œæ•°æ®æ³¨å…¥æ”»å‡»ç­‰ é€šè¿‡ç¬¬ä¸‰æ–¹æ³¨å…¥ä»£ç ï¼Œæµè§ˆå™¨æ— æ³•è¯†åˆ«å“ªä¸ªç½‘ç«™okå“ªä¸ªç½‘ç«™ä¸okï¼Œè€Œcspå°±æ˜¯æ¥å®šä¹‰HTTP æ ‡å¤´ï¼Œå®ƒå…è®¸æ‚¨åˆ›å»ºå—ä¿¡ä»»å†…å®¹æ¥æºçš„å…è®¸åˆ—è¡¨ï¼Œå¹¶æŒ‡ç¤ºæµè§ˆå™¨ä»…æ‰§è¡Œæˆ–å‘ˆç°æ¥è‡ªè¿™äº›æ¥æºçš„èµ„æºã€‚å³ä½¿æ”»å‡»è€…å¯ä»¥æ‰¾åˆ°æ³¨å…¥è„šæœ¬çš„æ¼æ´ï¼Œè¯¥è„šæœ¬ä¹Ÿä¸ä¼šåŒ¹é…ç™½åå•ï¼Œå› æ­¤ä¸ä¼šè¢«æ‰§è¡Œã€‚ CSP æœ¬è´¨ä¸Šå°±æ˜¯å»ºç«‹ç™½åå•ï¼Œå¼€å‘è€…æ˜ç¡®å‘Šè¯‰æµè§ˆå™¨å“ªäº›å¤–éƒ¨èµ„æºå¯ä»¥åŠ è½½å’Œæ‰§è¡Œã€‚æˆ‘ä»¬åªéœ€è¦é…ç½®è§„åˆ™ï¼Œå¦‚ä½•æ‹¦æˆªæ˜¯ç”±æµè§ˆå™¨è‡ªå·±å®ç°çš„ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡è¿™ç§æ–¹å¼æ¥å°½é‡å‡å°‘ XSS æ”»å‡»ã€‚ ä½¿ç”¨ï¼ˆå¼€å¯ CSPï¼‰ è®¾ç½® HTTP Header ä¸­çš„ Content-Security-Policyï¼ˆæœ‰æ—¶ä½ ä¼šçœ‹åˆ°ä¸€äº›å…³äºX-Content-Security-Policyå¤´éƒ¨çš„ææ³•, é‚£æ˜¯æ—§ç‰ˆæœ¬ï¼Œä½ æ— é¡»å†å¦‚æ­¤æŒ‡å®šå®ƒï¼‰ Content-Security-Policy: policy policyå‚æ•°æ˜¯ä¸€ä¸ªåŒ…å«äº†å„ç§æè¿°ä½ çš„CSPç­–ç•¥æŒ‡ä»¤çš„å­—ç¬¦ä¸²ã€‚ ä½¿ç”¨æ¡ˆä¾‹ï¼š ç¤ºä¾‹ 1 ä¸€ä¸ªç½‘ç«™ç®¡ç†è€…æƒ³è¦æ‰€æœ‰å†…å®¹å‡æ¥è‡ªç«™ç‚¹çš„åŒä¸€ä¸ªæº (ä¸åŒ…æ‹¬å…¶å­åŸŸå) Content-Security-Policy: default-src &#39;self&#39;ç¤ºä¾‹ 2 ä¸€ä¸ªç½‘ç«™ç®¡ç†è€…å…è®¸å†…å®¹æ¥è‡ªä¿¡ä»»çš„åŸŸååŠå…¶å­åŸŸå (åŸŸåä¸å¿…é¡»ä¸CSPè®¾ç½®æ‰€åœ¨çš„åŸŸåç›¸åŒ) Content-Security-Policy: default-src &#39;self&#39; *.trusted.comç¤ºä¾‹ 3 ä¸€ä¸ªçº¿ä¸Šé“¶è¡Œç½‘ç«™çš„ç®¡ç†è€…æƒ³è¦ç¡®ä¿ç½‘ç«™çš„æ‰€æœ‰å†…å®¹éƒ½è¦é€šè¿‡SSLæ–¹å¼è·å–ï¼Œä»¥é¿å…æ”»å‡»è€…çªƒå¬ç”¨æˆ·å‘å‡ºçš„è¯·æ±‚ã€‚ Content-Security-Policy: default-src https://onlinebanking.jumbobank.comè¯¥æœåŠ¡å™¨ä»…å…è®¸é€šè¿‡HTTPSæ–¹å¼å¹¶ä»…ä»onlinebanking.jumbobank.comåŸŸåæ¥è®¿é—®æ–‡æ¡£ã€‚ ç¤ºä¾‹ 4 Content-Security-Policy: script-src &#39;self&#39;; object-src &#39;none&#39;; style-src cdn.example.org third-party.org; child-src https: è„šæœ¬ï¼šåªä¿¡ä»»å½“å‰åŸŸå &lt;object&gt;æ ‡ç­¾ï¼šä¸ä¿¡ä»»ä»»ä½•URLï¼Œå³ä¸åŠ è½½ä»»ä½•èµ„æº æ ·å¼è¡¨ï¼šåªä¿¡ä»»cdn.example.orgå’Œthird-party.org æ¡†æ¶ï¼ˆframeï¼‰ï¼šå¿…é¡»ä½¿ç”¨HTTPSåè®®åŠ è½½ å…¶ä»–èµ„æºï¼šæ²¡æœ‰é™åˆ¶ æ¯ä¸ªé™åˆ¶é€‰é¡¹å¯ä»¥è®¾ç½®ä»¥ä¸‹å‡ ç§å€¼ï¼Œè¿™äº›å€¼å°±æ„æˆäº†ç™½åå•ã€‚ ä¸»æœºåï¼šexample.orgï¼Œhttps://example.com:443 è·¯å¾„åï¼šexample.org/resources/js/ é€šé…ç¬¦ï¼š*.example.orgï¼Œ*://*.example.com:*ï¼ˆè¡¨ç¤ºä»»æ„åè®®ã€ä»»æ„å­åŸŸåã€ä»»æ„ç«¯å£ï¼‰ åè®®åï¼šhttps:ã€data: å…³é”®å­—&#39;self&#39;ï¼šå½“å‰åŸŸåï¼Œéœ€è¦åŠ å¼•å· å…³é”®å­—&#39;none&#39;ï¼šç¦æ­¢åŠ è½½ä»»ä½•å¤–éƒ¨èµ„æºï¼Œéœ€è¦åŠ å¼•å· æ›´å¤šå¯ä»¥æ”¶çœ‹é˜®ä¸€å³°è€å¸ˆçš„æ•™ç¨‹http://www.ruanyifeng.com/blog/2016/09/csp.html åœ¨HTMLçš„æ”¾åˆ°headåŒºåŸŸè®¾ç½® meta æ ‡ç­¾çš„æ–¹å¼ &lt;meta http-equiv=&quot;Content-Security-Policy&quot;&gt; æˆ–è€…ç›´æ¥ &lt;meta http-equiv=\"Content-Security-Policy\" content=\"default-src https://cdn.example.net; child-src 'none'; object-src 'none'\"> è¿™ä¸èƒ½ç”¨äºframe-ancestorsã€report-uriæˆ–sandboxã€‚ å„é¡¹æ”¿ç­–ç¤ºä¾‹ï¼š script-srcå®ƒæ˜¯ä¸€ä¸ªæŒ‡ä»¤ï¼Œç”¨äºæ§åˆ¶ç‰¹å®šé¡µé¢çš„ä¸€ç»„ä¸è„šæœ¬ç›¸å…³çš„æƒé™ Content-Security-Policy: script-src &#39;self&#39; https://apis.google.comè™½ç„¶è„šæœ¬èµ„æºæ˜¯æœ€æ˜æ˜¾çš„å®‰å…¨é£é™©ï¼Œä½† CSP æä¾›äº†ä¸€ç»„ä¸°å¯Œçš„ç­–ç•¥æŒ‡ä»¤ï¼Œå¯ä»¥å¯¹å…è®¸åŠ è½½é¡µé¢çš„èµ„æºè¿›è¡Œç›¸å½“ç²¾ç»†çš„æ§åˆ¶ã€‚ è®©æˆ‘ä»¬å¿«é€Ÿæµè§ˆå…¶ä½™çš„èµ„æºæŒ‡ä»¤ã€‚ä¸‹é¢çš„åˆ—è¡¨ä»£è¡¨äº† 2çº§æŒ‡ä»¤çš„çŠ¶æ€ã€‚ 3 çº§è§„èŒƒå·²ç»å‘å¸ƒï¼Œä½†åœ¨ä¸»è¦æµè§ˆå™¨ä¸­åŸºæœ¬ä¸Šæ²¡æœ‰å®ç°ã€‚ base-urié™åˆ¶å¯ä»¥å‡ºç°åœ¨é¡µé¢&lt;base&gt;å…ƒç´ ä¸­çš„ URLã€‚ child-srcåˆ—å‡ºå·¥ä½œäººå‘˜å’ŒåµŒå…¥æ¡†æ¶å†…å®¹çš„ URLã€‚ä¾‹å¦‚ï¼šchild-src https://youtube.comå°†å¯ç”¨åµŒå…¥æ¥è‡ª YouTube ä½†ä¸æ¥è‡ªå…¶ä»–æ¥æºçš„è§†é¢‘ã€‚ connect-srcé™åˆ¶æ‚¨å¯ä»¥è¿æ¥çš„æ¥æºï¼ˆé€šè¿‡ XHRã€WebSockets å’Œ EventSourceï¼‰ã€‚ font-srcæŒ‡å®šå¯ä»¥æä¾›ç½‘ç»œå­—ä½“çš„æ¥æºã€‚è°·æ­Œçš„ç½‘ç»œå­—ä½“å¯ä»¥é€šè¿‡font-src https://themes.googleusercontent.com. form-action&lt;form&gt;åˆ—å‡ºä»æ ‡ç­¾æäº¤çš„æœ‰æ•ˆç«¯ç‚¹ã€‚ frame-ancestorsæŒ‡å®šå¯ä»¥åµŒå…¥å½“å‰é¡µé¢çš„æ¥æºã€‚è¯¥æŒ‡ä»¤é€‚ç”¨äº&lt;frame&gt;ã€&lt;iframe&gt;ã€&lt;embed&gt;å’Œ&lt;applet&gt;æ ‡ç­¾ã€‚è¯¥æŒ‡ä»¤ä¸èƒ½åœ¨&lt;meta&gt;æ ‡ç­¾ä¸­ä½¿ç”¨ï¼Œä»…é€‚ç”¨äºé HTML èµ„æºã€‚ frame-srcåœ¨çº§åˆ« 2 ä¸­å·²å¼ƒç”¨ï¼Œä½†åœ¨çº§åˆ« 3 ä¸­æ¢å¤ã€‚å¦‚æœä¸å­˜åœ¨ï¼Œå®ƒä»ä¼šchild-srcåƒä»¥å‰ä¸€æ ·å›é€€ã€‚ img-srcå®šä¹‰å¯ä»¥åŠ è½½å›¾åƒçš„æ¥æºã€‚ media-srcé™åˆ¶å…è®¸ä¼ é€è§†é¢‘å’ŒéŸ³é¢‘çš„æ¥æºã€‚ object-srcå…è®¸æ§åˆ¶ Flash å’Œå…¶ä»–æ’ä»¶ã€‚ â€¦.. é»˜è®¤æƒ…å†µä¸‹ï¼ŒæŒ‡ä»¤æ˜¯å®Œå…¨å¼€æ”¾çš„ã€‚å¦‚æœæ‚¨æ²¡æœ‰ä¸ºæŒ‡ä»¤è®¾ç½®ç‰¹å®šç­–ç•¥ï¼Œæ¯”å¦‚è¯´font-srcï¼Œé‚£ä¹ˆé»˜è®¤æƒ…å†µä¸‹ï¼Œè¯¥æŒ‡ä»¤çš„è¡Œä¸ºå°±åƒæ‚¨æŒ‡å®š*ä¸ºæœ‰æ•ˆæºä¸€æ ·ï¼ˆä¾‹å¦‚ï¼Œæ‚¨å¯ä»¥ä»ä»»ä½•åœ°æ–¹åŠ è½½å­—ä½“ï¼Œæ²¡æœ‰é™åˆ¶ï¼‰ã€‚ æ‚¨å¯ä»¥é€šè¿‡æŒ‡å®šdefault-srcæŒ‡ä»¤æ¥è¦†ç›–æ­¤é»˜è®¤è¡Œä¸ºã€‚è¯¥æŒ‡ä»¤å®šä¹‰äº†æ‚¨æœªæŒ‡å®šçš„å¤§å¤šæ•°æŒ‡ä»¤çš„é»˜è®¤å€¼ã€‚é€šå¸¸ï¼Œè¿™é€‚ç”¨äºä»»ä½•ä»¥ . ç»“å°¾çš„æŒ‡ä»¤-srcã€‚å¦‚æœdefault-srcè®¾ç½®ä¸ºhttps://example.comï¼Œå¹¶ä¸”æ‚¨æœªèƒ½æŒ‡å®šfont-srcæŒ‡ä»¤ï¼Œé‚£ä¹ˆæ‚¨å¯ä»¥ä» åŠ è½½å­—ä½“https://example.comï¼Œè€Œå…¶ä»–ä»»ä½•åœ°æ–¹éƒ½æ— æ³•åŠ è½½ã€‚æˆ‘ä»¬ä»…script-srcåœ¨å‰é¢çš„ç¤ºä¾‹ä¸­æŒ‡å®šï¼Œè¿™æ„å‘³ç€å¯ä»¥ä»ä»»ä½•æ¥æºåŠ è½½å›¾åƒã€å­—ä½“ç­‰ã€‚ æ›´å¤šå¯ä»¥çœ‹ https://web.dev/csp/ï¼ˆå¯æƒœè¦ç¿»å¢™ï¼‰ å…¶ä»– æ‚¨å°†åœ¨ç½‘ç»œä¸Šçš„å„ç§æ•™ç¨‹ä¸­çœ‹åˆ°X-WebKit-CSPå’ŒX-Content-Security-Policyæ ‡é¢˜ã€‚å±•æœ›æœªæ¥ï¼Œæ‚¨åº”è¯¥å¿½ç•¥è¿™äº›å¸¦å‰ç¼€çš„æ ‡å¤´ã€‚ç°ä»£æµè§ˆå™¨ï¼ˆIE é™¤å¤–ï¼‰æ”¯æŒæ— å‰ç¼€Content-Security-Policyæ ‡å¤´ã€‚é‚£æ˜¯æ‚¨åº”è¯¥ä½¿ç”¨çš„æ ‡é¢˜ã€‚ CSPå¯¹äºå†…è”ä»£ç æœ‰æ‰€é™åˆ¶ï¼Œä¸€èˆ¬æ¥è¯´å†…è”ä»£ç è¢«è®¤ä¸ºæ˜¯æœ‰å®³çš„ï¼šCSP æ˜¯åŸºäºå…è®¸åˆ—è¡¨æ¥æºçš„ï¼Œå› ä¸ºè¿™æ˜¯ä¸€ç§æŒ‡ç¤ºæµè§ˆå™¨å°†ç‰¹å®šèµ„æºé›†è§†ä¸ºå¯æ¥å—å¹¶æ‹’ç»å…¶ä½™èµ„æºçš„æ˜ç¡®æ–¹å¼ã€‚ç„¶è€Œï¼ŒåŸºäºæ¥æºçš„ç™½åå•å¹¶ä¸èƒ½è§£å†³ XSS æ”»å‡»å¸¦æ¥çš„æœ€å¤§å¨èƒï¼šå†…è”è„šæœ¬æ³¨å…¥ã€‚å¦‚æœæ”»å‡»è€…å¯ä»¥æ³¨å…¥ç›´æ¥åŒ…å«æŸäº›æ¶æ„è´Ÿè½½ ( &lt;script&gt;sendMyDataToEvilDotCom()&lt;/script&gt;) çš„è„šæœ¬æ ‡è®°ï¼Œåˆ™æµè§ˆå™¨æ²¡æœ‰å°†å…¶ä¸åˆæ³•çš„å†…è”è„šæœ¬æ ‡è®°åŒºåˆ†å¼€æ¥çš„æœºåˆ¶ã€‚CSP é€šè¿‡å®Œå…¨ç¦æ­¢å†…è”è„šæœ¬è§£å†³äº†è¿™ä¸ªé—®é¢˜ï¼šè¿™æ˜¯å”¯ä¸€å¯ä»¥ç¡®å®šçš„æ–¹æ³•ã€‚ æ¯”å¦‚ä»¥ä¸‹ä»£ç  noï¼noï¼noï¼ &lt;script> function doAmazingThings() { alert('YOU AM AMAZING!'); } &lt;/script> &lt;button onclick='doAmazingThings();'>Am I amazing?&lt;/button> å¦‚æœä¸å¾—ä¸ä½¿ç”¨å†…è”ä»£ç ï¼ŒCSP çº§åˆ« 2 å…è®¸æ‚¨ä½¿ç”¨åŠ å¯†éšæœºæ•°ï¼ˆä½¿ç”¨ä¸€æ¬¡çš„æ•°å­—ï¼‰æˆ–å“ˆå¸Œå°†ç‰¹å®šçš„å†…è”è„šæœ¬æ·»åŠ åˆ°å…è®¸åˆ—è¡¨ï¼Œä»è€Œä¸ºå†…è”è„šæœ¬æä¾›å‘åå…¼å®¹æ€§ã€‚è™½ç„¶è¿™å¯èƒ½å¾ˆéº»çƒ¦ï¼Œä½†å®ƒåœ¨ç´§è¦å…³å¤´å¾ˆæœ‰ç”¨ã€‚ï¼ˆhttps://web.dev/csp/ï¼‰ å‡è®¾æ‚¨è¿è¡Œä¸€ä¸ªé“¶è¡Œç½‘ç«™ï¼Œå¹¶å¸Œæœ›ç¡®ä¿åªæœ‰æ‚¨è‡ªå·±ç¼–å†™çš„é‚£äº›èµ„æºå¯ä»¥è¢«åŠ è½½ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä»ç»å¯¹é˜»æ­¢æ‰€æœ‰å†…å®¹çš„é»˜è®¤ç­–ç•¥å¼€å§‹ ( default-src &#39;none&#39;)ï¼Œç„¶åä»é‚£é‡Œå¼€å§‹æ„å»ºã€‚ å‡è®¾é“¶è¡Œä»ä½äºçš„ CDN åŠ è½½æ‰€æœ‰å›¾åƒã€æ ·å¼å’Œè„šæœ¬https://cdn.mybank.netï¼Œå¹¶é€šè¿‡ XHR è¿æ¥åˆ°https://api.mybank.com/ä»¥æå–å„ç§æ•°æ®ä½ã€‚ä½¿ç”¨æ¡†æ¶ï¼Œä½†ä»…ç”¨äºç«™ç‚¹æœ¬åœ°çš„é¡µé¢ï¼ˆæ— ç¬¬ä¸‰æ–¹æ¥æºï¼‰ã€‚ç½‘ç«™ä¸Šæ²¡æœ‰ Flashï¼Œæ²¡æœ‰å­—ä½“ï¼Œæ²¡æœ‰é¢å¤–å†…å®¹ã€‚æˆ‘ä»¬å¯ä»¥å‘é€çš„æœ€ä¸¥æ ¼çš„ CSP æ ‡å¤´æ˜¯è¿™æ ·çš„ï¼š Content-Security-Policy: default-src &#39;none&#39;; script-src https://cdn.mybank.net; style-src https://cdn.mybank.net; img-src https://cdn.mybank.net; connect-src https://api.mybank.com; child-src &#39;self&#39; ä½œç”¨æ•ˆæœCSP çš„ä¸»è¦ç›®æ ‡æ˜¯å‡å°‘å’ŒæŠ¥å‘Š XSS æ”»å‡» ï¼ŒXSS æ”»å‡»åˆ©ç”¨äº†æµè§ˆå™¨å¯¹äºä»æœåŠ¡å™¨æ‰€è·å–çš„å†…å®¹çš„ä¿¡ä»» CSPé€šè¿‡æŒ‡å®šæœ‰æ•ˆåŸŸâ€”â€”å³æµè§ˆå™¨è®¤å¯çš„å¯æ‰§è¡Œè„šæœ¬çš„æœ‰æ•ˆæ¥æºâ€”â€”ä½¿æœåŠ¡å™¨ç®¡ç†è€…æœ‰èƒ½åŠ›å‡å°‘æˆ–æ¶ˆé™¤XSSæ”»å‡»æ‰€ä¾èµ–çš„è½½ä½“ã€‚ä¸€ä¸ªCSPå…¼å®¹çš„æµè§ˆå™¨å°†ä¼šä»…æ‰§è¡Œä»ç™½åå•åŸŸè·å–åˆ°çš„è„šæœ¬æ–‡ä»¶ï¼Œå¿½ç•¥æ‰€æœ‰çš„å…¶ä»–è„šæœ¬ 2.CSRFä»€ä¹ˆæ˜¯CSRFCSRFæ˜¯ä¸€ç§è·¨ç«™è¯·æ±‚ä¼ªé€ ï¼Œä¹Ÿè¢«ç§°ä¸º one-click-attack æˆ–è€… session riding ä¸‹é¢çš„å›¾æºè‡ªè¿™ä¸ªå¤§ä½¬ ï¼š https://www.cnblogs.com/hyddd/archive/2009/04/09/1432744.html ï¼ˆéšä¾¿ç‚¹å¼€ï¼Œæ”¾å¿ƒç»å¯¹ä¸æ˜¯XSSæˆ–è€…CSRF ï¼Œæ‰‹åŠ¨ç‹—å¤´ï¼‰ è§¦å‘æ¡ä»¶ï¼š ç”¨æˆ·ç™»å½•å¹¶ä¸”ä¿¡ä»»ç½‘ç«™Aï¼Œå¹¶äº§ç”Ÿcookie æœªç™»å‡ºAçš„æƒ…å†µä¸‹ï¼Œè®¿é—®ç½‘ç«™Bï¼ˆæ­¤ç½‘ç«™è™½ç„¶æ˜¯æ”»å‡»ç½‘ç«™ï¼Œä½†æ˜¯å®ƒå¯èƒ½æ˜¯ä¸€ä¸ªå­˜åœ¨å…¶ä»–æ¼æ´çš„å¯ä¿¡ä»»çš„ç»å¸¸è¢«äººè®¿é—®çš„ç½‘ç«™ï¼‰ ï¼ˆæ„Ÿè§‰é€šä¿—æ¥è®²å°±æ˜¯ï¼Œä½ åœ¨å­˜æ”¾é‡è¦ä¿¡æ¯çš„ç½‘ç«™Aç™»å½•åï¼Œæ²¡æœ‰å…³é—­ ä¸” æœ¬åœ°çš„cookieæ²¡æœ‰è¿‡æœŸï¼Œç™»é™†äº†å¦å¤–ä¸€ä¸ªï¼ˆæ”»å‡»ï¼‰ç½‘ç«™ï¼Œå®ƒå°±ä¼šå·ä½ çš„cookieï¼Œå†’å……ä½ æ¥æ“ä½œä½ ç½‘ç«™Açš„è´¦å·ï¼‰ å¸¸è§ç±»å‹ Getç±»å‹çš„CSRF POSTç±»å‹çš„CSRF é“¾æ¥ç±»å‹çš„CSRFï¼Œä¸Šé¢ä¸¤ç§æ‰“å¼€ç½‘é¡µå°±ä¸­æ‹›ï¼Œè¿™ç§è¦ç‚¹å‡»çš„ï¼Œæ¯”è¾ƒlow å†æ¥ä¸€ä¸ªç”ŸåŠ¨çš„ä¾‹å­è®¤è¯†CSRFï¼š ç”¨æˆ·æ­£åœ¨ç™»é™†é“¶è¡Œç½‘é¡µï¼ŒåŒæ—¶ç™»é™†äº†æ”»å‡»è€…çš„ç½‘é¡µï¼Œå¹¶ä¸”é“¶è¡Œç½‘é¡µæœªå¯¹csrfæ”»å‡»è¿›è¡Œé˜²æŠ¤ã€‚ æ”»å‡»è€…å°±å¯ä»¥åœ¨ç½‘é¡µæ”¾ä¸€ä¸ªè¡¨å•ï¼Œè¯¥è¡¨å•æäº¤srcä¸ºhttp://www.bank.com/api/transferï¼Œbodyä¸ºcount=1000&amp;to=Tomã€‚ å€˜è‹¥æ˜¯session+cookieï¼Œç”¨æˆ·æ‰“å¼€ç½‘é¡µçš„æ—¶å€™å°±å·²ç»è½¬ç»™Tom1000å…ƒäº†ï¼ˆæ­¤æ—¶cookieä¼šæ ¹æ®pathå’Œdomainå‘ç°å½“å‰è®¿é—®åŸŸåå’Œé“¶è¡Œç›¸åŒï¼Œåˆ™æºå¸¦cookieä¿¡æ¯ï¼‰ï¼Œç”±æ­¤å½¢æˆCSRFæ”»å‡» é˜²å¾¡CSRF éªŒè¯ç ï¼›å¼ºåˆ¶ç”¨æˆ·å¿…é¡»ä¸åº”ç”¨è¿›è¡Œäº¤äº’ï¼Œæ‰èƒ½å®Œæˆæœ€ç»ˆè¯·æ±‚ã€‚æ­¤ç§æ–¹å¼èƒ½å¾ˆå¥½çš„éåˆ¶ csrfï¼Œä½†æ˜¯ç”¨æˆ·ä½“éªŒæ¯”è¾ƒå·® Referer checkï¼šè¯·æ±‚æ¥æºé™åˆ¶ï¼Œå³åŒæºæ£€æµ‹ï¼Œæ­¤ç§æ–¹æ³•æˆæœ¬æœ€ä½ï¼Œä½†æ˜¯å¹¶ä¸èƒ½ä¿è¯ 100% æœ‰æ•ˆï¼Œå› ä¸ºæœåŠ¡å™¨å¹¶ä¸æ˜¯ä»€ä¹ˆæ—¶å€™éƒ½èƒ½å–åˆ° Refererï¼Œè€Œä¸”ä½ç‰ˆæœ¬çš„æµè§ˆå™¨å­˜åœ¨ä¼ªé€  Referer çš„é£é™©ã€‚ tokenï¼štoken éªŒè¯çš„ CSRF é˜²å¾¡æœºåˆ¶æ˜¯å…¬è®¤æœ€åˆé€‚çš„æ–¹æ¡ˆã€‚è‹¥ç½‘ç«™åŒæ—¶å­˜åœ¨ XSS æ¼æ´çš„æ—¶å€™ï¼Œè¿™ä¸ªæ–¹æ³•ä¹Ÿæ˜¯ç©ºè°ˆï¼Œå› ä¸ºXSSæ”»å‡»æœ‰å¯èƒ½æ³„éœ²Token * - * 3.åŠ«æŒDNSåŠ«æŒ DNS ï¼š åŸŸå -&gt; ipåœ°å€ ï¼Œè¿›è¡ŒåŸŸåè§£æçš„æœåŠ¡å™¨ DNSåŠ«æŒåˆç§°åŸŸååŠ«æŒ,æ˜¯æŒ‡é€šè¿‡æŸäº›æ‰‹æ®µå–å¾—æŸåŸŸåçš„è§£ææ§åˆ¶æƒï¼Œä¿®æ”¹æ­¤åŸŸåçš„è§£æç»“æœï¼Œå¯¼è‡´å¯¹è¯¥åŸŸåçš„è®¿é—®ç”±åŸIPåœ°å€è½¬å…¥åˆ°ä¿®æ”¹åçš„æŒ‡å®šIPï¼Œå…¶ç»“æœå°±æ˜¯å¯¹ç‰¹å®šçš„ç½‘å€ä¸èƒ½è®¿é—®æˆ–è®¿é—®çš„æ˜¯å‡ç½‘å€ã€‚ DNSåŠ«æŒå…¶å®å¹¶ä¸æ˜¯çœŸçš„â€œé»‘æ‰â€äº†å¯¹æ–¹çš„ç½‘ç«™ï¼Œè€Œæ˜¯å†’åé¡¶æ›¿ã€æ‹›æ‘‡æ’éª—ç½¢äº† æ¡ˆä¾‹ åœ¨æŸ¥æ‰¾æœ¬æœºç³»ç»Ÿæ˜¯å¦ç¼“å­˜ipåœ°å€æ—¶ï¼Œå¯èƒ½ç¢°åˆ°é»‘å®¢è®¾ç½®ç»‘å®šå¥½çš„è§£æipï¼ˆhostæ–‡ä»¶ï¼‰ï¼Œä½¿å¾—æˆ‘ä»¬åˆ°è¾¾äº†ä¸€ä¸ªé”™è¯¯çš„ipåœ°å€ï¼ˆæœ¬åœ°DNSåŠ«æŒï¼‰; äº¦æˆ–è€…æ˜¯åƒã€Šå·´è¥¿é“¶è¡Œé’“é±¼äº‹ä»¶ã€‹ï¼Œé»‘å®¢åˆ©ç”¨D-Linkè·¯ç”±å™¨çš„æ¼æ´ï¼Œæ›´æ”¹å¯¹åº”çš„DNSé…ç½®ï¼Œé‡æ–°å®šå‘åˆ°é»‘å®¢è‡ªå·±æ­å»ºçš„æ¶æ„DNSæœåŠ¡å™¨ä¸Šï¼ˆDNSè§£æè·¯å¾„åŠ«æŒï¼‰ ï¼ˆDNSæœåŠ¡å™¨çš„IPåœ°å€ï¼Œæœ‰å¯èƒ½æ˜¯åŠ¨æ€çš„ï¼Œæ¯æ¬¡ä¸Šç½‘æ—¶ç”±ç½‘å…³åˆ†é…ï¼Œè¿™å«åšDHCPæœºåˆ¶ï¼›ä¹Ÿæœ‰å¯èƒ½æ˜¯äº‹å…ˆæŒ‡å®šçš„å›ºå®šåœ°å€ã€‚Linuxç³»ç»Ÿé‡Œé¢ï¼ŒDNSæœåŠ¡å™¨çš„IPåœ°å€ä¿å­˜åœ¨/etc/resolv.confæ–‡ä»¶ã€‚ï¼‰ é˜²æ­¢DNSåŠ«æŒ ç½‘ç»œå±‚é¢ï¼š æ‰‹åŠ¨ä¿®æ”¹DNS ä¿®æ”¹è·¯ç”±å¯†ç  åº”ç”¨å±‚é¢ï¼š å®‰è£…æ€æ¯’è½¯ä»¶ï¼Œé˜²å¾¡æœ¨é©¬ç—…æ¯’å’Œæ¶æ„è½¯ä»¶ï¼›å®šæœŸä¿®æ”¹è·¯ç”±å™¨ç®¡ç†è´¦å·å¯†ç å’Œæ›´æ–°å›ºä»¶ã€‚ æœ‰ç‚¹å¤æ‚ï¼Œå¯ä»¥ç½‘ä¸ŠæŸ¥è¯¢ï¼ˆæ³ªã€‚ã€‚ï¼‰ HTTPåŠ«æŒ ä½ DNSè§£æçš„åŸŸåçš„IPåœ°å€ä¸å˜ã€‚åœ¨å’Œç½‘ç«™äº¤äº’è¿‡ç¨‹ä¸­çš„åŠ«æŒäº†ä½ çš„è¯·æ±‚ã€‚åœ¨ç½‘ç«™å‘ç»™ä½ ä¿¡æ¯å‰å°±ç»™ä½ è¿”å›äº†è¯·æ±‚ã€‚ HTTPåŠ«æŒå¾ˆå¥½åˆ¤æ–­ï¼Œå½“å¹´æ­£å¸¸è®¿é—®ä¸€ä¸ªæ— å¹¿å‘Šçš„é¡µé¢æ—¶ï¼Œé¡µé¢ä¸Šå‡ºç°å¹¿å‘Šå¼¹çª—ï¼Œå…«æˆå°±æ˜¯è¿è¥å•†åŠ«æŒäº†HTTPã€‚ 4.SQLæ³¨å…¥æ”»å‡»ä»€ä¹ˆæ˜¯SQLæ³¨å…¥æ”»å‡»sqlä½œä¸ºä¸€ç§è§£é‡Šå‹è¯­è¨€ï¼ˆæ•°æ®åº“è¯­è¨€ï¼‰ï¼Œåœ¨è¿è¡Œæ—¶æ˜¯ç”±ä¸€ä¸ªè¿è¡Œæ—¶ç»„ä»¶è§£é‡Šè¯­è¨€ä»£ç å¹¶æ‰§è¡Œå…¶ä¸­åŒ…å«çš„æŒ‡ä»¤çš„è¯­è¨€ã€‚åŸºäºè¿™ç§æ‰§è¡Œæ–¹å¼ï¼Œäº§ç”Ÿäº†ä¸€ç³»åˆ—å«åšä»£ç æ³¨å…¥ï¼ˆcode injectionï¼‰çš„æ¼æ´ ç¨‹åºå‘˜åœ¨webå¼€å‘æ—¶ï¼Œæ²¡æœ‰è¿‡æ»¤æ•æ„Ÿå­—ç¬¦ï¼Œç»‘å®šå˜é‡ï¼Œå¯¼è‡´æ”»å‡»è€…å¯ä»¥é€šè¿‡sqlçµæ´»å¤šå˜çš„è¯­æ³•ï¼Œæ„é€ ç²¾å¿ƒå·§å¦™çš„è¯­å¥ï¼Œä¸æ‹©æ‰‹æ®µï¼Œè¾¾æˆç›®çš„ï¼Œæˆ–è€…é€šè¿‡ç³»ç»ŸæŠ¥é”™ï¼Œè¿”å›å¯¹è‡ªå·±æœ‰ç”¨çš„ä¿¡æ¯ã€‚ ä¸ªäººæ„Ÿè§‰æœ‰ç‚¹åƒXSSæ”»å‡»ï¼Œéƒ½æ˜¯åˆ©ç”¨è¯­è¨€æ¼æ´è¿›è¡Œä»£ç æ³¨å…¥ ç±»ä¼¼äºåˆæˆè¿™ç§æ°¸çœŸçš„è¯­å¥ï¼Œè®©é»‘å®¢ç”¨æˆ·ç™»é™†æˆåŠŸ select * from users where username=&#39;&#39; or 1=1 é˜²å¾¡SQLæ³¨å…¥1ã€é¢„ç¼–è¯‘ï¼Œåœ¨SQLæ˜ å°„æ–‡ä»¶ä¸­å°½é‡ä½¿ç”¨#æŒ‡ç¤ºç¬¦æ ‡è¯†å‚æ•°ä½ç½®ï¼Œé¿å…ä½¿ç”¨$ã€‚ 2ã€ç¡®è®¤æ¯ç§æ•°æ®çš„ç±»å‹ï¼Œæ¯”å¦‚æ˜¯æ•°å­—ï¼Œæ•°æ®åº“åˆ™å¿…é¡»ä½¿ç”¨intç±»å‹æ¥å­˜å‚¨ 3ã€è§„å®šæ•°æ®é•¿åº¦ï¼Œèƒ½åœ¨ä¸€å®šç¨‹åº¦ä¸Šé˜²æ­¢sqlæ³¨å…¥ 4ã€ä¸¥æ ¼é™åˆ¶æ•°æ®åº“æƒé™ï¼Œèƒ½æœ€å¤§ç¨‹åº¦å‡å°‘sqlæ³¨å…¥çš„å±å®³ 5ã€é¿å…ç›´æ¥å“åº”ä¸€äº›sqlå¼‚å¸¸ä¿¡æ¯ï¼Œsqlå‘ç”Ÿå¼‚å¸¸åï¼Œè‡ªå®šä¹‰å¼‚å¸¸è¿›è¡Œå“åº” 6ã€è¿‡æ»¤å‚æ•°ä¸­å«æœ‰çš„ä¸€äº›æ•°æ®åº“å…³é”®è¯ 5.åºåˆ—åŒ–ååºåˆ—åŒ–æ¼æ´ç®€å•æ¥è¯´ï¼Œåºåˆ—åŒ–å¯ä»¥ç†è§£ä¸ºå°±æ˜¯å°†å¯¹è±¡è½¬åŒ–ä¸ºå­—èŠ‚æµï¼Œå­—èŠ‚æµä¸­åŒ…æ‹¬è¿™ä¸ªå¯¹è±¡çš„æ•°æ®å’Œä¿¡æ¯ï¼Œåºåˆ—åŒ–å’Œååºåˆ—åŒ–ä¾¿äºç±»çš„æŒä¹…ä¿å­˜ï¼Œå¹¶ä¸”å¾ˆåˆ©äºç½‘ç»œä¼ è¾“ è€Œåœ¨ååºåˆ—åŒ–å¤„ç†ä¸­ï¼Œå¦‚æœæ”»å‡»è€…é€šè¿‡æ„å»ºæ¶æ„è¾“å…¥ï¼Œä½¿å¾—ååºåˆ—åŒ–äº§ç”Ÿéé¢„æœŸçš„ç±»æˆ–è€…å¯¹è±¡ï¼Œè¿™ä¸ªç±»æˆ–è€…å¯¹è±¡å°±æœ‰å¯èƒ½å¸¦æ¥ä»»æ„ä»£ç çš„æ‰§è¡Œ æ‰€ä»¥è¿™ä¸ªé—®é¢˜çš„æ ¹æºåœ¨äºï¼Œå­—èŠ‚æµè¿›è¡Œè¿˜åŸæ—¶ï¼Œå³ç”¨åˆ°ObjectInputStreamåœ¨ååºåˆ—åŒ–æ—¶ï¼Œæ²¡æœ‰å¯¹ç”Ÿæˆçš„å¯¹è±¡çš„ç±»å‹åšé™åˆ¶ 6.DDosæ”»å‡»DOSï¼šDenial of Serviceï¼Œæ‹’ç»æœåŠ¡ï¼Œé€šè¿‡å ç”¨ç½‘ç»œèµ„æºè®©å®ƒåº”æ¥ä¸æš‡ï¼Œä»è€Œæ‹’ç»æ­£å¸¸ä¸šåŠ¡æµé‡çš„ä¸€ç§ç½‘ç»œæ”»å‡»æ–¹å¼ DDOSï¼šDistributed denial of serviceï¼Œåˆ†å¸ƒå¼æ‹’ç»æœåŠ¡ï¼Œä¿—ç§°ç¾¤æ®´ï¼ˆå•å°è®¾å¤‡æ”»å‡»èƒ½åŠ›æœ‰é™ï¼Œä½†æ˜¯æˆç™¾ä¸Šåƒè®¾å¤‡åŒæ—¶æ”»å‡»å¾ˆçŒ›ï¼‰ å‘èµ·æ”»å‡»çš„ç½‘ç»œï¼ˆç»„æˆæˆç™¾ä¸Šåƒè®¾å¤‡çš„æ”»å‡»ç½‘ç»œï¼‰ç§°ä¸ºåƒµå°¸ç½‘ç»œ è¿™ä¸ªç½‘ç»œå¯ä»¥é€šè¿‡æœ¨é©¬ã€è •è™«ç­‰æ„ŸæŸ“å¤§é‡è®¾å¤‡ä»è€Œè·å–åƒµå°¸ç½‘ç»œï¼ˆäº¦æˆ–è€…å¯Œäººç›´æ¥ä¹°å°±è¡Œäº†ï¼‰ DDosæ”»å‡»å¯ä»¥å‡ºç°åœ¨ç½‘ç»œçš„å¾ˆå¤šå±‚ï¼š ç½‘ç»œå±‚ï¼šéœ¸å æœåŠ¡å™¨ç½‘ç»œå¸¦å®½èµ„æºï¼Œå‘é€å¤§é‡çš„IPåè®®æ•°æ®åŒ…ï¼ˆæ¯”å¦‚pingå·¥å…·ï¼Œäº§ç”ŸICMPåŒ…ï¼‰ï¼Œè¿™ç§æ”»å‡»æ–¹å¼ä¹Ÿç§°ä¸ºICMP flood é™¤æ­¤ä¹‹å¤–è¿˜æœ‰ UDP flood å¤šæŸçš„æ‹›æ•°ï¼š åå°„æ”»å‡»ï¼šä¼ªé€ è‡ªèº«ipåœ°å€ä¸ºæ”»å‡»ç›®æ ‡çš„åœ°å€ï¼Œç„¶åå‘å¤§é‡ç¬¬ä¸‰æ–¹æœºå™¨å‘é€è¯·æ±‚ï¼Œç„¶åè®©ç¬¬ä¸‰æ–¹æœºå™¨å›å¤çš„å“åº”å¤§é‡æ¶Œå…¥æ”»å‡»ç›®æ ‡ip æ”¾å¤§æ”»å‡»ï¼šä¸€æ¬¡DNSæŸ¥è¯¢ï¼Œè¿”å›çš„æ•°æ®å¾€å¾€å¤§äºè¯·æ±‚æ•°æ®ï¼Œæ ¹æ®å¸¦å®½æ”¾å¤§å› å­ï¼Œä¸€èˆ¬60Bçš„è¯·æ±‚æ•°æ®å¯ä»¥è·å¾—3000Bçš„è¿”å›æ•°æ®ï¼Œæ­¤æ—¶å†ç»“åˆåå°„æ”»å‡»ï¼Œè®©DNSè¿”å›çš„æ•°æ®å“åº”åˆ°æ”»å‡»åœ°å€ä¸Šï¼Œæ›´åŠ BTï¼ˆmaybeï¼Œ50å€çš„æ”»å‡»æ•ˆæœï¼‰ TCP floodï¼Œå› ä¸ºæœ‰ä¸‰æ¬¡æ¡æ‰‹ï¼Œæ‰€ä»¥æ— æ³•ä¼ªè£…ip RSTæ´ªæ°´æ”»å‡»ï¼ŒåŒæ ·æ˜¯åˆ©ç”¨TCPåè®®ï¼Œä¸€æ–¹å¯ä»¥å‘é€RSTæ•°æ®å¼ºè¡Œåˆ‡æ–­è¿æ¥ï¼Œè€Œä¸ç”¨å››æ¬¡æŒ¥æ‰‹ï¼Œæ­¤æ—¶æˆ‘ä»¬è®©æ”»å‡»è®¾å¤‡ä¸æ–­å°è¯•ä¼ªé€ å„ç§ipåœ°å€ï¼Œå‘é€RSTæ•°æ®ï¼Œè¿›è¡Œç›²æ‰“ï¼Œæ­¤æ—¶æœ‰å¯èƒ½å¯ä»¥å‘½ä¸­æŸä½xxç”¨æˆ·çš„è¿æ¥ åå‡»æ ¹æ²»DDosæ”»å‡»çš„æ–¹æ³•ï¼š ç½‘ç»œè®¾å¤‡æ£€æµ‹ipï¼Œè¿‡æ»¤æ‰ä¼ªè£…çš„ipåœ°å€ æ ¹æ®è·¯ç”±è½¬å‘é€»è¾‘ï¼Œè¿‡æ»¤ä¼ªè£…ip ä¿å®ˆæ²»ç–—ï¼š ä½¿ç”¨CDNèŠ‚ç‚¹ æµé‡æ¸…æ´—è®¾å¤‡ï¼ˆæœ‰ç‚¹åƒä¿é•–ï¼‰ï¼Œå…ˆè‡ªå·±æ¥åº”ç­”ï¼Œå¦‚æœæ˜¯æ­£å¸¸çš„æµé‡å°±æ”¾è¡Œ 7.é‡æ”¾æ”»å‡»APIé‡æ”¾æ”»å‡»ï¼ˆReplay Attacksï¼‰åˆç§°é‡æ’­æ”»å‡»ã€å›æ”¾æ”»å‡»ï¼Œè¿™ç§æ”»å‡»ä¼šä¸æ–­æ¶æ„æˆ–æ¬ºè¯ˆæ€§åœ°é‡å¤ä¸€ä¸ªæœ‰æ•ˆçš„APIè¯·æ±‚ã€‚æ”»å‡»è€…åˆ©ç”¨ç½‘ç»œç›‘å¬æˆ–è€…å…¶ä»–æ–¹å¼ç›—å–APIè¯·æ±‚ï¼Œè¿›è¡Œä¸€å®šçš„å¤„ç†åï¼Œå†æŠŠå®ƒé‡æ–°å‘ç»™è®¤è¯æœåŠ¡å™¨ï¼Œæ˜¯é»‘å®¢å¸¸ç”¨çš„æ”»å‡»æ–¹å¼ä¹‹ä¸€ã€‚ ç™¾ç§‘ï¼š é‡æ”¾æ”»å‡»çš„åŸºæœ¬åŸç†å°±æ˜¯æŠŠä»¥å‰çªƒå¬åˆ°çš„æ•°æ®åŸå°ä¸åŠ¨åœ°é‡æ–°å‘é€ç»™æ¥æ”¶æ–¹ã€‚å¾ˆå¤šæ—¶å€™ï¼Œç½‘ç»œä¸Šä¼ è¾“çš„æ•°æ®æ˜¯åŠ å¯†è¿‡çš„ï¼Œæ­¤æ—¶çªƒå¬è€…æ— æ³•å¾—åˆ°æ•°æ®çš„å‡†ç¡®æ„ä¹‰ã€‚ä½†å¦‚æœä»–çŸ¥é“è¿™äº›æ•°æ®çš„ä½œç”¨ï¼Œå°±å¯ä»¥åœ¨ä¸çŸ¥é“æ•°æ®å†…å®¹çš„æƒ…å†µä¸‹é€šè¿‡å†æ¬¡å‘é€è¿™äº›æ•°æ®è¾¾åˆ°æ„šå¼„æ¥æ”¶ç«¯çš„ç›®çš„ã€‚ä¾‹å¦‚ï¼Œæœ‰çš„ç³»ç»Ÿä¼šå°†é‰´åˆ«ä¿¡æ¯è¿›è¡Œç®€å•åŠ å¯†åè¿›è¡Œä¼ è¾“ï¼Œè¿™æ—¶æ”»å‡»è€…è™½ç„¶æ— æ³•çªƒå¬å¯†ç ï¼Œä½†ä»–ä»¬å´å¯ä»¥é¦–å…ˆæˆªå–åŠ å¯†åçš„å£ä»¤ç„¶åå°†å…¶é‡æ”¾ï¼Œä»è€Œåˆ©ç”¨è¿™ç§æ–¹å¼è¿›è¡Œæœ‰æ•ˆçš„æ”»å‡»ã€‚ å°æƒ…æ™¯1.0ï¼šå‡è®¾ç½‘ä¸Šå­˜æ¬¾ç³»ç»Ÿä¸­ï¼Œä¸€æ¡æ¶ˆæ¯è¡¨ç¤ºç”¨æˆ·æ”¯å–äº†ä¸€ç¬”å­˜æ¬¾ï¼Œæ”»å‡»è€…å®Œå…¨å¯ä»¥å¤šæ¬¡å‘é€è¿™æ¡æ¶ˆæ¯è€Œå·çªƒå­˜æ¬¾ã€‚ å°æƒ…æ™¯2.0ï¼šAç»™Bå†™äº†ä¸€å°ä¿¡ï¼Œè¯´ï¼šâ€œè€å‹ï¼Œè¯·ç»™æˆ‘è½¬è´¦100å—å§ï¼Aæ•¬ä¸Šã€‚â€ Bç…§åšäº†ï¼Œç„¶åæœ‰äººï¼ˆä¸ä¸€å®šæ˜¯A)å¤åˆ¶äº†ä¸€æ ·çš„ä¿¡å’Œç­¾åå‘ç»™Bï¼Œéª—Bå†è½¬è´¦100å—ï¼Œè¿™æ˜¯é‡æ”¾æ”»å‡»ï¼ˆreplay attackï¼‰ã€‚ å°æƒ…æ™¯3.0ï¼šä¸€ä¸ªç”µå­å•†åŠ¡ç½‘ç«™ï¼Œè¦æ±‚å®¢æˆ·å¯¹ç”µå­è®¢å•ç­¾åä»¥é˜²æ­¢éæˆæƒç”¨æˆ·ä¸‹è®¢å•ã€‚æ”»å‡»è€…å¦‚è¦å†’å……æŸä½å®¢æˆ·ä¸‹è®¢å•ï¼Œæœ€å¥½å¯ä»¥è·å¾—ä»–çš„ç§é’¥ï¼Œå¦‚æœä¸æˆåŠŸï¼Œæ”»å‡»è€…å¯ä»¥ç›‘å¬è¿™ä½é¡¾å®¢çš„é€šä¿¡ï¼Œå°†é¡¾å®¢ä»¥å‰å‘é€çš„è®¢å•è®°å½•ä¸‹æ¥ï¼Œç„¶åä»–å°±å¯ä»¥ç›´æ¥å°†è¿™äº›è®¢å•å‘ç»™ç½‘ç«™äº†ã€‚å› ä¸ºè¿™äº›è®¢å•çš„ç¡®æ˜¯åˆæ³•å®¢æˆ·ç­¾åè¿‡çš„ï¼Œå¦‚æœç½‘ç«™æ²¡æœ‰ä¸€ç§è¯†åˆ«é‡æ”¾è®¢å•çš„æœºåˆ¶ï¼Œå®ƒå°±ä¼šä¸åŠ çŠ¹è±«åœ°æ¥æ”¶è¿™äº›è®¢å•ã€‚ é˜²å¾¡ï¼š (1)åŠ éšæœºæ•°ã€‚è¯¥æ–¹æ³•ä¼˜ç‚¹æ˜¯è®¤è¯åŒæ–¹ä¸éœ€è¦æ—¶é—´åŒæ­¥ï¼ŒåŒæ–¹è®°ä½ä½¿ç”¨è¿‡çš„éšæœºæ•°ï¼Œå¦‚å‘ç°æŠ¥æ–‡ä¸­æœ‰ä»¥å‰ä½¿ç”¨è¿‡çš„éšæœºæ•°ï¼Œå°±è®¤ä¸ºæ˜¯é‡æ”¾æ”»å‡»ã€‚ç¼ºç‚¹æ˜¯éœ€è¦é¢å¤–ä¿å­˜ä½¿ç”¨è¿‡çš„éšæœºæ•°ï¼Œè‹¥è®°å½•çš„æ—¶é—´æ®µè¾ƒé•¿ï¼Œåˆ™ä¿å­˜å’ŒæŸ¥è¯¢çš„å¼€é”€è¾ƒå¤§ã€‚ (2)åŠ æ—¶é—´æˆ³ è¯¥æ–¹æ³•ä¼˜ç‚¹æ˜¯ä¸ç”¨é¢å¤–ä¿å­˜å…¶ä»–ä¿¡æ¯ã€‚ç¼ºç‚¹æ˜¯è®¤è¯åŒæ–¹éœ€è¦å‡†ç¡®çš„æ—¶é—´åŒæ­¥ï¼ŒåŒæ­¥è¶Šå¥½ï¼Œå—æ”»å‡»çš„å¯èƒ½æ€§å°±è¶Šå° (3)åŠ æµæ°´å·ï¼Œä¹Ÿå°±æ˜¯åŒæ–¹åœ¨æŠ¥æ–‡ä¸­æ·»åŠ ä¸€ä¸ªé€æ­¥é€’å¢çš„æ•´æ•°ï¼Œåªè¦æ¥æ”¶åˆ°ä¸€ä¸ªä¸è¿ç»­çš„æµæ°´å·æŠ¥æ–‡(å¤ªå¤§æˆ–å¤ªå°)ï¼Œå°±è®¤å®šæœ‰é‡æ”¾å¨èƒã€‚ 8.SSHSecure Shellï¼ˆå®‰å…¨å¤–å£³åè®®ï¼Œç®€ç§°SSHï¼‰æ˜¯ä¸€ç§åŠ å¯†çš„ç½‘ç»œä¼ è¾“åè®® å®ƒçš„æ•´ä¸ªè¿‡ç¨‹ï¼š ï¼ˆ1ï¼‰è¿œç¨‹ä¸»æœºæ”¶åˆ°ç”¨æˆ·çš„ç™»å½•è¯·æ±‚ï¼ŒæŠŠè‡ªå·±çš„å…¬é’¥å‘ç»™ç”¨æˆ·ã€‚ ï¼ˆ2ï¼‰ç”¨æˆ·ä½¿ç”¨è¿™ä¸ªå…¬é’¥ï¼Œå°†ç™»å½•å¯†ç åŠ å¯†åï¼Œå‘é€å›æ¥ã€‚ ï¼ˆ3ï¼‰è¿œç¨‹ä¸»æœºç”¨è‡ªå·±çš„ç§é’¥ï¼Œè§£å¯†ç™»å½•å¯†ç ï¼Œå¦‚æœå¯†ç æ­£ç¡®ï¼Œå°±åŒæ„ç”¨æˆ·ç™»å½•ã€‚ å…¶å®ä¹Ÿå°±æ˜¯å’Œhttpsçš„éå¯¹ç§°å¯†é’¥ä¸€æ ·ï¼Œåªä¸è¿‡å®ƒï¼šä¸åƒhttpsåè®®ï¼Œ SSHåè®®çš„å…¬é’¥æ˜¯æ²¡æœ‰è¯ä¹¦ä¸­å¿ƒï¼ˆCAï¼‰å…¬è¯çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œéƒ½æ˜¯è‡ªå·±ç­¾å‘çš„ã€‚æ‰€ä»¥è¿™ä¸ªæœºåˆ¶é˜²æ­¢ä¸äº†â€œä¸­é—´äººæ”»å‡»â€ è§£å†³åŠæ³• ä¸€ã€å£ä»¤ç™»å½• ç¬¬ä¸€æ¬¡ç™»å½•å¯¹æ–¹ä¸»æœºçš„æ—¶å€™ï¼Œé€šè¿‡å®ƒæä¾›çš„å…¬é’¥æŒ‡çº¹ï¼Œå»è‡ªå·±ä¸€ä¸€å¯¹åº”è¿œç¨‹ä¸»æœºåœ¨ç½‘ç«™ä¸Šè‡ªå·±è´´å‡ºæ¥çš„å…¬é’¥æŒ‡çº¹ï¼Œè®©æˆ‘ä»¬è‡ªè¡Œæ ¸å¯¹ å½“è¿œç¨‹ä¸»æœºçš„å…¬é’¥è¢«æ¥å—ä»¥åï¼Œå®ƒå°±ä¼šè¢«ä¿å­˜åœ¨æ–‡ä»¶$HOME/.ssh/known_hostsä¹‹ä¸­ã€‚ä¸‹æ¬¡å†è¿æ¥è¿™å°ä¸»æœºï¼Œç³»ç»Ÿå°±ä¼šè®¤å‡ºå®ƒçš„å…¬é’¥å·²ç»ä¿å­˜åœ¨æœ¬åœ°äº†ï¼Œä»è€Œè·³è¿‡è­¦å‘Šéƒ¨åˆ†ï¼Œç›´æ¥æç¤ºè¾“å…¥å¯†ç ã€‚ æ¯ä¸ªSSHç”¨æˆ·éƒ½æœ‰è‡ªå·±çš„known_hostsæ–‡ä»¶ï¼Œæ­¤å¤–ç³»ç»Ÿä¹Ÿæœ‰ä¸€ä¸ªè¿™æ ·çš„æ–‡ä»¶ï¼Œé€šå¸¸æ˜¯/etc/ssh/ssh_known_hostsï¼Œä¿å­˜ä¸€äº›å¯¹æ‰€æœ‰ç”¨æˆ·éƒ½å¯ä¿¡èµ–çš„è¿œç¨‹ä¸»æœºçš„å…¬é’¥ã€‚ äºŒã€å…¬é’¥ç™»å½• å…ˆè®©ç”¨æˆ·å°†è‡ªå·±çš„å…¬é’¥å‚¨å­˜åœ¨è¿œç¨‹ä¸»æœºä¸Š è¿œç¨‹ä¸»æœºå‘ä¸œè¥¿è¿‡æ¥ -&gt; ç”¨æˆ·ç”¨ç§é’¥åŠ å¯†åå†å‘è¿‡å» -&gt; è¿œç¨‹ä¸»æœºç”¨å­˜å‚¨å¥½çš„å…¬é’¥è§£å¯† å‚è€ƒé“¾æ¥ï¼šé˜®ä¸€å³°https://www.ruanyifeng.com/blog/2011/12/ssh_remote_login.html 9.å¿ƒè„å‡ºè¡€æ¼æ´wikiå®šä¹‰Heartbleedæ˜¯OpenSSLåŠ å¯†åº“ä¸­çš„ä¸€ä¸ªå®‰å…¨æ¼æ´ï¼Œå®ƒæ˜¯ä¼ è¾“å±‚å®‰å…¨(TLS) åè®®çš„å¹¿æ³›ä½¿ç”¨çš„å®ç°ï¼Œæ— è®ºæ˜“å—æ”»å‡»çš„ OpenSSL å®ä¾‹æ˜¯ä½œä¸º TLS æœåŠ¡å™¨è¿˜æ˜¯å®¢æˆ·ç«¯è¿è¡Œï¼Œéƒ½å¯ä»¥åˆ©ç”¨ Heartbleedã€‚è¿™æ˜¯ç”±äºåœ¨ TLSå¿ƒè·³æ‰©å±•çš„å®ç°ä¸­è¾“å…¥éªŒè¯ä¸æ­£ç¡®ï¼ˆç”±äºç¼ºå°‘è¾¹ç•Œæ£€æŸ¥ï¼‰é€ æˆçš„ã€‚[3]å› æ­¤ï¼Œè¯¥é”™è¯¯çš„åç§°æºè‡ªheartbeatã€‚[4]è¯¥æ¼æ´è¢«å½’ç±»ä¸ºç¼“å†²åŒºè¿‡åº¦è¯»å– , [5]å¯ä»¥è¯»å–çš„æ•°æ®å¤šäºåº”å…è®¸çš„æ•°æ®çš„æƒ…å†µã€‚[6] ç³»ç»Ÿç®¡ç†å‘˜ç»å¸¸å¾ˆæ…¢åœ°ä¿®è¡¥ä»–ä»¬çš„ç³»ç»Ÿã€‚æˆªè‡³ 2014 å¹´ 5 æœˆ 20 æ—¥ï¼Œåœ¨ 800,000 ä¸ªæœ€å—æ¬¢è¿çš„å¯ç”¨ TLS çš„ç½‘ç«™ä¸­ï¼Œä»æœ‰ 1.5% çš„ç½‘ç«™å®¹æ˜“å—åˆ° Heartbleed çš„æ”»å‡»ã€‚[9]æˆªè‡³ 2014 å¹´ 6 æœˆ 21 æ—¥ï¼Œ309,197 å°å…¬å…±ç½‘ç»œæœåŠ¡å™¨ä»ç„¶æ˜“å—æ”»å‡»ã€‚[10]æˆªè‡³ 2017 å¹´ 1 æœˆ 23 æ—¥ï¼Œæ ¹æ®Shodançš„ä¸€ä»½æŠ¥å‘Š[11]ï¼Œä»æœ‰è¿‘ 180,000 å°è”ç½‘è®¾å¤‡æ˜“å—æ”»å‡»ã€‚[12] [13]æ ¹æ® shodan.io å¯¹â€œvuln:cve-2014-0160â€çš„æœç´¢ï¼Œæˆªè‡³ 2017 å¹´ 7 æœˆ 6 æ—¥ï¼Œè¯¥æ•°å­—å·²é™è‡³ 144,000 äººã€‚[14]æˆªè‡³ 2019 å¹´ 7 æœˆ 11 æ—¥ï¼ŒShodan æŠ¥å‘Š[15]91,063 å°è®¾å¤‡æ˜“å—æ”»å‡»ã€‚ç¾å›½ä»¥ 21,258 (23%) ä½å±…ç¬¬ä¸€ï¼Œå‰ 10 ä½å›½å®¶æœ‰ 56,537 (62%)ï¼Œå…¶ä½™å›½å®¶æœ‰ 34,526 (38%)ã€‚è¯¥æŠ¥å‘Šè¿˜æŒ‰å…¶ä»– 10 ä¸ªç±»åˆ«å¯¹è®¾å¤‡è¿›è¡Œäº†ç»†åˆ†ï¼Œä¾‹å¦‚ç»„ç»‡ï¼ˆå‰ 3 åæ˜¯æ— çº¿å…¬å¸ï¼‰ã€äº§å“ï¼ˆApache httpdã€Nginxï¼‰æˆ–æœåŠ¡ï¼ˆHTTPSï¼Œ81%ï¼‰ã€‚ é™¤ OpenSSL ä¹‹å¤–çš„ TLS å®ç°ï¼Œä¾‹å¦‚GnuTLSã€Mozillaçš„ç½‘ç»œå®‰å…¨æœåŠ¡å’ŒTLS çš„ Windows å¹³å°å®ç°ï¼Œéƒ½æ²¡æœ‰å—åˆ°å½±å“ï¼Œå› ä¸ºç¼ºé™·å­˜åœ¨äº OpenSSL çš„ TLS å®ç°ä¸­ï¼Œè€Œä¸æ˜¯åè®®æœ¬èº«ã€‚[16] ä¼ æ’­å†å²2012å¹´3æœˆ14æ—¥ï¼ŒOpenSSL 1.0.1ç‰ˆå‘å¸ƒï¼Œæ¼æ´å¼€å§‹ä¼ æ’­ã€‚å¿ƒè·³æ”¯æŒé»˜è®¤æ˜¯å¯ç”¨çš„ï¼Œè¿™ä½¿å—å½±å“çš„ç‰ˆæœ¬æ˜“å—æ”»å‡» å®ä¾‹ï¼šæ—©åœ¨2014å¹´ï¼Œäº’è”ç½‘å®‰å…¨åè®®OpenSSLè¢«æ›å­˜åœ¨ä¸€ä¸ªååˆ†ä¸¥é‡çš„å®‰å…¨æ¼æ´ã€‚åœ¨é»‘å®¢ç¤¾åŒºï¼Œå®ƒè¢«å‘½åä¸ºâ€œå¿ƒè„å‡ºè¡€â€ï¼Œè¡¨æ˜ç½‘ç»œä¸Šå‡ºç°äº†â€œè‡´å‘½å†…ä¼¤â€ã€‚åˆ©ç”¨è¯¥æ¼æ´ï¼Œé»‘å®¢å¯ä»¥è·å–çº¦30%çš„httpså¼€å¤´ç½‘å€çš„ç”¨æˆ·ç™»å½•è´¦å·å¯†ç ï¼Œå…¶ä¸­åŒ…æ‹¬è´­ç‰©ã€ç½‘é“¶ã€ç¤¾äº¤ã€é—¨æˆ·ç­‰ç±»å‹çš„çŸ¥åç½‘ç«™ã€‚ä»Šå¤©å°±ä¸ºå¤§å®¶å¸¦æ¥å¹³å°äº‹ä»¶è§„åˆ™è§£è¯»ç³»åˆ—ç¬¬å››ç¯‡â€”â€”éœ‡æƒŠå…¨çƒçš„â€œå¿ƒè„å‡ºè¡€â€æ¼æ´ã€‚ å…·ä½“å†…å®¹æ‰€è°“å¿ƒè·³æ£€æµ‹ï¼Œå°±æ˜¯å»ºç«‹ä¸€ä¸ª Client Hello é—®è¯¢æ¥æ£€æµ‹å¯¹æ–¹æœåŠ¡å™¨æ˜¯ä¸æ˜¯æ­£å¸¸åœ¨çº¿ ï¼ŒæœåŠ¡å™¨å‘å› Server helloï¼Œè¡¨æ˜æ­£å¸¸æ ‘ç«‹SSLé€šè®¯ã€‚å°±åƒæˆ‘ä»¬æ‰“ç”µè¯æ—¶ä¼šé—®å¯¹æ–¹ â€œå–‚å¬å¾—åˆ°å—ï¼Ÿâ€ä¸€æ ·ã€‚ æ¯æ¬¡é—®è¯¢éƒ½ä¼šé™„åŠ ä¸€ä¸ªé—®è¯¢çš„å­—ç¬¦é•¿åº¦ pad lengthï¼Œbug æ¥äº†ï¼Œå¦‚æœè¿™ä¸ª pad length å¤§äºå®é™…çš„é•¿åº¦ï¼ŒæœåŠ¡å™¨ä»æ˜¯ä¼šå›æ¥ç›¸åŒè§„æ¨¡çš„å­—ç¬¦ä¿¡æ¯ï¼Œäºæ˜¯å½¢æˆäº†å†…å­˜é‡Œä¿¡æ¯çš„è¶Šç•Œè®¿é—®ã€‚ è¿™æ˜¯å› ä¸ºOpenSSLçš„å¿ƒè·³åŠŸèƒ½ç¼ºå°‘äº†ä¸€ä¸ªè‡³å…³é‡è¦çš„å®‰å…¨ç»´æŠ¤æ‰‹æ®µï¼šå—å½±å“çš„OpenSSLç‰ˆæœ¬æ ¹æ®è¯·æ±‚æ¶ˆæ¯ä¸­çš„é•¿åº¦å­—æ®µåˆ†é…å†…å­˜ç¼“å†²åŒºï¼Œç”¨äºå­˜å‚¨è¦è¿”å›çš„æ¶ˆæ¯ï¼Œè€Œä¸è€ƒè™‘æ¶ˆæ¯ä¸­æœ‰æ•ˆè½½è·çš„å®é™…é•¿åº¦ã€‚æ‰€ä»¥è®¡ç®—æœºæ¥å—å¿ƒè·³è¯·æ±‚æ—¶ä»ä¸æ£€æŸ¥è¯¥è¯·æ±‚å’Œå®ƒå£°ç§°çš„å†…å®¹æ˜¯å¦ä¸€è‡´ã€‚ å°±è¿™æ ·ï¼Œæ¯å‘èµ·ä¸€ä¸ªå¿ƒè·³ï¼ŒæœåŠ¡å™¨å°±èƒ½æ³„éœ²ä¸€ç‚¹ç‚¹æ•°æ®ï¼ˆç†è®ºä¸Šæœ€å¤šæ³„éœ² 64Kï¼‰ï¼Œä¾‹å¦‚ï¼Œæ­£å¸¸çš„å¿ƒè·³è¯·æ±‚å¯èƒ½ä¼šè¦æ±‚ä¸€æ–¹â€œè¿”å›4ä¸ªå­—ç¬¦çš„å•è¯â€˜birdâ€™â€ï¼Œé‚£ä¸€æ–¹å°±è¿”å›â€œbirdâ€ï¼›â€œå¿ƒè„å‡ºè¡€è¯·æ±‚â€ï¼ˆæ¶æ„çš„å¿ƒè·³è¯·æ±‚ï¼‰å¦‚â€œè¿”å›500ä¸ªå­—ç¬¦çš„å•è¯â€˜birdâ€™â€ä¼šå¯¼è‡´å—å®³è€…è¿”å›â€œbirdâ€ï¼Œç´§æ¥ç€æ˜¯æ°å‚¨å­˜åœ¨å—å®³è€…æ´»è·ƒå†…å­˜ä¸­çš„496ä¸ªå­—ç¬¦ã€‚è¿™æ ·ï¼Œæ”»å‡»è€…ä¾¿å¯èƒ½ä¼šæ”¶åˆ°æ•æ„Ÿæ•°æ®ï¼Œä»è€Œå±åŠå—å®³è€…å…¶å®ƒå®‰å…¨é€šä¿¡çš„ä¿å¯†æ€§ã€‚è™½ç„¶æ”»å‡»è€…èƒ½å¯¹è¿”å›çš„å†…å­˜å—å¤§å°æœ‰æ‰€æ§åˆ¶ï¼Œä½†å´æ— æ³•å†³å®šå®ƒçš„ä½ç½®ï¼Œå› è€Œä¸èƒ½æŒ‡å®šè¦æ˜¾ç¤ºå†…å®¹ã€‚ è¿™äº›æ•°æ®é‡Œå¯èƒ½åŒ…æ‹¬ç”¨æˆ·çš„ç™»å½•è´¦å·å¯†ç ã€ç”µå­é‚®ä»¶ç”šè‡³æ˜¯åŠ å¯†ç§˜é’¥ç­‰ä¿¡æ¯ï¼Œä¹Ÿå¯èƒ½å¹¶æ²¡æœ‰åŒ…å«è¿™äº›ä¿¡æ¯ï¼Œä½†æ”»å‡»è€…å¯ä»¥ä¸æ–­åˆ©ç”¨ â€œå¿ƒè·³â€æ¥è·å–æ›´å¤šçš„ä¿¡æ¯ã€‚å°±è¿™æ ·ï¼ŒæœåŠ¡å™¨ä¸€ç‚¹ä¸€ç‚¹æ³„éœ²è¶Šæ¥è¶Šå¤šçš„ä¿¡æ¯ï¼Œå°±åƒæ˜¯å¿ƒè„æ…¢æ…¢åœ¨å‡ºè¡€ï¼Œå¿ƒè„å‡ºè¡€æ¼æ´çš„åå­—ç”±æ­¤è€Œæ¥ã€‚ æ¼æ´å‡ºç°çš„ç‰ˆæœ¬ heartbleedæ¼æ´ä¸»è¦å­˜åœ¨äºæœ‰å¿ƒè·³æœºåˆ¶çš„OpenSSLåè®®ä¸­ã€‚ IANAç»„ç»‡æŠŠå¼€å¯å¿ƒè·³æ‰©å±•æœºåˆ¶çš„SSLæ•°æ®åŒ…typeç±»å‹å®šä¹‰ä¸º24ï¼ˆ0x18ï¼‰ã€‚ heartbleedæ¼æ´ä¸»è¦å­˜åœ¨äºTLSå’ŒDTLSä¸¤ç§åè®®ä¸­ï¼Œåœ¨å«æœ‰heartbleedæ¼æ´çš„OpenSSLåè®®ä¸­éœ€è¦å¼€å¯å¿ƒè·³æ‰©å±•æœºåˆ¶ï¼ˆbeartbeatï¼‰ï¼Œè€Œå«æœ‰å¿ƒè·³æ‰©å±•æœºåˆ¶çš„TLSç‰ˆæœ¬ä¸»è¦åŒ…å«åœ¨0ï¼ˆ0x0301ï¼‰ï¼ŒTLSv1.1ï¼ˆ0x0302ï¼‰ï¼ŒTLSv1.2ï¼ˆ0x0303ï¼‰ä¸‰ç§ç‰ˆæœ¬ä¸­ã€‚ heartbleedæ¼æ´æ”»å‡»ä¸»è¦ç”±äºæ”»å‡»è€…æ„é€ å¼‚å¸¸çš„å¿ƒè·³æ•°æ®åŒ…ï¼Œå³å¿ƒè·³åŒ…ä¸­çš„é•¿åº¦å­—æ®µä¸åç»­çš„æ•°æ®å­—æ®µä¸ç›¸ç¬¦åˆï¼Œæ¥è·å–å¿ƒè·³æ•°æ®æ‰€åœ¨çš„å†…å­˜åŒºåŸŸçš„åç»­æ•°æ®ã€‚ å‚è€ƒï¼š å¿ƒè„å‡ºè¡€æ¼æ´wiki äº‹ä»¶åˆ†æOPENSSLâ€œå¿ƒè„å‡ºè¡€â€æ¼æ´ å°é”™è¯¯å¼•å‘å¤§å±æœºâ€”â€”å¿ƒè„å‡ºè¡€åˆ°åº•æ˜¯ä»€ä¹ˆï¼Ÿ","categories":[{"name":"ç½‘ç»œ","slug":"ç½‘ç»œ","permalink":"https://taylor12138.github.io/categories/%E7%BD%91%E7%BB%9C/"}],"tags":[],"author":"Hello"},{"title":"è¶…æ–‡æœ¬ä¼ è¾“åè®®new","slug":"è¶…æ–‡æœ¬ä¼ è¾“åè®®new","date":"2021-03-14T16:00:00.000Z","updated":"2023-05-30T17:04:29.373Z","comments":true,"path":"2021/03/15/chao-wen-ben-chuan-shu-xie-yi-new/","link":"","permalink":"https://taylor12138.github.io/2021/03/15/chao-wen-ben-chuan-shu-xie-yi-new/","excerpt":"","text":"1.httpæ¦‚è¿°ä»è®¡ç®—æœºç½‘ç»œçš„å­¦ä¹ æˆ‘ä»¬äº†è§£åˆ°ï¼šHTTPåè®®[è¶…æ–‡æœ¬ä¼ è¾“åè®®]ï¼Œåè®®è¯¦ç»†è§„å®šäº†æµè§ˆå™¨å’Œä¸‡ç»´ç½‘æœåŠ¡å™¨ä¹‹é—´ç›¸äº’é€šä¿¡çš„è§„åˆ™ http 2.0 ä½¿ç”¨äºŒè¿›åˆ¶ä¼ è¾“ï¼ˆäºŒè¿›åˆ¶åˆ†å¸§ï¼‰ï¼Œå‡å°‘æœåŠ¡ç«¯å‹åŠ›ï¼Œè¿æ¥ååé‡æ›´å¤§ï¼Œæ”¹å–„TCPæ‹¥å¡çŠ¶å†µï¼ŒåŒæ—¶æ…¢å¯åŠ¨æ—¶é—´å‡å°‘ å¤šè·¯å¤ç”¨ï¼Œå¤šè·¯å¤ç”¨å…è®¸åŒæ—¶é€šè¿‡å•ä¸€çš„ HTTP/2 è¿æ¥å‘èµ·å¤šé‡çš„è¯·æ±‚-å“åº”æ¶ˆæ¯ã€‚ ä¸åŒæµè§ˆå™¨åœ¨http1æˆ–http1.1å¯¹è¯·æ±‚çš„é™åˆ¶æ•°é‡ å‹ç¼©headersï¼ˆæœ€å°æ•°æ®é‡åŒ–ï¼‰ æ”¯æŒserver pushï¼ˆæœåŠ¡ç«¯æ¨é€ï¼‰ï¼Œå”¯ä¸€ä¸€ä¸ªéœ€è¦å¼€å‘è€…è‡ªå·±é…ç½®çš„åŠŸèƒ½ï¼Œä»–å¯ä»¥å¯¹å®¢æˆ·ç«¯çš„ä¸€ä¸ªè¯·æ±‚å‘é€å¤šä¸ªå“åº”ï¼Œå®é™…ä¸Šæ˜¯è¿˜æ²¡æœ‰æ”¶åˆ°æµè§ˆå™¨çš„è¯·æ±‚ï¼ŒæœåŠ¡å™¨å°±æŠŠå„ç§èµ„æºæ¨é€ç»™æµè§ˆå™¨ã€‚ æ¯”å¦‚ï¼Œæµè§ˆå™¨åªè¯·æ±‚äº†index.htmlï¼Œä½†æ˜¯æœåŠ¡å™¨æŠŠindex.htmlã€style.cssã€example.pngå…¨éƒ¨å‘é€ç»™æµè§ˆå™¨ã€‚è¿™æ ·çš„è¯ï¼Œåªéœ€è¦ä¸€è½® HTTP é€šä¿¡ï¼Œæµè§ˆå™¨å°±å¾—åˆ°äº†å…¨éƒ¨èµ„æºï¼Œæé«˜äº†æ€§èƒ½ã€‚ è€Œä¸”å®ƒç‰¹æœ‰çš„ç¼“å­˜æœºåˆ¶ï¼Œä½¿ç”¨åœºæ™¯å¦‚ä¸‹ï¼Œã€Œå¦‚æœå®¢æˆ·ç«¯æ—©å·²åœ¨ç¼“å­˜ä¸­æœ‰äº†ä¸€ä»½ copy æ€ä¹ˆåŠï¼Ÿ]ï¼Œæ­¤æ—¶å†æ¨é€å°±æ˜¯æµªè´¹å¸¦å®½ã€‚ è¿™ç§æƒ…å†µä¸‹ï¼ŒHTTP/2 å…è®¸å®¢æˆ·ç«¯é€šè¿‡ RESET_STREAM ä¸»åŠ¨å–æ¶ˆ Push ï¼Œç„¶è€Œè¿™æ ·çš„è¯ï¼ŒåŸæœ¬å¯ä»¥ç”¨äºæ›´å¥½æ–¹å‘çš„ Push å°±ç™½ç™½çš„æµªè´¹æ‰æ•°æ®å¾€è¿”çš„ä»·å€¼ã€‚ å¯¹æ­¤ï¼Œä¸€ä¸ªæ¨èçš„è§£å†³æ–¹æ¡ˆæ˜¯ï¼Œå®¢æˆ·ç«¯ä½¿ç”¨ä¸€ä¸ªç®€æ´çš„ Cache Digest æ¥å‘Šè¯‰æœåŠ¡å™¨ï¼Œå“ªäº›ä¸œè¥¿å·²ç»åœ¨ç¼“å­˜ï¼Œå› æ­¤æœåŠ¡å™¨ä¹Ÿå°±ä¼šçŸ¥é“å“ªäº›æ˜¯å®¢æˆ·ç«¯æ‰€éœ€è¦çš„ï¼Œå› ä¸º Cache Digest ä½¿ç”¨çš„æ˜¯ Golumb Compressed Setsï¼Œæµè§ˆå™¨å®¢æˆ·ç«¯å¯ä»¥é€šè¿‡ä¸€ä¸ªè¿æ¥å‘é€å°‘äº 1K å­—èŠ‚çš„ Packets ç»™æœåŠ¡ç«¯ï¼Œé€šçŸ¥å“ªäº›æ˜¯å·²ç»åœ¨ç¼“å­˜ä¸­å­˜åœ¨çš„ï¼› http/1å¤„ç†å‡å°‘è¯·æ±‚çš„æ–¹å¼æ˜¯çº¿å¤´é˜»å¡ï¼ˆåˆå¹¶å¤šä¸ªè¯·æ±‚ä¸ºä¸€ä¸ªè¯·æ±‚ï¼‰ï¼Œä½†å®è´¨ä¸Šæœ‰ä¸€å®šçš„å¼€é”€ ä¸‹é¢æˆ‘ä»¬é˜è¿°http 1.xç‰ˆæœ¬çš„å†…å®¹ httpåè®®çš„ç‰¹ç‚¹ æ°¸è¿œéƒ½æ˜¯å®¢æˆ·ç«¯å‘èµ·è¯·æ±‚ï¼ŒæœåŠ¡å™¨å›é€å“åº” httpåè®®æ˜¯æ— çŠ¶æ€çš„ï¼Œä½†æ˜¯åœ¨å®é™…å·¥ä½œä¸­ï¼Œä¸€äº›ä¸‡ç»´ç½‘ç½‘ç«™å¸Œæœ›èƒ½è¯†åˆ«ç”¨æˆ·ï¼ˆç»™ç”¨æˆ·æ¨é”€äº§å“ï¼‰=&gt;è¯ç”Ÿäº†cookieå°é¥¼å¹²ï¼Œcookieæ˜¯å­˜å‚¨åœ¨ç”¨æˆ·ä¸»æœºçš„æ–‡æœ¬æ–‡ä»¶ï¼Œè®°å½•ä¸€æ®µæ—¶é—´å†…æŸç”¨æˆ·çš„è®¿é—®è®°å½•ï¼ˆä¸å¤ªæ•æ„Ÿçš„æ•°æ®ï¼‰ httpé‡‡ç”¨TCPä½œä¸ºè¿è¾“å±‚åè®®ï¼Œä½†æ˜¯httpåè®®æœ¬èº«æ˜¯æ— è¿æ¥çš„ ï¼ˆäº¤æ¢httpæŠ¥æ–‡ä¹‹å‰ä¸éœ€è¦å»ºç«‹è¿æ¥ï¼‰ httpè¿æ¥æ–¹å¼ï¼šæŒä¹…è¿æ¥ï¼ˆéæµæ°´çº¿å¼ï¼ˆæœ‰ç‚¹åƒåœç­‰åè®®ï¼‰ã€æµæ°´çº¿å¼ï¼ˆæœ‰ç‚¹åƒGBNæˆ–SRåè®®ï¼Œå³åé€€Nå¸§åè®®å’Œé€‰æ‹©é‡ä¼ åè®®ï¼‰ï¼‰ã€éæŒä¹…è¿æ¥ï¼ˆæ¯æ¬¡ä¼ è¾“éƒ½è¦ä¸‰æ¬¡æ¡æ‰‹ï¼‰ URL URLï¼šç»Ÿä¸€èµ„æºå®šä½å™¨ URLå’ŒåŸŸåçš„åŒºåˆ«åŸŸåï¼ŒDomain Nameï¼Œé€šå¸¸æŒ‡ä¸€ä¸ªç½‘å€çš„é¡¶çº§åŸŸåã€‚URLï¼Œwebsite addressï¼Œç½‘é¡µæˆ–ç½‘ç«™çš„åœ°å€ã€‚ URLä¸­åŒ…å«äº†ç½‘ç«™çš„åŸŸå.æ¯”å¦‚ä¸€ä¸ªç½‘å€ï¼šwww.cnblogs.com/gopark/p/8430916.htmlå…¶ä¸­cnblogs.comæ˜¯åŸŸåï¼Œcnblogsæ˜¯ç½‘ç«™åå­—ï¼Œcomæ˜¯åŸŸååç¼€ï¼›www.cnblogs.comä»£è¡¨ä¸€ä¸ªäºŒçº§åŸŸåï¼Œé€šå¸¸wwwè¢«ç”¨æ¥ç”¨ä¸ºé¦–é¡µæ ‡è¯†ï¼›https://www.cnblogs.com/gopark/p/8430916.htmlï¼Œè¿™ä¸ªåˆ™æ˜¯ä¸€ä¸ªå®Œæ•´çš„ç½‘ç«™é¦–é¡µURLåœ°å€ã€‚https://ï¼Œè¿™æ˜¯ä¸€ä¸ªåè®®ï¼Œæ˜¯ç½‘ç«™åœ¨ç½‘ä¸Šä¼ è¾“çš„åè®® URLå’ŒURIçš„åŒºåˆ«ï¼š URIï¼Œç»Ÿä¸€èµ„æºæ ‡å¿—ç¬¦ï¼Œè¡¨ç¤ºçš„æ˜¯webä¸Šæ¯ä¸€ç§å¯ç”¨çš„èµ„æºï¼Œå¦‚ HTMLæ–‡æ¡£ã€å›¾åƒã€è§†é¢‘ç‰‡æ®µã€ç¨‹åºç­‰éƒ½ç”±ä¸€ä¸ªURIè¿›è¡Œæ ‡è¯†çš„ã€‚ URLæ˜¯URIçš„ä¸€ä¸ªå­é›†ï¼Œé€šä¿—åœ°è¯´ï¼ŒURLæ˜¯Internetä¸Šæè¿°ä¿¡æ¯èµ„æºçš„å­—ç¬¦ä¸²ï¼Œä¸»è¦ç”¨åœ¨å„ç§WWWå®¢æˆ·ç¨‹åºå’ŒæœåŠ¡å™¨ç¨‹åºä¸Š æ›´åŠ é€šä¿—ï¼šURIå¯ä»¥è®¤ä¸ºæ˜¯ä¸€ä¸ªç¼–å·,ç±»ä¼¼ä¸€ä¸ªèº«ä»½è¯å·,ç”¨æ¥æ ‡è¯†å…¶å”¯ä¸€æ€§,è€Œurlæ—¢å¯ä»¥æ ‡è¯†å…¶å…·æœ‰å”¯ä¸€æ€§,è€Œä¸”å¯ä»¥æ ¹æ®urlæ‰¾åˆ°èµ„æºçš„ä½ç½®,è¿™å°±æ˜¯åŒºåˆ« è¾“å…¥urlåˆ°ç½‘é¡µå‘ˆç°çš„è¿‡ç¨‹ï¼š åŸŸåè§£æ å»ºç«‹TCPè¿æ¥ æµè§ˆå™¨å‘é€httpè¯·æ±‚ æœåŠ¡å™¨è¿”å›å“åº” æµè§ˆå™¨æ¸²æŸ“é¡µé¢ TCPæ–­å¼€è¿æ¥ urlç¼–ç è¿‡ç¨‹ å¯¹äºæ­£å¸¸è‹±è¯­ï¼Œä½¿ç”¨ASCIIç¼–ç æ–¹å¼ å¯¹äºå…¶ä»–è¯­è¨€ï¼ŒUnicodeç¼–ç æ–¹å¼ï¼Œè€Œæˆ‘ä»¬å¸¸è¯´çš„ UTF-8 å°±æ˜¯åœ¨äº’è”ç½‘ä¸Šä½¿ç”¨æœ€å¹¿çš„ä¸€ç§ Unicode çš„å®ç°æ–¹å¼ã€‚å…¶ä»–å®ç°æ–¹å¼è¿˜åŒ…æ‹¬ UTF-16ï¼ˆå­—ç¬¦ç”¨ä¸¤ä¸ªå­—èŠ‚æˆ–å››ä¸ªå­—èŠ‚è¡¨ç¤ºï¼‰å’Œ UTF-32ï¼ˆå­—ç¬¦ç”¨å››ä¸ªå­—èŠ‚è¡¨ç¤ºï¼‰ï¼Œä¸è¿‡åœ¨äº’è”ç½‘ä¸ŠåŸºæœ¬ä¸ç”¨ã€‚é‡å¤ä¸€éï¼Œè¿™é‡Œçš„å…³ç³»æ˜¯ï¼ŒUTF-8 æ˜¯ Unicode çš„å®ç°æ–¹å¼ä¹‹ä¸€ã€‚ï¼ˆé˜®ä¸€å³°è€å¸ˆsaidï¼‰ ï¼ˆæ›´å¤šå¯æŸ¥çœ‹ã€Šè®¡ç®—æœºåŸºç¡€çŸ¥è¯†åˆé›†ã€‹çš„blogï¼‰ encodeURIComponent()**encodeURIComponent()** å‡½æ•°é€šè¿‡å°†ä¸€ä¸ªï¼Œä¸¤ä¸ªï¼Œä¸‰ä¸ªæˆ–å››ä¸ªè¡¨ç¤ºå­—ç¬¦çš„ UTF-8 ç¼–ç çš„è½¬ä¹‰åºåˆ—æ›¿æ¢æŸäº›å­—ç¬¦çš„æ¯ä¸ªå®ä¾‹æ¥ç¼–ç  URIï¼ˆå¯¹äºç”±ä¸¤ä¸ªâ€œä»£ç†â€å­—ç¬¦ç»„æˆçš„å­—ç¬¦è€Œè¨€ï¼Œå°†ä»…æ˜¯å››ä¸ªè½¬ä¹‰åºåˆ—ï¼‰ã€‚ // encodes characters such as ?,=,/,&amp;,: console.log(`?x=${encodeURIComponent('test?')}`); // expected output: \"?x=test%3F\" console.log(`?x=${encodeURIComponent('ÑˆĞµĞ»Ğ»Ñ‹')}`); // expected output: \"?x=%D1%88%D0%B5%D0%BB%D0%BB%D1%8B\" httpè¯·æ±‚ GETï¼šè·å–èµ„æºã€‚getæ³¨é‡urlè·å¾—çš„å‚æ•° æ•°æ®æ ¼å¼ï¼šè·å¾—getè¯·æ±‚çš„å†…å®¹ï¼Œå®ƒçš„å†…å®¹æ˜¯åœ¨urlçš„? ä¹‹åçš„éƒ¨åˆ† é•¿åº¦é™åˆ¶ï¼šGetæ–¹æ³•æäº¤çš„æ•°æ®å¤§å°é•¿åº¦å¹¶æ²¡æœ‰é™åˆ¶ï¼ŒHTTPåè®®è§„èŒƒæ²¡æœ‰å¯¹URLé•¿åº¦è¿›è¡Œé™åˆ¶ã€‚è¿™ä¸ªé™åˆ¶æ˜¯ç‰¹å®šçš„æµè§ˆå™¨åŠæœåŠ¡å™¨å¯¹å®ƒçš„é™åˆ¶ï¼›è€Œè¿™ä¸ªé•¿åº¦é™åˆ¶ï¼Œæ¯ä¸ªæµè§ˆå™¨å¯¹åº”çš„é™åˆ¶éƒ½æ˜¯ä¸ä¸€æ ·çš„ã€‚ POSTï¼šåˆ›å»ºèµ„æºï¼ˆå¸¦è¯·æ±‚ä½“ï¼‰ã€‚postçš„ä¿¡æ¯æ”¾åœ¨Request bodyä¸­ï¼ˆfirefoxæµè§ˆå™¨é™¤å¤–ï¼‰ æ•°æ®æ ¼å¼ï¼špostå›é€€æ—¶ä¼šå†æ¬¡æäº¤è¯·æ±‚ï¼›ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œç§å¯†æ•°æ®ä¼ è¾“ç”¨POST + bodyå°±å¥½ é•¿åº¦é™åˆ¶ï¼šç†è®ºä¸Šè®²ï¼ŒPOSTæ˜¯æ²¡æœ‰å¤§å°é™åˆ¶çš„ã€‚HTTPåè®®è§„èŒƒä¹Ÿæ²¡æœ‰è¿›è¡Œå¤§å°é™åˆ¶ï¼Œèµ·é™åˆ¶ä½œç”¨çš„æ˜¯æœåŠ¡å™¨çš„å¤„ç†ç¨‹åºçš„å¤„ç†èƒ½åŠ›ã€‚ æœ‰äº›æ–‡ç« ä¸­æåˆ°ï¼Œpost ä¼šå°† header å’Œ body åˆ†å¼€å‘é€ï¼Œå…ˆå‘é€ headerï¼ŒæœåŠ¡ç«¯è¿”å› 100 çŠ¶æ€ç å†å‘é€ bodyã€‚ HTTP åè®®ä¸­æ²¡æœ‰æ˜ç¡®è¯´æ˜ POST ä¼šäº§ç”Ÿä¸¤ä¸ª TCP æ•°æ®åŒ…ï¼Œè€Œä¸”å®é™…æµ‹è¯•(Chrome)å‘ç°ï¼Œheader å’Œ body ä¸ä¼šåˆ†å¼€å‘é€ã€‚ æ‰€ä»¥ï¼Œheader å’Œ body åˆ†å¼€å‘é€æ˜¯éƒ¨åˆ†æµè§ˆå™¨æˆ–æ¡†æ¶çš„è¯·æ±‚æ–¹æ³•ï¼Œä¸å±äº post å¿…ç„¶è¡Œä¸ºã€‚ PUTï¼šæ›´æ–°èµ„æºï¼ˆå¸¦è¯·æ±‚ä½“ï¼‰ PUTè¯·æ±‚ï¼šå¦‚æœä¸¤ä¸ªè¯·æ±‚ç›¸åŒï¼Œåä¸€ä¸ªè¯·æ±‚ä¼šæŠŠç¬¬ä¸€ä¸ªè¯·æ±‚è¦†ç›–æ‰ã€‚ï¼ˆæ‰€ä»¥PUTç”¨æ¥æ”¹èµ„æºï¼‰Postè¯·æ±‚ï¼šåä¸€ä¸ªè¯·æ±‚ä¸ä¼šæŠŠç¬¬ä¸€ä¸ªè¯·æ±‚è¦†ç›–æ‰ã€‚ï¼ˆæ‰€ä»¥Postç”¨æ¥å¢èµ„æºï¼‰ PATCH ï¼š æ˜¯å¯¹ PUT æ–¹æ³•çš„è¡¥å……ï¼Œç”¨æ¥å¯¹å·²çŸ¥èµ„æºè¿›è¡Œå±€éƒ¨æ›´æ–° ã€‚æ¯”å¦‚ä½¿ç”¨PUTæ¯æ¬¡éƒ½è¦æŠŠæ›´æ”¹åæ•°æ®å†…å®¹å…¨éƒ¨å†™ä¸Šï¼Œè€ŒPATCHåªéœ€è¦å†™ä¸Šæ›´æ”¹éƒ¨åˆ†çš„å­—æ®µå³å¯ DELETEï¼šåˆ é™¤èµ„æº CONNECTï¼šæ–¹æ³•å»ºç«‹ä¸€ä¸ªåˆ°ç”±ç›®æ ‡èµ„æºæ ‡è¯†çš„æœåŠ¡å™¨çš„éš§é“ã€‚ OPTIONSï¼šæ–¹æ³•ç”¨äºæè¿°ç›®æ ‡èµ„æºçš„é€šä¿¡é€‰é¡¹ã€‚ HEADï¼š åªè¯·æ±‚é¡µé¢çš„é¦–éƒ¨ã€‚ è¯·æ±‚æŠ¥æ–‡ï¼š 1.è¡Œ ç¬¬ä¸€éƒ¨åˆ†æ˜¯è¯·æ±‚ç±»å‹ï¼ˆGETã€POSTä¹‹ç±»çš„ï¼‰ ç¬¬äºŒéƒ¨åˆ†æ˜¯urlçš„è·¯å¾„ ç¬¬ä¸‰éƒ¨åˆ†æ˜¯httpåè®®çš„ç‰ˆæœ¬ï¼ˆç›®å‰ä½¿ç”¨æœ€å¤šçš„æ˜¯1.1ï¼‰ 2.å¤´ï¼ˆé¦–éƒ¨ï¼‰ æ ¼å¼æ˜¯å€¼é”®å¯¹çš„å½¢å¼ Host: atguigu.com Cookie: name=guigu Content-type = application/x-www-form-urlencoded User-Agent: chrome 83 3.ç©ºè¡Œ 4.ä½“ GETçš„è¯ï¼Œè¯·æ±‚ä½“ä¸ºç©ºï¼ŒPOSTçš„è¯ï¼Œè¯·æ±‚ä½“å¯ä»¥ä¸ä¸ºç©º å“åº”æŠ¥æ–‡ 1.è¡Œ ç¬¬ä¸€éƒ¨åˆ†æ˜¯httpåè®®çš„ç‰ˆæœ¬ï¼ˆç›®å‰ä½¿ç”¨æœ€å¤šçš„æ˜¯1.1ï¼‰ ç¬¬äºŒéƒ¨åˆ†æ˜¯å“åº”çŠ¶æ€ç  ç¬¬ä¸‰æ˜¯å“åº”çŠ¶æ€å­—ç¬¦ä¸² 2.å¤´ ï¼ˆé¦–éƒ¨ï¼‰ æ ¼å¼å’Œè¯·æ±‚å¤´ä¸€æ · 3.ç©ºè¡Œ 4.ä½“ htmlçš„å†…å®¹ Content-Type: å†…å®¹ç±»å‹ï¼Œä¸€èˆ¬æ˜¯æŒ‡ç½‘é¡µä¸­å­˜åœ¨çš„Content-Typeï¼Œç”¨äºå®šä¹‰ç½‘ç»œæ–‡ä»¶çš„ç±»å‹å’Œç½‘é¡µçš„ç¼–ç ï¼Œå†³å®šæ–‡ä»¶æ¥æ”¶æ–¹å°†ä»¥ä»€ä¹ˆå½¢å¼ã€ä»€ä¹ˆç¼–ç è¯»å–è¿™ä¸ªæ–‡ä»¶ï¼Œè¿™å°±æ˜¯ç»å¸¸çœ‹åˆ°ä¸€äº›Aspç½‘é¡µç‚¹å‡»çš„ç»“æœå´æ˜¯ä¸‹è½½åˆ°çš„ä¸€ä¸ªæ–‡ä»¶æˆ–ä¸€å¼ å›¾ç‰‡çš„åŸå› ã€‚ ContentTypeå±æ€§æŒ‡å®šå“åº”çš„ HTTPå†…å®¹ç±»å‹ã€‚å¦‚æœæœªæŒ‡å®š ContentTypeï¼Œé»˜è®¤ä¸ºTEXT/HTMLã€‚ å¸¸è§çš„Content-Typeæœ‰æ•°ç™¾ä¸ªï¼Œä¸‹é¢ä¾‹ä¸¾äº†ä¸€äº› HTMLæ–‡æ¡£æ ‡è®°ï¼štext/html;æ™®é€šASCIIæ–‡æ¡£æ ‡è®°ï¼štext/html;JPEGå›¾ç‰‡æ ‡è®°ï¼šimage/jpeg;GIFå›¾ç‰‡æ ‡è®°ï¼šimage/gif;jsæ–‡æ¡£æ ‡è®°ï¼šapplication/javascript;xmlæ–‡ä»¶æ ‡è®°ï¼šapplication/xml;æ›´å¤šå…·ä½“å†…å®¹å¯å‚è€ƒã€Šå›¾è§£HTTPã€‹ æŠ¥æ–‡å’Œå®ä½“ httpæŠ¥æ–‡å’Œhttpå®ä½“æ˜¯ä¸åŒçš„æ¦‚å¿µï¼ŒhttpæŠ¥æ–‡ç±»ä¼¼äºè¿è¾“çš„ç®±å­ï¼Œhttpå®ä½“ç±»ä¼¼äºç®±å­ä¸­çš„è´§ç‰©ï¼ˆä¸ªäººæ„Ÿè§‰ å®ä½“ = æŠ¥æ–‡ - è¡Œ - é™¤äº†å®ä½“é¦–éƒ¨å­—æ®µçš„æ‰€æœ‰é¦–éƒ¨å­—æ®µï¼‰ æŠ¥æ–‡ï¼šç½‘ç»œä¸­äº¤æ¢å’Œä¼ è¾“çš„æ•°æ®å•å…ƒï¼Œå³ä¸€æ¬¡æ€§è¦å‘é€çš„æ•°æ®å—ï¼ŒåŒ…å«äº†å‘é€çš„å®Œæ•´æ•°æ®ä¿¡æ¯ å®ä½“ï¼šä½œä¸ºè¯·æ±‚å’Œå“åº”çš„æœ‰æ•ˆè½½è·æ•°æ® httpå·¥ä½œ åœ°å€è§£æï¼Œé€šè¿‡DNSè§£æåŸŸå,å¾—ä¸»æœºçš„IPåœ°å€ å°è£…httpçš„è¯·æ±‚æ•°æ®åŒ… å°è£…æˆTCPåŒ…ï¼Œå»ºç«‹TCPè¿æ¥ï¼ˆä¸‰æ¬¡æ¡æ‰‹ï¼‰ å®¢æˆ·ç«¯å‘æœåŠ¡å™¨å‘é€è¯·æ±‚ æœåŠ¡å™¨å‘å®¢æˆ·ç«¯è¿”å›å“åº” å…³é—­TCPè¿æ¥ï¼ˆå››æ¬¡æŒ¥æ‰‹ï¼‰ http onlyå¦‚æœæƒ³è¦å®ç°æœåŠ¡ç«¯è®¾ç½®cookieï¼Œè¿”å›æ—¶è®©å®¢æˆ·ç«¯æ— æ³•æŸ¥çœ‹ï¼Œå¯ä»¥ä½¿ç”¨ HttpOnlyå±æ€§ ï¼ˆMDNï¼šæœ‰ä¸¤ç§æ–¹æ³•å¯ä»¥ç¡®ä¿ Cookie è¢«å®‰å…¨å‘é€ï¼Œå¹¶ä¸”ä¸ä¼šè¢«æ„å¤–çš„å‚ä¸è€…æˆ–è„šæœ¬è®¿é—®ï¼šSecure å±æ€§å’ŒHttpOnly å±æ€§ã€‚ï¼‰ HttpOnly = true çš„è¯ï¼Œé‚£æ­¤Cookie åªèƒ½é€šè¿‡æœåŠ¡å™¨ç«¯ä¿®æ”¹ï¼ŒJs æ˜¯æ“ä½œä¸äº†çš„ï¼Œå¯¹äº document.cookie æ¥è¯´æ˜¯é€æ˜çš„ æ­¤é¢„é˜²æªæ–½æœ‰åŠ©äºç¼“è§£è·¨ç«™ç‚¹è„šæœ¬ï¼ˆXSSï¼‰ (en-US)æ”»å‡»ã€‚ 2.æŒä¹…è¿æ¥åœ¨httpåˆå§‹åè®®ç‰ˆæœ¬ä¸­ï¼Œæ¯è¿›è¡Œä¸€æ¬¡httpé€šä¿¡éƒ½è¦æ–­å¼€ä¸€æ¬¡TCPè¿æ¥ï¼Œå¦‚æœéœ€è¦åŒæ—¶è¯·æ±‚å¤šä¸ªèµ„æºæ—¶å°±é€ æˆäº†æ— ç¼˜æ— æ•…çš„TCPè¿æ¥å»ºç«‹å’Œæ–­å¼€ï¼Œé€ æˆèµ„æºæµªè´¹ï¼Œå¢åŠ é€šä¿¡å¼€é”€ã€‚ ä¸ºäº†è§£å†³ä¸Šè¿°é—®é¢˜ï¼Œhttp/1.1å’Œhttp/1.0æƒ³å‡ºäº†æŒä¹…è¿æ¥çš„æ–¹æ³•ï¼Œå…¶ç‰¹ç‚¹æ˜¯åªè¦ä¸€æ–¹æ²¡æœ‰æ˜ç¡®æå‡ºæ–­å¼€ï¼Œå°±ä¿æŒTCPè¿æ¥ã€‚åœ¨ http/1.1 ä¸­ï¼Œæ‰€æœ‰çš„è¿æ¥é»˜è®¤éƒ½æ˜¯æŒä¹…è¿æ¥ æ¯”è¾ƒæ–°çš„è½®è¯¢æŠ€æœ¯æ˜¯Cometã€‚è¿™ç§æŠ€æœ¯è™½ç„¶å¯ä»¥å®ç°åŒå‘é€šä¿¡ï¼Œä½†ä»ç„¶éœ€è¦åå¤å‘å‡ºè¯·æ±‚ã€‚è€Œä¸”åœ¨Cometä¸­æ™®éé‡‡ç”¨çš„HTTPæŒä¹…è¿æ¥ä¹Ÿä¼šæ¶ˆè€—æœåŠ¡å™¨èµ„æºã€‚ å®¢æˆ·ç«¯ï¼Œè¯·æ±‚å¤´ Connection: Keep-AliveæœåŠ¡ç«¯ï¼Œå“åº”å¤´ Connection: Keep-Aliveåœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒHTML5å®šä¹‰äº†WebSocketåè®®ï¼Œèƒ½æ›´å¥½çš„èŠ‚çœæœåŠ¡å™¨èµ„æºå’Œå¸¦å®½ï¼Œå¹¶ä¸”èƒ½å¤Ÿæ›´å®æ—¶åœ°è¿›è¡Œé€šè®¯ã€‚ å»¶ä¼¸å‡ºæ¥çš„ç®¡çº¿åŒ–æŒä¹…è¿æ¥ä½¿å¾—ç®¡çº¿åŒ–çš„æ–¹å¼æˆä¸ºå¯èƒ½ï¼Œç®¡çº¿åŒ–æŠ€æœ¯å‡ºç°åï¼Œä¸ç”¨ç­‰å¾…å³å¯å‘é€ä¸‹ä¸ªè¯·æ±‚ éç®¡é“åŒ–ï¼Œå®Œå…¨ä¸²è¡Œæ‰§è¡Œï¼Œè¯·æ±‚-&gt;å“åº”-&gt;è¯·æ±‚-&gt;å“åº”â€¦ï¼Œåä¸€ä¸ªè¯·æ±‚å¿…é¡»åœ¨å‰ä¸€ä¸ªå“åº”ä¹‹åå‘é€ã€‚ ç®¡é“åŒ–ï¼Œè¯·æ±‚å¯ä»¥å¹¶è¡Œå‘å‡ºï¼Œä½†æ˜¯å“åº”å¿…é¡»ä¸²è¡Œè¿”å›ã€‚åä¸€ä¸ªå“åº”å¿…é¡»åœ¨å‰ä¸€ä¸ªå“åº”ä¹‹åã€‚åŸå› æ˜¯ï¼Œæ²¡æœ‰åºå·æ ‡æ˜é¡ºåºï¼Œåªèƒ½ä¸²è¡Œæ¥æ”¶ã€‚ ç®¡é“åŒ–è¯·æ±‚çš„è‡´å‘½å¼±ç‚¹: ä¼šé€ æˆé˜Ÿå¤´é˜»å¡ï¼Œå‰ä¸€ä¸ªå“åº”æœªåŠæ—¶è¿”å›ï¼Œåé¢çš„å“åº”è¢«é˜»å¡ è¯·æ±‚å¿…é¡»æ˜¯å¹‚ç­‰è¯·æ±‚ï¼Œä¸èƒ½ä¿®æ”¹èµ„æºã€‚å› ä¸ºï¼Œæ„å¤–ä¸­æ–­æ—¶å€™ï¼Œå®¢æˆ·ç«¯éœ€è¦æŠŠæœªæ”¶åˆ°å“åº”çš„è¯·æ±‚é‡å‘ï¼Œéå¹‚ç­‰è¯·æ±‚ï¼Œä¼šé€ æˆèµ„æºç ´åã€‚ ç”±äºè¿™ä¸ªåŸå› ï¼Œç›®å‰å¤§éƒ¨åˆ†æµè§ˆå™¨å’ŒWebæœåŠ¡å™¨ï¼Œéƒ½å…³é—­äº†ç®¡é“åŒ–ï¼Œé‡‡ç”¨éç®¡é“åŒ–æ¨¡å¼ã€‚ æ— è®ºæ˜¯éç®¡é“åŒ–è¿˜æ˜¯ç®¡é“åŒ–ï¼Œéƒ½ä¼šé€ æˆé˜Ÿå¤´é˜»å¡(è¯·æ±‚é˜»å¡)ã€‚ è§£å†³httpé˜Ÿå¤´é˜»å¡çš„æ–¹æ³•1. å¹¶å‘TCPè¿æ¥ï¼šä¸€ä¸ªåŸŸåå…è®¸åˆ†é…å¤šä¸ªé•¿è¿æ¥ï¼Œé‚£ä¹ˆç›¸å½“äºå¢åŠ äº†ä»»åŠ¡é˜Ÿåˆ—ï¼Œä¸è‡³äºä¸€ä¸ªé˜Ÿä¼çš„ä»»åŠ¡é˜»å¡å…¶å®ƒæ‰€æœ‰ä»»åŠ¡ã€‚ï¼ˆæµè§ˆå™¨ä¸€ä¸ªåŸŸåé‡‡ç”¨6-8ä¸ªTCPè¿æ¥ï¼Œå¹¶å‘HTTPè¯·æ±‚ï¼‰2. åŸŸååˆ†ç‰‡ï¼šä¸€ä¸ªåŸŸåçš„å¹¶å‘ é•¿è¿æ¥æ•°æ˜¯ä¸€å®šçš„ï¼Œæ¯”å¦‚ä¸Šæ–¹è¯´çš„6-8ä¸ªï¼Œé‚£æˆ‘å°±å¤šåˆ†å‡ ä¸ªåŸŸåï¼ˆå¤šä¸ªåŸŸåï¼Œå¯ä»¥å»ºç«‹æ›´å¤šçš„TCPè¿æ¥ï¼Œä»è€Œæé«˜HTTPè¯·æ±‚çš„å¹¶å‘ï¼‰ 3.HTTP2æ–¹å¼ http2ä½¿ç”¨ä¸€ä¸ªåŸŸåå•ä¸€TCPè¿æ¥å‘é€è¯·æ±‚ï¼Œè¯·æ±‚åŒ…è¢«äºŒè¿›åˆ¶åˆ†å¸§ï¼Œä¸åŒè¯·æ±‚å¯ä»¥äº’ç›¸ç©¿æ’ï¼Œé¿å…äº†httpå±‚é¢çš„è¯·æ±‚é˜Ÿå¤´é˜»å¡ã€‚ä½†æ˜¯ä¸èƒ½é¿å…TCPå±‚é¢çš„é˜Ÿå¤´é˜»å¡ã€‚ 3.é¦–éƒ¨å­—æ®µæ¦‚è¿°HTTP æŠ¥æ–‡åŒ…å«æŠ¥æ–‡é¦–éƒ¨å’ŒæŠ¥æ–‡ä¸»ä½“ï¼ŒæŠ¥æ–‡é¦–éƒ¨åŒ…å«è¯·æ±‚è¡Œï¼ˆæˆ–çŠ¶æ€è¡Œï¼‰å’Œé¦–éƒ¨å­—æ®µã€‚ åœ¨æŠ¥æ–‡ä¼—å¤šçš„å­—æ®µå½“ä¸­ï¼ŒHTTP é¦–éƒ¨å­—æ®µåŒ…å«çš„ä¿¡æ¯æœ€ä¸ºä¸°å¯Œã€‚é¦–éƒ¨å­—æ®µåŒæ—¶å­˜åœ¨äºè¯·æ±‚å’Œå“åº”æŠ¥æ–‡å†…ï¼Œå¹¶æ¶µç›– HTTP æŠ¥æ–‡ç›¸å…³çš„å†…å®¹ä¿¡æ¯ã€‚ä½¿ç”¨é¦–éƒ¨å­—æ®µæ˜¯ä¸ºäº†ç»™å®¢æœç«¯å’ŒæœåŠ¡å™¨ç«¯æä¾›æŠ¥æ–‡ä¸»ä½“å¤§å°ã€æ‰€ä½¿ç”¨çš„è¯­è¨€ã€è®¤è¯ä¿¡æ¯ç­‰å†…å®¹ã€‚ ç»“æ„ æ ¼å¼æ˜¯å€¼é”®å¯¹çš„å½¢å¼ ç±»å‹åˆ†ä¸ºï¼š é€šç”¨é¦–éƒ¨å­—æ®µï¼ˆè¯·æ±‚å’Œå“åº”é€šç”¨ï¼‰Cache-Controlã€Connectionç­‰ è¯·æ±‚é¦–éƒ¨å­—æ®µï¼ˆè¯·æ±‚ä¸“ç”¨ï¼‰Acceptã€Accept-Charsetã€Hostï¼ˆè¯·æ±‚èµ„æºæ‰€åœ¨æœåŠ¡å™¨ï¼‰ç­‰ å“åº”é¦–éƒ¨å­—æ®µï¼ˆå“åº”ä¸“ç”¨ï¼‰Accept-Rangesã€Locationï¼ˆä»¤å®¢æˆ·ç«¯é‡å®šå‘è‡³æŒ‡å®š URIï¼‰ã€Serverï¼ˆHTTP æœåŠ¡å™¨åº”ç”¨ç¨‹åºçš„ä¿¡æ¯ï¼‰ç­‰ å®ä½“é¦–éƒ¨å­—æ®µï¼ˆé€šç”¨ï¼Œé’ˆå¯¹æŠ¥æ–‡çš„å®ä½“éƒ¨åˆ†ï¼‰Allowã€Content-Encodingç­‰ 4.å“åº”çŠ¶æ€ç 100ï¼šä¿¡æ¯å‹çŠ¶æ€å“åº”ç è¡¨ç¤ºç›®å‰ä¸ºæ­¢ä¸€åˆ‡æ­£å¸¸, å®¢æˆ·ç«¯åº”è¯¥ç»§ç»­è¯·æ±‚, å¦‚æœå·²å®Œæˆè¯·æ±‚åˆ™å¿½ç•¥. 101ï¼šHTTP **101 Switching Protocol**ï¼ˆåè®®åˆ‡æ¢ï¼‰çŠ¶æ€ç è¡¨ç¤ºæœåŠ¡å™¨åº”å®¢æˆ·ç«¯**å‡çº§åè®®**çš„è¯·æ±‚å¯¹åè®®è¿›è¡Œåˆ‡æ¢ã€‚ 200ï¼šok 201ï¼šä»£è¡¨æˆåŠŸçš„åº”ç­”çŠ¶æ€ç ï¼Œè¡¨ç¤ºè¯·æ±‚å·²ç»è¢«æˆåŠŸå¤„ç†ï¼Œå¹¶ä¸”åˆ›å»ºäº†æ–°çš„èµ„æºï¼Œå¸¸è§„ä½¿ç”¨åœºæ™¯æ˜¯ä½œä¸º POST ã€PUTè¯·æ±‚çš„è¿”å›å€¼ 204ï¼šæœåŠ¡å™¨æ¥æ”¶çš„è¯·æ±‚å·²æˆåŠŸå¤„ç†ï¼Œä½†åœ¨è¿”å›çš„å“åº”æŠ¥æ–‡ä¸­ä¸å«å®ä½“çš„ä¸»ä½“éƒ¨åˆ†ã€‚å¦å¤–ï¼Œä¹Ÿä¸å…è®¸è¿”å›ä»»ä½•å®ä½“çš„ä¸»ä½“ã€‚ 206ï¼šå®¢æˆ·ç«¯è¿›è¡Œäº†èŒƒå›´è¯·æ±‚ï¼ŒæœåŠ¡å™¨æˆåŠŸæ‰§è¡Œéƒ¨åˆ†getè¯·æ±‚ 301ï¼šæ°¸ä¹…é‡å®šå‘ ç¬¬ä¸€æ¬¡è¿›å…¥a.comï¼Œè¯·æ±‚-&gt;b.comï¼Œä»¥åæ¯æ¬¡è¿›å…¥a.comå°±ä¸ç”¨è¯·æ±‚ç›´æ¥å»b.comï¼ˆè¯·æ±‚çš„èµ„æºå·²è¢«æ°¸ä¹…åˆ†é…äº†æ–°çš„ URIï¼‰ 302ï¼šä¸´æ—¶é‡å®šå‘ï¼ˆæš‚æ—¶æ€§è½¬ç§»ï¼‰ æ¯ä¸€æ¬¡éƒ½ä¼šè¿›å…¥a.comï¼Œç„¶åè¯·æ±‚-&gt;b.comï¼ˆè¯·æ±‚çš„èµ„æºå·²è¢«ä¸´æ—¶åˆ†é…äº†æ–°çš„ URIï¼‰ 303ï¼šæœ‰ç‚¹åƒ302ï¼Œåªä¸è¿‡303æé†’ä½ åº”è¯¥ä½¿ç”¨getè¯·æ±‚ 304ï¼šè‡ªä»ä¸Šæ¬¡è¯·æ±‚åï¼Œè¯·æ±‚çš„ç½‘é¡µæœªä¿®æ”¹è¿‡ï¼Œæ‰€ä»¥æ²¡æœ‰å“åº”ä¸»ä½“éƒ¨åˆ† 307ï¼šåŒ302 400ï¼šæŠ¥æ–‡å­˜åœ¨è¯­æ³•é”™è¯¯ 401ï¼šæœªæˆæƒï¼Œè¯·æ±‚ç”¨æˆ·èº«ä»½è®¤è¯ 403ï¼šæœåŠ¡å™¨ç†è§£äº†è¯·æ±‚ä½†æ‹’ç»å¯¹å…¶è¿›è¡Œæˆæƒï¼Œè¢«ç¦æ­¢ï¼Œèµ„æºè®¿é—®è¢«æœåŠ¡å™¨æ‹’ç»äº† 404ï¼šæ‰¾ä¸åˆ° 413ï¼šè¡¨ç¤ºhttpè¯·æ±‚å®ä½“å¤ªå¤§ã€‚ 500ï¼šå†…éƒ¨é”™è¯¯ 502ï¼šé”™è¯¯ç½‘å…³ï¼Œä»ä¸Šæ¸¸æœåŠ¡å™¨æ”¶åˆ°æ— æ•ˆå“åº”ï¼Œå¯èƒ½ä¹Ÿæ˜¯åœæœºç»´æŠ¤ï¼Œæˆ–è€…æœåŠ¡å™¨æš‚æœªå¼€å¯ï¼Œ 503ï¼šæœåŠ¡å™¨ç›®å‰æ— æ³•ä½¿ç”¨ï¼ˆç”±äºè¶…è½½æˆ–åœæœºç»´æŠ¤ï¼‰é€šå¸¸ï¼Œè¿™åªæ˜¯æš‚æ—¶çŠ¶æ€ã€‚ï¼ˆæœåŠ¡ä¸å¯ç”¨ï¼‰ 504ï¼šç½‘å…³è¶…æ—¶ 5.httpç¼“å­˜å¸¸è§çš„httpç¼“å­˜åªèƒ½ç¼“å­˜getè¯·æ±‚å“åº”çš„èµ„æºï¼Œå¯¹äºå…¶ä»–ç±»å‹çš„å“åº”åˆ™æ— èƒ½ä¸ºåŠ›ã€‚å¯¹äºå¼€å‘è€…æ¥è¯´ï¼Œé•¿ä¹…ç¼“å­˜å¤ç”¨é‡å¤ä¸å˜çš„èµ„æºæ˜¯æ€§èƒ½ä¼˜åŒ–çš„é‡è¦ç»„æˆéƒ¨åˆ†ï¼ï¼ï¼ æµè§ˆå™¨ç¬¬ä¸€æ¬¡å‘ä¸€ä¸ªwebæœåŠ¡å™¨å‘èµ·httpè¯·æ±‚åï¼ŒæœåŠ¡å™¨ä¼šè¿”å›è¯·æ±‚çš„èµ„æºï¼Œå¹¶ä¸”åœ¨å“åº”å¤´ä¸­æ·»åŠ ä¸€äº›æœ‰å…³ç¼“å­˜çš„å­—æ®µï¼ˆæ·»åŠ åæµè§ˆå™¨æ‰çŸ¥é“æ˜¯å¦åº”è¯¥ç¼“å­˜èµ„æºï¼‰å¦‚ï¼š Cache-Controlï¼ˆæ§åˆ¶æµè§ˆå™¨æ˜¯å¦å¯ä»¥ç¼“å­˜èµ„æºã€å¼ºåˆ¶ç¼“å­˜æ ¡éªŒã€ç¼“å­˜æ—¶é—´ï¼‰ï¼ˆé€šç”¨å¤´éƒ¨ï¼‰ no-cacheï¼šå«ä¹‰æ˜¯ä¸ä½¿ç”¨æœ¬åœ°ç¼“å­˜ï¼Œéœ€è¦ä½¿ç”¨åå•†ç¼“å­˜ï¼Œä¹Ÿå°±æ˜¯å…ˆä¸æœåŠ¡å™¨ç¡®è®¤ç¼“å­˜æ˜¯å¦å¯ç”¨ã€‚ no-storeï¼šç¦ç”¨ç¼“å­˜ã€‚ publicï¼šè¡¨æ˜å…¶ä»–ç”¨æˆ·ä¹Ÿå¯ä½¿ç”¨ç¼“å­˜ï¼Œé€‚ç”¨äºå…¬å…±ç¼“å­˜æœåŠ¡å™¨çš„æƒ…å†µã€‚ privateï¼šè¡¨æ˜åªæœ‰ç‰¹å®šç”¨æˆ·æ‰èƒ½ä½¿ç”¨ç¼“å­˜ï¼Œé€‚ç”¨äºå…¬å…±ç¼“å­˜æœåŠ¡å™¨çš„æƒ…å†µ max-ageï¼šæœ€å¤§æœ‰æ•ˆæ—¶é—´ Expiresï¼ˆä¸å“åº”å¤´ä¸­çš„ Date å¯¹æ¯”ï¼‰ï¼ˆå®ä½“å¤´éƒ¨ï¼‰ Expires æ›´å¤šçš„æ˜¯ä¸ºäº†å…¼å®¹æ—§æµè§ˆå™¨ï¼ˆåªæ”¯æŒ HTTP/1.0 çš„ä¸Šå¤æ—¶ä»£æµè§ˆå™¨ï¼‰çš„å“åº”æ ‡å¤´ã€‚ ä» HTTP/1.1 ä»¥åå°±æœ‰äº† Cache-Control æ ‡å¤´ä¸­çš„ max-ageï¼Œè®¾ä¸€ä¸ªç§’æ•°ï¼›è€Œæ˜¯ Expires è®¾ä¸€ä¸ªå…·ä½“çš„æ—¶é—´ç‚¹ï¼Œæ˜¾ç„¶ Expires å¯èƒ½å› ä¸ºå®¢æˆ·ç«¯ä¸æœåŠ¡ç«¯æ—¶é—´ä¸ä¸€è‡´ã€æˆ–ç½‘ç»œå»¶è¿Ÿå¯¼è‡´è¿‡æœŸæ—¶é—´ä¸å‡†ç¡®ï¼Œå¹¶ä¸” Cache-Control èƒ½è®¾çš„å€¼æ›´å¤šä¹Ÿå°±æ›´çµæ´»ã€‚ Last-Modifiedï¼ˆå¼±æ ¡éªŒï¼Œ æ ¹æ®æ–‡ä»¶ä¿®æ”¹æ—¶é—´æ ¡éªŒï¼Œå¯èƒ½å†…å®¹æœªå˜ï¼Œä¸ç²¾ç¡®ï¼‰ï¼ˆå®ä½“å¤´éƒ¨ï¼‰ ETagï¼ˆå¼ºæ ¡éªŒï¼Œæ ¹æ®æ–‡ä»¶å†…å®¹æ ¡éªŒç²¾ç¡®ï¼Œè¿™ä¹Ÿæ˜¯æœ‰äº†Last-modifiedè¿˜è¦æœ‰ETagçš„åŸå› ï¼Œ å¯ä»¥çœ‹ä½œ Etagæ˜¯last-Modifedçš„è¡¥å……ï¼Œä½†æ˜¯æ£€æŸ¥æ—¶ Etagå…ˆæ£€æŸ¥ ï¼‰ï¼ˆå“åº”å¤´éƒ¨ï¼‰ Dateç­‰ç­‰ã€‚ httpç¼“å­˜éƒ½æ˜¯ä»ç¬¬äºŒæ¬¡è¯·æ±‚å¼€å§‹çš„ã€‚ç¬¬äºŒæ¬¡è¯·æ±‚æ—¶ï¼Œæµè§ˆå™¨åˆ¤æ–­è¿™äº›è¯·æ±‚å‚æ•°ï¼Œå‘½ä¸­å¼ºç¼“å­˜å°±ç›´æ¥200ï¼Œå¦åˆ™å°±æŠŠè¯·æ±‚å‚æ•°åŠ åˆ°request headerå¤´ä¸­ä¼ ç»™æœåŠ¡å™¨ï¼Œçœ‹æ˜¯å¦å‘½ä¸­åå•†ç¼“å­˜ï¼ˆå½“ETagå’ŒLast-ModifiedåŒæ—¶å­˜åœ¨æ—¶ï¼ŒæœåŠ¡å™¨å…ˆä¼šæ£€æŸ¥ETagï¼Œç„¶åå†æ£€æŸ¥Last-Modifiedï¼‰ï¼Œå‘½ä¸­åˆ™è¿”å›304ï¼Œå¦åˆ™æœåŠ¡å™¨ä¼šè¿”å›æ–°çš„èµ„æº ä¸ºä»€ä¹ˆæœ‰Last-Modified è¿˜è¦æœ‰ ETagï¼Ÿ è€ƒè™‘ä»¥ä¸‹æƒ…å†µï¼š 1.ä¸€äº›æ–‡ä»¶ä¹Ÿè®¸ä¼šå‘¨æœŸæ€§çš„æ›´æ”¹,ä½†æ˜¯ä»–çš„å†…å®¹å¹¶ä¸æ”¹å˜(ä»…ä»…æ”¹å˜çš„ä¿®æ”¹æ—¶é—´),è¿™ä¸ªæ—¶å€™,æˆ‘ä»¬å¹¶ä¸å¸Œæœ›å®¢æˆ·ç«¯è®¤ä¸ºè¿™ä¸ªæ–‡ä»¶è¢«ä¿®æ”¹äº†,è€Œé‡æ–° get2.æŸäº›æ–‡ä»¶ä¿®æ”¹éå¸¸é¢‘ç¹,æ¯”å¦‚åœ¨ç§’ä»¥ä¸‹çš„æ—¶é—´å†…è¿›è¡Œä¿®æ”¹(æ¯”æ–¹è¯´ 1s å†…ä¿®æ”¹äº† N æ¬¡),If-Modified-Sinceèƒ½æ£€æŸ¥åˆ°çš„ç²’åº¦æ—¶ s çº§çš„,è¿™ç§ä¿®æ”¹æ— æ³•åˆ¤æ–­(æˆ–è€…è¯´ UNIX è®°å½• MTIMEåªèƒ½ç²¾ç¡®åˆ°ç§’)3.æŸäº›æœåŠ¡å™¨ä¸èƒ½ç²¾ç¡®å¾—åˆ°çš„æ–‡ä»¶çš„æœ€åä¿®æ”¹æ—¶é—´ å¼ºç¼“å­˜ + åå•†ç¼“å­˜ä¹‹åæµè§ˆå™¨å†å‘è¯¥æœåŠ¡å™¨è¯·æ±‚è¯¥èµ„æºå°±å¯ä»¥è§†æƒ…å†µä½¿ç”¨å¼ºç¼“å­˜å’Œåå•†ç¼“å­˜ã€‚ å¼ºç¼“å­˜ï¼šï¼ˆå½“å‰ç¼“å­˜æœªè¿‡æœŸï¼‰æµè§ˆå™¨ç›´æ¥ä»æœ¬åœ°ç¼“å­˜ä¸­è·å–æ•°æ®ï¼Œä¸ä¸æœåŠ¡å™¨è¿›è¡Œäº¤äº’ã€‚ åå•†ç¼“å­˜ï¼šï¼ˆå½“å‰ç¼“å­˜è¿‡æœŸï¼‰æµè§ˆå™¨å‘é€è¯·æ±‚åˆ°æœåŠ¡å™¨ï¼ŒæœåŠ¡å™¨åˆ¤å®šæ˜¯å¦å¯ä½¿ç”¨æœ¬åœ°ç¼“å­˜ã€‚ è”ç³»ä¸åŒºåˆ«ï¼šä¸¤ç§ç¼“å­˜æ–¹å¼æœ€ç»ˆä½¿ç”¨çš„éƒ½æ˜¯æœ¬åœ°ç¼“å­˜ï¼›å‰è€…æ— éœ€ä¸æœåŠ¡å™¨äº¤äº’ï¼Œåè€…éœ€è¦ã€‚ ç¼“å­˜è¿‡æœŸç­–ç•¥1ã€è®¾ç½® Cache-Control: max-age=1000 ã€‚å“åº”å¤´ä¸­çš„ Date ç»è¿‡ 1000s è¿‡æœŸï¼ˆæ¯”èµ·é¦–éƒ¨å­—æ®µExpiresï¼Œä¼šä¼˜å…ˆå¤„ç†s-maxageæˆ–max-ageã€‚ï¼‰ï¼ˆCache-ControlHTTP / 1.1é€šç”¨å¤´å­—æ®µè¢«ç”¨äºä¸ºè¯·æ±‚å’Œå“åº”ç¼“å­˜æœºåˆ¶æŒ‡å®šæŒ‡ä»¤lï¼‰2ã€è®¾ç½® Expires ã€‚æ­¤æ—¶é—´ä¸æœ¬åœ°æ—¶é—´(å“åº”å¤´ä¸­çš„ Date )å¯¹æ¯”ï¼Œå°äºæœ¬åœ°æ—¶é—´è¡¨ç¤ºè¿‡æœŸï¼Œç”±äºæœ¬åœ°æ—¶é’Ÿä¸æœåŠ¡å™¨æ—¶é’Ÿæ— æ³•ä¿æŒä¸€è‡´ï¼Œå¯¼è‡´æ¯”è¾ƒä¸ç²¾ç¡®ï¼Œä¹Ÿå°±æ˜¯è¯´å¦‚æœä¿®æ”¹äº†æœ¬åœ°æ—¶é—´ï¼Œå¯èƒ½ä¼šé€ æˆç¼“å­˜å¤±æ•ˆã€‚ï¼ˆhttp1.0æ—¶ä»£ï¼ŒPragmaä¹Ÿæ˜¯1.0æ—¶ä»£çš„äº§ç‰©ï¼‰3ã€å¦‚æœä»¥ä¸Šå‡æœªè®¾ç½®ï¼Œå´è®¾ç½®äº† Last-Modified ï¼Œæµè§ˆå™¨éšå¼çš„è®¾ç½®èµ„æºè¿‡æœŸæ—¶é—´ä¸º (Date - Last-Modified) * 10% ç¼“å­˜è¿‡æœŸæ—¶é—´ã€‚ å‰ç«¯ç¼“å­˜å›¾ï¼š æ·»åŠ è™šæ‹Ÿå‚æ•°ï¼Œé¿å…å‘½ä¸­ç¼“å­˜æœ‰æ—¶å€™æˆ‘ä»¬å¯èƒ½å¹¶ä¸éœ€è¦å‘½ä¸­ç¼“å­˜ï¼Œæ¯”å¦‚è¿™ä¸ªé—®é¢˜ï¼Œé‡Œé¢è®°å½•äº†å…³äºç¬¬ä¸€ä¸ªimgåœ¨è·¨åŸŸç¼“å­˜åï¼Œä¸€ç›´ä¼šæŠ¥è·¨åŸŸçš„é—®é¢˜ã€‚ è§£å†³æ–¹æ³•æ˜¯æ·»åŠ è™šæ‹Ÿå‚æ•°ï¼Œæ¯”å¦‚ const corsImageModified = new Image(); corsImageModified.crossOrigin = \"Anonymous\"; corsImageModified.src = url + \"?not-from-cache-please\"; äº¦æˆ–è€…æ˜¯ è¿™å°†å¼ºåˆ¶æµè§ˆå™¨ä¸ä½¿ç”¨ä»¥å‰çš„ç¼“å­˜å›¾åƒï¼Œè€Œæ˜¯ä¸ºå›¾åƒå‘é€æ–°çš„GETè¯·æ±‚ï¼Œæˆ‘ä»¬æ·»åŠ çš„ GET å‚æ•°æ— å…³ç´§è¦ï¼Œåªè¦ç”Ÿæˆçš„ URL ä¸åˆå§‹ï¼ˆç¼“å­˜ï¼‰å›¾åƒ URL ä¸åŒå³å¯ã€‚ 6.å…¶ä»–èŒƒå›´è¯·æ±‚å‡è®¾ä½ æ­£åœ¨ä¸‹è½½ä¸€ä¸ªå¾ˆå¤§çš„æ–‡ä»¶ï¼Œå·²ç»ä¸‹äº†å››åˆ†ä¹‹ä¸‰ï¼Œå¿½ç„¶ç½‘ç»œä¸­æ–­äº†ï¼Œé‚£ä¸‹è½½å°±å¿…é¡»é‡å¤´å†æ¥ä¸€éã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œéœ€è¦ä¸€ç§å¯æ¢å¤çš„æœºåˆ¶ï¼Œå³èƒ½ä»ä¹‹å‰ä¸‹è½½ä¸­æ–­å¤„æ¢å¤ä¸‹è½½ï¼Œè¦å®ç°è¯¥åŠŸèƒ½ï¼Œè¿™å°±è¦ç”¨åˆ°èŒƒå›´è¯·æ±‚ã€‚ï¼ˆå‰ææ˜¯ä¸Šä¸€æ¬¡è¯·æ±‚åˆ°è¿™ä¸€æ¬¡è¯·æ±‚æ—¶é—´æ®µå†…ï¼Œä¸‹è½½å¯¹è±¡æ²¡æœ‰å‘ç”Ÿæ”¹å˜ï¼‰ å½“ç„¶ï¼Œå‰ææ˜¯æœåŠ¡å™¨è¦æ”¯æŒèŒƒå›´è¯·æ±‚ï¼Œè¦æ”¯æŒè¿™ä¸ªåŠŸèƒ½ï¼Œå°±å¿…é¡»åŠ ä¸Šè¿™æ ·ä¸€ä¸ªå“åº”å¤´: Accept-Ranges: none å•ä¸€èŒƒå›´ï¼šæˆ‘ä»¬å¯ä»¥è¯·æ±‚èµ„æºçš„æŸä¸€éƒ¨åˆ† å¤šé‡èŒƒå›´ï¼šä¸€æ¬¡è¯·æ±‚æ–‡æ¡£çš„å¤šä¸ªéƒ¨åˆ† æ¡ä»¶å¼èŒƒå›´ï¼šå½“ï¼ˆä¸­æ–­ä¹‹åï¼‰é‡æ–°å¼€å§‹è¯·æ±‚æ›´å¤šèµ„æºç‰‡æ®µçš„æ—¶å€™ï¼Œå¿…é¡»ç¡®ä¿è‡ªä»ä¸Šä¸€ä¸ªç‰‡æ®µè¢«æ¥æ”¶ä¹‹åè¯¥èµ„æºæ²¡æœ‰è¿›è¡Œè¿‡ä¿®æ”¹ã€‚ HTTPä»£ç†ä»£ç†æœ‰ä¸‰ä¸ªå¤§åŠŸèƒ½ 1.è´Ÿè½½å‡è¡¡ 2.ä¿éšœå®‰å…¨ 3.ç¼“å­˜ä»£ç† Viaé¦–éƒ¨å­—æ®µï¼šé‡Œå­˜å‚¨ç€ä»£ç†æœåŠ¡å™¨åç§°ï¼Œä»–ä»¬çš„é¡ºåºä¸ºHTTP ä¼ è¾“ä¸­æŠ¥æ–‡ä¼ è¾¾çš„é¡ºåºã€‚ X-Forwarded-Foré¦–éƒ¨å­—æ®µï¼šå®ƒè®°å½•çš„æ˜¯è¯·æ±‚æ–¹çš„IPåœ°å€ï¼Œä½†æ˜¯è¿™æ„å‘³ç€æ¯ç»è¿‡ä¸€ä¸ªä¸åŒçš„ä»£ç†ï¼Œè¿™ä¸ªå­—æ®µçš„åå­—éƒ½è¦å˜ ä½†æ˜¯è¿™ä¼šäº§ç”Ÿä¸¤ä¸ªé—®é¢˜: æ„å‘³ç€ä»£ç†å¿…é¡»è§£æ HTTP è¯·æ±‚å¤´ï¼Œç„¶åä¿®æ”¹ï¼Œæ¯”ç›´æ¥è½¬å‘æ•°æ®æ€§èƒ½ä¸‹é™ã€‚ åœ¨ HTTPS é€šä¿¡åŠ å¯†çš„è¿‡ç¨‹ä¸­ï¼ŒåŸå§‹æŠ¥æ–‡æ˜¯ä¸å…è®¸ä¿®æ”¹çš„ã€‚ ç”±æ­¤äº§ç”Ÿäº†ä»£ç†åè®®ï¼Œä¸€èˆ¬ä½¿ç”¨æ˜æ–‡ç‰ˆæœ¬ï¼Œåªéœ€è¦åœ¨ HTTP è¯·æ±‚è¡Œä¸Šé¢åŠ ä¸Šè¿™æ ·æ ¼å¼çš„æ–‡æœ¬å³å¯: // PROXY + TCP4/TCP6 + è¯·æ±‚æ–¹åœ°å€ + æ¥æ”¶æ–¹åœ°å€ + è¯·æ±‚ç«¯å£ + æ¥æ”¶ç«¯å£ PROXY TCP4 0.0.0.1 0.0.0.2 1111 2222 GET / HTTP/1.1 ... å¤åˆ¶ä»£ç è¿™æ ·å°±å¯ä»¥è§£å†³X-Forwarded-Forå¸¦æ¥çš„é—®é¢˜äº†ã€‚ X-Real-IPé¦–éƒ¨å­—æ®µï¼šå§‹ç»ˆè®°å½•æœ€åˆçš„å®¢æˆ·ç«¯çš„IP åˆ¤æ–­æ˜¯å¦å¼±ç½‘ç¯å¢ƒ// åˆ¤æ–­æ˜¯å¦ä¸ºå¼±ç½‘ç¯å¢ƒ const isSlowNetwork = navigator.connection ? navigator.connection.saveData || (navigator.connection.type !== 'wifi' &amp;&amp; navigator.connection.type !== 'ethernet' &amp;&amp; /(2|3)g/.test(navigator.connection.effectiveType)) : false; 7.QUICQuic å…¨ç§° quick udp internet connection ï¼Œâ€œå¿«é€Ÿ UDP äº’è”ç½‘è¿æ¥â€ï¼Œä¹Ÿå¯ä»¥ç†è§£ä¸ºhttp3.0 åº”ç”¨ï¼šé€Ÿåº¦æ›´å¿«ã€ç½‘ç»œåˆ‡æ¢ï¼ˆwifi -&gt; nGï¼‰æ— æ„ŸçŸ¥ç­‰ã€å¼±ç½‘ç»œç¯å¢ƒbetter å¯¹æ¯”http2.0ï¼š å‡å°‘äº† TCP ä¸‰æ¬¡æ¡æ‰‹åŠ TLS æ¡æ‰‹æ—¶é—´ã€‚ HTTPS çš„ä¸€æ¬¡å®Œå…¨æ¡æ‰‹çš„å»ºè¿è¿‡ç¨‹ï¼Œéœ€è¦ 3 ä¸ª RTTï¼Œè€ŒQUICç”±äºå»ºç«‹åœ¨UDPçš„åŸºç¡€ä¸Šï¼Œåªéœ€è¦0RTTå³å¯å®Œæˆå®‰å…¨æ¡æ‰‹ã€‚ æ”¹è¿›çš„æ‹¥å¡æ§åˆ¶ã€‚ ä¸ºå•¥ä½ ç”¨UDPä¹Ÿèƒ½å¯é å•Šï¼Ÿ TCP ä½¿ç”¨ACKï¼ˆç¡®è®¤ï¼‰ï¼Œè¿˜æœ‰åŸºäºå­—èŠ‚åºå·çš„ Sequence Numberä¸ºäº†ä¿è¯å¯é æ€§ï¼Œè€ŒQUICä¹Ÿæœ‰ä½¿ç”¨ACKï¼ˆç¡®è®¤ï¼‰å¹¶ä¸”ä»¥ Packet Number ä»£æ›¿äº† TCP çš„ sequence numberï¼› ä¼ ç»ŸTCPï¼šè¶…æ—¶äº‹ä»¶ RTO å‘ç”Ÿåï¼Œå®¢æˆ·ç«¯å‘èµ·é‡ä¼ ï¼Œç„¶åæ¥æ”¶åˆ°äº† Ack æ•°æ®ã€‚ä½†æ˜¯å› ä¸ºåºåˆ—å·ä¸€æ ·ï¼Œæ‰€ä»¥æˆ‘ä»¬åˆ†ä¸æ¸…è¿™ä¸ª Ack æ•°æ®åˆ°åº•æ˜¯åŸå§‹è¯·æ±‚çš„å“åº”ï¼Œè¿˜æ˜¯é‡ä¼ è¯·æ±‚çš„å“åº” QUIC åŒæ ·æ˜¯ä¸€ä¸ªå¯é çš„åè®®ï¼Œå®ƒä½¿ç”¨ Packet Number ä»£æ›¿äº† TCP çš„ sequence numberï¼Œå¹¶ä¸”æ¯ä¸ª Packet Number éƒ½ä¸¥æ ¼é€’å¢ï¼Œä¹Ÿå°±æ˜¯è¯´å°±ç®— Packet N ä¸¢å¤±äº†ï¼Œé‡ä¼ çš„ Packet N çš„ Packet Number å·²ç»ä¸æ˜¯ Nï¼Œè€Œæ˜¯ä¸€ä¸ªæ¯” N å¤§çš„å€¼ã€‚è€Œ TCP å‘¢ï¼Œé‡ä¼  segment çš„ sequence number å’ŒåŸå§‹çš„ segment çš„ Sequence Number ä¿æŒä¸å˜ï¼Œä¹Ÿæ­£æ˜¯ç”±äºè¿™ä¸ªç‰¹æ€§ï¼Œå¼•å…¥äº† Tcp é‡ä¼ çš„æ­§ä¹‰é—®é¢˜ã€‚ QUICï¼š å½“Packet Number å‘ç”Ÿäº†ä¸¢å¤±ï¼ŒPacket Number ä¼ é€’çš„æ•°å€¼ï¼ˆä¹Ÿå°±æ˜¯é‚£ä¸ªNumberï¼‰ä¼šä¸ä¸€æ ·ï¼Œå› ä¸ºä»–æ˜¯æŒ‰ç…§ä¸¥æ ¼é€’å¢çš„ï¼Œæ­¤æ—¶å°±å¯ä»¥å‘ç°ä¼ é€çš„å¤±è¯¯äº†ã€‚ï¼ˆåœ¨RTO å‘ç”Ÿåï¼Œå¯ä»¥ç²¾ç¡®åˆ¤æ–­Ack æ•°æ®æ˜¯åŸå§‹è¯·æ±‚çš„å“åº”ï¼Œè¿˜æ˜¯é‡ä¼ è¯·æ±‚çš„å“åº”ï¼‰ ä½†æ˜¯ä»…ä»…é  Packet Number è‚¯å®šæ˜¯æ— æ³•ä¿è¯æ•°æ®çš„é¡ºåºæ€§å’Œå¯é æ€§ï¼Œæ­¤æ—¶åˆå¼•å…¥äº† Stream Offsetã€‚ å³ä¸€ä¸ª Stream å¯ä»¥ç»è¿‡å¤šä¸ª Packet ä¼ è¾“ï¼ŒPacket Number ä¸¥æ ¼é€’å¢ï¼Œæ²¡æœ‰ä¾èµ–ã€‚ä½†æ˜¯ Packet é‡Œçš„ Payload å¦‚æœæ˜¯ Stream çš„è¯ï¼Œå°±éœ€è¦ä¾é  Stream çš„ Offset æ¥ä¿è¯åº”ç”¨æ•°æ®çš„é¡ºåºã€‚å¦‚é”™è¯¯! æœªæ‰¾åˆ°å¼•ç”¨æºã€‚æ‰€ç¤ºï¼Œå‘é€ç«¯å…ˆåå‘é€äº† Pakcet N å’Œ Pakcet N+1ï¼ŒStream çš„ Offset åˆ†åˆ«æ˜¯ x å’Œ x+yã€‚ å‡è®¾ Packet N ä¸¢å¤±äº†ï¼Œå‘èµ·é‡ä¼ ï¼Œé‡ä¼ çš„ Packet Number æ˜¯ N+2ï¼Œä½†æ˜¯å®ƒçš„ Stream çš„ Offset ä¾ç„¶æ˜¯ xï¼Œè¿™æ ·å°±ç®— Packet N + 2 æ˜¯ååˆ°çš„ï¼Œä¾ç„¶å¯ä»¥å°† Stream x å’Œ Stream x+y æŒ‰ç…§é¡ºåºç»„ç»‡èµ·æ¥ï¼Œäº¤ç»™åº”ç”¨ç¨‹åºå¤„ç†ã€‚ è¿˜æœ‰å¯æ’æ‹”ã€æ›´å¤šACKå—ç­‰ é¿å…é˜Ÿå¤´é˜»å¡çš„å¤šè·¯å¤ç”¨ã€‚ TCPé˜Ÿå¤´é˜»å¡ï¼š TCPæ•°æ®åŒ…æ˜¯æœ‰åºä¼ è¾“ï¼Œä¸­é—´ä¸€ä¸ªæ•°æ®åŒ…ä¸¢å¤±ï¼Œä¼šç­‰å¾…è¯¥æ•°æ®åŒ…é‡ä¼ ï¼Œé€ æˆåé¢çš„æ•°æ®åŒ…çš„é˜»å¡ã€‚ QUICçš„å¤šè·¯å¤ç”¨ï¼Œä¹Ÿå¯ä»¥å®ç°åœ¨ä¸€æ¡ QUIC è¿æ¥ä¸Šå¯ä»¥å¹¶å‘å‘é€å¤šä¸ª HTTP è¯·æ±‚ ï¼ˆstreamï¼‰ï¼Œä½†æ˜¯streamä¹‹é—´æ²¡æœ‰ç›¸äº’ä¾èµ–ï¼Œè¿™å¯¼è‡´äº†å½¼æ­¤ä¸ä¼šç›¸äº’å½±å“ï¼Œæå¤§ç¨‹åº¦æ¶ˆé™¤äº†å¯¹å¤´é˜»å¡çš„å½±å“ï¼› å¹¶ä¸”QUIC æœ€åŸºæœ¬çš„ä¼ è¾“å•å…ƒæ˜¯ Packetï¼Œæ•´ä¸ªåŠ å¯†å’Œè®¤è¯è¿‡ç¨‹éƒ½æ˜¯åŸºäº Packet çš„ï¼Œä¸ä¼šè·¨è¶Šå¤šä¸ª Packetã€‚è¿™æ ·å°±èƒ½é¿å… TLS åè®®å­˜åœ¨çš„é˜Ÿå¤´é˜»å¡ã€‚ è€Œå¯¹æ¯”QUICï¼Œhttp2.0çš„å¤šè·¯å¤ç”¨ä¼šé˜Ÿå¤´é˜»å¡ï¼Œæœ¬èº«å¼ºåˆ¶ä½¿ç”¨çš„TLSåè®®ä¹Ÿå­˜åœ¨ä¸€ä¸ªé˜Ÿå¤´é˜»å¡ è¿æ¥è¿ç§»ã€‚ WIFI å’Œ 4G ç§»åŠ¨ç½‘ç»œåˆ‡æ¢æ—¶ï¼Œ ipå‘ç”Ÿå˜åŒ– -&gt; é‡æ–°å»ºç«‹TCPè¿æ¥ï¼›è€Œä»»ä½•ä¸€æ¡ QUIC è¿æ¥ä¸å†ä»¥ IP åŠç«¯å£å››å…ƒç»„æ ‡è¯†ï¼Œè€Œæ˜¯ä»¥ä¸€ä¸ª 64 ä½çš„éšæœºæ•°ä½œä¸º ID æ¥æ ‡è¯†ï¼Œç»§è€Œä¸Šå±‚ä¸šåŠ¡é€»è¾‘æ„ŸçŸ¥ä¸åˆ°å˜åŒ– å‰å‘å†—ä½™çº é”™ QUICçš„UDPä¼˜åŒ–ç›¸ä¿¡å·²ç»åœ¨å°è¯•åº”ç”¨QUIC/HTTP3çš„æœåŠ¡ç«¯å¼€å‘è€…ï¼Œæˆ–å¤šæˆ–å°‘éƒ½ä¼šç»å†UDPåœ¨å†…æ ¸æ–¹é¢çš„æ€§èƒ½ç“¶é¢ˆé—®é¢˜ï¼Œè€ƒè™‘åˆ°UDPæ˜¯åœ¨è¿‘å‡ å¹´æ‰éšç€QUICå’Œæµåª’ä½“ä¼ è¾“çš„åœºæ™¯çš„é€æ¸æµè¡Œï¼Œæ‰è¢«é€æ¸å¹¿æ³›åœ°åº”ç”¨èµ·æ¥ï¼Œå› æ­¤å†…æ ¸UDPåœ¨æ€§èƒ½æ–¹é¢å¾ˆéš¾ä¸ä¼˜åŒ–äº†ä¸‰åå¹´çš„TCPç›¸æŠ—è¡¡ï¼ŒåŒæ—¶å†…æ ¸çš„å¤æ‚æ€§å’Œé€šç”¨æ€§è¦æ±‚ï¼Œä¹Ÿå¯¼è‡´ä¸€äº›æ–°çš„é«˜æ€§èƒ½ä¿®æ”¹éš¾ä»¥è¢«è¿…é€Ÿæ¥æ”¶ã€‚å› æ­¤ï¼Œåœ¨UDPæ€§èƒ½ä¼˜åŒ–æ–¹é¢ï¼Œæˆ‘ä»¬å’Œé¾™èœ¥ç¤¾åŒºçš„Anoliså†…æ ¸å›¢é˜Ÿè”åˆåšäº†ä¸€ç‰ˆbypasså†…æ ¸çš„ç”¨æˆ·æ€é«˜æ€§èƒ½udpæ”¶å‘æ–¹æ¡ˆã€‚ QUICå‚è€ƒé“¾æ¥ ç§‘æ™®ï¼šQUICåè®®åŸç†åˆ†æ å¦‚ä½•çœ‹å¾… HTTP/3 ï¼Ÿ 8.æœ¬åœ°ä¿®æ”¹hostç›®å‰å…ˆå°†æœ¬åœ°çš„/etc/hosts ä¸­é…ç½®æœ¬åœ°é¢„è§ˆåœ°å€ï¼ˆmacç«¯é€šè¿‡sudo vim /etc/hosts æ‰“å¼€ï¼‰ # 127.0.0.1 éƒ½èµ°æˆ t.baidu.163.com 127.0.0.1 t.baidu.163.com æ¥é¡¶æ›¿ç›®å‰è·¨åŸŸçš„é—®é¢˜ cat /etc/hosts 127.0.0.1 localhost 255.255.255.255 broadcasthost ::1 localhost 127.0.0.1 t.moyi.163.com é€šè¿‡è¿™ä¸ªæ–‡ä»¶å¯ä»¥çœ‹åˆ°å“ªäº›åŸŸåå¯¹åº”å“ªäº›ipï¼Œå“ªäº›ä¸»æœºåå¯¹åº”å“ªäº›ipï¼Œé€šå¸¸æƒ…å†µä¸‹è¿™ä¸ªæ–‡ä»¶é¦–å…ˆè®°å½•äº†æœ¬æœºçš„ipå’Œä¸»æœºå ä¸€èˆ¬æƒ…å†µä¸‹hostsæ–‡ä»¶çš„æ¯è¡Œä¸ºä¸€ä¸ªä¸»æœºï¼Œæ¯è¡Œç”±ä¸‰éƒ¨åˆ†ç»„æˆï¼Œæ¯ä¸ªéƒ¨åˆ†ç”±ç©ºæ ¼éš”å¼€ï¼Œæ ¼å¼å¦‚ä¸‹ ipåœ°å€ ä¸»æœºå/åŸŸå ï¼ˆä¸»æœºåˆ«åï¼‰","categories":[{"name":"ç½‘ç»œ","slug":"ç½‘ç»œ","permalink":"https://taylor12138.github.io/categories/%E7%BD%91%E7%BB%9C/"}],"tags":[],"author":"Hello"},{"title":"è¶…æ–‡æœ¬å®‰å…¨ä¼ è¾“åè®®","slug":"è¶…æ–‡æœ¬å®‰å…¨ä¼ è¾“åè®®","date":"2021-03-14T16:00:00.000Z","updated":"2022-07-17T05:52:17.372Z","comments":true,"path":"2021/03/15/chao-wen-ben-an-quan-chuan-shu-xie-yi/","link":"","permalink":"https://taylor12138.github.io/2021/03/15/chao-wen-ben-an-quan-chuan-shu-xie-yi/","excerpt":"","text":"1.httpå’Œhttpshttpï¼šè¶…æ–‡æœ¬ä¼ è¾“åè®®ï¼Œå®ƒæ˜¯ä»¥ä¸€ç§æ˜æ–‡çš„æ–¹å¼ï¼ˆä¼ è¾“æ˜¯æ˜æ–‡çš„ï¼‰ï¼Œæ²¡æœ‰ä»»ä½•åŠ å¯†ï¼Œå¦‚æœæˆ‘ä»¬åœ¨è¯¥ç½‘ç«™è¾“å…¥ç™»å½•å¯†ç ç­‰ä¿¡æ¯ï¼Œå‘é€è¯·æ±‚åˆ°æœåŠ¡å™¨æ—¶ï¼Œå¦‚æœæœ‰äººåœ¨ä¸­é€”æˆªå–æˆ‘ä»¬çš„ä¿¡æ¯ï¼Œé‚£æˆ‘ä»¬çš„ä¿¡æ¯å¯èƒ½å°±æš´éœ²äº†ï¼Œé»˜è®¤80 httpsï¼šè¶…æ–‡æœ¬ä¼ è¾“å®‰å…¨åè®®ï¼Œåˆ©ç”¨SSL/TLSæ¥åŠ å¯†æ•°æ®åŒ…ã€‚é»˜è®¤443ï¼Œéœ€è¦åˆ° CA ç”³è¯·è¯ä¹¦ï¼Œä¸€èˆ¬å…è´¹è¯ä¹¦å¾ˆå°‘ï¼Œéœ€è¦äº¤è´¹ï¼Œæ¡æ‰‹é˜¶æ®µæ¯”è¾ƒè´¹æ—¶ï¼Œä¼šä½¿é¡µé¢çš„åŠ è½½æ—¶é—´å»¶é•¿è¿‘50%ï¼Œå¢åŠ 10%åˆ°20%çš„è€—ç”µï¼› å¯¹ç§°å¯†é’¥ï¼šç›´æ¥å‘å¯†é’¥ï¼Œä¹‹åçš„é€šä¿¡éƒ½ç”¨è¿‡è¿™ä¸ªå¯†é’¥æ‰“å¼€ã€‚å®ƒçš„å¼Šç«¯å°±æ˜¯ï¼Œå¯èƒ½è¢«ä¸­é—´äººæ‹¦æˆªï¼Œè¿™æ ·ä¸­é—´äººå°±å¯ä»¥è·å–åˆ°äº†å¯†é’¥ï¼Œå°±å¯ä»¥å¯¹ä¼ è¾“çš„ä¿¡æ¯å°±è¡Œçª¥è§†å’Œç¯¡æ”¹ã€‚ éå¯¹ç§°å¯†é’¥ï¼ˆRSAï¼‰ï¼šåŒæ–¹å¿…é¡»åå•†ä¸€å¯¹å¯†é’¥ï¼Œä¸€ä¸ªç§é’¥ä¸€ä¸ªå…¬é’¥ã€‚ç”¨ç§é’¥åŠ å¯†çš„æ•°æ®ï¼Œåªæœ‰å¯¹åº”çš„å…¬é’¥æ‰èƒ½è§£å¯†ï¼Œç”¨å…¬é’¥åŠ å¯†çš„æ•°æ®ï¼Œ åªæœ‰å¯¹åº”çš„ç§é’¥æ‰èƒ½è§£å¯† ä½†å®ƒçš„å¼Šç«¯å°±æ˜¯ï¼Œç®—æ³•å¾ˆæ…¢ æˆ‘ä»¬ä½¿ç”¨ç»“åˆçš„æ–¹å¼ï¼ ä½¿ç”¨ éå¯¹ç§°å¯†é’¥ï¼ˆRSAï¼‰ å‘é€ å¯¹ç§°å¯†é’¥ï¼Œç„¶ååŒæ–¹ä½¿ç”¨ å¯¹ç§°å¯†é’¥ è¿›è¡Œé€šä¿¡ SSLåè®®è¿™ä¸ªåè®®ç®€å•æ¥è¯´å°±æ˜¯æä¾›æ•°æ®å®‰å…¨å’Œå®Œæ•´æ€§çš„åè®®ï¼Œç®€è€Œè¨€ä¹‹ï¼Œå®ƒæ˜¯ä¸€é¡¹æ ‡å‡†æŠ€æœ¯ã€‚æ¯”å¦‚æˆ‘ä»¬è®¿é—®äº†ä¸€ä¸ªhttpsç½‘ç«™ï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯ä¼šï¼ˆæ¡æ‰‹é˜¶æ®µï¼‰å¦‚æœæŸä¸ªç½‘ç«™å— SSL è¯ä¹¦ä¿æŠ¤ï¼Œå…¶ç›¸åº”çš„ URL ä¸­ä¼šæ˜¾ç¤º HTTPS å…ˆå»ºç«‹å®‰å…¨çš„è¿æ¥é€šé“ï¼Œå®¢æˆ·ç«¯å…ˆç»™å‡ºåè®®ç‰ˆæœ¬å· + æ”¯æŒçš„åŠ å¯†æ–¹æ³• + éšæœºæ•°ç­‰ ç¡®è®¤ä¿¡æ¯åï¼ŒæœåŠ¡å™¨ä¼šç”Ÿæˆä¸€ä¸ªåŠ é”çš„ç®±å­ï¼Œä½†æ˜¯è¿™æŠŠé”æœ‰ä¸¤æŠŠä¸ä¸€æ ·çš„é’¥åŒ™ï¼Œä¸€æŠŠç•™ç»™æœåŠ¡å™¨è‡ªå·±ï¼ˆç§é’¥ï¼‰ï¼Œä¸€æŠŠæä¾›ç»™å®¢æˆ·ç«¯ï¼ˆå…¬é’¥ï¼‰ æœåŠ¡å™¨å‘é€ â€” &gt; æœªä¸Šé”çš„ç®±å­ + ï¼ˆé‡Œé¢æ”¾ç€ä¸€ä»½ç½‘ç«™çš„è¯ä¹¦ï¼ˆè¯ä¹¦åŒ…æ‹¬å…¬é’¥å’Œæ•°å­—ç­¾ï¼‰åˆ° â€“ &gt; å®¢æˆ·ç«¯ï¼ˆä½ è®¿é—®çš„æœåŠ¡å™¨æ²¡é—®é¢˜ï¼‰ï¼‰ å®¢æˆ·ç«¯ç”Ÿæˆä¸¤æŠŠå¯¹ç§°å¯†é’¥ï¼Œä¸€æŠŠç•™ç»™è‡ªå·±ï¼Œç„¶åæŠŠä¿¡æ¯ + å¦ä¸€æŠŠå¯¹ç§°å¯†é’¥æ”¾åˆ°ç®±å­ä¸­ï¼Œç”¨é’¥åŒ™é”ä¸Šï¼ˆåªèƒ½ç”¨ç§é’¥å¼€ï¼‰å‘é€ â€”&gt;æœåŠ¡å™¨ ç„¶åæœåŠ¡å™¨ç”¨å¦å¤–ä¸€æŠŠé’¥åŒ™ï¼ˆç§é’¥ï¼‰æ‰“å¼€ç®±å­ï¼Œç„¶ååŒæ–¹å¯ä»¥é€šè¿‡å¯¹ç§°å¯†é’¥é€šä¿¡äº† åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œå³ä½¿ç®±å­è¢«æ‹¦æˆªäº†ï¼Œä¹Ÿå¾ˆéš¾æ‰“å¼€ç®±å­ ä¸­é—´äººæ”»å‡»å› ä¸ºä¼ è¾“éå¯¹ç§°å¯†é’¥çš„æ—¶å€™ï¼ŒæœåŠ¡ç«¯å‘é€çš„æ˜¯å…¬é’¥ï¼Œï¼Œæœ‰å¯èƒ½è¢«ä¸­é—´äººæ‹¦æˆªåè¿›è¡Œç¯¡æ”¹ è¿™æ—¶æˆ‘ä»¬å°±éœ€è¦æ•°å­—è¯ä¹¦ï¼Œç¡®å®šæœåŠ¡ç«¯çš„èº«ä»½ï¼Œä¸€å®šæ˜¯æœåŠ¡ç«¯å‘é€çš„ï¼Œè€Œæ•°å­—è¯ä¹¦ç±»ä¼¼äºæˆ‘ä»¬çš„å…¬è¯å¤„ è¿™ç¯‡æ–‡ç« å¯ä»¥ç”ŸåŠ¨å½¢è±¡åœ°äº†è§£åˆ° https çš„åŸç† https://juejin.cn/post/6844903504046211079 ï¼ˆè€Œæˆ‘ä»¬ç†ŸçŸ¥çš„è‡ªåŠ¨æ‰“å¡ï¼Œæœ‰äº›å°±æ˜¯åˆ©ç”¨ä¸­é—´äººæ”»å‡»çš„åŸç†ï¼ˆfiddleræŠ“åŒ…ï¼‰ï¼Œæ¨¡æ‹Ÿå®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯é€šä¿¡ï¼Œå½“ç„¶ï¼Œå®ƒä¹Ÿé€šè¿‡ä¸äº†æ•°å­—è¯ä¹¦çš„æ ¡éªŒï¼Œfiddlerä¼ªé€ çš„æ•°å­—è¯ä¹¦ï¼Œæ˜¯å»ºç«‹åœ¨æˆ‘ä»¬æ‰‹åŠ¨ä¿¡ä»»çš„åŸºç¡€ä¸Šï¼‰ ï¼ˆæ‰€ä»¥è¿æ¥é™Œç”Ÿwifiã€ä¸‹è½½ä¹±ä¸ƒå…«ç³Ÿçš„è½¯ä»¶ï¼Œæœ‰å¯èƒ½ä¼šè¢«è£…ä¸Šä¹±ä¸ƒå…«ç³Ÿçš„ç§å‘è¯ä¹¦ï¼Œä»è€Œå‡ºç°ä¸­é—´äººæ”»å‡»ï¼‰ æ•°å­—è¯ä¹¦ æ•°å­—è¯ä¹¦æ˜¯ä»€ä¹ˆä¸œè¥¿?å…¶å®å®ƒå°±æ˜¯ä¸€ä¸ª .crt æ–‡ä»¶ æ•°å­—è¯ä¹¦æ˜¯è°é¢å‘çš„?ç”±æƒå¨è¯ä¹¦è®¤è¯æœºæ„é¢å‘ï¼Œä¸€èˆ¬æˆ‘ä»¬ç®€ç§°ä¸º CA æœºæ„ æ•°å­—è¯ä¹¦å¦‚ä½•ç”³è¯·çš„ï¼š æœåŠ¡å™¨ä¸Šç”Ÿæˆä¸€å¯¹å…¬é’¥å’Œç§é’¥ã€‚ç„¶åå°†åŸŸåã€ç”³è¯·è€…ã€å…¬é’¥(æ³¨æ„ä¸æ˜¯ç§é’¥ï¼Œç§é’¥æ˜¯æ— è®ºå¦‚ä½•ä¹Ÿä¸èƒ½æ³„éœ²çš„)ç­‰å…¶ä»–ä¿¡æ¯æ•´åˆåœ¨ä¸€èµ·ï¼Œç”Ÿæˆ.csr æ–‡ä»¶ã€‚ .csræ–‡ä»¶å‘é€ç»™CAæœºæ„ï¼Œæ”¶åˆ°ç”³è¯·åä¼šéªŒè¯ç”³è¯·è€…çš„ç»„ç»‡å’Œä¸ªäººä¿¡æ¯ï¼Œç„¶å CA å°±ä¼šä½¿ç”¨æ•£åˆ—ç®—æ³•å¯¹.csré‡Œçš„æ˜æ–‡ä¿¡æ¯å…ˆåšä¸€ä¸ªHASHï¼Œå¾—åˆ°ä¸€ä¸ªä¿¡æ¯æ‘˜è¦ï¼Œå†ç”¨ CA è‡ªå·±çš„ç§é’¥å¯¹è¿™ä¸ªä¿¡æ¯æ‘˜è¦è¿›è¡ŒåŠ å¯†ï¼Œç”Ÿæˆä¸€ä¸²å¯†æ–‡ï¼Œå¯†æ–‡å³æ˜¯æ‰€è¯´çš„ ç­¾å å®¢æˆ·ç«¯(æµè§ˆå™¨)å‘æœåŠ¡ç«¯å‘å‡ºè¯·æ±‚ï¼ŒæœåŠ¡ç«¯è¿”å›è¯ä¹¦ç»™å®¢æˆ·ç«¯ã€‚ å®¢æˆ·ç«¯æ‹¿åˆ°è¯ä¹¦åï¼ŒæŠŠè¯ä¹¦é‡Œçš„ç­¾åä¸åŠæ˜æ–‡ä¿¡æ¯åˆ†åˆ«å–å‡ºæ¥ï¼Œç„¶åä¼šç”¨è‡ªèº«æºå¸¦çš„CAæœºæ„çš„å…¬é’¥å»è§£å¯†ç­¾åï¼Œç„¶åä¿¡æ¯æ‘˜è¦1ï¼Œç„¶åå†å¯¹æ˜æ–‡ä¿¡æ¯è¿›è¡ŒHASHï¼Œå¾—åˆ°ä¸€ä¸ªä¿¡æ¯æ‘˜è¦2ï¼Œå¯¹æ¯”ä¿¡æ¯æ‘˜è¦1 å’Œä¿¡æ¯æ‘˜è¦2ï¼Œå¦‚æœä¸€æ ·ï¼Œè¯´æ˜è¯ä¹¦æ˜¯åˆæ³•çš„ï¼Œä¹Ÿå°±æ˜¯è¯ä¹¦é‡Œçš„å…¬é’¥æ˜¯æ­£ç¡®çš„ã€‚ ä½¿ç”¨åˆ°çš„ç®—æ³•ï¼šæ‘˜è¦ç®—æ³•ï¼ˆDigest Algorithmï¼‰ï¼Œä¹Ÿå°±æ˜¯å¸¸è¯´çš„æ•£åˆ—å‡½æ•°ã€å“ˆå¸Œå‡½æ•°ï¼ˆHash Functionï¼‰ã€‚ ç›®å‰ TLS æ¨èä½¿ç”¨çš„æ˜¯ SHA-1 çš„åç»§è€…ï¼šSHA-2ã€‚ SHA-1æ¶æ„ç±»ä¼¼äºMD5å¾—æ•£åˆ—å‡½æ•°ï¼Œæ¥å—ä»»æ„å¤§å°çš„è¾“å…¥ï¼Œç”Ÿæˆ160ä½æ¶ˆæ¯æ•£åˆ—ï¼Œå®¹æ˜“å—åˆ°ç¢°æ’æ”»å‡»ï¼Œè¿™ä¸ªç®—æ³•å·²ç»ä¸å†å®‰å…¨ SHA-2 å®é™…ä¸Šæ˜¯ä¸€ç³»åˆ—æ‘˜è¦ç®—æ³•çš„ç»Ÿç§°ï¼Œæ€»å…±æœ‰ 6 ç§ï¼Œå¸¸ç”¨çš„æœ‰ SHA224ã€SHA256ã€SHA384ï¼Œåˆ†åˆ«èƒ½å¤Ÿç”Ÿæˆ 28 å­—èŠ‚ã€32 å­—èŠ‚ã€48 å­—èŠ‚çš„æ‘˜è¦ã€‚è¿™ä¸ªç®—æ³•ç›®å‰è¢«è®¤ä¸ºæ˜¯å®‰å…¨çš„ï¼Œè¿˜è¢«åº”ç”¨äºå¹¿æ³›é¢†åŸŸæ¯”å¦‚PGPã€æ¯”ç‰¹å¸ å‚è€ƒï¼šhttps://network.51cto.com/art/202010/628890.htm TLSåè®®å®ƒå»ºç«‹åœ¨SSL 3.0åè®®è§„èŒƒä¹‹ä¸Šï¼Œæ˜¯SSL 3.0çš„åç»­ç‰ˆæœ¬ å¯¹æ¯”SSLçš„å¢å¼ºå†…å®¹ï¼š æ›´å®‰å…¨çš„MACç®—æ³• æ›´ä¸¥å¯†çš„è­¦æŠ¥ â€œç°è‰²åŒºåŸŸâ€è§„èŒƒæ›´åŠ æ˜ç¡®å®šä¹‰ 2.HSTSHTTP ä¸¥æ ¼ä¼ è¾“å®‰å…¨( HSTS ) æ˜¯ä¸€ç§ç­–ç•¥æœºåˆ¶ ç»´åŸºç™¾ç§‘ï¼š æœ‰åŠ©äºä¿æŠ¤ç½‘ç«™å…å—åè®®é™çº§æ”»å‡»[1]å’Œcookie åŠ«æŒç­‰ä¸­é—´äººæ”»å‡»ã€‚å®ƒå…è®¸Web æœåŠ¡å™¨å£°æ˜Web æµè§ˆå™¨ï¼ˆæˆ–å…¶ä»–ç¬¦åˆè¦æ±‚çš„ç”¨æˆ·ä»£ç†ï¼‰åº”ä»…ä½¿ç”¨HTTPSè¿æ¥è‡ªåŠ¨ä¸å…¶äº¤äº’ï¼Œè¯¥è¿æ¥æä¾›ä¼ è¾“å±‚å®‰å…¨æ€§(TLS/SSL)ï¼Œè¿™ä¸å•ç‹¬ä½¿ç”¨ä¸å®‰å…¨çš„HTTPä¸åŒã€‚HSTS æ˜¯IETFæ ‡å‡†è·Ÿè¸ªåè®®ï¼Œåœ¨RFC 6797ä¸­æŒ‡å®š . æœåŠ¡å™¨é€šè¿‡åä¸ºâ€œâ€çš„ HTTP å“åº”å¤´å­—æ®µå°† HSTS ç­–ç•¥ä¼ è¾¾ç»™ç”¨æˆ·ä»£ç†Strict-Transport-Securityã€‚[1] HSTS ç­–ç•¥æŒ‡å®šç”¨æˆ·ä»£ç†ä»…åº”ä»¥å®‰å…¨æ–¹å¼è®¿é—®æœåŠ¡å™¨çš„æ—¶é—´æ®µã€‚[2]ä½¿ç”¨ HSTS çš„ç½‘ç«™é€šå¸¸ä¸æ¥å—æ˜æ–‡ HTTPï¼Œè¦ä¹ˆæ‹’ç»é€šè¿‡ HTTP çš„è¿æ¥ï¼Œè¦ä¹ˆç³»ç»Ÿåœ°å°†ç”¨æˆ·é‡å®šå‘åˆ° HTTPSï¼ˆå°½ç®¡è§„èŒƒæ²¡æœ‰è¦æ±‚ï¼‰ã€‚è¿™æ ·åšçš„ç»“æœæ˜¯æ— æ³•æ‰§è¡Œ TLS çš„ç”¨æˆ·ä»£ç†å°†æ— æ³•è¿æ¥åˆ°è¯¥ç«™ç‚¹ã€‚ ç‰¹æ®Šè¯¥ä¿æŠ¤ä»…åœ¨ç”¨æˆ·è‡³å°‘è®¿é—®è¯¥ç½‘ç«™ä¸€æ¬¡åæ‰é€‚ç”¨ï¼Œè¿™ä¾èµ–äºé¦–æ¬¡ä½¿ç”¨çš„ä¿¡ä»»åŸåˆ™ã€‚æ­¤ä¿æŠ¤çš„å·¥ä½œæ–¹å¼æ˜¯ç”¨æˆ·è¾“å…¥æˆ–é€‰æ‹©æŒ‡å‘æŒ‡å®š HTTP çš„ç«™ç‚¹çš„URLï¼Œå°†è‡ªåŠ¨å‡çº§åˆ° HTTPSï¼Œè€Œæ— éœ€å‘å‡º HTTP è¯·æ±‚ï¼Œä»è€Œé˜²æ­¢å‘ç”Ÿ HTTP ä¸­é—´äººæ”»å‡»ã€‚ ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸å¹¸çš„æ˜¯ï¼Œä½ ç¬¬ä¸€æ¬¡è®¿é—®è¿™ä¸ªç½‘ç«™ï¼Œä½ ä¸å— HSTS çš„ä¿æŠ¤ã€‚ å¦‚æœç½‘ç«™å‘ HTTP è¿æ¥æ·»åŠ  HSTS å¤´ï¼Œåˆ™è¯¥æŠ¥å¤´å°†è¢«å¿½ç•¥ã€‚ è¿™æ˜¯å› ä¸ºæ”»å‡»è€…å¯ä»¥åœ¨ä¸­é—´äººæ”»å‡»ï¼ˆman-in-the-middle attackï¼‰ä¸­åˆ é™¤æˆ–æ·»åŠ å¤´éƒ¨ã€‚ HSTS æŠ¥å¤´ä¸å¯ä¿¡ï¼Œé™¤éå®ƒæ˜¯é€šè¿‡ HTTPS ä¼ é€’çš„ã€‚ MDNï¼š **HTTP Strict Transport Security**ï¼ˆé€šå¸¸ç®€ç§°ä¸ºHSTSï¼‰æ˜¯ä¸€ä¸ªå®‰å…¨åŠŸèƒ½ï¼Œå®ƒå‘Šè¯‰æµè§ˆå™¨åªèƒ½é€šè¿‡ HTTPS è®¿é—®å½“å‰èµ„æºï¼Œè€Œä¸æ˜¯HTTPã€‚ è¯­æ³•Strict-Transport-Security: max-age=&lt;expire-time&gt; Strict-Transport-Security: max-age=&lt;expire-time&gt;; includeSubDomains Strict-Transport-Security: max-age=&lt;expire-time&gt;; preloadmax-age=&lt;expire-time&gt; è®¾ç½®åœ¨æµè§ˆå™¨æ”¶åˆ°è¿™ä¸ªè¯·æ±‚åçš„ç§’çš„æ—¶é—´å†…å‡¡æ˜¯è®¿é—®è¿™ä¸ªåŸŸåä¸‹çš„è¯·æ±‚éƒ½ä½¿ç”¨ HTTPS è¯·æ±‚ã€‚ includeSubDomains å¯é€‰ å¦‚æœè¿™ä¸ªå¯é€‰çš„å‚æ•°è¢«æŒ‡å®šï¼Œé‚£ä¹ˆè¯´æ˜æ­¤è§„åˆ™ä¹Ÿé€‚ç”¨äºè¯¥ç½‘ç«™çš„æ‰€æœ‰å­åŸŸåã€‚ preload å¯é€‰ æŸ¥çœ‹ é¢„åŠ è½½ HSTS è·å¾—è¯¦æƒ…ã€‚ä¸æ˜¯æ ‡å‡†çš„ä¸€éƒ¨åˆ†ã€‚ HSTSåº”ç”¨åœºæ™¯å½“ä½ ä½ æƒ³ä½¿ç”¨ä»–ä»¬çš„å…è´¹ Wi-Fiã€‚æ‚¨æ˜¯å¦æ³¨æ„åˆ°ä»–ä»¬çš„ Wi-Fi å¯†ç å°åœ¨çº¸ä¸Šå¹¶ä¸”ä»æœªæ›´æ”¹è¿‡ï¼Ÿ ä¸€ä¸ªæ¶æ¯’çš„é»‘å®¢åœ¨åŒä¸€å®¶é…’åº—é¢„è®¢äº†æˆ¿é—´ã€‚ä»–ä»¬æ­£åœ¨çªƒå¬é€šè¿‡è¿™ä¸ªä¸å®‰å…¨çš„æ— çº¿ç½‘ç»œçš„æ‰€æœ‰è¿æ¥ã€‚ è¯¥é»‘å®¢å¯ä»¥é€šè¿‡ HTTP æ•è·ä»»ä½•ä»…ä¾èµ– 301 é‡å®šå‘ä»¥ä» HTTP åˆ‡æ¢åˆ° HTTPS çš„ç½‘ç«™çš„ç½‘ç»œæµé‡ã€‚è¿™ç§æ–¹æ³•ä¸ºé»‘å®¢æä¾›äº†ä¸€ä¸ªæœºä¼šä¹‹çª—ï¼Œå¯ä»¥å‰¥ç¦»æ‚¨çš„ SSL åŠ å¯†å¹¶çªƒå–æœ‰ä»·å€¼çš„æ•°æ®ï¼Œæˆ–è€…æ›´ç³Ÿç³•çš„æ˜¯ï¼Œæä¾›ä¸€ä¸ªè™šå‡çš„ç™»å½•é—¨æˆ·é¡µé¢ã€‚ è¿™å°±æ˜¯ä¸ºä»€ä¹ˆæ‚¨çš„ç½‘ç«™å¿…é¡»ä½¿ç”¨ HTTP ä¸¥æ ¼ä¼ è¾“å®‰å…¨è€Œä¸æ˜¯ HTTPSã€‚è·å¾— SSL è¯ä¹¦æ˜¯è¿œè¿œä¸å¤Ÿçš„ã€‚ æ•°æ®å¯èƒ½ä¸å•†åº—æˆ–æˆ¿å±‹ä¸­çš„å®ç‰©ä¸€æ ·æœ‰ä»·å€¼ï¼Œå› æ­¤å°†å®ƒä»¬é”å®šå’Œä¿æŠ¤åŒæ ·é‡è¦ã€‚æŒ‚é”æ‚¨çš„ç½‘ç«™æœ‰æ—¶æ˜¯ä¸å¤Ÿçš„ï¼Œå› ä¸ºäººä»¬ä»ç„¶ä¼šæ‰¾åˆ°é€šè¿‡ http:// è®¿é—®æ‚¨çš„ç½‘ç«™çš„æ–¹æ³•ã€‚HSTS å¼ºåˆ¶æµè§ˆå™¨å’Œåº”ç”¨ç¨‹åºè¿æ¥ä½¿ç”¨ HTTPSï¼ˆå¦‚æœå¯ç”¨ï¼‰ã€‚å³ä½¿æœ‰äººåªæ˜¯è¾“å…¥ www æˆ– http://ã€‚ è®¾ç½®ä» http:// åˆ° https:// çš„ 301 é‡å®šå‘ä¸è¶³ä»¥å®Œå…¨ä¿æŠ¤æ‚¨çš„åŸŸåã€‚HTTP çš„ä¸å®‰å…¨é‡å®šå‘ä»ç„¶å­˜åœ¨æœºä¼šä¹‹çª—ã€‚ åè®®çš„æ”¯æŒä¿æŠ¤æ‰æ˜¯æœ‰æ•ˆçš„ä¿æŠ¤æªæ–½çš„ $ curl â€“head http://www.facebook.com HTTP/1.1 301 æ°¸ä¹…ç§»åŠ¨ä½ç½®ï¼šhttps://www.facebook.com/ é»‘å®¢ä»ç„¶èƒ½å¤Ÿæ•è·ç«™ç‚¹ cookieã€ä¼šè¯ IDï¼ˆé€šå¸¸ä½œä¸º URL å‚æ•°å‘é€ï¼‰æˆ–å¼ºåˆ¶é‡å®šå‘åˆ°çœ‹èµ·æ¥ä¸æ‚¨çš„ç½‘ç«™å®Œå…¨ç›¸åŒçš„ç½‘ç»œé’“é±¼ç«™ç‚¹ã€‚å“å“Ÿ! é€šè¿‡å®‰è£… Strict-Transport-Security æ ‡å¤´ï¼Œåäººå‡ ä¹ä¸å¯èƒ½æ”¶é›†åˆ°ä»»ä½•ä¿¡æ¯ï¼ç”šè‡³æ²¡æœ‰ä½ çš„ç‘œä¼½æ—¶é—´è¡¨ï¼ $ curl â€“head https://www.facebook.com HTTP/1.1 200 OK Strict-Transport-Security: max-age=15552000; preload HSTSå†å²ä»·å€¼æ•°åäº¿ç¾å…ƒçš„å…¬å¸ Google äº 2016 å¹´ 7 æœˆ 29 æ—¥æ­£å¼æ¨å‡ºäº† HSTS å®‰å…¨ç­–ç•¥ã€‚ HSTS é¡¹ç›®æœ€æ—©äº 2009 å¹´èµ·è‰ã€‚2015å¹´ 6 æœˆ 8 æ—¥ï¼Œé¦–å¸­ä¿¡æ¯å®˜æ‰˜å°¼Â·æ–¯ç§‘ç‰¹ (Tony Scott)å‘å‡ºäº†ä¸€ä»½å¤‡å¿˜å½• ï¼Œè€Œæ—©åœ¨ 2015 å¹´å°±ä¸€ç›´åœ¨è¿›è¡Œæ›´å¼ºæœ‰åŠ›çš„åŠªåŠ›ã€‚ HSTS æ°¸ä¹…è¦æ±‚ æ‚¨çš„ç½‘ç«™å¿…é¡»å…·æœ‰æœ‰æ•ˆçš„ SSL è¯ä¹¦ã€‚æ‚¨å¯ä»¥åœ¨GlobalSign çš„ SSL Checker ä¸Šæ£€æŸ¥æ‚¨çš„ SSL çš„æœ‰æ•ˆæ€§ã€‚ ä½¿ç”¨ 301 æ°¸ä¹…é‡å®šå‘å°†æ‰€æœ‰ HTTP é“¾æ¥é‡å®šå‘åˆ° HTTPSã€‚ æ‚¨çš„ SSL è¯ä¹¦å¿…é¡»æ¶µç›–æ‰€æœ‰å­åŸŸã€‚è€ƒè™‘è®¢è´­é€šé…ç¬¦è¯ä¹¦ã€‚ åœ¨åŸºåŸŸä¸Šä¸º HTTPS è¯·æ±‚æä¾› HSTS æ ‡å¤´ã€‚ Max-age å¿…é¡»è‡³å°‘ä¸º 10886400 ç§’æˆ– 18 å‘¨ã€‚å¦‚ä¸Šæ‰€è¿°ï¼Œäº‰å–ä¸¤å¹´çš„ä»·å€¼ï¼ å¦‚æœæ‚¨æœ‰ includeSubDomains æŒ‡ä»¤ï¼Œåˆ™å¿…é¡»æŒ‡å®šå®ƒä»¬ï¼ å¿…é¡»æŒ‡å®šé¢„åŠ è½½æŒ‡ä»¤ã€‚ HSTSå·¥ä½œåŸç†é€šå¸¸ï¼Œå½“æ‚¨åœ¨ Web æµè§ˆå™¨ä¸­è¾“å…¥ URL æ—¶ï¼Œæ‚¨ä¼šè·³è¿‡åè®®éƒ¨åˆ†ã€‚ ä¾‹å¦‚ï¼Œä½ è¾“å…¥çš„æ˜¯ www.acunetix.comï¼Œè€Œä¸æ˜¯ http://www.acunetix.comã€‚ åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæµè§ˆå™¨å‡è®¾ä½ æƒ³ä½¿ç”¨ HTTP åè®®ï¼Œæ‰€ä»¥å®ƒåœ¨è¿™ä¸ªé˜¶æ®µå‘å‡ºä¸€ä¸ª HTTP è¯·æ±‚ åˆ° www.acunetix.comï¼ŒåŒæ—¶ï¼ŒWeb Server ä¼šè¿”å› 301 çŠ¶æ€ç å°†è¯·æ±‚é‡å®šå‘åˆ° HTTPS ç«™ç‚¹ã€‚ æ¥ä¸‹æ¥æµè§ˆå™¨ä½¿ç”¨ HTTPS è¿æ¥åˆ° www.acunetix.comã€‚ è¿™æ—¶ HSTS å®‰å…¨ç­–ç•¥ä¿æŠ¤å¼€å§‹ä½¿ç”¨ HTTP å“åº”å¤´ï¼š Strict-Transport-Security: max-age=31536000; includeSubDomains; preload å“åº”å¤´çš„ Strict-Transport-Security ç»™æµè§ˆå™¨æä¾›äº†è¯¦ç»†çš„è¯´æ˜ã€‚ ä»ç°åœ¨å¼€å§‹ï¼Œæ¯ä¸ªè¿æ¥åˆ°è¯¥ç½‘ç«™åŠå…¶å­åŸŸçš„ä¸‹ä¸€å¹´ï¼ˆ31536000ç§’ï¼‰ä»è¿™ä¸ªå¤´è¢«æ¥æ”¶çš„æ—¶åˆ»èµ·å¿…é¡»æ˜¯ä¸€ä¸ª HTTPS è¿æ¥ã€‚ HTTP è¿æ¥æ˜¯å®Œå…¨ä¸å…è®¸çš„ã€‚ å¦‚æœæµè§ˆå™¨æ¥æ”¶åˆ°ä½¿ç”¨ HTTP åŠ è½½èµ„æºçš„è¯·æ±‚ï¼Œåˆ™å¿…é¡»å°è¯•ä½¿ç”¨ HTTPS è¯·æ±‚æ›¿ä»£ã€‚ å¦‚æœ HTTPS ä¸å¯ç”¨ï¼Œåˆ™å¿…é¡»ç›´æ¥ç»ˆæ­¢è¿æ¥ã€‚ æ­¤å¤–ï¼Œå¦‚æœè¯ä¹¦æ— æ•ˆï¼Œå°†é˜»æ­¢ä½ å»ºç«‹è¿æ¥ã€‚ é€šå¸¸æ¥è¯´ï¼Œå¦‚æœ HTTPS è¯ä¹¦æ— æ•ˆï¼ˆå¦‚ï¼šè¿‡æœŸã€è‡ªç­¾åã€ç”±æœªçŸ¥ CA ç­¾åç­‰ï¼‰ï¼Œæµè§ˆå™¨ä¼šæ˜¾ç¤ºä¸€ä¸ªå¯ä»¥è§„é¿çš„è­¦å‘Šã€‚ ä½†æ˜¯ï¼Œå¦‚æœç«™ç‚¹æœ‰ HSTSï¼Œæµè§ˆå™¨å°±ä¸ä¼šè®©ä½ ç»•è¿‡è­¦å‘Šã€‚ è‹¥è¦è®¿é—®è¯¥ç«™ç‚¹ï¼Œå¿…é¡»ä»æµè§ˆå™¨å†…çš„ HSTS åˆ—è¡¨ä¸­åˆ é™¤è¯¥ç«™ç‚¹ã€‚ httpsæ¡æ‰‹æµç¨‹ä¸€ä¸ªè¯·æ±‚ä»é›¶å¼€å§‹æ‰€éœ€è¦ç»å†çš„RTT æµç¨‹ æ¶ˆè€—æ—¶é—´ æ€»è®¡ å¯å¦ç¼“å­˜ 1. DNS è§£æç½‘ç«™åŸŸå 1-RTT å¯ç¼“å­˜ï¼ˆç¬¬ä¸€æ¬¡ä¹‹åï¼‰ 2. è®¿é—® HTTP ç½‘é¡µ TCP æ¡æ‰‹ 1-RTT ç½‘ç«™åšäº†HSTSå¯å¿½ç•¥ 3. HTTPS é‡å®šå‘ 302 1-RTT ç½‘ç«™åšäº†HSTSå¯å¿½ç•¥ 4. è®¿é—® HTTPS ç½‘é¡µ TCP æ¡æ‰‹ 1-RTT 5. TLS æ¡æ‰‹ç¬¬ä¸€é˜¶æ®µ Say Hello 1-RTT 6. ã€è¯ä¹¦æ ¡éªŒã€‘CA ç«™ç‚¹çš„ DNS è§£æ 1-RTT å¯ç¼“å­˜ï¼ˆæœ¬åœ°ï¼‰ 7. ã€è¯ä¹¦æ ¡éªŒã€‘CA ç«™ç‚¹çš„ TCP æ¡æ‰‹ 1-RTT å¯ç¼“å­˜ï¼ˆæœ¬åœ°ï¼‰ 8. ã€è¯ä¹¦æ ¡éªŒã€‘è¯·æ±‚ OCSP éªŒè¯ 1-RTT å¯ç¼“å­˜ï¼ˆæœ¬åœ°ï¼‰ 9. TLS æ¡æ‰‹ç¬¬äºŒé˜¶æ®µ åŠ å¯† 1-RTT 10. ç¬¬ä¸€ä¸ª HTTPS è¯·æ±‚ 1-RTT 10-RTT ä¸€èˆ¬æ¥è¯´ï¼Œæ¯”è¾ƒç§¯æçš„TCPåœ¨ç¬¬ä¸‰æ¬¡æ¡æ‰‹çš„æ—¶å€™ï¼Œå·²ç»é¡ºä¾¿æºå¸¦äº†æ•°æ®ï¼Œæ‰€ä»¥æœ¬æ¥ä¸‰æ¬¡æ¡æ‰‹ =ã€‹ 1.5RTTå¯ä»¥å˜æˆ 1 RTTï¼‰ ä¸Šé¢è¿™ 10 æ­¥æ˜¯æœ€æœ€å®Œæ•´çš„æµç¨‹ï¼Œä¸€èˆ¬æœ‰å„ç§ç¼“å­˜ä¸ä¼šç»å†ä¸Šé¢æ¯ä¸€æ­¥ã€‚å¦‚æœæœ‰å„ç§ç¼“å­˜ï¼Œå¹¶ä¸”æœ‰ HSTS ç­–ç•¥ï¼Œæ‰€ä»¥ç”¨æˆ·æ¯æ¬¡è®¿é—®ç½‘é¡µéƒ½å¿…é¡»è¦ç»å†çš„æµç¨‹å¦‚ä¸‹ï¼š æµç¨‹ æ¶ˆè€—æ—¶é—´ æ€»è®¡ 1. è®¿é—® HTTPS ç½‘é¡µ TCP æ¡æ‰‹ 1-RTT 2. TLS æ¡æ‰‹ç¬¬ä¸€é˜¶æ®µ Say Hello 1-RTT 3. TLS æ¡æ‰‹ç¬¬äºŒé˜¶æ®µ åŠ å¯† 1-RTT 4. ç¬¬ä¸€ä¸ª HTTPS è¯·æ±‚ 1-RTT 4-RTT é™¤å» 4 æ˜¯æ— è®ºå¦‚ä½•éƒ½æ— æ³•çœæ‰çš„ä»¥å¤–ï¼Œå‰©ä¸‹çš„å°±æ˜¯ TCP å’Œ TLS æ¡æ‰‹äº†ã€‚ TCP æƒ³è¦å‡è‡³ 0-RTTï¼Œç›®å‰æ¥çœ‹æœ‰ç‚¹éš¾ã€‚é‚£ TLS å‘¢ï¼Ÿç›®å‰ TLS 1.2 å®Œæ•´ä¸€æ¬¡æ¡æ‰‹éœ€è¦ 2-RTTï¼Œèƒ½å†å‡å°‘ä¸€ç‚¹ä¹ˆï¼Ÿç­”æ¡ˆæ˜¯å¯ä»¥çš„ã€‚ TLS1.2æ¡æ‰‹æµç¨‹ç¼©å‡ç‰ˆåœ¨ä¸Šæ–¹çš„ SSLåè®® ä»‹ç»è¿‡ ç¬¬ä¸€ä¸ªRTTï¼š Client å‘é€ä¸€ä¸ª ClientHello æ¶ˆæ¯ï¼ŒServer å¿…é¡»å›åº”ä¸€ä¸ª ServerHello æ¶ˆæ¯æˆ–äº§ç”Ÿä¸€ä¸ªéªŒè¯çš„é”™è¯¯å¹¶ä¸”ä½¿è¿æ¥å¤±è´¥ã€‚ ClientHello å’Œ ServerHello å»ºç«‹äº†å¦‚ä¸‹çš„å±æ€§: åè®®ç‰ˆæœ¬ï¼Œä¼šè¯ IDï¼Œå¯†ç å¥—ä»¶ï¼Œå‹ç¼©ç®—æ³•ã€‚æ­¤å¤–ï¼Œäº§ç”Ÿå¹¶äº¤æ¢ä¸¤ä¸ªéšæœºæ•°: ClientHello.random å’Œ ServerHello.randomã€‚ æ ¹æ®å¯†é’¥åå•†ç®—æ³•çš„ä¸åŒï¼Œäº¤æ¢çš„ä¿¡æ¯é¡ºåºç­‰ç»†å¾®å·®åˆ«éƒ½ä¼šå­˜åœ¨äº›è®¸ clientã€serverçš„éšæœºæ•°æ˜¯ä¸ºäº†é¿å…é‡æ”¾æ”»å‡» Server ä¼šåœ¨ Certificate æ¶ˆæ¯ä¸­å‘é€å®ƒè‡ªå·±çš„è¯ä¹¦ï¼Œå¦‚æœå®ƒå³å°†è¢«è®¤è¯ã€‚æ­¤å¤–ï¼Œå¦‚æœéœ€è¦çš„è¯ï¼Œä¸€ä¸ª ServerKeyExchange æ¶ˆæ¯ä¼šè¢«å‘é€(ä¾‹å¦‚, å¦‚æœ Server æ²¡æœ‰è¯ä¹¦, æˆ–è€…å®ƒçš„è¯ä¹¦åªç”¨äºç­¾åï¼ŒRSA å¯†ç å¥—ä»¶å°±ä¸ä¼šå‡ºç° ServerKeyExchange æ¶ˆæ¯)ã€‚å¦‚æœ Server è¢«è®¤è¯è¿‡äº†ï¼Œå¦‚æœå¯¹äºå·²é€‰æ‹©çš„å¯†ç å¥—ä»¶æ¥è¯´æ˜¯åˆé€‚çš„è¯ï¼Œå®ƒå¯èƒ½ä¼šè¦æ±‚ Client å‘é€è¯ä¹¦ã€‚æ¥ä¸‹æ¥ï¼ŒServer ä¼šå‘é€ ServerHelloDone æ¶ˆæ¯ï¼Œè‡³æ­¤æ„å‘³ç€æ¡æ‰‹çš„ hello æ¶ˆæ¯é˜¶æ®µå®Œæˆ Serverç­‰å¾… Client çš„å“åº” å¦‚æœ Server å‘é€äº†ä¸€ä¸ª CertificateRequest æ¶ˆæ¯ï¼ŒClient å¿…é¡»å‘é€ Certificate æ¶ˆæ¯ã€‚ç°åœ¨ ClientKeyExchange æ¶ˆæ¯éœ€è¦å‘é€, è¿™ä¸ªæ¶ˆæ¯çš„å†…å®¹å–å†³äº ClientHello å’Œ ServerHello ä¹‹é—´é€‰æ‹©çš„å…¬é’¥ç®—æ³•ã€‚å¦‚æœ Client å‘é€äº†ä¸€ä¸ªå¸¦ç­¾åèƒ½åŠ›çš„è¯ä¹¦, åˆ™éœ€è¦å‘é€ä»¥ä¸€ä¸ªæ•°å­—ç­¾åçš„ CertificateVerify æ¶ˆæ¯ï¼Œä»¥æ˜¾å¼éªŒè¯è¯ä¹¦ä¸­ç§é’¥çš„æ‰€æœ‰æƒã€‚ ä¸€ä¸ªéåŒ¿åçš„ Server å¯ä»¥é€‰æ‹©æ€§åœ°è¯·æ±‚ä¸€ä¸ª Client å‘é€çš„è¯ä¹¦ æ³¨: ä¸€ä¸ªåŒ¿å Server è¯·æ±‚è®¤è¯ Client ä¼šäº§ç”Ÿä¸€ä¸ªè‡´å‘½çš„ handshake_failure è­¦å‘Šé”™è¯¯ã€‚ Client è¯ä¹¦çš„æ•°æ®ç»“æ„å’Œ Server Certificate æ˜¯ç›¸åŒçš„ã€‚ ç¬¬äºŒä¸ªRTT è¿™æ—¶ï¼ŒClient å‘é€ä¸€ä¸ª ChangeCipherSpec æ¶ˆæ¯ï¼Œå¹¶ä¸”å¤åˆ¶ pending çš„ Cipher Spec åˆ°å½“å‰çš„ Cipher Spec ä¸­. ç„¶å Client åœ¨æ–°ç®—æ³•, å¯†é’¥ç¡®å®šåç«‹å³å‘é€ Finished æ¶ˆæ¯ã€‚ä½œä¸ºå›åº”ï¼ŒServer ä¼šå‘é€å®ƒè‡ªå·±çš„ ChangeCipherSpec æ¶ˆæ¯, å°† pending çš„ Cipher Spec è½¬æ¢ä¸ºå½“å‰çš„ Cipher Specï¼Œåœ¨æ–°çš„ Cipher Spec ä¸‹å‘é€ Finished æ¶ˆæ¯ã€‚è¿™æ—¶ï¼Œæ¡æ‰‹å®Œæˆï¼Œ Finished æ¶ˆæ¯æ˜¯ç¬¬ä¸€ä¸ªè¢«åˆšåˆšåå•†çš„ç®—æ³•ï¼Œå¯†é’¥å’Œæœºå¯†ä¿æŠ¤çš„æ¶ˆæ¯ã€‚Finished æ¶ˆæ¯çš„æ¥æ”¶è€…å¿…é¡»éªŒè¯å†…å®¹æ˜¯æ­£ç¡®çš„ã€‚ä¸€æ—¦ä¸€æ–¹å·²ç»å‘é€äº† Finished æ¶ˆæ¯ä¸”æ¥æ”¶å¹¶éªŒè¯äº†å¯¹ç«¯å‘é€çš„ Finished æ¶ˆæ¯ï¼Œå°±å¯ä»¥åœ¨è¿æ¥ä¸Šå¼€å§‹å‘é€å’Œæ¥æ”¶åº”ç”¨æ•°æ®ã€‚ Finished å­æ¶ˆæ¯çš„å­˜åœ¨çš„æ„ä¹‰ï¼šåœ¨æ‰€æœ‰çš„æ¡æ‰‹åè®®ä¸­ï¼Œæ‰€æœ‰çš„å­æ¶ˆæ¯éƒ½æ²¡æœ‰åŠ å¯†å’Œå®Œæ•´æ€§ä¿æŠ¤ï¼Œæ¶ˆæ¯å¾ˆå®¹æ˜“ç¯¡æ”¹ï¼Œæ”¹æ‰ä»¥åå¦‚æœä¸æ£€éªŒï¼Œå°±ä¼šå‡ºç°ä¸å®‰å…¨çš„æ”»å‡»ã€‚ä¸ºäº†é¿å…æ¡æ‰‹æœŸé—´å­˜åœ¨æ¶ˆæ¯è¢«ç¯¡æ”¹çš„æƒ…å†µï¼Œæ‰€ä»¥ Client å’Œ Server éƒ½éœ€è¦æ ¡éªŒä¸€ä¸‹å¯¹æ–¹çš„ Finished å­æ¶ˆæ¯ã€‚ å¦‚æœä¸­é—´äººåœ¨æ¡æ‰‹æœŸé—´æŠŠ ClientHello çš„ TLS æœ€é«˜æ”¯æŒç‰ˆæœ¬ä¿®æ”¹ä¸º TLS 1.0ï¼Œä¼å›¾å›é€€æ”»å‡»ï¼Œåˆ©ç”¨ TLS æ—§ç‰ˆæœ¬ä¸­çš„æ¼æ´ã€‚Server æ”¶åˆ°ä¸­é—´äººçš„ ClientHello å¹¶ä¸çŸ¥é“æ˜¯å¦å­˜åœ¨ç¯¡æ”¹ï¼Œäºæ˜¯ä¹ŸæŒ‰ç…§ TLS 1.0 å»åå•†ã€‚æ¡æ‰‹è¿›è¡Œåˆ°æœ€åä¸€æ­¥ï¼Œæ ¡éªŒ Finished å­æ¶ˆæ¯çš„æ—¶å€™ï¼Œæ ¡éªŒä¸é€šè¿‡ï¼Œå› ä¸º Client åŸæœ¬å‘çš„ ClientHello ä¸­ TLS æœ€é«˜æ”¯æŒç‰ˆæœ¬æ˜¯ TLS 1.2ï¼Œé‚£ä¹ˆäº§ç”Ÿçš„ Finished å­æ¶ˆæ¯çš„ verify_data ä¸ Server æ‹¿åˆ°ç¯¡æ”¹åçš„ ClientHello è®¡ç®—å‡ºæ¥çš„ verify_data è‚¯å®šä¸åŒã€‚è‡³æ­¤ä¹Ÿå°±å‘ç°äº†ä¸­é—´å­˜åœ¨ç¯¡æ”¹ï¼Œæ¡æ‰‹å¤±è´¥ã€‚ Client Server ClientHello --------> ServerHello Certificate* ServerKeyExchange* CertificateRequest* &lt;-------- ServerHelloDone Certificate* ClientKeyExchange CertificateVerify* [ChangeCipherSpec] Finished --------> [ChangeCipherSpec] &lt;-------- Finished Application Data &lt;-------> Application Data è¯ä¹¦ç±»å‹ å¯†é’¥äº¤æ¢ç®—æ³• è¯ä¹¦ç±»å‹ RSA RSA_PSK è¯ä¹¦ä¸­åŒ…å« RSA å…¬é’¥ï¼Œè¯¥å…¬é’¥å¯ä»¥è¿›è¡Œå¯†ç åå•†ï¼Œä¹Ÿå°±æ˜¯ä½¿ç”¨ RSA å¯†ç åå•†ç®—æ³•ï¼›è¯ä¹¦å¿…é¡»å…è®¸å¯†é’¥ç”¨äºåŠ å¯†(å¦‚æœ key usage æ‰©å±•å­˜åœ¨çš„è¯ï¼Œåˆ™ keyEncipherment ä½å¿…é¡»è¢«è®¾ç½®ï¼Œè¡¨ç¤ºå…è®¸æœåŠ¡å™¨å…¬é’¥ç”¨äºå¯†ç åå•†) æ³¨:RSA_PSK å®šä¹‰äº [TLSPSK] DHE_RSA ECDHE_RSA è¯ä¹¦ä¸­åŒ…å« RSA å…¬é’¥ï¼Œå¯ä»¥ä½¿ç”¨ ECDHE æˆ–è€… DHE è¿›è¡Œå¯†é’¥åå•†ï¼›è¯ä¹¦å¿…é¡»å…è®¸å¯†é’¥ä½¿ç”¨ Server å¯†é’¥äº¤äº’æ¶ˆæ¯ä¸­çš„ç­¾åæœºåˆ¶å’Œ hash ç®—æ³•è¿›è¡Œç­¾å (å¦‚æœ key usage æ‰©å±•å­˜åœ¨çš„è¯ï¼ŒdigitalSignature ä½å¿…é¡»è®¾ç½®ï¼ŒRSA å…¬é’¥å°±å¯ä»¥è¿›è¡Œæ•°å­—ç­¾å) æ³¨: ECDHE_RSAå®šä¹‰äº [TLSECC] DHE_DSS è¯ä¹¦åŒ…å« DSA å…¬é’¥; è¯ä¹¦å¿…é¡»å…è®¸å¯†é’¥ç”¨äºä½¿ç”¨å°†åœ¨ Server å¯†é’¥äº¤æ¢æ¶ˆæ¯ä¸­ä½¿ç”¨çš„æ•£åˆ—ç®—æ³•è¿›è¡Œç­¾å DH_DSS DH_RSA è¯ä¹¦ä¸­åŒ…å« DSS æˆ– RSA å…¬é’¥ï¼Œä½¿ç”¨ Diffie-Hellman è¿›è¡Œå¯†é’¥åå•†; å¦‚æœ key usage æ‰©å±•å­˜åœ¨çš„è¯ï¼ŒkeyAgreement ä½å¿…é¡»è®¾ç½®ï¼Œç›®å‰è¿™ç§å¥—ä»¶å·²ç»å¾ˆå°‘è§äº†ã€‚ ECDH_ECDSA ECDH_RSA è¯ä¹¦åŒ…å« ECDSA æˆ– RSA å…¬é’¥ï¼Œä½¿ç”¨ ECDH-capable è¿›è¡Œå¯†é’¥åå•†ã€‚ç”±äºæ˜¯é™æ€å¯†é’¥åå•†ç®—æ³•ï¼ŒECDH çš„å‚æ•°å’Œå…¬é’¥åŒ…å«åœ¨è¯ä¹¦ä¸­; å…¬é’¥å¿…é¡»ä½¿ç”¨ä¸€ä¸ªèƒ½å¤Ÿè¢« Client æ”¯æŒçš„æ›²çº¿å’Œç‚¹æ ¼å¼, æ­£å¦‚ [TLSECC] ä¸­æè¿°çš„é‚£æ ·ã€‚ç›®å‰è¿™ç§å¥—ä»¶å·²ç»å¾ˆå°‘è§äº†ï¼Œå› ä¸º ECDH ä¸æ”¯æŒå‰å‘å®‰å…¨æ€§ ECDHE_ECDSA è¯ä¹¦åŒ…å« ECDSA-capable å…¬é’¥ï¼Œä½¿ç”¨ ECDHE ç®—æ³•åå•†é¢„å¤‡ä¸»å¯†é’¥; è¯ä¹¦å¿…é¡»å…è®¸å¯†é’¥ç”¨äºä½¿ç”¨å°†åœ¨ Server å¯†é’¥äº¤æ¢æ¶ˆæ¯ä¸­ä½¿ç”¨çš„æ•£åˆ—ç®—æ³•è¿›è¡Œç­¾å;å…¬é’¥å¿…é¡»ä½¿ç”¨ä¸€ä¸ªèƒ½å¤Ÿè¢« Client æ”¯æŒçš„æ›²çº¿å’Œç‚¹æ ¼å¼ï¼ŒClient é€šè¿‡ Client Hello æ¶ˆæ¯ä¸­çš„ ec_point_formats æ‰©å±•æŒ‡å®šæ”¯æŒçš„å‘½åæ›²çº¿ï¼Œæ­£å¦‚ [TLSECC] ä¸­æè¿°çš„é‚£æ ·ã€‚è¿™æ˜¯ TLS 1.2 ä¸­æœ€å®‰å…¨ï¼Œæ€§èƒ½æœ€é«˜çš„å¯†ç å¥—ä»¶ã€‚ å¦‚æœ Client æä¾›äº†ä¸€ä¸ª â€œsignature_algorithmsâ€ æ‰©å±•ï¼Œåˆ™ Server æä¾›çš„æ‰€æœ‰è¯ä¹¦å¿…é¡»ç”±å‡ºç°åœ¨è¿™ä¸ªæ‰©å±•ä¸­çš„ä¸€ä¸ª hash/ç­¾åç®—æ³•å¯¹è¿›è¡Œç­¾åã€‚éœ€è¦æ³¨æ„çš„æ˜¯è¿™æ„å‘³ç€ä¸€ä¸ªåŒ…å«äº†ä¸€ä¸ªç­¾åç®—æ³•å¯†é’¥çš„è¯ä¹¦åº”è¯¥è¢«ä¸€ä¸ªä¸åŒçš„ç­¾åç®—æ³•ç­¾å(ä¾‹å¦‚ï¼ŒRSA å¯†é’¥è¢« DSA å¯†é’¥ç­¾å)ã€‚è¿™ä¸ªä¸ TLS 1.1 ä¸åŒï¼ŒTLS 1.1 ä¸­è¦æ±‚ç®—æ³•æ˜¯ç›¸åŒçš„ã€‚æ›´è¿›ä¸€æ­¥ä¹Ÿè¯´æ˜äº† DH_DSSï¼ŒDH_RSAï¼ŒECDH_ECDSAï¼Œå’Œ ECDH_RSA å¥—ä»¶çš„ååŠéƒ¨åˆ†å¯¹åº”çš„å…¬é’¥ä¸ä¼šç”¨æ¥åŠ å¯†æˆ–è€…æ•°å­—ç­¾åï¼Œæ²¡æœ‰å­˜åœ¨çš„å¿…è¦æ€§ï¼Œå¹¶ä¸”ååŠéƒ¨åˆ†ä¹Ÿä¸é™åˆ¶ CA æœºæ„ç­¾å‘è¯ä¹¦æ‰€é€‰ç”¨çš„æ•°å­—ç­¾åç®—æ³•ã€‚å›ºå®šçš„ DH è¯ä¹¦å¯ä»¥è¢«å‡ºç°åœ¨æ‰©å±•ä¸­çš„ä»»æ„ hash/ç­¾åç®—æ³•å¯¹ç­¾åã€‚DH_DSSï¼ŒDH_RSAï¼ŒECDH_ECDSAï¼Œå’Œ ECDH_RSA æ˜¯å†å²ä¸Šçš„åç§°ã€‚ å¦‚æœ Server æœ‰å¤šä¸ªè¯ä¹¦, å®ƒåŸºäºä¸Šè¿°æ ‡å‡†(æ­¤å¤–å…¶å®ƒçš„æ ‡å‡†æœ‰:ä¼ è¾“å±‚ç«¯ç‚¹ï¼Œæœ¬åœ°é…ç½®å’Œåå¥½ç­‰)é€‰æ‹©å…¶ä¸­ä¸€ä¸ªã€‚å¦‚æœ Server åªæœ‰ä¸€ä¸ªè¯ä¹¦ï¼Œå®ƒåº”è¯¥å°è¯•ä½¿è¿™ä¸ªè¯ä¹¦ç¬¦åˆè¿™äº›æ ‡å‡†ã€‚ éœ€è¦æ³¨æ„çš„æ˜¯æœ‰å¾ˆå¤šè¯ä¹¦ä½¿ç”¨æ— æ³•ä¸ TLS å…¼å®¹çš„ç®—æ³•æˆ–ç®—æ³•ç»„åˆã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªä½¿ç”¨ RSASSA-PSS ç­¾åå¯†é’¥çš„è¯ä¹¦(åœ¨ SubjectPublicKeyInfo ä¸­æ˜¯ id-RSASSA-PSS OID)ä¸èƒ½è¢«ä½¿ç”¨å› ä¸º TLS æ²¡æœ‰å®šä¹‰ç›¸åº”çš„ç­¾åç®—æ³•ã€‚ æ­£å¦‚å¯†é’¥å¥—ä»¶æŒ‡å®šäº†ç”¨äº TLS åè®®çš„æ–°çš„å¯†é’¥äº¤æ¢æ–¹æ³•ï¼Œå®ƒä»¬ä¹ŸåŒæ ·æŒ‡å®šäº†è¯ä¹¦æ ¼å¼å’Œè¦æ±‚çš„ç¼–ç çš„æŒ‰é”®ä¿¡æ¯ã€‚ è‡³æ­¤å·²ç»æ¶‰åŠåˆ°äº† Client ç­¾åç®—æ³•ã€è¯ä¹¦ç­¾åç®—æ³•ã€å¯†ç å¥—ä»¶ã€Server å…¬é’¥ï¼Œè¿™ 4 è€…ç›¸äº’æœ‰å…³è”ï¼Œä¹Ÿæœ‰æ²¡æœ‰å…³ç³»çš„ã€‚ Client ç­¾åç®—æ³•éœ€è¦å’Œè¯ä¹¦ç­¾åç®—æ³•ç›¸äº’åŒ¹é…ï¼Œå¦‚æœ Client Hello ä¸­çš„ signature_algorithms æ‰©å±•ä¸è¯ä¹¦é“¾ä¸­çš„è¯ä¹¦ç­¾åç®—æ³•ä¸åŒ¹é…çš„è¯ï¼Œç»“æœæ˜¯æ¡æ‰‹å¤±è´¥ã€‚ Server å…¬é’¥ä¸è¯ä¹¦ç­¾åç®—æ³•æ— ä»»ä½•å…³ç³»ã€‚è¯ä¹¦ä¸­åŒ…å« Server è¯ä¹¦ï¼Œè¯ä¹¦ç­¾åç®—æ³•å¯¹ Server å…¬é’¥è¿›è¡Œç­¾åï¼Œä½†æ˜¯ Server å…¬é’¥çš„åŠ å¯†ç®—æ³•å¯ä»¥æ˜¯ RSA ä¹Ÿå¯ä»¥æ˜¯ ECDSAã€‚ å¯†ç å¥—ä»¶å’Œ Server å…¬é’¥å­˜åœ¨ç›¸äº’åŒ¹é…çš„å…³ç³»ï¼Œå› ä¸ºå¯†ç å¥—ä»¶ä¸­çš„èº«ä»½éªŒè¯ç®—æ³•æŒ‡çš„å°±æ˜¯ Server å…¬é’¥ç±»å‹ã€‚ TLS 1.2 ä¼šè¯æ¢å¤å½“ Client å’Œ Server å†³å®šå¤ç”¨ä¹‹å‰çš„ä¸€ä¸ªTLSè¿æ¥ä¼šè¯æ—¶ï¼ˆèµ°TLSæ¡æ‰‹ç¼“å­˜ï¼‰ï¼Œéœ€è¦ä»¥ä¸‹æµç¨‹ï¼š Client ä½¿ç”¨éœ€è¦æ¢å¤çš„å½“å‰ä¼šè¯çš„ ID å‘é€ä¸€ä¸ª ClientHelloã€‚Server æ£€æŸ¥å®ƒçš„ä¼šè¯ç¼“å­˜ä»¥è¿›è¡ŒåŒ¹é…ã€‚å¦‚æœåŒ¹é…æˆåŠŸï¼Œå¹¶ä¸” Server æ„¿æ„åœ¨æŒ‡å®šçš„ä¼šè¯çŠ¶æ€ä¸‹é‡å»ºè¿æ¥ï¼Œå®ƒå°†ä¼šå‘é€ä¸€ä¸ªå¸¦æœ‰ç›¸åŒä¼šè¯ ID å€¼çš„ ServerHello æ¶ˆæ¯ã€‚è¿™æ—¶ï¼ŒClient å’Œ Server å¿…é¡»éƒ½å‘é€ ChangeCipherSpec æ¶ˆæ¯å¹¶ä¸”ç›´æ¥å‘é€ Finished æ¶ˆæ¯ã€‚ä¸€æ—¦é‡å»ºç«‹å®Œæˆï¼ŒClient å’Œ Server å¯ä»¥å¼€å§‹äº¤æ¢åº”ç”¨å±‚æ•°æ®(è§ä¸‹é¢çš„æµç¨‹å›¾)ã€‚å¦‚æœä¸€ä¸ªä¼šè¯ ID ä¸åŒ¹é…ï¼ŒServer ä¼šäº§ç”Ÿä¸€ä¸ªæ–°çš„ä¼šè¯ IDï¼Œç„¶å TLS Client å’Œ Server éœ€è¦è¿›è¡Œä¸€æ¬¡å®Œæ•´çš„æ¡æ‰‹ã€‚ Session IDæ­¤æ—¶æœ‰ä¸¤ç§æ–¹æ³•å¯ä»¥æ¢å¤åŸæ¥çš„session session ID session ticket Sessionç”¨äºä¿å­˜æ¯ä¸ªç”¨æˆ·çš„ä¸“ç”¨ä¿¡æ¯ï¼Œå˜é‡çš„å€¼ä¿å­˜åœ¨æœåŠ¡å™¨ç«¯ï¼Œé€šè¿‡Session IDæ¥åŒºåˆ†ä¸åŒçš„å®¢æˆ·ï¼Œé€šè¿‡è¿™ä¸ªSession IDï¼ŒåŒæ–¹è¿˜å¯ä»¥é‡æ–°ä½¿ç”¨å·²æœ‰çš„â€å¯¹è¯å¯†é’¥â€œï¼Œæ— éœ€é‡æ–°ç”Ÿæˆ åŸºäº Session ID çš„ä¼šè¯æ¢å¤ Session ID çš„æ¥æºï¼š ä¸Šæ¬¡å®Œå…¨æ¡æ‰‹ç”Ÿæˆçš„ Session ID ä½¿ç”¨å¦å¤–ä¸€æ¡è¿æ¥çš„ Session ID ç›´æ¥ä½¿ç”¨æœ¬æ¬¡è¿æ¥çš„ Session ID åŸºäº Session ID çš„ä¼šè¯æ¢å¤çš„ä¼˜ç‚¹æ˜¯: å‡å°‘ç½‘ç»œå»¶è¿Ÿï¼Œæ¡æ‰‹è€—æ—¶ä» 2-RTT -&gt; 1-RTTï¼ˆclient helloçš„æ—¶å€™å°±å‘äº†ï¼‰ å‡å°‘äº† Client å’Œ Server ç«¯çš„è´Ÿè½½ï¼Œå‡å°‘äº†åŠ å¯†è¿ç®—çš„ CPU èµ„æºæ¶ˆè€— é«˜å…¼å®¹æ€§ åŸºäº Session ID çš„ä¼šè¯æ¢å¤çš„ç¼ºç‚¹æ˜¯: Server å­˜å‚¨ä¼šè¯ä¿¡æ¯ï¼Œé™åˆ¶äº† Server çš„æ‰©å±•èƒ½åŠ›ã€‚ åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œå¦‚æœåªæ˜¯ç®€å•çš„åœ¨ Server çš„å†…å­˜ä¸­å­˜å‚¨ Session Cacheï¼Œé‚£ä¹ˆå¤šå°æœºå™¨çš„æ•°æ®åŒæ­¥ä¹Ÿæ˜¯ä¸€ä¸ªé—®é¢˜ã€‚ï¼ˆåªèƒ½ä¿ç•™åœ¨ä¸€ä¸ªæœåŠ¡å™¨ä¸Šï¼‰ åŸºäº Session ID ä¼šè¯æ¢å¤çš„æµç¨‹å¦‚ä¸‹ï¼š Client Server ClientHello --------&gt; ServerHello [ChangeCipherSpec] &lt;-------- Finished [ChangeCipherSpec] Finished --------&gt; Application Data &lt;-------&gt; Application DataSession Ticket åŸºäº Session Ticket çš„ä¼šè¯æ¢å¤æµç¨‹ï¼š å¯¹äº Server æ¥è¯´ï¼Œè§£å¯† ticket å°±å¯ä»¥å¾—åˆ°ä¸»å¯†é’¥ï¼Œ(æ³¨æ„è¿™é‡Œå’Œ SessionID ä¸åŒï¼Œæœ‰ Session ID å¯ä»¥å¾—åˆ°ä¸»å¯†é’¥çš„ä¿¡æ¯) å…¶æ€æƒ³æ˜¯æœåŠ¡å™¨å–å‡ºå®ƒçš„æ‰€æœ‰ä¼šè¯æ•°æ®ï¼ˆçŠ¶æ€ï¼‰å¹¶è¿›è¡ŒåŠ å¯† (å¯†é’¥åªæœ‰æœåŠ¡å™¨çŸ¥é“)ï¼Œå†ä»¥ç¥¨è¯çš„æ–¹å¼å‘å›å®¢æˆ·ç«¯ã€‚åœ¨æ¥ä¸‹æ¥çš„è¿æ¥ä¸­ï¼Œå®¢æˆ·ç«¯æ¢å¤ä¼šè¯æ—¶åœ¨ ClientHello çš„æ‰©å±•å­—æ®µ session_ticket ä¸­æºå¸¦åŠ å¯†ä¿¡æ¯å°†ç¥¨è¯æäº¤å›æœåŠ¡å™¨ï¼Œç”±æœåŠ¡å™¨æ£€æŸ¥ç¥¨è¯çš„å®Œæ•´æ€§ï¼Œè§£å¯†å…¶å†…å®¹ï¼Œå†ä½¿ç”¨å…¶ä¸­çš„ä¿¡æ¯æ¢å¤ä¼šè¯ã€‚ Session Ticket çš„ä¼˜ç‚¹ä¹Ÿå°±å†³å®šäº†å®ƒç‰¹åˆ«é€‚åˆåœ¨ä»¥ä¸‹åœºæ™¯ä¸­ä½¿ç”¨ï¼š å¤§å‹ HTTPS ç½‘ç«™ï¼Œè®¿é—®é‡éå¸¸å¤§ï¼Œåœ¨ Server ä¸­å­˜å‚¨ Session ä¿¡æ¯éœ€è¦æ¶ˆè€—å¤§é‡å†…å­˜ HTTPS ç½‘ç«™æ‰€æœ‰è€…å¸Œæœ›ä¼šè¯ä¿¡æ¯çš„ç”Ÿå‘½å‘¨æœŸèƒ½è¶³å¤Ÿé•¿ï¼Œè®© Client å°½é‡éƒ½ä½¿ç”¨ç®€çŸ­æ¡æ‰‹çš„æ–¹å¼ HTTPS ç½‘ç«™æ‰€æœ‰è€…å¸Œæœ›ç”¨æˆ·èƒ½è·¨åœ°åŸŸè·¨ä¸»æœºè®¿é—® æ ¡éªŒ SessionTicket å¤±è´¥ï¼Œé‚£ä¹ˆæ¡æ‰‹ä¼šå›é€€åˆ°å®Œæ•´æ¡æ‰‹ã€‚ å¦‚æœ Client åœ¨ ClientHello ä¸­åŒæ—¶å‘é€äº† Session ID å’Œ SessionTicket TLS æ‰©å±•ï¼ŒSessionTicket ä¼˜å…ˆçº§é«˜äº Session ID SessionTicket ä¼šè¯æ¢å¤ Client Server ClientHello (SessionTicket extension) --------> ServerHello (empty SessionTicket extension) NewSessionTicket [ChangeCipherSpec] &lt;-------- Finished [ChangeCipherSpec] Finished --------> Application Data &lt;-------> Application Data SeveréªŒè¯äº†å®¢æˆ·ç«¯å‘é€Finishedæ¶ˆæ¯åï¼Œé€šè¿‡â€New session ticketâ€æ¶ˆæ¯å°†session ticketå‘ç»™å®¢æˆ·ç«¯è¿›è¡Œä¿å­˜ï¼ŒæœåŠ¡å™¨ç«¯å°±ä¸å†ä¿å­˜ä¼šè¯çŠ¶æ€äº†ï¼Œä¸‹å›¾æ˜¯è¿™æ¡æ¶ˆæ¯æ‰€åœ¨çš„æµç¨‹æ­¥éª¤ï¼š å®¢æˆ·ç«¯åœ¨ä¸‹æ¬¡å‘èµ·ä¼šè¯æ—¶ï¼Œå°±å¯ä»¥å°†Session Ticketæ”¾å…¥client helloä¸­ï¼ŒæœåŠ¡å™¨æ”¶åˆ°åè¿›è¡Œè§£å¯†éªŒè¯ï¼Œå¹¶ä»ticketçš„å†…å®¹ä¸­æå–ä¼šè¯çŠ¶æ€ï¼Œç”¨æ¥æ¢å¤ä¼šè¯ã€‚ session ticketä¼˜ç‚¹ å¯åœ¨å…¶ä»–æœåŠ¡å™¨ä¸Šä½¿ç”¨ï¼Œå®ƒåŸç†ä¸Šå°±æ˜¯è®©xxçš„çš„è¯·æ±‚ä¸€ç›´ç²˜è¿åœ¨æœºå™¨Aä¸Šï¼Œä¸‹æ¬¡é‡è¿çš„æ—¶å€™ï¼Œå°±æŠŠè¿™ä¸ª Ticket è¿›è¡Œè§£å¯†ï¼ŒéªŒè¯å®ƒè¿‡æ²¡è¿‡æœŸï¼Œå¦‚æœæ²¡è¿‡æœŸé‚£å°±ç›´æ¥æ¢å¤ä¹‹å‰çš„ä¼šè¯çŠ¶æ€ã€‚ ç¼ºç‚¹ï¼š å…¼å®¹æ€§æ¯”ä¸ä¸Šsession id å’Œsession idä¸€æ ·ï¼Œæœ‰å®‰å…¨é£é™© ä¹‹å‰ä¼šè¯çš„master keyæ˜¯å¦æ³„å¯†ï¼ˆSession Ticket: åŠ å¯†åçš„session statusä¿¡æ¯ï¼ŒåŒ…å«äº†master keyï¼‰ï¼Œå¦åˆ™æ–°çš„session keyä¹Ÿä¸å®‰å…¨ã€‚ ç¼ºä¹èº«ä»½éªŒè¯æœºåˆ¶ï¼Œæ— æ³•é˜²æ­¢ä¸­é—´äººæ”»å‡»ã€‚ï¼ˆéœ€è¦è¯ä¹¦è®¤è¯æ¥ä¿è¯ï¼‰ TLSç»™å‡ºçš„æ–¹æ¡ˆæ˜¯ï¼Œæ¢å¤ä¼šè¯å¿…é¡»åŒæ–¹éƒ½åŒæ„ï¼Œå¦‚æœæœ‰ä¸€æ–¹è®¤ä¸ºä¼šè¯ä¸å®‰å…¨ï¼Œå°±éƒ½éœ€è¦é‡æ–°èµ°ä¸€éå®Œæ•´çš„æ¡æ‰‹æµç¨‹ï¼›å¦å¤–å®¢æˆ·ç«¯ä¿å­˜session ticketçš„æœ‰æ•ˆæœŸæœ€é•¿ä¸è¦è¶…è¿‡24å°æ—¶ï¼› å¦‚æœå¯¹äºsessionIDå’Œticketè¿˜ä¸å¤ªæ˜ç™½Session idï¼š Session idæ˜¯ç”±æœåŠ¡å™¨åˆ†é…çš„ï¼Œå‘ç»™å®¢æˆ·ç«¯è®©å®¢æˆ·ç«¯ä¿å­˜ï¼Œåœ¨å®¢æˆ·ç«¯å‘èµ·æ–°ä¼šè¯æ—¶ï¼Œä¼šå°†è¿™ä¸ªIDåœ¨client helloä¸­å‘ç»™æœåŠ¡å™¨ï¼Œç”¨æ¥åˆ¤æ–­æ˜¯å¦æ¢å¤ä¹‹å‰çš„sessionã€‚ æœåŠ¡å™¨åœ¨ç¼“å­˜ä¸­æŸ¥æ‰¾è¯¥idï¼Œå¦‚æœæ‰¾åˆ°äº†ï¼Œå¹¶ä¸”æœåŠ¡å™¨æ„¿æ„é‡å»ºè¯¥ä¼šè¯çš„è¯ï¼Œé‚£ä¹ˆå°±ä¼šåœ¨Sever Helloæ¶ˆæ¯ä¸­å‘é€åŒæ ·çš„session id ä¹‹ååŒæ–¹å°±å¯ä»¥å¼€å§‹ç”¨ä¹‹å‰åå•†è¿‡çš„åŠ å¯†æ¨¡å¼å¼€å§‹ä¼ è¾“æ•°æ®ã€‚ Session idæ˜¯æœ€ä¼ ç»Ÿçš„æ–¹å¼ï¼Œå®ƒçš„ä¸»è¦é—®é¢˜æ˜¯ï¼Œä¼šè¯çŠ¶æ€ä¿å­˜åœ¨æœåŠ¡å™¨ç«¯ï¼Œå½“å¤§é‡ç”¨æˆ·è®¿é—®æœåŠ¡å™¨æ—¶ï¼ŒæœåŠ¡å™¨ç”¨æ¥ä¿å­˜ä¼šè¯çŠ¶æ€çš„ç©ºé—´å ç”¨å°±ä¼šå¾ˆå¤§ï¼Œéœ€è¦å¯¹ä¿å­˜æ—¶é—´ï¼Œä¿å­˜æœºåˆ¶åšä¼˜åŒ–ã€‚ session ticketï¼š æœåŠ¡å™¨åœ¨è·å–åˆ°å®¢æˆ·ç«¯çš„å¯†é’¥åå•†å‚æ•°ï¼Œå¹¶ç”Ÿæˆsession keyä¹‹åï¼Œä¼šå°†å®Œæ•´çš„ä¼šè¯çŠ¶æ€(session status)è¿›è¡ŒåŠ å¯†ï¼Œç”Ÿæˆsession ticketï¼Œæ³¨æ„ï¼Œè¿™ä¸ªä¿¡æ¯åªæœ‰æœåŠ¡å™¨æ‰èƒ½å¤Ÿè§£å¯† SeveréªŒè¯äº†å®¢æˆ·ç«¯å‘é€Finishedæ¶ˆæ¯åï¼Œé€šè¿‡â€New session ticketâ€æ¶ˆæ¯å°†session ticketå‘ç»™å®¢æˆ·ç«¯è¿›è¡Œä¿å­˜ï¼ŒæœåŠ¡å™¨ç«¯å°±ä¸å†ä¿å­˜ä¼šè¯çŠ¶æ€äº†ï¼Œä¸‹å›¾æ˜¯è¿™æ¡æ¶ˆæ¯æ‰€åœ¨çš„æµç¨‹æ­¥éª¤ï¼š å®¢æˆ·ç«¯åœ¨ä¸‹æ¬¡å‘èµ·ä¼šè¯æ—¶ï¼Œå°±å¯ä»¥å°†Session Ticketæ”¾å…¥client helloä¸­ï¼ŒæœåŠ¡å™¨æ”¶åˆ°åè¿›è¡Œè§£å¯†éªŒè¯ï¼Œå¹¶ä»ticketçš„å†…å®¹ä¸­æå–ä¼šè¯çŠ¶æ€ï¼Œç”¨æ¥æ¢å¤ä¼šè¯ã€‚ ï¼ˆä½ å¤§æ¦‚å¯ä»¥ç†è§£ä¸ºï¼ŒæŠŠä¼šè¯å†…å®¹åŠ å¯†åå½“æˆsessionå‡­è¯æ¥ä½¿ç”¨äº†ï¼‰ PSKï¼ˆpre_share_keyï¼‰åœ¨TLS1.3ä¸­ï¼Œå¼•å…¥æ–°çš„session resumptionæœºåˆ¶ä»£æ›¿äº†session idå’Œticket. åŒæ–¹ç»è¿‡æ¡æ‰‹å’Œå¯†é’¥åå•†ï¼Œå’Œèº«ä»½éªŒè¯ä¹‹åï¼Œç”Ÿæˆå¯¹ç§°çš„å¯†é’¥session keyã€‚ åœ¨æ”¶åˆ°å®¢æˆ·ç«¯çš„finishedæ¶ˆæ¯ä¹‹åï¼ŒæœåŠ¡å™¨é€šè¿‡â€new session ticketâ€æ¶ˆæ¯ï¼Œæºå¸¦PSKå‘é€ç»™å®¢æˆ·ç«¯ï¼Œæ³¨æ„è¿™æ¡æ¶ˆæ¯æ˜¯ä½¿ç”¨session keyåŠ å¯†çš„ï¼Œè¿™å°±ä¿è¯äº†åªæœ‰é€šä¿¡åŒæ–¹æ‰èƒ½è¯»å–é‡Œé¢çš„ä¿¡æ¯ã€‚ï¼ˆå®è´¨ä¸Šæˆ‘ä¸ªäººç†è§£å°±æ˜¯éå¯¹ç§°å¯†é’¥ä¿è¯å®‰å…¨æ€§ï¼Œç„¶åä½¿ç”¨åŸæ¥çš„å¯¹ç§°å¯†é’¥ä¿è¯ä¾¿æ·æ€§ï¼‰ åªè¦è¯æ˜äº†åŒæ–¹éƒ½æŒæœ‰ç›¸åŒçš„ PSKï¼Œå°±ä¸å†éœ€è¦è¯ä¹¦è®¤è¯æ¥è¯æ˜åŒæ–¹çš„èº«ä»½ï¼Œè¿™æ ·çœ‹æ¥ï¼ŒPSK ä¹Ÿç®—æ˜¯ä¸€ç§èº«ä»½è®¤è¯æœºåˆ¶ã€‚ æœåŠ¡å™¨å¯èƒ½ä¼šå‘é€å¤šä¸ªnew session ticketï¼ŒåŒ…å«ä¸åŒçš„PSKï¼› åœ¨å»ºç«‹æ–°ä¼šè¯æ—¶ï¼Œå®¢æˆ·ç«¯å°†PSKä¿¡æ¯æ”¾å…¥client Helloæ¶ˆæ¯ä¸­å‘é€ç»™æœåŠ¡å™¨ï¼ŒæŠ¥æ–‡å¦‚ä¸‹ï¼š å¦‚æœæœåŠ¡å™¨éªŒè¯äº†è¯¥PSKçš„çœŸå®æ€§ï¼Œåˆ™ä¼šåœ¨server helloä¸­çš„pre_shared_keyä¸­å°†åŠ å¯†çš„PSKå‘é€ç»™å®¢æˆ·ç«¯ï¼› é‚£ä¹ˆä¹‹å‰çš„PSKå°±ä¼šè¢«ç”¨æ¥ç”Ÿæˆæ–°çš„session keyï¼Œå¹¶å¼€å§‹åŠ å¯†ä¼ è¾“æ•°æ®ï¼Œä¸éœ€è¦å†å‘é€CAè¯ä¹¦ç­‰éªŒè¯æ¶ˆæ¯äº†ã€‚ åªè¦è¯æ˜äº†åŒæ–¹éƒ½æŒæœ‰ç›¸åŒçš„PSKï¼Œä¸å†éœ€è¦è¯ä¹¦è®¤è¯ï¼Œå°±å¯ä»¥è¯æ˜åŒæ–¹çš„èº«ä»½ï¼Œå› æ­¤ï¼ŒPSKä¹Ÿæ˜¯ä¸€ç§èº«ä»½è®¤è¯æœºåˆ¶ã€‚ Client Server ClientHello + key_share --------> ServerHello + key_share {EncryptedExtensions} {CertificateRequest*} {Certificate*} {CertificateVerify*} {Finished} &lt;-------- [Application Data*] {Certificate*} {CertificateVerify*} {Finished} --------> &lt;-------- [NewSessionTicket] [Application Data] &lt;-------> [Application Data] TLS1.3å…ˆç®€è¿°ä¸€ä¸‹ TLS 1.3 çš„ä¸€äº›ä¼˜åŒ–å’Œæ”¹è¿›: å‡å°‘æ¡æ‰‹ç­‰å¾…æ—¶é—´ï¼Œå°†æ¡æ‰‹æ—¶é—´ä» 2-RTT é™ä½åˆ° 1-RTTï¼Œå¹¶ä¸”å¢åŠ  0-RTT æ¨¡å¼ã€‚ åˆ é™¤ RSA å¯†é’¥åå•†æ–¹å¼ï¼Œé™æ€çš„ Diffie-Hellman å¯†ç å¥—ä»¶ä¹Ÿè¢«åˆ é™¤äº†ã€‚å› ä¸º RSA ä¸æ”¯æŒå‰å‘åŠ å¯†æ€§ã€‚TLS 1.3 åªæ”¯æŒ (EC)DHE çš„å¯†é’¥åå•†ç®—æ³•ã€‚åˆ é™¤äº† RSA çš„æ–¹å¼ä»¥åï¼Œèƒ½æœ‰æ•ˆé¢„é˜²å¿ƒè„å‡ºè¡€çš„æ”»å‡»ã€‚æ‰€æœ‰åŸºäºå…¬é’¥çš„å¯†é’¥äº¤æ¢ç®—æ³•ç°åœ¨éƒ½èƒ½æä¾›å‰å‘å®‰å…¨ã€‚TLS 1.3 è§„èŒƒä¸­åªæ”¯æŒ 5 ç§å¯†é’¥å¥—ä»¶ï¼ŒTLS13-AES-256-GCM-SHA384ã€TLS13-CHACHA20-POLY1305-SHA256ã€TLS13-AES-128-GCM-SHA256ã€TLS13-AES-128-CCM-8-SHA256ã€TLS13-AES-128-CCM-SHA256ï¼Œéšè—äº†éå¯¹ç§°åŠ å¯†å¯†é’¥åå•†ç®—æ³•ï¼Œå› ä¸ºé»˜è®¤éƒ½æ˜¯æ¤­åœ†æ›²çº¿å¯†é’¥åå•†ã€‚ åˆ é™¤å¯¹ç§°åŠ å¯†ä¸­ï¼Œåˆ†ç»„åŠ å¯†å’Œ MAC å¯¼è‡´çš„ä¸€äº›éšæ‚£ã€‚åœ¨ TLS1.3 ä¹‹å‰çš„ç‰ˆæœ¬ä¸­ï¼Œé€‰æ‹©çš„æ˜¯ MAC-then-Encrypt æ–¹å¼ã€‚ä½†æ˜¯è¿™ç§æ–¹å¼å¸¦æ¥äº†ä¸€äº›æ¼æ´ï¼Œä¾‹å¦‚ BEASTï¼Œä¸€ç³»åˆ—å¡«å…… oracle æ¼æ´(Lucky 13 å’Œ Lucky Microseconds)ã€‚CBC æ¨¡å¼å’Œå¡«å……ä¹‹é—´çš„äº¤äº’ä¹Ÿæ˜¯ SSLv3 å’Œä¸€äº› TLS å®ç°ä¸­å¹¿æ³›å®£ä¼ çš„ POODLE æ¼æ´åŸå› ã€‚åœ¨ TLS 1.3 ä¸­ï¼Œå·²ç§»é™¤æ‰€æœ‰æœ‰å®‰å…¨éšæ‚£çš„å¯†ç å’Œå¯†ç æ¨¡å¼ã€‚ä½ ä¸èƒ½å†ä½¿ç”¨ CBC æ¨¡å¼å¯†ç æˆ–ä¸å®‰å…¨çš„æµå¼å¯†ç ï¼Œå¦‚ RC4 ã€‚TLS 1.3 ä¸­å…è®¸çš„å”¯ä¸€ç±»å‹çš„å¯¹ç§°åŠ å¯†æ˜¯ä¸€ç§ç§°ä¸º AEADï¼ˆauthenticated encryption with additional dataï¼‰çš„æ–°ç»“æ„ï¼Œå®ƒå°†åŠ å¯†æ€§å’Œå®Œæ•´æ€§æ•´åˆåˆ°ä¸€ä¸ªæ— ç¼æ“ä½œä¸­ã€‚ åœ¨ TLS 1.3ä¸­ï¼Œåˆ é™¤äº† PKCSï¼ƒ1 v1.5 çš„æ”¯æŒï¼Œè€Œé€‰æ‹©æ›´æ–°çš„è®¾è®¡ RSA-PSSï¼Œæé«˜äº†å®‰å…¨æ€§ã€‚è®¤è¯æ–¹é¢é€šè¿‡éå¯¹ç§°ç®—æ³•ï¼Œä¾‹å¦‚ï¼ŒRSA, æ¤­åœ†æ›²çº¿æ•°å­—ç­¾åç®—æ³•(ECDSA)ï¼Œæˆ– Edwards æ›²çº¿æ•°å­—ç­¾åç®—æ³•(EdDSA)å®Œæˆï¼Œæˆ–é€šè¿‡ä¸€ä¸ªå¯¹ç§°çš„é¢„å…±äº«å¯†é’¥ï¼ˆPSK)ã€‚ åœ¨ TLS 1.2 çš„æ¡æ‰‹æµç¨‹ä¸­ï¼Œåªæœ‰ ChangeCipherSpec ä¹‹åçš„æ¶ˆæ¯ä¼šè¢«åŠ å¯†ï¼Œå¦‚ Finished æ¶ˆæ¯å’Œ NewSessionTicketï¼Œå…¶ä»–çš„æ¡æ‰‹å­æ¶ˆæ¯ä¸ä¼šåŠ å¯†ã€‚TLS 1.3 é’ˆå¯¹è¿™ä¸ªé—®é¢˜ï¼Œå¯¹æ¡æ‰‹ä¸­å¤§éƒ¨åˆ†å­æ¶ˆæ¯å…¨éƒ¨è¿›è¡ŒåŠ å¯†å¤„ç†ã€‚è¿™æ ·å¯ä»¥æœ‰æ•ˆçš„é¢„é˜² FREAKï¼ŒLogJam å’Œ CurveSwap è¿™äº›é™çº§æ”»å‡»(é™çº§æ”»å‡»æ˜¯ä¸­é—´äººåˆ©ç”¨åå•†ï¼Œå¼ºåˆ¶ä½¿é€šä¿¡åŒæ–¹ä½¿ç”¨èƒ½è¢«æ”¯æŒçš„æœ€ä½å¼ºåº¦çš„åŠ å¯†ç®—æ³•ï¼Œä»è€Œæš´åŠ›æ”»å‡»è®¡ç®—å‡ºå¯†é’¥ï¼Œå…è®¸æ”»å‡»è€…åœ¨æ¡æ‰‹æ—¶ä¼ªé€  MAC)ã€‚åœ¨TLS 1.3ä¸­ï¼Œè¿™ç§ç±»å‹çš„é™çº§æ”»å‡»æ˜¯ä¸å¯èƒ½çš„ï¼Œå› ä¸ºæœåŠ¡å™¨ç°åœ¨ç­¾ç½²äº†æ•´ä¸ªæ¡æ‰‹ï¼ŒåŒ…æ‹¬å¯†ç åå•†ã€‚ TLS 1.3 å®Œå…¨ç¦æ­¢é‡åå•†ã€‚ å¯†é’¥å¯¼å‡ºå‡½æ•°è¢«é‡æ–°è®¾è®¡ï¼Œç”± TLS 1.2 çš„ PRF ç®—æ³•æ”¹ä¸ºæ›´åŠ å®‰å…¨çš„ HKDF ç®—æ³•ã€‚ åºŸé™¤ Session ID å’Œ Session Ticket ä¼šè¯æ¢å¤æ–¹å¼ï¼Œç»Ÿä¸€é€šè¿‡ PSK çš„æ–¹å¼è¿›è¡Œä¼šè¯æ¢å¤ï¼Œå¹¶åœ¨ NewSessionTicket æ¶ˆæ¯ä¸­æ·»åŠ è¿‡æœŸæ—¶é—´å’Œç”¨äºæ··æ·†æ—¶é—´çš„åç§»å€¼ã€‚ æˆ‘ä¸ªäººå½’çº³ä¸º å‡å°‘æ¡æ‰‹ç­‰å¾…æ—¶é—´ï¼Œå°†æ¡æ‰‹æ—¶é—´ä» 2-RTT é™ä½åˆ° 1-RTTï¼Œå¹¶ä¸”å¢åŠ  0-RTT æ¨¡å¼ã€‚ åˆ é™¤ RSA å¯†é’¥åå•†æ–¹å¼ï¼Œé¢„é˜²å¿ƒè„å‡ºè¡€çš„æ”»å‡»ï¼›åˆ é™¤å¯¹ç§°åŠ å¯†ä¸­ï¼Œåˆ†ç»„åŠ å¯†å’Œ MAC å¯¼è‡´çš„ä¸€äº›éšæ‚£ï¼›åˆ é™¤äº† PKCSï¼ƒ1 v1.5 çš„æ”¯æŒï¼Œè€Œé€‰æ‹©æ›´æ–°çš„è®¾è®¡ RSA-PSSï¼Œæé«˜äº†å®‰å…¨æ€§ï¼›å¯¹æ¡æ‰‹ä¸­å¤§éƒ¨åˆ†å­æ¶ˆæ¯å…¨éƒ¨è¿›è¡ŒåŠ å¯†å¤„ç†ã€‚è¿™æ ·å¯ä»¥æœ‰æ•ˆçš„é¢„é˜² FREAKï¼ŒLogJam å’Œ CurveSwap è¿™äº›é™çº§æ”»å‡»ï¼› å®Œå…¨ç¦æ­¢é‡åå•†ï¼›é‡æ–°è®¾è®¡å¯†é’¥å¯¼å‡ºå‡½æ•°ï¼›æ€»ä½“æ¥è¯´éƒ½æ˜¯æå‡å®‰å…¨æ€§ åºŸé™¤ Session ID å’Œ Session Ticket ä¼šè¯æ¢å¤æ–¹å¼ï¼Œç»Ÿä¸€é€šè¿‡ PSK çš„æ–¹å¼è¿›è¡Œä¼šè¯æ¢å¤ï¼Œå¹¶åœ¨ NewSessionTicket æ¶ˆæ¯ä¸­æ·»åŠ è¿‡æœŸæ—¶é—´å’Œç”¨äºæ··æ·†æ—¶é—´çš„åç§»å€¼ã€‚ æ›´åŠ å®‰å…¨ 4 ç§å¯†é’¥åå•†åœ¨ TLS 1.3 ä¸­ï¼Œå­˜åœ¨ 4 ç§å¯†é’¥åå•†çš„æ–¹æ³•: Client æ”¯æŒçš„åŠ å¯†å¥—ä»¶åˆ—è¡¨ã€‚å¯†ç å¥—ä»¶é‡Œé¢ä¸­èƒ½ä½“ç°å‡º Client æ”¯æŒçš„ AEAD ç®—æ³•æˆ–è€… HKDF å“ˆå¸Œå¯¹ã€‚ï¼ˆTLS1.2å·²æœ‰ï¼‰ â€œsupported_groupsâ€ çš„æ‰©å±• å’Œ â€œkey_shareâ€œ æ‰©å±•ã€‚â€œsupported_groupsâ€ è¿™ä¸ªæ‰©å±•è¡¨æ˜äº† Client æ”¯æŒçš„ (EC)DHE groupsï¼Œâ€key_shareâ€ æ‰©å±•è¡¨æ˜äº† Client æ˜¯å¦åŒ…å«äº†ä¸€äº›æˆ–è€…å…¨éƒ¨çš„ï¼ˆECï¼‰DHEå…±äº«ã€‚ï¼ˆTLS1.3æ–°å¢ï¼Œå®Œæ•´æ¡æ‰‹ï¼‰ â€œsignature_algorithmsâ€ ç­¾åç®—æ³•å’Œ â€œsignature_algorithms_certâ€ ç­¾åè¯ä¹¦ç®—æ³•çš„æ‰©å±•ã€‚â€signature_algorithmsâ€ è¿™ä¸ªæ‰©å±•å±•ç¤ºäº† Client å¯ä»¥æ”¯æŒäº†ç­¾åç®—æ³•æœ‰å“ªäº›ã€‚â€signature_algorithms_certâ€ è¿™ä¸ªæ‰©å±•å±•ç¤ºäº†å…·ä½“è¯ä¹¦çš„ç­¾åç®—æ³•ã€‚ï¼ˆTLS1.3æ–°å¢ï¼Œæ¯”ç¬¬äºŒç§å¸¸ç”¨ï¼‰ â€œpre_shared_keyâ€œ é¢„å…±äº«å¯†é’¥å’Œ â€œpsk_key_exchange_modesâ€ æ‰©å±•ã€‚é¢„å…±äº«å¯†é’¥æ‰©å±•åŒ…å«äº† Client å¯ä»¥è¯†åˆ«çš„å¯¹ç§°å¯†é’¥æ ‡è¯†ã€‚â€psk_key_exchange_modesâ€ æ‰©å±•è¡¨æ˜äº†å¯èƒ½å¯ä»¥å’Œ psk ä¸€èµ·ä½¿ç”¨çš„å¯†é’¥äº¤æ¢æ¨¡å¼ã€‚ï¼ˆTLS1.3æ–°å¢ï¼ŒPSKï¼Œ0-RTTï¼‰ åˆæ¬¡æ¡æ‰‹é™ä½ä¸º1RTTTLS 1.3 ä¹‹æ‰€ä»¥èƒ½æ¯” TLS 1.2 å®Œæ•´æ¡æ‰‹å‡å°‘ 1-RTT çš„åŸå› å°±åœ¨ ClientHello ä¸­å°±å·²ç»åŒ…å«äº† (EC)DHE æ‰€éœ€è¦çš„å¯†é’¥å‚æ•°ï¼Œ ï¼ˆæ˜¯çš„ï¼Œæˆ‘æœ‰äº†ä¸ªkey_shareï¼Œä½†æ˜¯å®é™…ä¸Šæˆ‘ä¸ªäººæ„Ÿè§‰åªæ˜¯å‡å°‘äº†0.5RTTï¼Œåªä¸è¿‡å°†å‰©ä¸‹finishæ‰€éœ€è¦çš„çš„0.5RTTåº”è¯¥æ˜¯æ”¾åˆ°application Data exchangeä¸­äº†ï¼‰ ä¸éœ€è¦åƒ TLS 1.2 ä¸­é¢å¤–ç”¨ç¬¬äºŒæ¬¡ RTT æ¥è¿›è¡Œ DH åå•†å‚æ•°ã€‚åœ¨ TLS 1.3 çš„ ClientHello çš„ Extension ä¸­ï¼Œå¸¦æœ‰ key_share æ‰©å±•ï¼Œè¿™ä¸ªæ‰©å±•ä¸­åŒ…å«äº† Client æ‰€èƒ½æ”¯æŒçš„ (EC)DHE ç®—æ³•çš„å¯†é’¥å‚æ•°ã€‚å¹¶ä¸” Extension ä¸­è¿˜ä¼šæœ‰ supported_groups æ‰©å±•ï¼Œè¿™ä¸ªæ‰©å±•è¡¨æ˜äº† Client æ”¯æŒçš„ç”¨äºå¯†é’¥äº¤æ¢çš„å‘½åç»„ã€‚æŒ‰ç…§ä¼˜å…ˆçº§ä»é«˜åˆ°ä½ã€‚ Client Server ClientHello + key_share --------> ServerHello + key_share {EncryptedExtensions} {CertificateRequest*} {Certificate*} {CertificateVerify*} {Finished} &lt;-------- [Application Data*] {Certificate*} {CertificateVerify*} {Finished} --------> &lt;-------- [NewSessionTicket] [Application Data] &lt;-------> [Application Data] æ¡ä»¶ï¼šåœ¨ ServerHello çš„ Extension ä¸­å¿…é¡»è¦æœ‰çš„è¿™ 2 ä¸ªæ‰©å±•ï¼Œsupported_versionsã€key_share(å¦‚æœæ˜¯ PSK ä¼šè¯æ¢å¤æ–¹å¼ï¼Œè¿˜å¿…é¡»åŒ…å« pre_shared_key)ã€‚ supported_versions æ˜¯ TLS 1.3 ä¸­å¿…å¸¦çš„æ‰©å±•ï¼Œå¦‚æœæ²¡æœ‰è¿™ä¸ªæ‰©å±•ï¼ŒServer ä¼šè®¤ä¸º Client åªèƒ½æ”¯æŒ TLS 1.2ï¼Œäºæ˜¯æ¥ä¸‹æ¥çš„æ¡æ‰‹ä¼šè¿›è¡Œ TLS 1.2 çš„æ¡æ‰‹æµç¨‹ã€‚ TLS1.3ä¼šè¯æ¢å¤TLS 1.3 åœ¨å®£ä¼ çš„æ—¶å€™å°±ä»¥ 0-RTT ä¸ºä¸»ï¼Œå¤§å®¶éƒ½ä¼šè®¤ä¸º TLS 1.3 å†ç¬¬äºŒæ¬¡æ¡æ‰‹çš„æ—¶å€™éƒ½æ˜¯ 0-RTT çš„ï¼ŒåŒ…æ‹¬ç½‘ä¸Šä¸€äº›åˆ†æçš„æ–‡ç« é‡Œé¢æåˆ°çš„æœ€æ–°çš„ PSK å¯†é’¥åå•†ï¼ŒPSK å¯†é’¥åå•†å¹¶éæ˜¯ 0-RTT çš„ã€‚ TLS 1.3 å†æ¬¡æ¡æ‰‹å…¶å®æ˜¯åˆ†ä¸¤ç§ï¼šä¼šè¯æ¢å¤æ¨¡å¼ã€0-RTT æ¨¡å¼ã€‚é 0-RTT çš„ä¼šè¯æ¢å¤æ¨¡å¼å’Œ TLS 1.2 åœ¨è€—æ—¶ä¸Šæ²¡æœ‰æå‡ï¼Œéƒ½æ˜¯ 1-RTTï¼Œåªä¸è¿‡æ¯” TLS 1.2 æ›´åŠ å®‰å…¨äº†ã€‚åªæœ‰åœ¨ 0-RTT çš„ä¼šè¯æ¢å¤æ¨¡å¼ä¸‹ï¼ŒTLS 1.3 æ‰æ¯” TLS 1.2 æœ‰æå‡ã€‚å…·ä½“æå‡å¯¹æ¯”è§ä¸‹è¡¨: HTTP/2 + TLS 1.2 é¦–æ¬¡è¿æ¥ HTTP/2 + TLS 1.2 ä¼šè¯æ¢å¤ HTTP/2 + TLS 1.3 é¦–æ¬¡è¿æ¥ HTTP/2 + TLS 1.3 ä¼šè¯æ¢å¤ HTTP/2 + TLS 1.3 0-RTT DNS è§£æ 1-RTT 0-RTT 1-RTT 0-RTT 0-RTT TCP æ¡æ‰‹ 1-RTT 1-RTT 1-RTT 1-RTT 1-RTT TLS æ¡æ‰‹ 2-RTT 1-RTT 1-RTT 1-RTT 0-RTT HTTP è¯·æ±‚ 1-RTT 1-RTT 1-RTT 1-RTT 1-RTT æ€»è®¡ 5-RTT 3-RTT 4-RTT 3-RTT 2-RTT Client Server Subsequent Handshake: ClientHello + key_share* + pre_shared_key --------> ServerHello + pre_shared_key + key_share* {EncryptedExtensions} {Finished} &lt;-------- [Application Data*] {Finished} --------> [Application Data] &lt;-------> [Application Data] 0RTTæ¨¡å¼TLS 1.3 åºŸé™¤äº†ä¹‹å‰çš„ Session ID å’Œ Session Ticket çš„ä¼šè¯æ¢å¤çš„æ–¹å¼ï¼Œç»Ÿä¸€æˆäº† PSK æ–¹å¼ï¼Œä½¿å¾—åŸæœ‰ä¼šè¯æ¢å¤å˜çš„æ›´åŠ å®‰å…¨ã€‚ä½†æ˜¯ TLS 1.3 çš„ä¼šè¯æ¢å¤å¹¶æ²¡æœ‰é™ä½ RTTï¼Œä¾æ—§åœç•™åœ¨äº† 1-RTTã€‚ä¸ºäº†è¿›ä¸€æ­¥é™ä½å»¶è¿Ÿï¼Œäºæ˜¯æå‡ºäº† 0-RTT çš„æ¦‚å¿µã€‚0-RTT èƒ½è®©ç”¨æˆ·æœ‰æ›´å¿«æ›´é¡ºæ»‘æ›´å¥½çš„ç”¨æˆ·ä½“éªŒï¼Œåœ¨ç§»åŠ¨ç½‘ç»œä¸Šæ›´åŠ æ˜æ˜¾ã€‚ TLS 1.3 çš„é‡Œç¨‹ç¢‘æ ‡å¿—å°±æ˜¯æ·»åŠ äº† 0-RTT ä¼šè¯æ¢å¤æ¨¡å¼ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå½“ client å’Œ server å…±äº«ä¸€ä¸ª PSKï¼ˆä»å¤–éƒ¨è·å¾—æˆ–é€šè¿‡ä¸€ä¸ªä»¥å‰çš„æ¡æ‰‹è·å¾—ï¼‰æ—¶ï¼ŒTLS 1.3 å…è®¸ client åœ¨ç¬¬ä¸€ä¸ªå‘é€å‡ºå»çš„æ¶ˆæ¯ä¸­æºå¸¦æ•°æ®ï¼ˆâ€early dataâ€ï¼‰ã€‚Client ä½¿ç”¨è¿™ä¸ª PSK ç”Ÿæˆ client_early_traffic_secret å¹¶ç”¨å®ƒåŠ å¯† early dataã€‚Server æ”¶åˆ°è¿™ä¸ª ClientHello ä¹‹åï¼Œç”¨ ClientHello æ‰©å±•ä¸­çš„ PSK å¯¼å‡º client_early_traffic_secret å¹¶ç”¨å®ƒè§£å¯† early dataã€‚ 0-RTT ä¼šè¯æ¢å¤æ¨¡å¼å¦‚ä¸‹ï¼š Client Server ClientHello + early_data + key_share* + psk_key_exchange_modes + pre_shared_key (Application Data*) --------> ServerHello + pre_shared_key + key_share* {EncryptedExtensions} + early_data* {Finished} &lt;-------- [Application Data*] (EndOfEarlyData) {Finished} --------> [Application Data] &lt;-------> [Application Data] å¯ä»¥ç†è§£ä¸ºæ­¤æ—¶ä¸ºTLS1.3æ¡æ‰‹æ¢å¤ï¼Œæˆ‘ä»¬å®¢æˆ·ç«¯æœåŠ¡ç«¯åŒæ–¹è®¤è¯ + æºå¸¦PSKï¼Œæˆ‘ä»¬å®¢æˆ·ç«¯å‘é€ç¬¬ä¸€æ¬¡è¯·æ±‚æ—¶ï¼Œç›´æ¥æºå¸¦PSK + é€šè¿‡PSKåŠ å¯†çš„è¦å‘é€çš„æ•°æ®å†…å®¹ï¼ˆearly dataï¼‰ æƒ³å®ç° 0-RTT ä¹Ÿæ˜¯æœ‰ä¸€äº›æ¡ä»¶çš„ï¼Œæ¡ä»¶æ¯”è¾ƒè‹›åˆ»ï¼Œå¦‚æœæ¡ä»¶æœ‰ä¸€æ¡ä¸æ»¡è¶³ï¼Œä¼šè¯æ¢å¤éƒ½åªèƒ½æ˜¯ 1-RTT çš„ PSK ä¼šè¯æ¢å¤æ¨¡å¼ã€‚ 0-RTT çš„å¼€å¯æ¡ä»¶æ˜¯ï¼š Server åœ¨å‰ä¸€æ¬¡å®Œæ•´æ¡æ‰‹ä¸­ï¼Œå‘é€äº† NewSessionTicketï¼Œå¹¶ä¸” Session ticket ä¸­å­˜åœ¨max_early_data_size æ‰©å±•è¡¨ç¤ºæ„¿æ„æ¥å— early dataã€‚å¦‚æœæ²¡æœ‰è¿™ä¸ªæ‰©å±•ï¼Œ0-RTT æ— æ³•å¼€å¯ã€‚ åœ¨ PSK ä¼šè¯æ¢å¤çš„è¿‡ç¨‹ä¸­ï¼ŒClientHello çš„æ‰©å±•ä¸­é…ç½®äº† early data æ‰©å±•ï¼Œè¡¨ç¤º Client æƒ³è¦å¼€å¯ 0-RTT æ¨¡å¼ã€‚ Server åœ¨ Encrypted Extensions æ¶ˆæ¯ä¸­æºå¸¦äº† early data æ‰©å±•è¡¨ç¤ºåŒæ„è¯»å– early dataã€‚0-RTT æ¨¡å¼å¼€å¯æˆåŠŸã€‚ åªæœ‰åŒæ—¶æ»¡è¶³äº†ä¸Šé¢ 3 ä¸ªæ¡ä»¶ï¼Œæ‰èƒ½å¼€å¯ 0-RTT ä¼šè¯æ¢å¤æ¨¡å¼ã€‚å¦åˆ™æ¡æ‰‹ä¼šæ˜¯ 1-RTT çš„ä¼šè¯æ¢å¤æ¨¡å¼ã€‚ æ³¨æ„ï¼šç›®å‰ä¸å°‘æµè§ˆå™¨è™½ç„¶æ”¯æŒ TLS 1.3 åè®®ï¼Œä½†æ˜¯è¿˜ä¸æ”¯æŒå‘é€ early dataï¼Œæ‰€ä»¥å®ƒä»¬ä¹Ÿæ²¡æ³•å¯ç”¨ 0-RTT æ¨¡å¼çš„ä¼šè¯æ¢å¤ã€‚ è€ŒServer æƒ³æ‹’ç» Client çš„ 0-RTT ä¼šè¯æ¢å¤ï¼Œåªè¦æ‰“ç ´ 3 ä¸ªå¼€å¯æ¡ä»¶å³å¯ï¼Œå¯ä»¥ï¼š æ‹’ç» PSKã€‚Server åœ¨ ServerHello ä¸­ä¸åŠ å…¥ pre_shared_key æ‰©å±•ï¼Œé‚£ä¹ˆæ¡æ‰‹å°±ä¼šå›é€€åˆ°å®Œæ•´æ¡æ‰‹ï¼Œè‡ªç„¶æ‹’ç»äº† 0-RTTã€‚ åªæ‹’ç» early_dataï¼Œæ¥å— PSKã€‚åœ¨ ServerHello ä¸­ï¼ŒåŠ å…¥ pre_shared_key æ‰©å±•ï¼Œä½†æ˜¯EncryptedExtension å­æ¶ˆæ¯ä¸­ä¸åŠ å…¥ early_data æ‰©å±•ã€‚ 0-RTT å­˜åœ¨å®‰å…¨æ€§é£é™©ä½†æ˜¯ 0-RTT å­˜åœ¨å®‰å…¨æ€§é£é™©ã€‚0-RTT æ•°æ®å®‰å…¨æ€§æ¯”å…¶ä»–ç±»å‹çš„ TLS æ•°æ®è¦å¼±ä¸€äº›ï¼Œç‰¹åˆ«æ˜¯ï¼š 0-RTT çš„æ•°æ®æ˜¯æ²¡æœ‰å‰å‘å®‰å…¨æ€§çš„ï¼Œå®ƒä½¿ç”¨çš„æ˜¯è¢«æä¾›çš„ PSK ä¸­å¯¼å‡ºçš„å¯†é’¥è¿›è¡ŒåŠ å¯†çš„ã€‚ åœ¨å¤šä¸ªè¿æ¥ä¹‹é—´ä¸èƒ½ä¿è¯ä¸å­˜åœ¨é‡æ”¾æ”»å‡»ã€‚æ™®é€šçš„ TLS 1.3 1-RTT æ•°æ®ä¸ºäº†é˜²æ­¢é‡æ”¾æ”»å‡»çš„ä¿æŠ¤æ–¹æ³•æ˜¯ä½¿ç”¨ server ä¸‹å‘çš„éšæœºæ•°ï¼Œç°åœ¨ 0-RTT ä¸ä¾èµ–äº ServerHello æ¶ˆæ¯ï¼Œå› æ­¤ä¿æŠ¤æªæ–½æ›´å·®ã€‚å¦‚æœæ•°æ®ä¸ TLS client è®¤è¯æˆ–ä¸åº”ç”¨åè®®é‡Œä¸€èµ·éªŒè¯ï¼Œè¿™ä¸€ç‚¹å®‰å…¨æ€§çš„è€ƒè™‘å°¤å…¶é‡è¦ã€‚è¿™ä¸ªè­¦å‘Šé€‚ç”¨äºä»»ä½•ä½¿ç”¨ early_exporter_master_secret çš„æƒ…å†µã€‚ï¼ˆä¸ä¾èµ–server helloäº†ï¼Œæ‰€ä»¥æ²¡æœ‰éšæœºæ•°ä¿è¯é‡æ”¾æ”»å‡»çš„é˜²å¾¡ï¼‰ TLS 1.3 0-RTT ä¸­è¦é¢„é˜²é‡æ”¾æ”»å‡»ã€‚é¢„é˜² 0-RTT æœ‰ 4 ç§æªæ–½ï¼š ç¬¬ä¸€ä¸ªæªæ–½æ£€æŸ¥ PSK ä¸­çš„è¿‡æœŸæ—¶é—´ï¼Œå¦‚æœè¿‡æœŸäº†ï¼Œå°±ä¸å¤„ç† early_data ä¸­çš„è¯·æ±‚ï¼Œå¹¶ä¸”å°†æ¡æ‰‹é™çº§åˆ° 1-RTTã€‚ ç¬¬äºŒä¸ªæªæ–½æ˜¯ä¸å…è®¸éå¹‚ç­‰æ€§çš„è¯·æ±‚å‡ºç°åœ¨ 0-RTT ä¸­ï¼Œå¦‚æœå‡ºç°äº†éå¹‚ç­‰æ€§çš„è¯·æ±‚ï¼ŒServer å°†ä¼šå¿½ç•¥ä¸å¤„ç†ï¼ŒGET è¯·æ±‚æ˜¯å¹‚ç­‰æ€§çš„ï¼Œä½†æ˜¯ä¹Ÿä¸èƒ½å…è®¸åé¢å¸¦å‚æ•°ï¼Œä¸å¸¦å‚æ•°çš„ GET è¯·æ±‚æ‰èƒ½å…è®¸ã€‚ ç¬¬ä¸‰ä¸ªæªæ–½æ˜¯ï¼Œåœ¨è¯·æ±‚å¤´ä¸­è®°å½• PSK binder çš„å€¼æˆ–è€…ä¸€ä¸ªéšæœºå€¼ï¼Œè¿™ä¸ªå€¼èƒ½ä¿è¯ 0-RTT çš„ early_data å…¨å±€å”¯ä¸€ï¼Œè¿™æ ·å°±å¯ä»¥é˜²æ­¢é‡æ”¾æ”»å‡»ã€‚å½“æ”¶åˆ° ClientHello æ—¶ï¼ŒServer é¦–å…ˆéªŒè¯ PSK binderã€‚ç„¶åå®ƒä¼šè®¡ç®— expected_arrival_timeï¼Œå¦‚æœå®ƒåœ¨è®°å½•çª—å£ä¹‹å¤–ï¼Œåˆ™æ‹’ç» 0-RTTï¼Œç„¶åå›åˆ° 1-RTT æ¡æ‰‹ã€‚å¦‚æœ expected_arrival_time åœ¨çª—å£ä¸­ï¼Œåˆ™ Server æ£€æŸ¥å®ƒæ˜¯å¦è®°å½•äº†åŒ¹é…çš„ ClientHelloã€‚å¦‚æœæ‰¾åˆ°ä¸€ä¸ªï¼Œå®ƒå°†ä½¿ç”¨ â€œillegal_parameterâ€ alert æ¶ˆæ¯ä¸­æ­¢æ¡æ‰‹æˆ–æ¥å— PSK ä½†æ‹’ç» 0-RTTã€‚å¦‚æœæ‰¾ä¸åˆ°åŒ¹é…çš„ ClientHelloï¼Œåˆ™å®ƒæ¥å— 0-RTTï¼Œç„¶ååªè¦ expected_arrival_time åœ¨çª—å£å†…ï¼Œå°±å­˜å‚¨ ClientHelloã€‚Server ä¹Ÿå¯ä»¥å®ç°å…·æœ‰è¯¯æŠ¥çš„æ•°æ®å­˜å‚¨ï¼Œä¾‹å¦‚å¸ƒéš†è¿‡æ»¤å™¨ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå®ƒä»¬å¿…é¡»é€šè¿‡æ‹’ç» 0-RTT æ¥å“åº”æ˜æ˜¾çš„é‡æ”¾ï¼Œä½†ç»ä¸èƒ½ä¸­æ­¢æ¡æ‰‹ã€‚å…³äºè¿™ä¸€ä¸ªæªæ–½ï¼Œè¿˜å¯èƒ½å­˜åœ¨å¤šä¸ª binder çš„æƒ…å†µï¼Œå¦‚æœæ˜¯åˆ†å¸ƒå¼ç³»ç»Ÿï¼Œè¿˜ä¼šå­˜åœ¨å¤šä¸ª zone çš„é—®é¢˜ï¼Œå…·ä½“åˆ†æè§ç¬”è€…è¿™ç¯‡æ–‡ç«  ã€ŠTLS 1.3 0-RTT and Anti-Replayã€‹ã€‚ ç¬¬å››ä¸ªæªæ–½æ˜¯ï¼Œåœ¨æ•°æ®åº“é‡Œé¢è®°å½•æ‰€æœ‰æœªå®Œæˆæœ‰æ•ˆçš„ ticketï¼Œä½¿ç”¨ä¸€æ¬¡å°±åˆ é™¤æ‰ï¼Œå¦‚æœäº§ç”Ÿé‡æ”¾æ”»å‡»ï¼Œé‚£ä¹ˆè¿™ä¸ª ticket å¿…ç„¶æ˜¯æ•°æ®åº“é‡Œé¢æŸ¥ä¸åˆ°çš„ï¼Œé‚£ä¹ˆå°±å›é€€åˆ°å®Œæ•´æ¡æ‰‹ã€‚ å‚è€ƒï¼š HTTPS æ¸©æ•…çŸ¥æ–°ï¼ˆä¸‰ï¼‰ â€”â€” ç›´è§‚æ„Ÿå— TLS æ¡æ‰‹æµç¨‹(ä¸Š) å½“æˆ‘ä»¬è°ˆè®ºHTTPSæ—¶ï¼Œæˆ‘ä»¬åœ¨è°ˆä»€ä¹ˆ(å…«) Session Ticket, Session ID å’Œ PSK HTTPS æ¸©æ•…çŸ¥æ–°ï¼ˆå››ï¼‰ â€”â€” ç›´è§‚æ„Ÿå— TLS æ¡æ‰‹æµç¨‹(ä¸‹)","categories":[{"name":"ç½‘ç»œ","slug":"ç½‘ç»œ","permalink":"https://taylor12138.github.io/categories/%E7%BD%91%E7%BB%9C/"}],"tags":[],"author":"Hello"},{"title":"æœåŠ¡å™¨ä¸éƒ¨ç½²","slug":"æœåŠ¡å™¨ä¸éƒ¨ç½²","date":"2021-03-07T16:00:00.000Z","updated":"2022-07-06T16:31:49.991Z","comments":true,"path":"2021/03/08/fu-wu-qi-yu-bu-shu/","link":"","permalink":"https://taylor12138.github.io/2021/03/08/fu-wu-qi-yu-bu-shu/","excerpt":"","text":"1.éƒ¨ç½²æ–¹å¼åˆ©ç”¨è„šæ‰‹æ¶æ‰“åŒ…åå¾—åˆ°distæ–‡ä»¶ å°†è‡ªå·±ç”µè„‘ä½œä¸ºæœåŠ¡å™¨ï¼Œéƒ¨ç½²æœ¬åœ° ï¼šwindow -&gt; ä½¿ç”¨nginxæˆ–è€…tomcat è¿œç¨‹ä¸»æœºï¼Œè¿›è¡Œéƒ¨ç½²ï¼šlinux centos -&gt; nginx å¦‚ æ³¨æ„ ï¼šä½¿ç”¨nginxæ—¶ï¼Œå…³é—­ä¸ç”¨ç²—æš´ä¹±ç»“æŸè¿›ç¨‹å…³é—­ï¼Œå¯èƒ½ä¼šäº§ç”Ÿä¸€äº›å…³ä¸æ‰ç­‰å°bugï¼Œè®°å¾—cmdè¿›å»nginxæ ¹ç›®å½•ä¸‹ nginx -s stopå³å¯ åœ¨éƒ¨ç½²Vueã€Node.jså’ŒMongoDBéƒ¨ç½²ä¸Šç»™äºˆä¸€å®šå¸®åŠ©çš„ç½‘å€ï¼šhttps://segmentfault.com/a/1190000022921908 ä½¿ç”¨react cliåœ¨å®å¡”éƒ¨ç½²å‰ç«¯é¡¹ç›®çš„æ—¶å€™ï¼Œéœ€è¦åœ¨package.jsonä¸­ï¼Œè®¾ç½®homepageï¼Œä¸ç„¶æ‰¾ä¸åˆ°èµ„æºï¼šhttps://blog.csdn.net/Sophie_U/article/details/80006723 é‡Œé¢å…³äºåç«¯éƒ¨ç½²éƒ¨åˆ†ï¼Œå¯ä»¥å°†ä¾èµ–æ¨¡å—çš„ç»å¯¹è·¯å¾„æ¢æˆç›´æ¥åœ¨åç«¯é¡¹ç›®ä¸‹ï¼Œä½¿ç”¨ç»ˆç«¯ npm i å¦‚æœæ˜¯ä½¿ç”¨è…¾è®¯äº‘è½»é‡çº§æœåŠ¡å™¨+å®å¡”å¯ä»¥çœ‹è¿™ä¸ªhttps://cloud.tencent.com/document/product/1207/54078 éƒ¨ç½²æ—¶è¸©çš„å‘ï¼š é¢å¯¹404æ—¶ï¼Œæ˜¯æ‰¾ä¸åˆ°èµ„æºï¼Œåœ¨æœ¬åœ°ä¸Šå¯ä»¥è¿è¡Œï¼Œè€Œéƒ¨ç½²åˆ°æœåŠ¡å™¨ä¸Šå´å‡ºç°äº†404ï¼Œå¾ˆæœ‰å¯èƒ½æ˜¯apié“¾æ¥ç­‰æ²¡æœ‰å†™å¯¹ï¼Œå¯¼è‡´æ‰¾ä¸åˆ°çœŸæ­£çš„åœ°å€ï¼›éƒ¨ç½²åå°é¡¹ç›®çš„æ—¶å€™ï¼Œæˆ‘å°†å¼‚æ­¥è¯·æ±‚çš„ axios baseURL æ”¹æˆï¼šè‡ªå·±çš„å…¬ç½‘åœ°å€:ç«¯å£å·ï¼Œå®é™…ä¸Šæ˜¯åªéœ€æ”¹æˆï¼šè‡ªå·±çš„å…¬ç½‘åœ°å€å°±å¯ä»¥äº†ï¼Œå®³æˆ‘çœ‹äº†åŠå¤© é¢å¯¹ç½‘é¡µç›´æ¥404æ—¶ï¼Œè¯·æŸ¥çœ‹nginxçš„é…ç½®æœ‰æ²¡æœ‰é…å¯¹ é¢å¯¹502æ—¶ï¼Œå¯èƒ½æ˜¯æœåŠ¡å™¨æš‚æœªå¼€å¯ é¢å¯¹500æ—¶ï¼Œæ˜¯æœåŠ¡å™¨å‘ç”Ÿå†…éƒ¨é”™è¯¯ï¼Œæˆ‘çœ‹äº†åŠå¤©çš„æœåŠ¡ç«¯ä»£ç ï¼Œå‘ç°æ²¡é”™ï¼Œå®é™…ä¸Šæ˜¯è¯·æ±‚çš„æ•°æ®æœ‰ä¸€æ®µæ—¶numberç±»å‹ï¼Œæˆ‘æµ‹è¯•çš„æ—¶å€™èƒ¡ä¹±è¾“å…¥å­—ç¬¦ä¸²ï¼Œä¹Ÿä¼šå‘ç”Ÿ500é”™è¯¯ å½“æˆ‘ä»¬è·å–çš„img çš„srcèµ„æºå‘ç”Ÿ 403çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨htmlå¤´éƒ¨æ·»åŠ  &lt;meta name=\"referrer\" content=\"no-referrer\" /> https://segmentfault.com/a/1190000017896469 å½“æœåŠ¡å™¨ä¸€ç›´å¼€ä¸äº†æ—¶ï¼Œå¯ä»¥æŸ¥çœ‹åœ¨linuxå‘½ä»¤é‡ŒæŸ¥çœ‹pm2æ—¥å¿—æŸ¥æ‰¾é—®é¢˜ pm2 logs ç»„ä»¶åŒ–æœ‰ä¸ªç¼ºç‚¹ï¼Œå°±æ˜¯ï¼Œå¯èƒ½ä¸èƒ½åŠæ—¶å‘ç°å˜é‡åï¼Œè¯­æ³•é”™è¯¯å¯¼è‡´çš„ç»“æœå‡ºä¸æ¥ï¼Œå·²ç»å¡ä½ä¸¤æ¬¡äº†ï¼Œè®°ä½è¯­æ³•ã€å˜é‡ååŸºæœ¬é”™è¯¯ä¸èƒ½çŠ¯ å…³äºå®šæ—¶ä»»åŠ¡ï¼ˆå®å¡”çš„è®¡åˆ’ä»»åŠ¡ï¼Œå‡ºç° line 4: node: command not found çš„é”™è¯¯ï¼‰ï¼Œè§£å†³æ–¹æ³•ï¼šè®²å®šæ—¶ä»»åŠ¡é‡Œé¢çš„shellè„šæœ¬é‡Œæ·»åŠ ä»¥ä¸‹æ“ä½œï¼š https://www.bt.cn/bbs/thread-10252-1-1.html https://github.com/Tammeny/blog/blob/master/source/_posts/%E5%AE%9D%E5%A1%94%E9%9D%A2%E6%9D%BF%E6%B7%BB%E5%8A%A0%E8%AE%A1%E5%88%92%E4%BB%BB%E5%8A%A1%E5%AE%9A%E6%97%B6%E8%87%AA%E5%8A%A8%E6%89%A7%E8%A1%8CNodeJS.md è¿˜æœ‰ä¸€äº›PM2ä»»åŠ¡ç®¡ç†å™¨çš„ä¸€äº›æ“ä½œç¬¦çŒ®ä¸Šï¼š pm2 start app.js # å¯åŠ¨app.jsåº”ç”¨ç¨‹åº pm2 list # åˆ—è¡¨ PM2 å¯åŠ¨çš„æ‰€æœ‰çš„åº”ç”¨ç¨‹åº pm2 restart all # é‡å¯æ‰€æœ‰åº”ç”¨ 2.github actionsGitHub actionäº§ç”Ÿçš„åˆè¡·æ˜¯ç”¨äºCIçš„ï¼Œä¹Ÿå°±æ˜¯æŒç»­é›†æˆã€‚ä½†æˆ‘å‘ç°å®é™…ä¸Šå¾ˆå¤šGitHubä¸Šçš„é¡¹ç›®ï¼Œä½¿ç”¨åˆ°GitHub actions å®šæ—¶è·‘è‡ªå·±çš„è„šæœ¬ï¼Œæ¯”å¦‚ç­¾åˆ°ç±»ã€æ¯å¤©è‡ªåŠ¨åšä»»åŠ¡ç±»çš„è„šæœ¬ï¼ˆå½“ç„¶æˆ‘è¿˜çœ‹åˆ°å¾ˆå¤šcsdnçš„è€å“¥ä½¿ç”¨å®ƒæ¥å“”å“©å“”å“©ç­¾åˆ°æŠ•å¸ç­‰ 0.0 ï¼‰ githubè€å“¥çš„å…¥é—¨æŒ‡å—https://github.com/shfshanyue/you-dont-need-vps/blob/master/github-action-guide.md ä¸æ­¤åŒæ—¶ï¼Œè¿˜å¯ä»¥ä½¿ç”¨linuxå‘½ä»¤ crontabå‘½ä»¤å®šæ—¶æ‰§è¡Œè„šæœ¬ï¼Œå®ç°ä»¥ä¸ŠåŠŸèƒ½ 3.æœåŠ¡å™¨è½¯ä»¶ WebæœåŠ¡å™¨ï¼šæä¾›WebåŒ–æœåŠ¡ï¼Œå½“ä¸‹å‡ ä¹æ‰€æœ‰æœåŠ¡å™¨è½¯ä»¶éƒ½å¯ä»¥æˆä¸ºWebæœåŠ¡å™¨ HttpæœåŠ¡å™¨ï¼šä¾§é‡é™æ€èµ„æºä¼ è¾“çš„æ”¯æŒ åº”ç”¨æœåŠ¡å™¨ï¼šå¸¸è¢«ç§°ä½œåŠ¨æ€æœåŠ¡å™¨ 1.Nginxï¼šhttpæœåŠ¡å™¨ï¼Œæ€§èƒ½å¥½ã€ç¨³å®šå¥½ã€ä¸€èˆ¬æ”¾åœ¨æœ€å‰é¢ 2.Tengineï¼šåŸºäºNginxï¼ŒåŠ å¼ºå’Œå°è£… 3.Apacheï¼šé™æ€æœåŠ¡å™¨ï¼Œæ€§èƒ½ä¸å¦‚Nginxï¼Œæ‰€ä»¥Nginxä½¿ç”¨å±…å¤š 4.IISï¼šå¾®è½¯é˜µè¥çš„WebæœåŠ¡å™¨ï¼Œåªèƒ½è¿è¡Œåœ¨windowsï¼Œhttpé™æ€æœåŠ¡å™¨ 5.Tomcatï¼šå…¸å‹javaåº”ç”¨æœåŠ¡å™¨è½¯ä»¶ï¼ŒåŠ¨æ€æœåŠ¡å™¨ï¼Œ ä¸€èˆ¬å’ŒNginxè¿™ç§é™æ€æœåŠ¡å™¨ä¸€èµ·æ‰“é…åˆ NginxNginx æ˜¯é«˜æ€§èƒ½çš„ HTTP å’Œåå‘ä»£ç†çš„webæœåŠ¡å™¨ï¼Œå¤„ç†é«˜å¹¶å‘èƒ½åŠ›æ˜¯ååˆ†å¼ºå¤§çš„ï¼Œèƒ½ç»å—é«˜è´Ÿ è½½çš„è€ƒéªŒ,æœ‰æŠ¥å‘Šè¡¨æ˜èƒ½æ”¯æŒé«˜è¾¾ 50,000 ä¸ªå¹¶å‘è¿æ¥æ•°ã€‚ æ­£å‘ä»£ç† æ­£å‘ä»£ç†ï¼šå¦‚æœæŠŠå±€åŸŸç½‘å¤–çš„ Internet æƒ³è±¡æˆä¸€ä¸ªå·¨å¤§çš„èµ„æºåº“ï¼Œåˆ™å±€åŸŸç½‘ä¸­çš„å®¢æˆ·ç«¯è¦è®¿ é—® Internetï¼Œåˆ™éœ€è¦é€šè¿‡ä»£ç†æœåŠ¡å™¨æ¥è®¿é—®ï¼Œè¿™ç§ä»£ç†æœåŠ¡å°±ç§°ä¸ºæ­£å‘ä»£ç†ã€‚ï¼ˆéšè—å®¢æˆ·ç«¯ï¼‰ ï¼ˆä¸€ä¸ªå¾ˆç®€å•çš„ä¾‹å­ï¼šVPNï¼‰ ç®€å•ä¸€ç‚¹ï¼šé€šè¿‡ä»£ç†æœåŠ¡å™¨æ¥è®¿é—®æœåŠ¡å™¨çš„è¿‡ç¨‹ å°±å« æ­£å‘ä»£ç†ã€‚ éœ€è¦åœ¨å®¢æˆ·ç«¯é…ç½®ä»£ç†æœåŠ¡å™¨è¿›è¡ŒæŒ‡å®šç½‘ç«™è®¿é—® æ­£å‘ä»£ç†çš„ç”¨é€”ï¼š ï¼ˆ1ï¼‰è®¿é—®åŸæ¥æ— æ³•è®¿é—®çš„èµ„æºï¼Œå¦‚Google ï¼ˆ2ï¼‰ å¯ä»¥åšç¼“å­˜ï¼ŒåŠ é€Ÿè®¿é—®èµ„æº ï¼ˆ3ï¼‰å¯¹å®¢æˆ·ç«¯è®¿é—®æˆæƒï¼Œä¸Šç½‘è¿›è¡Œè®¤è¯ ï¼ˆ4ï¼‰ä»£ç†å¯ä»¥è®°å½•ç”¨æˆ·è®¿é—®è®°å½•ï¼ˆä¸Šç½‘è¡Œä¸ºç®¡ç†ï¼‰ï¼Œå¯¹å¤–éšè—ç”¨æˆ·ä¿¡æ¯ åå‘ä»£ç†åå‘ä»£ç†ï¼Œå…¶å®å®¢æˆ·ç«¯å¯¹ä»£ç†æ˜¯æ— æ„ŸçŸ¥çš„ï¼Œå› ä¸ºå®¢æˆ·ç«¯ä¸éœ€è¦ä»»ä½•é…ç½®å°±å¯ä»¥è®¿é—®ã€‚ æˆ‘ä»¬åª éœ€è¦å°†è¯·æ±‚å‘é€åˆ°åå‘ä»£ç†æœåŠ¡å™¨ï¼Œç”±åå‘ä»£ç†æœåŠ¡å™¨å»é€‰æ‹©ç›®æ ‡æœåŠ¡å™¨è·å–æ•°æ®åï¼Œåœ¨è¿” å›ç»™å®¢æˆ·ç«¯ï¼Œæ­¤æ—¶åå‘ä»£ç†æœåŠ¡å™¨å’Œç›®æ ‡æœåŠ¡å™¨å¯¹å¤–å°±æ˜¯ä¸€ä¸ªæœåŠ¡å™¨ï¼Œæš´éœ²çš„æ˜¯ä»£ç†æœåŠ¡å™¨ åœ°å€ï¼Œéšè—äº†çœŸå®æœåŠ¡å™¨ IP åœ°å€ã€‚ï¼ˆéšè—æœåŠ¡ç«¯ï¼‰ ï¼ˆä¸€ä¸ªä¸ªç®€å•çš„ä¾‹å­ï¼šå°†ç”¨æˆ·çš„è®¿é—®è½¬å‘åˆ°æœåŠ¡å™¨å†…ç½‘ï¼‰ åå‘ä»£ç†çš„ä½œç”¨ï¼š ï¼ˆ1ï¼‰ä¿è¯å†…ç½‘çš„å®‰å…¨ï¼Œé˜»æ­¢webæ”»å‡»ï¼Œå¤§å‹ç½‘ç«™ï¼Œé€šå¸¸å°†åå‘ä»£ç†ä½œä¸ºå…¬ç½‘è®¿é—®åœ°å€ï¼ŒWebæœåŠ¡å™¨æ˜¯å†…ç½‘ ï¼ˆ2ï¼‰è´Ÿè½½å‡è¡¡ï¼Œé€šè¿‡åå‘ä»£ç†æœåŠ¡å™¨æ¥ä¼˜åŒ–ç½‘ç«™çš„è´Ÿè½½ å®é™…ä¸Šç”¨ä¸€ç§é€šä¿—æ¯”å–»æ¥å½¢å®¹æ­£åå‘ä»£ç†ï¼Œå¯ä»¥è§£è¯´ä¸ºæ­£å‘ä»£ç†ä¸ºæˆ‘å›½çš„æµ·å…³å…³å£ï¼Œåå‘ä»£ç†æ˜¯ç›®æ ‡å›½å®¶ï¼ˆå¤–å›½ï¼‰çš„æµ·å…³å…³å£ è´Ÿè½½å‡è¡¡å°†åŸå…ˆè¯·æ±‚é›†ä¸­åˆ°å•ä¸ªæœåŠ¡å™¨ä¸Šçš„ æƒ…å†µæ”¹ä¸ºï¼Œä¸­é—´ç»è¿‡ä¸€ä¸ªè´Ÿè½½å‡è¡¡å™¨ï¼Œç„¶åå°†è¯·æ±‚åˆ†å‘åˆ°å¤šä¸ªæœåŠ¡å™¨ä¸Šï¼Œå°†è´Ÿè½½åˆ†å‘åˆ°ä¸åŒçš„æœåŠ¡å™¨ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬æ‰€è¯´çš„è´Ÿè½½å‡è¡¡ å®¢æˆ·ç«¯å‘é€å¤šä¸ªè¯·æ±‚åˆ°æœåŠ¡å™¨ï¼ŒæœåŠ¡å™¨å¤„ç†è¯·æ±‚ï¼Œæœ‰ä¸€äº›å¯èƒ½è¦ä¸æ•°æ®åº“è¿›è¡Œäº¤äº’ï¼ŒæœåŠ¡å™¨å¤„ç†å®Œæ¯•åï¼Œå†å°†ç»“æœè¿”å›ç»™å®¢æˆ·ç«¯ 4.è‡ªå»ºæœåŠ¡å™¨å€ŸåŠ©serveåº“ï¼Œèƒ½è®©æŸä¸€æŒ‡å®šæ–‡ä»¶å¤¹ï¼ˆä½œä¸ºæ ¹ç›®å½•ï¼‰å¿«é€Ÿå¼€å¯ä¸€å°æœåŠ¡å™¨ npm i serve -g ç„¶ååœ¨è‡ªå»ºçš„æ–‡ä»¶å¤¹ä¸‹å¼€å¯æœåŠ¡å™¨ï¼š serve æˆ–è€…è¯¥ç›®å½•ä¸‹ï¼ˆâ€œæ–‡ä»¶åâ€çš„æ–‡ä»¶ä½œä¸ºæ ¹ç›®å½•ï¼‰ serve æ–‡ä»¶å 5.å¤§å‰ç«¯å¤§å‰ç«¯å®é™…ä¸Šå°±æ˜¯æ‰€æœ‰å‰ç«¯çš„ç»Ÿç§°ï¼Œå¤§å‰ç«¯æœ€å¤§çš„ç‰¹ç‚¹åœ¨äºä¸€æ¬¡å¼€å‘ï¼Œé€‚é…æ‰€æœ‰å¹³å°ï¼Œå®ç°ä»£ç å¤ç”¨ï¼Œæ˜¯ä¸€ä¸ªwebèµ°å‘ç»Ÿä¸€çš„æ—¶ä»£ã€‚ æ˜¯å‰ç«¯æ–¹å‘è¿›é˜¶ï¼Œè·µè¡Œå·¥ç¨‹åŒ–ã€è¿ˆè¿›å…¨çƒåŒ–ã€æ·±å…¥ç»„ä»¶åŒ–çš„è¿‡ç¨‹ åœ¨nodeå‡ºç°åï¼Œå‰ç«¯å·¥ç¨‹å¸ˆå¯ä»¥æš‚æ—¶ä¸ä¾èµ–åç«¯ç¨‹åºè€Œè¿è¡Œè‡ªå·±çš„æ•´ä½“é¡¹ç›®ï¼Œä»è€Œå®ç°å…ˆåç«¯åˆ†ç¦» å¤§å‰ç«¯åŠ¿å¿…ç§°ä¸ºç§»åŠ¨å¼€å‘ &amp; Webå‰ç«¯çš„å‘å±•è¶‹åŠ¿ï¼Œåœ¨å­¦ä¹ åŸç”Ÿçš„åŒæ—¶ï¼Œå‰ç«¯äººå‘˜ä¹Ÿè¦å­¦ä¹ Android æˆ– IOS çš„åŸç”Ÿå¼€å‘æŠ€æœ¯ï¼Œæ‰èƒ½æ›´å¥½åœ°èå…¥å¤§å‰ç«¯çš„åœˆå­ è·¨å¹³å°è·¨å¤šå¹³å°çš„æ–¹æ¡ˆæœ‰ï¼š H5+åŸç”Ÿï¼ˆCordovaã€Ionicã€å¾®ä¿¡å°ç¨‹åºï¼‰ï¼Œè¿™ç§æ¨¡å¼åˆç§°ä¸ºHybridå¼€å‘ ç¤¾åŒºåŠèµ„æºä¸°å¯Œï¼Œç¼ºç‚¹æ˜¯æ€§èƒ½ä¸å¥½ JavaScriptå¼€å‘+åŸç”Ÿæ¸²æŸ“ ï¼ˆReact Nativeï¼ˆFaceBookï¼‰ã€Weexï¼ˆé˜¿é‡Œï¼‰ã€Picassoï¼ˆç¾å›¢ï¼‰ã€å¿«åº”ç”¨ï¼‰ æ€§èƒ½ç›¸æ¯”H5æé«˜å¾ˆå¤šï¼›åŠ¨æ€åŒ–è¾ƒå¥½ï¼Œæ”¯æŒçƒ­æ›´æ–° æ¸²æŸ“æ—¶éœ€è¦JavaScriptå’ŒåŸç”Ÿä¹‹é—´é€šä¿¡ï¼Œåœ¨æœ‰äº›åœºæ™¯å¦‚æ‹–åŠ¨å¯èƒ½ä¼šå› ä¸ºé€šä¿¡é¢‘ç¹å¯¼è‡´å¡é¡¿ è‡ªç»˜UI+åŸç”Ÿ(Flutterï¼‰ Flutterä½¿ç”¨è‡ªå·±çš„é«˜æ€§èƒ½æ¸²æŸ“å¼•æ“æ¥ç»˜åˆ¶widgetã€‚è¿™æ ·ä¸ä»…å¯ä»¥ä¿è¯åœ¨Androidå’ŒiOSä¸ŠUIçš„ä¸€è‡´æ€§ï¼Œé¿å…å¯¹åŸç”Ÿæ§ä»¶ä¾èµ–è€Œå¸¦æ¥çš„é™åˆ¶åŠé«˜æ˜‚çš„ç»´æŠ¤æˆæœ¬ ä¸æ”¯æŒåŠ¨æ€ä¸‹å‘ä»£ç å’Œçƒ­æ›´æ–° å¢å¼ºç‰ˆWeb App(PWA) ç­‰ ç°åœ¨å¾ˆå¤šå¤§å…¬å¸éƒ½åŠ å…¥äº†å¤šç«¯å¤§æˆ˜ï¼Œè‡ªå·±å…¬å¸åˆ†åˆ«ç ”å‘å¤šç«¯è·¨å¹³å°ç»Ÿä¸€æ¡†æ¶ è·¨ç«¯ä¼˜åŠ¿ ä»å¼€å‘è€…è§’åº¦çœ‹ï¼š é™ä½å¼€å‘æˆæœ¬ï¼ˆç ”å‘æ•ˆç‡ã€ä»£ç é‡ç”¨ã€å¤šå¹³å°æ”¯æŒï¼‰ å¿«é€Ÿå¼€å‘åŸå‹ UI ä¸€è‡´æ€§ ä»ä¼ä¸šè§’åº¦çœ‹ï¼š æ”¯æŒå¤šå¹³å° è§¦åŠæ›´å¹¿çš„å¸‚åœº é™ä½å‰æœŸæˆæœ¬ é™„ä¸Šå‰ç«¯æœ¬äººçš„ç…§ç‰‡ï¼ˆç¾äººéƒ¨åˆ†ï¼‰ RPCRPCæ˜¯æŒ‡è¿œç¨‹è¿‡ç¨‹è°ƒç”¨ï¼Œæ¯”å¦‚è¯´æœåŠ¡å™¨Aä¸Šçš„é¡¹ç›®è°ƒç”¨æœåŠ¡å™¨Bä¸Šæä¾›çš„å‡½æ•°å’Œæ–¹æ³• rpcéœ€è¦é¢ä¸´çš„é—®é¢˜ 1.ç”±äºç½‘ç»œåè®®æ˜¯åŸºäºäºŒè¿›åˆ¶çš„ï¼Œæ‰€ä»¥éœ€è¦åºåˆ—åŒ–å’Œååºåˆ—åŒ– 2.è§£å†³é€šä¿¡ã€å¯»å€ç­‰ç½‘ç»œé—®é¢˜ 6.CDNæœåŠ¡å™¨ä¸ºäº†ç¼©çŸ­httpè¯·æ±‚çš„æ—¶é—´ï¼Œæˆ‘ä»¬åº”è¯¥æŠŠå¤§é‡çš„é™æ€èµ„æºæ”¾ç½®çš„ç¦»ç”¨æˆ·è¿‘ä¸€ç‚¹ã€‚ å†…å®¹å‘å¸ƒç½‘ç»œCDNï¼ˆContent Delivery Networksï¼‰å°±æ˜¯å…¶ä¸­ä¸€ç§æ–¹å¼ã€‚CDNæ˜¯ä¸€ç»„åˆ†å¸ƒåœ¨å¤šä¸ªä¸åŒåœ°ç†ä½ç½®æˆ–ç½‘æ®µçš„webæœåŠ¡å™¨ï¼Œç”¨äºæ›´åŠ æœ‰æ•ˆçš„å‘ç”¨æˆ·å‘å¸ƒå†…å®¹ã€‚ CDNçš„åŸºæœ¬åŸç†æ˜¯å¹¿æ³›é‡‡ç”¨å„ç§ç¼“å­˜æœåŠ¡å™¨ï¼Œå°†è¿™äº›ç¼“å­˜æœåŠ¡å™¨åˆ†å¸ƒåˆ°ç”¨æˆ·è®¿é—®ç›¸å¯¹é›†ä¸­çš„åœ°åŒºæˆ–ç½‘ç»œä¸­ï¼Œåœ¨ç”¨æˆ·è®¿é—®ç½‘ç«™æ—¶ï¼Œåˆ©ç”¨å…¨å±€è´Ÿè½½æŠ€æœ¯å°†ç”¨æˆ·çš„è®¿é—®æŒ‡å‘è·ç¦»æœ€è¿‘çš„å·¥ä½œæ­£å¸¸çš„ç¼“å­˜æœåŠ¡å™¨ä¸Šï¼Œç”±ç¼“å­˜æœåŠ¡å™¨ç›´æ¥å“åº”ç”¨æˆ·è¯·æ±‚ã€‚ å¤§ç™½è¯ï¼š å°±æ˜¯CDNæ˜¯ä¸€å †æœåŠ¡å™¨ï¼Œå…¶ä¸­ä¸€éƒ¨åˆ†æœåŠ¡å™¨åˆ†å¸ƒåœ¨å„ä¸ªåœ°ç‚¹ï¼Œè¢«ç§°ä¸ºè¾¹ç¼˜èŠ‚ç‚¹ï¼Œ æºæœåŠ¡å™¨æŠŠé™æ€å†…å®¹æå‰å¤‡ä»½ç»™è¾¹ç¼˜èŠ‚ç‚¹æœåŠ¡å™¨ï¼ˆpushï¼‰ï¼ˆä¸»è¦æ˜¯é™æ€èµ„æºï¼‰ å¦‚æœç”¨æˆ·è®¿é—®çš„æ—¶å€™è¾¹ç¼˜èŠ‚ç‚¹æœåŠ¡å™¨æ²¡æœ‰å¯¹åº”èµ„æºï¼Œå°±ä¼šé€’å½’æŸ¥è¯¢å»æŸ¥è¾¹ç¼˜èŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹æœåŠ¡å™¨ï¼Œä¸€ç›´æ²¡æœ‰å°±ä¸€ç›´æŸ¥è¯¢åˆ°æºç«™ï¼Œç„¶åçˆ¶èŠ‚ç‚¹ä»æºç«™ä¸‹è½½è¯¥èµ„æºï¼ˆpullï¼‰ï¼Œçˆ¶èŠ‚ç‚¹åˆ†å‘ç»™åˆšæ‰ç”¨æˆ·è®¿é—®çš„è¾¹ç¼˜èŠ‚ç‚¹ï¼Œä¸‹ä¸€æ¬¡å¦å¤–ä¸€ä¸ªç”¨æˆ·è®¿é—®çš„æ—¶å€™ï¼Œç›´æ¥è®¿é—®è¯¥è¾¹ç¼˜èŠ‚ç‚¹å°±å¯ä»¥ç›´æ¥è®¿é—®åˆ°äº† åŸºæœ¬æœºåˆ¶ å°½å¯èƒ½é¿å¼€äº’è”ç½‘ä¸Šæœ‰å¯èƒ½å½±å“æ•°æ®ä¼ è¾“é€Ÿåº¦å’Œç¨³å®šæ€§çš„ç“¶é¢ˆå’Œç¯èŠ‚ï¼Œä½¿å†…å®¹ä¼ è¾“çš„æ›´å¿«ã€æ›´ç¨³å®šï¼› é€šè¿‡åœ¨ç½‘ç»œå„å¤„æ”¾ç½®èŠ‚ç‚¹æœåŠ¡å™¨ï¼Œåœ¨ç°æœ‰çš„äº’è”ç½‘åŸºç¡€ä¹‹ä¸Šæ„æˆä¸€å±‚æ™ºèƒ½è™šæ‹Ÿç½‘ç»œï¼› CDNç³»ç»Ÿèƒ½å¤Ÿå®æ—¶åœ°æ ¹æ®ç½‘ç»œæµé‡å’Œå„èŠ‚ç‚¹çš„è¿æ¥ã€è´Ÿè½½çŠ¶å†µä»¥åŠåˆ°ç”¨æˆ·çš„è·ç¦»å’Œå“åº”æ—¶é—´ç­‰ç»¼åˆä¿¡æ¯å°†ç”¨æˆ·çš„è¯·æ±‚é‡æ–°å¯¼å‘ç¦»ç”¨æˆ·æœ€è¿‘çš„æœåŠ¡èŠ‚ç‚¹ä¸Šã€‚é€‰æ‹©çš„ç¼“å­˜æœåŠ¡å™¨ï¼š å“ªä¸€å°æœåŠ¡å™¨è·ç”¨æˆ·æœ€è¿‘ å“ªä¸€å°æœ‰æ‰€éœ€å†…å®¹ æŸ¥è¯¢å„ä¸ªæœåŠ¡å™¨å½“å‰çš„è´Ÿè½½æƒ…å†µï¼Œåˆ¤æ–­å“ªä¸€å°æœåŠ¡å™¨å°šæœ‰æœåŠ¡èƒ½åŠ› æœ€ç®€å•çš„CDNç½‘ç»œç”±ä¸€ä¸ªDNSæœåŠ¡å™¨å’Œå‡ å°ç¼“å­˜æœåŠ¡å™¨ç»„æˆ ç”¨æˆ·è¾“å…¥url -&gt; DNSåŸŸåè§£æ -&gt; è§£ææƒäº¤ç»™CNAMEæŒ‡å‘çš„CDNä¸“ç”¨DNSæœåŠ¡å™¨ã€‚ ç”¨æˆ·å‘CDNçš„å…¨å±€è´Ÿè½½å‡è¡¡è®¾å¤‡å‘èµ·å†…å®¹URLè®¿é—®è¯·æ±‚ -&gt; è´Ÿè½½å‡è¡¡å™¨é€‰æ‹©ç¼“å­˜æœåŠ¡å™¨ -&gt; è¿”å›è¯¥ç¼“å­˜æœåŠ¡å™¨ç»™ç”¨æˆ· ç”¨æˆ·å‘ç¼“å­˜æœåŠ¡å™¨å‘èµ·è¯·æ±‚ï¼Œç¼“å­˜æœåŠ¡å™¨å“åº”ç”¨æˆ·è¯·æ±‚ ä¸€åŠ ä¸€å‡ åŠ é€Ÿäº†ç½‘ç»œè¯·æ±‚ï¼Œå‡å°‘äº†ç½‘ç»œå¸¦å®½è´¹ç”¨ï¼ˆç½‘ç«™ä¸»è¦æ ¹æ®ç½‘ç»œå¸¦å®½æ¶ˆè€—å‘ä¸»æœºå•†æ”¯ä»˜è´¹ç”¨ï¼‰ å®‰å…¨ï¼šå¤§é‡CDNèŠ‚ç‚¹çš„å­˜åœ¨ï¼Œå¯ä»¥æœ‰æ•ˆåœ°å°†æ”»å‡»ç”±ä¸­å¿ƒåŒ–åˆ†æ•£åˆ°CDNçš„è¾¹ç¼˜ä¸Šï¼Œä»è€Œæœ‰æ•ˆåœ°é˜»æ­¢æˆ–è€…å‡å°æ”»å‡»é€ æˆçš„å±å®³ åº”ç”¨åœºæ™¯ ç½‘ç«™ç«™ç‚¹/åº”ç”¨åŠ é€Ÿï¼š ç«™ç‚¹æˆ–è€…åº”ç”¨ä¸­å¤§é‡é™æ€èµ„æºçš„åŠ é€Ÿåˆ†å‘ï¼Œå»ºè®®å°†ç«™ç‚¹å†…å®¹è¿›è¡ŒåŠ¨é™åˆ†ç¦»ï¼ŒåŠ¨æ€æ–‡ä»¶å¯ä»¥ç»“åˆäº‘æœåŠ¡å™¨ECSï¼Œé™æ€èµ„æºå¦‚å„ç±»å‹å›¾ç‰‡ã€htmlã€cssã€jsæ–‡ä»¶ç­‰ï¼Œä½¿ç”¨CDNæœåŠ¡å™¨å­˜å‚¨ï¼Œå¯ä»¥æœ‰æ•ˆåŠ é€Ÿå†…å®¹åŠ è½½é€Ÿåº¦ï¼Œè½»æ¾æå®šç½‘ç«™å›¾ç‰‡ã€çŸ­è§†é¢‘ç­‰å†…å®¹åˆ†å‘ã€‚ ç§»åŠ¨åº”ç”¨åŠ é€Ÿï¼š ç§»åŠ¨APPæ›´æ–°æ–‡ä»¶ï¼ˆapkæ–‡ä»¶ï¼‰åˆ†å‘ï¼Œç§»åŠ¨APPå†…å›¾ç‰‡ã€é¡µé¢ã€çŸ­è§†é¢‘ã€UGCç­‰å†…å®¹çš„ä¼˜åŒ–åŠ é€Ÿåˆ†å‘ã€‚æä¾›httpDNSæœåŠ¡ï¼Œé¿å…DNSåŠ«æŒå¹¶è·å¾—å®æ—¶ç²¾ç¡®çš„DNSè§£æç»“æœï¼Œæœ‰æ•ˆç¼©çŸ­ç”¨æˆ·è®¿é—®æ—¶é—´ï¼Œæå‡ç”¨æˆ·ä½“éªŒã€‚ è§†éŸ³é¢‘ç‚¹æ’­/å¤§æ–‡ä»¶ä¸‹è½½åˆ†å‘åŠ é€Ÿï¼› è§†é¢‘ç›´æ’­åŠ é€Ÿï¼› å€¼å¾—æ³¨æ„ CDNæ˜¯åªå¯¹ç½‘ç«™çš„æŸä¸€ä¸ªå…·ä½“çš„åŸŸååŠ é€Ÿï¼Œå¦‚æœåŒä¸€ä¸ªç½‘ç«™æœ‰å¤šä¸ªåŸŸåï¼Œåˆ™è®¿å®¢è®¿é—®åŠ å…¥CDNçš„åŸŸåè·å¾—åŠ é€Ÿæ•ˆæœï¼Œè®¿é—®æœªåŠ å…¥CDNçš„åŸŸåï¼Œæˆ–è€…ç›´æ¥è®¿é—®IPåœ°å€ï¼Œåˆ™æ— æ³•è·å¾—CDNæ•ˆæœã€‚ CDNå¯¹ç½‘ç«™çš„è®¿å®¢å®Œå…¨é€æ˜ï¼Œä¸éœ€è¦è®¿å®¢æ‰‹åŠ¨é€‰æ‹©è¦è®¿é—®çš„é•œåƒç«™ç‚¹ï¼Œä¿è¯äº†ç½‘ç«™å¯¹è®¿å®¢çš„å‹å¥½æ€§ã€‚ CDNéƒ¨ç½²ç®€å•ï¼Œå¯¹åŸç«™åŸºæœ¬ä¸åšä»»ä½•æ”¹åŠ¨å³å¯ç”Ÿæ•ˆã€‚ æ€§èƒ½æé«˜ æ¯”è¾ƒä¸åŒæœåŠ¡ç­‰çº§licenseçš„å·®åˆ«ï¼ˆè´­ä¹°çš„vipç­‰çº§ï¼‰ é¿å…å…¨é‡å‘å¸ƒæ–°å›¾ç‰‡æ ¼å¼ï¼ˆnoæ›´æ¢å›¾ç‰‡æ ¼å¼ï¼‰ å°½é‡å¯¹å›¾ç‰‡åªæ–°å¢ä¸ä¿®æ”¹ï¼Œæœ‰åˆ©äºæé«˜CDNå‘½ä¸­ç‡ CDNçš„æ€§èƒ½é—®é¢˜ä¸€èˆ¬å’Œå¤§é‡å›æºç›¸å…³ï¼Œå¯ä»¥é€šè¿‡ç»†åˆ†ç›‘æ§æ¥ç¡®å®šæ˜¯ç”±å“ªä¸ªåŸŸåå¼•èµ·çš„ï¼Œé€šè¿‡ç›‘æ§çš„è¡°å˜æ—¶é—´ç‚¹ï¼Œç¡®å®šé¡¹ç›®å‘å¸ƒæ˜¯å¦ä¼šå¼•èµ·å¤§é‡çš„å›æºï¼Œä¸€èˆ¬æˆç†Ÿçš„CDNæ˜¯èƒ½å¤Ÿä¿éšœç¨³å®šæ€§çš„ 7.ä¸Šçº¿ä¼˜åŒ– &amp; èµ°æŸ¥å‰ç«¯æ€§èƒ½ä¼˜åŒ–é€ƒä¸å¼€å›åˆ°æˆ‘ä»¬æ“…é•¿çš„å‰ç«¯é¢†åŸŸï¼Œå½“æˆ‘ä»¬è°ˆåˆ°æ€§èƒ½ä¼˜åŒ–æ—¶ï¼Œæ€»æ˜¯é€ƒä¸å¼€å‡ æ¡é‡‘ç§‘ç‰å¾‹ å‡å°åŒ…ä½“ç§¯ï¼ŒåŒ…æ‹¬å¯¹ HTMLã€CSSã€JavaScript ä»£ç çš„å‹ç¼©ç­‰ å‡å° HTTP è¯·æ±‚ï¼Œä½¿ç”¨æœåŠ¡ç«¯ gzip å‹ç¼© ä½¿ç”¨ Webpackã€Rollup ç­‰ç°ä»£æ„å»ºå·¥å…·æ¥æŠ½ç¦»å…¬å…±ä»£ç ï¼ŒCode Splitting ä»£ç æ‹†åˆ†ç­‰ ä¸Šçº¿èµ°æŸ¥æ¸…å• é¡µé¢å’Œèµ„æº( js å’Œ css )ï¼Œæ˜¯å¦gzipï¼› cdnï¼Œå¼€å¯ç¼“å­˜ï¼Œç¼“å­˜æ—¶é—´ä¸€èˆ¬å¤§äºä¸€ä¸ªæœˆï¼› èµ„æºæ–‡ä»¶ç±»å‹ï¼ˆjs ä¸º application/javascriptï¼Œcss ä¸º text/cssï¼‰ï¼› è¿æ¥ï¼ˆhtmlã€jsã€cssã€å›¾ç‰‡ï¼‰æ˜¯å¦å¼€å¯ http2ï¼› é¡µé¢æ˜¾ç¤ºæ­£å¸¸ï¼› æ¥å£è¯·æ±‚æ­£å¸¸ï¼ˆæ²¡æœ‰é‡å¤æˆ–å¤šä½™çš„è¯·æ±‚ï¼‰ï¼› é¦–å±å›¾ç‰‡è¯·æ±‚æ•°é‡ï¼Œæ˜¯å¦ä½¿ç”¨æ‡’åŠ è½½ï¼› å›¾ç‰‡å¤§å°ï¼Œæ˜¯å¦è£å‰ªï¼› å…³æ³¨ wapm æ€§èƒ½æŒ‡æ ‡(å®éªŒå®¤)ï¼Œå¦‚å¤§å›¾ï¼Œå¤§èµ„æºæ–‡ä»¶ï¼› ç¬¬ä¸‰æ–¹ä¾èµ–ï¼› ä½“éªŒæ£€æŸ¥ï¼Œå¦‚æ¥å£è¯·æ±‚æ˜¯å¦æœ‰è¿‡æ¸¡ loadingï¼Œå…œåº•çš„é”™è¯¯å±•ç¤ºï¼Œéšè—çš„æ¨¡å—æ˜¯å¦è¦æå‰è¯·æ±‚æ•°æ®ï¼› å‚è€ƒæ–‡ç« https://zhuanlan.zhihu.com/p/28940451 å‚è€ƒä¹¦ç±ã€Šå¤§å‹ç½‘ç«™æ€§èƒ½ä¼˜åŒ–å®æˆ˜ã€‹â€”å‘¨æ¶›æ˜ã€å¼ è£åã€å¼ æ–°å…µ","categories":[{"name":"å‰ç«¯","slug":"å‰ç«¯","permalink":"https://taylor12138.github.io/categories/%E5%89%8D%E7%AB%AF/"}],"tags":[],"author":"Hello"},{"title":"è·¨ç«¯ç›¸å…³","slug":"è·¨ç«¯ç›¸å…³","date":"2021-03-07T16:00:00.000Z","updated":"2022-08-21T09:17:36.521Z","comments":true,"path":"2021/03/08/kua-duan-xiang-guan/","link":"","permalink":"https://taylor12138.github.io/2021/03/08/kua-duan-xiang-guan/","excerpt":"","text":"1.webviewwebViewæ˜¯ç§»åŠ¨ç«¯(åŸç”Ÿ)æä¾›çš„è¿è¡Œwebçš„ç¯å¢ƒï¼Œå®ƒæ˜¯ä¸€ç§åµŒå…¥å¼æµè§ˆå™¨ï¼ŒåŸç”Ÿåº”ç”¨å¯ä»¥ç”¨å®ƒæ¥å±•ç¤ºç½‘ç»œå†…å®¹ã€‚å¯ä¸é¡µé¢JavaScriptäº¤äº’ï¼Œå®ç°æ··åˆå¼€å‘ã€‚ webviewæ¸²æŸ“çš„ä½œç”¨æ˜¯ï¼šwebviewå¯ä»¥å†…åµŒåœ¨ç§»åŠ¨ç«¯ï¼Œå®ç°å‰ç«¯çš„æ··åˆå¼å¼€å‘ï¼Œå¤§å¤šæ•°æ··åˆå¼å¼€å‘æ¡†æ¶éƒ½æ˜¯åŸºäºwebviewæ¨¡å¼è¿›è¡ŒäºŒæ¬¡å¼€å‘çš„ã€‚webviewå¯ä»¥ç›´æ¥ä½¿ç”¨htmlæ–‡ä»¶ï¼ˆç½‘ç»œä¸Šæˆ–æœ¬åœ°assetsä¸­ï¼‰ä½œå¸ƒå±€ï¼Œå¯å’ŒJavaScriptäº¤äº’è°ƒç”¨ã€‚webviewæ˜¯ä¸€ä¸ªåŸºäºwebkitçš„å¼•æ“ã€‚ æ‰€ä»¥webviewæ˜¯H5è·¨ç«¯å¸¸ç”¨æ–¹å¼ 2.JSBridgeWebç«¯å’ŒNativeå¯ä»¥ç±»æ¯”äºClient/Serveræ¨¡å¼ï¼ŒWebç«¯è°ƒç”¨åŸç”Ÿæ¥å£æ—¶å°±å¦‚åŒClientå‘Serverç«¯å‘é€ä¸€ä¸ªè¯·æ±‚ç±»ä¼¼ï¼ŒJSBåœ¨æ­¤å……å½“ç±»ä¼¼äºHTTPåè®®çš„è§’è‰²ã€‚ H5 ä¸­çš„è·¨ç«¯é€šä¿¡ç§°ä¸º JSBridgeï¼Œåœ¨è¿›è¡Œä¸€æ¬¡ JSBridge è°ƒç”¨çš„æ—¶å€™ä¼šæºå¸¦è°ƒç”¨å‚æ•° ModuleId: æ¨¡å— ID MethodId: æ–¹æ³• ID params: å‚æ•° CallbackId: JS å›è°ƒå ModuleId å’Œ MethodId èƒ½å®šä½åˆ°å…·ä½“è°ƒç”¨çš„åŸç”Ÿæ–¹æ³•ï¼Œparams å‚æ•°ä½œä¸ºåŸç”Ÿæ–¹æ³•è°ƒç”¨çš„å‚æ•°ï¼Œæœ€åé€šè¿‡ CallbackId å›è°ƒ JS çš„å›è°ƒå‡½æ•°ï¼ˆæˆ‘ä»¬å¯ä»¥è‡ªè¡Œè„‘è¡¥reactä¸­çˆ¶å­ç»„ä»¶é€šè¿‡å›è°ƒé€šä¿¡çš„æ–¹å¼ï¼‰ åœ¨ä½¿ç”¨ H5 çš„æƒ…å†µä¸‹ï¼ŒWebview æ˜¯ JS çš„æ‰§è¡Œå¼•æ“ï¼ŒåŒæ—¶ Webview è¿˜æ˜¯é¡µé¢çš„æ¸²æŸ“å¼•æ“ã€‚ å®ç°JSBridgeä¸»è¦æ˜¯ä¸¤ç‚¹ï¼š å°†Nativeç«¯åŸç”Ÿæ¥å£å°è£…æˆJavaScriptæ¥å£ å°†Webç«¯JavaScriptæ¥å£å°è£…æˆåŸç”Ÿæ¥å£ Native to WebNative è°ƒç”¨ JS æ¯”è¾ƒç®€å•ï¼Œåªè¦ H5 å°† JS æ–¹æ³•æš´éœ²åœ¨ Window ä¸Šç»™ Native è°ƒç”¨å³å¯ã€‚ JavaScriptä½œä¸ºè§£é‡Šæ€§è¯­è¨€ï¼Œæœ€å¤§çš„ä¸€ä¸ªç‰¹æ€§å°±æ˜¯å¯ä»¥éšæ—¶éšåœ°åœ°é€šè¿‡è§£é‡Šå™¨æ‰§è¡Œä¸€æ®µJSä»£ç ï¼Œæ‰€ä»¥å¯ä»¥å°†æ‹¼æ¥çš„JavaScriptä»£ç å­—ç¬¦ä¸²ï¼Œä¼ å…¥JSè§£æå™¨æ‰§è¡Œå°±å¯ä»¥ï¼ŒJSè§£æå™¨åœ¨è¿™é‡Œå°±æ˜¯webViewã€‚ Android 4.4ä¹‹å‰åªèƒ½ç”¨loadUrlæ¥å®ç°ï¼Œå¹¶ä¸”æ— æ³•æ‰§è¡Œå›è°ƒ val jsCode = String.format(\"window.showWebDialog('%s')\", text) webView.loadUrl(\"javascript: \" + jsCode) Android 4.4ä¹‹åæä¾›äº†evaluateJavascriptæ¥æ‰§è¡ŒJSä»£ç ï¼Œå¹¶ä¸”å¯ä»¥è·å–è¿”å›å€¼æ‰§è¡Œå›è°ƒï¼› String jsCode = String.format(\"window.showWebDialog('%s')\", text); webView.evaluateJavascript(jsCode, new ValueCallback&lt;String>() { @Override public void onReceiveValue(String value) { //æ‹¿åˆ°è¿”å›å€¼åè¿›è¡Œå¤„ç† } }); Android ç‰ˆæœ¬ API ç‰¹ç‚¹ ä½äº4.4 WebView.loadUrl æ— æ³•æ‰§è¡Œå›è°ƒ é«˜äº4.4 WebView.evaluateJavascript å¯ä»¥æ‹¿åˆ° JS æ‰§è¡Œå®Œæ¯•çš„è¿”å›å€¼ iOSçš„UIWebViewä½¿ç”¨stringByEvaluatingJavaScriptFromStringï¼› NSString *jsStr = @\"æ‰§è¡Œçš„JSä»£ç \"; [webView stringByEvaluatingJavaScriptFromString:jsStr]; iOSçš„WKWebViewä½¿ç”¨evaluateJavaScriptï¼› [webView evaluateJavaScript:@\"æ‰§è¡Œçš„JSä»£ç \" completionHandler:^(id _Nullable response, NSError * _Nullable error) { }]; iOS ç‰ˆæœ¬ API ç‰¹ç‚¹ ä½äº8.0 UIWebView.stringByEvaluatingJavaScriptFromString æ— æ³•æ‰§è¡Œå›è°ƒ é«˜äº8.0 WKWebView.evaluateJavaScript å¯ä»¥æ‹¿åˆ° JS æ‰§è¡Œå®Œæ¯•çš„è¿”å›å€¼ Web to NativeJSè°ƒç”¨nativeæ–¹æ³• æ–¹æ¡ˆ è°ƒç”¨æ–¹æ³• é€Ÿåº¦ æ³¨æ„äº‹é¡¹ æ³¨å…¥api addJavascriptInterface è¾ƒå¿« Android &lt; 4.2 å­˜åœ¨å®‰å…¨æ¼æ´ urlæ‹¦æˆª shouldOverrideUrlLoading æœ€æ…¢ JSå›è°ƒæ—¶æœº onJsPrompt è¾ƒå¿« æ—¥å¿—è¾“å‡º console.log æœ€å¿« scheme://dddd ï¼ˆ1ï¼‰å…¨å±€æ³¨å…¥APIä¹Ÿå¯ä»¥è§£é‡Šä¸ºåœ¨windowæ³¨å…¥nativeå°è£…å¥½çš„æ–¹æ³•ï¼Œå‰ç«¯é€šè¿‡ window.xxxè°ƒç”¨ï¼Œ å°†Nativeçš„ç›¸å…³æ¥å£æ³¨å…¥åˆ°JSçš„Contextï¼ˆwindowï¼‰çš„å¯¹è±¡ä¸­ï¼Œä¸€èˆ¬æ¥è¯´è¿™ä¸ªå¯¹è±¡å†…çš„æ–¹æ³•åä¸Nativeç›¸å…³æ–¹æ³•åæ˜¯ç›¸åŒçš„ï¼ŒWebç«¯å°±å¯ä»¥ç›´æ¥åœ¨å…¨å±€windowä¸‹ä½¿ç”¨è¿™ä¸ªæš´éœ²çš„å…¨å±€JSå¯¹è±¡ï¼Œè¿›è€Œè°ƒç”¨åŸç”Ÿç«¯çš„æ–¹æ³•ã€‚ 1ã€ å®¢æˆ·ç«¯å®šä¹‰jsæ˜ å°„å¯¹è±¡ å…·ä½“æœ‰å®‰å“ webview çš„ addJavascriptInterfaceï¼ŒiOS UIWebview çš„ JSContextï¼ŒiOS WKWebview çš„ scriptMessageHandlerã€‚ public class AndroidToJS { // å®šä¹‰JSéœ€è¦è°ƒç”¨çš„æ–¹æ³• // è¢«JSè°ƒç”¨çš„æ–¹æ³•å¿…é¡»åŠ å…¥@JavascriptInterfaceæ³¨è§£ @JavascriptInterface public void callAndroid(String msg){ Log.e(\"zw\",\"JSè°ƒç”¨äº†Androidçš„callAndroid()ï¼Œmsg : \" + msg); }} 2ã€æ³¨å…¥jsæ–¹æ³• webView.addJavascriptInterface(new AndroidToJS(),\"android\"); 3ã€å‰ç«¯è°ƒç”¨ window.NativeBridge.callAndroid('hello'); 4ã€ä¼˜ç¼ºç‚¹ ä¼˜ç‚¹ï¼šé€šä¿¡æ—¶é—´çŸ­ï¼Œè°ƒç”¨æ–¹ä¾¿ã€‚ ç¼ºç‚¹ï¼šä½¿ç”¨ webView.addJavascriptInterface æ–¹æ³•è¿›è¡Œæ³¨å…¥ã€‚æ­¤æ–¹æ³•å­˜åœ¨æ¼æ´(å®‰å…¨éšæ‚£)ï¼Œåœ¨ Android4.2 ä»¥ä¸Šæä¾› @javascriptInterface æ³¨è§£æ¥è§„é¿è¯¥æ¼æ´ï¼Œä½†å¯¹äº4.2ä»¥ä¸‹ç‰ˆæœ¬åˆ™æ²¡æœ‰ä»»ä½•æ–¹æ³•ã€‚æ‰€ä»¥ä½¿ç”¨è¯¥æ–¹æ³•æœ‰ä¸€å®šçš„é£é™©å’Œå…¼å®¹æ€§é—®é¢˜ã€‚ ï¼ˆ2ï¼‰schemeæ‹¦æˆªå¯ä»¥è§£é‡Šä¸ºï¼Œå‘è¯·æ±‚ï¼Œç„¶åå®¢æˆ·ç«¯æ‹¦æˆªè¯·æ±‚ï¼Œè°ƒç”¨æ–¹æ³• å®¢æˆ·ç«¯å’Œå‰ç«¯å®šä¹‰schemeè§„èŒƒï¼Œå‰ç«¯åŠ è½½schemeï¼Œå®¢æˆ·ç«¯ä¼šæ‹¦æˆªschemeï¼Œå¦‚æœschemeæ ¼å¼ç¬¦åˆè§„èŒƒï¼Œå®¢æˆ·ç«¯ä¼šè§£æschemeä¸­çš„å‚æ•°ï¼Œè·å–å¯¹åº”çš„æ–¹æ³•å’Œå‚æ•°åï¼Œç„¶åè°ƒèµ·å®¢æˆ·ç«¯åŸç”Ÿæ–¹æ³•ã€‚ 1ã€å‰ç«¯åŠ è½½scheme é€šè¿‡iframe.srcå‘èµ·ä¸€ä¸ªè¯·æ±‚ï¼Œå®¢æˆ·ç«¯webviewèƒ½æ‹¦æˆªè¿™ä¸ªè¯·æ±‚ï¼Œåšç›¸åº”çš„å¤„ç†ã€‚ Web ç«¯å‘å‡ºè¯·æ±‚çš„æ–¹å¼éå¸¸å¤šæ ·ï¼Œä¾‹å¦‚ &lt;a/&gt; ã€iframe.srcã€location.hrefã€ajax ç­‰ï¼Œä½† &lt;a/&gt; éœ€è¦ç”¨æˆ·æ‰‹åŠ¨è§¦å‘ï¼Œlocation.href å¯èƒ½ä¼šå¯¼è‡´é¡µé¢è·³è½¬ï¼Œå®‰å“ç«¯æ‹¦æˆª ajax çš„èƒ½åŠ›æœ‰æ‰€æ¬ ç¼ºï¼Œå› æ­¤ç»å¤§å¤šæ•°æ‹¦æˆªå¼å®ç°æ–¹æ¡ˆå‡é‡‡ç”¨iframe æ¥å‘é€è¯·æ±‚ã€‚ var iframe = document.createElement('iframe'); iframe.style.width = '1px'; iframe.style.height = '1px'; iframe.style.display = 'none'; iframe.src = 'jsbridge://getNetwork?callback=networkInfo'; document.body.appendChild(iframe); // 100æ¯«ç§’åç§»é™¤ setTimeout(function() { iframe.remove(); }, 100)l ä¸€ä¸ªæ ‡å‡†çš„ URL ç”± &lt;scheme&gt;://&lt;host&gt;:&lt;port&gt;&lt;path&gt; ç»„æˆï¼Œç›¸ä¿¡å¤§å®¶éƒ½æœ‰è¿‡ä»å¾®ä¿¡æˆ–æ‰‹æœºæµè§ˆå™¨ç‚¹å‡»æŸä¸ªé“¾æ¥æ„å¤–è·³è½¬åˆ°å…¶ä»– App çš„ç»å†ï¼Œå¦‚æœæœ‰ä»”ç»†ç•™æ„è¿‡è¿™äº›é“¾æ¥çš„ URL ä½ ä¼šå‘ç°ç›®å‰ä¸»æµ App éƒ½æœ‰å…¶ä¸“å±çš„ä¸€ä¸ª scheme æ¥ä½œä¸ºè¯¥åº”ç”¨çš„æ ‡è¯†ï¼Œä¾‹å¦‚å¾®ä¿¡çš„ URL scheme å°±æ˜¯ weixin://ã€‚ JSB çš„å®ç°å€Ÿé‰´è¿™ä¸€æ€è·¯ï¼Œå®šåˆ¶ä¸šåŠ¡è‡ªèº«ä¸“å±çš„ä¸€ä¸ª URL scheme æ¥ä½œä¸º JSB è¯·æ±‚çš„æ ‡è¯†ï¼Œä¾‹å¦‚å­—èŠ‚å†…éƒ¨å®ç°æ‹¦æˆªå¼ JSB çš„ SDK ä¸­å°±å®šä¹‰äº† bytedance:// è¿™æ ·ä¸€ä¸ª schemeã€‚ å®é™…ä¸Šè¿™ä¸ªè·³è½¬åœ°å€åªæ˜¯ä¸€ä¸ªéæ³•çš„ä¸å­˜åœ¨çš„url 2ã€android é‡å†™shouldOverrideUrlLoading Native æ‹¦æˆªè¯·æ±‚çš„é’©å­æ–¹æ³•ï¼š å¹³å° API Android shouldOverrideUrlLoading iOS 8+ decidePolicyForNavigationAction iOS 8- shouldStartLoadWithRequest åœ¨webviewä¸­é‡å†™shouldOverrideUrlLoadingæ ¹æ®å®šä¹‰çš„schemeåŸåˆ™è¿›è¡Œæ‹¦æˆª public boolean shouldOverrideUrlLoading(WebView view, String url) { if(isValidScheme()){ //æ‹¦æˆªå¤„ç†scheme return handleScheme() } return false; } å¤åˆ¶ä»£ç  3ã€ä¼˜ç¼ºç‚¹ ä¼˜ç‚¹ï¼šå…¼å®¹æ€§å¥½ï¼Œå®‰å“å’Œ IOS çš„å„ä¸ªç‰ˆæœ¬éƒ½èƒ½æ”¯æŒæ­¤åŠŸèƒ½ã€‚ ç¼ºç‚¹ï¼šè°ƒç”¨æ—¶å»¶æ¯”è¾ƒé«˜ 200 - 400msï¼Œåœ¨å®‰å“ä¸Šè¡¨ç°æ˜æ˜¾ï¼›URL scheme é•¿åº¦æœ‰é™ï¼Œå†…å®¹è¿‡å¤šå¯èƒ½ä¼šä¸¢å¤±å­—ç¬¦ï¼›ä¸æ”¯æŒåŒæ­¥è¿”å›ç»“æœï¼Œæ‰€æœ‰ä¿¡æ¯ä¼ é€éƒ½éœ€è¦è°ƒç”¨ iframe è¯·æ±‚ï¼Œä½¿ç”¨ callback å¾—åˆ°è¿”å›çš„æ•°æ®ã€‚ ä¸€éƒ¨åˆ†é—®é¢˜ï¼ˆç¼ºç‚¹ï¼‰çš„è§£å†³ è¿ç»­å‘é€æ—¶æ¶ˆæ¯ä¸¢å¤± ä»¥ä¸‹ä»£ç ï¼š window.location.href = \"jsbridge://callNativeNslog?{\"data\": \"111\", \"cbName\": \"\"}\"; window.location.href = \"jsbridge://callNativeNslog?{\"data\": \"222\", \"cbName\": \"\"}\"; js æ­¤æ—¶çš„è¯‰æ±‚æ˜¯åœ¨åŒä¸€ä¸ªè¿è¡Œé€»è¾‘å†…ï¼Œå¿«é€Ÿçš„è¿ç»­å‘é€å‡º 2 ä¸ªé€šè®¯è¯·æ±‚ï¼Œç”¨å®¢æˆ·ç«¯è‡ªå·± IDE çš„ logï¼ŒæŒ‰é¡ºåºæ‰“å° 111ï¼Œ222ï¼Œé‚£ä¹ˆå®é™…ç»“æœæ˜¯ 222 çš„é€šè®¯æ¶ˆæ¯æ ¹æœ¬æ”¶ä¸åˆ°ï¼Œç›´æ¥ä¼šè¢«ç³»ç»ŸæŠ›å¼ƒä¸¢æ‰ã€‚ ç¼˜ç”±ï¼šç”±äº h5 çš„è¯·æ±‚å½’æ ¹ç»“åº•æ˜¯ä¸€ç§æ¨¡æ‹Ÿè·³è½¬ï¼Œè·³è½¬è¿™ä»¶äº‹æƒ…ä¸Š webview ä¼šæœ‰é™åˆ¶ï¼Œå½“ h5 è¿ç»­å‘é€å¤šæ¡è·³è½¬çš„æ—¶å€™ï¼Œwebview ä¼šç›´æ¥è¿‡æ»¤æ‰åå‘çš„è·³è½¬è¯·æ±‚ï¼Œæ‰€ä»¥ç¬¬äºŒä¸ªæ¶ˆæ¯æ ¹æœ¬æ”¶ä¸åˆ°ï¼Œæƒ³è¦æ”¶åˆ°æ€ä¹ˆåŠï¼Ÿjs é‡Œå°†ç¬¬äºŒæ¡æ¶ˆæ¯å»¶æ—¶ä¸€ä¸‹ã€‚ //å‘ç¬¬ä¸€æ¡æ¶ˆæ¯ location.href = \"jsbridge://callNativeNslog?{\"data\": \"111\", \"cbName\": \"\"}\"; //å»¶æ—¶å‘é€ç¬¬äºŒæ¡æ¶ˆæ¯ setTimeout(500,function(){ location.href = \"jsbridge://callNativeNslog?{\"data\": \"222\", \"cbName\": \"\"}\"; }); ä½†è¿™å¹¶ä¸èƒ½ä¿è¯æ­¤æ—¶æ˜¯å¦æœ‰å…¶ä½™åœ°æ–¹ç»è¿‡è¿™ç§æ–¹å¼è¿›è¡Œè¯·æ±‚ï¼Œä¸ºç³»ç»Ÿè§£å†³æ­¤é—®é¢˜ï¼Œjs ç«¯èƒ½å¤Ÿå°è£…ä¸€å±‚é˜Ÿåˆ—ï¼Œå…¨éƒ¨ js ä»£ç è°ƒç”¨æ¶ˆæ¯éƒ½å…ˆè¿›å…¥é˜Ÿåˆ—å¹¶ä¸é©¬ä¸Šå‘é€ï¼Œè€Œå h5 ä¼šå‘¨æœŸæ€§å¥½æ¯” 500 æ¯«ç§’ï¼Œæ¸…ç©ºä¸€æ¬¡é˜Ÿåˆ—ï¼Œä¿è¯åœ¨å¾ˆå¿«çš„æ—¶é—´å†…ç»å¯¹ä¸ä¼šè¿ç»­å‘ 2 æ¬¡è¯·æ±‚é€šè®¯ã€‚ ï¼ˆ3ï¼‰JSå›è°ƒæ—¶æœºåŸºæœ¬æ²¡ç”¨â€¦.å› ä¸ºä»¥ä¸‹æ–¹æ³•ioséƒ½ä¸æ”¯æŒï¼Œä½œäº†è§£å°±å¯ä»¥äº† 1ã€Confirm å®¢æˆ·ç«¯å¯ä»¥æ‹¦æˆªconfirmã€‚iOSçš„UIWebviewä¸æ”¯æŒï¼ˆä¸è¿‡å¥½åƒWKWebView æ”¯æŒï¼‰ã€‚ä½¿ç”¨åœºæ™¯ç›¸å¯¹è¾ƒå¤šï¼Œä¸é€‚åˆç”¨æ¥åšjsbã€‚ å‰ç«¯è°ƒç”¨ window.confirm('dance://app.toast?title=hello') 2ã€alert å®¢æˆ·ç«¯å¯ä»¥æ‹¦æˆªalertã€‚iOSçš„UIWebviewä¸æ”¯æŒã€‚ä½†æ˜¯alertä½¿ç”¨åœºæ™¯è¾ƒå¤šï¼Œä¸é€‚åˆç”¨æ¥åšjsbã€‚ å‰ç«¯è°ƒç”¨ window.alert('dance://app.toast?title=hello') 3ã€Prompt å®¢æˆ·ç«¯å¯ä»¥æ‹¦æˆªpromptï¼Œå‚æ•°åŒä¸Šã€‚iOSçš„UIWebviewä¸æ”¯æŒã€‚å¯è‡ªå®šä¹‰è¿”å›å€¼ï¼Œå¤šç”¨äºå®‰å“jsbæ–¹æ¡ˆã€‚ å‰ç«¯è°ƒç”¨ const url = 'jsbridge://' + method + '?' + JSON.stringify(args); window.prompt(url) Androidç«¯æ‹¦æˆª / Java: é‡è½½ onJsPrompt æ–¹æ³•ï¼Œæå– prompt å†…å®¹åˆ¤æ–­æ˜¯å¦éœ€è¦æ‹¦æˆª class MyWebViewClient extends WebChromeClient { @Override public boolean onJsPrompt(WebView view, String url, String message, String defaultValue, JsPromptResult result) { if (message.startsWith(\"bridge://\")) { // è§£æ // åé¢çš„ action å’Œå‚æ•°ï¼Œè°ƒç”¨ç›¸å…³çš„å‡½æ•° result.confirm(\"Yes!\"); } return true; } } webView.setWebViewClient(new MyWebViewClient()); ï¼ˆ4ï¼‰æ—¥å¿—è¾“å‡ºå®¢æˆ·ç«¯å¯ä»¥æ‹¦æˆªconsole.logï¼Œå‚æ•°åŒä¸Šã€‚å®‰å“å’ŒiOSé€šç”¨ã€‚ 1ã€å‰ç«¯è°ƒç”¨ console.log('dance://app.toast?title=hello') 2ã€Androidç«¯æ‹¦æˆª WebView.setWebChromeClient(new WebChromeClient() { public void onConsoleMessage(String message, int lineNumber, String sourceID) { return true; } }); è°ƒç”¨ä¸å›è°ƒè·¨ç«¯æ–¹æ³•ä¸€èˆ¬éƒ½ä¸æ˜¯å•å‘çš„ï¼Œä¸€èˆ¬è°ƒç”¨å®Œæ¯•æˆ‘ä»¬éƒ½éœ€è¦æ‰§è¡Œå›è°ƒå•Šã€ä»€ä¹ˆè¿”å›ä¸€ä¸ªå‚æ•°ä¹‹ç±»çš„ï¼Œè€Œæ‰§è¡Œ js å›è°ƒå‡½æ•°æ–¹å¼æœ¬è´¨æ˜¯ native è°ƒç”¨ h5 çš„ js æ–¹æ³• ä½†æ˜¯ç”±äºè°ƒç”¨æ–¹è°ƒç”¨è¢«è°ƒç”¨æ–¹å’Œè°ƒç”¨æ–¹å›è°ƒè¢«è°ƒç”¨æ–¹åœ¨ä»£ç å±‚é¢éƒ½æ˜¯åŒä¸€ä¸ªæ¥å£ï¼ˆä½ ä¹Ÿå¯ä»¥äº†ç†è§£ä¸ºåŒä¸€ä¸ªå‘½åçš„æ–¹æ³•ï¼‰ï¼Œä¸ºäº†åŒºåˆ†æœ¬æ¬¡è°ƒç”¨æ˜¯ API è°ƒç”¨è¿˜æ˜¯å›è°ƒè°ƒç”¨ï¼Œsn éœ€è¦åšåŒºåˆ†ï¼Œæ¯”å¦‚è¯·æ±‚æ–¹å¸¦è¿‡å»çš„ key åå« req_sn(callbackId)ï¼Œå›è°ƒå¸¦è¿‡å»çš„å« res_sn(responseId)ã€‚ ä»¥æ‹¦æˆªå¼è°ƒç”¨ä¸ºä¾‹ï¼Œå‘èµ·å¸¦ req_sn çš„è¯·æ±‚å‰ï¼Œå¦‚æœæœ‰å›è°ƒå‡½æ•°ï¼Œä¼šä»¥ req_sn çš„å€¼ä¸º keyï¼ŒæŠŠå›è°ƒå‡½æ•°å­˜åˆ°å¯¹åº”çš„å›è°ƒå‡½æ•°åˆ—è¡¨ã€‚å½“æ¥æ”¶åˆ°å¸¦æœ‰ res_sn çš„è°ƒç”¨åï¼Œä¼šä»¥ res_sn çš„å€¼ä¸º keyï¼Œä»å¯¹åº”çš„å›è°ƒå‡½æ•°åˆ—è¡¨å–å‡ºå›è°ƒå‡½æ•°ï¼Œå¹¶ä»¥æ¥æ”¶åˆ°çš„æ•°æ®ä¸ºå‚æ•°ï¼Œæ‰§è¡Œå›è°ƒå‡½æ•° åˆ†äº«ä¸€ä¸ªJSBridgeAn iOS/OSX bridge for sending messages between Obj-C and JavaScript in UIWebViews/WebViewsï¼š Facebook Messenger Facebook Paper ç­‰éƒ½æœ‰åœ¨ä½¿ç”¨ å®ƒæŠŠ JSBå°è£…çš„å°±åƒæ˜¯ä¸€ä¸ªè·¨è¶Šä¸¤ç«¯çš„ EventEmitter https://github.com/marcuswestin/WebViewJavascriptBridge 3.RNè·¨ç«¯ä¼ ç»Ÿçš„jsbæ–¹æ¡ˆä¸‹ï¼Œä½¿ç”¨Webview ä½œä¸ºæ˜¯ JS çš„æ‰§è¡Œå¼•æ“ï¼Œè€Œåœ¨ä½¿ç”¨RNæƒ…å†µä¸‹ï¼ŒRN å›¢é˜Ÿé€‰æ‹©äº†JSCoreï¼ˆJSCore çš„å¯¹å¤–æ¥å£æ˜¯ç”¨ C å’Œ C++ ç¼–å†™çš„ï¼ŒC++ åœ¨ iOS å’Œå®‰å“ç³»ç»Ÿä¸Šä¹Ÿæœ‰è‰¯å¥½çš„è·¨ç«¯è¿è¡Œçš„åŠŸèƒ½ï¼‰ä½œä¸ºæ‰§è¡Œå¼•æ“ï¼Œç”¨æ¥è·‘reactä»£ç ï¼ˆJSä»£ç åŠ è½½å’Œè§£æï¼‰ï¼Œè‡ªå¸¦çš„javaå±‚ä½œä¸ºæ¸²æŸ“å¼•æ“ Native æ¨¡å—ï¼ˆå®¢æˆ·ç«¯åŸç”Ÿæ¨¡å—ï¼‰åœ¨ Android ç³»ç»Ÿä¸‹æ˜¯ Java æ¨¡å—ï¼ŒJS é€šè¿‡æ¨¡å— IDï¼ˆmoduleIDï¼‰ å’Œæ–¹æ³• IDï¼ˆmethodIDï¼‰ æ¥è¿›è¡Œè°ƒç”¨ JavaScript æ¨¡å—æ˜¯ç”± JS å®ç° ä»¥å®‰å“ä¸ºä¾‹ï¼ŒJS ç¯å¢ƒä¸­ä¼šç»´æŠ¤ä¸€ä»½æ‰€æœ‰ Native æ¨¡å—çš„ moduleID å’Œ methodID çš„æ˜ å°„ NativeModulesï¼Œç”¨æ¥è°ƒç”¨ Native æ¨¡å—çš„æ—¶å€™æŸ¥æ‰¾å¯¹åº” IDï¼›Java ç¯å¢ƒä¸­ä¹Ÿä¼šç»´æŠ¤ä¸€ä»½ JavaScript æ¨¡å—çš„æ˜ å°„ JSModuleRegistryï¼Œç”¨æ¥è°ƒç”¨ JS ä»£ç ã€‚è€Œåœ¨å®é™…çš„ä»£ç ä¸­ï¼ŒNative æ¨¡å—å’Œ JS æ¨¡å—çš„é€šä¿¡éœ€è¦é€šè¿‡ä¸­é—´å±‚ä¹Ÿå°±æ˜¯ C++ å±‚çš„è¿‡æ¸¡ï¼Œä¹Ÿå°±æ˜¯è¯´ Native æ¨¡å—å’Œ JS æ¨¡å—å®é™…ä¸Šéƒ½åªæ˜¯åœ¨å’Œ C++ æ¨¡å—è¿›è¡Œé€šä¿¡ã€‚ RNç¯å¢ƒä¸­ä¼šå¡å…¥4ä¸ªapiä½œä¸ºè°ƒç”¨jsçš„å…¥å£ï¼š callFunctionReturnFlushedQueue // è®© C++ è°ƒç”¨ JS æ¨¡å— invokeCallbackAndReturnFlushedQueue // è®© C++ è°ƒç”¨ JS å›è°ƒ flushedQueue // æ¸…ç©º JS ä»»åŠ¡é˜Ÿåˆ— callFunctionReturnResultAndFlushedQueue // è®© C++ è°ƒç”¨ JS æ¨¡å—å¹¶è¿”å›ç»“æœ JS è¿˜åœ¨ global ä¸­è¿˜è®¾ç½®äº† __fbGenNativeModule æ–¹æ³•ï¼Œç”¨æ¥ç»™ C++ è°ƒç”¨ååœ¨ JS ç¯å¢ƒç”Ÿæˆ Java æ¨¡å—çš„æ˜ å°„å¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯ NativeModules æ¨¡å—ã€‚ æ•°æ®ç»“æ„ç±»ä¼¼äºï¼ˆè·Ÿå®é™…çš„æ•°æ®ç»“æ„æœ‰åå·®ï¼‰ï¼š { \"Timing\": { \"moduleID\": \"1001\", \"method\": { \"createTimer\": { \"methodID\": \"10001\" } } } } å…¶ä¸­moduleIDå’ŒmethodID ä¼šæ˜ å°„ nativeæ–¹æ³• åŒæ ·çš„ï¼ŒC++ é€šè¿‡ JSCore çš„ JSObjectSetProperty æ–¹æ³•åœ¨ global å¯¹è±¡ä¸­å¡å…¥äº†å‡ ä¸ª Native APIï¼Œè®© JS èƒ½é€šè¿‡å®ƒä»¬æ¥è°ƒç”¨ C++ æ¨¡å— nativeFlushQueueImmediate // ç«‹å³æ¸…ç©º JS ä»»åŠ¡é˜Ÿåˆ— nativeCallSyncHook // åŒæ­¥è°ƒç”¨ Native æ–¹æ³• nativeRequire // åŠ è½½ Native æ¨¡å—Java è·Ÿ C++ çš„äº’ç›¸è°ƒç”¨é€šè¿‡ JNIï¼Œé€šè¿‡ JNIï¼ŒC++ å±‚ä¼šæš´éœ²å‡ºæ¥ä¸€äº› API æ¥ç»™ Java å±‚è°ƒç”¨ å‚è€ƒï¼š https://zhuanlan.zhihu.com/p/473710695 https://juejin.cn/post/7097845525587689486","categories":[{"name":"å‰ç«¯","slug":"å‰ç«¯","permalink":"https://taylor12138.github.io/categories/%E5%89%8D%E7%AB%AF/"}],"tags":[],"author":"Hello"},{"title":"Vue(ä¸­)","slug":"Vue(ä¸­)","date":"2021-02-28T16:00:00.000Z","updated":"2022-03-04T06:44:08.066Z","comments":true,"path":"2021/03/01/vue-zhong/","link":"","permalink":"https://taylor12138.github.io/2021/03/01/vue-zhong/","excerpt":"","text":"4.Vue CLIåœ¨å¼€å‘å¤§å‹é¡¹ç›®çš„æ—¶å€™ï¼Œåˆ™å¿…é¡»ä½¿ç”¨åˆ°Vue CLIï¼ŒCLIæ˜¯Command-Line Interface ï¼Œç¿»è¯‘ä¸ºå‘½ä»¤è¡Œç•Œé¢ï¼Œä¿—ç§°è„šæ‰‹æ¶ ä½¿ç”¨ vue-cli å¯ä»¥å¿«é€Ÿæ­å»ºVueå¼€å‘ç¯å¢ƒä»¥åŠå¯¹åº”çš„webpacké…ç½®ï¼ˆç»ˆäºä¸ç”¨è‡ªå·±é…ç½®webpackäº†ï¼ï¼‰ Vue CLI çš„ä½¿ç”¨å‰æï¼šNode &amp; Webpack å®‰è£…è„šæ‰‹æ¶ï¼ˆåŒæ—¶ä¹Ÿè‡ªåŠ¨è£…ä¸Švueï¼‰ï¼š npm install -g @vue/cli CLI 3+ åˆå§‹åŒ– vue create my-project ä½†æ˜¯æˆ‘ä»¬è¿™é‡Œä¹Ÿè¦ä½¿ç”¨cli 2 çš„åŠŸèƒ½æ‰€ä»¥è¿˜å¾— æ‹‰å– 2.xæ¨¡æ¿ npm install -g @vue/cli-init CLI 2 åˆå§‹åŒ–é¡¹ç›® vue init webpack my-project ç°æœ‰çš„vueé¡¹ç›®æ·»åŠ eslint vue add eslint CLI 2 åˆå§‹åŒ–vue init webpack é¡¹ç›®åç§°ï¼Œè¿™ä¸ªé¡¹ç›®åç§°ä¸ºåˆ›å»ºæœ€ç»ˆé¡¹ç›®æ–‡ä»¶å¤¹å ç„¶åä¼šå‡ºç°é€‰é¡¹ï¼š ç„¶åå¾—åˆ°ä¸€ä¸ªæ–‡ä»¶ï¼Œå¯ä»¥æŸ¥çœ‹ package.json æ–‡ä»¶é‡Œçš„ scriptï¼Œå¾—çŸ¥ç›¸åº”çš„è¿è¡Œå‘½ä»¤ï¼›ä¸‹é¢å¯¹å­˜æ”¾åœ¨é‡Œé¢çš„æ¯ä¸ªæ–‡ä»¶è¿›è¡Œä»‹ç» buildã€configï¼ˆé…ç½®åŸºç¡€å˜é‡ï¼‰å­˜æ”¾webpackçš„é…ç½®åŒºåŸŸ src æ”¾ç½®æºä»£ç åŒºåŸŸ static æ”¾ç½®é™æ€èµ„æºçš„åŒºåŸŸï¼ŒåŸå°ä¸åŠ¨å¤åˆ¶åˆ°distæ–‡ä»¶å¤¹é‡Œ .babelrc å…³äºè½¬åŒ–ä¸ºES5çš„ç›¸å…³é…ç½® éƒ¨åˆ†é…ç½®çš„ä»‹ç»å…³é—­ESLintä»£ç è§„èŒƒï¼ˆå¯èƒ½ä¸ç¬¦åˆéƒ¨åˆ†ä»£ç é£æ ¼ï¼Œæ¯”å¦‚ä¸åŠ åˆ†å·ï¼Œå®šä¹‰å‡½æ•°æ—¶å‡½æ•°ååç©ºä¸€æ ¼ç­‰ï¼‰ config -&gt; index.js -&gt; useEslint: false Runtime-only å’Œ Runtime + Compilerçš„ä¸åŒä¹‹å¤„åœ¨main.jsé‡Œé¢ //runtime compiler new Vue({ el: '#app', components: { App }, template: '&lt;App/>' }) //runtime-only //ç›´æ¥renderï¼Œè·³è¿‡templateéƒ¨åˆ† new Vue({ el: '#app', render: h => h(App) }) Runtime-onlyåœ¨å®é™…å…¬å¸å¼€å‘ä¸­ä½¿ç”¨çš„æ¯”è¾ƒå¤šï¼Œæ€§èƒ½æ›´å¥½ï¼Œä»£ç æ›´å°‘ï¼ˆä¸ç”¨å¤„ç†templateå’Œastï¼Œ å®ƒçš„ .vueæ–‡ä»¶ç”± webpackç”¨åˆ°çš„loaderï¼švue-template-compiler è§£ææˆrenderï¼Œ ä¹Ÿå°±æ˜¯render(App) -&gt; ç»„ä»¶Appçš„ template æ›¿æ¢æ‰ç»‘å®šçš„å…ƒç´  ï¼‰ å®é™…ä¸Šï¼ŒVueå®ä¾‹çš„template -&gt; ä¼šä¿å­˜åœ¨optioné‡Œ -&gt; è¿›è¡Œparseè§£ææˆæŠ½è±¡è¯­æ³•æ ‘ï¼ˆastï¼‰ï¼ˆæè¿°äº†æˆ‘ä»¬æ ‡ç­¾çš„è¯¦æƒ…æ•°æ®æƒ…å†µï¼‰ -&gt; compileç¼–è¯‘æˆ renderå‡½æ•° -&gt; ç¿»è¯‘æˆè™šæ‹ŸDOMï¼ˆvirtual DOMï¼‰ -&gt; æ¸²æŸ“æˆUIï¼ˆçœŸå®DOMï¼‰ æ‰€ä»¥å®é™…ä¸Šcompileræ˜¯å¤„ç† templateéƒ¨åˆ†å’Œ astéƒ¨åˆ† åŠ¨æ€åˆ›å»ºæ ‡ç­¾ï¼šcreateElement(&#39;æ ‡ç­¾&#39;, {æ ‡ç­¾å±æ€§}, [&#39;&#39;]), createElement(ç»„ä»¶)ä¹Ÿå¯ä»¥ //renderå‡½æ•°çš„çœŸèº«ï¼š(APPä¸ºç»„ä»¶å¯¹è±¡) render: funciton(createElement) { return createElement(APP); } CLI 3ä¸2ç‰ˆæœ¬æœ‰å¾ˆå¤§åŒºåˆ« åŸºäºwebpack 4 æ‰“é€  è®¾è®¡åŸåˆ™æ˜¯â€œ0é…ç½®â€ï¼Œç§»é™¤æ ¹ç›®å½•ä¸‹çš„buildã€config æä¾›äº†vue ui å‘½ä»¤ï¼Œæä¾›äº†å¯è§†åŒ–é…ç½®ï¼Œæ›´åŠ äººæ€§åŒ– ç§»é™¤äº†staticï¼Œæ–°å¢äº†publicï¼Œå¹¶ä¸”å°†index.htmlç§»åŠ¨åˆ°publicä¸­ï¼Œpublicç±»ä¼¼äºæ–°çš„static åˆå§‹åŒ–ååŒæ ·ä¼šå‡ºç°åˆå§‹åŒ–çš„é…ç½®é€‰é¡¹ preset é¢„è®¾ï¼šdefaultæ˜¯é»˜è®¤ï¼›manually select featuresæ˜¯æ‰‹åŠ¨ featureç‰¹æ€§ï¼šæŒ‰ç©ºæ ¼é€‰ä¸­/å–æ¶ˆï¼ˆLinterä»£ç è§„èŒƒå¯ä»¥å–æ¶ˆæ‰ã€Babelä¸ºæ”¯æŒes6ä»¥ä¸Šè¯­æ³• ï¼‰ placing configé…ç½®çš„å­˜æ”¾ï¼šconfig files ç‹¬ç«‹å­˜æ”¾ï¼›package.json æ”¾åœ¨package.jsonä¸­ save prestï¼šæ˜¯å¦ä¿å­˜åˆšæ‰é…ç½®å¥½çš„é¢„è®¾ ï¼ˆå¦‚æœæƒ³åˆ é™¤ï¼Œåˆ™è¦æ‰¾åˆ°.vuercæ–‡ä»¶ï¼Œè¿›å…¥åè¿›è¡Œä¿®æ”¹åˆ é™¤ï¼‰ CLI 3 çš„é…ç½®å»å“ªé‡Œäº†ï¼Ÿ -&gt; å¯åŠ¨é…ç½®æœåŠ¡å™¨ï¼ˆå¯è§†åŒ–é…ç½®ï¼‰ï¼š vue ui å¯¼å…¥å½“å‰é¡¹ç›®è„šæ‰‹æ¶çš„æ–‡ä»¶å¤¹ï¼Œç„¶åå¯ä»¥åœ¨å½“å‰é¡µé¢æ·»åŠ éœ€è¦çš„æ’ä»¶ï¼Œé…ç½®ç”šè‡³è¿è¡Œç­‰ å¦‚æœçœŸçš„è¦æ‰‹åŠ¨ä¿®æ”¹æ‰åŸºç¡€çš„é…ç½®ï¼Œéœ€è¦æ–°å»ºvue.config.jsåœ¨å½“å‰é¡¹ç›®ç›®å½•ä¸‹ï¼ˆåŸæ¥buildå’ŒConfigæ–‡ä»¶çš„é…ç½®éƒ½æ”¾åœ¨node_modulesé‡Œé¢äº†ï¼‰ï¼Œåœ¨é‡Œé¢è¿›è¡Œ module.exports = {}é…ç½®ï¼Œåˆ°æ—¶ä¼šå’ŒåŸæ¥çš„é…ç½®è¿›è¡Œåˆå¹¶ä½œä¸ºæ•´ä½“é…ç½® æƒ³äº†è§£æ›´å¤šé…ç½®å¯ä»¥ä¸Š https://cli.vuejs.org/zh/config/ æŸ¥çœ‹ module.exports = { devServer: { //è¿è¡Œåé»˜è®¤æ‰“å¼€æµè§ˆå™¨ open: true } } CLI 4é…ç½®è®²è¿°ä¸€ä¸‹cli 4 ä¸­é…ç½®æ–°æ·»åŠ çš„é€‰é¡¹ (*) Choose Vue version æ˜¯å¦è¦é€‰æ‹©vueç‰ˆæœ¬ (*) Babel (*) TypeScript ( ) Progressive Web App (PWA) Support (*) Router (*) Vuex (*) CSS Pre-processors æ˜¯å¦è¦ä½¿ç”¨cssé¢„å¤„ç†å™¨ï¼Œæ¯”å¦‚sassã€less () Linter / Formatter esä»£ç linteræ£€æŸ¥ ( ) Unit Testing å•å…ƒæµ‹è¯• ( ) E2E Testing ç«¯åˆ°ç«¯æµ‹è¯• Use class-style component syntax? (y/N) æ˜¯å¦è¦ä½¿ç”¨classé£æ ¼çš„componentï¼Œæˆ‘ä»¬ä¸€èˆ¬æ˜¯ä¸æ€ä¹ˆå®ç”¨çš„ï¼Œå¯ä»¥é€‰æ‹©no Use Babel alongside TypeScript (required for modern mode, auto-detected polyfills, transpiling JSX)? (Y/n) æ˜¯å¦è¦ç”¨babelç¼–è¯‘tsï¼Œä¸€èˆ¬tscã€babelå’±ä»¬é€‰babelï¼Œå› ä¸ºbabelå¸¦polyfillï¼Œä¼šæ‰“ä¸Šä¸€äº›è¡¥ä¸ Pick a linter / formatter config: (Use arrow keys) ESLint with error prevention only æ™®é€šeslint ESLint + Airbnb config eslint+çˆ±å½¼è¿è§„èŒƒ ESLint + Standard config eslint+æ ‡å‡†è§„èŒƒ ESLint + Prettier eslint+prettieræ ¼å¼åŒ–ï¼ˆcmsé¡¹ç›®ä¸­æˆ‘ç”¨çš„æ˜¯è¿™ä¸ªï¼‰ TSLint (deprecated) Where do you prefer placing config for Babel, ESLint, etc.? (Use arrow keys) é…ç½®æ–‡ä»¶è¦å­˜æ”¾å“ªç§å½¢å¼ In dedicated config files å•ç‹¬æ–‡ä»¶ In package.json æ”¾package.json è„šæ‰‹æ¶çš„æ¨¡å—åŒ–æ ·å¼å½“styleæ ‡ç­¾å…·æœ‰è¯¥scopedå±æ€§æ—¶ï¼Œå…¶CSSå°†ä½œç”¨åŸŸåŒ–å½“å‰ç»„ä»¶çš„å…ƒç´ ï¼ˆå®è´¨ä¸Šè„šæ‰‹æ¶ä¼šå¤„ç†åŠ ä¸Šdata-v-xxxxçš„å±æ€§ï¼‰ æˆ‘ä»¬é€šå¸¸åœ¨vue.config.jsé…ç½®è·¯å¾„åˆ«å module.exports = { devServer: { //è¿è¡Œåé»˜è®¤æ‰“å¼€æµè§ˆå™¨ open: true }, //publicPathä¸ºéƒ¨ç½²çš„é…ç½® publicPath: process.env.NODE_ENV === 'production' ? './' : '/', configureWebpack: { resolve: { // é…ç½®åˆ«å,å†…éƒ¨å…¶å®å·²ç»é…ç½®è¿‡ä¸€ä¸ªï¼Œå°±æ˜¯ '@':src // åœ¨cli3ä»¥ä¸Šç‰ˆæœ¬ï¼Œé…ç½®åˆ«åçš„å€¼å¯ä»¥å¼•ç”¨ä¹‹å‰é…ç½®è¿‡çš„åˆ«åï¼Œå¦‚'@/assets',ä¸è¿‡cli4å¥½åƒè¿™é‡Œç”¨ä¸äº†ã€‚ã€‚ alias: { 'assets': '@/assets', 'components': '@/components', 'view': '@/view' } } } } ä½†æ˜¯è¯¥åˆ«å @ åœ¨cssä¸­æ— æ³•ç›´æ¥ä½¿ç”¨ï¼Œéœ€è¦å˜æˆ ~@çš„å½¢å¼ï¼›è¿˜æœ‰ img æ ‡ç­¾çš„ srcä¸­ï¼Œä¹Ÿéœ€è¦ ~@çš„å½¢å¼ è¿è¡Œé¡¹ç›®æ ¹æ®é…ç½®çš„æç¤ºä¸º npm run serve å®è´¨ä¸Šä¼šæ‰§è¡Œnode_modulesä¸‹é¢çš„binç›®å½•çš„vue-cli-serviceæ–‡ä»¶å¤¹ä¸‹ä»£ç  é‡Œé¢çš„æ¯”å¦‚ const Service = require(../lib/Serive)ä¹Ÿä¸è¦è¢«æ¬ºéª—äº†ï¼Œå¹¶ä¸æ˜¯å½“å‰ç›®å½•ä¸‹çš„ ../ï¼Œè€Œæ˜¯å†…éƒ¨æœ‰ä¸€ä¸ªè½¯è¿æ¥ï¼Œä¼šå»æ‰¾åˆ°çœŸæ˜¯ä»£ç æ‰€åœ¨çš„ä½ç½®ï¼Œæ‰§è¡ŒçœŸå®çš„ä»£ç  5.Vue routerå‰åç«¯è·¯ç”±æ¦‚è¿°è·¯ç”±å°±æ˜¯ç½‘ç»œæŠŠä¿¡æ¯ä»æºåœ°å€ä¼ è¾“åˆ°ç›®çš„åœ°å€çš„æ´»åŠ¨ï¼Œè·¯ç”±å™¨ä¸»è¦ç»´æŠ¤ä¸€ä¸ªæ˜ å°„è¡¨ï¼ˆipåœ°å€å’Œmacåœ°å€çš„æ˜ å°„å…³ç³»ï¼‰ åç«¯æ¸²æŸ“æ˜¯å°†æ•°æ®åœ¨åç«¯å¤„ç†ç”Ÿæˆhtmlå‘ç»™æµè§ˆå™¨ï¼Œå‰ç«¯æ¸²æŸ“æ˜¯é€šè¿‡ajaxæ‹¿åˆ°æ•°æ®ï¼Œæ“ä½œdomèŠ‚ç‚¹ æ¸²æŸ“ui ï¼ˆç›¸å½“äºNode.jsé‡Œçš„æœåŠ¡å™¨æ¸²æŸ“å’Œå®¢æˆ·ç«¯æ¸²æŸ“ï¼‰ 1.åç«¯è·¯ç”±ï¼ˆåç«¯æ¸²æŸ“ï¼‰ï¼šæœåŠ¡å™¨å¤„ç†ä¸€ä¸ªurlæ˜ å°„ä¸€ä¸ªé¡µé¢ï¼Œé€šè¿‡æ­£åˆ™åŒ¹é…ï¼Œäº¤ç»™controllerè¿›è¡Œå¤„ç†ï¼Œç„¶åç”Ÿæˆhtmlç­‰æ•°æ®è¿”å›å‰ç«¯ 2.å‰åç«¯åˆ†ç¦»ï¼ˆå‰ç«¯æ¸²æŸ“ï¼‰ï¼š è¾“å…¥url å»é™æ€æœåŠ¡å™¨ï¼ˆå‰ç«¯æœåŠ¡å™¨ï¼‰é‡Œè·å– html + css + js æµè§ˆå™¨æ‰§è¡ŒJSä»£ç  -&gt; JSä»£ç ä¸­æœ‰APIè¯·æ±‚ï¼Œå»åˆ°APIæ¥å£æœåŠ¡å™¨ï¼ˆåç«¯æœåŠ¡å™¨ï¼‰ä¸­è·å–æ•°æ® éšç€Ajaxçš„å‡ºç°ï¼Œæœ‰äº†å‰åç«¯åˆ†ç¦»çš„å¼€å‘æ¨¡å¼ï¼Œå‰åç«¯åˆ†ç¦»æœ€å¤§çš„ä¼˜ç‚¹å°±æ˜¯è´£ä»»æ¸…æ™°ï¼Œåˆ†å·¥æ˜ç¡®ï¼Œå¹¶ä¸”åœ¨ç§»åŠ¨ç«¯ï¼ˆIOS/Androidï¼‰å‡ºç°åï¼Œåç«¯ä½¿ç”¨ä¹‹å‰ä¸€å¥—APIå³å¯ å‰ç«¯è·¯ç”± åœ¨å‰åç«¯åˆ†ç¦»ä¸­ï¼Œé™æ€èµ„æºæœåŠ¡å™¨æ”¾äº†å¥½å‡ å¥—çš„ HTML + CSS +JSï¼Œæ¯ä¸ªå¯¹åº”ä¸åŒçš„é¡µé¢ SPAé¡µé¢ï¼ˆå•é¡µé¢å¯Œåº”ç”¨ï¼‰ï¼šæ•´ä¸ªç½‘ç«™åªæœ‰ä¸€ä¸ªhtmlé¡µé¢ï¼ˆReactã€Vueï¼‰ è€Œåœ¨å‰ç«¯è·¯ç”±ä¸­ï¼š é™æ€èµ„æºæœåŠ¡å™¨åªæœ‰ä¸€ä¸ªhtmlï¼ˆç”šè‡³ä¹Ÿåªæœ‰ä¸€ä¸ªCSS + ä¸€ä¸ªJSï¼‰ ç½‘é¡µè·å–åˆ°é™æ€èµ„æºåï¼Œç”±å‰ç«¯è·¯ç”±é…ç½®æ˜ å°„å…³ç³»ï¼Œä¸€ä¸ªè·¯å¾„å¯¹åº”ä¸€ä¸ªç»„ä»¶ï¼ˆ/home -&gt; Home.vueï¼‰ ç‚¹å‡»urlï¼Œé€šè¿‡JSä»£ç åˆ¤æ–­ï¼Œä»é‚£ä¸ªè·å–çš„ä¸€ä¸ªé™æ€èµ„æºé‡Œå†æŠ½å–èµ„æºï¼Œç„¶åæ˜¾ç¤ºå‡ºæ¥ï¼ˆè¿™é‡ŒæŠ½å–çš„èµ„æºï¼Œå†vueé‡Œï¼Œç›¸å½“äºä¸€ä¸ªurlæ˜ å°„ä¸€ä¸ªç»„ä»¶ï¼Œä¸€ä¸ªç»„ä»¶å¯¹åº”ä¸€ä¸ªç½‘é¡µï¼‰ æ”¹å˜urlï¼Œä¾ç„¶æ˜¯é¡µé¢ä¸å‘ç”Ÿæ•´ä½“åˆ·æ–° urlçš„hash ä¸ºäº†æ”¹å˜urlï¼Œè€Œè®©ä¹Ÿé¡µé¢ä¸å‘ç”Ÿåˆ·æ–°ï¼Œå¯ä»¥ä½¿ç”¨ urlçš„hash æˆ–è€…html5 çš„ historyæ¨¡å¼ Pushï¼šé€šè¿‡window.location.hash = &#39;xxx&#39;æ›´æ”¹hrefï¼Œç½‘é¡µä¸ä¼šåˆ·æ–°ï¼ˆé»˜è®¤ï¼‰ï¼Œä¹Ÿå°±æ˜¯é‡å®šå‘ï¼ˆå¸¦æœ‰hashçš„å‰ç«¯è·¯ç”±ï¼Œä¼˜ç‚¹æ˜¯å…¼å®¹æ€§é«˜ï¼Œç¼ºç‚¹æ˜¯URLå¸¦#å·ä¸å¥½çœ‹ï¼‰ ç»§è€Œæ­¤æ—¶æˆ‘ä»¬å¯ä»¥é€šè¿‡ window.addEventListener(&quot;hashchange&quot;, fn) ç›‘å¬hashæ”¹å˜æ—¶å›è°ƒçš„äº‹ä»¶ hashï¼ˆ#ï¼‰æ˜¯URL çš„é”šç‚¹ï¼Œä»£è¡¨çš„æ˜¯ç½‘é¡µä¸­çš„ä¸€ä¸ªä½ç½®ï¼Œå•å•æ”¹å˜#åçš„éƒ¨åˆ†ï¼Œæµè§ˆå™¨åªä¼šæ»šåŠ¨åˆ°ç›¸åº”ä½ç½®ï¼Œä¸ä¼šé‡æ–°åŠ è½½ç½‘é¡µï¼Œä¹Ÿå°±æ˜¯è¯´ #æ˜¯ç”¨æ¥æŒ‡å¯¼æµè§ˆå™¨åŠ¨ä½œçš„ï¼Œå¯¹æœåŠ¡å™¨ç«¯å®Œå…¨æ— ç”¨ï¼ŒHTTPè¯·æ±‚ä¸­ä¹Ÿä¸ä¼šä¸åŒ…æ‹¬#ï¼›åŒæ—¶æ¯ä¸€æ¬¡æ”¹å˜#åçš„éƒ¨åˆ†ï¼Œéƒ½ä¼šåœ¨æµè§ˆå™¨çš„è®¿é—®å†å²ä¸­å¢åŠ ä¸€ä¸ªè®°å½•ï¼Œä½¿ç”¨â€åé€€â€æŒ‰é’®ï¼Œå°±å¯ä»¥å›åˆ°ä¸Šä¸€ä¸ªä½ç½®ï¼› Pushï¼šä¹Ÿå¯ä»¥é€šè¿‡history.pushState({}, &#39;&#39;, &#39;xxx&#39;)æ›´æ”¹hrefï¼Œè¿›è¡Œé‡å®šå‘ï¼ˆhistoryçš„å‰ç«¯è·¯ç”±ï¼Œç¼ºç‚¹æ˜¯å¦‚æœè¾“å…¥é”™è¯¯ç½‘å€ï¼ŒçœŸçš„ä¼šè·‘å»å’Œåç«¯è¦æ•°æ®ï¼Œç„¶åæˆ‘ä»¬å°±ä¼šçœ‹åˆ°ä¸€ä¸ªä¸å¥½çœ‹çš„404é¡µé¢ï¼Œéœ€è¦æˆ‘ä»¬å’Œåç«¯è°ƒèŠ‚è¯´è¦ä»–ç»™æˆ‘ä»¬æä¾›ä¸€ä¸ªæˆ‘ä»¬æå‰ç»™ä»–çš„å›ºå®šçš„htmlç•Œé¢ï¼‰ å¯ä»¥ä½¿ç”¨history.back()æˆ–è€…history.go(-1) åé€€åŠŸèƒ½è¿›è¡Œå›é€€ Pushï¼Œå…¥æ ˆé¡¶ï¼Œå¯å›é€€ Replaceï¼šè¿˜å¯ä»¥é€šè¿‡ window.replaceã€ history.replaceState({}, &#39;&#39;, &#39;xxx&#39;)æ¥æ›´æ”¹ï¼Œä¸å¯å›é€€ï¼ˆæ›¿æ¢æ‰åŸå…ˆæ ˆé¡¶çš„è·¯ç”±ï¼‰ åœ¨Vueå®ä¾‹ä¸­ä½¿ç”¨ this.$router.back() ä¹Ÿå¯ä»¥å®ç°å›é€€ ï¼ˆæºç ä¸Šé™¤äº†hashã€historyã€å…¶å®è¿˜æœ‰ä¸€ä¸ªabstractæ¨¡å¼ï¼‰ vue-routerå…³äºurlæ”¹åŠ¨çš„é—®é¢˜ ç”±äºé»˜è®¤æ˜¯ä½¿ç”¨hashæ”¹åŠ¨urlï¼Œå¦‚æœæƒ³è¦æ”¹æˆHtml5çš„historyæ¨¡å¼ï¼Œåˆ™åœ¨routerå¯¹è±¡é‡Œåˆ©ç”¨modeå±æ€§è¿›è¡Œä¿®æ”¹ const router = new Router({ routes, mode: 'history', LinkActiveClass: 'active' //å¯ä»¥æŠŠrouter-linkå½“å‰è¢«é€‰ä¸­ï¼ˆç‚¹å‡»ï¼‰çš„æ ‡ç­¾çš„ç±»åï¼Œæ”¹ä¸ºactive }) åŸºæœ¬ä½¿ç”¨ç›®å‰ä¸‰å¤§æ¡†æ¶éƒ½æœ‰è‡ªå·±çš„è·¯ç”±å®ç°ï¼šAngularçš„ngRouterã€Reactçš„ReactRouterã€Vueçš„vue-router å®‰è£…ï¼š(æˆ–è€…è„šæ‰‹æ¶é€‰æ‹©çš„æ—¶å€™ï¼Œå¯ä»¥è‡ªåŠ¨å¸®ä½ å®‰è£…è·¯ç”±ï¼Œå¹¶ä¸”ä»¥ä¸‹æ­¥éª¤ä¸ç”¨å®æ–½) npm install vue-router --save äºsrcæ–‡ä»¶å¤¹é‡Œåˆ›å»º routeræ–‡ä»¶å¤¹ -&gt; index.js 1.é€šè¿‡Vue.use(æ’ä»¶)ï¼Œæ¥å®‰è£…æ’ä»¶ ï¼ˆåœ¨vueå†…éƒ¨æ‰§è¡Œäº†æ’ä»¶.installæ–¹æ³•ï¼‰ 2.åˆ›å»ºè·¯ç”±å¯¹è±¡ï¼Œrouteså±æ€§ç”¨äºé…ç½®è·¯ç”±å’Œç»„ä»¶çš„æ˜ å°„å…³ç³» 3.å°†routerå¯¹è±¡ä¼ å…¥Vueå®ä¾‹å½“ä¸­ import Router from 'vue-router' import Vue from 'vue' Vue.use(Router); const routes = []; const router = new Router({ routes }) export default router; router ä¸º Vueçš„ è·¯ç”±å±æ€§ï¼Œç›´æ¥èµ‹å€¼å³å¯ //main.js import Vue from 'vue' import App from './App' import router from './router' //è‡ªåŠ¨æ‰¾åˆ°è¯¥ç›®å½•ä¸‹çš„indexæ–‡ä»¶ Vue.config.productionTip = false new Vue({ el: '#app', router, render: h => h(App) }) ä½¿ç”¨ 1.åœ¨componentsæ–‡ä»¶å¤¹é‡Œæ–°å»ºç»„ä»¶ å¦‚ï¼š home.vue å’Œ about.vueï¼Œé‡Œé¢è‡ªå·±é€‚é…å¥½template å’Œ script 2.åœ¨routesé‡Œç¼–å†™æ˜ å°„å…³ç³»ï¼Œä¸€ä¸ªå¯¹è±¡å¯¹åº”ä¸€ä¸ªæ˜ å°„å…³ç³» 3.å¯ä»¥é€šè¿‡ &quot;/:pathMatch(.*)&quot; åŒ¹é…æ‰¾ä¸åˆ°è·¯å¾„å¡«è¡¥çš„ç»„ä»¶ï¼ˆ404 not foundï¼‰ï¼Œè€Œå¯¹äºæ­¤æ—¶åŒ¹é…ä¸åˆ°æ—¶æ‹¿åˆ°çš„è·¯å¾„å‚æ•°ï¼Œé€šè¿‡ $route.params.patchMathæ‹¿åˆ° url ä¸­å‡ºç° path,åˆ™æ˜¾ç¤ºè¯¥å¯¹è±¡é‡Œçš„ç»„ä»¶component import Home from '../components/home' import About from '../components/about' const routes = [ { path: '/home', component: Home }, { path: '/about', component: About }, { path: '/:pathMatch(.*)', component: NotFound } ]; 3.é€šè¿‡&lt;router-link&gt;å’Œ&lt;router-view&gt;ä½¿ç”¨è·¯ç”±: vue-routeræ¨¡å—æºç ä¸­ï¼Œæ³¨å†Œäº†å…¨å±€ç»„ä»¶ RouterView å’Œ RouterLink æ‰€ä»¥å¯ä»¥ä½¿ç”¨è¿™ä¸¤ä¸ªæ ‡ç­¾ ç”±äºè¿™é‡Œæˆ‘ä»¬æŠŠVueå®ä¾‹çš„æ¸²æŸ“å±æ€§ç»‘å®šäº† App.vue çš„ç»„ä»¶å¯¹è±¡ï¼Œæˆ‘ä»¬æŠŠ&lt;router-link&gt;å’Œ&lt;router-view&gt;æ·»åŠ è‡³ App.vueç»„ä»¶çš„templateä¸­ä½¿ç”¨ &lt;template> &lt;div id=\"app\"> &lt;!-- &lt;router-link >æ˜¯Vuerouterå·²ç»æ³¨å†Œçš„çš„å†…ç½®æ ‡ç­¾ï¼Œæœ€ç»ˆä¼šè¢«æ¸²æŸ“æˆaæ ‡ç­¾ --> &lt;router-link to=\"/home\">é¦–é¡µ&lt;/router-link> &lt;router-link to=\"/about\">å…³äº&lt;/router-link> &lt;!-- &lt;router-view>æ˜¯Vuerouterå·²ç»æ³¨å†Œçš„ï¼Œå†³å®šè·¯ç”±çš„é¡µé¢æ¸²æŸ“ --> &lt;router-view>&lt;/router-view> &lt;/div> &lt;/template> é…ç½®é¦–é¡µ const routes = [ { path: '/', // redirect é‡å®šå‘ redirect: '/home' } ]; router-linkçš„å…¶ä»–å±æ€§çš„è¡¥å…… toå±æ€§ï¼šå†™ä¸Šè·¯å¾„ï¼Œç‚¹å‡»ååˆ™ä¼šæŠŠç½‘é¡µçš„urlè¿›è¡Œè·¯å¾„çš„æ”¹åŠ¨ï¼Œç„¶årouter-viewå°±ä¼šæ ¹æ®è¿™ä¸ªè·¯å¾„æ¸²æŸ“ç½‘é¡µ tagå±æ€§ï¼šé»˜è®¤æœ€ç»ˆæ¸²æŸ“ä¸ºä¸º a æ ‡ç­¾ï¼Œtag=&quot;button&quot; åˆ™æ¸²æŸ“ä¸ºbuttonæ ‡ç­¾ replaceå±æ€§ï¼šå¦‚æœå½“å‰çš„routerå¯¹è±¡ä¸­modeå±æ€§ä¸º â€˜historyâ€™ï¼Œå¢åŠ è¯¥å±æ€§ï¼Œåˆ™urlçš„æ”¹å˜æ–¹æ³•æ”¹ä¸ºï¼š history.replaceState() router-linkçš„åŸç†ï¼š &lt;template> &lt;div id=\"app\"> &lt;button @click=\"homeClick\">é¦–é¡µ&lt;/button> &lt;button @click=\"aboutClick\">å…³äº&lt;/button> &lt;router-view>&lt;/router-view> &lt;/div> &lt;/template> &lt;script> export default { name: \"App\", methods: { // é€šè¿‡ä»£ç ä¿®æ”¹è·¯å¾„ // vue-routeræºç å¾€æ‰€æœ‰ç»„ä»¶é‡Œéƒ½æ·»åŠ äº†$routerå±æ€§ // historyçš„pushStatusï¼Œ push => pushStatus // ä½†æ˜¯è¿ç»­ç‚¹å‡»ä¼šæŠ¥é”™ï¼Œå¯ä»¥è¯•ä¸€è¯•this.$router.push('home').catch(err => err) homeClick() { this.$router.push(\"/home\"); }, aboutClick() { this.$router.push(\"/about\"); }, }, }; &lt;/script> //é€‰æ‹©hashçš„mode $router.push() --> HashHistory.push() --> History.transitionTo() --> History.updateRoute() --> {app._route = route} --> vm.render() 1 $router.push() //è°ƒç”¨æ–¹æ³• 2 HashHistory.push() //æ ¹æ®hashæ¨¡å¼è°ƒç”¨,è®¾ç½®hashå¹¶æ·»åŠ åˆ°æµè§ˆå™¨å†å²è®°å½•ï¼ˆæ·»åŠ åˆ°æ ˆé¡¶ï¼‰ //ï¼ˆå…¶å®ä¹Ÿå°±æ˜¯window.location.hash= XXXï¼‰ 3 History.transitionTo() //ç›‘æµ‹æ›´æ–°ï¼Œæ›´æ–°åˆ™è°ƒç”¨History.updateRoute() 4 History.updateRoute() //æ›´æ–°è·¯ç”± 5 {app._route= route} //æ›¿æ¢å½“å‰appè·¯ç”± 6 vm.render() //æ›´æ–°è§†å›¾ è·¯ç”±nameå±æ€§ è·¯æœ‰è®°å½•ç‹¬ä¸€æ— äºŒçš„åç§° å®ƒå¯ä»¥ä¾›ç»™ keep-alive çš„ Propsä½¿ç”¨ï¼Œå¯¹åç§°è¿›è¡ŒåŒ¹é… const routes = [ { path: '/', name: 'home', redirect: '/home' }, ]; æ­¤æ—¶å¯ä»¥é€šè¿‡this.$routeè·å– ä¸æ­¤åŒæ—¶ï¼Œå½“å­è·¯ç”±è¿›è¡Œè·¯ç”±åµŒå¥— + åŒ¹é…æ˜¯ä¹Ÿéœ€è¦å¯¹åº”è¿™ä¸ªnameï¼Œä¸€èˆ¬å»ºè®®nameå’Œè·¯ç”±è·¯å¾„åå­—ä¿æŒä¸€è‡´æ¯”å¦‚ { path: '/home', name: \"home\" component: Home, children: [ { path: 'message', name: \"message\" component: HomeMessage } ] }, è·å–è·¯ç”±åˆ—è¡¨ å¦‚æœè·¯ç”±è·³è½¬å‡ºç°é—®é¢˜ï¼Œå¯ä»¥æŸ¥çœ‹å½“å‰è·¯ç”±åˆ—è¡¨æ˜¯å¦è·¯ç”±å·²ç»æ³¨å†Œ æ­¤æ—¶å¯ä»¥ä½¿ç”¨API getRoutes getRoutes(): RouteRecord[] console.log(router.getRoutes()) å…¶ä»–çŸ¥è¯†ç‚¹åŠ¨æ€è·¯ç”± æŸäº›æƒ…å†µä¸‹ï¼Œä¸€ä¸ªé¡µé¢çš„pathæ˜¯ä¸ç¡®å®šçš„ï¼Œæ¯”å¦‚æˆ‘å¸Œæœ›æˆ‘çš„è·¯å¾„æ˜¯ /user/aaa æˆ– /user/bbb /user/:id è¿™ç§pathå’ŒComponentçš„åŒ¹é…å…³ç³»ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸ºåŠ¨æ€è·¯ç”±ï¼ˆä¹Ÿæ˜¯è·¯ç”±ä¼ é€’æ•°æ®çš„ä¸€ç§æ–¹å¼ï¼‰ åŠ¨æ€è·¯ç”±çš„ç»‘å®šï¼šæ–°å»ºä¸€ä¸ªuser.vueæ–‡ä»¶ï¼Œç„¶åæŠŠvueæ–‡ä»¶æ˜ å°„åˆ°è·¯ç”±çš„jsæ–‡ä»¶ä¸­ï¼ˆrouterçš„index.jsï¼‰ &lt;template> &lt;div> &lt;h2>ç”¨æˆ·ç•Œé¢&lt;/h2> &lt;h2>{{ userId }}&lt;/h2> &lt;/div> &lt;/template> &lt;script> export default { name: \"User\", computed: { // paramsæ˜¯å‚æ•°çš„æ„æ€ userId() { //è¿™é‡Œçš„userIdå¯¹åº”çš„æ˜¯æ˜ å°„æ—¶çš„/:userId return this.$route.params.userId; }, }, }; &lt;/script> import User from '../components/user' const routes = [ { path: '/user/:userId', component: User } ]; æ¥ç€åœ¨å¤§ç»„ä»¶app.vueä¸­ä½¿ç”¨è¯¥æ¨¡æ¿ &lt;router-link :to=\"'/user/' + userId\" tag=\"button\">ç”¨æˆ·&lt;/router-link> æˆ–è€…åˆ©ç”¨äº‹ä»¶è¿›è¡Œè·³è½¬+ä¼ é€’params this.$router.push(\"/detail/\" + userId); åœ¨app.vueå¯¼å‡ºçš„å®ä¾‹å¯¹è±¡é‡Œæ·»åŠ ç›¸åº”çš„dataå±æ€§ï¼š data() { return { userId: \"zhangsan\" }; }, è·¯ç”±æ‡’åŠ è½½ ç”±äºæ‰“åŒ…æ—¶ï¼Œé™¤äº†å…¶ä»–ä¸€äº›æ–‡ä»¶ï¼Œä¸»è¦çš„éƒ¨åˆ†ä¸¢å­˜æ”¾äºä¸€ä¸ªjså½“ä¸­ï¼Œç„¶ååœ¨è¯·æ±‚é™æ€èµ„æºæœåŠ¡å™¨æ—¶ï¼Œå¯èƒ½å› ä¸ºæ–‡ä»¶å¤ªå¤§ï¼Œå¯¼è‡´ç¬¬ä¸€æ¬¡è¯·æ±‚èµ„æºæ—¶ï¼ˆå³é‚£ä¸€ä¸ªä¸»è¦çš„jsæ–‡ä»¶ï¼‰ï¼ŒèŠ±è´¹è¿‡é•¿çš„æ—¶é—´ï¼Œå¯èƒ½åœ¨è¯·æ±‚è¿‡ç¨‹ï¼Œæµè§ˆå™¨å‡ºç°çŸ­æš‚çš„ç©ºç™½ã€‚ vueæ­å»ºè„šæ‰‹æ¶æ—¶ï¼Œå¯¹jsã€cssæ–‡ä»¶ç­‰è¿›è¡Œäº†åˆ†åŒ… npm run build /dist/static/js æ–‡ä»¶ä¸­ app.xxx.js æ˜¯ä¸šåŠ¡ä»£ç  ã€vendor.xxx.jsæ˜¯æä¾›å•†/ç¬¬ä¸‰æ–¹åŒ…çš„æºç ã€mainfest.xxx.jsæ˜¯ä¸ºæ‰“åŒ…çš„ä»£ç åšåº•å±‚æ”¯æ’‘ï¼ˆè®©æµè§ˆå™¨è¯†åˆ«ES6ã€commonJSè¯­æ³•ç­‰ï¼‰ å½“æ‰“åŒ…æ„å»ºåº”ç”¨æ—¶ï¼ŒJavaScriptåŒ…ä¼šå˜å¾—ç‰¹åˆ«å¤§ï¼Œå¦‚æœæˆ‘ä»¬æŠŠä¸åŒè·¯ç”±ç”±å¯¹åº”çš„ç»„ä»¶åˆ†å‰²æˆä¸åŒåŒä»£ç å—ï¼Œç„¶åå½“è·¯ç”±è¢«è®¿é—®æ—¶æ‰åŠ è½½å¯¹åº”ç»„ä»¶ï¼Œè¿™æ ·æ‰ä¼šæ›´åŠ é«˜æ•ˆï¼ˆé‡‡å–ä¸€ä¸ªè·¯ç”±æ‰“åŒ…ä¸€ä¸ªjsæ–‡ä»¶çš„æ–¹æ³•ï¼Œå…ˆå‘é™æ€èµ„æºæœåŠ¡å™¨è¯·æ±‚å½“å‰æœ€éœ€è¦çš„jsæ–‡ä»¶ï¼‰ æ‡’åŠ è½½ï¼šç”¨åˆ°æ—¶ï¼Œå†åŠ è½½ äºrouteræ–‡ä»¶å¤¹çš„index.jsä¸­æ¯ä¸ªåŠ è½½ä¿®æ”¹ä¸ºå‡½æ•°çš„å½¢å¼ // æ‡’åŠ è½½ const Home = () => import('../components/home'); const About = () => import('../components/about'); const User = () => import('../components/user'); const routes = [ { path: '/', redirect: '/home' }, { path: '/home', component: Home }, { path: '/about', component: About }, { path: '/user/:userId', component: User } ]; è·¯ç”±åµŒå¥—å¦‚æœæƒ³è¦è¿›è¡Œè·¯ç”±ç»†åˆ†ï¼ˆæ¯”å¦‚è¿›å…¥ /home ä¹‹åï¼Œè¿˜æƒ³è¦åœ¨è¿›å…¥ /home/message ï¼‰ï¼Œåˆ™å½¢æˆäº†è·¯ç”±åµŒå¥— åµŒå¥—çš„å®ç°ï¼š åˆ›å»ºç›¸åº”çš„å­ç»„ä»¶ï¼Œå¹¶ä¸”åœ¨è·¯ç”±æ˜ å°„ä¸­é…ç½®ç›¸åº”çš„å­è·¯ç”± åœ¨ç»„ä»¶å†…éƒ¨å†æ¬¡ä½¿ç”¨ &lt;router-view&gt;æ ‡ç­¾ ä»¥ä¸‹æ“ä½œä½œä¸ºä¾‹å­è¿›è¡Œè·¯ç”±åµŒå¥— æ–°å»ºä¸¤ä¸ªvueæ–‡ä»¶ï¼ˆç”¨äºåµŒå¥—åœ¨homeè·¯ç”±ä¸Šï¼‰ åœ¨è·¯ç”±çš„jsæ–‡ä»¶ä¸­çš„routesæ•°ç»„é‡Œï¼Œæ¯ä¸ªå¯¹è±¡éƒ½å¯ä»¥æœ‰ä¸€ä¸ªchildrenå±æ€§ï¼Œé‡Œé¢å¯ä»¥ä¿å­˜åµŒå¥—çš„è·¯ç”± const HomeNews = () => import('../components/HomeNews') const HomeMessage = () => import('../components/HomeMessage') { path: '/home', component: Home, children: [ { path: '', redirect: 'news' }, {// å­è·¯ç”±ä¸éœ€è¦åŠ  '/' path: 'news', component: HomeNews }, { path: 'message', component: HomeMessage } ] }, ç„¶åå†homeç»„ä»¶ä¸­æ·»åŠ  router-view è¿›è¡Œå­è·¯ç”±é¡µé¢æ¸²æŸ“ &lt;template> &lt;div> &lt;h2>é¦–é¡µ&lt;/h2> &lt;!-- è¿™é‡Œéœ€è¦ç»™å®Œæ•´çš„è·¯å¾„ï¼Œ ä¸èƒ½ç›´æ¥to=\"/news\" --> &lt;router-link to=\"/home/news\" tag=\"button\">æ–°é—»&lt;/router-link> &lt;router-link to=\"/home/message\" tag=\"button\">ä¿¡æ¯&lt;/router-link> &lt;router-view>&lt;/router-view> &lt;/div> &lt;/template> å‚æ•°ä¼ é€’ä»ä¸€ä¸ªè·¯ç”±é¡µé¢è·³è½¬åˆ°å¦å¤–ä¸€ä¸ªè·¯ç”±é¡µé¢æ—¶ï¼Œæˆ‘ä»¬å¯èƒ½å¸Œæœ›ä¼ é€’ä¸€äº›æ¶ˆæ¯ ä¼ é€’å‚æ•°ä¸»è¦æœ‰ä¸¤ç§ç±»å‹ï¼šparamså’Œquery paramsç±»å‹ï¼šå¦‚åŠ¨æ€è·¯ç”±çš„é…ç½® /router/:å‚æ•°å ä¼ é€’æ–¹å¼ï¼šåœ¨é…ç½®è·¯ç”±æ˜ å°„æ—¶ï¼Œpathåé¢è·Ÿä¸Šå“åº”çš„å€¼è¿›è¡Œæ¥æ”¶å£°æ˜ è·¯ç”±è·¯å¾„å/:å‚æ•°åï¼› æ¥ç€åœ¨ç»„ä»¶çš„router-linkçš„toå±æ€§æ·»åŠ å‚æ•°è¿›è¡Œä¼ é€’ / æˆ–è€…åˆ©ç”¨this.$router.push(&quot;/detail/&quot; + userId)è¿›è¡Œè¿›è¡Œè·³è½¬ å½“ç„¶ä¼ é€’å¤šä¸ªå‚æ•°è¿˜å¯ä»¥ï¼š è·¯ç”±è·¯å¾„å/:å‚æ•°å/è·¯ç”±è·¯å¾„å2/:å‚æ•°å2 è¿›è¡Œé‡å  ä¼ é€’åå½¢æˆçš„è·¯å¾„ /router/123ï¼Œ /router/abcç­‰ å­ç»„ä»¶é€šè¿‡ this.$route.params.å‚æ•°åè·å–å‚æ•° queryç±»å‹ï¼š æ­£å¸¸è·¯ç”±é…ç½®æ–¹å¼ ä¼ é€’æ–¹å¼ï¼šå¯¹è±¡ä¸­ä½¿ç”¨queryçš„keyä½œä¸ºä¼ é€’æ–¹å¼ ä¼ é€’åå½¢æˆçš„è·¯å¾„ï¼š /router?id=123, /router?id=abc åœ¨æ€»ç»„ä»¶ app.vue ä¸­è¿›è¡Œé…ç½® &lt;router-link :to=\"{ path: '/Profile', query: { name: 'Allen', age: 18, heigh: 1.88 } }\" tag=\"button\"> æ¡£æ¡ˆ&lt;/router-link> æˆ–è€…åˆ©ç”¨äº‹ä»¶è¿›è¡Œè·³è½¬+ä¼ é€’queryï¼ˆrouter.pushå¯ä»¥ä¼ å…¥ä¸€ä¸ªå¯¹è±¡ï¼‰ äº‹ä»¶å(){ this.$router.push({ path:'/detail', query:{ name: 'Allen', age: 18, heigh: 1.88 } }) } è‹¥æƒ³åœ¨å­ç»„ä»¶çš„templateæ¨¡æ¿ä¸­ä¸­è·å–è¯¥å‚æ•°ï¼Œåˆ™ä½¿ç”¨ route.queryè¿›è¡Œè·å–ï¼ˆå¾—åˆ°ä¸€ä¸ªå¯¹è±¡ï¼Œé‡Œé¢å­˜å‚¨å‚æ•°ï¼‰ &lt;p>{{ $route.query }}&lt;/p> æ€»ç»“ï¼šå¤§é‡æ•°æ®ä½¿ç”¨queryï¼Œå› ä¸ºqueryä¼ è¿‡å»æ˜¯å¯¹è±¡ routerå’Œroute å¤§å‰æï¼šæ‰€æœ‰çš„ç»„ä»¶éƒ½ç»§æ‰¿vueç±»çš„åŸå‹ vue-routeræºç å¾€æ‰€æœ‰ç»„ä»¶é‡Œéƒ½æ·»åŠ äº†$routerå±æ€§ï¼ˆå¾€vueçš„åŸå‹ä¸ŠåŠ çš„ï¼Œç”¨çš„æ˜¯vue.prototypeåœ¨åŸå‹å¯¹è±¡ä¸Šæ·»åŠ ï¼‰ æ‰€ä»¥åœ¨ä»»ä½•ä¸€ä¸ªç»„ä»¶é‡Œï¼Œéƒ½å¯ä»¥ä½¿ç”¨ this.$routerè¿›è¡Œè·å– å‰ç«¯è·¯ç”±ä½¿ç”¨historyåˆ·æ–°é¡µé¢æ—¶ï¼Œrouter-linkçš„åŸç†ä¸­ä½¿ç”¨åˆ° $router.push(&quot;è·¯å¾„&quot;)ã€$router.replace(&quot;è·¯å¾„&quot;)ã€$router.go(-1)ï¼Œrouterå¯¹è±¡ä¸ºè·¯ç”±æ–‡ä»¶å¤¹routerä¸­index.jså¯¼å‡ºçš„routerå¯¹è±¡ï¼ˆæœ‰ç‚¹å½“ä½œBOMçš„ history ä½¿ç”¨å†…å‘³å„¿äº† ï¼‰ è€Œ route æ˜¯å½“å‰æ´»è·ƒçš„è·¯ç”±ï¼Œvue-routeræºç å¾€æ‰€æœ‰ç»„ä»¶é‡Œä¹Ÿæ·»åŠ äº†$routeå±æ€§ï¼ˆå¾€vueçš„åŸå‹ä¸ŠåŠ çš„ï¼Œç”¨çš„æ˜¯vue.prototypeåœ¨åŸå‹å¯¹è±¡ä¸Šæ·»åŠ ï¼‰ æ‰€ä»¥åœ¨ä»»ä½•ä¸€ä¸ªç»„ä»¶é‡Œï¼Œéƒ½å¯ä»¥ä½¿ç”¨ this.$routeè¿›è¡Œè·å– å¯¼èˆªå®ˆå«åœ¨å‘ç”Ÿè·¯ç”±è·³è½¬æ—¶ï¼Œæˆ‘ä»¬æœ‰æ—¶éœ€è¦å»ç›‘å¬è¿™ä¸ªè·³è½¬äº‹ä»¶ï¼Œç„¶åå¯¹ç½‘é¡µè¿›è¡Œç›¸åº”çš„å˜åŒ–ï¼ˆæ¯”å¦‚ç½‘é¡µæ ‡é¢˜çš„æ”¹å˜ï¼‰ï¼›äº¦æˆ–è€…æ˜¯è¿›è¡Œæ‹¦æˆªï¼Œè®©ä»–è·³è½¬åˆ°ç™»é™†é¡µé¢ / æ³¨å†Œé¡µé¢ æ–¹æ³•ä¸€ï¼šä½¿ç”¨ç”Ÿå‘½å‘¨æœŸå‡½æ•° vueçš„ç”Ÿå‘½å‘¨æœŸå‡½æ•° created() {} æ¥å®šåˆ¶ï¼Œç¼ºç‚¹ï¼šä¸€ä¸ªåŠŸèƒ½çš„å®ç°éœ€è¦åœ¨å¤šä¸ªï¼ˆç”šè‡³æ˜¯æ¯ä¸ªï¼‰å­ç»„ä»¶ä¸Šå®šä¹‰ã€‚ æ–¹æ³•äºŒï¼šå¯¼èˆªå®ˆå« æ¯”å¦‚å…ˆç»™æ¯ä¸ªè·¯ç”±æ·»åŠ  å…ƒæ•°æ® meta ï¼ˆæè¿°æ•°æ®çš„æ•°æ®ï¼‰ const routes = [ { path: '/home', component: Home, meta: { title: 'é¦–é¡µ' }, children: [ { path: '', redirect: 'news' }, {// å­è·¯ç”±ä¸éœ€è¦åŠ  '/' path: 'news', component: HomeNews } ] } ] // å¯¼èˆªå®ˆå« router.beforeEach(function (to, from, next) { //ä»fromè·³è½¬åˆ°toï¼Œ fromå’Œtoéƒ½æ˜¯Routeç±»å‹ document.title = to.matched[0].meta.title; //æœ‰nextæ‰èƒ½å®ç°è·¯ç”±è·³è½¬ï¼Œä¸€å®šè¦åŠ ä¸Š next(); }) æˆ‘ä»¬å¯ä»¥é€šè¿‡this.$routeè·å–metaçš„æ•°æ® ä¹Ÿå¯ä»¥ä½¿ç”¨å¯¼èˆªå®ˆå«ï¼Œç›¸å½“äºaxiosçš„æ‹¦æˆªå™¨ï¼Œè¿™æ—¶å¯ä»¥ä½¿ç”¨to.meta.titleè·å–ï¼Œä½†æ˜¯å¦‚æœè·¯ç”±ä¸­ä½¿ç”¨äº†è·¯ç”±åµŒå¥—ï¼Œè¿˜å¾—æ ¼å¤–æ³¨æ„ä½¿ç”¨ to.matched[0].meta.titleè·å–ï¼Œä½¿ç”¨ä¸‹æ ‡ä¸º0çš„è¿›è¡Œè·å–ï¼Œåˆ™å½“ä½ æœªè¿›è¡ŒåµŒå¥—æ—¶ï¼Œè¿˜èƒ½æ­£å¸¸è·å–ï¼Œå› ä¸ºç¡®å®æ˜¯å½“å‰é€‰å®šè·¯ç”±çš„ç¬¬ä¸€ä¸ª next() è¿›è¡Œç®¡é“ä¸­çš„ä¸‹ä¸€ä¸ªé’©å­ã€‚å¦‚æœå…¨éƒ¨é’©å­æ‰§è¡Œå®Œäº†ï¼Œåˆ™å¯¼èˆªçš„çŠ¶æ€å°±æ˜¯ confirmed (ç¡®è®¤çš„)ã€‚ï¼ˆä»vue router4.xä»¥åä¸æ¨èä½¿ç”¨äº†ï¼Œé€šè¿‡è¿”å›å€¼æ§åˆ¶è·³è½¬ï¼Œè¯¦æƒ…è§æˆ‘çš„Vue3(ä¸Š)æ–‡ç« ï¼‰ toï¼šä¸€ä¸ªrouteå¯¹è±¡ï¼Œå³å°†è·³è½¬åˆ°çš„è·¯ç”±å¯¹è±¡ froï¼šä¸€ä¸ªrouteå¯¹è±¡ï¼Œè·³è½¬æºå¤´å¯¹è±¡ å®ˆå«åˆ†ç±»å…¨å±€å®ˆå«ï¼š router.beforeEach((to, from, next) =&gt; {}) å…¨å±€å‰ç½®å®ˆå«ï¼Œæ˜¯è·¯ç”±è·³è½¬ä¹‹å‰è¿›è¡Œçš„å›è°ƒã€‚æ¯ä¸€ä¸ªå¯¼èˆªè¢«è§¦å‘æ—¶ï¼Œè¢«è°ƒç”¨çš„æ€»æ˜¯å…¨å±€å‰ç½®å®ˆå« ç”¨çš„æœ€å¤šï¼Œimportantï¼ router.beforeResolve((to, from, next) =&gt; {})ï¼Œå…¨å±€è§£æå®ˆå«ï¼Œå’Œ beforeEachç±»ä¼¼ï¼ŒåŒºåˆ«æ˜¯å¯¼èˆªè¢«ç¡®è®¤ä¹‹å‰ï¼ŒåŒæ—¶åœ¨æ‰€æœ‰ç»„ä»¶å†…å®ˆå«å’Œå¼‚æ­¥è·¯ç”±ç»„ä»¶è¢«è§£æä¹‹åï¼Œæ‰è¢«è°ƒç”¨ router.afterEach((to, from) =&gt; {})ï¼Œåç½®é’©å­ï¼Œ ä¸éœ€è¦ä¸»åŠ¨è°ƒç”¨nextå‡½æ•°ï¼Œç­‰å¾…è·¯ç”±è·³è½¬ç»“æŸåä¹Ÿä¼šè°ƒç”¨å‡½æ•° è·¯ç”±ç‹¬äº«å®ˆå«ï¼ˆå†™åˆ°è·¯ç”±é‡Œé¢ï¼‰ beforeEnter const router = new VueRouter({ routes: [ { path: '/play', component: Play, beforeEnter: (to, from, next) => {} } ] }) ç»„ä»¶å†…è·¯ç”±å®ˆå« beforeRouteEnter(to, from, next) beforeRouteUpdate(to, from, next) beforeRouteLeave(to, from ,next) const Foo = { template: `...`, beforeRouteEnter (to, from, next) { // åœ¨æ¸²æŸ“è¯¥ç»„ä»¶çš„å¯¹åº”è·¯ç”±è¢« confirm å‰è°ƒç”¨ // ä¸ï¼èƒ½ï¼è·å–ç»„ä»¶å®ä¾‹ `this` // å› ä¸ºå½“å®ˆå«æ‰§è¡Œå‰ï¼Œç»„ä»¶å®ä¾‹è¿˜æ²¡è¢«åˆ›å»º }, beforeRouteUpdate (to, from, next) { // åœ¨å½“å‰è·¯ç”±æ”¹å˜ï¼Œä½†æ˜¯è¯¥ç»„ä»¶è¢«å¤ç”¨æ—¶è°ƒç”¨ // ä¸¾ä¾‹æ¥è¯´ï¼Œå¯¹äºä¸€ä¸ªå¸¦æœ‰åŠ¨æ€å‚æ•°çš„è·¯å¾„ /foo/:idï¼Œåœ¨ /foo/1 å’Œ /foo/2 ä¹‹é—´è·³è½¬çš„æ—¶å€™ï¼Œ // ç”±äºä¼šæ¸²æŸ“åŒæ ·çš„ Foo ç»„ä»¶ï¼Œå› æ­¤ç»„ä»¶å®ä¾‹ä¼šè¢«å¤ç”¨ã€‚è€Œè¿™ä¸ªé’©å­å°±ä¼šåœ¨è¿™ä¸ªæƒ…å†µä¸‹è¢«è°ƒç”¨ã€‚ // å¯ä»¥è®¿é—®ç»„ä»¶å®ä¾‹ `this` }, beforeRouteLeave (to, from, next) { // å¯¼èˆªç¦»å¼€è¯¥ç»„ä»¶çš„å¯¹åº”è·¯ç”±æ—¶è°ƒç”¨ // å¯ä»¥è®¿é—®ç»„ä»¶å®ä¾‹ `this` } } å¯¼èˆªæµç¨‹ï¼ˆå®˜ç½‘ï¼‰ å¯¼èˆªè¢«è§¦å‘ã€‚ åœ¨å¤±æ´»çš„ç»„ä»¶ï¼ˆfromç»„ä»¶ï¼‰é‡Œè°ƒç”¨ beforeRouteLeave å®ˆå«ã€‚ è°ƒç”¨å…¨å±€çš„ beforeEach å®ˆå«ã€‚ åœ¨é‡ç”¨çš„ç»„ä»¶é‡Œè°ƒç”¨ beforeRouteUpdate å®ˆå« (2.2+)ã€‚ åœ¨è·¯ç”±é…ç½®é‡Œè°ƒç”¨ beforeEnterã€‚ è§£æå¼‚æ­¥è·¯ç”±ç»„ä»¶ã€‚ åœ¨è¢«æ¿€æ´»çš„ç»„ä»¶ï¼ˆtoç»„ä»¶ï¼‰é‡Œè°ƒç”¨ beforeRouteEnterã€‚ è°ƒç”¨å…¨å±€çš„ beforeResolve å®ˆå« (2.5+)ã€‚ å¯¼èˆªè¢«ç¡®è®¤ã€‚ï¼ˆè¿›å…¥å¯¼èˆªï¼‰ è°ƒç”¨å…¨å±€çš„ afterEach é’©å­ã€‚ è§¦å‘ DOM æ›´æ–°ã€‚ è°ƒç”¨ beforeRouteEnter å®ˆå«ä¸­ä¼ ç»™ next çš„å›è°ƒå‡½æ•°ï¼Œåˆ›å»ºå¥½çš„ç»„ä»¶å®ä¾‹ä¼šä½œä¸ºå›è°ƒå‡½æ•°çš„å‚æ•°ä¼ å…¥ï¼ˆnextä¼ å…¥ä¸€ä¸ªå‚æ•°ï¼Œèƒ½æ‹¿åˆ°ç»„ä»¶å®ä¾‹instanceï¼‰ã€‚ keep-aliverouter-viewä¹Ÿæ˜¯ä¸€ä¸ªç»„ä»¶ï¼Œå¦‚æœç›´æ¥è¢«åŒ…åœ¨ keep-alive é‡Œé¢ï¼Œæ‰€æœ‰è·¯å¾„åŒ¹é…åˆ°çš„è§†å›¾ç»„ä»¶éƒ½ä¼šè¢«ç¼“å­˜ï¼ˆæ¯”å¦‚å®ç°åŠŸèƒ½ï¼šè¿›å…¥ /home ï¼Œ é»˜è®¤è¿›å…¥ /home/newsï¼Œå¦‚æœè·³è½¬åˆ° /home/messgae ä¹‹åï¼Œå†è·³è½¬åˆ°å…¶ä»–é¡µé¢ï¼Œæ­¤æ—¶å›åˆ° /home å¯ä»¥ç›´æ¥è¿›å…¥ä¸Šä¸€æ¬¡æŸ¥çœ‹çš„é¡µé¢/home/messgaeï¼Œè€Œä¸æ˜¯é»˜è®¤é¡µé¢/home/newsï¼‰ keep-alive æ˜¯Vueå†…ç½®çš„ä¸€ä¸ªç»„ä»¶ï¼Œå¯ä»¥ä½¿è¢«åŒ…å«çš„ç»„ä»¶ä¿ç•™çŠ¶æ€ï¼Œé¿å…é‡æ–°æ¸²æŸ“ï¼Œå®ƒçš„åŸç†æ˜¯é¿å…ç»„ä»¶è¢«é”€æ¯ï¼ˆæ‰€ä»¥ä½¿ç”¨keep-aliveä¹‹åï¼Œç»„ä»¶ä¸ä¼šè§¦å‘destoryed é’©å­å‡½æ•°ï¼‰ ç”Ÿå‘½å‘¨æœŸå‡½æ•° activated å’Œ deactivated åªæœ‰åœ¨ç»„ä»¶è¢«ä¿æŒäº† keep-alive æ—¶ï¼Œæ‰èƒ½è¢«æ­£å¸¸ä½¿ç”¨ï¼Œè¿™ä¸¤ä¸ªç”Ÿå‘½å‘¨æœŸåˆ†åˆ«æ˜¯é‡æ–°è¿›å…¥ / ç¦»å¼€è¯¥ç¼“å­˜ç»„ä»¶è¢«è§¦å‘ é‡Œé¢è¿˜æœ‰ä¸ª LRU ï¼ˆæœ€è¿‘æœ€ä¹…æœªç”¨ç®—æ³•ï¼ŒåŒæ“ä½œç³»ç»Ÿçš„LRUï¼‰ï¼Œç¼“å­˜çš„å¤ªå¤šè¶…è¿‡maxï¼Œå°±éœ€è¦åˆ é™¤æ‰ SPAï¼ˆå•é¡µé¢å¯Œåº”ç”¨ï¼‰å¸¸ç”¨ kepp-aliveï¼Œæé«˜æ€§èƒ½ï¼ &lt;keep-alive> &lt;router-view>&lt;/router-view> &lt;/keep-alive> //home.vueçš„scriptéƒ¨åˆ† export default { name: \"home\", data() { return { path: \"/home/news\" }; }, // ä½¿ç”¨ç»„ä»¶å†…å®ˆå«è®°å½•ç¦»å¼€æ—¶çš„è·¯å¾„ä¿¡æ¯ï¼Œå¹¶ä¸”å†ç”¨ç”Ÿå‘½å‘¨æœŸå‡½æ•°activatedå®ç°è·³è½¬ //activatedä¸ºå½“å‰é¡µé¢æ´»è·ƒçŠ¶æ€çš„é’©å­å‡½æ•° activated() { this.$router.push(this.path).catch((err) => {}); }, beforeRouteLeave(to, from, next) { this.path = this.$route.path; next(); }, }; keep-aliveæœ‰ä¸¤ä¸ªéå¸¸é‡è¦çš„å±æ€§ includeï¼šå­—ç¬¦ä¸²æˆ–æ­£åˆ™è¡¨è¾¾ï¼Œåªæœ‰åŒ¹é…çš„ç»„ä»¶æ‰ä¼šè¢«ç¼“å­˜ excludeï¼šå­—ç¬¦ä¸²æˆ–æ­£åˆ™è¡¨è¾¾ï¼Œä»»ä½•åŒ¹é…çš„ç»„ä»¶éƒ½ä¸ä¼šè¢«ç¼“å­˜ è¿˜æœ‰ä¸€ä¸ªmaxå±æ€§ maxï¼šæœ€å¤šå¯ä»¥ç¼“å­˜å¤šå°‘ä¸ªç»„ä»¶å®ä¾‹ï¼Œä¸€æ—¦è¾¾åˆ°è¿™ä¸ªæ•°å­—ï¼Œé‚£ä¹ˆç¼“å­˜çš„æœ€è¿‘æ²¡è¢«è®¿é—®çš„ç»„ä»¶å°±ä¼šè¢«é”€æ¯ æ³¨æ„ï¼šè¿™é‡Œçš„ â€œ,â€ä¸èƒ½åŠ ç©ºæ ¼ &lt;!-- ä½¿ç”¨keep-alive include=\"ç»„ä»¶çš„name\" --> &lt;keep-alive include=\"home,User\"> &lt;router-view>&lt;/router-view> &lt;/keep-alive> åŠ¨æ€ç»„ä»¶Componentå¯ä»¥çœ‹æˆç®€æ˜“ç‰ˆè·¯ç”±ç»„ä»¶ é¡µé¢åˆ‡æ¢ &lt;!-- æ–¹æ³•ä¸€ï¼šv-ifåˆ¤æ–­ --> &lt;template v-if=\"currentTab === 'home'\"> &lt;home /> &lt;/template> &lt;template v-else-if=\"currentTab === 'about'\"> &lt;about /> &lt;/template> &lt;template v-else-if=\"currentTab === 'category'\"> &lt;category /> &lt;/template> &lt;!-- æ–¹æ³•äºŒï¼šåŠ¨æ€ç»„ä»¶ --> &lt;component :is=\"currentTab\">&lt;/component> componentå°±æ˜¯vueçš„ä¸€ä¸ªå†…ç½®ç»„ä»¶ä»–æœ‰ä¸€ä¸ªç‰¹æ®Šçš„attributeï¼šis iså±æ€§è¦æ³¨å…¥ é€šè¿‡componentå‡½æ•°æ³¨å†Œçš„ç»„ä»¶ï¼ˆå…¨å±€æ³¨å†Œï¼‰ ä¸€ä¸ªç»„ä»¶å¯¹è±¡çš„componentå¯¹è±¡é‡Œæ³¨å†Œçš„ç»„ä»¶ï¼ˆå±€éƒ¨æ³¨å†Œï¼‰ åŒæ ·çš„ï¼Œæƒ³è¦è®©åŠ¨æ€ç»„ä»¶ä¿æŒåˆ‡æ¢ä¹‹åä¸è¢«é”€æ¯ï¼Œå¯ä»¥ä½¿ç”¨ keep-aliveå†…ç½®ç»„ä»¶è¿›è¡ŒåŒ…è£¹ &lt;keep-alive> &lt;component :is=\"currentTab\">&lt;/component> &lt;/keep-alive> 6.Vuexæ¦‚å¿µVuexæ˜¯ä¸€ä¸ªè½¬ä¸ºVue.jsåº”ç”¨ç¨‹åºå¼€å‘çš„çŠ¶æ€ç®¡ç†æ¨¡å¼ å…¶å®å¯ä»¥ç®€å•çœ‹æˆæŠŠéœ€è¦å¤šä¸ªç»„ä»¶å…±äº«çš„å˜é‡å…¨éƒ¨å­˜å‚¨åœ¨ä¸€ä¸ªå¯¹è±¡é‡Œé¢ï¼ˆçŠ¶æ€ï¼šå˜é‡ï¼‰ï¼Œç„¶åæŠŠè¿™ä¸ªå¯¹è±¡æ”¾åœ¨é¡¶å±‚çš„Vueå®ä¾‹ä¸­ï¼Œè®©å…¶ä»–ç»„ä»¶ä¸€èµ·ä½¿ç”¨ï¼ˆè€Œä¸”äº¤ç»™Vuexå¤§ç®¡å®¶æ¥ç®¡ç†ï¼Œå…¶æ•°æ®è¿˜æ˜¯å“åº”å¼çš„ï¼‰ æˆ‘ä»¬å…¶å®å¯ä»¥è‡ªå·±é€šè¿‡prototypeå°è£…å…±äº«çš„å˜é‡å¯¹è±¡ï¼Œä½†æ˜¯åšä¸åˆ°å“åº”å¼ å¤šç•Œé¢å…±äº«çš„ä¾‹å­ï¼šç”¨æˆ·ç™»é™†çŠ¶æ€ã€ç”¨æˆ·åç§°å¤´åƒã€åœ°ç†ä½ç½®ã€è´­ç‰©è½¦ä¿¡æ¯ å•é¡µé¢çŠ¶æ€ç®¡ç†ï¼š View(è§†å›¾templateéƒ¨åˆ†) -&gt; Actions(äº‹ä»¶è¡Œä¸º) -&gt; State(å˜é‡) -&gt; View å¤šé¡µé¢çŠ¶æ€ç®¡ç†ï¼šVuex åŸç† åˆ©ç”¨vueçš„æ’ä»¶æœºåˆ¶ï¼Œä½¿ç”¨Vue.use(vuex)æ—¶ï¼Œä¼šè°ƒç”¨vuexçš„installæ–¹æ³•ï¼Œè£…è½½vuex vuexæ˜¯åˆ©ç”¨vueçš„mixinæ··å…¥æœºåˆ¶ï¼Œåœ¨beforeCreateé’©å­å‰æ··å…¥vuexInitæ–¹æ³•ï¼ŒvuexInitæ–¹æ³•å®ç°äº†storeæ³¨å…¥vueç»„ä»¶å®ä¾‹ï¼Œå¹¶æ³¨å†Œäº†vuex storeçš„å¼•ç”¨å±æ€§$store è€Œå…¶ä¸­çš„å“åº”å¼ï¼Œstateæ˜¯é€šè¿‡åˆ›å»ºVueå®ä¾‹çš„dataæ¥ä¿å­˜stateï¼Œä¾æ—§æ˜¯ç”¨åˆ°äº†å‘å¸ƒç›‘å¬çš„åŒå‘ç»‘å®šï¼Œgettersåˆ™æ˜¯å€ŸåŠ©vueçš„è®¡ç®—å±æ€§computedå®ç°æ•°æ®å®æ—¶ç›‘å¬ ä½¿ç”¨å®‰è£… npm install vuex --save åˆå§‹åŒ– ç„¶åæ–°å»ºä¸€ä¸ªstoreæ–‡ä»¶å¤¹ï¼Œåœ¨é‡Œé¢åˆ›å»º index.js æ–‡ä»¶ï¼Œä»¥ä¸‹æ­¥éª¤å’Œåˆ›å»ºrouterè·¯ç”±æ’ä»¶å‡ ä¹ç›¸åŒ 1.é€šè¿‡Vue.use(æ’ä»¶)ï¼Œæ¥å®‰è£…æ’ä»¶ ï¼ˆåœ¨vueå†…éƒ¨æ‰§è¡Œäº†æ’ä»¶.installæ–¹æ³•ï¼‰ 2.åˆ›å»ºstoreå¯¹è±¡ 3.å°†storeå¯¹è±¡ä¼ å…¥Vueå®ä¾‹å½“ä¸­(åœ¨mian.jsé‡Œé¢)ï¼Œç±»ä¼¼äºæ·»åŠ äº†Vue.prototype.$store = storeï¼Œä½†æ˜¯å´å…·æœ‰å“åº”å¼èƒ½åŠ› import Vuex from 'vuex' import Vue from 'vue' // 1.å®‰è£…æ’ä»¶ Vue.use(Vuex) // 2.åˆ›å»ºå¯¹è±¡ const store = new Vuex.Store({ }) // 3.å¯¼å‡ºstoreå¯¹è±¡ export default store //main.js import Vue from 'vue' import App from './App' import store from './store' Vue.config.productionTip = false new Vue({ el: '#app', store, render: h => h(App) }) â€‹ VuexçŠ¶æ€ç®¡ç†å›¾ Devtools æ˜¯Vueå¼€å‘çš„ä¸€ä¸ªæµè§ˆå™¨æ’ä»¶ï¼Œç”¨æ¥è®°å½•æ¯ä¸€æ¬¡æ”¹å˜State éœ€è¦åœ¨æµè§ˆå™¨ä¸Šå®‰è£…ï¼šå¯ä»¥å»è°·æ­Œåº”ç”¨å•†åº—å®‰è£…Vue.js devtools æ’ä»¶ Vueå®˜æ–¹ä¸å»ºè®®Componentsç›´æ¥ä¿®æ”¹State ï¼Œä½†æ˜¯å®˜æ–¹å…è®¸Componentsç›´æ¥ä¿®æ”¹Mutations Actionsç”¨äºå¤„ç†å¼‚æ­¥æ“ä½œï¼ˆBackendï¼Œä¹Ÿå°±æ˜¯åç«¯ï¼‰ï¼ŒMutationsä¸€èˆ¬éƒ½æ˜¯å­˜å‚¨åŒæ­¥æ“ä½œ storeå¯¹è±¡å†…ç½®å±æ€§ï¼š stateï¼šä¿å­˜çŠ¶æ€ï¼ˆå˜é‡ï¼‰ï¼Œå…¶ä»–ç»„ä»¶å¯ä»¥é€šè¿‡ $store.state.å˜é‡åè¿›è¡Œè·å–ï¼ˆç±»ä¼¼dataï¼‰ gettersï¼šç±»ä¼¼äºç»„ä»¶é‡Œçš„è®¡ç®—å±æ€§computed, é‡Œé¢çš„å‡½æ•°é»˜è®¤å¯ä»¥ä¼ å…¥stateä½œä¸ºå‚æ•° mutationsï¼šå®šä¹‰ä¿®æ”¹çŠ¶æ€çš„æ–¹æ³•ï¼Œé‡Œé¢çš„å‡½æ•°é»˜è®¤å¯ä»¥ä¼ å…¥stateä½œä¸ºå‚æ•°ï¼ˆç±»ä¼¼methodsï¼‰ actionsï¼šåœ¨é‡Œé¢å¤„ç†å¼‚æ­¥æ“ä½œ modulesï¼šç”¨äºåˆ’åˆ†æ¨¡å— å…·ä½“æ“ä½œ const store = new Vuex.Store({ state: { counter: 10, }, mutations: { increment(state) { state.counter++; }, decrement(state) { state.counter--; }, actions:{}, getters: {}, modules:{} } }) ä½¿ç”¨å…±äº«å˜é‡çš„ç»„ä»¶ï¼Œè¿™æ—¶è°ƒç”¨å…±äº«çš„æ–¹æ³•Mutationséœ€è¦ç”¨commitæ¥æäº¤ &lt;template> &lt;div id=\"app\"> &lt;h2>{{ $store.state.counter }}&lt;/h2> &lt;button @click=\"add\">+&lt;/button> &lt;button @click=\"sub\">-&lt;/button> &lt;/div> &lt;/template> &lt;script> export default { name: \"App\", methods: { add() { this.$store.commit(\"increment\"); }, sub() { this.$store.commit(\"decrement\"); }, }, }; &lt;/script> Vuexæ¯ä¸ªå±æ€§è¯¦è§£Stateå•ä¸€çŠ¶æ€æ ‘vuexæ¨èåªåˆ›å»ºä¸€ä¸ªVuex.Storeå®ä¾‹ï¼Œè‹¥åˆ›å»ºå¤šä¸ªï¼Œæ—¥åä¸æ–¹ä¾¿è¿›è¡Œç»´æŠ¤ å•ä¸€çŠ¶æ€æ ‘å¯ä»¥æœ€ç›´æ¥åœ°æ‰¾åˆ°æŸä¸ªçŠ¶æ€ è¾…åŠ©å‡½æ•°è¾…åŠ©å‡½æ•° mapStateçš„ä½¿ç”¨ é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜æœ‰è¾…åŠ©å‡½æ•° mapGettersã€mapActionsã€mapMutations ç­‰ï¼ˆå¤§å®¶çš„ä½¿ç”¨æ–¹å¼éƒ½ä¸€æ ·çš„ï¼‰ å½“ä¸€ä¸ªç»„ä»¶éœ€è¦è·å–å¤šä¸ªçŠ¶æ€çš„æ—¶å€™ï¼Œå°†è¿™äº›çŠ¶æ€éƒ½å£°æ˜ä¸ºè®¡ç®—å±æ€§ä¼šæœ‰äº›é‡å¤å’Œå†—ä½™ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ mapState è¾…åŠ©å‡½æ•°å¸®åŠ©æˆ‘ä»¬ç”Ÿæˆè®¡ç®—å±æ€§ï¼Œè®©ä½ å°‘æŒ‰å‡ æ¬¡é”®ï¼š // åœ¨å•ç‹¬æ„å»ºçš„ç‰ˆæœ¬ä¸­è¾…åŠ©å‡½æ•°ä¸º Vuex.mapState import { mapState } from 'vuex' export default { // ... computed: { fullName(){ return xxx; }, ...mapState({ // ç®­å¤´å‡½æ•°å¯ä½¿ä»£ç æ›´ç®€ç»ƒ //count: state => state.count, // ä¼ å­—ç¬¦ä¸²å‚æ•° 'count' ç­‰åŒäº `state => state.count` countAlias: 'count', // ä¸ºäº†èƒ½å¤Ÿä½¿ç”¨ `this` è·å–å±€éƒ¨çŠ¶æ€ï¼Œå¿…é¡»ä½¿ç”¨å¸¸è§„å‡½æ•° countPlusLocalState (state) { return state.count + this.localCount } }) } } æ³¨æ„ï¼Œå¾—åˆ°çš„mapStateæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œè€Œé‡Œé¢å­˜å‚¨çš„æ˜¯ä¸€ä¸ªä¸€ä¸ªå‡½æ•°ï¼Œå› ä¸ºè®¡ç®—å±æ€§çš„æ¯ä¸€ä¸ªå±æ€§éƒ½æ˜¯ä¸€ä¸ªå‡½æ•°ï¼ˆåŒæ ·é€‚ç”¨ç»™mapGettersï¼‰ å½“æ˜ å°„çš„è®¡ç®—å±æ€§çš„åç§°ä¸ state çš„å­èŠ‚ç‚¹åç§°ç›¸åŒæ—¶ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ç»™ mapState ä¼ ä¸€ä¸ªå­—ç¬¦ä¸²æ•°ç»„ã€‚ computed: mapState([ // æ˜ å°„ this.count ä¸º store.state.count 'count' ]) å¦‚æœå®åœ¨moduleä¸­å¤„ç†ï¼Œå¯ä»¥é€šè¿‡ä¼ å…¥ æ¨¡å—å + stateçš„å±æ€§åå¾—åˆ° computed: { ...mapState(\"home\", [\"homeCounter\"]); // å¯¹åº”æ¨¡å—å + å±æ€§å } â€‹ ä½¿ç”¨gettersæ—¶ï¼Œè¿˜å¯ä»¥ä½¿ç”¨ï¼šmapGetters è¾…åŠ©å‡½æ•°ï¼Œå®ƒä»…ä»…æ˜¯å°† store ä¸­çš„ getter æ˜ å°„åˆ°å±€éƒ¨è®¡ç®—å±æ€§ï¼š æ­¤æ—¶ï¼Œæˆ‘ä»¬ä¾¿å¯ä»¥åœ¨å­ç»„ä»¶ç›´æ¥ä½¿ç”¨è¯¥æ•°æ®ï¼š&lt;div&gt;&lt;/div&gt; import { mapGetters } from 'vuex' export default { // ... computed: { // ä½¿ç”¨å¯¹è±¡å±•å¼€è¿ç®—ç¬¦å°† getter æ··å…¥ computed å¯¹è±¡ä¸­ ...mapGetters([ 'doubleCounter', 'doubleCountermore', 'add', // ... ]) } } åœ¨å­ç»„ä»¶ä½¿ç”¨Actionsæ—¶ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ï¼šmapActions è¾…åŠ©å‡½æ•°ï¼Œå°†ç»„ä»¶çš„ methods æ˜ å°„ä¸º store.dispatch è°ƒç”¨ï¼ˆéœ€è¦å…ˆåœ¨æ ¹èŠ‚ç‚¹æ³¨å…¥ storeï¼‰ï¼šï¼ˆæ­¤æ—¶ç”¨ this.æ–¹æ³•åå³å¯è°ƒç”¨ï¼‰ import { mapActions } from 'vuex' export default { // ... methods: { ...mapActions([ 'increment', // å°† `this.increment()` æ˜ å°„ä¸º `this.$store.dispatch('increment')` // `mapActions` ä¹Ÿæ”¯æŒè½½è·ï¼š 'incrementBy' // å°† `this.incrementBy(amount)` æ˜ å°„ä¸º `this.$store.dispatch('incrementBy', amount)` ]), ...mapActions({ add: 'increment' // å°† `this.add()` æ˜ å°„ä¸º `this.$store.dispatch('increment')` }) } } GettersåŸºæœ¬ä½¿ç”¨é‡Œé¢çš„å‡½æ•°é»˜è®¤å¯ä»¥ä¼ å…¥stateä½œä¸ºå‚æ•°ï¼Œä½†ä¹Ÿå¯ä»¥é»˜è®¤ä¼ å…¥ gatters å·²æœ‰çš„æ•°æ®ï¼ˆè‹¥ä¼ è¿›æ¥ï¼Œç¬¬ä¸€ä¸ªå‚æ•°ä¸ºstateï¼Œç¬¬äºŒä¸ªå‚æ•°ä¸ºgettersï¼‰ã€‚å¦‚æœè¦åœ¨ç»„ä»¶ä¸­ä¼ å…¥å‚æ•°ï¼Œåˆ™éœ€è¦æŠŠè¿”å›çš„å€¼æ”¹æˆè¿”å›ä¸€ä¸ªå‡½æ•° æœ‰ç‚¹åƒcomputed const store = new Vuex.Store({ state: { counter: 10, }, getters: { doubleCounter(state) { return state.counter * state.counter; }, doubleCountermore(state, getters) { return getters.doubleCounter + 1; }, add(state, getters) { return num => { return getters.doubleCountermore + num } } }, }) &lt;h2>{{ $store.getters.doubleCounter }}&lt;/h2> &lt;h2>{{ $store.getters.add(10) }}&lt;/h2> ActionåŸºæœ¬ä½¿ç”¨Actionç±»ä¼¼äºMutationï¼Œä½†æ˜¯æ˜¯ç”¨æ¥æ›¿ä»£Mutationè¿›è¡Œå¼‚æ­¥æ“ä½œçš„ï¼ˆå…¶å®ä¹Ÿå¯ä»¥æ¥æ›¿ä»£ä¸€äº›åŠŸèƒ½å¤æ‚çš„æ“ä½œï¼‰ å’ŒGetterã€Mutationä¸åŒï¼Œé»˜è®¤ä¼ å…¥çš„å‚æ•°ä¸æ˜¯stateï¼Œè€Œæ˜¯ contextï¼šä¸Šä¸‹æ–‡ï¼Œæ˜¯ä¸€ä¸ªå’Œstoreå®ä¾‹å‡æœ‰ç›¸åŒæ–¹æ³•çš„ä¸€ä¸ªcontextå¯¹è±¡ ï¼ˆåŒ…è£¹åœ¨Moduleé‡ŒActionsçš„contextåˆ™å’Œæœ€å¤–å±‚çš„storeä¸ä¸€æ ·ï¼Œå¤šäº†ä¸€ä¸ª rootStateã€rootGetters å±æ€§ ï¼‰ ä½†æ˜¯ä¹Ÿä¸æ”¯æŒåœ¨actioné‡Œç›´æ¥ä¿®æ”¹stateï¼Œå³ä¸æ”¯æŒ context.state.info.name = â€˜Mikasaâ€™ è¯¦æƒ…å…³ç³»å›¾å¯ä»¥çœ‹VuexçŠ¶æ€ç®¡ç†å›¾ï¼Œåœ¨actionä½¿ç”¨commitè¿›è¡Œæäº¤ -&gt; mutation ç¬¬äºŒä¸ªå‚æ•°å¯é€‰ï¼Œä¸ºä¼ å…¥çš„å¯¹è±¡payloadï¼Œç±»ä¼¼mutationçš„payload åœ¨ç»„ä»¶ä¸­è°ƒç”¨actionçš„å¼‚æ­¥æ–¹æ³•ï¼Œä½¿ç”¨ this.$store.dispatch(&quot;æ–¹æ³•å&quot;[, ä¼ å…¥å‚æ•°]); const store = new Vuex.Store({ state: { counter: 10, info: { name: 'Allen', age: 18, feature: 'å§‹ç¥–å·¨äºº' } }, mutations: { update(state) { Vue.set(state.info, 'address', 'å¸•æ‹‰è¿ªäºšå²›') } }, actions: { aupdate(context, payload) { setTimeout(() => { context.commit('update');// åŸæ¥æ˜¯åœ¨vueç»„ä»¶ä¸­ this.$store.commit console.log(payload); }, 1000); } }, }) //Vueå¯¹è±¡çš„methodså±æ€§é‡Œ update() { this.$store.dispatch(\"aupdate\", \"æˆ‘æ˜¯payload\"); }, ä½¿ç”¨Actionsæ—¶å¯ä»¥è¿”å›ä¸€ä¸ªPromise å½“ç„¶ï¼Œç¢°åˆ°äº†å¼‚æ­¥æ“ä½œï¼Œä¸”æƒ³è¦ç¡®è®¤å¼‚æ­¥æ“ä½œæ˜¯å¦å®Œæˆï¼Œå°‘ä¸äº†Promiseçš„ä¼˜é›…åŠ æˆï¼š actions: { aupdate(context, payload) { return new Promise((resolve, reject) => { setTimeout(() => { context.commit('update'); console.log(payload); resolve(); }, 1000); }) } }, update() { this.$store .dispatch(\"aupdate\", \"æˆ‘æ˜¯payload\") .then(() => { console.log(\"æ‰§è¡ŒæˆåŠŸï¼\"); }) .catch(() => { console.log(\"æ‰§è¡Œå¤±è´¥\"); }); }, Actionsæäº¤é£æ ¼ é™¤äº†ä¸Šè¿°çš„commitæäº¤æ–¹å¼ï¼ŒVueè¿˜æä¾›äº†å¦å¤–ä¸€ç§é£æ ¼ï¼Œå®ƒæ˜¯åŒ…å«typeå±æ€§çš„å¯¹è±¡ï¼Œè€Œä¼ å…¥çš„å‚æ•°å³ä½¿å¹¶ä¸éœ€è¦ä¼ é€’å¤šä¸ªï¼Œä½†ä¹Ÿéœ€è¦ï¼ˆè‡ªåŠ¨ï¼‰å˜æˆä¸€ä¸ªå¯¹è±¡ this.$store.dispatch({ type: \"aupdate\", // è¿™æ—¶ä¼ è¿‡æ¥çš„numå˜æˆä¸€ä¸ªå¯¹è±¡ num: num, }); æ­¤æ—¶mutationä¼ å…¥çš„æ˜¯å¯¹è±¡ï¼Œæ‰€ä»¥ä¹Ÿè¦å‘ç”Ÿç›¸åº”æ”¹å˜ const store = new Vuex.Store({ actions: { aupdate(constext, payload) { console.log(payload.num) } }, } ModuleåŸºæœ¬ä½¿ç”¨storeæ¨èstateå•ä¸€çŠ¶æ€æ ‘ã€ä½†æ˜¯stateé‡ŒåŒ…å«å¤ªå¤šæ•°æ®ä¼šæ˜¾å¾—ååˆ†è‡ƒè‚¿ ä¸ºæ­¤ï¼ŒVuexå…è®¸æˆ‘ä»¬è®²storeåˆ†å‰²æˆæ¨¡å—ï¼ˆModuleï¼‰ï¼Œæ¯ä¸ªæ¨¡å—æ‹¥æœ‰è‡ªå·±çš„stateã€mutationç­‰ const store = new Vuex.Store({ modules: { a: { state: {}, mutations: {}, actions: {}, getters:{} }, b: { state: {}, mutations: {}, actions: {}, getters:{} } } }) æˆ–è€…åœ¨storeçš„å¤–éƒ¨å®šä¹‰ moduleå¯¹è±¡ï¼Œç„¶åç›´æ¥åœ¨storeçš„modulesé‡Œé¢å¼•ç”¨å°±å¯ä»¥äº† const moduleA = { state:{}, mutations:{} } const store = new Vuex.Store({ modules: { a:moduleA } }) ä½¿ç”¨moduleæ³¨æ„äº‹é¡¹ï¼š åœ¨ç»„ä»¶ä¸­ä½¿ç”¨æ¨¡å—çš„stateæ•°æ®ï¼š $store.state.æ¨¡å—åç§°.çŠ¶æ€ &lt;h2>{{$store.state.a.name}}&lt;/h2> ç»„ä»¶ä¸­ä½¿ç”¨æ¨¡å—çš„mutationåˆ™ä½¿ç”¨æ–¹æ³•å’ŒåŸæ¥æ”¾åœ¨storeé‡Œä¸€æ ·ï¼Œåœ¨ç»„ä»¶ä¸­ç›´æ¥this.$store.commit(äº‹ä»¶ç±»å‹)å°±å¯ä»¥äº† gettersä¹Ÿæ˜¯ä¹ŸåŸæ¥æ”¾åœ¨storeé‡Œä¸€æ ·å»ä½¿ç”¨ï¼›å¦‚æœæ¨¡å—çš„getteræƒ³è¦ä½¿ç”¨åˆ°åŸæ¥çš„storeä¸­çš„stateï¼Œåˆ™æ­¤æ—¶æ¨¡å—çš„getterå¯ä»¥ä¼ å…¥ä¸‰ä¸ªå‚æ•°ï¼Œåˆ†åˆ«æ˜¯ï¼š è‡ªèº«çš„state getters storeçš„state storeçš„getters const moduleA = { state: { name: 'Armin' }, getters: { fullname(state, getters, rootState, rootGetters) { return state.name + rootState.counter } } } 4.å®ƒçš„actionsä¸­ context.commit(&#39;å‡½æ•°&#39;);çš„å½¢å¼ ï¼Œå‡½æ•°åªèƒ½commitæ¨¡å—ä¸­mutationsé‡Œé¢çš„å‡½æ•° actionsä¸­çš„contexté‡Œï¼ŒåŒ…å« rootGettersã€ rootStateï¼Œå¯ä»¥è·å–å½“å‰moduleä»¥ä¸Šçš„æ ¹çš„stateã€getters actionsä¸­ä½¿ç”¨commitæäº¤çš„æ—¶å€™ï¼ˆä½¿ç”¨ namespaced: trueçš„æ—¶å€™ ï¼‰ï¼Œå¯ä»¥é™„å¸¦ç¬¬ä¸‰ä¸ªå‚æ•°ï¼Œ{ root: true }ï¼Œè¡¨ç¤ºæäº¤çš„æ˜¯æ ¹rooté‡Œé¢çš„mutationsã€actionsã€‚ actions: { aupdate(context, payload) { setTimeout(() => { context.commit('update', null, { root: true }); }, 1000); } }, ä½†æ˜¯ä¸Šè¿°æ–¹æ³•ï¼Œæ¯”å¦‚ä½¿ç”¨gettersã€actionsçš„æ—¶å€™ï¼Œæ¨¡å—ä½¿ç”¨å’ŒåŸæ¥çš„rootä½¿ç”¨æ²¡æœ‰åŒºåˆ†ï¼Œè¿™æ ·éš¾ä»¥è¾¨åˆ«äº‹ä»¶æºå¤´ï¼Œis not good æ­¤æ—¶æˆ‘ä»¬å¯ä»¥ç»™æ¨¡å—å¢åŠ å±æ€§ï¼šnamespaced: trueï¼Œæ­¤æ—¶æ¨¡å—å°±å˜å¾—ç‹¬ç«‹äº†(æ— æ³•å’ŒåŸæ¥çš„ä½¿ç”¨æ–¹æ³•ä¸€æ ·) const moduleA = { namespaced: true; //.... } &lt;!-- &lt;h2>{{ $store.getters[\"æ¨¡å—å/æ¨¡å—ä¸‹gettersçš„æŸå±æ€§å\"] }}&lt;/h2> --> &lt;h2>{{ $store.getters[\"home/doubleHomeCounter\"] }}&lt;/h2> methods:{ homeIncrement(){ this.$store.commit(\"home/increment\"); //æ¨¡å—å/æ¨¡å—ä¸‹çš„mutationæ–¹æ³• this.$store.dispatch(\"home/actionIncrement\"); //æ¨¡å—å/æ¨¡å—ä¸‹actionæ–¹æ³• } } MutationåŸºæœ¬ä½¿ç”¨mutationsä½œä¸ºVuexçš„ä¸€ä¸ªå±æ€§ï¼Œä½†æ˜¯åŒ…å«çš„ä¸œè¥¿æ¯”è¾ƒå¤š å®˜æ–¹è®¤å¯ï¼šVuexçš„storeçŠ¶æ€çš„æ›´æ–°å”¯ä¸€æ–¹å¼ï¼šæäº¤Mutation mutationsé‡Œæ¯ä¸ªæ–¹æ³•å®Œæˆçš„äº‹ä»¶å°½é‡å•ä¸€ï¼ˆä¹Ÿå°±æ˜¯ä¸€ä¸ªæ–¹æ³•ï¼Œä¸è¦æœ‰å¯¹äºstateçš„å¤šç§ä¿®æ”¹åŠŸèƒ½ï¼‰ï¼Œæ–¹ä¾¿è·Ÿè¸ªDevtoolsçš„è·Ÿè¸ªï¼Œå¯ä»¥é€‰æ‹©æ”¾åœ¨Actionsé‡Œï¼Œç„¶åActioné‡Œçš„å‡½æ•°commitåˆ°ä¸åŒçš„mutationå‡½æ•°å¯¹stateä¿®æ”¹ Mutationä¸»è¦åŒ…æ‹¬ä¸¤éƒ¨åˆ†ï¼š å­—ç¬¦ä¸²çš„äº‹ä»¶ç±»å‹ ä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œè¯¥å›è°ƒå‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°å°±æ˜¯state æ¯”å¦‚ä¸Šè¿° ä½¿ç”¨ éƒ¨åˆ†çš„ä¾‹å­ä¸­ï¼ˆä»£ç æ”¾åœ¨äº†ä¸‹æ–¹ï¼‰ï¼Œincrementä¸ºäº‹ä»¶ç±»å‹ï¼Œ(state) {state.counter++;}ä¸ºå›è°ƒå‡½æ•° increment(state) { state.counter++; } ç„¶ååœ¨ç»„ä»¶ä¸­é€šè¿‡mutationæ›´æ–°è¿›è¡Œä½¿ç”¨ this.$store.commit(äº‹ä»¶ç±»å‹) mutationsä¼ å‚é—®é¢˜ï¼š é‡Œé¢çš„å‡½æ•°é»˜è®¤å¯ä»¥ä¼ å…¥stateä½œä¸ºå‚æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°ä¸ºstate ç¬¬äºŒä¸ªå‚æ•°ä¸ºå¤–éƒ¨ä¼ è¿›æ¥çš„å‚æ•°ï¼ˆå¦‚æœè¦ä¼ é€’å¤šä¸ªå‚æ•°ï¼Œåˆ™æˆ‘ä»¬å¯ä»¥ä»¥å¯¹è±¡çš„å½¢å¼è¿›è¡Œä¼ é€’ï¼‰ï¼Œå®ƒæœ‰ä¸ªä¸“ä¸šåè¯å« payloadï¼šè½½è· const store = new Vuex.Store({ mutations: { increment(state) { state.counter++; }, incrementCount(state, payload) { state.counter += payload; } }, //ç»„ä»¶çš„methods methods: { add() { this.$store.commit(\"increment\"); }, addCount(num) { this.$store.commit(\"incrementCount\", num); }, }, mutationsæäº¤é£æ ¼ é™¤äº†ä¸Šè¿°çš„commitæäº¤æ–¹å¼ï¼ŒVueè¿˜æä¾›äº†å¦å¤–ä¸€ç§é£æ ¼ï¼Œå®ƒæ˜¯åŒ…å«typeå±æ€§çš„å¯¹è±¡ï¼Œè€Œä¼ å…¥çš„å‚æ•°å³ä½¿å¹¶ä¸éœ€è¦ä¼ é€’å¤šä¸ªï¼Œä½†ä¹Ÿéœ€è¦ï¼ˆè‡ªåŠ¨ï¼‰å˜æˆä¸€ä¸ªå¯¹è±¡ this.$store.commit({ type: \"incrementCount\", // è¿™æ—¶ä¼ è¿‡æ¥çš„numå˜æˆä¸€ä¸ªå¯¹è±¡ num: num, }); æ­¤æ—¶mutationä¼ å…¥çš„æ˜¯å¯¹è±¡ï¼Œæ‰€ä»¥ä¹Ÿè¦å‘ç”Ÿç›¸åº”æ”¹å˜ const store = new Vuex.Store({ mutations: { incrementCount(state, payload) { state.counter += payload.num; } }, } Mutationså¸¸é‡ç±»å‹ å®šä¹‰å¸¸é‡æ˜¯å‡å°‘é”™è¯¯çš„åŸºæœ¬æ–¹æ³• åœ¨storeæ–‡ä»¶å¤¹é‡Œå®šä¹‰ä¸€ä¸ªjsæ–‡ä»¶ï¼Œæ¯”å¦‚ mutation-type.js ç”¨äºå­˜å‚¨å¸¸é‡åï¼Œç„¶ååœ¨å…¶ä»–æ–‡ä»¶é‡Œç”¨ importå¯¼å…¥ï¼Œç”¨å¸¸é‡åä»¥ [å¸¸é‡å]çš„å½¢å¼ æ›¿ä»£mutationsé‡Œçš„å‡½æ•°åï¼Œç„¶åå¼•ç”¨mutationå‡½æ•°çš„æ—¶å€™ï¼Œç»§ç»­å…ˆimportå¯¼å…¥å­˜å‚¨å¸¸é‡åçš„jsæ–‡ä»¶ï¼Œç›´æ¥å¼•ç”¨ this.$store.commit(å¸¸é‡å); å°±å¯ä»¥äº† è™½ç„¶è¿‡ç¨‹ååˆ†ç¹çï¼Œä½†æœ‰åˆ©äºé¡¹ç›®å¼€å‘åçš„ç»´æŠ¤æ‰¾é”™ MutationåŒæ­¥å‡½æ•° é€šå¸¸æƒ…å†µä¸‹ï¼ŒVuexè¦æ±‚æˆ‘ä»¬Mutationä¸­æ–¹æ³•å¿…é¡»æ˜¯åŒæ­¥æ–¹æ³• ä¸»è¦åŸå› æ˜¯æˆ‘ä»¬ä½¿ç”¨devtoolsæ—¶ï¼Œdevtoolså¯ä»¥å¸®åŠ©æˆ‘ä»¬æ•æ‰mutationçš„å¿«ç…§ ä½†å¦‚æœæ˜¯å¼‚æ­¥æ“ä½œï¼Œé‚£devtoolså°†ä¸èƒ½å¾ˆå¥½çš„è¿½è¸ªåˆ°è¿™ä¸ªæ“ä½œä»€ä¹ˆæ—¶å€™ä¼šè¢«å®Œæˆ Vuexå“åº”å¼åŸç†Vuexçš„storeä¸­çš„stateæ˜¯å“åº”å¼çš„ stateå…¶ä¸­æ¯ä¸ªçŠ¶æ€éƒ½æœ‰å¯¹åº”çš„ Dep -&gt; [Watcher]ï¼Œç›‘å¬å˜åŒ– åŒ…æ‹¬çŠ¶æ€é‡Œå¯¹è±¡çš„æ¯ä¸ªå±æ€§çš„å˜åŒ– ä½†è¿™è¦æ±‚æˆ‘ä»¬å¿…é¡»éµå®ˆVuexå¯¹åº”çš„ä¸€äº›è§„åˆ™ï¼š æå‰åœ¨storeåˆå§‹åŒ–æ‰€éœ€çš„å±æ€§ å½“ç»™stateå¯¹è±¡æ·»åŠ æ–°å±æ€§æ—¶ï¼Œä½¿ç”¨ä¸‹åˆ—æ–¹å¼ï¼š æ–¹å¼ä¸€ï¼šä½¿ç”¨Vue.set(obj, &#39;newProp&#39;, 123) æ–¹å¼äºŒï¼šç”¨æ–°å¯¹è±¡ç»™æ—§å¯¹è±¡é‡æ–°èµ‹å€¼ è¿™é‡Œå’Œæ•°ç»„çš„å“åº”åŸç†ä¸€æ ·ï¼Œæœ‰ä¸€äº›æ•°ç»„æ–¹æ³•ä¹Ÿä¸æ˜¯å“åº”çš„ï¼Œéœ€è¦å€ŸåŠ©å…¶ä»–æ–¹æ³•æ¥è¿›è¡Œå“åº”å¤„ç†ï¼ˆå¦‚ this.arr[0] = &#39;nothing&#39;; ï¼‰ åˆ é™¤å±æ€§çš„æ–¹å¼ä¹Ÿç›¸åº”æ”¹æˆä½¿ç”¨ Vue.delete(obj, &#39;newProp&#39;)","categories":[{"name":"å‰ç«¯","slug":"å‰ç«¯","permalink":"https://taylor12138.github.io/categories/%E5%89%8D%E7%AB%AF/"}],"tags":[],"author":"Hello"},{"title":"gitåŸºæœ¬å‘½ä»¤ç¬¦","slug":"gitåŸºæœ¬å‘½ä»¤ç¬¦","date":"2021-02-28T16:00:00.000Z","updated":"2023-03-30T07:59:33.796Z","comments":true,"path":"2021/03/01/git-ji-ben-ming-ling-fu/","link":"","permalink":"https://taylor12138.github.io/2021/03/01/git-ji-ben-ming-ling-fu/","excerpt":"","text":"ç‰ˆæœ¬æ§åˆ¶å®ƒæ˜¯ä¸€ç§è½¯ä»¶å¼€å‘è¿‡ç¨‹ä¸­ï¼Œç®¡ç†æˆ‘ä»¬å¯¹æ–‡ä»¶ã€ç›®å½•ã€æˆ–å·¥ç¨‹ç­‰å†…å®¹çš„ä¿®æ”¹å†å²ã€æ–¹ä¾¿æˆ‘ä»¬æŸ¥çœ‹æ›´æ”¹å†å²è®°å½•ï¼Œå¤‡ä»½ä»¥ä¾¿æ¢å¤ä»¥å‰çš„ç‰ˆæœ¬è½¯ä»¶å·¥ç¨‹æŠ€æœ¯ã€‚ç®€å•æ¥è¯´å°±æ˜¯ç”¨äºç®¡ç†å¤šäººååŒå¼€å‘é¡¹ç›®çš„æŠ€æœ¯ SVNï¼šé›†ä¸­å¼ç‰ˆæœ¬æ§åˆ¶ã€æ‰€æœ‰ç‰ˆæœ¬å­˜åœ¨æœåŠ¡å™¨ä¸Šï¼Œéœ€è¦è¿ç½‘æ‰èƒ½çœ‹åˆ°å†å²ç‰ˆæœ¬ï¼ŒæœåŠ¡å™¨åäº†å¯èƒ½å¯¼è‡´æ•°æ®ä¸¢å¤±ã€‚å·¥ä½œæ—¶æˆ‘ä»¬é¦–å…ˆéœ€è¦ä»ä¸­å¤®æœåŠ¡å™¨çš„åˆ°æœ€æ–°ç‰ˆæœ¬ Gitï¼šåˆ†å¸ƒå¼ç‰ˆæœ¬æ§åˆ¶ï¼Œæ¯ä¸ªäººéƒ½æ‹¥æœ‰å…¨éƒ¨çš„ä»£ç ï¼ˆå¯èƒ½æœ‰å®‰å…¨éšæ‚£ï¼‰ï¼Œè¿™æ ·å°±å¯ä»¥åœ¨æœ¬åœ°æŸ¥çœ‹å†å²ç‰ˆæœ¬ï¼Œå¯ä»¥ç¦»çº¿åœ¨æœ¬åœ°æäº¤ï¼Œåªéœ€ç»ƒç½‘æ—¶pushåˆ°ç›¸åº”æœåŠ¡å™¨å³å¯ã€‚ååŒæ–¹å¼ï¼šAä¿®æ”¹äº†ä»£ç ã€Bä¹Ÿä¿®æ”¹äº†ä»£ç ï¼Œè¿™æ—¶åªéœ€è¦ä½ ä»¬ä¸¤äººä¹‹é—´æŠŠå„è‡ªä¿®æ”¹çš„ä»£ç æ¨é€ç»™å¯¹æ–¹ï¼Œå³å¯çœ‹åˆ°å¯¹æ–¹ä¿®æ”¹ Gitæ˜¯ç›®å‰ï¼ˆ2021å¹´ï¼‰ä¸–ç•Œä¸Šæœ€å…ˆè¿›çš„åˆ†å¸ƒå¼ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿ Gitå¯åŠ¨Git Bashï¼šUnixä¸Linuxé£æ ¼çš„å‘½ä»¤è¡Œï¼Œä½¿ç”¨æœ€å¤šï¼Œæ¨èæœ€å¤š Git CMDï¼šWindowsé£æ ¼å‘½ä»¤è¡Œ Git GUIï¼šå›¾å½¢ç•Œé¢ï¼Œä¸å»ºè®®åˆå­¦è€…ä½¿ç”¨ GitåŸºæœ¬å‘½ä»¤ç¬¦config é…ç½®æœ‰systemçº§åˆ« globalï¼ˆç”¨æˆ·çº§åˆ«ï¼‰ å’Œlocalï¼ˆå½“å‰ä»“åº“ï¼‰ä¸‰ä¸ª è®¾ç½®å…ˆä»system -&gt; global -&gt; local åº•å±‚é…ç½®ä¼šè¦†ç›–é¡¶å±‚é…ç½® åˆ†åˆ«ä½¿ç”¨â€“system/global/local å¯ä»¥å®šä½åˆ°é…ç½®æ–‡ä»¶ æŸ¥çœ‹ç³»ç»Ÿconfig git config --system --list æŸ¥çœ‹å½“å‰ç”¨æˆ·ï¼ˆglobalï¼‰é…ç½® git config --global --list å®‰è£…Gitåå¿…é¡»æ‰§è¡Œçš„(ä¸ç„¶æäº¤ä¸äº†é¡¹ç›®)ï¼šè®¾ç½®ç”¨æˆ·åå’Œé‚®ç®± git config --global user.name \"taylor12138\" git config --global user.email \"277421392@qq.com\" æŸ¥çœ‹å½“å‰ä»“åº“é…ç½®ä¿¡æ¯ git config --local--list åŸºæœ¬ç†è®ºGitæœ¬åœ°æœ‰ä¸‰ä¸ªå·¥ä½œåŒºåŸŸï¼š å·¥ä½œç›®å½•ï¼ˆWorking Directoryï¼‰ï¼šå¹³æ—¶å­˜æ”¾é¡¹ç›®ä»£ç çš„åœ°æ–¹ï¼ˆä¸»è¦è·Ÿæˆ‘ä»¬æŒ‚é’©çš„ä¸¤ä¸ªåŒºåŸŸä¹‹ä¸€ï¼‰ æš‚å­˜åŒºï¼ˆStage/Indexï¼‰ï¼šä¸´æ—¶å­˜æ”¾æ”¹åŠ¨ï¼Œäº‹å®ä¸Šåªæ˜¯ä¸€ä¸ªæ–‡ä»¶ èµ„æºåº“ï¼ˆRespository/Git Directoryï¼‰ï¼šå®‰å…¨å­˜æ”¾æ•°æ®çš„ä½ç½®ï¼Œè¿™é‡Œæœ‰æäº¤åˆ°æ‰€æœ‰ç‰ˆæœ¬çš„æ•°æ® å†åŠ ä¸Šè¿œç¨‹ä»“åº“ï¼ˆRemote Directoryï¼‰ï¼šæ‰˜ç®¡ä»£ç çš„æœåŠ¡å™¨ï¼ˆä¸»è¦è·Ÿæˆ‘ä»¬æŒ‚é’©çš„ä¸¤ä¸ªåŒºåŸŸä¹‹ä¸€ï¼‰ å¿½ç•¥æ–‡ä»¶æœ‰æ—¶æˆ‘ä»¬ä¸æƒ³æŠŠæŸäº›æ–‡ä»¶ä¹Ÿä¸€å¹¶ä¸Šä¼ ï¼Œæ¯”å¦‚å‰ç«¯é¡¹ç›®ä¸­çš„ npm_modules å¯ä»¥åœ¨ .gitignoreæ–‡ä»¶ä¸‹æ·»åŠ å¿½ç•¥çš„æ–‡ä»¶ *.txt #å¿½ç•¥æ‰€æœ‰.txtç»“å°¾çš„æ–‡ä»¶ !lib.txt #å°†lib.txté™¤å¤–ï¼ˆä¸è¢«å¿½ç•¥ï¼‰ /temp #ä»…å¿½ç•¥æ ¹ç›®å½•ä¸‹çš„TODOæ–‡ä»¶ï¼Œä¸åŒ…æ‹¬å…¶ä»–ç›®å½•çš„tempæ–‡ä»¶ build/ #å¿½ç•¥build/ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶ doc/*.txt #å¿½ç•¥doc/notes.txtä½†ä¸åŒ…æ‹¬doc/server/arch.txt githubå»ºç«‹è¿æ¥çš„æ–¹æ³•æ–¹æ³•1ï¼šåœ¨GitHubç½‘ç«™ä¸Šæ–°å»ºä»“åº“ ç„¶åæ‹·è´ä»“åº“çš„åœ°å€ï¼Œè¿›è¡Œå…‹éš†ä¸‹è½½åˆ°æœ¬åœ° æŠŠè‡ªå·±åŸæ¥é¡¹ç›®é™¤äº†gitæ–‡ä»¶çš„æ‰€æœ‰æ–‡ä»¶æ‹·è´è¿›ä¸‹è½½çš„æ–‡ä»¶å¤¹é‡Œï¼ˆå…‹éš†ä¸‹è½½çš„æ–‡ä»¶æœ¬èº«è‡ªå¸¦.gitæ–‡ä»¶ï¼‰ åˆ©ç”¨å·¥å…· è¿›å…¥æ–°çš„æ–‡ä»¶å¤¹ å¯ä»¥æŸ¥çœ‹çŠ¶æ€ï¼šï¼ˆå¯ä»¥æŸ¥çœ‹æ–‡ä»¶æ˜¯å¦è¢«è·Ÿè¸ªï¼‰ git status ä¸€èˆ¬gitä¸Šä¼ åªéœ€è¦ 1 æ”¾å…¥æš‚å­˜åŒº git add . 2 æäº¤åˆ°gitæœ¬åœ°ä»“åº“ï¼Œ -mæ˜¯æäº¤ä¿¡æ¯ git commit -m 'æè¿°' æ¯”å¦‚ï¼šgit commit -m &#39;feat(buyvip): è¡¥å……åŸ‹ç‚¹è·¯å¾„å‚æ•°&#39; æäº¤è§„èŒƒï¼š 3 æ¨é€åˆ°è¿œç¨‹ git push æ–¹æ³•2ï¼šå°†æœ¬åœ°é¡¹ç›®ç›´æ¥pushï¼Œä¸ç”¨æ‹·è´ åˆ›å»ºä¸€ä¸ªå…¨ç©ºçš„ä»“åº“ ç„¶åè¯¥é¡¹ç›®æœ‰æç¤ºï¼šgit remote add orgin https://github.com/xxxxxxxx.gitçš„æŒ‡ä»¤ å’Œ git push -u origin masteræŒ‡ä»¤ åœ¨é¡¹ç›®çš„ç»ˆç«¯æ‰§è¡Œ gitæ’¤å›æ“ä½œå¦‚æœåªæ˜¯addï¼ˆæš‚å­˜ï¼‰æˆ–è€…commitï¼ˆæäº¤åˆ°æœ¬åœ°ä»“åº“ï¼‰ï¼Œå¯ä»¥ä½¿ç”¨ git reset HEAD HEAD è¯´æ˜ï¼š HEAD è¡¨ç¤ºå½“å‰ç‰ˆæœ¬ HEAD^ ä¸Šä¸€ä¸ªç‰ˆæœ¬ HEAD^^ ä¸Šä¸Šä¸€ä¸ªç‰ˆæœ¬ HEAD^^^ ä¸Šä¸Šä¸Šä¸€ä¸ªç‰ˆæœ¬ ä»¥æ­¤ç±»æ¨â€¦ å¦‚æœæ˜¯å·²ç»æ¨é€åˆ°è¿œç¨‹ä»“åº“äº†ï¼Œéœ€è¦è¿›è¡Œå›æ»šï¼ˆresetæˆ–è€…revertï¼‰ $ git revert HEAD $ git push origin master resetå’Œrevertéƒ½å¯ä»¥ç”¨æ¥å›æ»šä»£ç ã€‚ä½†ä»–ä»¬æ˜¯æœ‰åŒºåˆ«çš„ã€‚ 1ã€resetæ˜¯å½»åº•å›é€€åˆ°æŒ‡å®šçš„commitç‰ˆæœ¬ï¼Œè¯¥commitåçš„æ‰€æœ‰commitéƒ½å°†è¢«æ¸…é™¤ï¼›è€Œrevertä»…æ˜¯æ’¤é”€æŒ‡å®šcommitçš„ä¿®æ”¹ï¼Œå¹¶ä¸å½±å“åç»­çš„commitã€‚ 2ã€resetæ‰§è¡Œåä¸ä¼šäº§ç”Ÿè®°å½•ï¼Œrevertæ‰§è¡Œåä¼šäº§ç”Ÿè®°å½•ã€‚ å½“ç„¶ä¹Ÿå¯ä»¥ä¸ç”¨revertï¼Œè€Œæ˜¯å½“å‰ä»£ç åˆ‡åˆ°æ–°çš„åˆ†æ”¯ï¼Œæ¯”å¦‚feat/xxxï¼Œç„¶åå›åˆ°åŸæ¥çš„åˆ†æ”¯ï¼Œ ä½¿ç”¨ git resetæˆ‘ä»¬éœ€è¦æ‰¾åˆ°å›æ»šçš„commitï¼Œè¾“å…¥git reset â€“hard {commitId}ï¼Œå°†æœ¬åœ°æ–‡ä»¶å›æ»šï¼š git reset --hard d580ea7dab097d8ea6d658adbc7e9d57ef22669a ç„¶åå¯ä»¥å¼ºè¡Œpushä¸Šå» git push -f æ­¤æ—¶æˆ‘ä»¬æ‹¿åˆ°çš„æ—¶å€™ä¼šæ»šçš„æ—§ä»£ç ï¼Œç„¶åæˆ‘ä»¬å¯ä»¥ä½¿ç”¨vscodeè‡ªå¸¦çš„å·¥å…·ï¼Œæ‹¿åˆ°æˆ‘ä»¬ä¿®æ”¹çš„éƒ¨åˆ†ï¼Œè¿›è¡Œå¯¹æ¯”ä¿®æ”¹ å›é€€åˆ°ä¸Šä¸ªç‰ˆæœ¬ + æäº¤ï¼š git reset --hard HEAD^ git push origin HEAD --force git stashæš‚å­˜å†…å®¹å½“git pullæ—¶ï¼Œå‡ºç°ä»¥ä¸‹æç¤ºï¼š æ›´æ–° 07153c9..820f46d error: æ‚¨å¯¹ä¸‹åˆ—æ–‡ä»¶çš„æœ¬åœ°ä¿®æ”¹å°†è¢«åˆå¹¶æ“ä½œè¦†ç›–ï¼š åˆ«äººä¿®æ”¹äº†æ–‡ä»¶å¹¶ä¸”æäº¤PUSH,ä½ ä¹Ÿä¿®æ”¹äº†æ­¤æ–‡ä»¶å¹¶ä¸”æ²¡æœ‰addå’Œcommit.ç„¶åä½ åœ¨pullæ—¶å°±ä¼šå‡ºç°æ­¤æç¤ºã€‚ å¦‚æœä¸æƒ³èˆå¼ƒå¯¹æœ¬åœ°çš„ä¿®æ”¹ï¼š å°±æŒ‰ç…§æç¤ºçš„æ“ä½œä¸€æ ·ï¼šè¯·åœ¨åˆå¹¶å‰æäº¤æˆ–è´®è—æ‚¨çš„ä¿®æ”¹ã€‚ è´®è—ä¿®æ”¹ï¼Œå°±è¦ç”¨åˆ°git stash å…ˆgit stashï¼Œæœ¬åœ°å·¥ä½œåŒºå¤‡åˆ†ï¼Œæ”¾å…¥gitæ ˆä¸­ã€‚ç„¶åï¼Œå·¥ä½œåŒºå†…å®¹æ¢å¤åˆ°ä»“åº“headæœ€åä¸€æ¬¡æäº¤çš„å†…å®¹ã€‚ ç„¶ågit pull. æœ€åï¼Œgit stash pop,è¿™ä¸ªè¿‡ç¨‹è‡ªåŠ¨åˆå¹¶ã€‚å¦‚æœæˆåŠŸï¼Œåˆ™è‡ªåŠ¨æ­¤å¤‡åˆ†ä»git stashä¸­åˆ é™¤ã€‚å¦‚æœæœ‰å†²çªï¼Œåˆ™ä½ éœ€è¦æ‰‹åŠ¨è§£å†³å†²çªã€‚ç„¶ågit stash drop Gitåˆ†æ”¯git branch #æŸ¥çœ‹æ‰€æœ‰åˆ†æ”¯ git branch -r #æŸ¥çœ‹è¿œç¨‹åˆ†æ”¯ git branch dev #æ–°å»ºdevåˆ†æ”¯ï¼Œä½†æ˜¯ç°åœ¨ä»åœç•™åœ¨åŸåˆ†æ”¯ git branch -d dev #åˆ é™¤devåˆ†æ”¯ git merge [branch] #åˆå¹¶æŒ‡å®šåˆ†æ”¯åˆ°å½“å‰åˆ†æ”¯ å¦‚æœå¤šä¸ªåˆ†æ”¯å¹¶è¡Œæ‰§è¡Œï¼Œä¼šå¯¼è‡´ä»£ç å¹¶ä¸å†²çªï¼Œä¹Ÿå°±æ˜¯åŒæ—¶å­˜åœ¨å¤šä¸ªç‰ˆæœ¬ ä¸€èˆ¬æ¥è¯´masterä¸»åˆ†æ”¯éå¸¸ç¨³å®šï¼Œç”¨æ¥å‘å¸ƒæ–°ç‰ˆæœ¬ï¼Œå·¥ä½œä¸€èˆ¬åœ¨æ–°å»ºçš„devåˆ†æ”¯ä¸Šå·¥ä½œï¼Œç­‰å¾…devåˆ†æ”¯ç¨³å®šåæ‰å¯åˆå¹¶åˆ°masterä¸»åˆ†æ”¯ä¸Š åˆ‡æ¢åˆ†æ”¯ git checkout â€œå¯¹åº”åˆ†æ”¯â€ git checkout - #åˆ‡æ¢åˆ°ä¸Šä¸€ä¸ªåˆ†æ”¯ git checkout -b å‘½å(feat/v1.21) #æ–°å»ºåˆ†æ”¯feat/v1.21 æ­¤æ—¶æˆ‘ä»¬å¯ä»¥pushåˆ°æ–°å»ºçš„åˆ†æ”¯ git push --set-upstream origin feat/v1.21 Gitæäº¤é”™è¯¯Connection was reset in connection to github.com:443 è§£å†³æ–¹æ³•ï¼š 1. git config --global http.sslVerify false ç»“æœï¼šå¤±è´¥ 2. git config --global --unset http.proxy ç»“æœï¼šå¤±è´¥ 3.cmdå‘½ä»¤æ‰§è¡Œï¼ˆå¯èƒ½æ˜¯å› ä¸ºä½¿ç”¨è¿‡vpnæˆ–è€…ä»£ç†ï¼Œå…³æœºæ—¶å¿˜è®°å…³äº†ã€‚ï¼‰ ipconfig/flushdns ç»“æœï¼šå¤±è´¥ 4.æ›´æ”¹æœ¬åœ°hostsæ–‡ä»¶ï¼Œæ·»åŠ githubçš„ipåœ°å€ ç»“æœï¼šå¤±è´¥ 5.ï¼šè¾“å…¥å‘½ä»¤ git config --global http.proxy 127.0.0.1:7890 ä¸ºå…¨å±€çš„ git é¡¹ç›®éƒ½è®¾ç½®ä»£ç† git config --local http.proxy 127.0.0.1:7890 ä¸ºæŸä¸ª git é¡¹ç›®å•ç‹¬è®¾ç½®ä»£ç† ç»“æœï¼šæˆåŠŸ gitä»£ç æäº¤è§„èŒƒå·¥å…·huskyå¦‚æœæƒ³è¦åœ¨æäº¤ä¹‹å‰ï¼ˆgit commitï¼‰ï¼Œè®©eslintåšä¸€æ¬¡ eslint fixï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨huskyå·¥å…· ä½ ä¸€å¯ä»¥ä»–æŠŠçœ‹æˆä¸€ä¸ªå…³äºgit çš„ eslint huskyæ˜¯ä¸€ä¸ªgit hookå·¥å…·ï¼Œå¯ä»¥å¸®åŠ©æˆ‘ä»¬è§¦å‘git æäº¤çš„å„ä¸ªé˜¶æ®µï¼Œpre-commitã€commit-msgã€pre-push æˆ‘ä»¬è‡ªå·±ä¹Ÿå¯ä»¥åœ¨ ./git/hooks æ–°å»ºæ–‡ä»¶ï¼Œç»™äºˆå¯æ‰§è¡Œæƒé™ï¼Œç„¶ååœ¨pre-commité˜¶æ®µæ‰§è¡ŒæŸç§æ“ä½œ ä½¿ç”¨huskyï¼šä½¿ç”¨è‡ªåŠ¨é…ç½®å‘½ä»¤ npx husky-init && npm install windowsç”¨æˆ·ï¼ˆpowershellï¼‰å¯ä»¥æ¢æˆ npx husky-init -and npm install pre-commitæ­¤æ—¶å¯ä»¥åœ¨.huskyæ–‡ä»¶å¤¹ä¸‹çš„pre-commitæ–‡ä»¶ä¸‹ï¼Œå†™å…¥eslintçš„fixå‘½ä»¤ï¼ˆpackage.jsonä¸­ä»£ç æ£€æŸ¥å‘½ä»¤ npm run lint ä¹‹ç±»çš„ ï¼‰ ä¸Šé¢é‚£ä¸ªå‘½ä»¤ä¼šæ‰§è¡Œä»¥ä¸‹ä¸‰æ­¥æ“ä½œ å®‰è£…huskyç›¸å…³ä¾èµ–ï¼ˆ npm i husky -D ï¼‰ é¡¹ç›®ç›®å½•ä¸‹åˆ›å»º .husky æ–‡ä»¶å¤¹ï¼ˆ npx husky install ï¼‰ åœ¨package.jsonä¸­æ·»åŠ ä¸€ä¸ªè„šæœ¬ è‡ªåŠ¨è§„èŒƒåŒ–æäº¤æ ¼å¼commitizenï¼Œå¯ä»¥å¸®åŠ©æˆ‘ä»¬è‡ªåŠ¨ç”Ÿæˆè§„èŒƒçš„æäº¤ä¿¡æ¯ï¼ˆä¸Šé¢æ‰€è¯´åˆ°çš„commitè§„èŒƒï¼‰ ä½¿ç”¨ï¼š npm i commitizen -D å®‰è£… cz-conventional-changelogå¹¶ä¸”è¿›è¡Œåˆå§‹åŒ–ï¼ˆè‡ªåŠ¨å¸®æˆ‘ä»¬åœ¨package.jsonä¸­é…ç½®ç›¸å…³configï¼‰ npx commitizen init cz-conventional-changelog --save-dev --save-exact é¦–å…ˆæˆ‘ä»¬è¿˜æ˜¯ git add . ç„¶åæˆ‘ä»¬æäº¤ä»£ç çš„æ—¶å€™ï¼Œä¸è¾“å…¥ git commit -m &#39;xxx&#39; ï¼Œè€Œæ˜¯è¾“å…¥ä»¥ä¸‹å‘½ä»¤å³å¯ npx cz é™åˆ¶æäº¤ï¼ˆcommit-msgï¼‰æ—¢ç„¶æˆ‘ä»¬æŒ‰ç…§czçš„è§„æ ¼æ¥æäº¤ï¼Œä½†æ˜¯å¹¶æ²¡æœ‰è¯´ä¸èƒ½ä½¿ç”¨åŸæ¥çš„æ–¹æ³•ç›´æ¥æäº¤ æ­¤æ—¶æˆ‘ä»¬å¯ä»¥æ˜¯ç”¨ commitlint æ¥é™åˆ¶æäº¤ å®‰è£… npm i @commitlint/config-conventional @commitlint/cli -D åœ¨æ ¹ç›®å½•åˆ›å»º commitlint.config.js æ–‡ä»¶ï¼Œé…ç½®commitlint module.exports = { extends: ['@commitlint/config-conventional'] } ä½¿ç”¨huskyç”Ÿæˆ commit-msg æ–‡ä»¶ï¼ŒéªŒè¯æäº¤ä¿¡æ¯ npx husky add .husky/commit-msg \"npx --no-install commitlint --edit $1\" gité…ç½®sshå…³äºgitç®¡ç†æ—¶ï¼Œé…ç½®å¤šä¸ªè´¦å·ï¼ˆæ¯”å¦‚å…¬å¸ç”¨ä¸€ä¸ªï¼Œä¸ªäººç”¨ä¸€ä¸ªï¼‰ æŒ‡å¯¼ä¸€ï¼šGit é…ç½®å¤šè´¦å·ï¼ˆMacï¼‰ æŒ‡å¯¼äºŒï¼š github/gitlabåŒæ—¶ç®¡ç†å¤šä¸ªssh key å› ä¸º If youâ€™re using macOS Sierra 10.12.2 or later, you will need to modify your ~/.ssh/config file to automatically load keys into the ssh-agent and store passphrases in your keychain. æ‰€ä»¥ç°åœ¨ä¸€èˆ¬sshä¸­çš„configä¹Ÿéœ€è¦é…ç½®ï¼Œæœ€å¥½ç”¨ç¬¬äºŒä¸ªã€‚","categories":[],"tags":[],"author":"Hello"},{"title":"jsæ¸¸æˆæ¡†æ¶åˆé›†","slug":"jsæ¸¸æˆæ¡†æ¶åˆé›†","date":"2021-02-28T16:00:00.000Z","updated":"2023-06-11T16:56:47.012Z","comments":true,"path":"2021/03/01/js-you-xi-kuang-jia-he-ji/","link":"","permalink":"https://taylor12138.github.io/2021/03/01/js-you-xi-kuang-jia-he-ji/","excerpt":"","text":"Cocos.jsæ¦‚è¿°Cocos.jsæ¦‚è¿°ï¼Œä¸»è¦æºè‡ªchatgptï¼š Cocos.js æ˜¯ä¸€æ¬¾åŸºäº Cocos2d-x å¼•æ“çš„ JavaScript æ¸¸æˆå¼€å‘æ¡†æ¶ï¼Œä¸»è¦ç”¨äºåˆ›å»ºè·¨å¹³å°çš„ç§»åŠ¨ç«¯æ¸¸æˆã€‚å®ƒç»“åˆäº† Cocos2d-x å¼•æ“çš„é«˜æ€§èƒ½å’Œè·¨å¹³å°ç‰¹æ€§ä»¥åŠ JavaScript è¯­è¨€çš„ä¾¿æ·æ€§å’Œçµæ´»æ€§ã€‚ Cocos2d-x æ˜¯ä¸€ä¸ªæˆç†Ÿçš„å¼€æºæ¸¸æˆå¼•æ“ï¼Œç”¨ C++ ç¼–å†™ï¼Œæ”¯æŒå¤šå¹³å°å¼€å‘ï¼ŒåŒ…æ‹¬ iOSã€Androidã€Windows ç­‰ã€‚Cocos.js åˆ™æ˜¯é’ˆå¯¹ JavaScript å¼€å‘è€…æä¾›çš„ä¸€ä¸ªå°è£…å±‚ï¼Œä½¿ä»–ä»¬èƒ½å¤Ÿä½¿ç”¨ JavaScript è¯­è¨€è¿›è¡Œæ¸¸æˆå¼€å‘ã€‚ Cocos.js æä¾›äº†ä¸€ç³»åˆ—çš„æ¸¸æˆå¼€å‘å·¥å…·å’Œç»„ä»¶ï¼ŒåŒ…æ‹¬åœºæ™¯ç®¡ç†ã€åŠ¨ç”»ç³»ç»Ÿã€ç²¾çµç®¡ç†ã€ç‰©ç†å¼•æ“ã€UI ç³»ç»Ÿç­‰ï¼Œä½¿å¼€å‘è€…èƒ½å¤Ÿæ–¹ä¾¿åœ°æ„å»ºæ¸¸æˆåœºæ™¯ã€å¤„ç†ç”¨æˆ·è¾“å…¥ã€ç®¡ç†æ¸¸æˆå¯¹è±¡ç­‰ã€‚æ­¤å¤–ï¼ŒCocos.js è¿˜æ”¯æŒ JavaScript çš„æ¨¡å—åŒ–å¼€å‘ï¼Œä½¿å¼€å‘è€…èƒ½å¤Ÿæ›´å¥½åœ°ç»„ç»‡å’Œç®¡ç†ä»£ç ã€‚ Cocos.js çš„ç‰¹ç‚¹ è·¨å¹³å°æ”¯æŒï¼šå¯ä»¥ä½¿ç”¨ä¸€å¥—ä»£ç å¼€å‘æ¸¸æˆï¼Œå¹¶åœ¨å¤šä¸ªå¹³å°ä¸Šè¿è¡Œï¼ŒåŒ…æ‹¬ iOSã€Androidã€Windows ç­‰ã€‚ é«˜æ€§èƒ½ï¼šCocos2d-x å¼•æ“å…·æœ‰ä¼˜ç§€çš„æ€§èƒ½è¡¨ç°ï¼Œèƒ½å¤Ÿå®ç°æµç•…çš„æ¸¸æˆä½“éªŒã€‚ JavaScript å¼€å‘ï¼šä½¿ç”¨ JavaScript è¯­è¨€è¿›è¡Œå¼€å‘ï¼Œæ— éœ€å­¦ä¹ é¢å¤–çš„ç¼–ç¨‹è¯­è¨€ã€‚ ä¸°å¯Œçš„åŠŸèƒ½ï¼šæä¾›äº†ä¸°å¯Œçš„æ¸¸æˆå¼€å‘å·¥å…·å’Œç»„ä»¶ï¼Œæ–¹ä¾¿å¼€å‘è€…æ„å»ºå„ç§ç±»å‹çš„æ¸¸æˆã€‚ ç¤¾åŒºæ”¯æŒï¼šCocos.js æ‹¥æœ‰æ´»è·ƒçš„å¼€å‘è€…ç¤¾åŒºï¼Œæä¾›æŠ€æœ¯æ”¯æŒå’Œèµ„æºåˆ†äº«ã€‚ Cocos Creatorï¼šæ˜¯ä¸€ä¸ªä½äºCocos2d-xä¹‹ä¸Šçš„GUIç¼–è¾‘å™¨ã€‚å®ƒæ”¯æŒJavaScriptï¼Œ Creator 3.0 ç»Ÿä¸€äº† 2D ä¸ 3D çš„å¼€å‘å·¥ä½œæµï¼Œè¿›ä¸€æ­¥ä¼˜åŒ–äº†æ€§èƒ½ï¼Œå®Œå–„äº†å“è´¨ ç‰¹æ€§ï¼š Cocos2d-xï¼šæ˜¯æ¸¸æˆå¼•æ“ã€‚å®ƒæ”¯æŒc ++ï¼ŒJavaScriptå’ŒLuaã€‚2D å’Œ 3Dã€‚ Cocos Creatorå®˜ç½‘ï¼šå®‰è£…å’Œå¯åŠ¨ + æ³¨å†Œä¸ªäººè´¦æˆ· ç„¶åå†editoré€‰é¡¹æ ä¸‹è½½ä¸€ä¸ªç¼–è¾‘å™¨ ç„¶åæˆ‘ä»¬å¯ä»¥åœ¨ç¤¾åŒºä¸‹è½½ä¸€äº›çœ‹èµ·æ¥å¾ˆé…·çš„é¡¹ç›®(éœ€è¦æ³¨æ„ä»–å¯¹åº”çš„creatorç¼–è¾‘å™¨ ç‰ˆæœ¬) ç„¶åæ‰“å¼€é¡¹ç›®åè¿›è¡Œ é¢„è§ˆå’Œè°ƒè¯• è¿›è¡ŒæŸ¥çœ‹ å®˜æ–¹è¿˜æä¾›äº†å‡ ä¸ªæ–°æ‰‹æ“ä½œæ—¶é—´å®ä¾‹ï¼Œå¯ä»¥çœ‹è¿™é‡Œï¼š Hello world! å¿«é€Ÿä¸Šæ‰‹ï¼šåˆ¶ä½œç¬¬ä¸€ä¸ªæ¸¸æˆ æ•´ä½“ä¸Šçœ‹å’Œæˆ‘ä»¬æ­£å¸¸å¼€å‘web 3då¾ˆåƒï¼Œæ¯”å¦‚åˆ›å»ºåœºæ™¯ï¼Œåˆ›å»ºcubeå•Šï¼Œåªæ˜¯è¿™äº›ä»å†™ä»£ç è½¬ç§»åˆ°äº†guiç•Œé¢ å·¦ä¸Šè§’è´Ÿè´£guiéƒ¨åˆ†ï¼Œå¿«é€Ÿæ·»åŠ  / åˆ é™¤ mesh å·¦ä¸‹è§’è´Ÿè´£ç¼–å†™ä»£ç ï¼Œå’Œæˆ‘ä»¬æ­£å¸¸çš„é¡¹ç›®ç›®å½•ä¸€æ ·ï¼ˆæ·»åŠ è„šæœ¬ç”¨typescriptï¼Œä¸”éœ€è¦æ³¨æ„ï¼ŒCocos Creator ä¸­è„šæœ¬åç§°å°±æ˜¯ç»„ä»¶çš„åç§°ï¼Œè¿™ä¸ªå‘½åæ˜¯å¤§å°å†™æ•æ„Ÿçš„ï¼å¦‚æœç»„ä»¶åç§°çš„å¤§å°å†™ä¸æ­£ç¡®ï¼Œå°†æ— æ³•æ­£ç¡®é€šè¿‡åç§°ä½¿ç”¨ç»„ä»¶ï¼ï¼‰ è¿™å¯¹äºä¸€äº›ç®€å•çš„åŠ¨ç”»æ¥è¯´ï¼Œæ— ç–‘æ˜¯ç¦éŸ³ æ¸¸æˆåº“å¯¹æ¯”åˆé›†3Dæ¢ç´¢â€”â€”Web 3Då“ªå®¶å¼ºï¼Ÿï¼ˆä¸»è¦æ˜¯threejså’ŒLayaboxï¼‰ æ¡ˆä¾‹åˆé›†cocoså®˜ç½‘æ¡ˆä¾‹ï¼šhttps://docs.cocos.com/creator/manual/zh/cases-and-tutorials/","categories":[],"tags":[],"author":"Hello"},{"title":"babel","slug":"babel","date":"2021-02-06T16:00:00.000Z","updated":"2023-04-10T16:36:29.773Z","comments":true,"path":"2021/02/07/babel/","link":"","permalink":"https://taylor12138.github.io/2021/02/07/babel/","excerpt":"","text":"1.babelä»‹ç»å°æ¦‚ polyfillï¼špolyfillä¸»è¦æŠšå¹³ä¸åŒæµè§ˆå™¨ä¹‹é—´å¯¹jså®ç°çš„å·®å¼‚ï¼Œæ¯”å¦‚ä¸€äº›es6çš„è¯­æ³•ï¼Œé€šè¿‡polyfillæ³¨å…¥ä»£ç ï¼Œä½¿å¾—es5ä¹Ÿèƒ½æ­£å¸¸è¿è¡Œapi Core-jsï¼šå®ƒæ˜¯JavaScript æ ‡å‡†åº“ä¸­æœ€æµè¡Œä¹Ÿæœ€å¸¸ç”¨çš„polyfill core-jsï¼šåŒ…å«æ‰€æœ‰polyfillï¼ˆå½“ç„¶ä¹Ÿå¯ä»¥ä»…å¼•å…¥éƒ¨åˆ†ç‰¹æ€§çš„polyfillï¼Œæ¯”å¦‚ï¼š import 'core-js/features/array/from'; // &lt;- at the top of your entry point import 'core-js/features/array/flat'; // &lt;- at the top of your entry point import 'core-js/features/set'; // &lt;- at the top of your entry point import 'core-js/features/promise'; // &lt;- at the top of your entry point Array.from(new Set([1, 2, 3, 2, 1])); // => [1, 2, 3] [1, [2, 3], [4, [5]]].flat(2); // => [1, 2, 3, 4, 5] Promise.resolve(32).then(x => console.log(x)); // => 32 ä½†æ˜¯å³ä½¿åœ¨è¿™é‡Œéƒ¨åˆ†å¼•å…¥çš„polyfillï¼Œä¾ç„¶ä¼šç›´æ¥æ‰©å±•åˆ°å…¨å±€ç¯å¢ƒä¸­ core-js-pureï¼šä¸ä¼šæŠŠpolyfillæ³¨å…¥å…¨å±€ç¯å¢ƒï¼Œä½†æ˜¯åœ¨ä½¿ç”¨æ—¶éœ€è¦å•ç‹¬å¼•å…¥polyfillçš„module core-js-bundleï¼šç¼–è¯‘æ‰“åŒ…å¥½çš„ç‰ˆæœ¬ï¼ŒåŒ…å«å…¨éƒ¨çš„polyfillç‰¹æ€§ï¼Œé€‚åˆåœ¨æµè§ˆå™¨é‡Œé¢é€šè¿‡scriptç›´æ¥åŠ è½½ï¼Œå‰2ä¸ªç‰ˆæœ¬é€‚åˆæ”¾æ„å»ºå·¥å…· regenerator-runtimeï¼šç”¨æ¥è½¬æ¢ generator å’Œ async å‡½æ•°ï¼Œä¹Ÿæ˜¯ä¸€ä¸ªpolyfill babelï¼š å†…éƒ¨å€ŸåŠ©äº†corejså¯¹ä»£ç æ·»åŠ polyfill å¹¶ä¸”æ”¯æŒES6çš„ä»£ç è½¬æ¢ä¸ºES5ä»£ç ï¼ˆclassã€ç®­å¤´å‡½æ•°ã€propertiesï¼‰ æ”¯æŒjsxç­‰ç¼–è¯‘è½¬æ¢ åœ¨babel7ä¹‹å‰ï¼Œbabelä¸“é—¨æä¾›äº†ä¸€ä¸ªåº“å«babel/polyfillæ¥åšpolyfillï¼Œåœ¨babel7ä¹‹åï¼Œè¿™ä¸ªåº“è¢«åºŸå¼ƒäº† babelçš„æ¯ä¸€ç§è½¬æ¢å¤„ç†éƒ½å¯¹åº”ä¸€ä¸ªbabelæ’ä»¶ï¼Œä½†æ˜¯pluginå¤ªå¤šäº†ï¼Œæ‰€ä»¥babelæ¨å‡ºäº†presetsï¼ŒåŒ…å«è‹¥å¹²ä¸ªplugin è‡ªå®šä¹‰presetå®‰è£…å®Œå¯¹åº”pluginä¹‹åï¼Œæ–°å»ºä¸€ä¸ªmy-preset.js module.exports = () => ({ plugins: [ ['@babel/plugin-transform-arrow-functions'], ['@babel/plugin-transform-classes', {spec: false}], ['@babel/plugin-transform-computed-properties'], ['@babel/plugin-proposal-object-rest-spread', {loose: true, useBuiltIns: true}] ] }); ç„¶ååœ¨babelé…ç½®æ–‡ä»¶ä¸­å¯¼å…¥ //babel.config.js const presets = [ './my-preset.js' ]; const plugins = [ ]; module.exports = {presets, plugins} webpack and babelå¦‚æœå¸Œæœ›å°†ES6è¯­æ³•è½¬åŒ–æˆES5è¯­æ³•ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨babelå¯¹åº”çš„loaderï¼Œé…ç½®æ‰“åŒ…å¾—åˆ°æ–°çš„jsæ–‡ä»¶ npm install -D babel-loader @babel/core @babel/preset-env @babel/core babelçš„æ ¸å¿ƒå·¥å…· @babel/preset-env babelçš„é¢„å®šä¹‰ç¯å¢ƒï¼ŒåŒ…å«å¤§é‡å®ç”¨babel pluginï¼Œè¿˜èƒ½æ ¹æ®browserslistè¿›è¡Œé…ç½®ï¼Œæ»¡è¶³è¿è¡Œç¯å¢ƒæœ€ä½ç‰ˆæœ¬è¦æ±‚ èå…¥äº†corejsï¼Œå¹¶ä¸”æœ‰å¯¹åº”çš„é…ç½®é¡¹è¿›è¡Œé€‚é…ï¼ŒæŠ›å¼ƒäº†ä¼ ç»Ÿçš„ @babel/polyfill ç›´æ¥å…¨é‡å¼•å…¥ @babel-loader babelåœ¨webpackä¸­çš„åŠ è½½å™¨ å…¶å®è¿˜å¯ä»¥é…ç½®ä¸€ä¸ªcore-jsï¼Œcore-jsç”¨æ¥ä½¿è€ç‰ˆæœ¬çš„æµè§ˆå™¨æ”¯æŒæ–°ç‰ˆESè¯­æ³•ï¼ˆæ¯”å¦‚è€ç‰ˆæœ¬æ²¡æœ‰Promiseï¼Œå®ƒä¼šç»™ä½ å¼•è¿›å»coreJsåº“é‡Œçš„Promiseå‡½æ•°ï¼‰ï¼Œç„¶åæŒ‰éœ€åŠ è½½å¯ä»¥ä½¿ç”¨åˆ°çš„ core-js éƒ¨åˆ† å¦‚æœ @babel/core or @babel/plugin-transform-regenerator ç‰ˆæœ¬ å°äº 7.18.0ï¼Œä½ éœ€è¦åŠ è½½ regenerator runtime æ¥åŠ è½½ core-js/stableï¼Œ å¦‚æœ ä½ ç”¨äº† @babel/preset-envâ€˜s useBuiltIns: &quot;usage&quot; option or @babel/plugin-transform-runtime. åˆ™ä¼šè‡ªåŠ¨åŠ è½½ core-js/stable 2.é…ç½®åœ¨webpack.config.jsä¸­çš„é…ç½® const path = require('path') module.exports = { entry: \"./src/index.ts\", output: { path: path.join(__dirname, 'dist'), filename: 'bundle.js' }, module: { // æŒ‡å®šåŠ è½½è§„åˆ™ rules: [ { //è¿™é‡Œä½¿ç”¨TypeScript test: /\\.ts$/,// testæŒ‡å®šè§„åˆ™ç”Ÿæ•ˆçš„æ–‡ä»¶,ä»¥tsç»“å°¾çš„å›¾ç‰‡ exclude: /node_modules/, use: [ { loader: \"babel-loader\", options: { presets: [ [ '@babel/preset-env', { // è¦å…¼å®¹çš„ç›®æ ‡æµè§ˆå™¨ targets: { \"chrome\": \"58\", \"ie\": \"8\" }, // corejsç‰ˆæœ¬ \"corejs\": \"3\", // ä½¿ç”¨corejsçš„æ–¹å¼ï¼ŒæŒ‰éœ€åŠ è½½ \"useBuiltIns\": \"usage\" } ] ] } }, // å¦‚æœä½¿ç”¨typescriptçš„loaderï¼Œè¦æŠŠts-lodaeræ”¾ä¸‹æ–¹ï¼Œbabel-loaderæ”¾ä¸Šæ–¹ // webpackä»åå¾€å‰æ‰§è¡Œï¼Œæ‰€ä»¥å¿…é¡»è¦å…ˆæ‰§è¡Œts -> Jsè½¬æ¢ï¼Œå†æ‰§è¡Œjså…¼å®¹æ€§çš„è½¬æ¢ 'ts-loader' ], } ] }, } @babel/preset-envï¼š useBuiltIns é»˜è®¤falseï¼Œä¸ä¼šæœ‰ä»»ä½• polyfill è¢«æ·»åŠ è¿›æ¥ entryï¼Œéœ€è¦æˆ‘ä»¬æ‰‹åŠ¨é’ˆå¯¹é¡¹ç›®å…¥å£æ–‡ä»¶å¤„å…¨å±€æ³¨å…¥çš„core-jsè¿›è¡Œä¼˜åŒ–è½¬æ¢ï¼Œä½†æ˜¯åªé’ˆå¯¹core-js@3ç‰ˆæœ¬ import \"core-js\"; //... usageï¼ŒæŒ‰éœ€å¯¼å…¥ï¼Œæ•ˆæœæ¯” entry å¥½ï¼ˆä½“ç§¯å°ï¼Œå¯ä»¥çœ‹ è¿™é‡Œï¼‰ corejs å®‰è£…å®Œcore-jsåè¿˜éœ€è¦åœ¨@babel-preset-envä¸­æŒ‡å®šå…¶ç‰ˆæœ¬ï¼Œå¦‚æœå¼€å¯useBuiltInsï¼Œé»˜è®¤ä¸º2.0ç‰ˆæœ¬ï¼Œè¿™é‡Œè‚¯å®šè¦æ”¹æˆ3.0+çš„ï¼Œå› ä¸º3.0çš„core-jsæ”¹è¿›å¾ˆå¤§ã€‚ å½“ç„¶ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥åœ¨æ ¹ç›®å½•ä¸‹ï¼Œåˆ›å»ºä¸€ä¸ªbabel.config.js / babel.config.json / .babelrc å°†babelé…ç½®ä¿¡æ¯æ”¾åœ¨ä¸€ä¸ªç‹¬ç«‹çš„æ–‡ä»¶ä¸­ //babel.config.js module.exports = { preset: { \"@babel/preset-env\" } } ç„¶ååœ¨webpack.config.jsé‡Œçš„rulesé‡Œç›´æ¥use babel-loaderå³å¯ ä½ ç”šè‡³å¯ä»¥åœ¨package.jsoné‡Œé¢å†™ { \"name\": \"my-package\", \"version\": \"1.0.0\", \"babel\": { \"presets\": [ ], \"plugins\": [ ] } } 3.transform-runtime(1)Babel æ’å…¥äº†è¾…åŠ©ä»£ç  Babel åœ¨æ¯ä¸ªæ–‡ä»¶éƒ½æ’å…¥äº†è¾…åŠ©ä»£ç ï¼Œä½¿ä»£ç ä½“ç§¯è¿‡å¤§ï¼ Babel å¯¹ä¸€äº›å…¬å…±æ–¹æ³•ä½¿ç”¨äº†éå¸¸å°çš„è¾…åŠ©ä»£ç ï¼Œæ¯”å¦‚ _extendï¼Œé»˜è®¤æƒ…å†µä¸‹ä¼šè¢«æ·»åŠ åˆ°æ¯ä¸€ä¸ªéœ€è¦å®ƒçš„æ–‡ä»¶ä¸­ã€‚ è€Œtransform-runtimeæ’ä»¶å¯ä»¥æŠŠè¿™äº›é‡å¤çš„è¾…åŠ©ä»£ç ï¼Œè½¬æ¢æˆå…¬å…±çš„å‡½æ•°è¿›è¡Œå¼•å…¥ æˆ‘ä»¬æ­£å¸¸ç»™åº”ç”¨å…¨å±€ç¯å¢ƒæ³¨å…¥polyfillï¼Œæ˜¯æ²¡å•¥é—®é¢˜çš„ï¼Œä½†æ˜¯å¦‚æœåœ¨å¼€å‘ä¸€ä¸ªç‹¬ç«‹çš„å·¥å…·åº“é¡¹ç›®ï¼Œä¸ç¡®å®šå®ƒå°†ä¼šè¢«å…¶å®ƒäººç”¨åˆ°ä»€ä¹ˆè¿è¡Œç¯å¢ƒé‡Œé¢ï¼Œé‚£ä¹ˆå‰é¢é‚£ç§æ‰©å±•å…¨å±€ç¯å¢ƒçš„polyfillå°±ä¸æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„æ–¹å¼ï¼Œè€Œtransform-runtimeä¼šä¸ºä½ åˆ›é€ ä¸€ä¸ªæ²™ç›’ç¯å¢ƒæ¥è¿è¡Œå½“å‰ä»£ç  ä¸‹é¢çš„é…ç½®ç¦ç”¨äº† Babel è‡ªåŠ¨å¯¹æ¯ä¸ªæ–‡ä»¶çš„ runtime æ³¨å…¥ï¼Œè€Œæ˜¯å¼•å…¥ @babel/plugin-transform-runtime å¹¶ä¸”ä½¿æ‰€æœ‰è¾…åŠ©ä»£ç ä»è¿™é‡Œå¼•ç”¨ã€‚ æ›´å¤šä¿¡æ¯è¯·æŸ¥çœ‹ æ–‡æ¡£ã€‚ npm install --save-dev @babel/plugin-transform-runtime npm install --save @babel/runtime rules: [ // 'transform-runtime' æ’ä»¶å‘Šè¯‰ Babel // è¦å¼•ç”¨ runtime æ¥ä»£æ›¿æ³¨å…¥ã€‚ { test: /\\.m?js$/, exclude: /(node_modules|bower_components)/, use: { loader: 'babel-loader', options: { presets: ['@babel/preset-env'], plugins: ['@babel/plugin-transform-runtime'] } } } ] æ³¨æ„ï¼šå¦‚æœåŒæ—¶å¼€å¯plugin-transform-runtimeå’Œpreset-envçš„polyfillï¼Œåˆ™ä¼š rules: [ { test: /\\.m?js$/, exclude: /(node_modules|bower_components)/, use: { loader: 'babel-loader', options: { presets: [ '@babel/preset-env', { \"targets\": { ios: 8, android: 4.1 }, useBuiltIns: 'usage' } ], plugins: ['@babel/plugin-transform-runtime', { corejs: 3 }] } } } ] ç„¶åå¯¹ä»¥ä¸‹è¿›è¡Œè½¬æ¢ Promise.resolve().finally(); ä¼šå‡ºç° \"use strict\"; var _interopRequireDefault = require(\"@babel/runtime-corejs3/helpers/interopRequireDefault\"); var _promise = _interopRequireDefault(require(\"@babel/runtime-corejs3/core-js-stable/promise\")); require(\"core-js/modules/es6.promise\"); require(\"core-js/modules/es6.object.to-string\"); require(\"core-js/modules/es7.promise.finally\"); _promise.default.resolve().finally(); require(&quot;core-js/modules/es6.promise&quot;); å’Œ var _promise = _interopRequireDefault(require(&quot;@babel/runtime-corejs3/core-js-stable/promise&quot;)); è¿™ç§é‡å¤çš„polyfillçš„å­˜åœ¨ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨å¼€å‘æ—¶è¦å…³é—­å…¶ä¸­ä¹‹ä¸€ options: { presets: ['@babel/preset-env'], plugins: ['@babel/plugin-transform-runtime'] } æˆ–è€… [ \"@babel/plugin-transform-runtime\", { corejs: false, regenerator: false } ] æœ€åæ³¨æ„ï¼š å®ƒè·Ÿpreset-envæä¾›çš„polyfillé€‚ç”¨çš„åœºæ™¯æ˜¯å®Œå…¨ä¸åŒï¼Œruntimeé€‚åˆå¼€å‘åº“ï¼Œpreset-envé€‚åˆå¼€å‘application runtimeä¸preset-envçš„polyfillä¸èƒ½åŒæ—¶å¯ç”¨ runtimeçš„polyfillä¸åˆ¤æ–­ç›®æ ‡è¿è¡Œç¯å¢ƒï¼ˆå¹¶ä¸æ”¯æŒ targets çš„é…ç½®ï¼‰ (2)ç®­å¤´å‡½æ•°babelåéƒ¨åˆ†æµè§ˆå™¨ä»ç„¶ä¸æ”¯æŒç®­å¤´å‡½æ•°ï¼Œæ˜¯å› ä¸ºwebpack5æ‰“åŒ…æ–‡ä»¶é»˜è®¤è¾“å‡ºå½¢å¼å°±æ˜¯ç®­å¤´å‡½æ•°ï¼Œç”¨ä»¥ä¸‹é…ç½®è§£å†³å³å¯ output: { filename: 'js/bundle.js', path: path.resolve(__dirname, 'dist'), environment: { arrowFunction: false } }, (3)babelä¼˜åŒ–å½±å“æ‰“åŒ…æ•ˆç‡çš„loaderé¦–å½“å…¶å†²å¿…å± Babel äº† æˆ‘ä»¬å¯ä»¥æ§åˆ¶babelæ–‡ä»¶æœç´¢èŒƒå›´ï¼Œåªè½¬æ¢æŒ‡å®šæ–‡ä»¶å¤¹ä¸‹çš„ä»£ç ï¼Œå»é™¤æ²¡å¿…è¦è½¬æ¢çš„éƒ¨åˆ†ï¼Œæ¯”å¦‚node_modules module.exports = { module: { rules: [ { // js æ–‡ä»¶æ‰ä½¿ç”¨ babel test: /\\.js$/, loader: 'babel-loader', // åªåœ¨ src æ–‡ä»¶å¤¹ä¸‹æŸ¥æ‰¾ include: [resolve('src')], // ä¸ä¼šå»æŸ¥æ‰¾çš„è·¯å¾„ exclude: /node_modules/ } ] } } (4)babelåŸç†babelå°±æ˜¯ä»ä¸€ç§æºä»£ç è½¬æ¢ä¸ºå¦å¤–ä¸€ç§æºä»£ç ï¼Œæˆ–è€…æŠŠbabelçœ‹æˆä¸€ç§ç¼–è¯‘å™¨ https://juejin.cn/post/7078482623387402271#comment å‚è€ƒæ–‡ç« ï¼š webpackå®˜ç½‘ babelå®˜ç½‘ babelè¯¦è§£","categories":[{"name":"å‰ç«¯","slug":"å‰ç«¯","permalink":"https://taylor12138.github.io/categories/%E5%89%8D%E7%AB%AF/"}],"tags":[],"author":"Hello"},{"title":"webpack(ä¸‹)","slug":"webpack(ä¸‹)","date":"2021-02-06T16:00:00.000Z","updated":"2023-04-13T02:43:29.802Z","comments":true,"path":"2021/02/07/webpack-xia/","link":"","permalink":"https://taylor12138.github.io/2021/02/07/webpack-xia/","excerpt":"","text":"5.å…³äºwebpackWebpackç¼©å°ä½“ç§¯åŸç†å°†å¤šä¸ªæ¨¡å—ä¾èµ–ï¼Œè½¬å˜æˆå•ä¸ªé™æ€èµ„æºï¼ˆjsã€cssã€jpgã€pngï¼‰ æ‰“åŒ…ï¼Œæ˜¯æŒ‡å¤„ç†æŸäº›æ–‡ä»¶å¹¶å°†å…¶è¾“å‡ºä¸ºå…¶ä»–æ–‡ä»¶çš„èƒ½åŠ›ã€‚ entry: ç¼–è¯‘å…¥å£ module: æ¨¡å—ï¼Œåœ¨ webpack ä¸­ï¼Œä¸€åˆ‡çš†ä¸ºæ¨¡å—ï¼Œä¸€ä¸ªæ¨¡å—å¯¹åº”ä¸€ä¸ªæ–‡ä»¶ Chunk: ä»£ç å—ï¼Œä¸€ä¸ª chunk ç”±å¤šä¸ªæ¨¡å—ç»„åˆè€Œæˆï¼Œç”¨äºä»£ç çš„åˆå¹¶ä¸åˆ†å‰² Loader: æ¨¡å—è½¬æ¢å™¨ï¼Œå°†éjsæ¨¡å—è½¬åŒ–ä¸ºwebpackèƒ½è¯†åˆ«çš„jsæ¨¡å— Plugin: æ‰©å±•æ’ä»¶ï¼Œåœ¨webpackè¿è¡Œçš„å„ä¸ªé˜¶æ®µï¼Œéƒ½ä¼šå¹¿æ’­å‡ºå»ç›¸å¯¹åº”çš„äº‹ä»¶ï¼Œæ’ä»¶å¯ä»¥ç›‘å¬åˆ°è¿™äº›äº‹ä»¶çš„å‘ç”Ÿï¼Œåœ¨ç‰¹å®šçš„æ—¶æœºåšç›¸å¯¹åº”çš„äº‹æƒ… é¡¹ç›®ä¸­ä½¿ç”¨çš„æ¯ä¸ªæ–‡ä»¶éƒ½æ˜¯ä¸€ä¸ªæ¨¡å—ï¼Œåœ¨æ‰“åŒ…è¿‡ç¨‹ä¸­ï¼Œæ¨¡å—ï¼ˆmoduleï¼‰ä¼šè¢«åˆå¹¶æˆ chunkï¼Œchunk åˆå¹¶æˆ chunk ç»„ï¼Œå¹¶å½¢æˆä¸€ä¸ªé€šè¿‡æ¨¡å—äº’ç›¸è¿æ¥çš„å›¾(ModuleGraph)ã€‚ é‚£ä¹ˆå¦‚ä½•é€šè¿‡ä»¥ä¸Šæ¥æè¿°ä¸€ä¸ªå…¥å£èµ·ç‚¹ï¼šåœ¨å…¶å†…éƒ¨ï¼Œä¼šåˆ›å»ºä¸€ä¸ªåªæœ‰ä¸€ä¸ª chunk çš„ chunk ç»„ã€‚ æ‰€ä»¥chunkæœ‰ä¸¤ç§å½¢å¼ initial(åˆå§‹åŒ–) æ˜¯å…¥å£èµ·ç‚¹çš„ main chunkã€‚æ­¤ chunk åŒ…å«ä¸ºå…¥å£èµ·ç‚¹æŒ‡å®šçš„æ‰€æœ‰æ¨¡å—åŠå…¶ä¾èµ–é¡¹ã€‚ non-initial æ˜¯å¯ä»¥å»¶è¿ŸåŠ è½½çš„å—ã€‚å¯èƒ½ä¼šå‡ºç°åœ¨ä½¿ç”¨ åŠ¨æ€å¯¼å…¥(dynamic imports) æˆ–è€… SplitChunksPlugin æ—¶ã€‚ ç„¶åloaderæ˜¯æ–‡ä»¶è½¬æ¢å™¨ï¼ˆå°†webpackä¸èƒ½å¤„ç†çš„æ¨¡å—è½¬æ¢æˆèƒ½å¤„ç†çš„æ¨¡å—ï¼Œä¹Ÿå°±æ˜¯jsæ¨¡å—ï¼‰ã€pluginæ˜¯åŠŸèƒ½æ‹“å±• æˆ‘ä»¬ä¹Ÿå¯ä»¥å®‰è£…ä¸€ä¸ªæ’ä»¶å¸®æˆ‘ä»¬æŸ¥çœ‹ä¾èµ–å›¾ npm i webpack-bundle-analyzer -D const { BundleAnalyzerPlugin } = require(\"webpack-bundle-analyzer\"); module.exports = (env) => { return { plugins: [ new BundleAnalyzerPlugin(), ], }; npx webpack serve ç„¶åä½ å°±å¯ä»¥çœ‹åˆ° Webpackæ„å»ºæµç¨‹ åˆå§‹åŒ–å‚æ•°ï¼šé€šè¿‡ yargs è§£æ config ä¸ shell ä¸­çš„é…ç½®é¡¹ï¼Œä»é…ç½®æ–‡ä»¶å’Œ Shell è¯­å¥ä¸­è¯»å–ä¸åˆå¹¶å‚æ•°ï¼Œå¾—å‡ºæœ€ç»ˆçš„å‚æ•°ï¼› å¼€å§‹ç¼–è¯‘ï¼šç”¨ä¸Šä¸€æ­¥å¾—åˆ°çš„å‚æ•°ï¼ˆoptionsï¼‰åˆå§‹åŒ– Compiler å¯¹è±¡ï¼ˆå®ä¾‹åŒ–ï¼‰ï¼ŒåŠ è½½æ‰€æœ‰é…ç½®çš„æ’ä»¶ compiler å¯ä»¥ç†è§£ä¸º webpack ç¼–è¯‘çš„è°ƒåº¦ä¸­å¿ƒï¼Œå®ƒè®°å½•äº†å®Œæ•´çš„ webpack ç¯å¢ƒä¿¡æ¯ åˆå§‹åŒ–æ—¶å®šä¹‰äº†å¾ˆå¤šé’©å­ class Compiler extends Tapable { constructor(context) { super(); this.hooks = { beforeCompile: new AsyncSeriesHook([\"params\"]), compile: new SyncHook([\"params\"]), afterCompile: new AsyncSeriesHook([\"compilation\"]), make: new AsyncParallelHook([\"compilation\"]), entryOption: new SyncBailHook([\"context\", \"entry\"]) // å®šä¹‰äº†å¾ˆå¤šä¸åŒç±»å‹çš„é’©å­ }; // ... } } è°ƒç”¨compiler.run(callback);ï¼Œå¼€å§‹æ„å»ºï¼Œè¿›å…¥compileå‡½æ•° run(callback) { const onCompiled = (err, compilation) => { this.hooks.done.callAsync(stats, err => { return finalCallback(null, stats); }); }; // æ‰§è¡Œè®¢é˜…äº†compiler.beforeRuné’©å­æ’ä»¶çš„å›è°ƒ this.hooks.beforeRun.callAsync(this, err => { // æ‰§è¡Œè®¢é˜…äº†compiler.runé’©å­æ’ä»¶çš„å›è°ƒ this.hooks.run.callAsync(this, err => { this.compile(onCompiled); }); }); } compiler.compileå‡½æ•° compile(callback) { // å®ä¾‹åŒ–æ ¸å¿ƒå·¥å‚å¯¹è±¡ const params = this.newCompilationParams(); // æ‰§è¡Œè®¢é˜…äº†compiler.beforeCompileé’©å­æ’ä»¶çš„å›è°ƒ this.hooks.beforeCompile.callAsync(params, err => { // æ‰§è¡Œè®¢é˜…äº†compiler.compileé’©å­æ’ä»¶çš„å›è°ƒ this.hooks.compile.call(params); // åˆ›å»ºæ­¤æ¬¡ç¼–è¯‘çš„Compilationå¯¹è±¡ const compilation = this.newCompilation(params); // æ‰§è¡Œè®¢é˜…äº†compiler.makeé’©å­æ’ä»¶çš„å›è°ƒ this.hooks.make.callAsync(compilation, err => { compilation.finish(err => { compilation.seal(err => { this.hooks.afterCompile.callAsync(compilation, err => { return callback(null, compilation); }); }) }) }) }) } ç„¶ååœ¨åˆ›å»ºCompilationå¯¹è±¡å®ä¾‹ï¼ŒCompilation å¯¹è±¡æ˜¯åç»­æ„å»ºæµç¨‹ä¸­æœ€æ ¸å¿ƒæœ€é‡è¦çš„å¯¹è±¡ï¼Œå®ƒåŒ…å«äº†ä¸€æ¬¡æ„å»ºè¿‡ç¨‹ä¸­æ‰€æœ‰çš„æ•°æ®ã€‚ä¹Ÿå°±æ˜¯è¯´ä¸€æ¬¡æ„å»ºè¿‡ç¨‹å¯¹åº”ä¸€ä¸ª Compilation å®ä¾‹ã€‚åœ¨åˆ›å»º Compilation å®ä¾‹æ—¶ä¼šè§¦å‘é’©å­ compilaiion å’Œ thisCompilationã€‚ åœ¨Compilationå¯¹è±¡ä¸­ï¼š modules è®°å½•äº†æ‰€æœ‰è§£æåçš„æ¨¡å— chunks è®°å½•äº†æ‰€æœ‰chunk assetsè®°å½•äº†æ‰€æœ‰è¦ç”Ÿæˆçš„æ–‡ä»¶ ç¡®å®šå…¥å£ï¼šæ ¹æ®é…ç½®ä¸­çš„ entry æ‰¾å‡ºæ‰€æœ‰çš„å…¥å£æ–‡ä»¶ï¼› ç¼–è¯‘æ¨¡å—ï¼šå¼€å§‹ modules çš„ç”Ÿæˆé˜¶æ®µï¼Œè¿›å…¥make é’©å­ï¼Œæ‰§è¡ŒçœŸæ­£çš„ç¼–è¯‘æ„å»ºè¿‡ç¨‹ï¼Œä»å…¥å£æ–‡ä»¶å¼€å§‹ï¼Œæ„å»ºæ¨¡å—ï¼Œç›´åˆ°æ‰€æœ‰æ¨¡å—åˆ›å»ºç»“æŸä»å…¥å£æ–‡ä»¶å‡ºå‘ modulesï¼šä¸€ä¸ªä¾èµ–å¯¹è±¡ï¼ˆDependencyï¼‰ç»è¿‡å¯¹åº”çš„å·¥å‚å¯¹è±¡ï¼ˆFactoryï¼‰åˆ›å»ºä¹‹åï¼Œå°±èƒ½å¤Ÿç”Ÿæˆå¯¹åº”çš„æ¨¡å—å®ä¾‹ï¼ˆModuleï¼‰ã€‚ è°ƒç”¨æ‰€æœ‰é…ç½®çš„ Loader å¯¹æ¨¡å—è¿›è¡Œç¿»è¯‘ï¼ˆåœ¨doBuild è°ƒç”¨äº†ç›¸åº”çš„ loadersï¼Œè½¬æ¢äº†éƒ¨åˆ†çš„åŸæœ¬ä¸å¯è¯†åˆ«çš„è¯­è¨€ï¼‰ è°ƒç”¨Parser.parseæ–¹æ³•ï¼Œå°†JSè§£æä¸ºASTã€‚è§£ææˆASTæœ€å¤§ä½œç”¨å°±æ˜¯æ”¶é›†æ¨¡å—ä¾èµ–å…³ç³» å†æ‰¾å‡ºè¯¥æ¨¡å—ä¾èµ–çš„æ¨¡å—ï¼Œå†é€’å½’æœ¬æ­¥éª¤ç›´åˆ°æ‰€æœ‰å…¥å£ä¾èµ–çš„æ–‡ä»¶éƒ½ç»è¿‡äº†æœ¬æ­¥éª¤çš„å¤„ç†ï¼ˆå¯¹æ¯ä¸ªæ¨¡å—æ‰€ä¾èµ–çš„å¯¹è±¡è¿›è¡Œæ”¶é›†ã€‚ï¼‰ å®Œæˆæ¨¡å—ç¼–è¯‘ï¼šåœ¨ç»è¿‡ç¬¬4æ­¥ä½¿ç”¨ Loader ç¿»è¯‘å®Œæ‰€æœ‰æ¨¡å—åï¼Œå¾—åˆ°äº†æ¯ä¸ªæ¨¡å—è¢«ç¿»è¯‘åçš„æœ€ç»ˆå†…å®¹ä»¥åŠå®ƒä»¬ä¹‹é—´çš„ä¾èµ–å…³ç³»ï¼› è¾“å‡ºèµ„æºï¼šè§¦å‘compilation.sealæ–¹æ³•ï¼Œè¿›å…¥ä¸‹ä¸€ä¸ªé˜¶æ®µã€‚ï¼ˆchunkç”Ÿæˆé˜¶æ®µï¼‰ æ ¹æ®å…¥å£å’Œæ¨¡å—ä¹‹é—´çš„ä¾èµ–å…³ç³»ï¼Œç»„è£…æˆä¸€ä¸ªä¸ªåŒ…å«å¤šä¸ªæ¨¡å—çš„ Chunkï¼Œå†æŠŠæ¯ä¸ª Chunk è½¬æ¢æˆä¸€ä¸ªå•ç‹¬çš„æ–‡ä»¶åŠ å…¥åˆ°è¾“å‡ºåˆ—è¡¨ï¼Œè¿™æ­¥æ˜¯å¯ä»¥ä¿®æ”¹è¾“å‡ºå†…å®¹çš„æœ€åæœºä¼š chunkå†…éƒ¨çš„ä¸»è¦å±æ€§æ˜¯_modulesï¼Œç”¨æ¥è®°å½•åŒ…å«çš„æ‰€æœ‰æ¨¡å—å¯¹è±¡ã€‚æ‰€ä»¥è¦ç”Ÿæˆä¸€ä¸ªchunkï¼Œå°±å…ˆè¦æ‰¾åˆ°å®ƒåŒ…å«çš„æ‰€æœ‰modulesã€‚ä¸‹é¢ç®€è¿°ä¸€ä¸‹chunkçš„ç”Ÿæˆè¿‡ç¨‹ï¼š å…ˆæŠŠ entry ä¸­å¯¹åº”çš„æ¯ä¸ª module éƒ½ç”Ÿæˆä¸€ä¸ªæ–°çš„ chunk éå†module.dependenciesï¼Œå°†å…¶ä¾èµ–çš„æ¨¡å—ä¹ŸåŠ å…¥åˆ°ä¸Šä¸€æ­¥ç”Ÿæˆçš„chunkä¸­ è‹¥æŸä¸ªmoduleæ˜¯åŠ¨æ€å¼•å…¥çš„ï¼Œä¸ºå…¶åˆ›å»ºä¸€ä¸ªæ–°çš„chunkï¼Œæ¥ç€éå†ä¾èµ– è°ƒç”¨createChunkAssetsï¼Œéå†chunkï¼Œæ¥æ¸²æŸ“æ¯ä¸€ä¸ªchunkç”Ÿæˆä»£ç  æ¯ä¸ªchunkçš„æºç ç”Ÿæˆä¹‹åï¼Œä¼šè°ƒç”¨ emitAsset å°†å…¶å­˜åœ¨ compilation.assets ä¸­ã€‚å½“æ‰€æœ‰çš„ chunk éƒ½æ¸²æŸ“å®Œæˆä¹‹åï¼Œassets å°±æ˜¯æœ€ç»ˆæ›´è¦ç”Ÿæˆçš„æ–‡ä»¶åˆ—è¡¨ã€‚è‡³æ­¤ï¼Œcompilation çš„ seal æ–¹æ³•ç»“æŸï¼Œä¹Ÿä»£è¡¨ç€ compilation å®ä¾‹çš„æ‰€æœ‰å·¥ä½œåˆ°æ­¤ä¹Ÿå…¨éƒ¨ç»“æŸï¼Œæ„å‘³ç€ä¸€æ¬¡æ„å»ºè¿‡ç¨‹å·²ç»ç»“æŸï¼Œæ¥ä¸‹æ¥åªæœ‰æ–‡ä»¶ç”Ÿæˆçš„æ­¥éª¤äº†ã€‚ åœ¨ Compiler å¼€å§‹ç”Ÿæˆæ–‡ä»¶å‰ï¼Œé’©å­ emit ä¼šè¢«æ‰§è¡Œï¼Œè¿™æ˜¯æˆ‘ä»¬ä¿®æ”¹æœ€ç»ˆæ–‡ä»¶çš„æœ€åä¸€ä¸ªæœºä¼šï¼Œç”Ÿæˆçš„åœ¨æ­¤ä¹‹åï¼Œæˆ‘ä»¬çš„æ–‡ä»¶å°±ä¸èƒ½æ”¹åŠ¨äº†ã€‚ webpack ä¼šç›´æ¥éå† compilation.assets ç”Ÿæˆæ‰€æœ‰æ–‡ä»¶ï¼Œç„¶åè§¦å‘é’©å­doneï¼Œç»“æŸæ„å»ºæµç¨‹ã€‚ æµç¨‹å‚è€ƒï¼šhttps://juejin.cn/post/6844904000169607175 webpakcç®¡ç†æ¨¡å—ä¹‹manifestä¸€æ—¦ä½ çš„åº”ç”¨åœ¨æµè§ˆå™¨ä¸­ä»¥ index.html æ–‡ä»¶çš„å½¢å¼è¢«æ‰“å¼€ï¼Œä¸€äº› bundle å’Œåº”ç”¨éœ€è¦çš„å„ç§èµ„æºéƒ½éœ€è¦ç”¨æŸç§æ–¹å¼è¢«åŠ è½½ä¸é“¾æ¥èµ·æ¥ã€‚åœ¨ç»è¿‡æ‰“åŒ…ã€å‹ç¼©ã€ä¸ºå»¶è¿ŸåŠ è½½è€Œæ‹†åˆ†ä¸ºç»†å°çš„ chunk è¿™äº› webpack ä¼˜åŒ– ä¹‹åï¼Œä½ ç²¾å¿ƒå®‰æ’çš„ /src ç›®å½•çš„æ–‡ä»¶ç»“æ„éƒ½å·²ç»ä¸å†å­˜åœ¨ã€‚æ‰€ä»¥ webpack å¦‚ä½•ç®¡ç†æ‰€æœ‰æ‰€éœ€æ¨¡å—ä¹‹é—´çš„äº¤äº’å‘¢ï¼Ÿè¿™å°±æ˜¯ manifest æ•°æ®ç”¨é€”çš„ç”±æ¥ å½“ compiler å¼€å§‹æ‰§è¡Œã€è§£æå’Œæ˜ å°„åº”ç”¨ç¨‹åºæ—¶ï¼Œå®ƒä¼šä¿ç•™æ‰€æœ‰æ¨¡å—çš„è¯¦ç»†è¦ç‚¹ã€‚è¿™ä¸ªæ•°æ®é›†åˆç§°ä¸º â€œmanifestâ€ï¼Œå½“å®Œæˆæ‰“åŒ…å¹¶å‘é€åˆ°æµè§ˆå™¨æ—¶ï¼Œruntime ä¼šé€šè¿‡ manifest æ¥è§£æå’ŒåŠ è½½æ¨¡å—ã€‚æ— è®ºä½ é€‰æ‹©å“ªç§ æ¨¡å—è¯­æ³•ï¼Œé‚£äº› import æˆ– require è¯­å¥ç°åœ¨éƒ½å·²ç»è½¬æ¢ä¸º __webpack_require__ æ–¹æ³•ï¼Œæ­¤æ–¹æ³•æŒ‡å‘æ¨¡å—æ ‡è¯†ç¬¦(module identifier)ã€‚é€šè¿‡ä½¿ç”¨ manifest ä¸­çš„æ•°æ®ï¼Œruntime å°†èƒ½å¤Ÿæ£€ç´¢è¿™äº›æ ‡è¯†ç¬¦ï¼Œæ‰¾å‡ºæ¯ä¸ªæ ‡è¯†ç¬¦èƒŒåå¯¹åº”çš„æ¨¡å—ã€‚ é—®é¢˜æ‰€ä»¥ï¼Œç°åœ¨ä½ åº”è¯¥å¯¹ webpack åœ¨å¹•åå·¥ä½œæœ‰ä¸€ç‚¹äº†è§£ã€‚â€œä½†æ˜¯ï¼Œè¿™å¯¹æˆ‘æœ‰ä»€ä¹ˆå½±å“å‘¢ï¼Ÿâ€ï¼Œä½ å¯èƒ½ä¼šé—®ã€‚ç­”æ¡ˆæ˜¯å¤§å¤šæ•°æƒ…å†µä¸‹æ²¡æœ‰ã€‚runtime åšå®Œæˆè¿™äº›å·¥ä½œï¼šä¸€æ—¦ä½ çš„åº”ç”¨ç¨‹åºåŠ è½½åˆ°æµè§ˆå™¨ä¸­ï¼Œä½¿ç”¨ manifestï¼Œç„¶åæ‰€æœ‰å†…å®¹å°†å±•ç°å‡ºé­”å¹»èˆ¬è¿è¡Œç»“æœã€‚ç„¶è€Œï¼Œå¦‚æœä½ å†³å®šé€šè¿‡ä½¿ç”¨æµè§ˆå™¨ç¼“å­˜æ¥æ”¹å–„é¡¹ç›®çš„æ€§èƒ½ï¼Œç†è§£è¿™ä¸€è¿‡ç¨‹å°†çªç„¶å˜å¾—æä¸ºé‡è¦ã€‚ é€šè¿‡ä½¿ç”¨å†…å®¹æ•£åˆ—(content hash)ä½œä¸º bundle æ–‡ä»¶çš„åç§°ï¼Œè¿™æ ·åœ¨æ–‡ä»¶å†…å®¹ä¿®æ”¹æ—¶ï¼Œä¼šè®¡ç®—å‡ºæ–°çš„ hashï¼Œæµè§ˆå™¨ä¼šä½¿ç”¨æ–°çš„åç§°åŠ è½½æ–‡ä»¶ï¼Œä»è€Œä½¿ç¼“å­˜æ— æ•ˆã€‚ä¸€æ—¦ä½ å¼€å§‹è¿™æ ·åšï¼Œä½ ä¼šç«‹å³æ³¨æ„åˆ°ä¸€äº›æœ‰è¶£çš„è¡Œä¸ºã€‚å³ä½¿æŸäº›å†…å®¹æ˜æ˜¾æ²¡æœ‰ä¿®æ”¹ï¼ŒæŸäº› hash è¿˜æ˜¯ä¼šæ”¹å˜ã€‚è¿™æ˜¯å› ä¸ºï¼Œæ³¨å…¥çš„ runtime å’Œ manifest åœ¨æ¯æ¬¡æ„å»ºåéƒ½ä¼šå‘ç”Ÿå˜åŒ–ã€‚ æŸ¥çœ‹ ç®¡ç†è¾“å‡º æŒ‡å—çš„ manifest éƒ¨åˆ†ï¼Œäº†è§£å¦‚ä½•æå– manifestï¼Œå¹¶é˜…è¯»ä¸‹é¢çš„æŒ‡å—ï¼Œä»¥äº†è§£æ›´å¤šé•¿æ•ˆç¼“å­˜é”™ç»¼å¤æ‚ä¹‹å¤„ã€‚ Further Reading åˆ†ç¦» manifest ä½¿ç”¨ webpack æä¾›å¯é¢„æµ‹çš„é•¿æ•ˆç¼“å­˜ ç¼“å­˜ Webpackå¯¹å‰ç«¯æ€§èƒ½çš„ä¼˜åŒ– å‹ç¼©ä»£ç ï¼Œæ¯”å¦‚ä¸‘åŒ–JSä»£ç ï¼Œä½¿å¾—æ–‡ä»¶ä½“ç§¯æ›´å°ï¼ˆUglifyJsPluginã€ ParallelUglifyPluginï¼‰ åˆ©ç”¨CDNåŠ é€Ÿï¼Œä¿®æ”¹èµ„æºè·¯å¾„ åˆ é™¤æ­»ä»£ç  æå–å…¬å…±ä»£ç  Tree-shakingåœ¨webpackä¸­å¼€å¯tree-shakingï¼Œåªè¦æ˜¯â€œæˆ‘â€è®¤ä¸ºæ²¡æœ‰ä½¿ç”¨çš„ä»£ç ï¼Œæˆ‘å°±åˆ æ‰ module.exports = (env) => { return { //... optimization: { //åœ¨ç”Ÿäº§ç¯å¢ƒä¸‹å¼€å¯ï¼Œä¼šå¼€å¯tree-shaking usedExports: true, }, }; }; webpack4é»˜è®¤æ²¡æœ‰ç›´æ¥è¿›è¡Œtree-shakingï¼Œæ€•éƒ¨åˆ†æœ‰å‰¯ä½œç”¨çš„æ–‡ä»¶ä¼šè¢«å¿½ç•¥ï¼ˆæ¯”å¦‚å…¨å±€æ ·å¼å¼•å…¥ï¼‰ï¼Œå¯ä»¥é€šå¤é…ç½®sideEffectsè¿›è¡Œæ›´æ”¹ï¼Œä½†æ˜¯webpack5é»˜è®¤ä¼šè¿›è¡Œ tree-shakingï¼ˆæ™ºèƒ½tree-shakingï¼Œåœ¨ä¸ç¡®å®šçš„æƒ…å†µä¸‹å°†å¯¼å…¥çš„æ¨¡å—åˆ—ä¸ºæœ‰å‰¯ä½œç”¨çš„ï¼‰ â€œside effect(å‰¯ä½œç”¨)â€ çš„å®šä¹‰æ˜¯ï¼Œåœ¨å¯¼å…¥æ—¶ä¼šæ‰§è¡Œç‰¹æ®Šè¡Œä¸ºçš„ä»£ç ï¼Œè€Œä¸æ˜¯ä»…ä»…æš´éœ²ä¸€ä¸ª export æˆ–å¤šä¸ª exportã€‚ä¸¾ä¾‹è¯´æ˜ï¼Œä¾‹å¦‚ polyfillï¼Œå®ƒå½±å“å…¨å±€ä½œç”¨åŸŸï¼Œå¹¶ä¸”é€šå¸¸ä¸æä¾› exportã€‚ ä»¥ä¸‹æ˜¯ä¸ªäººæ ¹æ®æƒ…å†µä¿®æ”¹å‰¯ä½œç”¨æ–‡ä»¶ //package.json { \"sideEffects\": false, //éƒ½æ²¡æœ‰å‰¯ä½œç”¨ï¼Œå¯ä»¥åˆ é™¤ä»»ä½•ä½ è§‰å¾—ä¸æ»¡çš„ä»£ç  } //package.json { \"sideEffects\": [\"*.css\"], //cssæ–‡ä»¶çš„ä¸èƒ½ä¹±åˆ ï¼Œæœ‰å‰¯ä½œç”¨ } ä¸åŒç¯å¢ƒä¸‹ä½¿ç”¨ å¼€å‘ç¯å¢ƒä¸‹çš„é…ç½® // webpack.config.js module.exports = { // ... mode: 'development', optimization: { usedExports: true, } }; å¤åˆ¶ä»£ç  ç”Ÿäº§ç¯å¢ƒä¸‹çš„é…ç½® // webpack.config.js module.exports = { // ... mode: 'production', }; å¤åˆ¶ä»£ç  åœ¨ç”Ÿäº§ç¯å¢ƒä¸‹ï¼ŒWebpack é»˜è®¤ä¼šæ·»åŠ  Tree Shaking çš„é…ç½®ï¼Œå› æ­¤åªéœ€å†™ä¸€è¡Œ mode: â€˜productionâ€™ å³å¯ã€‚ å°æ€»ç»“é€šè¿‡sideEffectsä¿®æ”¹tree-shakingçš„æ–¹å¼ ä½¿ç”¨ ES2015 æ¨¡å—è¯­æ³•ï¼ˆå³ import å’Œ exportï¼‰ã€‚ ç¡®ä¿æ²¡æœ‰ç¼–è¯‘å™¨å°†æ‚¨çš„ ES2015 æ¨¡å—è¯­æ³•è½¬æ¢ä¸º CommonJS çš„ï¼ˆé¡ºå¸¦ä¸€æï¼Œè¿™æ˜¯ç°åœ¨å¸¸ç”¨çš„ @babel/preset-env çš„é»˜è®¤è¡Œä¸ºï¼Œè¯¦ç»†ä¿¡æ¯è¯·å‚é˜…æ–‡æ¡£ï¼‰ã€‚ åœ¨é¡¹ç›®çš„ package.json æ–‡ä»¶ä¸­ï¼Œæ·»åŠ  &quot;sideEffects&quot; å±æ€§ã€‚ ä½¿ç”¨ mode ä¸º &quot;production&quot; çš„é…ç½®é¡¹ä»¥å¯ç”¨æ›´å¤šä¼˜åŒ–é¡¹ï¼ŒåŒ…æ‹¬å‹ç¼©ä»£ç ä¸ tree shakingã€‚ 6.webpackçƒ­æ›´æ–°åŸç†webpackæ¨¡å—çƒ­æ›´æ–°ä¹Ÿå°±æ˜¯HMRï¼ŒHot Module Replacementï¼Œå®ƒæ˜¯æŒ‡åº”ç”¨ç¨‹åºè¿è¡Œè¿‡ç¨‹ä¸­ï¼Œæ›¿æ¢ã€æ·»åŠ ã€åˆ é™¤æ¨¡å—ï¼Œè€Œæ— éœ€åˆ·æ–°æ•´ä¸ªé¡µé¢ è¿™é‡Œè¦æ³¨æ„çš„æ˜¯çƒ­æ›´æ–°çš„æ—¶å€™ï¼Œå¹¶æ²¡æœ‰è‡ªåŠ¨åˆ·æ–°æµè§ˆå™¨ ä¸éœ€è¦é‡æ–°åŠ è½½æ•´ä¸ªé¡µé¢ï¼Œå¯ä»¥ä¿è¯æŸäº›åº”ç”¨ç¨‹åºçš„çŠ¶æ€ä¸ä¸¢å¤±ã€‚ åªæ›´æ–°éœ€è¦å˜åŒ–çš„å†…å®¹ï¼ŒèŠ‚çœå¼€å‘æ—¶é—´ ä¿®æ”¹äº†cssã€jsçš„æºä»£ç ï¼Œä¾¿ä¼šç«‹å³åœ¨æµè§ˆå™¨æ›´æ–°ï¼Œç›¸å½“äºåœ¨æµè§ˆå™¨å¼€å‘è€…æ¨¡å¼devtoolsä¸­ç›´æ¥æ›´æ”¹æ ·å¼ ä½¿ç”¨ï¼šé»˜è®¤æƒ…å†µä¸‹ webpack-dev-serverï¼ˆä¹Ÿå°±æ˜¯ä¸Šæ–¹å®‰è£…çš„æ­å»ºæœåŠ¡ï¼‰å·²ç»æ”¯æŒäº†HMRï¼Œæˆ‘ä»¬åªéœ€è¦å¼€å¯å³å¯ã€‚ä¸å¼€å¯åˆ™ä¸ºlive reloadingï¼Œæ•´ä¸ªé¡µé¢è¿›è¡Œåˆ·æ–° module.exports = { //... target: \"web\", //ç»™webæ‰“åŒ…ï¼Œæˆ–è€…å€¼ä¸ºnodeï¼Œåˆ™ä¸ºnodeæ‰“åŒ… devServer: { hot: true } }; ä½†æ˜¯éœ€è¦å‘Šè¯‰webpackï¼Œå“ªäº›æ¨¡å—ç”¨åˆ°çƒ­æ›´æ–°ï¼Œåœ¨webpackä¸­éœ€è¦é…åˆmodule.hotè¿›è¡Œä½¿ç”¨. ä½†æ˜¯åƒVueã€Reactç­‰æ¡†æ¶ï¼Œä»–ä»¬æœ‰vue-loaderã€react-refreshç­‰ï¼Œå¯ä»¥åšåˆ°å¼€ç®±å³ç”¨ è¿˜æœ‰ä¸€ä¸ªçƒ­åŠ è½½ï¼Œä¹Ÿå°±æ˜¯æ–‡ä»¶æ›´æ–°æ—¶ï¼Œè‡ªåŠ¨åˆ·æ–°æˆ‘ä»¬çš„æœåŠ¡å’Œé¡µé¢ module.exports = { //... devServer: { liveReload: true //é»˜è®¤ä¸ºtrue } }; HMRå®é™…ä¸Šæ˜¯ä½¿ç”¨äº†ä¸€ä¸ªæ’ä»¶ï¼šHotModuleReplacementPlugin,ä½†æ˜¯æˆ‘ä»¬webpack5å·²ç»å¼€ç®±å³ç”¨äº† HMRåŸç†æ˜¯webpack-dev-serverä¼šåˆ›å»ºä¸¤ä¸ªæœåŠ¡ï¼Œæä¾›é™æ€èµ„æºæœåŠ¡çš„expressã€å’ŒSocketæœåŠ¡ï¼ˆnet.Socketï¼‰ HMR Socket Serveræ˜¯ä¸€ä¸ªsocketé•¿è¿æ¥ï¼š ä½¿ç”¨expresså¯åŠ¨æœ¬åœ°æœåŠ¡ï¼Œå½“æµè§ˆå™¨è®¿é—®èµ„æºæ—¶å¯¹æ­¤åšå“åº”ã€‚ æœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯ä½¿ç”¨websocketå®ç°é•¿è¿æ¥ webpackç›‘å¬æºæ–‡ä»¶çš„å˜åŒ–ï¼Œå³å½“å¼€å‘è€…ä¿å­˜æ–‡ä»¶æ—¶è§¦å‘webpackçš„é‡æ–°ç¼–è¯‘ã€‚ æ¯æ¬¡ç¼–è¯‘éƒ½ä¼šç”Ÿæˆhashå€¼ã€å·²æ”¹åŠ¨æ¨¡å—çš„jsonæ–‡ä»¶ã€å·²æ”¹åŠ¨æ¨¡å—ä»£ç çš„jsæ–‡ä»¶ ç¼–è¯‘å®Œæˆåé€šè¿‡socketå‘å®¢æˆ·ç«¯æ¨é€å½“å‰ç¼–è¯‘çš„hashæˆ³ å®¢æˆ·ç«¯çš„websocketç›‘å¬åˆ°æœ‰æ–‡ä»¶æ”¹åŠ¨æ¨é€è¿‡æ¥çš„hashæˆ³ï¼Œä¼šå’Œä¸Šä¸€æ¬¡å¯¹æ¯” ä¸€è‡´åˆ™èµ°ç¼“å­˜ ä¸ä¸€è‡´åˆ™é€šè¿‡ajaxå’Œjsonpå‘æœåŠ¡ç«¯è·å–æœ€æ–°èµ„æº ä½¿ç”¨å†…å­˜æ–‡ä»¶ç³»ç»Ÿå»æ›¿æ¢æœ‰ä¿®æ”¹çš„å†…å®¹å®ç°å±€éƒ¨åˆ·æ–° ä¹Ÿå¯ä»¥ç†è§£ä¸ºæœ¬åœ°æœåŠ¡å™¨å’Œæµè§ˆå™¨ç«¯å½¢æˆä¸€ä¸ªå®Œæˆçš„é€šä¿¡åŒæ–¹ï¼Œè¿›è¡Œsocketé€šä¿¡ å®ç°çƒ­æ›´æ–° å›¾ç‰‡æ¥è‡ªé¥¿äº†ä¹ˆå‰ç«¯@çŸ¥ä¹ä¸“æ  ä¸Šå›¾åº•éƒ¨çº¢è‰²æ¡†å†…æ˜¯æœåŠ¡ç«¯ï¼Œè€Œä¸Šé¢çš„æ©™è‰²æ¡†æ˜¯æµè§ˆå™¨ç«¯ã€‚ ç»¿è‰²çš„æ–¹æ¡†æ˜¯ webpack ä»£ç æ§åˆ¶çš„åŒºåŸŸã€‚è“è‰²æ–¹æ¡†æ˜¯ webpack-dev-server ä»£ç æ§åˆ¶çš„åŒºåŸŸï¼Œæ´‹çº¢è‰²çš„æ–¹æ¡†æ˜¯æ–‡ä»¶ç³»ç»Ÿï¼Œæ–‡ä»¶ä¿®æ”¹åçš„å˜åŒ–å°±å‘ç”Ÿåœ¨è¿™ï¼Œè€Œé’è‰²çš„æ–¹æ¡†æ˜¯åº”ç”¨æœ¬èº«ã€‚ ç¬¬ä¸€æ­¥ï¼Œåœ¨ webpack çš„ watch æ¨¡å¼ä¸‹ï¼Œæ–‡ä»¶ç³»ç»Ÿä¸­æŸä¸€ä¸ªæ–‡ä»¶å‘ç”Ÿä¿®æ”¹ï¼Œwebpack ç›‘å¬åˆ°æ–‡ä»¶å˜åŒ–ï¼Œæ ¹æ®é…ç½®æ–‡ä»¶å¯¹æ¨¡å—é‡æ–°ç¼–è¯‘æ‰“åŒ…ï¼Œå¹¶å°†æ‰“åŒ…åçš„ä»£ç é€šè¿‡ç®€å•çš„ JavaScript å¯¹è±¡ä¿å­˜åœ¨å†…å­˜ä¸­ï¼Œå¹¶ä¸”ç”Ÿæˆäº†ä¸€ä¸ª Hashå€¼ã€‚ ç¬¬äºŒæ­¥ï¼Œwebpack-dev-server å’Œ webpack ä¹‹é—´çš„æ¥å£äº¤äº’ï¼Œè€Œåœ¨è¿™ä¸€æ­¥ï¼Œä¸»è¦æ˜¯ dev-server çš„ä¸­é—´ä»¶ webpack-dev-middleware å’Œ webpack ä¹‹é—´çš„äº¤äº’ï¼Œwebpack-dev-middleware è°ƒç”¨ webpack æš´éœ²çš„ API ï¼ˆ compiler.watch() ï¼‰å¯¹ä»£ç å˜åŒ–è¿›è¡Œç›‘æ§ï¼Œå¹¶ä¸”å‘Šè¯‰ webpackï¼Œå°†ä»£ç æ‰“åŒ…åˆ°å†…å­˜ä¸­ï¼ˆä½¿ç”¨ webpack-dev-middleware ä¸€ä¸ªä¾èµ–åº“ memory-fs ï¼‰ã€‚ ç¬¬ä¸‰æ­¥æ˜¯ webpack-dev-server å¯¹æ–‡ä»¶å˜åŒ–çš„ä¸€ä¸ªç›‘æ§ï¼Œè¿™ä¸€æ­¥ä¸åŒäºç¬¬ä¸€æ­¥ï¼Œå¹¶ä¸æ˜¯ç›‘æ§ä»£ç å˜åŒ–é‡æ–°æ‰“åŒ…ã€‚å½“æˆ‘ä»¬åœ¨é…ç½®æ–‡ä»¶ä¸­é…ç½®äº†devServer.watchContentBase ä¸º true çš„æ—¶å€™ï¼ŒServer ä¼šç›‘å¬è¿™äº›é…ç½®æ–‡ä»¶å¤¹ä¸­é™æ€æ–‡ä»¶çš„å˜åŒ–ï¼Œå˜åŒ–åä¼šé€šçŸ¥æµè§ˆå™¨ç«¯å¯¹åº”ç”¨è¿›è¡Œ live reloadã€‚æ³¨æ„ï¼Œè¿™å„¿æ˜¯æµè§ˆå™¨åˆ·æ–°ï¼Œå’Œ HMR æ˜¯ä¸¤ä¸ªæ¦‚å¿µã€‚ ç¬¬å››æ­¥ä¹Ÿæ˜¯ webpack-dev-server ä»£ç çš„å·¥ä½œï¼Œè¯¥æ­¥éª¤ä¸»è¦æ˜¯é€šè¿‡ sockjsï¼ˆwebpack-dev-server çš„ä¾èµ–ï¼‰åœ¨æµè§ˆå™¨ç«¯å’ŒæœåŠ¡ç«¯ä¹‹é—´å»ºç«‹ä¸€ä¸ª websocket é•¿è¿æ¥ï¼Œå°† webpack ç¼–è¯‘æ‰“åŒ…çš„å„ä¸ªé˜¶æ®µçš„çŠ¶æ€ä¿¡æ¯å‘ŠçŸ¥æµè§ˆå™¨ç«¯ï¼ŒåŒæ—¶ä¹ŸåŒ…æ‹¬ç¬¬ä¸‰æ­¥ä¸­ Server ç›‘å¬é™æ€æ–‡ä»¶å˜åŒ–çš„ä¿¡æ¯ã€‚æµè§ˆå™¨ç«¯æ ¹æ®è¿™äº› socket æ¶ˆæ¯è¿›è¡Œä¸åŒçš„æ“ä½œã€‚å½“ç„¶æœåŠ¡ç«¯ä¼ é€’çš„æœ€ä¸»è¦ä¿¡æ¯è¿˜æ˜¯æ–°æ¨¡å—çš„ Hash å€¼ï¼Œåé¢çš„æ­¥éª¤æ ¹æ®è¿™ä¸€ Hash å€¼æ¥è¿›è¡Œæ¨¡å—çƒ­æ›¿æ¢ã€‚å…¶ä¸­å…³äºwebsocketçš„æ¶ˆæ¯æ¥æ”¶ï¼Œæ˜¯å› ä¸ºwebpack-dev-server ä¿®æ”¹äº†webpack é…ç½®ä¸­çš„ entry å±æ€§ï¼Œåœ¨é‡Œé¢æ·»åŠ äº† webpack-dev-client çš„ä»£ç ï¼Œè¿™æ ·åœ¨æœ€åçš„ bundle.js æ–‡ä»¶ä¸­å°±ä¼šæœ‰æ¥æ”¶ websocket æ¶ˆæ¯çš„ä»£ç äº†ã€‚ ç¬¬äº”ã€å…­æ­¥ï¼Œwebpack-dev-server/client ç«¯å¹¶ä¸èƒ½å¤Ÿè¯·æ±‚æ›´æ–°çš„ä»£ç ï¼Œä¹Ÿä¸ä¼šæ‰§è¡Œçƒ­æ›´æ¨¡å—æ“ä½œï¼Œè€ŒæŠŠè¿™äº›å·¥ä½œåˆäº¤å›ç»™äº† webpackï¼Œwebpack/hot/dev-server çš„å·¥ä½œå°±æ˜¯æ ¹æ® webpack-dev-server/client ä¼ ç»™å®ƒçš„ä¿¡æ¯ä»¥åŠ dev-server çš„é…ç½®å†³å®šæ˜¯åˆ·æ–°æµè§ˆå™¨å‘¢è¿˜æ˜¯è¿›è¡Œæ¨¡å—çƒ­æ›´æ–°ã€‚å½“ç„¶å¦‚æœä»…ä»…æ˜¯åˆ·æ–°æµè§ˆå™¨ï¼Œä¹Ÿå°±æ²¡æœ‰åé¢é‚£äº›æ­¥éª¤äº†ã€‚ ç¬¬ä¸ƒã€å…«ã€ä¹æ­¥ï¼ŒHotModuleReplacement.runtime æ˜¯å®¢æˆ·ç«¯ HMR çš„ä¸­æ¢ï¼Œå®ƒæ¥æ”¶åˆ°ä¸Šä¸€æ­¥ä¼ é€’ç»™ä»–çš„æ–°æ¨¡å—çš„ Hash å€¼ï¼Œå®ƒé€šè¿‡ JsonpMainTemplate.runtime å‘ server ç«¯å‘é€ Ajax è¯·æ±‚ï¼ŒæœåŠ¡ç«¯è¿”å›ä¸€ä¸ª jsonï¼Œè¯¥ json åŒ…å«äº†æ‰€æœ‰è¦æ›´æ–°çš„æ¨¡å—çš„ hash å€¼ï¼Œä»¥æŸ¥çœ‹æ˜¯å¦éœ€è¦æ›´æ–°ï¼Œè·å–åˆ°æ›´æ–°åˆ—è¡¨åï¼Œè¯¥æ¨¡å—å†æ¬¡é€šè¿‡ jsonp è¯·æ±‚ï¼Œè·å–åˆ°æœ€æ–°çš„æ¨¡å—ä»£ç ï¼ˆä¸»è¦æ˜¯å› ä¸ºJSONPè·å–çš„ä»£ç å¯ä»¥ç›´æ¥æ‰§è¡Œï¼‰ã€‚ è€Œç¬¬ å æ­¥æ˜¯å†³å®š HMR æˆåŠŸä¸å¦çš„å…³é”®æ­¥éª¤ï¼Œåœ¨è¯¥æ­¥éª¤ä¸­ï¼ŒHotModulePlugin å°†ä¼šå¯¹æ–°æ—§æ¨¡å—è¿›è¡Œå¯¹æ¯”ï¼Œå†³å®šæ˜¯å¦æ›´æ–°æ¨¡å—ï¼Œåœ¨å†³å®šæ›´æ–°æ¨¡å—åï¼Œæ£€æŸ¥æ¨¡å—ä¹‹é—´çš„ä¾èµ–å…³ç³»ï¼Œæ›´æ–°æ¨¡å—çš„åŒæ—¶æ›´æ–°æ¨¡å—é—´çš„ä¾èµ–å¼•ç”¨ã€‚ æœ€åä¸€æ­¥ï¼Œå½“ HMR å¤±è´¥åï¼Œå›é€€åˆ° livereload æ“ä½œï¼Œä¹Ÿå°±æ˜¯è¿›è¡Œæµè§ˆå™¨åˆ·æ–°æ¥è·å–æœ€æ–°æ‰“åŒ…ä»£ç ã€‚ https://zhuanlan.zhihu.com/p/30669007 7.webpackæ‰“åŒ…åº“å¦‚æœæƒ³è¦ç¼–å†™è‡ªå·±çš„åº“ï¼Œä¾›å…¶ä»–äººä½¿ç”¨ï¼Œéœ€è¦åœ¨webpackä¸­é…ç½® //webpack.config.js const path = require(\"path\"); module.exports = { mode: \"production\", entry: \"./src/index.js\", output: { path: path.join(__dirname, \"dist\"), filename: \"bundle.js\", //æ‰“åŒ…åçš„æ–‡ä»¶å library: \"littleLib\", }, }; å½“ç„¶ï¼Œä½œä¸ºåº“çš„ä½œè€…ï¼Œå¸Œæœ›è‡ªå·±çš„åº“èƒ½é€šè¿‡commonjsã€scriptæ ‡ç­¾ã€amdã€esmoduleç­‰å½¢å¼è¿›è¡Œå¼•ç”¨ const path = require(\"path\"); module.exports = { //... experiments: { outputModule: true, //å¦‚æœä»¥es moduleçš„å½¢å¼å¯¼å‡ºï¼Œåˆ™éœ€è¦é…ç½®experiments.outputModuleé¡¹,å› ä¸ºè¿˜æ˜¯å®éªŒæ€§çš„ }, output: { //... library: { type: \"module\", //ä»¥es moduleå½¢å¼å¯¼å‡ºï¼Œä¸èƒ½è®¾ç½®åå­— }, }, }; module.exports = { //... output: { //... library: { name: \"littleLib\", type: \"umd\", //æ”¯æŒè¿è¡Œåœ¨ CommonJSã€AMDã€Node.js ç­‰ç¯å¢ƒä¸­ã€‚ }, }, }; ä¸­é—´æ’æ’­å°ç¬‘è¯ éƒ¨åˆ†èµ„æ–™å‚è€ƒåœ°å€https://juejin.cn/post/6844903877771264013 8.webpack5æ¨¡å—è”é‚¦å…±äº«æ¨¡å—çš„æ–¹å¼ï¼š NPM æ–¹å¼å…±äº«æ¨¡å— å¯¹äºé¡¹ç›® Home ä¸ Searchï¼Œéœ€è¦å…±äº«ä¸€ä¸ªæ¨¡å—æ—¶ï¼Œæœ€å¸¸è§çš„åŠæ³•å°±æ˜¯å°†å…¶æŠ½æˆé€šç”¨ä¾èµ–å¹¶åˆ†åˆ«å®‰è£…åœ¨å„è‡ªé¡¹ç›®ä¸­ã€‚ç¼ºç‚¹æ˜¯è¦èµ°æœ¬åœ°ç¼–è¯‘ï¼ˆéœ€è¦æ›´æ–°npmåŒ…ï¼Œ npm installï¼Œå†æ„å»º + å‘å¸ƒï¼Œè€Œä¸”äº§ç‰©ä½“ç§¯å¯èƒ½ä¼šåå¤§ï¼‰ è™½ç„¶ Monorepo å¯ä»¥ä¸€å®šç¨‹åº¦è§£å†³é‡å¤å®‰è£…å’Œä¿®æ”¹å›°éš¾çš„é—®é¢˜ï¼ˆä¾èµ–å¤ç”¨ï¼‰ï¼Œä½†ä¾ç„¶éœ€è¦èµ°æœ¬åœ°ç¼–è¯‘ï¼Œå¹¶ä¸”è¿˜è¦æ±‚æ‰€æœ‰çš„åº”ç”¨ä»£ç å¿…é¡»æ”¾åˆ°åŒä¸€ä¸ªä»“åº“ã€‚ umdå…±äº«æ¨¡å— å°†æ¨¡å—ç”¨ Webpack UMD æ¨¡å¼æ‰“åŒ…ï¼Œå¹¶è¾“å‡ºåˆ°å…¶ä»–é¡¹ç›®ä¸­ã€‚è¿™æ˜¯éå¸¸æ™®éçš„æ¨¡å—å…±äº«æ–¹å¼ åƒè¿™ç§ &lt;!DOCTYPE html> &lt;html lang=\"en\"> &lt;head> &lt;meta charset=\"UTF-8\" /> &lt;link rel=\"icon\" type=\"image/svg+xml\" href=\"/src/favicon.svg\" /> &lt;meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\" /> &lt;title>Vite App&lt;/title> &lt;/head> &lt;body> &lt;div id=\"root\">&lt;/div> &lt;!-- ä» CDN ä¸Šå¼•å…¥ç¬¬ä¸‰æ–¹ä¾èµ–çš„ä»£ç  --> &lt;script src=\"https://cdn.jsdelivr.net/npm/react@17.0.2/index.min.js\">&lt;script> &lt;script src=\"https://cdn.jsdelivr.net/npm/react-dom@17.0.2/index.min.js\">&lt;script> &lt;/body> &lt;/html> ä½†è¿™ç§æŠ€æœ¯æ–¹æ¡ˆé—®é¢˜ä¹Ÿå¾ˆæ˜æ˜¾ï¼Œå°±æ˜¯åŒ…ä½“ç§¯æ— æ³•è¾¾åˆ°æœ¬åœ°ç¼–è¯‘æ—¶çš„ä¼˜åŒ–æ•ˆæœ(å…¨é‡å¼•ç”¨)ï¼Œä¸”åº“ä¹‹é—´å®¹æ˜“å†²çªï¼ˆåº“å¼•å…¥é¡ºåºï¼‰ã€‚ å¾®å‰ç«¯å…±äº«æ¨¡å— ä½†æ˜¯å¾®å‰ç«¯ä¼šå‡ºç°ä»¥ä¸‹é—®é¢˜ 1ï¼‰å­åº”ç”¨ç‹¬ç«‹æ‰“åŒ…ï¼Œæ¨¡å—æ›´è§£è€¦ï¼Œä½†æ— æ³•æŠ½å–å…¬å…±ä¾èµ–ç­‰ã€‚ 2ï¼‰æ•´ä½“åº”ç”¨ä¸€èµ·æ‰“åŒ…ï¼Œå¾ˆå¥½è§£å†³ä¸Šé¢çš„é—®é¢˜ï¼Œä½†æ‰“åŒ…é€Ÿåº¦å®åœ¨æ˜¯å¤ªæ…¢äº†ï¼Œä¸å…·å¤‡æ°´å¹³æ‰©å±•èƒ½åŠ›ã€‚ webpack5çš„æ¨¡å—è”é‚¦ï¼Œæ˜¯ç›´æ¥å°†åŸæ¥çš„åº”ç”¨ä¾èµ–çš„åŒ…ï¼ˆæ¨¡å—ï¼‰ï¼Œç›´æ¥å¼•ç”¨äºå¦å¤–ä¸€ä¸ªé¡¹ç›®/åº”ç”¨ï¼Œåœ¨æ¨¡å—è”é‚¦ä¸­ï¼Œæ›´æ³¨é‡é¡¹ç›®ä¸é¡¹ç›®ä¹‹é—´çš„å¼•ç”¨ï¼ˆAç”¨äº†Bçš„xxæ¨¡å—ï¼ŒBç”¨äº†Cçš„xxæ¨¡å—ï¼‰ï¼Œç›¸å¯¹æ¥è¯´æ˜¯mf æ˜¯å»ä¸­å¿ƒåŒ–çš„(å…¶å®ä¹ŸæŒºåƒnpmåŒ…çš„æ„Ÿè§‰)ï¼Œå½“ç„¶è¿™ç§å¼•ç”¨å…³ç³»ä¹Ÿå¯ä»¥è¿ç”¨åˆ°å¾®å‰ç«¯è¿™ç§çªå‡ºä¸»å’Œå­åº”ç”¨çš„å…³ç³»ä¸­å» åº•å±‚æ¦‚å¿µæˆ‘ä»¬åŒºåˆ†æœ¬åœ°æ¨¡å—å’Œè¿œç¨‹æ¨¡å—ã€‚æœ¬åœ°æ¨¡å—å³ä¸ºæ™®é€šæ¨¡å—ï¼Œæ˜¯å½“å‰æ„å»ºçš„ä¸€éƒ¨åˆ†ã€‚è¿œç¨‹æ¨¡å—ä¸å±äºå½“å‰æ„å»ºï¼Œå¹¶åœ¨è¿è¡Œæ—¶ä»æ‰€è°“çš„å®¹å™¨åŠ è½½ã€‚ åŠ è½½è¿œç¨‹æ¨¡å—è¢«è®¤ä¸ºæ˜¯å¼‚æ­¥æ“ä½œã€‚å½“ä½¿ç”¨è¿œç¨‹æ¨¡å—æ—¶ï¼Œè¿™äº›å¼‚æ­¥æ“ä½œå°†è¢«æ”¾ç½®åœ¨è¿œç¨‹æ¨¡å—å’Œå…¥å£ä¹‹é—´çš„ä¸‹ä¸€ä¸ª chunk çš„åŠ è½½æ“ä½œä¸­ã€‚å¦‚æœæ²¡æœ‰ chunk åŠ è½½æ“ä½œï¼Œå°±ä¸èƒ½ä½¿ç”¨è¿œç¨‹æ¨¡å—ã€‚ å®¹å™¨æ˜¯ç”±å®¹å™¨å…¥å£åˆ›å»ºçš„ï¼Œè¯¥å…¥å£æš´éœ²äº†å¯¹ç‰¹å®šæ¨¡å—çš„å¼‚æ­¥è®¿é—®ã€‚æš´éœ²çš„è®¿é—®åˆ†ä¸ºä¸¤ä¸ªæ­¥éª¤ï¼š åŠ è½½æ¨¡å—ï¼ˆå¼‚æ­¥çš„ï¼‰ æ‰§è¡Œæ¨¡å—ï¼ˆåŒæ­¥çš„ï¼‰ å¾®å‰ç«¯ è®©åº”ç”¨å…·å¤‡æ¨¡å—åŒ–è¾“å‡ºèƒ½åŠ›ï¼Œå…¶å®å¼€è¾Ÿäº†ä¸€ç§æ–°çš„åº”ç”¨å½¢æ€ï¼Œå³ â€œä¸­å¿ƒåº”ç”¨â€ï¼Œï¼ˆå…¶å®ä¹Ÿå°±æ˜¯å¾®å‰ç«¯ï¼‰è¿™ä¸ªä¸­å¿ƒåº”ç”¨ç”¨äºåœ¨çº¿åŠ¨æ€åˆ†å‘ Runtime å­æ¨¡å—ï¼Œå¹¶ä¸ç›´æ¥æä¾›ç»™ç”¨æˆ·ä½¿ç”¨ è€Œåœ¨å¾®å‰ç«¯é¢†åŸŸï¼Œè¿™ä¸ªä¸»åº”ç”¨å°±æ˜¯åº”ç”¨ä¸­å¿ƒï¼Œæ‰€æœ‰å­åº”ç”¨éƒ½å¯ä»¥åˆ©ç”¨ Runtime æ–¹å¼å¤ç”¨ä¸»åº”ç”¨çš„ Npm åŒ…å’Œæ¨¡å—ï¼Œæ›´å¥½çš„é›†æˆåˆ°ä¸»åº”ç”¨ä¸­ã€‚ è¯„è®ºçœ‹åˆ°ç½‘ä¸Šçš„ä¸€æ¡è¯„è®ºï¼š è¿™ä¸å°±æ˜¯ä¸€ä¸ªåŒ… æ„å»ºä¸€ä¸ªå…¨é‡umd +å•ç‹¬å£°æ˜entryçš„umd +å•ç‹¬umdçš„entry/sharedé›†åˆ å˜›ã€‚ã€‚ã€‚ è‡³äºsharedï¼Œå’Œexternalæ²¡ä»€ä¹ˆåŒºåˆ«ï¼Œåªæ˜¯å¯ä»¥æ„å»ºæ—¶ç”Ÿæˆç½¢äº†ã€‚ å…¶ä¸­sharedéƒ¨åˆ†ä¹Ÿä¸èƒ½åšæ„å»ºä¼˜åŒ–ï¼Œåªèƒ½å…¨é‡æ‰“åŒ…ã€‚ æ„ä¹‰å°±æ˜¯ä»¥å‰ä¸€ä¸ªåŒ…ä¸€ä¸ªå…¥å£å¼•å…¥æ‰€æœ‰å†…å®¹ï¼Œç°åœ¨å¯ä»¥æŒ‰éœ€æ‰“åŒ…äº†ã€‚ æ¯”å¦‚antdå¯ä»¥åœ¨å‘å¸ƒçš„æ—¶å€™æ¯ä¸ªç»„ä»¶æ‰“ä¸€ä¸ªumdï¼Œå†åŠ ä¸Šä¸€ä¸ªæ•´ä½“çš„runtimeã€‚ äºæ˜¯å°±å½¢æˆäº† 1.umdå¼•å…¥ 2.umdå¼•å…¥runtime+å•ç‹¬entryåŠ¨æ€å¼•å…¥ ä½†æ˜¯è¦æƒ³é€‰å‡ºæ¥éœ€è¦ç”¨çš„åŒ…ç»„åˆæˆä¸€ä¸ªæ–‡ä»¶ï¼Œåªèƒ½é‡æ–°æ‰“åŒ…ã€‚ è€Œä¸”ä½¿ç”¨2å¼•å…¥æ–¹å¼ï¼Œå¿…é¡»ç”¨import()ï¼Œå¦åˆ™ç½‘ç»œå»¶è¿Ÿä¼šé˜»å¡æ¸²æŸ“ï¼Œç›¸å½“äºæ˜¯requirejsçš„æœºåˆ¶ã€‚å¾®å‰ç«¯å½¼æ­¤é—´çš„ä¾èµ–ç‰ˆæœ¬ä¼°è®¡éƒ½æ˜¯å¤§ç›¸å¾„åº­çš„ï¼Œå¾ˆéš¾ç›´æ¥å» share libaray ã€‚ Service çš„ share å¯èƒ½æ›´åˆé€‚ä¸€äº›ï¼Œæ¯”å¦‚ä»å‰å°†é€šç”¨ä¸šåŠ¡æŠ½æˆ npm åŒ…çš„æ–¹å¼ï¼Œå¯ä»¥ç”¨è¿™ç§æ–¹å¼ä»£æ›¿äº†ã€‚ ç›¸è¾ƒäºæ•´ä½“æ‰“åŒ…ï¼Œå­é¡¹ç›®å•ç‹¬å‘å¸ƒå«â€œæ°´å¹³æ‰©å±•â€ï¼Œä¸å¤ªåˆé€‚å§ã€‚å®è·µæ¨¡å—è”é‚¦æœ¬èº«æ˜¯ä¸€ä¸ªæ™®é€šçš„ Webpack æ’ä»¶ ModuleFederationPluginï¼Œæ’ä»¶æœ‰å‡ ä¸ªé‡è¦å‚æ•°ï¼š name å½“å‰åº”ç”¨åç§°ï¼Œéœ€è¦å…¨å±€å”¯ä¸€ã€‚ remotes å¯ä»¥å°†å…¶ä»–é¡¹ç›®çš„ name æ˜ å°„åˆ°å½“å‰é¡¹ç›®ä¸­ï¼ˆremoteè¯‘ä¸ºè¿œç¨‹çš„ï¼‰ exposes è¡¨ç¤ºå¯¼å‡ºçš„æ¨¡å—ï¼Œç±»ä¼¼äºexportï¼Œåªæœ‰åœ¨æ­¤ç”³æ˜çš„æ¨¡å—æ‰å¯ä»¥ä½œä¸ºè¿œç¨‹ä¾èµ–è¢«ä½¿ç”¨ï¼Œéœ€è¦æ³¨æ„çš„keyéœ€è¦åŠ ä¸Š ./ã€‚ shared æ˜¯éå¸¸é‡è¦çš„å‚æ•°ï¼Œåˆ¶å®šäº†è¿™ä¸ªå‚æ•°ï¼Œå¯ä»¥è®©è¿œç¨‹åŠ è½½çš„æ¨¡å—å¯¹åº”ä¾èµ–æ”¹ä¸ºä½¿ç”¨æœ¬åœ°é¡¹ç›®çš„ React æˆ– ReactDOMã€‚ æ¨¡å—è”é‚¦çš„ä½¿ç”¨æ–¹å¼å¦‚ä¸‹ï¼š ä¸€å…±æœ‰ä¸‰ä¸ªå¾®åº”ç”¨:lib-appã€component-appã€main-appï¼Œè§’è‰²åˆ†åˆ«æ˜¯ï¼š lib-appas remote,æš´éœ²äº†ä¸¤ä¸ªæ¨¡å—reactå’Œreact-domï¼ˆå…¬å…±reactå’Œreact-domï¼‰ component-app as remote and host,ä¾èµ–lib-appæš´éœ²çš„ reactå’Œreact-dom ï¼Œæš´éœ²äº†ä¸€äº›ç»„ä»¶ä¾›main-appæ¶ˆè´¹ main-app as host,ä¾èµ–lib-appå’Œcomponent-app æš´éœ²lib-appæ¨¡å—//webpack.config.js module.exports = { //...çœç•¥ plugins: [ new ModuleFederationPlugin({ name: \"lib_app\", filename: \"remoteEntry.js\", exposes: { \"./react\":\"react\", \"./react-dom\":\"react-dom\" } }) ], //...çœç•¥ } ç¼–è¯‘åçš„ç»“æœï¼š é™¤å»ç”Ÿæˆçš„mapæ–‡ä»¶ï¼Œæœ‰å››ä¸ªæ–‡ä»¶ï¼šmain.jsã€remoteEntry.jsã€...react_index.jsã€...react-dom_index.jsï¼› ç¬¬ä¸€ä¸ªæ˜¯æœ¬é¡¹ç›®çš„å…¥å£æ–‡ä»¶ï¼ˆè¯¥é¡¹ç›®åªæ˜¯æš´éœ²æ¥å£ï¼Œæ‰€ä»¥è¯¥æ–‡ä»¶ä¸ºç©ºï¼‰ ç¬¬äºŒä¸ªæ˜¯è¿œç¨‹å…¥å£æ–‡ä»¶ï¼Œå…¶ä»–webpackæ„å»ºä½¿ç”¨ã€è®¿é—®æœ¬é¡¹ç›®æš´éœ²çš„æ¨¡å—æ—¶ï¼Œé¡»é€šè¿‡å®ƒæ¥åŠ è½½ ç¬¬ä¸‰ä¸ªå’Œç¬¬å››ä¸ªæ˜¯æš´éœ²çš„æ¨¡å—ï¼Œä¾›å…¶ä»–é¡¹ç›®æ¶ˆè´¹(ä½¿ç”¨) component-appçš„é…ç½®ä¾èµ–lib-app,æš´éœ²ä¸‰ä¸ªæ¨¡å—ç»„ä»¶Buttonã€Dialogã€Logo //webpack.config.js module.exports = { //...çœç•¥ plugins:[ new ModuleFederationPlugin({ name: \"component_app\", filename: \"remoteEntry.js\", exposes: { \"./Button\":\"./src/Button.jsx\", \"./Dialog\":\"./src/Dialog.jsx\", \"./Logo\":\"./src/Logo.jsx\" }, remotes:{ \"lib-app\":\"lib_app@http://localhost:3000/remoteEntry.js\" } }), ] } ç„¶ååœ¨ä¸‰ä¸ªç»„ä»¶å†…ä½¿ç”¨å¼•å…¥çš„remoteï¼ˆlib-appï¼‰ //Dialog.jsx import React from 'lib-app/react'; export default class Dialog extends React.Component { //... } export default class Button extends React.Component { //... } export default class Logo extends React.Component { //... } main-appé…ç½®main-appä¾èµ–ä¸¤ä¸ªé¡¹ç›®lib-appã€component-appã€‚ ///webpack.config.js module.exports = { //çœç•¥... plugins: [ new ModuleFederationPlugin({ name: \"main_app\", remotes:{ \"lib-app\":\"lib_app@http://localhost:3000/remoteEntry.js\", \"component-app\":\"component_app@http://localhost:3001/remoteEntry.js\" }, }), new HtmlWebpackPlugin({ template: \"./public/index.html\", }) ] //çœç•¥... }; ç”±äºéœ€è¦ç­‰å¾…åŸºç¡€æ¨¡å—åŠ è½½å®Œæ¯•ï¼Œæ‰€ä»¥éœ€è¦é…ç½®æ‡’åŠ è½½å…¥å£bootstrap.js. webpackæ‰“åŒ…å…¥å£æ–‡ä»¶ import(\"./bootstrap.js\") bootstrap.js import App from './App.jsx' import ReactDOM from 'lib-app/react-dom'; import React from 'lib-app/react' ReactDOM.render(&lt;App />, document.getElementById(\"app\")); æ ¹ç»„ä»¶App.jsx import React from 'lib-app/react'; import Button from 'component-app/Button' import Dialog from 'component-app/Dialog' import Logo from 'component-app/Logo' export default class App extends React.Component{ //... } ä¸‹è½½è„šæœ¬ç½‘ä¸Šæ‰’è¿‡æºç ï¼Œä¸‹è½½è„šæœ¬æœ¬è´¨ä¹Ÿæ˜¯é€šè¿‡jsonpçš„å½¢å¼ä¸‹è½½ é€šè¿‡webpack_require.l(url, errorHandler, chunkName)ä¸‹è½½è„šæœ¬ï¼š /* webpack/runtime/load script */ (() => { var inProgress = {}; var dataWebpackPrefix = 'webpack5-demo:'; // loadScript function to load a script via script tag __webpack_require__.l = (url, done, key) => { if (inProgress[url]) { inProgress[url].push(done); return; } var script, needAttach; if (key !== undefined) { var scripts = document.getElementsByTagName('script'); for (var i = 0; i &lt; scripts.length; i++) { var s = scripts[i]; if ( s.getAttribute('src') == url || s.getAttribute('data-webpack') == dataWebpackPrefix + key ) { script = s; break; } } } if (!script) { needAttach = true; // åˆ›å»º script æ ‡ç­¾ script = document.createElement('script'); script.charset = 'utf-8'; script.timeout = 120; if (__webpack_require__.nc) { script.setAttribute('nonce', __webpack_require__.nc); } script.setAttribute('data-webpack', dataWebpackPrefix + key); // è®¾ç½® src = 'http://127.0.0.1:2001/examples_app1_say_js.bundle.js' script.src = url; // åˆ°è¿™è¿œç¨‹è„šæœ¬ examples_app1_say_js.bundle.js åº”è¯¥å°±å¼€å§‹ä¸‹è½½äº† } inProgress[url] = [done]; var onScriptComplete = (prev, event) => { // avoid mem leaks in IE. script.onerror = script.onload = null; clearTimeout(timeout); var doneFns = inProgress[url]; delete inProgress[url]; script.parentNode &amp;&amp; script.parentNode.removeChild(script); doneFns &amp;&amp; doneFns.forEach((fn) => fn(event)); if (prev) return prev(event); }; var timeout = setTimeout( onScriptComplete.bind(null, undefined, { type: 'timeout', target: script }), 120000 ); script.onerror = onScriptComplete.bind(null, script.onerror); script.onload = onScriptComplete.bind(null, script.onload); needAttach &amp;&amp; document.head.appendChild(script); }; })(); å¼€å§‹æ„Ÿè§‰æœ‰ç‚¹ç±»ä¼¼ä»¥å‰é€šè¿‡ cdn å¼•å…¥ç¬¬ä¸‰æ–¹jsåº“çš„æ„Ÿè§‰ ä¸€äº›å…¶ä»–é—®é¢˜sharedç‰ˆæœ¬é—®é¢˜ï¼š æ­£ç¡®åšæ³• const { dependencies } = require(\"./package.json\"); ... shared: { ...dependencies, react: { singleton: true, requiredVersion: dependencies[\"react\"], }, \"react-dom\": { singleton: true, requiredVersion: dependencies[\"react-dom\"], }, }, å‚è€ƒï¼š å¾®å‰ç«¯å®è·µâ€“webpack5æ¨¡å—è”é‚¦ ç²¾è¯»ã€ŠWebpack5 æ–°ç‰¹æ€§ - æ¨¡å—è”é‚¦ã€‹","categories":[{"name":"å‰ç«¯","slug":"å‰ç«¯","permalink":"https://taylor12138.github.io/categories/%E5%89%8D%E7%AB%AF/"}],"tags":[],"author":"Hello"},{"title":"webpack(ä¸Š)","slug":"webpack(ä¸Š)","date":"2021-02-06T16:00:00.000Z","updated":"2023-05-17T06:41:33.940Z","comments":true,"path":"2021/02/07/webpack-shang/","link":"","permalink":"https://taylor12138.github.io/2021/02/07/webpack-shang/","excerpt":"","text":"1.Webpackæ¦‚è¿°Bundler æ˜¯èƒ½å¤Ÿé€šè¿‡ import/export å°†å¾ˆå¤š JavaScript æ–‡ä»¶ï¼Œæ‰“åŒ…æˆä¸€ä¸ª/å‡ ä¸ªæ–‡ä»¶çš„å·¥å…· webpackæ˜¯ä¸€ä¸ªç°ä»£çš„JavaScriptåº”ç”¨çš„é™æ€æ¨¡å—æ‰“åŒ…å·¥å…·ï¼ˆä¾èµ–äºnodeç¯å¢ƒï¼‰ï¼Œæ˜¯ç›®å‰æœ€æµè¡Œçš„bundler å®ƒå¯ä»¥å¸®ä½ æŠŠAMDã€CMDã€CommonJSã€ES6çš„ä¸€äº›æ¨¡å—åŒ–ç¼–å†™æ–¹å¼ï¼Œè½¬åŒ–ä¸ºâ€” &gt; æµè§ˆå™¨å¯ä»¥è¯†åˆ«çš„æ¨¡å—åŒ–æ–¹æ¡ˆ è€Œä¸”ä¸ä»…ä»…JSæ–‡ä»¶ï¼ŒCSSæ–‡ä»¶ã€å›¾ç‰‡æ–‡ä»¶ç­‰åœ¨Webpackä¹Ÿä¼šè¢«å½“æˆæ¨¡å—æ¥ä½¿ç”¨ æ‰“åŒ…åç”Ÿæˆä¸€ä¸ªæ–‡ä»¶å¤¹ï¼Œåœ¨æœåŠ¡å™¨è¿›è¡Œéƒ¨ç½²å³å¯ å†å²åœ¨æ‰“åŒ…å·¥å…·æœªå‡ºç°ä¹‹å‰ï¼Œæˆ‘ä»¬å¼•å…¥ç¬¬ä¸‰æ–¹åº“ï¼Œè¦åœ¨htmlä¸‹é¢çš„scriptä¸€ä¸€å¼•å…¥ ç„¶åæˆ‘ä»¬è‡ªå·±é¡¹ç›®çš„ä¸šåŠ¡ä»£ç ä¹Ÿå¾—åœ¨scriptä¸­ä¸€ä¸€å¼•å…¥ï¼ˆåœ¨ç¬¬ä¸‰æ–¹åº“scriptä¸‹æ–¹å¼•å…¥ï¼Œæ¯•ç«Ÿjsæ˜¯ä»ä¸Šåˆ°ä¸‹ä¸€ä¸€åŠ è½½çš„ï¼‰ æµè§ˆå™¨åŠ è½½ä¸€ä¸ªå¤§è„šæœ¬ï¼Œè¦æ¯”åŠ è½½å¤šä¸ªå°è„šæœ¬ï¼Œæ€§èƒ½æ›´å¥½ã€‚ é™¤äº†éº»çƒ¦ä¹‹å¤–ï¼Œè¿˜æœ‰å…¶ä»–é—®é¢˜ï¼šä½œç”¨åŸŸé—®é¢˜ã€æ–‡ä»¶å¤§å°é—®é¢˜ï¼ˆå¯ä»¥ä½¿ç”¨nodejsæ¨¡å—æ–¹æ¡ˆè§£å†³ï¼‰ã€æ–‡ä»¶å¼•ç”¨é¡ºåºé—®é¢˜ï¼ˆwebpackå¸®ä½ è§£å†³ï¼ï¼‰ã€å¯è¯»æ€§å·®ã€ç»´æŠ¤æ€§å¼±ç­‰ å‡ºç°gruntå’Œgule å¾€åå…ˆå‡ºç°äº†gruntå’Œguleè¿™ä¸¤ä¸ªæ‰“åŒ…å·¥å…· gruntã€guleä½¿ç”¨IIFEçš„å½¢å¼è§£å†³ä½œç”¨åŸŸé—®é¢˜ï¼ˆç«‹å³æ‰§è¡Œå‡½æ•°ï¼‰ var res = (function(){ return { name:'allen' } }()) console.loh(res.name) ä¸‰è€…éƒ½æ˜¯å‰ç«¯æ„å»ºå·¥å…·ï¼Œgruntå’Œgulpåœ¨æ—©æœŸæ¯”è¾ƒæµè¡Œï¼Œè€Œwebpackæ˜¯ç°åœ¨çš„ä¸»æµã€‚ gruntå’Œgulpæ˜¯åŸºäºä»»åŠ¡å’Œæµï¼ˆTaskã€Streamï¼‰çš„ã€‚ç±»ä¼¼jQueryï¼Œæ‰¾åˆ°ä¸€ä¸ªï¼ˆæˆ–ä¸€ç±»ï¼‰æ–‡ä»¶ï¼Œå¯¹å…¶åšä¸€ç³»åˆ—é“¾å¼æ“ä½œï¼Œæ›´æ–°æµä¸Šçš„æ•°æ®ï¼Œ æ•´æ¡é“¾å¼æ“ä½œæ„æˆäº†ä¸€ä¸ªä»»åŠ¡ï¼Œå¤šä¸ªä»»åŠ¡å°±æ„æˆäº†æ•´ä¸ªwebçš„æ„å»ºæµç¨‹ã€‚ webpackåŸºäºå…¥å£ï¼Œwebpackä¼šè‡ªåŠ¨åœ°é€’å½’è§£æå…¥å£æ‰€éœ€è¦åŠ è½½çš„æ‰€æœ‰èµ„æºæ–‡ä»¶ï¼Œç„¶åç”¨ä¸åŒçš„Loaderæ¥å¤„ç†ä¸åŒçš„æ–‡ä»¶ï¼Œç”¨Pluginæ¥æ‰©å±•webpackåŠŸèƒ½ã€‚ æ¨¡å—æ‹“å±• å‡ºç°äº†nodejsï¼Œæ¨¡å—æ–¹æ¡ˆå¾—ä»¥è§£å†³ï¼Œä½†æ˜¯æµè§ˆå™¨ä¸Šå¹¶ä¸èƒ½è¿è¡Œnodeï¼Œåœ¨æ—©æœŸæˆ‘ä»¬ä½¿ç”¨çš„æ˜¯requirejsåº“ï¼Œè°ƒç”¨åº“çš„æ–¹æ³•ï¼Œè®©æµè§ˆå™¨å¯ä»¥ä½¿ç”¨nodejsï¼ˆwebpackï¼‰ åé¢ES6ä¹‹åï¼Œæ”¯æŒäº†æµè§ˆå™¨ç«¯çš„æ¨¡å—åŠ è½½ï¼Œå¤šäº†ä¸€ç§å®ç°æ¨¡å—åŠ è½½çš„æ–¹æ¡ˆï¼ˆviteä½¿ç”¨ï¼‰ èµ·æ­¥å®‰è£… npm i webpack webpack-cli -g https://webpack.docschina.org/guides/getting-started/ &lt;- çœ‹è¿™é‡Œ æ³¨æ„ï¼šå…¨å±€å®‰è£…webpackåœ¨å¤šäººå¼€å‘æ¨¡å¼ä¸‹ä¼šæœ‰ç‰ˆæœ¬é£é™©ï¼Œå»ºè®®æœ¬åœ°å®‰è£…å³å¯ è‹¥åªæƒ³æ‰§è¡Œæœ¬ç›®å½•ä¸‹node_modulesçš„webpackç‰ˆæœ¬å¯ä»¥ä½¿ç”¨ npx webpack è¿™ç§åœ¨package.jsonçš„scripté‡Œï¼ˆè„šæœ¬ï¼‰ï¼Œè®¾ç½® \"script\": { \"build\": \"webpack\" } æ‰§è¡Œ npm run buildå³å¯ å…¥å£ã€æ‰“åŒ…æ–‡ä»¶çš„å­˜æ”¾ï¼š æ–°å»ºä¸¤ä¸ªæ–‡ä»¶å¤¹ï¼Œsrcæ”¾ç½®å¼€å‘çš„æºç ï¼Œdistæ”¾ç½®ä¹‹åæ‰“åŒ…çš„æ–‡ä»¶ æ–¹æ³•ä¸€ï¼šï¼ˆå…¨å±€å®‰è£…webpackï¼‰webpackåœ¨æ‰“åŒ…çš„æ—¶å€™ï¼Œä¼šæŸ¥çœ‹ä½ æœ‰æ²¡æœ‰ä¾èµ–å…¶ä»–æ–‡ä»¶ï¼Œæ‰€ä»¥ç»™ä¸€ä¸ªå…¥å£æ–‡ä»¶(main.jsæˆ–è€…index.js)å°±å¥½äº† webpack ./src/å…¥å£æ–‡ä»¶.js ./dist/æ‰“åŒ…åæ–‡ä»¶å.js è¿™æ—¶åœ¨htmlæ–‡ä»¶å†…ç”¨scriptå¼•ç”¨æ‰“åŒ…åçš„jsæ–‡ä»¶å³å¯ æ–¹æ³•äºŒï¼šæŒ‡å®šoption æ‰§è¡Œä»¥ä¸‹ä»£ç å¯ä»¥å¸®åŠ©æŸ¥çœ‹webapckä¸€äº›ç›¸å…³å‘½ä»¤ npx webpack --help æ¨¡å¼ä¸ºç”Ÿäº§æ¨¡å¼ï¼Œå…¥å£ä¸º ./src/index.js npx webpack --entry ./src/index.js --mode productionæ­¤æ—¶ä¼šè‡ªåŠ¨åœ¨ç›®å½•ä¸‹ç”Ÿäº§distæ–‡ä»¶å­˜æ”¾æ‰“åŒ…å¥½çš„jsæ–‡ä»¶ æ–¹æ³•ä¸‰ï¼šæ–°å»ºä¸€ä¸ª webpack.config.jsï¼Œé…ç½®å…¥å£ entryå’Œå‡ºå£ outputï¼Œoutputæ¨èç”¨å¯¹è±¡çš„å½¢å¼æ¥å†™ const path = require('path'); module.exports = { entry: './src/main.js', output: { path: path.join(__dirname, 'dist'), filename: 'bundle.js' //æ‰“åŒ…åçš„æ–‡ä»¶å } } ç”±äºè¦ä¾èµ–nodeçš„æ ¸å¿ƒæ¨¡å—pathä»¥åŠ¨æ€è·å¾—outputçš„ç»å¯¹è·¯å¾„ï¼Œè¿™é‡Œå…ˆè¿›è¡Œnpmåˆå§‹åŒ–ï¼Œå¾—åˆ°package.jsonåŒ…ï¼Œ è¿™æ—¶åœ¨å‘½ä»¤çª—å£ç›´æ¥è¾“å…¥ npx webpack æˆ–è€…ç”¨æ˜ å°„æ¥è¿è¡Œï¼šï¼ˆæ›´æ¨èï¼Œå› ä¸ºå®ƒä¼šä¼˜å…ˆåœ¨æœ¬åœ°æ‰¾ä¾èµ–åŒ…ï¼Œè€Œä¸æ˜¯å…¨å±€æ‰¾ä¾èµ–åŒ…ï¼Œå…¨å±€ä¾èµ–åŒ…å¯èƒ½å› ä¸ºç‰ˆæœ¬åŸå› å¯¼è‡´ä»£ç æŠ¥é”™ï¼‰ åœ¨package.jsonæ–‡ä»¶ä¸­çš„ script é…ç½® \"scripts\": { \"test\": \"echo \\\"Error: no test specified\\\" &amp;&amp; exit 1\", \"build\": \"npx webpack\" }, ç„¶åå†å‘½ä»¤çª—å£è¾“å…¥ npm run build ä¸€äº›webpackè®¾ç½®module.exports = { /*è®¾ç½®æ¨¡å¼ï¼Œå¯ä»¥å»å®˜ç½‘æŸ¥çœ‹ï¼Œå…¶å®è¿™ä¸ªæ¨¡å¼ä»£è¡¨webpackå¸®ä½ è°ƒäº†å¾ˆå¤šé…ç½® 1.developmentï¼Œå¼€å‘é˜¶æ®µ 2.productionï¼Œæ‰“åŒ…ä¸Šçº¿é˜¶æ®µ */ mode: \"development\", //è®¾ç½®source-mapï¼Œç®€å†jsæ˜ å°„æ–‡ä»¶ï¼ˆç±»ä¼¼äºæˆ‘ä»¬åœ¨vue3ä¸­è°ƒè¯•æºç çš„è¡Œä¸ºï¼‰ï¼Œæ–¹ä¾¿è°ƒè¯•ä»£ç é”™è¯¯æ—¶ devtool: \"source-map\", entry: './src/main.js', output: { path: path.join(__dirname, 'dist'), filename: 'bundle.js' //æ‰“åŒ…åçš„æ–‡ä»¶å clean: true, // åœ¨ç”Ÿæˆæ–‡ä»¶ä¹‹å‰æ¸…ç©º output ç›®å½• }, library: 'myLib', //å¦‚æœè¦æ‰“åŒ…çš„æ˜¯è‡ªå·±åˆ›å»ºçš„æ–¹æ³•åº“ï¼Œè¯·é…ç½®ä¸Šlibrary } æ‰“åŒ…æˆåº“æ‰“åŒ…æˆåº“è®°å¾—è¦é…ç½®ä¸Šlibrary module.exports = { //... output: { path: path.resolve(__dirname, 'dist'), filename: 'webpack-numbers.js', library: \"webpackNumbers\", }, } ä½†æ˜¯æ­¤æ—¶åªèƒ½ä½œä¸ºesmæ¨¡å—è¢«ä½¿ç”¨ï¼Œåªèƒ½é€šè¿‡è¢« script æ ‡ç­¾å¼•ç”¨è€Œå‘æŒ¥ä½œç”¨ï¼Œå®ƒä¸èƒ½è¿è¡Œåœ¨ CommonJSã€AMDã€Node.js ç­‰ç¯å¢ƒä¸­ã€‚ ä½œä¸ºä¸€ä¸ªåº“ä½œè€…ï¼Œæˆ‘ä»¬å¸Œæœ›å®ƒèƒ½å¤Ÿå…¼å®¹ä¸åŒçš„ç¯å¢ƒ æˆ‘ä»¬æ›´æ–° output.library é…ç½®é¡¹ï¼Œå°†å…¶ type è®¾ç½®ä¸º &#39;umd&#39;ï¼š const path = require('path'); module.exports = { entry: './src/index.js', output: { path: path.resolve(__dirname, 'dist'), filename: 'webpack-numbers.js', - library: 'webpackNumbers', + library: { + name: 'webpackNumbers', + type: 'umd', + }, }, }; typeç±»å‹ï¼š &quot;var&quot; | &quot;module&quot; | &quot;assign&quot; | &quot;assign-properties&quot; | &quot;this&quot; | &quot;window&quot; | &quot;self&quot; | &quot;global&quot; | &quot;commonjs&quot; | &quot;commonjs2&quot; | &quot;commonjs-module&quot; | &quot;commonjs-static&quot; | &quot;amd&quot; | &quot;amd-require&quot; | &quot;umd&quot; | &quot;umd2&quot; | &quot;jsonp&quot; | &quot;system&quot; | string è¾“å‡º ES æ¨¡å—(module)ã€‚è¯·ç¡®ä¿äº‹å…ˆå¯ç”¨ experiments.outputModuleã€‚ source-mapå…³äºwebpack.config.jsé…ç½®ä¸­devtoolçš„è®¾ç½®ï¼Œé»˜è®¤å€¼ä¸º evalï¼ˆæœ€å¥½æ€§èƒ½ï¼‰ æ¨¡å¼ è¯¦æƒ… eval æ¯ä¸ªmoduleä¼šå°è£…åˆ°evalï¼ŒåŒ…è£¹èµ·æ¥æ‰§è¡Œï¼Œå¹¶åœ¨æœ«å°¾è¿½åŠ æ³¨é‡Š //@sourceURL source-map ç”Ÿæˆä¸€ä¸ªSourceMapæ–‡ä»¶ hidden-source-map åŒsource-mapï¼Œä½†æ˜¯ä¸ä¼šåœ¨bundleæœ«å°¾è¿½åŠ æ³¨é‡Šï¼ˆå³æ— æ³•é”å®šæºæ–‡ä»¶å‘ç”Ÿé”™è¯¯çš„è¡Œæ•°ï¼‰ inline-source-map ç”Ÿæˆä¸€ä¸ªDataURLå½¢å¼çš„SourceMapæ–‡ä»¶ eval-source-map æ¯ä¸ªmoduleéƒ½ä¼šé€šè¿‡evalæ‰§è¡Œï¼Œå¹¶ç”Ÿæˆä¸€ä¸ªDataURLå½¢å¼çš„SourceMapæ–‡ä»¶ cheap-source-map ç”Ÿæˆä¸€ä¸ªæ²¡æœ‰åˆ—ä¿¡æ¯ï¼ˆcolumn-mappingï¼‰çš„SourceMapæ–‡ä»¶ï¼Œä½†æ˜¯æœ‰è¡Œä¿¡æ¯ï¼Œä¸åŒ…å«loaderçš„sourcemapï¼ˆæ¯”å¦‚babelåæ— æ³•æ˜¾ç¤ºçœŸæ­£å¯¹åº”çš„è¡Œæ•°ï¼‰ï¼Œå¯ä»¥å‡å°‘source-mapæ–‡ä»¶å¤§å° cheap-module-source-map ç”Ÿæˆä¸€ä¸ªæ²¡æœ‰åˆ—ä¿¡æ¯ï¼ˆcolumn-mappingï¼‰çš„SourceMapæ–‡ä»¶ï¼Œä½†æ˜¯æœ‰è¡Œä¿¡æ¯ï¼ŒåŒæ—¶loaderçš„sourcemapä¹Ÿè¢«ç®€åŒ–ä¸ºåªåŒ…å«å¯¹åº”è¡Œ ä½†æ˜¯è¦æ³¨æ„çš„æ˜¯ï¼Œç”Ÿäº§ç¯å¢ƒæˆ‘ä»¬ä¸€èˆ¬ä¸ä¼šå¼€å¯source-map é€šè¿‡bundleå’Œsourcemapæ–‡ä»¶ï¼Œå¯ä»¥åç¼–è¯‘å‡ºæºç ï¼Œä¹Ÿå°±æ˜¯è¯´çº¿ä¸Šäº§ç‰©yousourcemapæ–‡ä»¶çš„è¯ï¼Œå°±æ„å‘³ç€åˆæš´éœ²ä»£ç çš„é£é™© source-mapæ–‡ä»¶ä½“ç§¯ç›¸å¯¹æ¯”è¾ƒå¤§ï¼Œè€Œæˆ‘ä»¬ç”Ÿäº§ç¯å¢ƒå½“ç„¶æ›´åŠ è¿½æ±‚æ›´è½»é‡çº§æ›´å°çš„åŒ… Loaderå’ŒPluginloaderç±»ä¼¼äºä¸€ä¸ªè½¬æ¢å™¨ï¼Œpluginç›¸å¯¹webpackæœ¬èº«çš„æ‹“å±•ï¼Œç±»ä¼¼äºä¸€ä¸ªæ‹“å±•å™¨ ä¸åŒçš„ä½œç”¨ Loaderå¯ä»¥å®ç°è®©WebpackåŠ è½½å’Œè§£æé™¤äº†JavaScriptä»¥å¤–çš„èƒ½åŠ›ã€‚ Pluginç›´è¯‘ä¸ºâ€æ’ä»¶â€ã€‚Pluginå¯ä»¥æ‰©å±•webpackçš„åŠŸèƒ½ï¼Œè®©webpackå…·æœ‰æ›´å¤šçš„çµæ´»æ€§ã€‚ åœ¨ Webpack è¿è¡Œçš„ç”Ÿå‘½å‘¨æœŸä¸­ä¼šå¹¿æ’­å‡ºè®¸å¤šäº‹ä»¶ï¼ŒPlugin å¯ä»¥ç›‘å¬è¿™äº›äº‹ä»¶ï¼Œåœ¨åˆé€‚çš„æ—¶æœºé€šè¿‡ Webpack æä¾›çš„ API æ”¹å˜è¾“å‡ºç»“æœã€‚ ä¸åŒçš„ç”¨æ³• Loaderåœ¨module.rulesä¸­é…ç½®ï¼Œä¹Ÿå°±æ˜¯è¯´ä»–ä½œä¸ºæ¨¡å—çš„è§£æè§„åˆ™è€Œå­˜åœ¨ã€‚ ç±»å‹ä¸ºæ•°ç»„ï¼Œæ¯ä¸€é¡¹éƒ½æ˜¯ä¸€ä¸ªObjectï¼Œé‡Œé¢æè¿°äº†å¯¹äºä»€ä¹ˆç±»å‹çš„æ–‡ä»¶ï¼ˆtestï¼‰ï¼Œä½¿ç”¨ä»€ä¹ˆåŠ è½½(loader)å’Œä½¿ç”¨çš„å‚æ•°ï¼ˆoptionsï¼‰ Pluginåœ¨pluginsä¸­å•ç‹¬é…ç½®ã€‚ ç±»å‹ä¸ºæ•°ç»„ï¼Œæ¯ä¸€é¡¹æ˜¯ä¸€ä¸ªpluginçš„å®ä¾‹ï¼Œå‚æ•°éƒ½é€šè¿‡æ„é€ å‡½æ•°ä¼ å…¥ã€‚ 2.Loader(å‰è¨€ï¼šä½ å·²ç»æ˜¯ä¸€ä¸ªæˆç†Ÿçš„webpackäº†ï¼Œåº”è¯¥å­¦ä¼šè‡ªå·±å®‰è£…loaderï¼ï¼ï¼) webpackä¸»è¦ç”¨æ¥å¤„ç†æˆ‘ä»¬jsä»£ç ï¼Œè¿›è¡Œæ¨¡å—åŒ–å¼€å‘ï¼Œå¹¶ä¸”è‡ªåŠ¨å¤„ç†jsä¹‹é—´çš„ä¾èµ–å…³ç³» ä½†æ˜¯åœ¨å¼€å‘ä¸­ï¼Œæˆ‘ä»¬ä¸ä»…ä»…æœ‰åŸºæœ¬çš„jsä»£ç éœ€è¦å¤„ç†ï¼Œä¹Ÿéœ€è¦åŠ è½½cssã€å›¾ç‰‡ï¼ŒåŒ…æ‹¬ä¸€äº›é«˜çº§çš„å°†ES6è½¬åŒ–ä¸ºES5ä»£ç ï¼Œæˆ–è€…TypeScriptè½¬åŒ–ä¸ºES5ä»£ç ï¼Œå°†scssã€lessè½¬åŒ–ä¸ºcssï¼Œcsså…¼å®¹ä½ç‰ˆæœ¬çš„ç­‰ç­‰ å¯¹äºwebpackæœ¬èº«èƒ½åŠ›æ¥è¯´ï¼Œå¯¹äºè¿™äº›è½¬åŒ–æ˜¯ä¸æ”¯æŒçš„ï¼Œè¿™æ—¶æˆ‘ä»¬éœ€è¦ç”¨åˆ°loaderã€‚ æ³¨æ„ï¼šåœ¨useé€‰é¡¹ä¸­ï¼Œloaderçš„æ”¾ç½®é¡ºåºéœ€è¦æ³¨æ„ä¸‹ï¼Œæ˜¯ä»ä¸‹å¾€ä¸Šçš„ï¼Œæ¯”å¦‚style-loaderä¸€å®šè¦æ¯”css-loaderåæ‰§è¡Œï¼Œæ‰€ä»¥style-loaderæ”¾ä¸Šé¢ï¼Œcss-loaderæ”¾ä¸‹é¢ 1.é€šè¿‡npmå®‰è£…éœ€è¦ä½¿ç”¨çš„loader 2.åœ¨webpack.config.jsçš„moduleå…³é”®å­—ä¸‹è¿›è¡Œé…ç½®ï¼ˆæ ¹æ®å®˜ç½‘ç»™çš„é…ç½®ä¿¡æ¯å¡«å……å°±å¯ä»¥äº†ï¼‰ å¤„ç†CSSæ–‡ä»¶è¿™é‡Œä¸¾ä¸€ä¸ªCSSæ–‡ä»¶æ‰“åŒ…çš„ä¾‹å­ï¼Œéœ€è¦é…ç½® style-loader ï¼ˆè´Ÿè´£å°†å¯¼å‡ºçš„æ ·å¼æ·»åŠ åˆ°DOMï¼ˆç”¨äºç”Ÿæ•ˆï¼‰ï¼‰å’Œ css-loaderï¼ˆè´Ÿè´£åŠ è½½å¹¶è§£æimportçš„CSSæ–‡ä»¶ï¼ˆç”¨äºåŠ è½½ï¼‰ï¼‰ npm install --save-dev style-loader css-loader module.exports = { module: { rules: [ { test: /\\.css$/i, use: [\"style-loader\", \"css-loader\"], }, ], }, }; å¤„ç†å›¾ç‰‡ï¼ˆåœ¨webpack5é‡Œé¢ï¼Œurl-loaderå’Œfile-loaderä¸å†ä½¿ç”¨ï¼‰ å½“CSSè¦ä½¿ç”¨ background-imageçš„urlå¯¼å…¥å›¾ç‰‡æ—¶ï¼Œå¯ä»¥å®‰è£… file-loaderå¹¶ä¸”åœ¨webpack.config.jsä¸­é…ç½®ï¼Œç”¨äºåŠ è½½å›¾ç‰‡ è‹¥æƒ³è¦åœ¨htmlä¸­è®¾ç½®æŸå…ƒç´ çš„srcï¼Œæˆ‘ä»¬ä¸åº”è¯¥ç›´æ¥æ ¹æ®å½“å‰å›¾ç‰‡è·ç¦»æˆ‘ä»¬çš„è·¯å¾„è¿›è¡Œå­—ç¬¦ä¸²è®¾ç½®ï¼Œè€Œæ˜¯åº”è¯¥ç”±æ‰“åŒ…çš„æ€æƒ³ï¼Œå¼•å…¥æ¨¡å—æ¥è¿æ¥å®ƒä»¬ä¹‹é—´çš„å…³ç³» module: { // æŒ‡å®šåŠ è½½è§„åˆ™ rules: [ { test: /\\.(jpe?g|png|gif|svg)/ use: \"file-loader\" } ] } import Image from '../img/xx.jpg' imgEl.src = Image; åœ¨ä½¿ç”¨åˆ°å›¾ç‰‡çš„åœºæ™¯æ—¶ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨å¯¹åº”çš„å›¾ç‰‡url-loader å…³äºurlçš„loaderä¸­é…ç½®çš„optioné€‰é¡¹æœ‰ä¸€ä¸ªlimit å¯ä»¥è¿›è¡Œè®¾ç½®ï¼š limit: 8192, å½“åŠ è½½çš„å›¾ç‰‡å°äºè¿™ä¸ªlimitæ—¶ï¼Œä¼šå°†å›¾ç‰‡ç¼–è¯‘æˆbase64å­—ç¬¦ä¸²å½¢å¼ è‹¥å¤§äºlimitï¼Œåˆ™è¿˜éœ€è¦å®‰è£…ä¸€ä¸ªloaderï¼Œå³file-loaderæ¨¡å—è¿›è¡ŒåŠ è½½ï¼Œä»å…¥å£jsæ–‡ä»¶æ‰“åŒ…ä¼šå¾—åˆ°ä¸€å¼ éšæœºå‘½åï¼ˆ32ä½çš„å“ˆå¸Œå€¼ï¼‰çš„å›¾ç‰‡äºdistæ–‡ä»¶å¤¹ä¸­ã€‚ï¼ˆå®‰è£…åå¹¶ä¸éœ€è¦é…ç½®file-loaderï¼‰ ï¼ˆå¦‚æœæ²¡æœ‰å®‰è£…HtmlWebpackPluginæ’ä»¶ï¼Œæˆ‘ä»¬index.htmlï¼ˆæƒ³è¦åŠ è½½åˆ°çš„é¡µé¢ï¼‰åœ¨distæ–‡ä»¶å¤–é¢ï¼Œè¿™æ—¶å°±è¿˜éœ€è¦åœ¨webpackçš„é…ç½®æ–‡ä»¶é‡Œçš„outputä¸­ï¼Œæ·»åŠ publicPath:&#39;dist/&#39;ï¼Œè¿™æ ·ä»¥åæ¶‰åŠåˆ°urlçš„è·¯å¾„ï¼Œéƒ½ä¼šè‡ªåŠ¨æ·»åŠ ä¸Š &#39;dist/&#39;ï¼‰ ä½†æ˜¯çœŸå®å¼€å‘ä¸­å¯¹æ‰“åŒ…çš„å›¾ç‰‡å‘½åæœ‰ä¸€å®šè¦æ±‚ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨url-loaderçš„é…ç½®optioné‡Œé¢ï¼Œå¢åŠ å…¶ä»–å±æ€§ å‘½åè§„èŒƒï¼šhttps://v4.webpack.js.org/loaders/file-loader/#n options: { limit: 8192, name: 'img/[name].[hash:8].[ext]', // æŒ‰ç…§è¿™ä¸ªè§„èŒƒè¿›è¡Œå‘½åï¼Œextæ˜¯æ‹“å±•åï¼Œæ‰“åŒ…çš„æ—¶å€™æ”¾åˆ° //output: \"img\" ä¸Šæ–¹æ²¡æœ‰â€œimg/â€çš„æ—¶å€™å¯ä»¥å†™ï¼Œè¾“å‡ºåˆ°æ‰“åŒ…æ–‡ä»¶å¤¹ä¸‹imgæ–‡ä»¶é‡Œ }, èµ„æºæ¨¡å— ï¼ˆæ›¿ä»£ä»¥å¾€éƒ¨åˆ†loaderï¼‰ä¸Šè¿°è¯´é“webpack5å¼€å§‹ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥ä½¿ç”¨èµ„æºæ¨¡å—ç±»å‹ï¼ˆasset module typeï¼‰æ¥æ›¿ä»£ä»¥ä¸Šå¤„ç†å›¾ç‰‡ã€å…¶ä»–èµ„æºçš„loader æ³¨æ„ï¼ä¸ç”¨ä¸‹è½½loaderäº†ï¼ï¼ä¹Ÿå°±æ˜¯è¯´æ˜¯å†…ç½®çš„ åŸºæœ¬ä»‹ç» asset/resourceï¼Œå‘é€ä¸€ä¸ªæ–‡ä»¶å¹¶å¯¼å‡ºurlï¼ˆæ›¿ä»£file-loaderï¼‰ï¼Œç›´æ¥ä¸€ä¸ªå›¾ç‰‡ï¼ˆpngã€jpgï¼‰çš„urlå»ä½¿ç”¨ï¼Œæ‰“åŒ…åä¼šå‡ºç°åœ¨distæ–‡ä»¶å¤¹ä¸‹ import imgSrc from \"../asset/1.jpg\"; const img = document.createElement(\"img\"); img.src = imgSrc; asset/inlineï¼Œå¯¼å‡ºä¸€ä¸ªèµ„æºURIï¼ˆæ›¿ä»£url-loaderï¼Œé€šè¿‡Rule.parser.dataUrlCondition.maxSize é€‰é¡¹æ¥ä¿®æ”¹æ­¤limitï¼‰ï¼Œæ¯”å¦‚svgä¹‹ç±»çš„ï¼Œåœ¨æ‰“åŒ…ä¹‹åä¸ä¼šå‡ºç°åœ¨distæ–‡ä»¶å¤¹ä¸­ import mySvg from \"../asset/1.svg\"; const img = document.createElement(\"img\"); img.src = mySvg; asset/sourceï¼Œå¯¼å‡ºèµ„æºçš„æºä»£ç ï¼ˆæ›¿ä»£raw-loaderï¼‰ï¼Œæ¯”å¦‚txtæ–‡ä»¶ï¼Œé€šè¿‡importå¯¼å…¥æ—¶å¯ä»¥txtæ–‡æœ¬å†…å®¹ import Txt from \"../asset/1.txt\"; const div = document.createElement(\"div\"); div.textContent = Txt assetï¼Œåœ¨å¯¼å‡ºdata URIå’Œå‘é€ä¸€ä¸ªå•ç‹¬çš„æ–‡ä»¶ä¹‹é—´è‡ªåŠ¨é€‰æ‹©ï¼Œå¯ä»¥å½“æˆæ˜¯asset/resourceã€asset/inlineä¹‹é—´è¿›è¡Œè‡ªåŠ¨é€‰æ‹©ï¼Œä¹‹å‰é€šè¿‡url-loaderï¼Œå¹¶ä¸”é€šè¿‡é…ç½®èµ„æºä½“ç§¯é™åˆ¶å®ç°ã€‚ å®é™…ä¸Šæ˜¯æ ¹æ®å›¾ç‰‡å¤§å°è¿›è¡Œé€‰æ‹©ï¼Œå°åˆ™inlineã€å¤§åˆ™resource è¿˜å¯ä»¥è‡ªå·±è®¾ç½®è¿™ä¸ªå¤§å° rules: [ { test: /\\.jpg/, type: \"asset\", parser: { dataUrlCondition: { maxSize: 4 * 1024 * 1024 //å¤§äº4Mæ—¶æ‰ä½¿ç”¨resource } } } ] å…·ä½“é…ç½®æ–¹æ³•//webpack.config.js module.exports = { module: { // æŒ‡å®šåŠ è½½è§„åˆ™ rules: [ { test: /\\.(jpe?g|png|gif|svg)/, type: \"asset/resource\" } ] } }; ä½†æ˜¯ç»è¿‡æ‰“åŒ…å¤„ç†ä¹‹åï¼Œèµ„æºéƒ½æ˜¯ç›´æ¥æ”¾åœ¨disté‡Œé¢ï¼Œçœ‹èµ·æ¥æ¯”è¾ƒæ‚ä¹± æ–¹æ³•ä¸€ï¼šåœ¨webpacké…ç½®æ–‡ä»¶çš„output optionä¸­å®šä¹‰ assetModuleFilename output: { path: path.join(__dirname, \"dist\"), filename: \"bundle.js\", //æ‰“åŒ…åçš„æ–‡ä»¶åï¼Œ clean: true, assetModuleFilename: \"imges/[contenthash][ext]\", //æ ¹æ®æ–‡ä»¶å†…å®¹ï¼Œç”Ÿæˆä¸€ä¸ªå“ˆå¸Œå­—ç¬¦ä¸²ï¼Œç„¶åæ‹“å±•åä½¿ç”¨[ext]æ¥ç”ŸæˆåŸæ¥æ–‡ä»¶çš„æ‹“å±•å }, æ–¹æ³•äºŒï¼ˆé«˜äºæ–¹æ³•ä¸€ä¼˜å…ˆçº§ï¼‰ï¼šåœ¨ä½¿ç”¨èµ„æºæ¨¡å—ä¸­é…ç½®rulesæ—¶ï¼Œé¡ºä¾¿é…ç½®generator rules: [ { test: /\\.(jpe?g|png|gif|svg)/, type: \"asset/resource\", generator: { filename: \"images/test.png\", }, }, ], åŠ è½½iconå­—ä½“rules: [ { test: /\\.(woff|woff2|eot|ttf|otf)/, type: \"asset/resource\", }, ], å¤„ç†Vueå¼•å…¥Vue.js é¦–å…ˆåœ¨é¡¹ç›®ä¸­ä½¿ç”¨Vue.jsï¼Œéœ€è¦å…ˆé€šè¿‡npmå®‰è£…Vue npm install vue --save ä½†æ˜¯ï¼Œvueåœ¨æœ€ç»ˆæ„å»ºå‘å¸ƒç‰ˆæœ¬æ—¶ï¼Œä¼šæ„å»ºä¸¤ç±»ç‰ˆæœ¬ï¼Œåˆ†åˆ«æ˜¯ runtime-only ä»£ç ä¸­ä¸èƒ½æœ‰ä»»ä½•çš„template runtime-compiler ä»£ç ä¸­å¯ä»¥æœ‰templateã€‚ï¼ˆæ­¤ç‰ˆæœ¬éœ€è¦åœ¨webpack.config.jsä¸­é…ç½®ä¿¡æ¯ï¼Œæ­¤æ—¶åœ¨moduleé…ç½®é¡¹çš„ä¸‹æ–¹æ·»åŠ ï¼šï¼‰ resolve: { // åˆ«å,è®©vueç»“å°¾çš„æŒ‡å‘ä¸€ä¸ªå…·ä½“çš„æ–‡ä»¶å¤¹çš„æ–‡ä»¶ // é»˜è®¤æŒ‡å‘'vue/dist/vue.runtime.js' alias: { 'vue$': 'vue/dist/vue.esm.js' } } å¦‚æœæƒ³è¦é€šè¿‡vueæ–‡ä»¶åˆ†ç¦»ç»„ä»¶å’Œä¸»è¦çš„main.jsæ–‡ä»¶æ—¶ï¼Œä¼šæ˜¯ä½¿ç”¨åˆ°vueæ–‡ä»¶ è¿™æ—¶éœ€è¦å®‰è£… vue-loaderï¼ˆè´Ÿè´£åŠ è½½ï¼Œå¦‚æœæ˜¯Vue3åˆ™å®‰è£… vue-loader@next ï¼‰ å’Œ @vue/complier-sfc-Dï¼ˆè´Ÿè´£ç¼–è¯‘ï¼‰ è€æ ·å­åœ¨moduleçš„ rules æ·»åŠ é…ç½®ä¿¡æ¯ï¼ˆè¿™é‡Œæ²¡use@vue/complier-sfc-Dæ˜¯å› ä¸ºvue-loaderå†…éƒ¨å·²ç»useäº†ï¼‰ test: /\\.vue$/, use: ['vue-loader'] ä½†æ˜¯Vue Loader v15 ç°åœ¨éœ€è¦é…åˆä¸€ä¸ª webpack æ’ä»¶æ‰èƒ½æ­£ç¡®ä½¿ç”¨ï¼š // webpack.config.js const VueLoaderPlugin = require('vue-loader/lib/plugin') module.exports = { // ... plugins: [ new VueLoaderPlugin() ] } PostCSSå·¥å…·PostCSSæ˜¯ä¸€ä¸ªé€šè¿‡JavaScriptè½¬æ¢æ ·å¼çš„å·¥å…·ï¼Œè¿™ä¸ªå·¥å…·å¯ä»¥å¸®åŠ©æˆ‘ä»¬è¿›è¡Œä¸€äº›CSSçš„é€‚é…ï¼Œæ¯”å¦‚æ·»åŠ æµè§ˆå™¨å‰ç¼€ã€cssæ ·å¼é‡ç½®ç­‰ã€‚ ä½¿ç”¨ï¼š æŸ¥æ‰¾PostCSSåœ¨æ„å»ºå·¥å…·ä¸­çš„æ‹“å±•ã€å…¥webpackçš„postcss-loader é€‰æ‹©å¹¶æ·»åŠ ä½ éœ€è¦çš„PostCSSç›¸å…³æ’ä»¶ ä½¿ç”¨webpack.config.js äº¦æˆ–è€… æ–°å»ºä¸€ä¸ªpostcss.config.jsè¿›è¡Œé…ç½®éƒ½å¯ æ¯”å¦‚æ¯”è¾ƒå¥½ç”¨çš„æ’ä»¶ autoprefixerï¼Œè‡ªåŠ¨è·å–æµè§ˆå™¨çš„æµè¡Œåº¦å’Œèƒ½æ”¯æŒçš„å±æ€§ï¼Œå¹¶ä¸”æ ¹æ®è¿™äº›æ•°æ®å¸®æˆ‘ä»¬è‡ªåŠ¨ä¸ºCSSæ·»åŠ å‰ç¼€å¤„ç†ï¼Œä½¿ç”¨Can I Useçš„æ•°æ®æ¥å†³å®šå“ªäº›å‰ç¼€æ˜¯éœ€è¦çš„ï¼Œå°†æœ€æ–°çš„cssè¯­æ³•è½¬åŒ–ä¸ºå¤§å¤šæ•°æµè§ˆå™¨éƒ½èƒ½ç†è§£çš„è¯­æ³•ï¼› å¹¶ä¸”åœ¨postcssçš„åŸºç¡€ä¸ŠåŠ autoprefixerï¼Œå¯ä»¥è‡ªåŠ¨ä¸ºä¸åŒçš„ç›®æ ‡æµè§ˆå™¨æ·»åŠ æ ·å¼å‰ç¼€ï¼Œè§£å†³çš„æ˜¯æµè§ˆå™¨å…¼å®¹æ€§çš„é—®é¢˜ npm install --save-dev autoprefixer module.exports = { module: { rules: [ { test: /\\.css$/i, use: [ 'style-loader', { loader: 'css-loader', options: { importLoaders: 1 }, }, { loader: 'postcss-loader', options: { postcssOptions: { plugins: [ [ 'autoprefixer', { // é€‰é¡¹ }, ], ], }, }, }, ], }, ], }, }; postcss-preset-envï¼Œå®ƒå¯ä»¥å¸®åŠ©æˆ‘ä»¬å°†ä¸€äº›ç°ä»£çš„CSSç‰¹å‹è½¬åŒ–å¤§å¤šæµè§ˆå™¨éƒ½è®¤è¯†çš„CSSï¼Œå¹¶ä¸”æ ¹æ®ç›®æ ‡æµè§ˆå™¨æˆ–è¿è¡Œæ—¶çš„ç¯å¢ƒæ·»åŠ æ‰€éœ€polyfillï¼Œä¹ŸåŒ…æ‹¬ä¼šè‡ªåŠ¨å¸®æˆ‘ä»¬æ·»åŠ autoprefixer npm i -D postcss postcss-loader postcss-preset-env Autoprefixer ä½¿ç”¨Browserslistï¼Œå› æ­¤æ‚¨å¯ä»¥ä½¿ç”¨ç±»ä¼¼çš„æŸ¥è¯¢æŒ‡å®šæ‚¨æƒ³è¦åœ¨é¡¹ç›®ä¸­å®šä½çš„æµè§ˆå™¨&gt; 5% ï¼ˆè¯·å‚é˜…æœ€ä½³å®è·µï¼‰ã€‚ æä¾›æµè§ˆå™¨çš„æœ€ä½³æ–¹å¼æ˜¯.browserslistrcåœ¨æ‚¨çš„é¡¹ç›®æ ¹ç›®å½•ä¸­æ·»åŠ ä¸€ä¸ªæ–‡ä»¶ï¼Œæˆ–è€…é€šè¿‡browserslistå‘æ‚¨çš„package.json. æˆ‘ä»¬å»ºè®®ä½¿ç”¨è¿™äº›é€‰é¡¹è€Œä¸æ˜¯å°†é€‰é¡¹ä¼ é€’ç»™ Autoprefixerï¼Œä»¥ä¾¿é…ç½®å¯ä»¥ä¸å…¶ä»–å·¥å…·å…±äº«ï¼Œä¾‹å¦‚babel-preset-envå’Œ Stylelintã€‚ æœ‰å…³æŸ¥è¯¢ã€æµè§ˆå™¨åç§°ã€é…ç½®æ ¼å¼å’Œé»˜è®¤å€¼ï¼Œè¯·å‚é˜…Browserslist æ–‡æ¡£ã€‚ ä¼˜åŒ–çš„LoaderHappyPackï¼šå—é™äº Node æ˜¯å•çº¿ç¨‹è¿è¡Œçš„ï¼Œæ‰€ä»¥ Webpack åœ¨æ‰“åŒ…çš„è¿‡ç¨‹ä¸­ä¹Ÿæ˜¯å•çº¿ç¨‹çš„ï¼Œç‰¹åˆ«æ˜¯åœ¨æ‰§è¡Œ Loader çš„æ—¶å€™ï¼Œé•¿æ—¶é—´ç¼–è¯‘çš„ä»»åŠ¡å¾ˆå¤šï¼Œè¿™æ ·å°±ä¼šå¯¼è‡´ç­‰å¾…çš„æƒ…å†µï¼Œç„¶è€ŒHappyLoaderå¯ä»¥å°†Loaderå•è¡Œè½¬æ¢ä¸ºå¹¶è¡Œ eslint-loaderï¼šé€šè¿‡ ESLint æ£€æŸ¥ JavaScript ä»£ç ï¼ˆThis loader has been deprecated. Please use eslint-webpack-pluginï¼‰ EslintWebpackPluginï¼šåº”ç”¨äºwebpack5çš„eslint æ‰“å¼€ webpack æ–‡ä»¶ç¼“å­˜è°ƒè¯•æ—¥å¿—çš„æ–¹æ³•tools: { webpackChain: (chain) => { chain.merge({ infrastructureLogging: { level: 'verbose', colors: true, debug: /webpack\\.cache/, } }); } } 3.pluginpluginæ˜¯æ’ä»¶çš„æ„æ€ï¼Œé€šå¸¸ç”¨äºå¯¹æŸä¸ªç°æœ‰æ¶æ„è¿›è¡Œæ‰©å±• ä½¿ç”¨ï¼š 1.é€šè¿‡npmå®‰è£…éœ€è¦çš„æ’ä»¶ï¼ˆä½†æ˜¯æœ‰äº›æ’ä»¶webpackå·²ç»å†…ç½®äº†ï¼‰ 2.ç„¶ååœ¨webpack.config.jsä¸­çš„pluginsè¿›è¡Œé…ç½® ä¸‹é¢ä¸¾ä¸€ä¸ªåŠ å…¥ç‰ˆæƒçš„æ’ä»¶çš„ä¾‹å­ // webpack.config.js const webpack = require('webpack'); module.exports = { // ... plugins: [ new webpack.BannerPlugin('æœ€ç»ˆç‰ˆæƒå½’Helloæ‰€æœ‰') ] } HtmlWebpackPluginçœŸæ˜¯å‘å¸ƒé¡¹ç›®æ—¶ï¼Œå‘å¸ƒçš„æ˜¯distæ–‡ä»¶å¤¹ä¸­çš„å†…å®¹ï¼Œä½†æ˜¯æ‰“åŒ…çš„æ—¶å€™å¹¶æ²¡æœ‰å°†htmlæ–‡ä»¶ä¹Ÿæ‰“åŒ…è¿›distæ–‡ä»¶å¤¹ä¸­ï¼Œ æ­¤æ—¶æˆ‘ä»¬éœ€è¦ç”¨åˆ°HtmlWebpackPluginæ’ä»¶ï¼Œå®ƒä¼šè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªindex.htmlæ–‡ä»¶ï¼ˆå¯ä»¥æŒ‰ç…§æŒ‡å®šæ¨¡æ¿æ¥ç”Ÿæˆï¼‰ï¼Œå¹¶ä¸”å°†æ‰“åŒ…åçš„jsæ–‡ä»¶ï¼Œè‡ªåŠ¨é€šè¿‡scriptæ ‡ç­¾æ’å…¥åˆ°bodyä¸­ 1.å®‰è£…æ’ä»¶ npm install html-webpack-plugin --save-dev 2.ä½¿ç”¨æ’ä»¶ï¼Œåœ¨webpack.config.jsä¸­ä½¿é…ç½®ä¿¡æ¯ // webpack.config.js const HtmlWebpackPlugin = require('html-webpack-plugin'); module.exports = { // ... plugins: [ new HtmlWebpackPlugin() ] } æ­¤æ—¶ç”Ÿæˆçš„htmlæ–‡ä»¶çš„bodyå†…è¿˜æ²¡æœ‰æ ¹å…ƒç´ ç»‘å®šVueï¼Œæˆ‘ä»¬å¯ä»¥ç»™ä¸ªæ¨¡æ¿ï¼Œæ¨¡æ¿é‡Œæœ‰æˆ‘ä»¬ç†æƒ³çš„å­˜æ”¾å¥½çš„æ ‡ç­¾ï¼Œè®©å®ƒæ ¹æ®æ¨¡æ¿ç”Ÿæˆè¯¥ divå…ƒç´  new HtmlWebpackPlugin({ // å¯»æ‰¾å½“å‰ç›®å½•ä¸‹çš„index.html, æ ¹æ®è¿™ä¸ªç”Ÿæˆæ¨¡æ¿ï¼ˆå®šä¹‰titleä¹‹ç±»çš„ï¼‰ï¼Œå¯ä»¥å‚è€ƒVueçš„è„šæ‰‹æ¶æ­å»ºæ—¶ä¸‹é¢æ”¾ç½®çš„æ¨¡æ¿html template: './index.html', //é»˜è®¤å°†æ‰“åŒ…æ–‡ä»¶æ”¾åœ¨headï¼Œå¯ä»¥è®¾ç½®æ”¾åœ¨htmlçš„bodyé‡Œé¢ inject:'body', //å¦‚æœæ‰“åŒ…å¤šä¸ªhtmlæ–‡ä»¶æ¥å¼•å…¥ä¸åŒçš„scriptåŒ…ï¼Œåˆ™å®šä¹‰filenameæ¥åŒºåˆ†æ‰“åŒ…è¾“å…¥html filename: 'index.html' }) å¤šå…¥å£entryé€šè¿‡ä¸åŒçš„entryæ–‡ä»¶æ‰“åŒ…å¤šä¸ªhtmlæ–‡ä»¶ ä¸€ä¸ªé¡¹ç›®ä¸­ä¿å­˜äº†å¤šä¸ª HTML æ¨¡ç‰ˆï¼Œä¸åŒçš„æ¨¡ç‰ˆæœ‰ä¸åŒçš„å…¥å£ï¼Œå¹¶ä¸”æœ‰å„è‡ªçš„ routerã€store ç­‰ï¼› ä¸ä»…å¯ä»¥æ‰“åŒ…å‡ºä¸åŒ HTMLï¼Œè€Œä¸”å¼€å‘çš„æ—¶å€™ä¹Ÿå¯ä»¥é¡ºåˆ©è¿›è¡Œè°ƒè¯•ï¼› ä¸åŒå…¥å£çš„æ–‡ä»¶å¯ä»¥å¼•ç”¨åŒä¸€ä»½ç»„ä»¶ã€å›¾ç‰‡ç­‰èµ„æºï¼Œä¹Ÿå¯ä»¥å¼•ç”¨ä¸åŒçš„èµ„æºï¼› ç»¼ä¸Šæ‰€è¿°ï¼Œä½ å¯ä»¥ç†è§£ä¸ºè¦å†™å¤šä¸ªé¡µé¢ï¼Œä½†æ˜¯é¡µé¢ä¹‹é—´è¦å¤ç”¨ç»„ä»¶ã€å‡½æ•°ç­‰ plugins:[ new HtmlWebpackPlugin({ //å¦‚æœæ‰“åŒ…å¤šä¸ªhtmlæ–‡ä»¶æ¥å¼•å…¥ä¸åŒçš„scriptåŒ…ï¼Œåˆ™å®šä¹‰filenameæ¥åŒºåˆ†æ‰“åŒ…è¾“å…¥html filename: 'index.html', chunks:['main'] }), new HtmlWebpackPlugin({ template: './index.html', filename: 'index2.html', chunks:['main2', 'lodash'] }) ], entry: { main: { import: \"./src/index.js\", dependOn: \"lodash\", }, main2: { import: \"./src/another-bundle.js\", dependOn: \"lodash\", }, lodash: \"lodash\", }, DefinePluginå…¨å±€å˜é‡webpackå†…éƒ¨æœ‰ä¸€ä¸ªDefinePluginï¼Œå¯ä»¥ç›´æ¥é€šè¿‡ä»¥ä¸‹æ–¹å¼è¿›è¡Œè·å–ï¼Œç„¶ååœ¨webpack.config.jsé‡Œé¢è·å–è®¾ç½®å…¨å±€å˜é‡ const { DefinePlugin } = require(\"webpack\") jså‹ç¼©çš„pluginwebpack v5 å¼€ç®±å³å¸¦æœ‰æœ€æ–°ç‰ˆæœ¬çš„ terser-webpack-pluginã€‚å¦‚æœä½ ä½¿ç”¨çš„æ˜¯ webpack v5 æˆ–æ›´é«˜ç‰ˆæœ¬ï¼ŒåŒæ—¶å¸Œæœ›è‡ªå®šä¹‰é…ç½®ï¼Œé‚£ä¹ˆä»éœ€è¦å®‰è£… terser-webpack-pluginã€‚å¦‚æœä½¿ç”¨ webpack v4ï¼Œåˆ™å¿…é¡»å®‰è£… terser-webpack-plugin v4 çš„ç‰ˆæœ¬ã€‚ é¦–å…ˆï¼Œä½ éœ€è¦å®‰è£… terser-webpack-pluginï¼š $ npm install terser-webpack-plugin --save-dev ç„¶åå°†æ’ä»¶æ·»åŠ åˆ°ä½ çš„ webpack é…ç½®æ–‡ä»¶ä¸­ã€‚ä¾‹å¦‚ï¼š webpack.config.js const TerserPlugin = require(\"terser-webpack-plugin\"); module.exports = { optimization: { minimize: true, minimizer: [new TerserPlugin()], }, }; é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜æœ‰å…¶ä»–æ¯”è¾ƒæœ‰ç”¨çš„å‹ç¼©æ’ä»¶ extract-text-webpack-plugin ç”¨äºå°† CSS ä»ä¸»åº”ç”¨ç¨‹åºä¸­åˆ†ç¦» optimize-css-assets-webpack-plugin å‹ç¼©æå–å‡ºçš„cssï¼Œè§£å†³extract-text-webpack-plugin CSSé‡å¤é—®é¢˜ CommonsChunkPlugin å°†å…¬å…±æ¨¡å—æ‹†å‡ºæ¥ï¼Œæœ€ç»ˆåˆæˆçš„æ–‡ä»¶èƒ½å¤Ÿåœ¨æœ€å¼€å§‹çš„æ—¶å€™åŠ è½½ä¸€æ¬¡ï¼Œä¾¿å­˜åˆ°ç¼“å­˜ä¸­ä¾›åç»­ä½¿ç”¨ MiniCssExtractPlugin æ³¨æ„âš ï¸ï¼šä»…æ”¯æŒwebpack5ä»¥ä¸Š æŠ½å‡ºstyleä»£ç  ä½¿ç”¨style-loader å’Œ css-loaderè¿›è¡Œè½¬æ¢å¾—åˆ°çš„ä»£ç ï¼Œæ˜¯ç›´æ¥æ”¾ç½®åœ¨htmlä¸­çš„ï¼Œè¦æƒ³æ”¾ç½®åœ¨å¦å¤–ä¸€ä¸ªæ–‡ä»¶ï¼Œç„¶åè®©æ‰“åŒ…åçš„htmlè¿›è¡Œlinkå¼•ç”¨ï¼Œéœ€è¦å®‰è£…ï¼š mini-css-extract-pluginï¼ˆéœ€è¦webpack5ä»¥ä¸Šç‰ˆæœ¬ï¼‰ npm i mini-css-extract-plugin -D å› ä¸ºstyle-loaderæ˜¯å°†å¯¼å‡ºçš„æ ·å¼æ·»åŠ åˆ°DOMï¼Œæ­¤æ—¶å‡å¦‚æˆ‘ä»¬ä½¿ç”¨äº†style-loaderï¼Œéœ€è¦æˆ‘ä»¬ æ‰‹åŠ¨åˆ é™¤æ‰ const MiniCssExtractPlugin = require(\"mini-css-extract-plugin\"); module.exports = { plugins: [new MiniCssExtractPlugin({ filename:'styles/[contenthash].css' //æ‰“åŒ…æ—¶è‡ªåŠ¨ç”Ÿæˆstylesæ–‡ä»¶å¤¹ï¼Œå¹¶ä¸”æ ¹æ®æ–‡ä»¶å†…å®¹ï¼Œç”Ÿæˆä¸€ä¸ªhashåç§°çš„cssæ–‡ä»¶å­˜æ”¾å…¶ä¸­ })], module: { rules: [ { test: /\\.css$/i, use: [MiniCssExtractPlugin.loader, \"css-loader\"], }, ], }, }; csså‹ç¼©çš„pluginæˆ‘ä»¬è¿˜éœ€è¦å…ˆæŠŠmodeæ”¹ä¸ºproductionï¼Œå¹¶ä¸”å®‰è£…äº†MiniCssExtractPlugin module.exports = { mode: \"production\", } å®‰è£… npm i css-minimizer-webpack-plugin -D const MiniCssExtractPlugin = require(\"mini-css-extract-plugin\"); const CssMinimizerPlugin = require(\"css-minimizer-webpack-plugin\"); module.exports = { module: { rules: [ { test: /.s?css$/, use: [MiniCssExtractPlugin.loader, \"css-loader\", \"sass-loader\"], }, ], }, optimization: { minimizer: [ // åœ¨ webpack@5 ä¸­ï¼Œä½ å¯ä»¥ä½¿ç”¨ `...` è¯­æ³•æ¥æ‰©å±•ç°æœ‰çš„ minimizerï¼ˆå³ `terser-webpack-plugin`ï¼‰ï¼Œå°†ä¸‹ä¸€è¡Œå–æ¶ˆæ³¨é‡Š // `...`, new CssMinimizerPlugin(), ], }, plugins: [new MiniCssExtractPlugin()], }; æ³¨æ„ï¼Œå¦‚æœåœ¨optimizationä¸­é…ç½®äº†cssçš„å‹ç¼©ï¼Œåˆ™jsé»˜è®¤çš„webpackè‡ªå¸¦terseræ’ä»¶å‹ç¼©æ•ˆæœå¤±æ•ˆï¼Œéœ€è¦åŒæ ·åœ¨optimizationä¸­é‡æ–°é…ç½® é¦–å…ˆä¸‹è½½terser npm i terser-webpack-plugin -D åœ¨webpacké…ç½®é¡¹ä¸­ä½¿ç”¨ const CssMinimizerPlugin = require(\"css-minimizer-webpack-plugin\"); const TerserPlugin = require(\"terser-webpack-plugin\"); module.exports = { //... optimization: { minimizer: [ // åœ¨ webpack@5 ä¸­ï¼Œä½ å¯ä»¥ä½¿ç”¨ `...` è¯­æ³•æ¥æ‰©å±•ç°æœ‰çš„ minimizerï¼ˆå³ `terser-webpack-plugin`ï¼‰ï¼Œå°†ä¸‹ä¸€è¡Œå–æ¶ˆæ³¨é‡Š // `...`, new CssMinimizerPlugin(), new TerserPlugin(), ], }, }; æ­¤æ—¶é€šè¿‡ä¿®æ”¹modeï¼Œå³å¯çœ‹åˆ°æµ‹è¯•ç¯å¢ƒdevelopmentæ²¡å‹ç¼©ä»£ç ã€productionä¸‹ä»£ç å‹ç¼©äº†","categories":[{"name":"å‰ç«¯","slug":"å‰ç«¯","permalink":"https://taylor12138.github.io/categories/%E5%89%8D%E7%AB%AF/"}],"tags":[],"author":"Hello"},{"title":"webpack(ä¸­)","slug":"webpack(ä¸­)","date":"2021-02-06T16:00:00.000Z","updated":"2023-04-17T09:27:31.293Z","comments":true,"path":"2021/02/07/webpack-zhong/","link":"","permalink":"https://taylor12138.github.io/2021/02/07/webpack-zhong/","excerpt":"","text":"4.å…¶ä»–webpackå¼€å‘ç¯å¢ƒçš„å¼€å‘æ¨¡å¼1. watchæ¨¡å¼è¯¥æ¨¡å¼ä¸‹ï¼Œwebpackä¼šå®æ—¶ä¾¦æµ‹æˆ‘ä»¬çš„jsæ–‡ä»¶å˜åŒ–ï¼Œåœ¨webpackä¾èµ–å›¾çš„æ‰€æœ‰æ–‡ä»¶ï¼Œåªè¦æœ‰ä¸€ä¸ªå‘ç”Ÿäº†æ›´æ–°ï¼Œé‚£ä¹ˆä»£ç å°†è¢«é‡æ–°ç¼–è¯‘ ä½†å¦‚æœä½¿ç”¨ä¸‹æ–¹æ­å»ºæœåŠ¡ï¼Œåˆ™æ²¡å¿…è¦å¼€å¯è¿™ä¸ªwatchæ¨¡å¼ï¼Œå› ä¸ºæœåŠ¡å†…ç½®äº†çƒ­æ›´æ–° å¼€å¯æ–¹æ³•ï¼š \"scripts\": { \"test\": \"echo \\\"Error: no test specified\\\" &amp;&amp; exit 1\", \"watch\": \"webpack --watch\", \"build\": \"webpack\" }, ä½†æ˜¯éœ€è¦æˆ‘ä»¬äººå·¥åˆ·æ–°ä¸€ä¸‹æµè§ˆå™¨ 2.dev-serveræ¨¡å¼ä¸ºäº†è®©webpackæä¾›å¼€å‘æ—¶æœåŠ¡ï¼Œå¯ä»¥è£…è½½webpack-dev-serveræ­å»ºæœ¬åœ°æœåŠ¡å™¨ï¼Œå®ƒå†…éƒ¨ä½¿ç”¨äº†expressæ¡†æ¶ å®é™…ä¸ŠVueã€Reactè„šæ‰‹æ¶æ­å»ºå®Œæ¯•åï¼Œå‘ˆç°çš„é¡µé¢éƒ½ç”¨åˆ°äº†è¿™ä¸ªæœ¬åœ°æœåŠ¡å™¨ npm install webpack-dev-server -D åœ¨webpack.config.jsé‡Œé…ç½®ï¼ˆè¿™é‡Œæœ‰å¤šä¸ªå…¥å£ï¼‰ module.exports = { mode: 'development', entry: { index: './src/index.js', print: './src/print.js', }, devtool: 'inline-source-map', + devServer: { + static: './dist', + }, plugins: [ new HtmlWebpackPlugin({ title: 'Development', }), ], output: { filename: '[name].bundle.js', path: path.resolve(__dirname, 'dist'), clean: true, }, + optimization: { + runtimeChunk: 'single', + }, }; å› ä¸ºåœ¨è¿™ä¸ªç¤ºä¾‹ä¸­å•ä¸ª HTML é¡µé¢æœ‰å¤šä¸ªå…¥å£ï¼Œæ‰€ä»¥æ·»åŠ äº† optimization.runtimeChunk: &#39;single&#39; é…ç½®ã€‚æ²¡æœ‰è¿™ä¸ªé…ç½®çš„è¯ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šé‡åˆ° è¿™ä¸ªé—®é¢˜ã€‚ æŸ¥çœ‹ ä»£ç åˆ†å‰² ç« èŠ‚è·å–æ›´å¤šç»†èŠ‚ã€‚ ä»é‚£ä¸ªé—®é¢˜çš„å®˜ç½‘ä¸­ä¹Ÿå¯ä»¥çœ‹åˆ°å…¬å…±ä¾èµ–çš„å®ä¾‹å¯¹è±¡ï¼Œå¯èƒ½ä¼šè¢«å®ä¾‹åŒ–å¤šæ¬¡ï¼Œæ¥è€Œå¤±å»çŠ¶æ€çš„åŒæ­¥ï¼Œä¸ºäº†ä¿æŒå®ä¾‹çš„å…±äº«ï¼ˆçŠ¶æ€åŒæ­¥ï¼‰ï¼Œéœ€è¦é…ç½®optimization.runtimeChunkä¸º&quot;single&quot;ï¼Œé»˜è®¤æƒ…å†µä¸‹å®ƒæ˜¯ç¦ç”¨çš„ï¼Œä½†è®°å½•åœ¨Webpack çš„ä»£ç æ‹†åˆ†æŒ‡å—ä¸­ã€‚ å½“ç„¶ä½ ä¹Ÿå¯ä»¥é…è¯¦ç»†ä¸€ç‚¹ å†æ¨èä¸€ä¸ªcopyWebpackPluginï¼Œå¸®åŠ©ä½ æŠŠèµ„æºåœ¨webpackæ‰“åŒ…çš„æ—¶å€™ï¼Œä¹Ÿæ”¾è¿›å» var path = require('path'); module.exports = { //... devServer: { static: path.resolve(__dirname, './dist'),//æŒ‡å‘å½“å‰æœåŠ¡çš„ç‰©ç†è·¯å¾„ /* contentBaseä¸ºï¼šåœ¨webpackç»™æˆ‘ä»¬æ‰“åŒ…çš„èµ„æºä¸­æ‰¾ä¸åˆ°æ—¶ï¼Œå†å»æŸ¥æ‰¾çš„åœ°å€ï¼Œæ˜¯ä¸€ä¸ªé¢å¤–çš„æ–‡ä»¶åœ°å€ ä¸€èˆ¬ç”¨äºåœ¨å¼€å‘æ—¶æ®µä¸æƒ³ä½¿ç”¨copyWebpackPluginï¼Œé¿å…æ‰“åŒ…çš„æ—¶å€™é€Ÿåº¦å¤ªæ…¢ å¼€å‘é˜¶æ®µï¼šcontentBase æ‰“åŒ…é˜¶æ®µï¼šcopyWebpackPluginï¼Œç„¶åæ”¾åˆ°æœåŠ¡å™¨ä¸­ */ contentBase: path.resolve(__dirname, './dist'), // inlineæ˜¯å¦å®æ—¶ç›‘å¬ inline:true, host: 0.0.0.0, //è®¾ç½®åœ°å€ï¼Œé»˜è®¤localhost compress: true, //æ˜¯å¦å¼€å¯gzipå‹ç¼©èµ„æº,é»˜è®¤true port: 9000, //ç«¯å£å·è®¾ç½® open: true, //è‡ªåŠ¨æ‰“å¼€æµè§ˆå™¨ proxy: { //å’ŒReacté…ç½®ä»£ç†çš„åŸç†ç›¸åŒ,ä»…é™æµ‹è¯•ç¯å¢ƒä¸‹è·¨åŸŸè§£å†³æ–¹æ¡ˆ '/api': { target: 'http://localhost:3000', pathRewrite: { '^/api': '' }, }, '/api2': 'http://localhost:3000', }, headers: { 'X-Access-Token': 'abc123' //è®¾ç½® }, https: true, //å°†æœåŠ¡å™¨è®¾ç½®ä¸ºhttpsï¼Œä½†æ˜¯éœ€è¦é…ç½®ä¸€äº›è¯ä¹¦ historyApiFallback: true, //ä¸€èˆ¬vueã€reactè„šæ‰‹æ¶éƒ½ä¼šé…ç½®ï¼Œç”¨äºSPAæ—¶å¦‚æœè¾“å…¥æœªé…ç½®çš„è·¯ç”±ï¼Œå¯ä»¥ç”¨æŸä¸ªé¡µé¢æ›¿ä»£ä»»ä½•404çš„é™æ€èµ„æºè¯·æ±‚ devMiddleware:{ writeToDisk: true //æ¯æ¬¡å¯åŠ¨æœåŠ¡çš„åŒæ—¶ï¼Œä¹Ÿä¼šè¿›è¡Œæ‰“åŒ… } } }; æ­¤æ—¶è¿˜å¯ä»¥å’Œèµ·æ­¥é…ç½® npm run build ä¸€æ ·é¡ºä¾¿åœ¨package.jsonæ–‡ä»¶çš„scriptä¸­å¢åŠ  &quot;dev&quot;:&quot;webpack-dev-server&quot; / &quot;serve&quot;: &quot;webpack serve&quot; æˆ–è€…æ˜¯ &quot;dev&quot;:&quot;npx webpack-dev-server&quot; / &quot;serve&quot;: &quot;npx webpack serve&quot; è¿™æ—¶å€™è¿è¡Œèµ·æ¥å°±ç›´æ¥ npm run devå³å¯ æ¨¡å—çƒ­æ›´æ–°åŸç†ï¼š å®é™…ä¸Šwebpackæ˜¯æœ‰è¿›è¡Œæ‰“åŒ…çš„ï¼Œä½†æ‰€æœ‰çš„äº§ç‰©æ–‡ä»¶éƒ½é»˜è®¤ä¸ä¼šå†™åˆ°ç£ç›˜ï¼Œè€Œæ˜¯æ”¾åˆ°å†…å­˜ä¸­ï¼Œæ‰€ä»¥æ²¡åšæ–‡ä»¶è¾“å‡ºï¼Œæ­¤æ—¶æˆ‘ä»¬å°±ç®—åˆ é™¤æ‰distæ–‡ä»¶ï¼ŒæœåŠ¡è¿˜æ˜¯ç…§å¸¸è¿›è¡Œï¼Œæ¯•ç«Ÿæ”¾è¿›äº†å†…å­˜ 3.middlewareæ¨¡å¼webpack-dev-middleware webpack-dev-middleware æ˜¯ä¸€ä¸ªå°è£…å™¨(wrapper)ï¼Œå®ƒå¯ä»¥æŠŠ webpack å¤„ç†è¿‡çš„æ–‡ä»¶å‘é€åˆ°ä¸€ä¸ª serverã€‚webpack-dev-server åœ¨å†…éƒ¨ä½¿ç”¨äº†å®ƒï¼Œç„¶è€Œå®ƒä¹Ÿå¯ä»¥ä½œä¸ºä¸€ä¸ªå•ç‹¬çš„ package æ¥ä½¿ç”¨ï¼Œä»¥ä¾¿æ ¹æ®éœ€æ±‚è¿›è¡Œæ›´å¤šè‡ªå®šä¹‰è®¾ç½®ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ª webpack-dev-middleware é…åˆ express server çš„ç¤ºä¾‹ã€‚ åœ¨å®˜ç½‘ä¸Šå¯ä»¥ç»§ç»­æŸ¥çœ‹ä½¿ç”¨æ–¹æ³•ï¼Œå¯ä»¥ç†è§£ä¸ºwebpackçš„ä¸­é—´ä»¶nodeè¿è¡Œæ¨¡å¼ï¼Œç›´æ¥è¿è¡Œnode webpackçš„resolveé…ç½®ï¼ˆæ¨¡å—è§£æç›¸å…³ï¼‰åœ¨webpack.config.jsä¸­é…ç½®ï¼Œç”¨äºè§£æ module.exports = { //... resolve: { //é»˜è®¤é…ç½®å¥½çš„åç¼€åå¤„ç†,å¯¼åŒ…çš„æ—¶å€™ä¸åŒæ·»åŠ ä»¥ä¸‹åç¼€åï¼Œå¯ä»¥è‡ªåŠ¨è¯†åˆ«ï¼Œå½“ç„¶ä½ ä¹Ÿå¯ä»¥è‡ªå·±æ·»åŠ  extensions: [\".js\", \".json\", \".mjs\"], //é…ç½®åˆ«å alias alias: { \"js\": path.resolve(__dirname, \"./src/js\"); } } }; ç”Ÿäº§/å¼€å‘æ—¶é…ç½®æ–‡ä»¶åˆ†ç¦»å¼€å‘æ—¶ä¾èµ–çš„é…ç½®æ–‡ä»¶å’Œå‘å¸ƒæ—¶ä¾èµ–çš„é…ç½®æ–‡ä»¶è¿›è¡Œåˆ†ç¦» æ–°å»ºä¸€ä¸ªconfigæ–‡ä»¶å¤¹ -&gt; æ–°å»ºä¸€ä¸ª base.config.jsæ–‡ä»¶ (å…¬å…±çš„é…ç½®æ”¾åœ¨baseé‡Œ) ã€prod.config.jsæ–‡ä»¶ï¼ˆæ”¾ç½®ç”Ÿäº§æ—¶çš„é…ç½®ï¼‰å’Œdev.config.jsï¼ˆæ”¾ç½®å¼€å‘æ—¶çš„é…ç½®ï¼‰ è¿™é‡Œè¿˜éœ€è¦å®‰è£…mergeï¼Œç”¨äºåˆå¹¶å…¬å…±é…ç½®å’Œç”Ÿäº§/å¼€å‘é…ç½® npm i webpack-merge@4.1.5 --save-dev ç„¶ååˆ†åˆ«åœ¨prod.config.jsæ–‡ä»¶ å’Œdev.config.js å†™å¥½å„è‡ªçš„é…ç½® const {merge} = require('webpack-merge'); const baseConfig = require('./base.config'); // åˆå¹¶å¯¼å‡º module.exports = merge(baseConfig, { //å„è‡ªé…ç½® }); æœ€ååœ¨package.jsoné…ç½®æ–‡ä»¶ä¸­ï¼Œä¿®æ”¹ åŸæ¥è¿è¡Œwebpack å’Œ è¿è¡ŒwebpackæœåŠ¡å™¨çš„ é”®ä½ æ”¹ä¸º ï¼š \"build\": \"webpack --config ./config/prod.config.js\", \"dev\": \"webpack-dev-server --config ./config/dev.config.js\" --config ç¼©å†™ä¸º -c è¿™é‡Œå¦‚æœæ‰“åŒ…åæ–‡ä»¶å‡ºç°ä¸æ˜¯åœ¨åŸæ¥çš„ç›®å½•ï¼Œå¯ä»¥æ£€æŸ¥ä¸€ä¸‹base.config.jsæ–‡ä»¶çš„ outputå‡ºå£ï¼Œè¿›è¡Œä¿®æ”¹ ä»£ç åˆ†ç¦»æ–¹å¼ï¼ˆä»£ç åˆ†å—ï¼‰æ–¹å¼ä¸€ï¼šåœ¨entryé…ç½®å¤šå…¥å£ æ³¨æ„ï¼šåœ¨å¯¼å…¥å¤šä¸ªå…¥å£æ–‡ä»¶ä¹‹åï¼Œè¾“å‡ºæ–‡ä»¶çš„filenameåˆ™ä¸èƒ½å›ºå®šæ­»ï¼Œæ¯•ç«Ÿæ˜¯ç”Ÿæˆäº†å¤šä¸ªæ‰“åŒ…æ–‡ä»¶ module.exports = { entry: { index: \"./src/index.js\", another: \"./src/another-bundle.js\", }, output: { path: path.join(__dirname, \"dist\"), filename: \"[name].bundle.js\",, //è®©è¾“å‡ºçš„æ–‡ä»¶æ ¹æ®è‡ªå·±æœ¬èº«entryçš„keyå‘½å }, } æ‰“åŒ…ä¹‹åæˆ‘ä»¬å¯ä»¥çœ‹åˆ°æœ‰ index.bundle.jsã€another-bundle.bundle.jsä¸¤ä¸ªæ‰“åŒ…æ–‡ä»¶å‡ºæ¥ ç¼ºç‚¹ï¼šé€šç”¨çš„åŒ…å¦‚æœä½¿ç”¨äº†ä¹‹åï¼Œéƒ½ä¼šåˆ†åˆ«æ‰“åˆ°chunké‡Œé¢ï¼Œé€ æˆä»£ç é‡å¤+å¤§é‡(é‡å¤æ‰“åŒ…é—®é¢˜) æ–¹å¼äºŒï¼šé˜²æ­¢é‡å¤ ä»éœ€è¦åœ¨entryè¿›è¡Œé…ç½®ï¼Œä½†æ˜¯ç›¸å¯¹äºç¬¬ä¸€ç§å¯ä»¥æŠŠå…¬å…±ä»£ç æŠ½ç¦»æˆchunk module.exports = { entry: { index: { import: \"./src/index.js\", dependOn: \"shared\", }, another: { import: \"./src/another-bundle.js\", dependOn: \"shared\", }, shared: \"lodash\", //å½“ä¸¤ä¸ªæ¨¡å—ä¸­æœ‰lodashæ—¶ï¼Œå°±ä¼šè‡ªåŠ¨æŠ½ç¦»å‡ºæ¥ï¼Œå¹¶ä¸”å–åsharedè¿™ä¸ªchunk }, output: { path: path.join(__dirname, \"dist\"), filename: \"[name].bundle.js\", }, optimization: { runtimeChunk: 'single', }, } æ­¤æ—¶ä¼šå¤šæ‰“åŒ…ä¸€ä¸ª shared.bundle.jsæ–‡ä»¶æ”¾ç½®å…¬å…±ä»£ç  å…¶ä»–å…³äº optimization: {runtimeChunk: &#39;single&#39;}çš„å¥½å¤„ å¯ä»¥åœ¨ dev-serveræ¨¡å¼ ã€runtimeChunkä¼˜åŒ–ä¸­æŸ¥çœ‹ å…¶å®è¿˜æœ‰ä¸€ä¸ªwebpackçš„å†…ç½®æ’ä»¶ï¼Œä¹Ÿæ˜¯ç±»ä¼¼çš„é˜²æ­¢é‡å¤åŠŸèƒ½ split-chunks-Plugin è¿™ä¸ªæ’ä»¶ä¹Ÿå¯ä»¥å°†æˆ‘ä»¬æ¨¡å—ä¾èµ–çš„å…¬å…±ä»£ç æŠ½ç¦»æˆå•ç‹¬çš„chunksï¼ˆè‡ªåŠ¨æŠ½ç¦»å…¬å…±ä»£ç ï¼Œgoodï¼ï¼‰ module.exports = { entry: { index: \"./src/index.js\", another: \"./src/another-bundle.js\", }, output: { path: path.join(__dirname, \"dist\"), filename: \"[name].bundle.js\", //è®©è¾“å‡ºçš„æ–‡ä»¶æ ¹æ®è‡ªå·±æœ¬èº«entryçš„keyå‘½å }, optimization: { splitChunks: { chunks: \"all\", }, }, } æ­¤æ–¹æ³•å¯¹äºæœ‰åŠ¨æ€å¯¼å…¥éœ€æ±‚ï¼Œä¹ŸåŒæ ·é€‚ç”¨é˜²æ­¢é‡å¤åœ°è¿›è¡Œä»£ç æŠ½ç¦»ï¼Œç„¶åæ‰“åŒ…ï¼ˆåŠ¨æ€å¯¼å…¥å³ä¸‹æ–¹çš„æ‡’åŠ è½½å¯¼å…¥ï¼‰ æ‡’åŠ è½½export const add = (x, y) => { return x + y; }; export const minus = (x, y) => { return x - y; }; const button = document.createElement(\"button\"); button.textContent = \"ç‚¹å‡»æ‰§è¡ŒåŠ æ³•è¿ç®—\"; button.addEventListener(\"click\", () => { import(\"./async-math\").then(({ add }) => { console.log(add(4, 5)); }); }); document.body.appendChild(button) ä»¥ä¸Šæ˜¯åœ¨æŠ€æœ¯æ¦‚å¿µä¸Šâ€œæ‡’åŠ è½½â€å®ƒã€‚é—®é¢˜æ˜¯åŠ è½½è¿™ä¸ªåŒ…å¹¶ä¸éœ€è¦ç”¨æˆ·çš„äº¤äº’ - æ„æ€æ˜¯æ¯æ¬¡åŠ è½½é¡µé¢çš„æ—¶å€™éƒ½ä¼šè¯·æ±‚å®ƒã€‚è¿™æ ·åšå¹¶æ²¡æœ‰å¯¹æˆ‘ä»¬æœ‰å¾ˆå¤šå¸®åŠ©ï¼Œè¿˜ä¼šå¯¹æ€§èƒ½äº§ç”Ÿè´Ÿé¢å½±å“ã€‚ æˆ‘ä»¬è¯•è¯•ä¸åŒçš„åšæ³•ã€‚æˆ‘ä»¬å¢åŠ ä¸€ä¸ªäº¤äº’ï¼Œå½“ç”¨æˆ·ç‚¹å‡»æŒ‰é’®çš„æ—¶å€™ç”¨ console æ‰“å°ä¸€äº›æ–‡å­—ã€‚ä½†æ˜¯ä¼šç­‰åˆ°ç¬¬ä¸€æ¬¡äº¤äº’çš„æ—¶å€™å†åŠ è½½é‚£ä¸ªä»£ç å—ï¼ˆprint.jsï¼‰ project webpack-demo |- package.json |- package-lock.json |- webpack.config.js |- /dist |- /src |- index.js + |- print.js |- /node_modules src/print.js console.log( 'The print.js module has loaded! See the network tab in dev tools...' ); export default () => { console.log('Button Clicked: Here\\'s \"some text\"!'); }; src/index.js + import _ from 'lodash'; + - async function getComponent() { + function component() { const element = document.createElement('div'); - const _ = await import(/* webpackChunkName: \"lodash\" */ 'lodash'); + const button = document.createElement('button'); + const br = document.createElement('br'); + button.innerHTML = 'Click me and look at the console!'; element.innerHTML = _.join(['Hello', 'webpack'], ' '); + element.appendChild(br); + element.appendChild(button); + + // Note that because a network request is involved, some indication + // of loading would need to be shown in a production-level site/app. + button.onclick = e => import(/* webpackChunkName: \"print\" */ './print').then(module => { + const print = module.default; + + print(); + }); return element; } - getComponent().then(component => { - document.body.appendChild(component); - }); + document.body.appendChild(component()); Warningæ³¨æ„å½“è°ƒç”¨ ES6 æ¨¡å—çš„ import() æ–¹æ³•ï¼ˆå¼•å…¥æ¨¡å—ï¼‰æ—¶ï¼Œå¿…é¡»æŒ‡å‘æ¨¡å—çš„ .default å€¼ï¼Œå› ä¸ºå®ƒæ‰æ˜¯ promise è¢«å¤„ç†åè¿”å›çš„å®é™…çš„ module å¯¹è±¡ã€‚ å¼‚æ­¥åŠ è½½çš„åŸç†ï¼š import(chunkId) =&gt; __webpack_require__.e(chunkId) å°†ç›¸å…³çš„è¯·æ±‚å›è°ƒå­˜å…¥ installedChunksã€‚ // import(chunkId) => __webpack_require__.e(chunkId) __webpack_require__.e = function(chunkId) { return new Promise((resolve, reject) => { var script = document.createElement('script'); script.src = jsonpScriptSrc(chunkId); var onScriptComplete = function(event) { // ... }; var timeout = setTimeout(function() { onScriptComplete({ type: 'timeout', target: script }); }, 120000); script.onerror = script.onload = onScriptComplete; document.head.appendChild(script); }); }; é¢„è·å–ä½¿ç”¨é¢„è·å–å¯¼å…¥jsæ–‡ä»¶æ—¶ï¼Œä¼šåœ¨htmlåœ°headä¸Šå¤šä¸€ä¸ªæ–°çš„linkï¼Œå«åšrel prefetch ä»–å¯¹æ¯”æ‡’åŠ è½½çš„æ„ä¹‰åœ¨äº æ‡’åŠ è½½æ˜¯ï¼šç”¨åˆ° -&gt; åŠ è½½é¢„è·å–æ˜¯ï¼šç½‘ç»œç©ºé—² - &gt; åŠ è½½ åœ¨webpackä¸­ä½¿ç”¨ï¼šï¼ˆä½¿ç”¨ä¸Šæ–¹çš„ä¸€ä¸ªbuttonä¾‹å­è¿›è¡Œç¤ºèŒƒ, webpackChunkNameç”¨äºè‡ªå®šä¹‰webpackåŠ¨æ€å¯¼å…¥çš„åŒ…åï¼‰ const button = document.createElement(\"button\"); button.textContent = \"ç‚¹å‡»æ‰§è¡ŒåŠ æ³•è¿ç®—\"; button.addEventListener(\"click\", () => { import(/*webpackChunkName: 'math', webpackPrefetch: true*/ \"./async-math\").then(({ add }) => { console.log(add(4, 5)); }); }); document.body.appendChild(button) å¤–éƒ¨æ‰©å±•(Externals)externals é…ç½®é€‰é¡¹æä¾›äº†ã€Œä»è¾“å‡ºçš„ bundle ä¸­æ’é™¤ä¾èµ–ã€çš„æ–¹æ³• é˜²æ­¢å°†æŸäº› import çš„åŒ…(package)æ‰“åŒ…åˆ° bundle ä¸­ï¼Œè€Œæ˜¯åœ¨è¿è¡Œæ—¶(runtime)å†å»ä»å¤–éƒ¨è·å–è¿™äº›æ‰©å±•ä¾èµ–(external dependencies)ã€‚ ä¾‹å¦‚ï¼Œä» CDN å¼•å…¥ jQueryï¼Œè€Œä¸æ˜¯æŠŠå®ƒæ‰“åŒ…ï¼š index.htmlï¼ˆæ‰“åŒ…çš„æ¨¡æ¿htmlè¦è¿›è¡Œé…ç½®ï¼‰ &lt;script src=\"https://code.jquery.com/jquery-3.1.0.js\" integrity=\"sha256-slogkvB1K3VOkzAI8QITxV3VzpOnkeNVsKvtkYLMjfk=\" crossorigin=\"anonymous\" >&lt;/script> webpack.config.js module.exports = { //... //keyçš„åå­—è¦å’ŒåŒ…åä¸€è‡´ externals: { jquery: 'jQuery', }, }; è¿™æ ·å°±å‰¥ç¦»äº†é‚£äº›ä¸éœ€è¦æ”¹åŠ¨çš„ä¾èµ–æ¨¡å—ï¼Œæ¢å¥è¯ï¼Œä¸‹é¢å±•ç¤ºçš„ä»£ç è¿˜å¯ä»¥æ­£å¸¸è¿è¡Œï¼š import $ from 'jquery'; $('.my-element').animate(/* ... */); äº¦æˆ–è€…è¿™æ ·é…ç½® module.exports = { //... externalsType: 'script', externals: { jquery: [ 'https://code.jquery.com/jquery-3.1.0.js', 'jQuery' ], }, }; ç¼“å­˜äº§ç”Ÿçš„é—®é¢˜é—®é¢˜æ‰€åœ¨å¦‚æœæˆ‘ä»¬åœ¨éƒ¨ç½²æ–°ç‰ˆæœ¬æ—¶ä¸æ›´æ”¹èµ„æºçš„æ–‡ä»¶åï¼Œæµè§ˆå™¨å¯èƒ½ä¼šè®¤ä¸ºå®ƒæ²¡æœ‰è¢«æ›´æ–°ï¼Œå°±ä¼šä½¿ç”¨å®ƒçš„ç¼“å­˜ç‰ˆæœ¬ã€‚ç”±äºç¼“å­˜çš„å­˜åœ¨ï¼Œå½“ä½ éœ€è¦è·å–æ–°çš„ä»£ç æ—¶ï¼Œå°±ä¼šæ˜¾å¾—å¾ˆæ£˜æ‰‹ã€‚ æˆ‘ä»¬å¯ä»¥é€šè¿‡æ›¿æ¢ output.filename ä¸­çš„ substitutions è®¾ç½®ï¼Œæ¥å®šä¹‰è¾“å‡ºæ–‡ä»¶çš„åç§°ã€‚webpack æä¾›äº†ä¸€ç§ä½¿ç”¨ç§°ä¸º substitution(å¯æ›¿æ¢æ¨¡æ¿å­—ç¬¦ä¸²) çš„æ–¹å¼ï¼Œé€šè¿‡å¸¦æ‹¬å·å­—ç¬¦ä¸²æ¥æ¨¡æ¿åŒ–æ–‡ä»¶åã€‚å…¶ä¸­ï¼Œ[contenthash] substitution å°†æ ¹æ®èµ„æºå†…å®¹åˆ›å»ºå‡ºå”¯ä¸€ hashã€‚å½“èµ„æºå†…å®¹å‘ç”Ÿå˜åŒ–æ—¶ï¼Œ[contenthash] ä¹Ÿä¼šå‘ç”Ÿå˜åŒ–ã€‚ //webpack.config.js const path = require('path'); const HtmlWebpackPlugin = require('html-webpack-plugin'); module.exports = { entry: './src/index.js', plugins: [ new HtmlWebpackPlugin({ title: 'Caching', }), ], output: { -- filename: 'bundle.js', ++ filename: '[name].[contenthash].js', path: path.resolve(__dirname, 'dist'), clean: true, }, }; ä½¿ç”¨æ­¤é…ç½®ï¼Œç„¶åè¿è¡Œæˆ‘ä»¬çš„ build script npm run buildï¼Œäº§ç”Ÿä»¥ä¸‹è¾“å‡ºï¼š ... Asset Size Chunks Chunk Names main.7e2c49a622975ebd9b7e.js 544 kB 0 [emitted] [big] main index.html 197 bytes [emitted] ... å¯ä»¥çœ‹åˆ°ï¼Œbundle çš„åç§°æ˜¯å®ƒå†…å®¹ï¼ˆé€šè¿‡ hashï¼‰çš„æ˜ å°„ã€‚å¦‚æœæˆ‘ä»¬ä¸åšä¿®æ”¹ï¼Œç„¶åå†æ¬¡è¿è¡Œæ„å»ºï¼Œæˆ‘ä»¬ä»¥ä¸ºæ–‡ä»¶åä¼šä¿æŒä¸å˜ã€‚ ç„¶è€Œ!!!!!!!ï¼Œå¦‚æœæˆ‘ä»¬çœŸçš„è¿è¡Œï¼Œå¯èƒ½ä¼šå‘ç°æƒ…å†µå¹¶éå¦‚æ­¤ï¼š ... Asset Size Chunks Chunk Names main.205199ab45963f6a62ec.js 544 kB 0 [emitted] [big] main index.html 197 bytes [emitted] ... è¿™ä¹Ÿæ˜¯å› ä¸º webpack åœ¨å…¥å£ chunk ä¸­ï¼ŒåŒ…å«äº†æŸäº› boilerplate(å¼•å¯¼æ¨¡æ¿)ï¼Œç‰¹åˆ«æ˜¯ runtime å’Œ manifestã€‚ runtimeChunkä¼˜åŒ–æ­£å¦‚æˆ‘ä»¬åœ¨ ä»£ç åˆ†ç¦» ä¸­æ‰€å­¦åˆ°çš„ï¼ŒSplitChunksPlugin å¯ä»¥ç”¨äºå°†æ¨¡å—åˆ†ç¦»åˆ°å•ç‹¬çš„ bundle ä¸­ã€‚webpack è¿˜æä¾›äº†ä¸€ä¸ªä¼˜åŒ–åŠŸèƒ½ï¼Œå¯ä½¿ç”¨ optimization.runtimeChunk é€‰é¡¹ å°† runtime ä»£ç æ‹†åˆ†ä¸ºä¸€ä¸ªå•ç‹¬çš„ chunkã€‚å°†å…¶è®¾ç½®ä¸º single æ¥ä¸ºæ‰€æœ‰ chunk åˆ›å»ºä¸€ä¸ª runtime bundleï¼š webpack.config.js const path = require('path'); const HtmlWebpackPlugin = require('html-webpack-plugin'); module.exports = { entry: './src/index.js', plugins: [ new HtmlWebpackPlugin({ title: 'Caching', }), ], output: { filename: '[name].[contenthash].js', path: path.resolve(__dirname, 'dist'), clean: true, }, + optimization: { + runtimeChunk: 'single', + }, }; å†æ¬¡æ„å»ºï¼Œç„¶åæŸ¥çœ‹æå–å‡ºæ¥çš„ runtime bundleï¼š Hash: 82c9c385607b2150fab2 Version: webpack 4.12.0 Time: 3027ms Asset Size Chunks Chunk Names runtime.cc17ae2a94ec771e9221.js 1.42 KiB 0 [emitted] runtime main.e81de2cf758ada72f306.js 69.5 KiB 1 [emitted] main index.html 275 bytes [emitted] [1] (webpack)/buildin/module.js 497 bytes {1} [built] [2] (webpack)/buildin/global.js 489 bytes {1} [built] [3] ./src/index.js 309 bytes {1} [built] + 1 hidden module å°†ç¬¬ä¸‰æ–¹åº“(library)ï¼ˆä¾‹å¦‚ lodash æˆ– reactï¼‰æå–åˆ°å•ç‹¬çš„ vendor chunk æ–‡ä»¶ä¸­ï¼Œæ˜¯æ¯”è¾ƒæ¨èçš„åšæ³•ï¼Œè¿™æ˜¯å› ä¸ºï¼Œå®ƒä»¬å¾ˆå°‘åƒæœ¬åœ°çš„æºä»£ç é‚£æ ·é¢‘ç¹ä¿®æ”¹ã€‚å› æ­¤é€šè¿‡å®ç°ä»¥ä¸Šæ­¥éª¤ï¼Œåˆ©ç”¨ client çš„é•¿æ•ˆç¼“å­˜æœºåˆ¶ï¼Œå‘½ä¸­ç¼“å­˜æ¥æ¶ˆé™¤è¯·æ±‚ï¼Œå¹¶å‡å°‘å‘ server è·å–èµ„æºï¼ŒåŒæ—¶è¿˜èƒ½ä¿è¯ client ä»£ç å’Œ server ä»£ç ç‰ˆæœ¬ä¸€è‡´ã€‚ è¿™å¯ä»¥é€šè¿‡ä½¿ç”¨ SplitChunksPlugin ç¤ºä¾‹ 2 ä¸­æ¼”ç¤ºçš„ SplitChunksPlugin æ’ä»¶çš„ cacheGroups é€‰é¡¹æ¥å®ç°ã€‚æˆ‘ä»¬åœ¨ optimization.splitChunks æ·»åŠ å¦‚ä¸‹ cacheGroups å‚æ•°å¹¶æ„å»ºï¼š webpack.config.js const path = require('path'); const HtmlWebpackPlugin = require('html-webpack-plugin'); module.exports = { entry: './src/index.js', plugins: [ new HtmlWebpackPlugin({ title: 'Caching', }), ], output: { filename: '[name].[contenthash].js', path: path.resolve(__dirname, 'dist'), clean: true, }, optimization: { runtimeChunk: 'single', + splitChunks: { + cacheGroups: { + vendor: { + test: /[\\\\/]node_modules[\\\\/]/, + name: 'vendors', + chunks: 'all', + }, + }, + }, }, }; å†æ¬¡æ„å»ºï¼Œç„¶åæŸ¥çœ‹æ–°çš„ vendor bundleï¼š ... Asset Size Chunks Chunk Names runtime.cc17ae2a94ec771e9221.js 1.42 KiB 0 [emitted] runtime vendors.a42c3ca0d742766d7a28.js 69.4 KiB 1 [emitted] vendors main.abf44fedb7d11d4312d7.js 240 bytes 2 [emitted] main index.html 353 bytes [emitted] ... ç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ° main ä¸å†å«æœ‰æ¥è‡ª node_modules ç›®å½•çš„ vendor ä»£ç ï¼Œå¹¶ä¸”ä½“ç§¯å‡å°‘åˆ° 240 bytesï¼ æ¨¡å—æ ‡è¯†ç¬¦(module identifier)åœ¨é¡¹ç›®ä¸­å†æ·»åŠ ä¸€ä¸ªæ¨¡å— print.jsï¼š project webpack-demo |- package.json |- package-lock.json |- webpack.config.js |- /dist |- /src |- index.js + |- print.js |- /node_modules print.js + export default function print(text) { + console.log(text); + }; src/index.js import _ from 'lodash'; + import Print from './print'; function component() { const element = document.createElement('div'); // lodash æ˜¯ç”±å½“å‰ script è„šæœ¬ import è¿›æ¥çš„ element.innerHTML = _.join(['Hello', 'webpack'], ' '); + element.onclick = Print.bind(null, 'Hello webpack!'); return element; } document.body.appendChild(component()); å†æ¬¡è¿è¡Œæ„å»ºï¼Œç„¶åæˆ‘ä»¬æœŸæœ›çš„æ˜¯ï¼Œåªæœ‰ main bundle çš„ hash å‘ç”Ÿå˜åŒ–ï¼Œç„¶è€Œâ€¦â€¦ ... Asset Size Chunks Chunk Names runtime.1400d5af64fc1b7b3a45.js 5.85 kB 0 [emitted] runtime vendor.a7561fb0e9a071baadb9.js 541 kB 1 [emitted] [big] vendor main.b746e3eb72875af2caa9.js 1.22 kB 2 [emitted] main index.html 352 bytes [emitted] ... â€¦â€¦æˆ‘ä»¬å¯ä»¥çœ‹åˆ°è¿™ä¸‰ä¸ªæ–‡ä»¶çš„ hash éƒ½å˜åŒ–äº†ã€‚è¿™æ˜¯å› ä¸ºæ¯ä¸ª module.id ä¼šé»˜è®¤åœ°åŸºäºè§£æé¡ºåº(resolve order)è¿›è¡Œå¢é‡ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå½“è§£æé¡ºåºå‘ç”Ÿå˜åŒ–ï¼ŒID ä¹Ÿä¼šéšä¹‹æ”¹å˜ã€‚ç®€è¦æ¦‚æ‹¬ï¼š main bundle ä¼šéšç€è‡ªèº«çš„æ–°å¢å†…å®¹çš„ä¿®æ”¹ï¼Œè€Œå‘ç”Ÿå˜åŒ–ã€‚ vendor bundle ä¼šéšç€è‡ªèº«çš„ module.id çš„å˜åŒ–ï¼Œè€Œå‘ç”Ÿå˜åŒ–ã€‚ manifest runtime ä¼šå› ä¸ºç°åœ¨åŒ…å«ä¸€ä¸ªæ–°æ¨¡å—çš„å¼•ç”¨ï¼Œè€Œå‘ç”Ÿå˜åŒ–ã€‚ ç¬¬ä¸€ä¸ªå’Œæœ€åä¸€ä¸ªéƒ½æ˜¯ç¬¦åˆé¢„æœŸçš„è¡Œä¸ºï¼Œvendor hash å‘ç”Ÿå˜åŒ–æ˜¯æˆ‘ä»¬è¦ä¿®å¤çš„ã€‚æˆ‘ä»¬å°† optimization.moduleIds è®¾ç½®ä¸º &#39;deterministic&#39;ï¼š webpack.config.js const path = require('path'); const HtmlWebpackPlugin = require('html-webpack-plugin'); module.exports = { entry: './src/index.js', plugins: [ new HtmlWebpackPlugin({ title: 'Caching', }), ], output: { filename: '[name].[contenthash].js', path: path.resolve(__dirname, 'dist'), clean: true, }, optimization: { + moduleIds: 'deterministic', runtimeChunk: 'single', splitChunks: { cacheGroups: { vendor: { test: /[\\\\/]node_modules[\\\\/]/, name: 'vendors', chunks: 'all', }, }, }, }, }; ç°åœ¨ï¼Œä¸è®ºæ˜¯å¦æ·»åŠ ä»»ä½•æ–°çš„æœ¬åœ°ä¾èµ–ï¼Œå¯¹äºå‰åä¸¤æ¬¡æ„å»ºï¼Œvendor hash éƒ½åº”è¯¥ä¿æŒä¸€è‡´ï¼š ... Asset Size Chunks Chunk Names main.216e852f60c8829c2289.js 340 bytes 0 [emitted] main vendors.55e79e5927a639d21a1b.js 69.5 KiB 1 [emitted] vendors runtime.725a1a51ede5ae0cfde0.js 1.42 KiB 2 [emitted] runtime index.html 353 bytes [emitted] Entrypoint main = runtime.725a1a51ede5ae0cfde0.js vendors.55e79e5927a639d21a1b.js main.216e852f60c8829c2289.js ... ç„¶åï¼Œä¿®æ”¹ src/index.jsï¼Œä¸´æ—¶ç§»é™¤é¢å¤–çš„ä¾èµ–ï¼š src/index.js import _ from 'lodash'; - import Print from './print'; + // import Print from './print'; function component() { const element = document.createElement('div'); // lodash æ˜¯ç”±å½“å‰ script è„šæœ¬ import è¿›æ¥çš„ element.innerHTML = _.join(['Hello', 'webpack'], ' '); - element.onclick = Print.bind(null, 'Hello webpack!'); + // element.onclick = Print.bind(null, 'Hello webpack!'); return element; } document.body.appendChild(component()); æœ€åï¼Œå†æ¬¡è¿è¡Œæˆ‘ä»¬çš„æ„å»ºï¼š ... Asset Size Chunks Chunk Names main.ad717f2466ce655fff5c.js 274 bytes 0 [emitted] main vendors.55e79e5927a639d21a1b.js 69.5 KiB 1 [emitted] vendors runtime.725a1a51ede5ae0cfde0.js 1.42 KiB 2 [emitted] runtime index.html 353 bytes [emitted] Entrypoint main = runtime.725a1a51ede5ae0cfde0.js vendors.55e79e5927a639d21a1b.js main.ad717f2466ce655fff5c.js ... æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œè¿™ä¸¤æ¬¡æ„å»ºä¸­ï¼Œvendor bundle æ–‡ä»¶åç§°ï¼Œéƒ½æ˜¯ 55e79e5927a639d21a1bã€‚ æé«˜è§£æé€Ÿåº¦è§£æ ä»¥ä¸‹æ­¥éª¤å¯ä»¥æé«˜è§£æé€Ÿåº¦ï¼š å‡å°‘ resolve.modules, resolve.extensions, resolve.mainFiles, resolve.descriptionFiles ä¸­æ¡ç›®æ•°é‡ï¼Œå› ä¸ºä»–ä»¬ä¼šå¢åŠ æ–‡ä»¶ç³»ç»Ÿè°ƒç”¨çš„æ¬¡æ•°ã€‚ å¦‚æœä½ ä¸ä½¿ç”¨ symlinksï¼ˆä¾‹å¦‚ npm link æˆ–è€… yarn linkï¼‰ï¼Œå¯ä»¥è®¾ç½® resolve.symlinks: falseã€‚ å¦‚æœä½ ä½¿ç”¨è‡ªå®šä¹‰ resolve plugin è§„åˆ™ï¼Œå¹¶ä¸”æ²¡æœ‰æŒ‡å®š context ä¸Šä¸‹æ–‡ï¼Œå¯ä»¥è®¾ç½® resolve.cacheWithContext: falseã€‚","categories":[{"name":"å‰ç«¯","slug":"å‰ç«¯","permalink":"https://taylor12138.github.io/categories/%E5%89%8D%E7%AB%AF/"}],"tags":[],"author":"Hello"},{"title":"Vue(ä¸Š)","slug":"Vue(ä¸Š)","date":"2021-01-31T16:00:00.000Z","updated":"2022-07-06T16:46:01.071Z","comments":true,"path":"2021/02/01/vue-shang/","link":"","permalink":"https://taylor12138.github.io/2021/02/01/vue-shang/","excerpt":"","text":"1.é‚‚é€…VUEvueæ˜¯ä¸€ä¸ªæ¸è¿›å¼æ¡†æ¶ï¼Œè¿™æ„å‘³ç€å¯ä»¥ä½œä¸ºä½ åº”ç”¨çš„ä¸€éƒ¨åˆ†åµŒå…¥å…¶ä¸­ï¼Œå¯¹é¡¹ç›®ä¸€ç‚¹ç‚¹è¿›è¡Œé‡æ„ï¼Œå“åº”å¼ï¼šç•Œé¢éšç€æ•°æ®éšæ—¶å‘ç”Ÿæ”¹å˜ ä»¥å‰JSåŸå§‹ç¼–å†™çš„æ–¹æ³•ï¼šå‘½ä»¤å¼ç¼–ç¨‹ï¼› Vueç¼–å†™æ–¹æ³•ï¼šå£°æ˜å¼ç¼–ç¨‹ vueå…¨å®¶æ¡¶ï¼šCore + Vue-router + Vuex Vueç‰¹ç‚¹ï¼š è§£è€¦è§†å›¾å’Œæ•°æ® å¯å¤ç”¨ç»„ä»¶ å‰ç«¯è·¯ç”±æŠ€æœ¯ çŠ¶æ€ç®¡ç† è™šæ‹ŸDOM å¼•å…¥vue $ npm install vue ä½“éªŒï¼š &lt;div id=\"app\"> &lt;ul> &lt;li v-for='item in message'>{{item}}&lt;/li> &lt;/ul> &lt;/div> &lt;script src=\"./js/vue.js\">&lt;/script> &lt;script> const app = new Vue({ el: '#app', data: { message: ['i', 'wanna', 'be', 'with', 'you'] } }) &lt;/script> Vueå’ŒMVVMå‰æè¯·è®°ä½ï¼šåœ¨å®˜æ–¹æ–‡æ¡£ä¸­å†™é“ï¼Œè™½ç„¶Vueå¹¶æ²¡æœ‰å®Œå…¨éµå¾ªMVVMæ¨¡å‹ï¼Œä½†æ˜¯Vueçš„è®¾è®¡ä¹Ÿå—åˆ°äº†å®ƒçš„å¯å‘ï¼Œå› æ­¤åœ¨æ–‡æ¡£ä¸­ç»å¸¸ä¼šä½¿ç”¨VMè¿™ä¸ªå˜é‡åè¡¨ç¤ºVueçš„å®ä¾‹ã€‚ Vueå¯ä»¥é€šè¿‡refå¯ä»¥æ‹¿åˆ°domå¯¹è±¡ï¼Œé€šè¿‡refç›´æ¥å»æ“ä½œè§†å›¾ã€‚è¿™ä¸€ç‚¹ä¸Šï¼Œè¿èƒŒäº†MVVMã€‚ MVVM æ¨¡å¼é¡¾åæ€ä¹‰å³ Model-View-ViewModel æ¨¡å¼ï¼Œæœ€æ ‡å¿—æ€§çš„ç‰¹æ€§å°±æ˜¯ æ•°æ®ç»‘å®š ï¼Œæ“ä½œæ•°æ® = æ“ä½œè§†å›¾ï¼Œæ“ä½œDOM ä»¥ Vue æ¡†æ¶æ¥ä¸¾ä¾‹ï¼ŒViewModel å°±æ˜¯ç»„ä»¶çš„å®ä¾‹ã€‚View å°±æ˜¯æ¨¡æ¿ï¼ŒModel çš„è¯åœ¨å¼•å…¥ Vuex çš„æƒ…å†µä¸‹æ˜¯å®Œå…¨å¯ä»¥å’Œç»„ä»¶åˆ†ç¦»çš„ã€‚ Model å±‚: ä»…ä»…å…³æ³¨æ•°æ®æœ¬èº«ï¼Œå¯¹åº”æ•°æ®å±‚çš„åŸŸæ¨¡å‹ï¼Œå®ƒä¸»è¦åšåŸŸæ¨¡å‹çš„åŒæ­¥ã€‚é€šè¿‡ Ajax/fetch ç­‰ API å®Œæˆå®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯ä¸šåŠ¡ Model çš„åŒæ­¥ View å±‚:ä½œä¸ºè§†å›¾æ¨¡æ¿å­˜åœ¨ï¼ˆtemplateï¼‰ï¼Œ æ•°æ®ç»‘å®šçš„å£°æ˜ã€ æŒ‡ä»¤çš„å£°æ˜ã€ äº‹ä»¶ç»‘å®šçš„å£°æ˜ã€‚ ViewModel å±‚ï¼ˆvueï¼‰:æŠŠ View éœ€è¦çš„æ•°æ®æš´éœ²ï¼Œå¹¶ä¸º View å±‚çš„ æ•°æ®ç»‘å®šå£°æ˜ã€ æŒ‡ä»¤å£°æ˜ã€ äº‹ä»¶ç»‘å®šå£°æ˜ è´Ÿè´£ VMï¼ˆVirtual DOMï¼‰é™¤äº†æé«˜æ€§èƒ½ï¼Œæœ€å¤§çš„ä¼˜åŠ¿è¿˜æ˜¯åœ¨äºï¼š å°† Virtual DOM ä½œä¸ºä¸€ä¸ªå…¼å®¹å±‚ï¼Œè®©æˆ‘ä»¬è¿˜èƒ½å¯¹æ¥é Web ç«¯çš„ç³»ç»Ÿï¼Œå®ç°è·¨ç«¯å¼€å‘ã€‚ åŒæ ·çš„ï¼Œé€šè¿‡ Virtual DOM æˆ‘ä»¬å¯ä»¥æ¸²æŸ“åˆ°å…¶ä»–çš„å¹³å°ï¼Œæ¯”å¦‚å®ç° SSRã€åŒæ„æ¸²æŸ“ç­‰ç­‰ã€‚ å®ç°ç»„ä»¶çš„é«˜åº¦æŠ½è±¡åŒ– MVVMæ˜¯MVCçš„æ”¹è¿›ç‰ˆï¼ŒMVCä¸­çš„Må°±æ˜¯å•çº¯çš„ä»ç½‘ç»œè·å–å›æ¥çš„æ•°æ®æ¨¡å‹ï¼ŒVæŒ‡çš„æˆ‘ä»¬çš„è§†å›¾ç•Œé¢ï¼Œè€ŒCå°±æ˜¯æˆ‘ä»¬çš„ViewControllerã€‚ MVCçš„é€šä¿¡æ–¹å¼æ—¶å•å‘çš„ï¼Œview -&gt; controller -&gt; model -&gt; view æ§åˆ¶å™¨ï¼ˆControllerï¼‰- æ§åˆ¶å™¨æ˜¯æ¨¡å‹å’Œè§†å›¾ä¹‹é—´çš„çº½å¸¦ï¼Œæ¥æ”¶Viewä¼ æ¥çš„ç”¨æˆ·äº‹ä»¶å¹¶ä¸”ä¼ é€’ç»™Modelï¼ŒåŒæ—¶åˆ©ç”¨ä»Modelä¼ æ¥çš„æœ€æ–°æ¨¡å‹æ§åˆ¶æ›´æ–°View. ViewModelå……å½“äº†ä¸€ä¸ªUIé€‚é…å™¨çš„è§’è‰²ï¼Œä¹Ÿå°±æ˜¯è¯´Viewä¸­æ¯ä¸ªUIå…ƒç´ éƒ½åº”è¯¥åœ¨ViewModelæ‰¾åˆ°ä¸ä¹‹å¯¹åº”çš„å±æ€§ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œä»ControlleræŠ½ç¦»å‡ºæ¥çš„ä¸UIæœ‰å…³çš„é€»è¾‘éƒ½æ”¾åœ¨äº†ViewModelä¸­ï¼Œè¿™æ ·å°±å‡è½»äº†Controllerçš„è´Ÿæ‹…ã€‚ MVCç¼ºç‚¹ï¼š ä¸é€‚åˆå°ã€ä¸­å‹é¡¹ç›® å¢åŠ ç»“æ„ã€å®ç°å¤æ‚æ€§ è§†å›¾ï¼ˆviewï¼‰å’Œæ§åˆ¶å™¨ï¼ˆcontrollerï¼‰è¿‡äºç´§å¯†çš„è¿æ¥ è§†å›¾ï¼ˆviewï¼‰å¯¹æ¨¡å¼æ•°æ®çš„ä½æ•ˆè®¿é—® ä¸€èˆ¬çš„é«˜çº§ç•Œé¢å·¥å…·æˆ–æ„é€ å™¨ä¸æ”¯æŒè¯¥æ¨¡å¼ faceçš„Fluxæ¶æ„å°±æœ‰ç‚¹åƒMVCï¼Œå¯ä»¥å‚è€ƒä¸€ä¸‹åƒé”‹æ•™è‚²è€å¸ˆçš„å›¾ï¼ˆreduxåªæ˜¯fluxçš„å…¶ä¸­ä¸€ç§å®ç°æ–¹å¼ï¼‰ 2.åŸºç¡€è¯­æ³•Vueå¯¹è±¡ä¼ å…¥çš„optionï¼š elï¼šå†³å®šVueå¯¹è±¡æŒ‚è½½åœ¨å“ªä¸ªå…ƒç´ ä¸Š dataï¼šå­˜å‚¨æ•°æ®ï¼Œç±»å‹ä¸ºå¯¹è±¡æˆ–è€…å‡½æ•° methods: ç”¨äºåœ¨Vueå¯¹è±¡ä¸­å®šä¹‰æ–¹æ³• åœ¨å®˜ç½‘ä¸­è¿˜æœ‰ä¸€äº›å…¶ä»–çš„option åœ¨å¼€å‘ä¸­åœ¨å¯¹è±¡/ç±»é‡Œé¢å®šä¹‰çš„å«æ–¹æ³•ï¼ˆmethodï¼‰ï¼Œç‹¬ç«‹å‡ºæ¥ä½œç”¨å…¨å±€çš„ç§°ä¸ºå‡½æ•°ï¼ˆfunctionï¼‰ åŒæ‹¬å·è¯­æ³•è¢«ç§°ä¹‹ä¸ºmustacheè¯­æ³•ï¼Œå…«å­—èƒ¡ &lt;!-- itemå’Œmessageåˆ†åˆ«ä¸ºdataä¸­çš„å­—ç¬¦ä¸² --> &lt;li>{{item + '' + message}}ï¼Œhello&lt;/li> &lt;!-- counterä¸ºdataä¸­çš„æ•°å­— --> &lt;li>{{counter * 2}}&lt;/li> &lt;!-- å¾—åˆ°getNumberå‡½æ•°è¿”å›å€¼ --> &lt;li>{{getNumber()}}&lt;/li> Vueçš„ç”Ÿå‘½å‘¨æœŸåœ¨åˆ›å»ºVueå¯¹è±¡çš„æ—¶å€™ï¼Œå†…éƒ¨ä¼šä¸€æ­¥ä¸€æ­¥åšå‡ºä¸€ç³»åˆ—å¤æ‚çš„äº‹æƒ…/æ“ä½œï¼Œè€Œåœ¨åšæ¯ä¸€ç³»åˆ—äº‹æƒ…çš„è¿‡ç¨‹å½“ä¸­ï¼Œå¦‚æœä¸­é—´ç©¿æ’ createdã€mountedã€updatedã€destroyedç­‰ç”Ÿå‘½å‘¨æœŸé’©å­å‡½æ•°å®ƒä¼šæŒ‡ç¤ºä½ ï¼ˆå®ƒä¼šå†…éƒ¨è‡ªåŠ¨æ‰§è¡Œï¼Œä¸éœ€è¦æ‰‹åŠ¨è°ƒç”¨ï¼‰ï¼Œç›®å‰åšåˆ°äº‹æƒ…çš„å“ªä¸€æ­¥ã€‚ ç”Ÿå‘½å‘¨æœŸï¼Œæ›´èªæ˜çš„æ’åº è€Œå½“è½¯ä»¶ä½“ç§¯ä¸æ–­å¢å¤§æ—¶ï¼Œä»£ç é€»è¾‘å¯èƒ½ä¼šåƒé«˜é€Ÿå…¬è·¯ä¸Šçš„è½¦è¾†ä¸€æ ·ï¼Œå¦‚æœæ¯«æ— ç§©åºï¼Œæ¯ä¸€è¾†è½¦éƒ½æƒ³ä»¥æœ€å¿«çš„é€Ÿåº¦é€šè¿‡ï¼Œåè€Œä¼šå¯¼è‡´æ‰€æœ‰è½¦è¾†åœæ»ä¸å‰ï¼Œé€ æˆæ‹¥å µã€‚ æ‹†åˆ†ç”Ÿå‘½å‘¨æœŸçš„ä¸€ä¸ªé‡è¦ç›®çš„å°±æ˜¯å°†è¿™äº›æ ¸å¿ƒåŠŸèƒ½çš„ä¼˜å…ˆçº§è¿›è¡Œæ’åºï¼Œé»„é‡‘åŸåˆ™å°±æ˜¯å°½å¯èƒ½å¿«çš„è®©ç”¨æˆ·æœ€å…³å¿ƒçš„ç•Œé¢å…ˆæ¸²æŸ“å‡ºæ¥ ç”Ÿå‘½å‘¨æœŸå°±æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼ˆå¦‚vue)ä»å£°æ˜åˆ°ä½¿ç”¨åˆ°é”€æ¯çš„å„ä¸ªé˜¶æ®µï¼Œä¸ºäº†å¼€å‘æ–¹ä¾¿æ¡†æ¶ä¼šåœ¨æ¯ä¸ªé˜¶æ®µçš„èŠ‚ç‚¹ä¸Šå®šä¹‰ä¸€ä¸ªç‰¹å®šå‡½æ•°ï¼Œè¿™ä¸ªç‰¹å®šå‡½æ•°å°±æ˜¯ç”Ÿå‘½å‘¨æœŸå‡½æ•°ï¼Œä¹Ÿå«é’©å­å‡½æ•° å®˜ç½‘é™„æœ‰ç”Ÿå‘½å‘¨æœŸç¤ºæ„å›¾ è¿˜æœ‰keep-aliveç‹¬æœ‰çš„ activated å’Œ deactivated created -&gt; mounted -&gt; activated çˆ¶å­ç»„ä»¶ç”Ÿå‘½å‘¨æœŸ çˆ¶ beforeCreate - &gt; çˆ¶ created -&gt;çˆ¶ beforeMount -&gt;å­ beforeCreate-&gt; å­ created-&gt; å­ beforeMount-&gt; å­ mounted-&gt; çˆ¶ mounted çˆ¶ç»„ä»¶æ›´æ–°ï¼šçˆ¶ beforeUpdate-&gt; çˆ¶ updated å­ç»„ä»¶æ›´æ–°ï¼šçˆ¶ beforeUpdate-&gt;å­beforeUpdate -&gt; å­ updated -&gt;çˆ¶updated ç»„ä»¶çš„è°ƒç”¨ å…ˆçˆ¶åå­ï¼Œæ¸²æŸ“å®Œæˆé¡ºåºå…ˆå­åçˆ¶ ç»„ä»¶é”€æ¯ å…ˆçˆ¶åå­ï¼Œé”€æ¯å®Œæˆ å…ˆå­åçˆ¶ å³ä¾¿å¦‚æ­¤ï¼Œå®˜ç½‘æç¤ºä½ ï¼šæ³¨æ„ mounted ä¸ä¼šä¿è¯æ‰€æœ‰çš„å­ç»„ä»¶ä¹Ÿéƒ½ä¸€èµ·è¢«æŒ‚è½½ã€‚å¦‚æœä½ å¸Œæœ›ç­‰åˆ°æ•´ä¸ªè§†å›¾éƒ½æ¸²æŸ“å®Œæ¯•ï¼Œå¯ä»¥åœ¨ mounted å†…éƒ¨ä½¿ç”¨ vm.$nextTick å…³äº destoryï¼šåœ¨å¤§å¤šæ•°åœºæ™¯ä¸­ä½ ä¸åº”è¯¥è°ƒç”¨è¿™ä¸ªæ–¹æ³•ã€‚æœ€å¥½ä½¿ç”¨ v-if å’Œ v-for æŒ‡ä»¤ä»¥æ•°æ®é©±åŠ¨çš„æ–¹å¼æ§åˆ¶å­ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸã€‚ V-æŒ‡ä»¤v-once åªä¼šåœ¨ç¬¬ä¸€æ¬¡æ¸²æŸ“æ•°æ®ï¼Œéšåæ•°æ®å‘ç”Ÿæ”¹å˜ï¼Œå…ƒç´ å†…çš„æ•°æ®ä¸ä¼šå†å‘ç”Ÿæ”¹å˜ï¼Œé˜»æ­¢äº†å“åº”å¼ï¼Œå¯ä»¥æ·»åŠ åœ¨æ ‡ç­¾å±æ€§ä¸Š &lt;h2 v-once>{{message}}&lt;/h2> v-html ç±»ä¼¼äºJSåŸç”Ÿé‡Œçš„innerHTMLï¼Œå¯ä»¥æ·»åŠ åœ¨æ ‡ç­¾å±æ€§ä¸Š &lt;h2 v-html=\"æ•°æ®åç§°\">&lt;/h2> v-pre è¿›è¡ŒåŸå°ä¸åŠ¨çš„è§£æï¼Œå¯ä»¥æ·»åŠ åœ¨æ ‡ç­¾å±æ€§ä¸Š &lt;!-- é¡µé¢å¾—åˆ°ç»“æœ{{message}} --> &lt;h2 v-pre>{{message}}&lt;/h2>` v-cloak ä¸ºäº†é˜²æ­¢ç”¨æˆ·åŠ è½½é¡µé¢æ—¶ï¼ŒåŠ è½½JavaScriptå¡ä½ï¼Œå¯¼è‡´é¡µé¢æ˜¾ç¤ºæºç  â€˜â€˜ ï¼Œæ·»åŠ  &lt;h2 v-cloak>{{message}}&lt;/h2> ç­‰åˆ°Vueå¯¹è¯¥å…ƒç´ è¿›è¡Œè§£ææ¸²æŸ“ï¼Œé¡µé¢ä¸­æ‰ä¼šæ˜¾ç¤ºè¯¥å…ƒç´ ï¼ˆåŸç†ä½¿ç”¨äº†display: noneï¼‰ v-bind ä½¿ç”¨{{å€¼}}å¯ä»¥å°†Vueçš„æ•°æ®æ’å…¥å…ƒç´ å†…å®¹ä¸­ï¼Œä½†æ˜¯å¦‚æœæƒ³è®©Vueçš„æ•°æ®åŠ¨æ€ç»‘å®šå…ƒç´ æ ‡ç­¾å±æ€§ä¸­çš„å€¼ï¼ˆæ¯”å¦‚imgçš„srcï¼Œaæ ‡ç­¾çš„hrefï¼‰,å¯ä»¥ä½¿ç”¨v-bindã€‚v-bindè¿˜æœ‰ä¸€ä¸ªå¯¹åº”çš„è¯­æ³•ç³– :ï¼ˆç®€å†™æ–¹å¼ï¼‰ï¼Œæ–¹å¼å¦‚ä¸‹ &lt;a v-bind:href=\"bdurl\">baidu&lt;/a> &lt;a :href=\"bdurl\">baidu&lt;/a> å¦‚æœä½¿ç”¨åˆ«äººå†™å¥½çš„ç»„ä»¶ï¼Œä¼ å…¥æ‰¹é‡çš„propsæ—¶ï¼ˆå­ç»„ä»¶ä¸­çš„propså¯¹è±¡çš„æ¯ä¸ªå±æ€§éƒ½å£°æ˜å¥½äº†ï¼‰ï¼Œç›´æ¥å†™ä¸€ä¸ªå¯¹è±¡ï¼Œç„¶å v-bind=&quot;å¯¹è±¡å&quot;å³å¯ ä¸æ­¤åŒæ—¶v-bindä¹Ÿå¯ä»¥åŠ¨æ€ç»‘å®šclasså±æ€§å€¼ï¼Œä½†æ˜¯å®ƒåŠ¨æ€ç»‘å®šclasså±æ€§çš„é‡å¤§æ„ä¹‰åœ¨äºå¯ä»¥å†™å…¥å¯¹è±¡ï¼Œä»¥é”®-å€¼çš„å½¢å¼ï¼Œé€šè¿‡å¸ƒå°”å€¼ä¿®æ”¹ï¼Œæ¥åŠ¨æ€ä¿®æ”¹å…ƒç´ æ˜¯å¦ä½¿ç”¨è¯¥ç±»ï¼ˆåœ¨æ ‡ç­¾ä¸Šè¿˜å¯ä»¥å†è‡ªå®šä¹‰æ·»åŠ ä¸Šè‡ªå¸¦çš„classï¼Œä¸å‚ä¸åŠ¨æ€ç»‘å®šå˜åŒ–ï¼‰ å…¶å®åŠ¨æ€ç»‘å®šclassè¿˜å¯ä»¥é‡‡ç”¨æ•°ç»„è¯­æ³•ï¼Œåªä¸è¿‡ç›®å‰ç”¨çš„æ¯”è¾ƒå°‘äº† &lt;div id=\"app\"> &lt;ul> &lt;li v-for=\"(item, index) in movies\" @click=\"colorch(index)\" :class=\"{active: index === iscolor}\">{{item}}&lt;/li> &lt;/ul> &lt;/div> &lt;script src=\"./js/vue.js\">&lt;/script> &lt;script> const app = new Vue({ el: '#app', data: { movies: ['batman', 'superman', 'spiderman'], iscolor: -1 }, methods: { colorch: function (index) { this.iscolor = index; } } }) v-bindè¿˜èƒ½åŠ¨æ€ç»‘å®šå…ƒç´ styleæ ·å¼çš„æŸä¸ªçš„å•ä¸ªå±æ€§ï¼Œä½†æ˜¯æ·»åŠ çš„æ—¶å€™æ³¨æ„ï¼Œvueçš„è¯­æ³•ä¸­æœ€å¥½é‡‡ç”¨é©¼å³°å‘½åæ³•ï¼Œè€Œä¸”å±æ€§å€¼å¤–åŠ å•å¼•å·&#39;&#39; &lt;h2 :style=\"{fontSize: '100px'}\">{{message}}&lt;/h2> æ³¨æ„ï¼Œç»‘å®šå±æ€§åçš„æ—¶å€™ï¼Œä¸èƒ½ç”¨é©¼å³°å‘½åæ³•ï¼Œå¯èƒ½htmlä¸èƒ½æ­£ç¡®è¯†åˆ«ï¼Œå¦‚æœè¦ç”¨çš„è¯ï¼Œåˆ™å±æ€§åè¦å‘ç”Ÿæ”¹åŠ¨ï¼š:topImages -&gt;æ”¹æˆ-&gt; :top-images=&quot;xxx&quot; åœ¨ä»¥å¯¹å‘å½¢å¼ç»‘å®šç±»åæ—¶ï¼Œä¸èƒ½ç”¨ -ï¼Œé©¼å³°å‘½åä¹Ÿä¸èƒ½å¥æ•ˆï¼Œå¯ä»¥ä½¿ç”¨ &lt;div :class=\" { 'tip': item.type === 3, 'my-msg': item.type === 1, 'other-msg': item.type === 2, }\" > é™¤æ­¤ä¹‹å¤–ï¼Œè¿å±æ€§åä¹Ÿå¯ä»¥åŠ¨æ€å†³å®šï¼Œåªéœ€è¦åŠ ä¸€ä¸ªä¸­æ‹¬å·å³å¯ &lt;div id=\"app\"> &lt;/div> &lt;template id=\"my-app\"> &lt;div :[name]=\"active\">hello&lt;/div> &lt;/template> &lt;script> const app = new Vue({ template: '#my-app', data() { return { name: 'hello', active: 'act' } } }).$mount(\"#app\") &lt;/script> è‹¥è¦ä¼ å…¥å¤šä¸ªåŠ¨æ€å±æ€§ï¼Œç›´æ¥ç»™ v-bindèµ‹å€¼å³å¯ &lt;template id=\"my-app\"> &lt;div v-bind=\"info\">hello&lt;/div> &lt;!-- &lt;div name=\"allen\" age=12>hello&lt;/div> --> &lt;/template> &lt;script> const app = new Vue({ template: '#my-app', data() { return { info: { name: 'allen', age: 12 } } } }).$mount(\"#app\") computedè®¡ç®—å±æ€§Vueå¯¹è±¡çš„optionä¹‹ä¸€,å½“æˆå±æ€§å»ä½¿ç”¨ï¼Œä¸ç”¨åŠ ()è¿›è¡Œå‡½æ•°è°ƒç”¨ï¼Œè®¡ç®—å±æ€§ä¸åƒmethodsä¼šè¢«å¤šæ¬¡è°ƒç”¨ï¼Œå®ƒåªä¼šè¢«è°ƒç”¨ä¸€æ¬¡ï¼ˆå› æ­¤æ•ˆç‡ç›¸å¯¹äºmethodsæ›´é«˜ï¼‰ï¼Œå†…éƒ¨å¯¹è®¡ç®—å±æ€§åšäº†ç¼“å­˜ï¼ˆæœ‰ç‚¹Reactçš„useMemoå†…å‘³äº†~ï¼‰ &lt;div id=\"app\"> &lt;h2>{{fullname}}&lt;/h2> &lt;/div> &lt;script src=\"./js/vue.js\">&lt;/script> &lt;script> const app = new Vue({ el: '#app', data: { firstname: 'Lebron', lastname: 'James' }, computed: { fullname: function () { //fullname() {} ä¹Ÿå¯ä»¥ return this.firstname + ' ' + this.lastname; } } }) &lt;/script> å®é™…ä¸Šè®¡ç®—å±æ€§ä¸€èˆ¬åªä½¿ç”¨äº†å®ƒæœ¬èº«çš„getæ–¹æ³•ï¼Œè€Œå®ƒçš„å®Œæ•´å†™æ³•ä¸ºï¼š fullname: { set: function () { //ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä¸å¸Œæœ›è®¡ç®—å±æ€§ä½¿ç”¨setæ–¹æ³•,è¿™æ ·çš„è¯å®ƒå°±å˜æˆäº†ä¸€ä¸ªåªè¯»å±æ€§ }, get:function() { return this.firstname + '' + this.lastname; } } Computed é»˜è®¤è°ƒç”¨çš„æ˜¯getæ–¹æ³• ä¸èƒ½ä¼ å‚ï¼Œæƒ³è¦ä¼ é€’å‚æ•°å¾—ç”¨setè®¾ç½®å¥½ï¼Œå†ç”¨getå– watchå±æ€§watchä¹Ÿæ˜¯å±äºç»„ä»¶ä¸­çš„å±æ€§ï¼ˆå’Œdataï¼Œpropsï¼Œmethodsç­‰å¹¶åˆ—ï¼‰ï¼Œå¯¹åº”ä¸€ä¸ªå¯¹è±¡ç±»å‹ï¼Œé‡Œé¢å­˜æ”¾å‡½æ•°æ–¹æ³•ï¼Œè¿™äº›å‡½æ•°é€‚ç”¨äºç›‘å¬æŸäº›dataä¸­å±æ€§çš„æ”¹å˜ã€‚å½“éœ€è¦åœ¨æ•°æ®å˜åŒ–æ—¶æ‰§è¡Œå¼‚æ­¥æˆ–å¼€é”€è¾ƒå¤§çš„æ“ä½œæ—¶ï¼Œè¿™ä¸ªæ–¹å¼æ˜¯æœ€æœ‰ç”¨çš„ã€‚ å‡½æ•°å‘½åæ–¹å¼ï¼šdataä¸­çš„å±æ€§å(æ”¹å˜åçš„å€¼[, æ”¹å˜å‰çš„å€¼]){} watch:{ // ç›‘å¬dataä¸­messageçš„æ”¹å˜ message(){ console.log(\"hello\"); } //ç›¸å½“äºmessage:function(){console.log(\"hello\")} //äº¦æˆ–è€…æ˜¯æ‹¿åˆ°æ–°æ—§çš„å€¼ //message(newVal, oldVal) {} } é™¤äº†ä¼ å…¥å‡½æ•°å¤–ï¼Œå…¶å®watché‡Œé¢ä¼ çš„æ˜¯é”®å€¼å¯¹ï¼Œå€¼é™¤äº†å‡½æ•°è¿˜å¯ä»¥åŒ…å«ä¸¤ä¸ªå‚æ•° immediateï¼šç»„ä»¶åŠ è½½ï¼ˆé¦–æ¬¡æ¸²æŸ“å®Œæˆï¼‰ç«‹å³è§¦å‘å›è°ƒå‡½æ•°æ‰§è¡Œï¼Œ deep: æ·±åº¦ç›‘å¬ï¼Œä¸ºäº†å‘ç°å¯¹è±¡å†…éƒ¨å€¼çš„å˜åŒ–ï¼Œå¤æ‚ç±»å‹çš„æ•°æ®æ—¶ä½¿ç”¨ï¼ˆå†…éƒ¨å®é™…ä¸Šæ˜¯é€šè¿‡é€’å½’å–å€¼ï¼Œç„¶åè¿›è¡Œé€ä¸ªç›‘å¬ï¼‰ï¼Œè€Œcomputedä¸éœ€è¦deepï¼Œæ˜¯å› ä¸ºå®ƒæ˜¯ä»æ¨¡æ¿åŒæ‹¬å·å–å€¼ï¼Œå³ä½¿ç”¨JSON.stringfy()æŠŠå¯¹è±¡çš„å€¼ä¸€æ¬¡æ€§å–å‡ºæ¥ å› ä¸ºæ˜¯é€’å½’ï¼Œæ¯”è¾ƒè€—æ€§èƒ½ï¼Œå°½é‡ä¸è¦é‡‡ç”¨ ä½†æ˜¯deepæœ‰ä¸ªbugï¼Œä¼ å…¥newValã€oldValå‚æ•°çš„æ—¶å€™ï¼Œå¦‚æœæ˜¯å†…éƒ¨çš„å±æ€§å€¼å‘ç”Ÿæ”¹å˜ï¼Œä½¿å¾—oldValå’ŒnewValä»ç„¶æ˜¯æŒ‡å‘åŒä¸€ä¸ªåœ°å€ï¼Œæ­¤æ—¶oldVal === newValã€‚ å½“ç„¶ï¼Œå®˜æ–¹ä¹Ÿåšè¿‡è¯´æ˜ æ³¨æ„ï¼šå½“å˜æ›´ï¼ˆä¸æ˜¯æ›¿æ¢ï¼‰å¯¹è±¡æˆ–æ•°ç»„å¹¶ä½¿ç”¨ deep é€‰é¡¹æ—¶ï¼Œæ—§å€¼å°†ä¸æ–°å€¼ç›¸åŒï¼Œå› ä¸ºå®ƒä»¬çš„å¼•ç”¨æŒ‡å‘åŒä¸€ä¸ªå¯¹è±¡/æ•°ç»„ã€‚Vue ä¸ä¼šä¿ç•™å˜æ›´ä¹‹å‰å€¼çš„å‰¯æœ¬ã€‚ watch: { message: { //ä½¿ç”¨deepã€immediateå‚æ•°æ—¶ï¼Œå¯¹åº”çš„å‡½æ•°åå¿…é¡»ä¸ºhandler handler(newVal, oldVal) { console.log(oldVal) console.log(newVal) }, deep: true immediate: true } } ç”šè‡³watchè¿˜æœ‰vm.$watchçš„ç”¨æ³• data(){ return { info: { name: \"allen\" } } } //åœ¨createç”Ÿå‘½å‘¨æœŸä¸­ created(){ const unwatch = this.$watch(\"info\", function(newVal, oldVal) { console.log(newVal, oldVal); }, { deep: true, immediate: true }) } computedå’Œwatch computedï¼š æ”¯æŒç¼“å­˜ï¼Œåªæœ‰ä¾èµ–æ•°æ®å‘ç”Ÿæ”¹å˜æ—¶æ‰ä¼šé‡æ–°è®¡ç®— ä¸æ”¯æŒå¼‚æ­¥ï¼Œå½“computedå†…æœ‰å¼‚æ­¥æ“ä½œæ—¶æ— æ•ˆï¼Œæ— æ³•ç›‘å¬æ•°æ®çš„å˜åŒ– å¦‚æœä¸€ä¸ªå±æ€§æ˜¯ç”±å…¶ä»–å±æ€§è®¡ç®—è€Œæ¥çš„ï¼Œä¸”ä¸€å¯¹ä¸€æˆ–è€…å¤šå¯¹ä¸€ï¼Œåˆ™ä¸€èˆ¬ç”¨computed watchï¼š ä¸æ”¯æŒç¼“å­˜ï¼Œæ•°æ®å˜åŒ–åˆ™ä¼šç›´æ¥è§¦å‘ç›¸åº”æ“ä½œ æ”¯æŒå¼‚æ­¥ ç›‘å¬çš„å‡½æ•°æ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯æœ€æ–°çš„å€¼ï¼ˆnewValueï¼‰ï¼›ç¬¬äºŒä¸ªå‚æ•°æ˜¯è¾“å…¥ä¹‹å‰çš„å€¼ï¼ˆoldValueï¼‰ å¯ä»¥ç›‘å¬å…·ä½“åˆ°æ•°æ®çš„æŸä¸ªå±æ€§ï¼ˆå¯¹è±¡ï¼‰ ç¼“å­˜å®ç°åŸç†ï¼šnew watcher -&gt; è¿™é‡Œæœ‰ä¸ªdirtyå±æ€§ï¼Œé»˜è®¤ä¸ºtrue - &gt; æ±‚å€¼è®¡ç®—ï¼Œç„¶ådirty = false -&gt; å½“ä¾èµ–æ•°æ®å†æ¬¡å‘ç”Ÿæ”¹å˜æ—¶ dirty = true äº‹ä»¶ç›‘å¬v-on ç»‘å®šäº‹ä»¶ç›‘å¬å™¨ï¼Œç¼©å†™ï¼ˆè¯­æ³•ç³–ï¼‰ä¸º @ ï¼Œç±»ä¼¼äºjQueryçš„ on äº‹ä»¶å¤„ç†ï¼Œç»‘å®šå¤šä¸ªäº‹ä»¶å¯ä»¥ä½¿ç”¨å¯¹è±¡çš„å½¢å¼ &lt;button @click=\"increment\">+&lt;/button> &lt;button v-on=\"{click: btnClick, mousemove: mouseMove}\">-&lt;/button> æ­£å¸¸æƒ…å†µä¸‹ï¼Œå‡½æ•°å¦‚æœéœ€è¦ä¼ é€’å‚æ•°ï¼Œç„¶è€Œä½ æ²¡æœ‰ä¼ é€’ï¼Œåˆ™å‡½æ•°å½¢å‚ä¸ºundefined v-onå‚æ•°é—®é¢˜ï¼š å¦‚æœè¯¥æ–¹æ³•ä¸éœ€è¦ä¼ é€’å‚æ•°ï¼Œåˆ™æ–¹æ³•åé¢çš„()å¯ä»¥ä¸ç”¨æ·»åŠ  ä½†æ˜¯å¦‚æœæ–¹æ³•æœ¬èº«æ˜¯éœ€è¦ä¸€ä¸ªå‚æ•°çš„ï¼Œä½†æ˜¯ä¼ è¿›æ¥çš„æ—¶å€™æ²¡æœ‰åŠ  ()ï¼Œï¼ˆå¦‚@click=â€decrementâ€ï¼‰ï¼Œåˆ™Vueä¼šå°†æµè§ˆå™¨ä¸­ç”Ÿæˆçš„äº‹ä»¶å¯¹è±¡Eventä½œä¸ºå‚æ•°ï¼Œä¼ å…¥æ–¹æ³•ä¸­ æ–¹æ³•å®šä¹‰æ—¶ï¼Œæˆ‘ä»¬éœ€è¦eventå¯¹è±¡ï¼ŒåŒæ—¶åˆéœ€è¦å…¶ä»–å‚æ•°æ—¶ï¼Œåœ¨htmlæ ‡ç­¾å†…çš„æ–¹æ³•æ‹¬å·ä¸­åªæ·»åŠ å‚æ•° + $event &lt;button @click=\"cclick(123, $event)\">call&lt;/button> methods: { cclick(number, event) { console.log(number, event); } } v-onä¿®é¥°ç¬¦ @äº‹ä»¶å.stopé˜»æ­¢äº‹ä»¶å†’æ³¡ï¼šç›¸å½“äºåŸç”Ÿçš„e.stopPropagation() &lt;div @click=\"cclick\"> &lt;button @click.stop=\"cclick\">call&lt;/button> &lt;/div> @äº‹ä»¶å.preventé˜»æ­¢é»˜è®¤äº‹ä»¶ =&gt; ç›¸å½“äºåŸç”Ÿçš„ e.preventDefault(); @äº‹ä»¶å.{keyCode | ketAlias} ä»é”®ç›˜ç‰¹å®šé”®ä½è§¦å‘å›è°ƒï¼ˆ @keyup.enter=&quot;xxx&quot; ï¼‰ @äº‹ä»¶å.native ç›‘å¬æ ¹å…ƒç´ åŸç”Ÿäº‹ä»¶ï¼ˆåœ¨ç»„ä»¶ä¸­ä½¿ç”¨ï¼‰ &lt;Compon_test @click=&quot;() =&gt; {}&quot;&gt;&lt;Compon_test&gt; =&gt; Compon_test.$on(&#39;click&#39;, () =&gt; {}) Compon_test.$emit(&#39;click&#39;) &lt;Compon_test @click.native=&quot;() =&gt; {}&quot;&gt;&lt;Compon_test&gt; =&gt; Compon_test.addEventListener @äº‹ä»¶å.once åªè§¦å‘ä¸€æ¬¡å›è°ƒ æ¡ä»¶åˆ¤æ–­ + å¾ªç¯éå†v-if=&quot;å¸ƒå°”å€¼(æˆ–vueå¯¹è±¡ä¸­å­˜å‚¨çš„å˜é‡)&quot;æ¥å†³å®šå…ƒç´ æ ‡ç­¾æ˜¯å¦æ˜¾ç¤ºå‡ºæ¥ v-if å¯ä»¥æ­é… v-else æ¥å†³å®šæ˜¾ç¤ºå“ªä¸€äº›å…ƒç´ æ ‡ç­¾ &lt;h2 v-if=\"score>=90\">ä¼˜ç§€&lt;/h2> &lt;h2 v-else-if=\"socre>=80\">è‰¯å¥½&lt;/h2> &lt;h2 v-else-if=\"socre>=60\">åŠæ ¼&lt;/h2> &lt;h2 v-else>ä¸åŠæ ¼&lt;/h2> v-showå†³å®šä¸€ä¸ªå…ƒç´ æ˜¯å¦æ¸²æŸ“å‡ºæ¥ï¼ˆç”¨æ³•å’Œ v-ifç›¸ä¼¼ï¼‰ï¼Œåªæ˜¯ v-showæ§åˆ¶ç»“ç‚¹çš„displayï¼Œè€Œv-ifæ˜¯åˆ é™¤/åˆ›å»ºèŠ‚ç‚¹ å½“æˆ‘ä»¬éœ€è¦ç»å¸¸åˆ‡æ¢æŸä¸ªå…ƒç´ çš„æ˜¾ç¤º/éšè—æ—¶ï¼Œä½¿ç”¨v-showä¼šæ›´åŠ èŠ‚çœæ€§èƒ½ä¸Šçš„å¼€é”€ï¼›å½“åªéœ€è¦ä¸€æ¬¡æ˜¾ç¤ºæˆ–éšè—æ—¶ï¼Œä½¿ç”¨v-ifæ›´åŠ åˆç†ã€‚ æœ‰æ—¶å€™æˆ‘ä»¬å¹¶ä¸æƒ³ä¸ºäº†ä½¿ç”¨ v-ifä¸å¾—ä¸åœ¨å¤–å±‚åŒ…è£¹ä¸€å±‚divï¼Œä½†æ˜¯æˆ‘ä»¬å¯èƒ½å¹¶ä¸åƒåœ¨ç»“æ„ä¸Šå‘ç”Ÿæ›´æ”¹ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ templateæ¥æ›¿ä»£ï¼Œæœ‰ç§ç±»ä¼¼äºReactä¸­ Fragment æˆ–è€… &lt;&gt;ç©ºæ ‡ç­¾çš„æ•ˆæœ v-forä¹Ÿæ”¯æŒ templateå¤–å±‚åµŒå¥— ä½†æ˜¯ v-show å¹¶ä¸æ”¯æŒ template v-foréå†æ•°ç»„/å¯¹è±¡ éå†è¿‡ç¨‹é¢å¤–è·å–æ•°ç»„ç´¢å¼•å€¼ä½¿ç”¨ v-for=&quot;(item, index) in æ•°ç»„å&quot; éå†è¿‡ç¨‹é¢å¤–è·å–å¯¹è±¡å±æ€§åä½¿ç”¨ v-for=&quot;(value, key) in info&quot; ï¼ˆå¦‚æœåªæœ‰value,ï¼Œåˆ™éå†å¯¹è±¡æ¯ä¸ªå±æ€§çš„å±æ€§å€¼ï¼‰ éå†è¿‡ç¨‹é¢å¤–è·å–å¯¹è±¡å±æ€§åï¼Œæ•°ç»„ç´¢å¼•å€¼ä½¿ç”¨ &quot;(value, key, index) in info&quot; ï¼ˆå¦‚æœåªæœ‰value,ï¼Œåˆ™éå†å¯¹è±¡æ¯ä¸ªå±æ€§çš„å±æ€§å€¼ï¼‰ &lt;ul> &lt;li v-for=\"item in strs\">{{item}}&lt;/li> &lt;li v-for=\"(item, index) in strs\">{{index}}.{{item}}&lt;/li> &lt;li v-for=\"value in info\">{{value}}&lt;/li> &lt;li v-for=\"(value, key) in info\">{{key}}:{{value}}&lt;/li> &lt;li v-for=\"(value, key, index) in info\">{{index}}.{{key}}:{{value}}&lt;/li> &lt;/ul> ä½ ä¹Ÿå¯ä»¥ç”¨ of æ›¿ä»£ in ä½œä¸ºåˆ†éš”ç¬¦ï¼Œå› ä¸ºå®ƒæ›´æ¥è¿‘ JavaScript è¿­ä»£å™¨çš„è¯­æ³•ï¼š &lt;div v-for=\"item of items\">&lt;/div> å®˜æ–¹æ¨èæˆ‘ä»¬ä½¿ç”¨ v-forçš„æ—¶å€™ï¼Œç»™å…ƒç´ æˆ–ç»„ä»¶æ·»åŠ ä¸Š keyå±æ€§ï¼ˆèƒ½æ›´å¥½çš„å¤ç”¨ï¼Œæé«˜å¢åˆ æ—¶çš„æ€§èƒ½ï¼Œé«˜æ•ˆæ›´æ–°è™šæ‹ŸDOMï¼‰ï¼Œå¹¶ä¸”æ­¤æ—¶keyå±æ€§ç»‘å®šä¸ºitemæˆ–è€… item.id æ¯”è¾ƒå¥½ï¼Œèƒ½å½¢æˆä¸€ä¸€å¯¹åº”ï¼ˆä¹Ÿå¯ä»¥æ˜¯itemå¯¹è±¡ä¸­çš„idï¼‰ã€‚è¿™æ—¶å€™å°±å¯ä»¥å”¯ä¸€æ ‡è¯†å…ƒç´ æˆ–ç»„ä»¶ï¼Œç”¨diffç®—æ³•æ­£ç¡®è¯†åˆ«èŠ‚ç‚¹ï¼Œæ‰¾åˆ°æ­£ç¡®ä½ç½®æ’å…¥/åˆ é™¤èŠ‚ç‚¹ã€‚ å¦‚æœkeyç”¨indexï¼Œæ˜¯ä¸å¯ä»¥çš„ï¼Œå› ä¸ºindexï¼Œå³ä¸‹æ ‡ï¼Œä¼šéšç€DOMå…ƒç´ çš„ä½ç½®è€Œæ”¹å˜ï¼Œå¯¼è‡´key = â€œindexâ€ï¼ŒåŠ äº†å’Œæ²¡åŠ ä¸€æ ·ï¼ï¼ å¦‚æœitemä¸æ˜¯å­—ç¬¦ä¸²ã€æ•°å­—ä¹‹ç±»çš„ï¼Œä¹Ÿä¸æ¨èä½¿ç”¨ åŸå› ï¼šæ²¡æœ‰keyä¼šåƒæ“ä½œé¡ºåºè¡¨ï¼ˆæˆ–è€…æ•°ç»„ï¼‰ä¸€æ ·æ“ä½œæ”¹å˜ä½ç½®åŠä¹‹åæ‰€æœ‰æ•°æ®ï¼Œæœ‰keyå°±ä¼šåƒé“¾è¡¨ä¸€æ ·æ–­é“¾åé“¾æ¥ï¼Œåªè¿›è¡Œä¸€æ¬¡æ“ä½œ &lt;li v-for=\"item in strs\" :key=\"item\">{{item}}&lt;/li> v-for and v-if ç”±äºv-forçš„ä¼˜å…ˆçº§æ˜¯å¤§äºv-ifçš„ï¼Œå½“ v-foréå†å‡ºæ¥åå†æ¯æ¬¡éƒ½v-ifè¿›è¡Œåˆ¤æ–­æ¯”è¾ƒæ¶ˆè€—æ€§èƒ½ï¼Œ æ‰€ä»¥å»ºè®®æŠŠv-ifæ”¾åœ¨å¤–å±‚ï¼ˆæ¯”å¦‚ç›´æ¥æ”¾åœ¨templateæ¨¡æ¿ä¸Šï¼‰ å“ªäº›æ•°ç»„çš„æ–¹æ³•æ˜¯å“åº”å¼çš„ï¼š å’Œå¯¹è±¡ä¸åŒçš„æ˜¯ï¼Œæœ‰äº›æ•°ç»„æ–¹æ³•ä½¿ç”¨åVueçš„é¡µé¢ä¸ä¼šåŠæ—¶å“åº” å®é™…ä¸Šè¿™ä¸ªå“åº”å¼æœ€å¥½è®°çš„å°±æ˜¯æ•°ç»„æ–¹æ³• çœ‹ä»–æ˜¯å¦çœŸçš„æ”¹å˜åŸæ•°ç»„ï¼Œè€Œä¸æ˜¯è¿”å›ä¸€ä¸ªæ–°æ•°ç»„ï¼ˆæˆ–è€…é€šè¿‡å®˜æ–¹æ–‡æ¡£æŸ¥çœ‹å®ƒæ˜¯å¦ä¸ºè¢«åŒ…è£¹è¿‡çš„æ–¹æ³•ï¼‰ // 1.push this.arr.push('David'); // 2.pop åˆ é™¤æ•°ç»„ä¸­æœ€åä¸€ä¸ªå…ƒç´  this.arr.pop(); //3.shift åˆ é™¤æ•°ç»„ç¬¬ä¸€ä¸ªå…ƒç´  this.arr.shift(); //4.unshift æ•°ç»„æœ€å‰é¢æ·»åŠ å…ƒç´  this.arr.unshift('David', 'Eason'); // 5.splice ç”¨äºåˆ é™¤å¤šç»„å…ƒç´ ä¸”æ·»åŠ æ•°æ® // splice(å¼€å§‹ä½ç½®, åˆ é™¤ä¸ªæ•°, ...è¦æ·»åŠ çš„å…ƒç´ ) this.arr.splice(1, 0, 'David'); // 6.sort this.arr.sort(); // 7.reverse this.arr.reverse(); é€šè¿‡ç´¢å¼•å€¼ä¿®æ”¹æ•°ç»„å…ƒç´ å¹¶ä¸ä¼šå‘é¡µé¢åŠæ—¶å“åº”ç»“æœï¼š //ä¿®æ”¹å¯¹è±¡ç”¨spliceæˆ–è€… Vue.set(ä¿®æ”¹å¯¹è±¡, ç´¢å¼•å€¼, ä¿®æ”¹åçš„å€¼) this.arr[0] = 'nothing'; Methodsæ³¨æ„äº‹é¡¹ æ³¨æ„ ä¸åº”è¯¥ä½¿ç”¨ç®­å¤´å‡½æ•°æ¥å®šä¹‰methodå‡½æ•°ï¼ˆä¾‹å¦‚plus: () =&gt; this.a++ï¼‰ã€‚ç†ç”±æ˜¯ç®­å¤´å‡½æ•° ç»‘å®šäº†çˆ¶çº§ä½œç”¨åŸŸçš„ä¸Šä¸‹æ–‡ï¼Œæ‰€ä»¥thiså°†ä¸ä¼šæŒ‰ç…§æœŸæœ›æŒ‡å‘ç»„ä»¶å®ä¾‹ï¼Œthiså°†ä¼šæ˜¯çˆ¶çº§çš„ä½œç”¨åŸŸï¼ˆå¯èƒ½æ˜¯windowï¼‰ï¼Œthis.aå°†ä¼šæ˜¯undefined è¿™é‡Œå’ŒReactæ˜¯ç›¸åçš„ï¼ŒReactå°±æ˜¯è¦ä½¿ç”¨ç®­å¤´å‡½æ•°æ¥ç»‘å®šç»„ä»¶å®ä¾‹ï¼› è€ŒVueç”¨æ™®é€šå‡½æ•°ï¼Œè€ŒVueå¹¶æ²¡æœ‰åƒReactä¸€æ ·åˆ›å»ºè‡ªå·±çš„å†…éƒ¨ä½œç”¨åŸŸï¼ˆç±»orå‡½æ•°ï¼‰ï¼Œæ‰€ä»¥æ­¤æ—¶ç®­å¤´å‡½æ•°å´å‘ä¸ŠæŸ¥æ‰¾ï¼Œç»‘å®šäº†çˆ¶çº§ä½œç”¨åŸŸï¼ˆåœ¨Vue3.xå†…éƒ¨å®è´¨ä¸Šæ˜¯ä½¿ç”¨ bindç»‘å®š instance.proxy ï¼‰ï¼å¯ä»¥ç†è§£ä¸ºä»¥ä¸‹çš„ä¾‹å­ var a = 1; var foo = { a: 2, bar: function () { return this.a; } bad: () => { return this.a //ç®­å¤´å‡½æ•°å¯¼è‡´thisæ°¸è¿œç»‘å®šäº†çˆ¶çº§ä½œç”¨åŸŸwindow } }; è¿‡æ»¤å™¨filtersVueå¯¹è±¡çš„optionä¹‹ä¸€,å½“æˆå±æ€§å»ä½¿ç”¨ï¼Œè°ƒç”¨éœ€è¦åœ¨å…ƒç´ æ ‡ç­¾ä¸­æ·»åŠ  {{ä¼ å…¥çš„å‚æ•° | è¿‡æ»¤å™¨å‡½æ•°å}}å¯ä»¥æŠŠè¿‡æ»¤å™¨ç®€å•ç†è§£ä¸ºä¸€ç§æ ¼å¼åŒ–ï¼Œæ¯”å¦‚æ—¶é—´ï¼Œæ•°å­—ç­‰ç­‰ï¼›å®ƒçš„å®é™…æ•ˆæœå’Œmethodsè°ƒç”¨å‡½æ•°æ–¹æ³•ä¹Ÿå·®ä¸å¤šï¼Œåªæ˜¯ç¼–å†™æ ·å¼æ›´æ˜“æ‡‚ã€ç®€æ´ &lt;td>{{book.price | Price_str}}&lt;/td> è¿‡æ»¤å™¨é‡Œé¢ä¸€èˆ¬å­˜å‡½æ•°ï¼Œå‚æ•°ä¸ºè¿‡æ»¤çš„æ•°æ® //toFixedä¸ºä¿ç•™ä¸¤ä½å°æ•° filters: { Price_str(price) { return '$' + price.toFixed(2); } } V-modelv-modelä¹Ÿå¸¸å¸¸è¢«ç”¨æ¥å®ç°è¡¨å•ï¼ˆinputã€checkboxã€selectã€textareaï¼‰å’Œæ•°æ®çš„åŒå‘ç»‘å®š v-modelå¦‚æœç”¨åœ¨æ™®é€šdivä¸Šï¼Œåªèƒ½ç”¨æ¥ä½œæ•°æ®ç»‘å®šåŠŸèƒ½ï¼ˆæ— äº‹ä»¶åŠŸèƒ½ã€å®é™…ä¸Šdivä¸æ”¯æŒ v-modelï¼Œä½†æ˜¯ç»„ä»¶å°±å¯ä»¥ ï¼‰ &lt;input type=\"text\" v-model=\"message\"> {{message}} //åœ¨Vueå¯¹è±¡ä¸­çš„data data: { message: 'nothing' } åˆ©ç”¨ v-modelå®ç°å•é€‰æ¡†äº’ç»‘ &lt;!-- æ·»åŠ v-modelä¹‹åï¼Œradioçš„inputä¸éœ€è¦åŠ nameå±æ€§æ¥äº’æ–¥radioï¼ˆå•é€‰æ¡†ï¼‰ --> &lt;label for=\"male\"> &lt;input type=\"radio\" id=\"male\" value=\"male\" v-model=\"sex\">ç”·â™‚ &lt;/label> &lt;label for=\"female\"> &lt;input type=\"radio\" id=\"female\" value=\"female\" v-model=\"sex\">å¥³â™€ &lt;/label> &lt;h2>ä½ é€‰æ‹©çš„æ€§åˆ«æ˜¯ï¼š{{sex}}&lt;/h2> v-modelå…¶å®æ˜¯æ˜¯ä¸€ä¸ªè¯­æ³•ç³–ï¼Œä¸¤ä¸ªæŒ‡ä»¤çš„ç»“åˆ v-bindç»‘å®šdataæ•°æ® + v-onç»‘å®šinputäº‹ä»¶æ”¹å˜dataæ•°æ® &lt;input type=\"text\" :value=\"message\" @input=\"message = $event.target.value\"> &lt;h2> {{message}}&lt;/h2> å¦‚æœæ˜¯è¦å†å¤šé€‰æ¡†checkboxã€é€‰é¡¹selectã€å•é€‰radioçš„æ—¶å€™ä½¿ç”¨ v-modeléœ€è¦åœ¨inputä¸Šèµ‹äºˆvalueå€¼ï¼ˆhobbiesæ˜¯ä¸€ä¸ªæ•°ç»„ï¼‰ &lt;div>ä½ çš„çˆ±å¥½ï¼š&lt;/div> &lt;label for=\"basketball\"> basketball &lt;input type=\"checkbox\" id=\"basketball\" v-model=\"hobbies\" value=\"basketball\"> &lt;/label> &lt;label for=\"tennis\"> tennis &lt;input type=\"checkbox\" id=\"tennis\" v-model=\"hobbies\" value=\"tennis\"> &lt;/label> &lt;label for=\"soccer\"> soccer &lt;input type=\"checkbox\" id=\"soccer\" v-model=\"hobbies\" value=\"soccer\"> &lt;/label> &lt;h2>{{hobbies}}&lt;/h2> v-modelè¿˜æœ‰ä¿®é¥°ç¬¦ lazyã€numberã€trim &lt;!-- ä¿®é¥°ç¬¦lazy ä½¿ç”¨ä¹‹åä½¿å¾—inputäº‹ä»¶å˜å¾—ç±»ä¼¼äºchangeäº‹ä»¶ï¼Œç­‰åˆ°ç”¨æˆ·è¾“å…¥å®Œå­—ç¬¦ï¼Œæ•²å›è½¦/å¤±å»ç„¦ç‚¹æ‰ä¼šä¿®æ”¹æ•°æ® --> &lt;!-- &lt;input type=\"text\" @change=\"message = $event.target.value\"> --> &lt;input type=\"text\" v-model.lazy=\"message\"> &lt;!-- ä¿®é¥°ç¬¦number v-modelé»˜è®¤ç»™dataèµ‹å€¼æ—¶ï¼Œéƒ½æ˜¯èµ‹å€¼ä¸ºstringç±»å‹ï¼Œå¢åŠ numberä¿®é¥°ç¬¦å¯æ”¹å˜v-modelèµ‹å€¼ç±»å‹--> &lt;input type=\"text\" v-model.number=\"age\"> &lt;!-- ä¿®é¥°ç¬¦trimï¼Œv-modelé»˜è®¤ç»™dataèµ‹å€¼æ—¶å‰¥é™¤ä¸¤è¾¹ç©ºæ ¼ --> &lt;input type=\"text\" v-model.trim=\"name\"> ç”±äºé»˜è®¤ v-modelæ˜¯ dataæ•°æ® + inputäº‹ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æºç ä¸Šè‡ªå®šä¹‰ v-model è‡ªå®šä¹‰ç»„ä»¶ä¸Šä½¿ç”¨ è‡ªå®šä¹‰ v-model ï¼š &lt;el-checkbox v-model=\"check\">&lt;/el-checkbox> //å…¨å±€æ³¨å†Œç»„ä»¶ Vue.component('el-checkbox', { template:`&lt;input type=\"checkbox\" :checked=\"check\" @change=\"$emit('change', $event.target.checked)>\"` //modelå±æ€§,æœåŠ¡äºv-model model:{ prop:'check', //æ›´æ”¹é»˜è®¤valueåå­— event:'change' //æ›´æ”¹é»˜è®¤æ–¹æ³•å,inputäº‹ä»¶æ”¹ä¸ºchangeäº‹ä»¶ }, props:{ check:Boolean } }) åŸç”Ÿæ ‡ç­¾ä¸Šä½¿ç”¨è‡ªå®šä¹‰ v-model const VueTemplateCompiler = require('vue-template-compiler'); const ele = VueTemplateCompiler.compiler('&lt;input v-model=\"value\"/>'); /** with(this) { return _c('input', { //_c createElement directives:[{ //directivesæ˜¯å¯¹è¾“å…¥æ¡†çš„é…ç½® name:\"model\", rawName:\"v-model\" vale:(value), expression:\"value\" }], domProps:{ \"value\":(value) //è¿™é‡Œvalueæ˜¯é»˜è®¤ï¼Œå¯ä»¥è‡ªå®šä¹‰ä¸ºcheck }, on:{ \"input\":function($event) { //è¿™é‡Œçš„é»˜è®¤inputå¯ä»¥è‡ªå®šä¹‰ä¸ºchange if($event.target.composing) return; value = $event.target.value } } }) } **/ elå’ŒtemplateåŒæ—¶æœ‰elå’Œtemplateï¼Œåˆ™å°†templateé‡Œçš„æ¨¡æ¿ï¼Œç›´æ¥æŠŠelç»‘å®šçš„å…ƒç´ æ›¿æ¢æ‰ nameå±æ€§ç»™æ¯ä¸ªç»„ä»¶æœ€å¥½åŠ ä¸Šä¸€ä¸ªnameå±æ€§ï¼Œå¾ˆå¤šåŠŸèƒ½çš„åŒ¹é…éƒ½æ˜¯ä¾èµ–è¿™ä¸ªnameï¼Œæ¯”å¦‚å†…ç½®ç»„ä»¶keep-aliveçš„includeå±æ€§åŒ¹é…å°±æ˜¯é¦–å…ˆæ£€æŸ¥ç»„ä»¶çš„nameé€‰é¡¹ name: ç»„ä»¶å å®˜æ–¹ä»‹ç» ç±»å‹ï¼šstring è¯¦æƒ…ï¼š å…è®¸ç»„ä»¶æ¨¡æ¿é€’å½’åœ°è°ƒç”¨è‡ªèº«ã€‚æ³¨æ„ï¼Œç»„ä»¶åœ¨å…¨å±€ç”¨ app.component æ³¨å†Œæ—¶ï¼Œå…¨å±€ ID è‡ªåŠ¨ä½œä¸ºç»„ä»¶çš„ nameã€‚ æŒ‡å®š name é€‰é¡¹çš„å¦ä¸€ä¸ªå¥½å¤„æ˜¯ä¾¿äºè°ƒè¯•ã€‚æœ‰åå­—çš„ç»„ä»¶æœ‰æ›´å‹å¥½çš„è­¦å‘Šä¿¡æ¯ã€‚å¦å¤–ï¼Œå½“åœ¨æœ‰ vue-devtoolsï¼Œæœªå‘½åç»„ä»¶å°†æ˜¾ç¤ºæˆ &lt;AnonymousComponent&gt;ï¼Œè¿™å¾ˆæ²¡æœ‰è¯­ä¹‰ã€‚é€šè¿‡æä¾› name é€‰é¡¹ï¼Œå¯ä»¥è·å¾—æ›´æœ‰è¯­ä¹‰ä¿¡æ¯çš„ç»„ä»¶æ ‘ã€‚ 3.ç»„ä»¶åŒ–å¼€å‘ç»„ä»¶åŒ–å¼€å‘æ€æƒ³å³æŠŠé¡µé¢æ‹†åˆ†æˆä¸€ä¸ªä¸ªå°çš„åŠŸèƒ½å—ï¼Œæ¯ä¸ªåŠŸèƒ½å®Œæˆå±äºè‡ªå·±é‚£éƒ¨åˆ†çš„ç‹¬ç«‹åŠŸèƒ½ï¼Œåˆ†è€Œæ²»ä¹‹ ç»„ä»¶ä½¿ç”¨ä¸‰ä¸ªæ­¥éª¤ åˆ›å»ºç»„ä»¶æ„é€ å™¨ Vue.extend()ï¼Œé€šå¸¸æˆ‘ä»¬åœ¨åˆ›å»ºç»„ä»¶æ„é€ å™¨æ—¶ä¼šä¼ å…¥templateä½œä¸ºè‡ªå®šä¹‰æ¨¡æ¿ æ³¨å†Œç»„ä»¶ Vue.component(è‡ªå®šä¹‰ç»„ä»¶æ ‡ç­¾å, ç»„ä»¶æ„é€ å™¨å¯¹è±¡) æ³¨æ„ï¼šå®šä¹‰çš„æ ‡ç­¾å¿…é¡»å°å†™ ä½¿ç”¨ç»„ä»¶ å¿…é¡»åœ¨Vueçš„å®ä¾‹èŒƒå›´å†…ä½¿ç”¨ç»„ä»¶ï¼Œå³ä½¿ç”¨è¯¥ç»„ä»¶æ—¶ï¼Œå¿…é¡»æŠŠæ ‡ç­¾æ”¾åœ¨Vueç»‘å®šçš„æ ‡ç­¾å†… æœ€ç»ˆå†…éƒ¨è°ƒç”¨ $mount()è¿›è¡ŒæŒ‚è½½ å®é™…ä¸Šå¯ä»¥æŠŠç»„ä»¶æ„é€ å™¨å¯¹è±¡çœ‹æˆä¸€ä¸ªç±»ï¼Œä½¿ç”¨çš„è¿‡ç¨‹çœ‹æˆåˆ›å»ºä¸€ä¸ªå®ä¾‹ï¼Œåœ¨å“ªä¸ªç»„ä»¶ä¸­ä½¿ç”¨äº†å³åœ¨å“ªä¸ªç»„ä»¶ä¸­åˆ›å»ºäº†ä¸€ä¸ªå®ä¾‹ &lt;div id=\"app\"> &lt;!-- 3.ä½¿ç”¨ç»„ä»¶ --> &lt;!-- æ¯”å¦‚è¿™é‡Œç»‘å®šäº†idä¸ºappçš„å—å…ƒç´ ï¼Œåˆ™è¯¥è‡ªå®šä¹‰æ ‡ç­¾å¯ä»¥åœ¨è¯¥å—å†…ä½¿ç”¨ --> &lt;my-cpn> &lt;/my-cpn> &lt;/div> &lt;script> // 1.åˆ›å»ºç»„ä»¶æ„é€ å™¨å¯¹è±¡ const cpnConstructor = Vue.extend({ // æ¨¡æ¿ template: `&lt;div> &lt;h2>æ¨¡æ¿1å†…å®¹&lt;/h2> &lt;/div>` }); // 2.æ³¨å†Œç»„ä»¶ // ä¸¥é‡æ³¨æ„ï¼šå®šä¹‰çš„æ ‡ç­¾å¿…é¡»å°å†™ Vue.component('my-cpn', cpnConstructor); const app = new Vue({el: '#app'}); &lt;/script> æ³¨æ„ï¼šåœ¨çˆ¶ç»„ä»¶ä¸­ä½¿ç”¨å­ç»„ä»¶ä¸èƒ½ä½¿ç”¨ v-on ç›‘å¬åŸç”Ÿäº‹ä»¶ï¼Œå¿…é¡»æ·»åŠ  nativeä¿®é¥°ç¬¦ï¼Œæ‰èƒ½è¿›è¡Œç›‘å¬ &lt;div> &lt;back-top @click.native=\"backClick\">&lt;/back-top> &lt;/div> è·å–ç»„ä»¶å†…çš„å…ƒç´ ï¼Œéœ€è¦ç”¨åˆ° $elï¼Œæ‰€æœ‰ç»„ä»¶éƒ½æœ‰ä¸€ä¸ªå…ƒç´  $el ç”¨äºè·å–ç»„ä»¶ä¸­çš„å…ƒç´ ï¼Œæ¯”å¦‚è·å– ç»„ä»¶ çš„ offsetTop console.log(this.$refs.tabControl.$el.offsetTop;) ç»„ä»¶å‘½åå®˜æ–¹ï¼š åœ¨å­—ç¬¦ä¸²æ¨¡æ¿æˆ–å•ä¸ªæ–‡ä»¶ç»„ä»¶ä¸­å®šä¹‰ç»„ä»¶æ—¶ï¼Œå®šä¹‰ç»„ä»¶åçš„æ–¹å¼æœ‰ä¸¤ç§ï¼š ä½¿ç”¨ kebab-case app.component('my-component-name', { /* ... */ }) å½“ä½¿ç”¨ kebab-case (çŸ­æ¨ªçº¿åˆ†éš”å‘½å) å®šä¹‰ä¸€ä¸ªç»„ä»¶æ—¶ï¼Œä½ ä¹Ÿå¿…é¡»åœ¨å¼•ç”¨è¿™ä¸ªè‡ªå®šä¹‰å…ƒç´ æ—¶ä½¿ç”¨ kebab-caseï¼Œä¾‹å¦‚ &lt;my-component-name&gt;ã€‚ ä½¿ç”¨-pascalcaseä½¿ç”¨ PascalCase app.component('MyComponentName', { /* ... */ }) å½“ä½¿ç”¨ PascalCase (é¦–å­—æ¯å¤§å†™å‘½å) å®šä¹‰ä¸€ä¸ªç»„ä»¶æ—¶ï¼Œä½ åœ¨å¼•ç”¨è¿™ä¸ªè‡ªå®šä¹‰å…ƒç´ æ—¶ä¸¤ç§å‘½åæ³•éƒ½å¯ä»¥ä½¿ç”¨ã€‚ä¹Ÿå°±æ˜¯è¯´ &lt;my-component-name&gt; å’Œ &lt;MyComponentName&gt; éƒ½æ˜¯å¯æ¥å—çš„ã€‚æ³¨æ„ï¼Œå°½ç®¡å¦‚æ­¤ï¼Œç›´æ¥åœ¨ DOM (å³éå­—ç¬¦ä¸²çš„æ¨¡æ¿) ä¸­ä½¿ç”¨æ—¶åªæœ‰ kebab-case æ˜¯æœ‰æ•ˆçš„ã€‚ ä½†å®é™…ä¸Šå¤§å†™å‘½åå†Vueä¸­ä¸æ¨èï¼ˆç¬¦åˆW3Cçš„è§„èŒƒï¼‰ï¼Œåè€ŒReactä¸­ä½¿ç”¨çš„å°±æ˜¯è¿™ç§å¤§å†™å‘½å ç»„ä»¶åˆ†ç±»å…¨å±€æ³¨å†Œ&amp;å±€éƒ¨æ³¨å†Œï¼šä¸Šé¢çš„ä¾‹å­ä¸ºæ³¨å†Œå…¨å±€ç»„ä»¶ï¼Œæ„å‘³ç€å¯ä»¥å†å¤šä¸ªVueå®ä¾‹ä¸‹ä½¿ç”¨ ä»¥ä¸‹çš„ä¾‹å­ä¸ºå±€éƒ¨æ³¨å†Œç»„ä»¶ï¼ˆå±€éƒ¨æ³¨å†Œç»„ä»¶è‡ªå®šä¹‰æ ‡ç­¾åä¸æ”¯æŒ -ï¼‰ Vueå¯¹è±¡ä¸­çš„componentså±æ€§æ¥æ³¨å†Œå±€éƒ¨ç»„ä»¶,åœ¨å¼€å‘è¿‡ç¨‹ç”¨çš„æœ€å¤šçš„è¿˜æ˜¯å±€éƒ¨ç»„ä»¶ const app = new Vue({ el: '#app', components: { //è‡ªå®šä¹‰ç»„ä»¶æ ‡ç­¾å:ç»„ä»¶æ„é€ å™¨å¯¹è±¡ my_cpn: cpnConstructor } }); çˆ¶ç»„ä»¶å’Œå­ç»„ä»¶ åœ¨ç»„ä»¶æ„é€ å™¨(ç»„ä»¶äºŒ)ä¸­å¯¹å¦å¤–ä¸€ä¸ªç»„ä»¶(ç»„ä»¶ä¸€)è¿›è¡Œæ³¨å†Œï¼ˆcomponents{}ï¼‰ï¼Œè¿™æ ·çš„å¥½å¤„æ˜¯å¯ä»¥åœ¨ç»„ä»¶äºŒæ¨¡æ¿é‡Œé¢,ä½¿ç”¨ç»„ä»¶ä¸€,è¿™æ ·å­å°±å½¢æˆäº†çˆ¶å­ç»„ä»¶çš„å…³ç³» çˆ¶ç»„ä»¶æ¨¡æ¿çš„æ‰€æœ‰ä¸œè¥¿éƒ½ä¼šåœ¨çˆ¶çº§ä½œç”¨åŸŸè¿›è¡Œç¼–è¯‘ï¼Œå­ç»„ä»¶æ¨¡æ¿çš„æ‰€æœ‰ä¸œè¥¿éƒ½ä¼šåœ¨å­çº§ä½œç”¨åŸŸè¿›è¡Œç¼–è¯‘ æ³¨æ„: åœ¨æ¨¡æ¿ä¸­ï¼Œå­ç»„ä»¶çš„æ ‡ç­¾ä¸€å®šè¦å†™åœ¨çˆ¶ç»„ä»¶çš„DIVé‡Œé¢ï¼Œå› ä¸ºå®šä¹‰æ¨¡æ¿æ—¶ä¸€èˆ¬è¦æœ‰ä¸€ä¸ªå¤–å±‚åŒ…è£¹çš„æ ¹å…ƒç´ ï¼ˆä¸€èˆ¬ä½¿ç”¨divï¼‰ &lt;div id=\"app\"> &lt;cpn2>&lt;/cpn2> &lt;/div> &lt;script> //å­ç»„ä»¶,å­ç»„ä»¶è¦æ¯”çˆ¶ç»„ä»¶å…ˆåˆ›ç«‹ const cpnConstructor = Vue.extend({ template: ` &lt;div> &lt;h2>æ¨¡æ¿1å†…å®¹&lt;/h2> &lt;/div> ` }); //çˆ¶ç»„ä»¶ const cpnConstructor2 = Vue.extend({ template: ` &lt;div> &lt;h2>æ¨¡æ¿2å†…å®¹&lt;/h2> &lt;cpn1>&lt;/cpn1> &lt;/div> `, components: { cpn1: cpnConstructor } }); // rootç»„ä»¶ const app = new Vue({ el: '#app', components: { cpn2: cpnConstructor2 } }); &lt;/script> ç»„ä»¶è¯­æ³•ç³–Vueä¸ºäº†ç®€åŒ–ç»„ä»¶ä½¿ç”¨çš„è¿‡ç¨‹ï¼Œæä¾›äº†åˆ›å»º + æ³¨å†Œåˆå¹¶çš„è¯­æ³•ç³–ï¼Œç›´æ¥é€‚ç”¨å¯¹è±¡æ›¿ä»£extendæ­¥éª¤ //åˆ›å»º+æ³¨å†Œå…¨å±€ç»„ä»¶è¯­æ³•ç³– Vue.component('mycpn', { template: ` &lt;div> &lt;h2>æ¨¡æ¿1å†…å®¹&lt;/h2> &lt;/div> ` }) //åˆ›å»º+æ³¨å†Œå±€éƒ¨ç»„ä»¶è¯­æ³•ç³– const app = new Vue({ el: '#app', components: { mycpn2: { template: ` &lt;div> &lt;h2>æ¨¡æ¿2å†…å®¹&lt;/h2> &lt;/div> ` } } }); ç»„ä»¶æ¨¡æ¿çš„åˆ†ç¦»å†™æ³• ä¸ºäº†ä½¿ç»“æ„æ›´åŠ æ¸…æ™°ï¼Œæœ€å¥½å°†htmlåˆ†ç¦»å‡ºæ¥å†™ï¼Œè¿™é‡Œæœ‰ä¸¤ä¸ªç»„ä»¶æ¨¡æ¿åˆ†ç¦»çš„å†™æ³• 1.scriptæ ‡ç­¾ï¼Œæ³¨æ„ç±»å‹å¿…é¡»æ˜¯text/x-templateï¼ˆä½†æ˜¯ç°åœ¨æ¯”è¾ƒå°‘ä½¿ç”¨äº†ï¼‰ 2.ä½¿ç”¨templateæ ‡ç­¾ &lt;template id=\"cpn\"> &lt;div> &lt;h2>æ¨¡æ¿1å†…å®¹&lt;/h2> &lt;/div> &lt;/template> &lt;script> Vue.component('mycpn', { template: '#cpn' }) &lt;/script> ç»„ä»¶çš„æ•°æ®è®¿é—®ç»„ä»¶çš„data ç»„ä»¶å†…éƒ¨ä¸èƒ½ç›´æ¥è®¿é—®Vueå®ä¾‹é‡Œçš„æ•°æ®ï¼ŒåŒ…æ‹¬dataï¼Œmethodsç­‰ ç»„ä»¶æ˜¯ä¸€ä¸ªå•ç‹¬åŠŸèƒ½æ¨¡å—çš„å°è£…ï¼Œä¹Ÿæœ‰å±äºè‡ªå·±çš„dataå±æ€§ï¼ˆå…¶å®å¯ä»¥æŠŠVueå®ä¾‹ä¹Ÿçœ‹æˆä¸€ä¸ªç‰¹æ®Šçš„ç»„ä»¶ï¼Œç»„ä»¶åœ¨è‡ªå·±çš„æ ‡ç­¾é‡Œåªèƒ½è®¿é—®è‡ªå·±çš„dataï¼‰ï¼Œå½“ç„¶ä¹Ÿæœ‰è‡ªå·±çš„methodså±æ€§ ä½†æ˜¯ï¼ï¼ï¼šå’ŒVueçš„dataä¸åŒçš„æ˜¯ï¼Œç»„ä»¶è‡ªå·±çš„dataå¿…é¡»ç”¨å‡½æ•°å†™ï¼ˆmethodsä¸ç”¨ï¼‰ï¼Œç„¶åå†è¿”å›ä¸€ä¸ªå®ä¾‹å¯¹è±¡ ç»„ä»¶ä¸­çš„dataå†™æˆä¸€ä¸ªå‡½æ•°ï¼Œæ•°æ®ä»¥åˆ›ç«‹æ–°ä¸€ä¸ªå¯¹è±¡çš„å‡½æ•°è¿”å›å€¼å½¢å¼å®šä¹‰ï¼Œè¿™æ ·æ¯å¤ç”¨ä¸€æ¬¡ç»„ä»¶ï¼Œå°±ä¼šè¿”å›ä¸€ä»½æ–°çš„dataï¼Œï¼ˆå› ä¸ºå‡½æ•°ä¼šåˆ›å»ºè‡ªå·±çš„ä½œç”¨åŸŸï¼‰ç±»ä¼¼äºç»™æ¯ä¸ªç»„ä»¶å®ä¾‹åˆ›å»ºä¸€ä¸ªç§æœ‰çš„æ•°æ®ç©ºé—´ï¼Œè®©å„ä¸ªç»„ä»¶å®ä¾‹ç»´æŠ¤å„è‡ªçš„æ•°æ®ã€‚ï¼ˆåŒä¸€ä¸ªç»„ä»¶æ ‡ç­¾åç”¨çš„æ˜¯åŒä¸€ä¸ªç»„ä»¶æ„é€ å™¨å¯¹è±¡ï¼‰ è€Œå•çº¯çš„å†™æˆå¯¹è±¡å½¢å¼ï¼Œå°±ä½¿å¾—æ‰€æœ‰ç»„ä»¶å®ä¾‹åœ¨ä½¿ç”¨çš„æ—¶å€™ç›´æ¥å¼•ç”¨åŒä¸€ä¸ªå¯¹è±¡ï¼Œå¯¼è‡´å…±ç”¨äº†ä¸€ä»½dataï¼Œå°±ä¼šé€ æˆä¸€ä¸ªæ”¹å˜ï¼Œå…¨éƒ½ä¼šå‘ç”Ÿæ”¹å˜çš„å±€é¢ã€‚ &lt;template id=\"cpn\"> &lt;div> &lt;h2>{{str}}&lt;/h2> &lt;/div> &lt;/template> &lt;script> Vue.component('mycpn', { template: '#cpn', data() { return { str: 'hello world' } } }) &lt;/script> çˆ¶å­ç»„ä»¶çš„é€šä¿¡ çˆ¶ç»„ä»¶ä¼ ç»™å­ç»„ä»¶ï¼šå­ç»„ä»¶é€šè¿‡propsæ–¹æ³•æ¥å—æ•°æ®; ï¼ˆå¤–åŠ  v-bindå±æ€§ä¼ å€¼ï¼‰Vueå®ä¾‹çš„data -&gt; å­ç»„ä»¶çš„propsæ•°ç»„ä¸­æŸä¸ªå˜é‡åè¿›è¡Œæ¥æ”¶ï¼Œå½“ä½œæ•°æ®æ¥ä½¿ç”¨ï¼Œç„¶ååœ¨æ¸²æŸ“åˆ°templateæ¨¡æ¿ä¸­ï¼ˆmustacheè¯­æ³•ï¼‰ å­ç»„ä»¶ä¼ ç»™çˆ¶ç»„ä»¶ï¼š$emitæ–¹æ³•ï¼ˆè‡ªå®šä¹‰äº‹ä»¶ï¼‰ä¼ é€’å‚æ•° åœ¨çœŸå®å¼€å‘ä¸­ï¼ŒVueå®ä¾‹å’Œå­ç»„ä»¶çš„é€šä¿¡ä¹Ÿå¯ä»¥å½“ä½œçˆ¶ç»„ä»¶å’Œå­ç»„ä»¶çš„é€šä¿¡æ¥çœ‹ çˆ¶ç»„ä»¶ä¼ å­ç»„ä»¶çˆ¶ç»„ä»¶ä¼ é€’ç»™å­ç»„ä»¶å®ä¾‹ï¼š &lt;div id=\"app\"> &lt;mycpn :smovies=\"movies\" :smessage=\"message\">&lt;/mycpn> &lt;/div> &lt;template id=\"cpn\"> &lt;div> &lt;ul> &lt;li v-for=\"item in smovies\">{{item}}&lt;/li> &lt;/ul> &lt;h2>{{smessage}}&lt;/h2> &lt;/div> &lt;/template> &lt;script> // çˆ¶ç»„ä»¶ä¼ å­ç»„ä»¶ props const app = new Vue({ el: '#app', data: { movies: ['ironman', 'batman', 'spiderman'], message: 'hello world' }, components: { mycpn: { template: '#cpn', props: ['smovies', 'smessage'] } } }); &lt;/script> æ³¨æ„ï¼špropså®šä¹‰çš„å±æ€§ååŒæ ·ä¸è¦ä½¿ç”¨é©¼å³°æ ‡è¯†ï¼Œå› ä¸ºHTMLå±æ€§ä¸æ”¯æŒå¤§å†™ï¼ˆè‡ªå®šä¹‰ç»„ä»¶åä¹Ÿæ˜¯ä¸è¦å¤§å†™ï¼‰ï¼ˆéè¦ç”¨å¤§å†™åˆ™åœ¨htmlé‡Œæ—¶ï¼Œå°†å¯¹åº”çš„å¤§å†™å‰åŠ  -ï¼Œè¿™æ ·çš„è¯å¤§å†™è½¬å°å†™ï¼‰ å¯¹äºé€šè¿‡propsä»çˆ¶ç»„ä»¶ä¼ é€’è¿‡æ¥çš„å€¼æœ€å¥½ä¸è¦ç›´æ¥ä¿®æ”¹ï¼Œè€Œæ˜¯åœ¨å­ç»„ä»¶çš„dataåˆ›å»ºæ•°æ®ï¼Œä»¥ä¼ é€’è¿‡æ¥çš„å€¼å¯¹å…¶è¿›è¡Œèµ‹å€¼ï¼Œç„¶åæƒ³ä¿®æ”¹çš„æ‰‹å†åœ¨dataçš„æ•°æ®ä¸­ä¿®æ”¹ propçš„èµ‹å€¼æ–¹å¼ // props: ['smovies', 'smessage'] // è¿™ç§å¯¹è±¡å†™æ³•è¿˜å¯ä»¥æŒ‡å®šæ¯ä¸ª prop çš„å€¼ç±»å‹,ç”šè‡³æä¾›é»˜è®¤å€¼,å¿…ä¼ å€¼,æ›´å¸¸ç”¨ // ä½†æ˜¯propsé‡Œå±æ€§ä¸ºå¯¹è±¡æˆ–è€…æ•°ç»„æ—¶,é»˜è®¤å€¼ï¼ˆdefaultï¼‰å±æ€§å¿…é¡»æ˜¯ä¸€ä¸ªå‡½æ•° // props:{ // smovies:Array, // smessage:String // } props: { smovies: { type: Array, default() { return [] } }, smessage: { type: String, default: 'nothing', require: false // ä½¿ç”¨è¯¥å­ç»„ä»¶çš„æ—¶å€™,æ˜¯å¦å¿…é¡»è¦ç»™è¿™ä¸ªsmessageå±æ€§èµ‹å€¼ } } épropsçš„å±æ€§ å½“æˆ‘ä»¬ä¼ é€’ç»„å»ºçš„æŸä¸€ä¸ªå±æ€§æ—¶ï¼Œè¯¥å±æ€§æ²¡æœ‰å®šä¹‰å¯¹åº”çš„propsæˆ–è€…emitsæ—¶ï¼Œå°±ç§°ä¹‹ä¸ºéPropsçš„Attribute å¸¸è§çš„åŒ…æ‹¬styleã€classã€idå±æ€§ç­‰ è€Œå½“ç»„ä»¶æœ‰æ ¹èŠ‚ç‚¹æ—¶ï¼ŒéPropsçš„Attributeå°†è‡ªåŠ¨æ·»åŠ åˆ°æ ¹èŠ‚ç‚¹çš„Attributeä¸­ å½“ç„¶ï¼Œä¹Ÿå¯ä»¥åœ¨ç»„ä»¶é‡Œæ·»åŠ ä¸€ä¸ªoptionï¼šinheritAttrs: falseï¼Œæ ¹èŠ‚ç‚¹å°†ä¸ä¼šå†ç»§æ‰¿è¿™ä¸ªépropså±æ€§ ç¦ç”¨çš„å®é™…æƒ…å†µ ç¦ç”¨attributeç»§æ‰¿å¸¸è§æƒ…å†µæ˜¯éœ€è¦å°†attributeåº”ç”¨äºæ ¹å…ƒç´ ä¹‹å¤–çš„å…¶å®ƒå…ƒç´  æˆ‘ä»¬å¯ä»¥é€šè¿‡$attrsæ¥è®¿é—®æ‰€æœ‰épropsçš„attribute &lt;template> &lt;div> &lt;h2 :class=\"$attrs.class\">hello world&lt;/h2> &lt;h2>hello world&lt;/h2> &lt;/div> &lt;/template> å­ç»„ä»¶ä¼ çˆ¶ç»„ä»¶ æµç¨‹ï¼š 1.å­ç»„ä»¶é€šè¿‡$emit()è§¦å‘äº‹ä»¶ï¼Œå­ç»„ä»¶å‘é€å‡ºå»ä¸€ä¸ªäº‹ä»¶ this.$emit(äº‹ä»¶åç§°, [ä¼ é€’å‚æ•°]),æ˜¯è‡ªå®šä¹‰äº‹ä»¶ 2.çˆ¶ç»„ä»¶é€šè¿‡ v-onç›‘å¬å­ç»„ä»¶äº‹ä»¶ &lt;!-- çˆ¶æ¨¡æ¿ --> &lt;div id=\"app\"> &lt;!-- çˆ¶ç»„ä»¶éœ€è¦ä½¿ç”¨äº‹ä»¶ç›‘å¬ v-on è¿›è¡Œç›‘å¬ï¼Œç„¶åè‡ªå·±åœ¨methodså®šä¹‰ç›¸å¯¹åº”çš„å¤„ç†å‡½æ•°å°±å¯ä»¥äº† --> &lt;!-- v-onä¸ä»…å¯ä»¥ç›‘å¬DOMäº‹ä»¶ï¼Œè¿˜å¯ä»¥ç›‘å¬ç»„ä»¶ä¹‹é—´çš„äº‹ä»¶ --> &lt;mycpn v-on:Bigclick=\"FatherListener\">&lt;/mycpn> &lt;/div> &lt;!-- å­æ¨¡ç‰ˆ --> &lt;template id=\"cpn\"> &lt;div> &lt;ul> &lt;li v-for=\"item in categories\" @click=\"itemclick(item)\">{{item.name}}&lt;/li> &lt;/ul> &lt;/div> &lt;/template> &lt;script> const app = new Vue({ el: '#app', components: { mycpn = { template: '#cpn', data() { return { categories: [ { id: 1, name: \"çƒ­é—¨æ¨è\" }, { id: 1, name: \"æ‰‹æœºæ•°ç \" }, { id: 1, name: \"å®¶ç”¨å®¶ç”µ\" }, { id: 1, name: \"ç”µè„‘åŠå…¬\" }, ] } }, methods: { itemclick(item) { this.$emit('Bigclick', item); } }, } }, methods: { //åŸºæœ¬çš„äº‹ä»¶é»˜è®¤ä¼ å…¥eventï¼Œä½†æ˜¯å­ç»„ä»¶ä¼ æ¥çš„äº‹ä»¶ï¼Œå¦‚æœé™„å¸¦ä¸Šå‚æ•°ï¼Œåˆ™å¦‚æœçˆ¶ç»„ä»¶å¤„ç†çš„å‡½æ•°è‡ªå¸¦ä¼ æ¥çš„å‚æ•° FatherListener(item) { console.log(\"hello\", item); } } }); &lt;/script> çˆ¶å­ç»„ä»¶å¯¹è±¡æ“ä½œä¸Šé¢çš„ç»„ä»¶æ•°æ®è®¿é—®æˆ‘ä»¬å·²ç»æåˆ°äº†çˆ¶å­ç»„ä»¶ç›¸äº’é€šä¿¡çš„æ–¹æ³•ï¼ˆå­ç»„ä»¶ä¼ å­ç»„ä»¶ä¿¡æ¯ç»™çˆ¶ç»„ä»¶ï¼Œçˆ¶ç»„ä»¶ä¼ çˆ¶ç»„ä»¶çš„ä¿¡æ¯ç»™å­ç»„ä»¶ï¼‰ï¼Œä½†æœ‰æ—¶æˆ‘ä»¬æƒ³ç›´æ¥è®¿é—®ç»„ä»¶ï¼ˆçˆ¶ç»„ä»¶è·å–å­ç»„ä»¶ä¿¡æ¯ï¼‰ï¼Œè€Œä¸æ˜¯å½“å­ç»„ä»¶è§¦å‘æŸä¸ªäº‹ä»¶æ—¶ï¼Œå°†å­ç»„ä»¶æ•°æ®ä¼ ç»™çˆ¶ç»„ä»¶å†è¿›è¡Œæ“ä½œ çˆ¶ç»„ä»¶æƒ³è¦è®¿é—®å­ç»„ä»¶ï¼šä½¿ç”¨ $children æˆ–è€… $refs å­ç»„ä»¶è®¿é—®çˆ¶ç»„ä»¶ï¼šä½¿ç”¨ $parent çˆ¶ç»„ä»¶æƒ³è¦è®¿é—®å­ç»„ä»¶ï¼š ä½†æ˜¯çœŸå®å¼€å‘ä¸­ï¼Œæˆ‘ä»¬ä¸ä¼šé€šè¿‡$childrenå»æ‹¿å­ç»„ä»¶å¯¹è±¡è¿›è¡Œæ“ä½œï¼Œè¿™æ˜¯å› ä¸ºå½“ä½¿ç”¨$children[ç´¢å¼•å·]çš„æ–¹å¼æ‹¿å–æ•°æ®ï¼Œå½“Vueç»‘å®šçš„æ ‡ç­¾å†…åœ¨ä¸­é—´æ–°æ’å…¥æ–°å­ç»„ä»¶ï¼Œä¼šå¯¼è‡´æ‹¿åˆ°çš„æ˜¯æ–°å­ç»„ä»¶çš„æ•°æ® æ‰€ä»¥ç”¨$refsæ¯”è¾ƒå¤šï¼Œæ— è®ºVueç»‘å®šçš„æ ‡ç­¾å†…æ˜¯å¦æœ‰å­ç»„ä»¶ï¼Œthis.$ref éƒ½é»˜è®¤ä¸ºç©º &lt;!-- å¯¹åº”çš„htmlæ ‡ç­¾ --> &lt;div id=\"app\"> &lt;cpn> &lt;/cpn> &lt;cpn ref=\"cpn2\"> &lt;/cpn> &lt;button @click=\"btnClick\">æ‰“å°å­ç»„ä»¶ä¿¡æ¯&lt;/button> &lt;/div> //å­ç»„ä»¶ä¿¡æ¯ cpn: { template: '#cpn', data() { return { name: 'Allen' } }, methods: { showMessage() { console.log('nothing'); } } } //Vueçš„mothodsä¸­çš„æ–¹æ³•ï¼š btnClick() { // 1.$children // è°ƒç”¨Vueç»‘å®šçš„æ ‡ç­¾å†…ç¬¬ä¸€ä¸ªå­ç»„ä»¶çš„æ–¹æ³•showMessage() this.$children[0].showMessage(); console.log(this.$children[0].name); // 2.$ref,åœ¨æ ‡ç­¾ä¸ŠåŠ å±æ€§ï¼šref=\"cpn2\",æ­¤æ—¶this.$refä¸å†ä¸ºç©º console.log(this.$refs.cpn2); } ä½¿ç”¨å‰è¦æ³¨æ„ï¼šå› ä¸º ref æœ¬èº«æ˜¯ä½œä¸ºæ¸²æŸ“ç»“æœè¢«åˆ›å»ºçš„ï¼Œåœ¨åˆå§‹æ¸²æŸ“çš„æ—¶å€™ä½ ä¸èƒ½è®¿é—®å®ƒä»¬ - å®ƒä»¬è¿˜ä¸å­˜åœ¨ï¼$refs ä¹Ÿä¸æ˜¯å“åº”å¼çš„ï¼Œå› æ­¤ä½ ä¸åº”è¯¥è¯•å›¾ç”¨å®ƒåœ¨æ¨¡æ¿ä¸­åšæ•°æ®ç»‘å®šã€‚ refå¦‚æœç»‘å®šåœ¨ç»„ä»¶ä¸­ï¼Œé‚£ä¹ˆé€šè¿‡ this.refs.refç»‘å®šçš„åç§°è·å–åˆ°çš„æ˜¯ä¸€ä¸ªç»„ä»¶å¯¹è±¡ refå¦‚æœç»‘å®šåœ¨å…ƒç´ ä¸­ï¼Œé‚£ä¹ˆé€šè¿‡ this.refs.refç»‘å®šçš„åç§°è·å–åˆ°çš„æ˜¯ä¸€ä¸ªå…ƒç´ å¯¹è±¡ï¼ˆæ­¤æ—¶refçš„åŠŸèƒ½ä¸æ˜¯ç”¨äºçˆ¶ç»„ä»¶è·å–å­ç»„ä»¶çš„æ•°æ®ï¼Œè€Œæ˜¯ç»„ä»¶è‡ªå·±å†…éƒ¨æƒ³è¦åœ¨æŸä¸ªåœ°æ–¹è·å–åˆ°è‡ªå·±çš„æŸä¸ªæ ‡ç­¾ï¼ˆå…ƒç´ ï¼‰ï¼Œè¿™æ ·æœ‰è¾ƒé«˜å®‰å…¨æ€§ï¼Œå› ä¸ºç±»åå¯èƒ½ä¼šé‡å¤ï¼Œåˆ°æ—¶å€™é¡¹ç›®å¼€å‘æ—¶é€šè¿‡ç±»åçš„è·å–ï¼Œä¸ä¸€å®šèƒ½å¤Ÿå‡†ç¡®è·å–ç›®æ ‡ï¼‰ å­ç»„ä»¶æƒ³è¦è®¿é—®çˆ¶ç»„ä»¶ï¼šï¼ˆå¼€å‘ä¸­ä¸å»ºè®®ç”¨ï¼Œå› ä¸ºå¼•ç”¨äº†å¤–éƒ¨ç»„ä»¶çš„æ•°æ®ï¼Œè¿˜æ˜¯çˆ¶ç»„ä»¶çš„æ•°æ®ï¼Œè¿™æ ·ä¼šå¯¼è‡´ç‹¬ç«‹æ€§ã€å¯å¤ç”¨æ€§é™ä½ï¼Œæœ‰è¾ƒå¤§è€¦åˆæ€§ï¼‰$parent å¦‚æœæƒ³è®¿é—®æ ¹ç»„ä»¶æ•°æ®ç”¨ $root //cpnçš„methodsä¸­ï¼š methods: { btn_click() { console.log(this.$parent); } } æ’æ§½slotç»„ä»¶çš„æ’æ§½ä¹Ÿæ˜¯ä¸ºäº†è®©å°è£…çš„ç»„ä»¶æ›´å…·æœ‰æ‰©å±•æ€§ï¼ˆä½¿ç”¨åŒä¸€ç»„ä»¶ä½†èƒ½è‡ªå®šä¹‰ç‰¹è‰²é£æ ¼ï¼‰ æŠ½å–å…±æ€§ï¼Œé¢„ç•™ä¸åŒ åœ¨ç»„ä»¶ï¼ˆæ¨¡æ¿ï¼‰ä¸­å¢åŠ  &lt;slot&gt;&lt;/slot&gt;ï¼Œç„¶ååœ¨htmlä¸Šä½¿ç”¨ç»„ä»¶æ—¶ï¼Œå¾€ä¸­é—´æ·»åŠ çš„æ ‡ç­¾/æ–‡å­—ï¼Œéƒ½ä¼šæ”¾åœ¨templateæ¨¡æ¿ä¸­slotæ ‡ç­¾å†… æ¨èä½¿ç”¨ divæ ‡ç­¾å…ˆå°† slotåŒ…èµ·æ¥å†ä½¿ç”¨ &lt;div&gt;&lt;slot&gt;&lt;/slot&gt;&lt;/div&gt;ï¼Œå¯ä»¥é¿å…å¾ˆå¤šbug &lt;!-- ç»„ä»¶cpnçš„æ¨¡æ¿ä¸­æ·»åŠ ï¼š --> &lt;div> &lt;h2>æˆ‘æ˜¯å­ç»„ä»¶&lt;/h2> &lt;p>è¿™æ˜¯å­ç»„ä»¶çš„æ®µè½&lt;/p> &lt;!-- åŒæ—¶ä¹Ÿå¯ä»¥å®šä¹‰ä¸€ä¸ªé»˜è®¤å€¼ï¼Œè¿™é‡Œæ²¡æœ‰ä¼ å…¥åˆ™æ’æ§½å†…é»˜è®¤æ˜¾ç¤ºä¸€ä¸ªbutton --> &lt;slot>&lt;button>æŒ‰é’®&lt;/button>&lt;/slot> &lt;/div> &lt;!-- ä½¿ç”¨æ’æ§½è¿›è¡Œæ›¿æ¢ --> &lt;cpn>&lt;button>å…¶ä»–&lt;/button> &lt;/cpn> å…·åæ’æ§½ åº”ç”¨ï¼šå¦‚æœæœ‰å¤šä¸ªæ’æ§½ä¸”æƒ³è¦æ›¿æ¢æ‰æŒ‡å®šçš„æ’æ§½ ä¸€ä¸ªä¸å¸¦ name çš„ &lt;slot&gt; å‡ºå£ä¼šå¸¦æœ‰éšå«çš„åå­—â€œdefaultâ€ã€‚ æ³¨æ„ v-slot åªèƒ½æ·»åŠ åœ¨ &lt;template&gt; ä¸Š &lt;!-- ç»„ä»¶cpnçš„æ¨¡æ¿ä¸­æ·»åŠ ï¼š --> &lt;div> &lt;slot name=\"left\">&lt;span>å·¦è¾¹&lt;/span>&lt;/slot> &lt;slot name=\"mid\">&lt;span>ä¸­é—´&lt;/span>&lt;/slot> &lt;slot name=\"right\">&lt;span>å³è¾¹&lt;/span>&lt;/slot> &lt;/div> &lt;!-- å¦‚æœæ˜¯åœ¨&lt;template>ä¸Šçš„è¯ï¼Œå¯ä»¥ä½¿ç”¨æ–°ç‰ˆçš„ v-slotäº† --> &lt;!-- æ›¿æ¢æ‰nameä¸ºmidçš„æ’æ§½--> &lt;cpn> &lt;template v-slot:mid> &lt;!-- &lt;template #mid>--> &lt;span>nothing&lt;/span> &lt;/template> &lt;/cpn> æ—§ç‰ˆæœ¬çš„ï¼š&lt;div slot=&quot;æ’æ§½å&quot;&gt;é¦–é¡µ&lt;/div&gt; vue2.6æ–°å¢ï¼š è¿˜æœ‰åŠ¨æ€æ’æ§½åçš„ç”¨æ³•ï¼Œå¯ä»¥å®˜ç½‘æŸ¥çœ‹ä¸€ä¸‹ v-slotè¯­æ³•ç³–ï¼š# ä½œç”¨åŸŸæ’æ§½ å¤§å‰æï¼šçˆ¶ç»„ä»¶æ¨¡æ¿çš„æ‰€æœ‰ä¸œè¥¿éƒ½ä¼šåœ¨çˆ¶çº§ä½œç”¨åŸŸè¿›è¡Œç¼–è¯‘ï¼Œå­ç»„ä»¶æ¨¡æ¿çš„æ‰€æœ‰ä¸œè¥¿éƒ½ä¼šåœ¨å­çº§ä½œç”¨åŸŸè¿›è¡Œç¼–è¯‘ å½“å‰éœ€æ±‚ï¼šæƒ³åŠæ³•åœ¨çˆ¶ç»„ä»¶çš„ä½œç”¨åŸŸæ‹¿åˆ°å­ç»„ä»¶çš„æ•°æ®ï¼Œç„¶åå†åœ¨çˆ¶ç»„ä»¶åšä¸€ä¸ªæ’æ§½å¡«å……ï¼ˆè¿™é‡Œä¸èƒ½ä½¿ç”¨$refså› ä¸ºï¼Œè¿˜æ²¡æ¸²æŸ“å®Œæ¯•ï¼Œåœ¨åˆå§‹æ¸²æŸ“çš„æ—¶å€™ä½ ä¸èƒ½ç”¨$refsè¿›è¡Œè®¿é—®ï¼‰ ä¹Ÿå°±æ˜¯è¯´ï¼Œæ™®é€šæ’æ§½çš„æ¸²æŸ“ä½ç½®åœ¨çˆ¶ç»„ä»¶é‡Œé¢ï¼Œå°†çˆ¶ç»„ä»¶æ¸²æŸ“çš„ç»“æœç›´æ¥æ›¿æ¢åˆ° slotä¸­ï¼› è€Œä½œç”¨åŸŸæ’æ§½çš„æ¸²æŸ“ä½ç½®æ˜¯åœ¨å­ç»„ä»¶é‡Œé¢ï¼Œæ‰€ä»¥è¿™é‡Œå°±äº§ç”Ÿäº†ä½œç”¨åŸŸçš„ä¸åŒ å¤šä¸ªæ’æ§½å†™æ³•ï¼šv-slot:æ’æ§½å=â€æ•°æ®è°ƒç”¨æ–¹æ³•åâ€ï¼Œ é¦–å…ˆåœ¨å­ç»„ä»¶æ¨¡æ¿ä¸­çš„ &lt;slot&gt;&lt;/slot&gt;æŸ¥æ‰¾ä¸­æ·»åŠ è‡ªå®šä¹‰å±æ€§ï¼Œè‡ªå®šä¹‰å±æ€§=â€æƒ³è¦ç»‘å®šçš„æ•°æ®åâ€ &lt;!-- å­ç»„ä»¶--> &lt;!-- æ³¨æ„ï¼š:dataå±æ€§åè¿™é‡Œå¯ä»¥éšä¾¿æ”¹è‡ªå·±å–œæ¬¢çš„åå­—ï¼Œä½†æ˜¯å¿…é¡»è¦å°å†™ï¼Œv-slotçš„ä¹Ÿæ˜¯ä¸€æ ·è¦æ³¨æ„å°å†™ --> &lt;slot :data=\"pLanguages\"> &lt;ul> &lt;li v-for=\"item in pLanguages\">{{item}}&lt;/li> &lt;/ul> &lt;/slot> Vueé‡Œæ”¯æŒé€šè¿‡templateï¼Œæ¥æ‹¿åˆ°åˆšæ‰çš„dataå±æ€§ï¼Œä½¿ç”¨ v-slot:&quot;æ’æ§½å…·å&quot;=&quot;è‡ªå®šä¹‰æ’æ§½ prop çš„å¯¹è±¡&quot;ï¼›è·å–å­ç»„ä»¶é€šè¿‡å±æ€§ä¼ é€’è¿‡æ¥çš„æ•°æ®ï¼Œç„¶åé€šè¿‡ è‡ªå®šä¹‰æ’æ§½ prop çš„å¯¹è±¡.å­ç»„ä»¶è‡ªå®šä¹‰å±æ€§åè°ƒç”¨å­ç»„ä»¶çš„æ•°æ® &lt;!-- åœ¨htmlä¸­ä½¿ç”¨ç»„ä»¶ --> &lt;cpn> &lt;!-- &lt;span v-for=\"item in pLanguages\">{{item}}&lt;/span> é”™è¯¯ï¼Œä¸å¯ä»¥ç›´æ¥è·å–--> &lt;!-- å¦‚æœæ’æ§½æœ‰å…·åï¼Œåˆ™å†™æˆ&lt;template v-slot:\"å…·å\"=\"slotProps\"> --> &lt;template v-slot=\"slotProps\"> &lt;span v-for=\"item in slotProps.data\">{{item}} - &lt;/span> &lt;/template> &lt;/cpn> ä¸ºä»€ä¹ˆè¦ä½¿ç”¨å¼‚æ­¥ç»„ä»¶å¤§å‰æï¼š åœ¨webpackä¸­ï¼Œå¦‚æœæƒ³è¦è®©webpackå•ç‹¬åˆ†åŒ…ï¼Œä¹Ÿå°±æ˜¯å°†å¯¼å…¥çš„ç»„ä»¶/æ–‡ä»¶åœ¨æ‰“åŒ…åä¸è¦åˆå¹¶ï¼Œè€Œæ˜¯å•ç‹¬åˆ†ä¸€ä¸ªchunk-å“ˆå¸Œå€¼.jså‡ºæ¥ï¼Œåˆ™åªéœ€è¦æˆ‘ä»¬åœ¨å¯¼å…¥çš„æ—¶å€™é€šè¿‡ import('xxxxx.js').then(res => res.å‡½æ•°å); çš„å½¢å¼è¿›è¡Œä½¿ç”¨æ—¶ï¼Œåˆ™webapckä¼šå¸®æˆ‘ä»¬é¢å¤–ç”Ÿæˆchunkæ¥æ‰“åŒ…è¯¥æ–‡ä»¶ï¼ˆåˆ©ç”¨çš„æ˜¯importå‡½æ•°å¾—åˆ°ä¸€ä¸ªå¼‚æ­¥promiseçš„åŸç†ï¼‰ å¦‚æœç»„ä»¶åŠŸèƒ½å¤šï¼Œæ‰“åŒ…çš„ç»“æœï¼ˆapp.jsï¼‰ä¼šå˜å¤§ï¼Œæˆ‘ä»¬å¯ä»¥é‡‡ç”¨å¼‚æ­¥çš„æ–¹å¼æ¥åŠ è½½ç»„ä»¶ï¼Œä¸»è¦ä¾èµ–äº import å¼‚æ­¥ç»„ä»¶ ï¼ˆasync componentï¼‰ä¸€å®šæ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œæ–°ç‰ˆæœ¬æä¾›äº†å¯¹è±¡çš„å†™æ³• components:{ AddCustomerSchedule:(resolve) => import(\"../components/AddCustomer\") } Vue.component('async-example', function (resolve, reject) { setTimeout(function () { // å‘ `resolve` å›è°ƒä¼ é€’ç»„ä»¶å®šä¹‰ resolve({ template: '&lt;div>I am async!&lt;/div>' }) }, 1000) })","categories":[{"name":"å‰ç«¯","slug":"å‰ç«¯","permalink":"https://taylor12138.github.io/categories/%E5%89%8D%E7%AB%AF/"}],"tags":[],"author":"Hello"},{"title":"Express","slug":"Express","date":"2021-01-30T16:00:00.000Z","updated":"2022-05-04T12:37:32.421Z","comments":true,"path":"2021/01/31/express/","link":"","permalink":"https://taylor12138.github.io/2021/01/31/express/","excerpt":"","text":"Expressæ¡†æ¶åŸºäºNode.jså¹³å°å¿«é€Ÿã€å¼€æ”¾ã€æç®€çš„Webå¼€å‘æ¡†æ¶ï¼Œé«˜åº¦å°è£…äº†httpæ¨¡å— ï¼ˆæˆªè‡³åœ¨2021/4/18ï¼Œåœ¨GitHubä¸Šï¼Œ expressï¼š52.7k starï¼› koaï¼š31k starï¼› Hapiï¼š13.2k starï¼Œexpresså é¢†æ¦œé¦–ï¼Œæœ€é«˜æ´»è·ƒåº¦ï¼‰ å®‰è£…ï¼šç”¨VScodeæ‰“å¼€æ–‡ä»¶ç›®å½•ï¼Œç„¶ååœ¨è¯¥ç›®å½•ä¸‹å³é”®-&gt;åœ¨é›†æˆç»ˆç«¯æ‰“å¼€-&gt;è¾“å…¥å‘½ä»¤ npm init --yes è¿›è¡Œåˆå§‹åŒ–ï¼Œåˆ›å»ºä¸€ä¸ªpackage.jsonæ–‡ä»¶-&gt; npm i express --save å®‰è£…æ¡†æ¶ -&gt; åœ¨jsä¸­è¾“å…¥ å®ƒï¼ï¼š å°è£…APIï¼Œè®©å¼€å‘è€…æ›´å…³æ³¨äºä¸šåŠ¡ä»£ç çš„å¼€å‘ æœ‰ä¸€å®šçš„æµç¨‹å’Œæ ‡å‡† åŸºæœ¬ä½¿ç”¨1.http.createServer((req, res) =&gt; {}) =&gt; express() åˆ›å»ºæœåŠ¡å™¨ 2.if (url.parse(req.url, true).pathname === è·¯å¾„){} =&gt; app.get(è·¯å¾„, fn) åˆ¤æ–­è·¯å¾„è¿›è¡Œå¤„ç† 3.app.use(&#39;public&#39;, express.static(&#39;./public/&#39;)); å¤„ç†å…¬å¼€ç›®å½•ï¼Œå½“ä»¥/public/å¼€å¤´çš„æ—¶å€™ï¼Œå»./public/ç›®å½•ä¸­æŸ¥æ‰¾å¯¹åº”çš„èµ„æºï¼Œå¦‚ http://127.0.0.1:5208/public/404.htmlï¼Œç›´æ¥è¿›è¡Œè®¿é—®ï¼ˆå¸¸ç”¨ï¼‰ ç¬¬ä¸€ä¸ªå‚æ•°å…¶å®æ˜¯åˆ«åï¼Œapp.use(&#39;a&#39;, express.static(&#39;./public/&#39;)); å¤„ç†å…¬å¼€ç›®å½•ï¼Œå½“ä»¥/a/å¼€å¤´çš„æ—¶å€™ï¼Œå»./public/ç›®å½•ä¸­æŸ¥æ‰¾å¯¹åº”çš„èµ„æºï¼Œå¦‚ http://127.0.0.1:5208/a/404.htmlï¼Œç›´æ¥è¿›è¡Œè®¿é—® å¦‚æœçœç•¥ç¬¬ä¸€ä¸ªå‚æ•°ï¼šapp.use(express.static(&#39;./public/&#39;))ï¼Œåˆ™å¯ä»¥åœ¨åŸå§‹ç½‘é¡µç½‘å€+èµ„æºåç§°ï¼Œå¦‚ http://127.0.0.1:5208/404.htmlï¼Œç›´æ¥è¿›è¡Œè®¿é—® 4.url.parse(req.url, true).query=&gt; req.query åŸæ¥çš„getè·å–url ? åçš„å‚æ•°çš„æ–¹æ³•çš„æ”¹å˜ï¼ˆåªèƒ½æ‹¿getè¯·æ±‚çš„å‚æ•°ï¼‰ æ¨¡æ¿å¯¹è±¡ï¼šåœ¨Expressä¸­ï¼Œæ¨¡æ¿å¼•æ“çš„ä½¿ç”¨æœ‰æ›´å¥½çš„æ–¹å¼res.render(â€˜æ–‡ä»¶åâ€™, {æ¨¡æ¿å¯¹è±¡})ï¼Œå¯ä»¥è‡ªå·±å°è¯•çœ‹art-templateå®˜æ–¹æ–‡æ¡£ï¼Œè®©å®ƒä»¬ç»“åˆä½¿ç”¨ 5.expressä¸éœ€è¦ res.end()ç»“å°¾æ¥ç»“æŸå“åº”ï¼Œè€Œä¸”å®ƒè¿˜æä¾›äº†res.send(JSON.stringify(å¯¹è±¡)) =&gt; res.json() è‡ªåŠ¨å¸®ä½ æŠŠjsonå¯¹è±¡è½¬æ¢æˆå­—ç¬¦ä¸²ï¼Œç„¶åå‘é€ç»™æµè§ˆå™¨ // å¼•åŒ… var express = require('express'); // åˆ›å»ºæœåŠ¡å™¨ï¼Œç›¸å½“äºåŸæ¥çš„http.createServer() var app = express(); //å½“æœåŠ¡å™¨æ”¶åˆ°getè¯·æ±‚ '/' çš„æ—¶å€™ï¼Œæ‰§è¡Œå›è°ƒå‡½æ•° // ä¸ç”¨å†è®¾ç½®httpå¤´éƒ¨æ–‡ä»¶ï¼Œå¹¶ä¸”ä¸ç”¨è®¾ç½®charset=utf-8:é˜²æ­¢ä¸­æ–‡ä¹±ç ï¼Œå®ƒä¼šæ ¹æ®ä½ çš„è¯­è¨€æ›´æ”¹language //å†…ç½®å¤„ç†æœ‰ä¸è®¤è¯†çš„è·¯å¾„æ—¶ï¼Œè‡ªåŠ¨å‘404 app.get('/', function (req, res) { res.send('Hello, world!'); }) app.get('/about', function (req, res) { //æ‹¿å‡ºgetè¯·æ±‚å‚æ•°ï¼šåœ¨Expressä¸­å¯ä»¥ç›´æ¥é€šè¿‡req.queryæ¥è·å–æŸ¥è¯¢å­—ç¬¦ä¸²å‚æ•° //http://127.0.0.1:5208/about?a=1&amp;b=2 console.log(req.query); res.send('ä½ å¥½ï¼ï¼!'); }) // å…¬å¼€æŒ‡å®šç›®å½•ï¼ˆå¤„ç†é™æ€èµ„æºpublicé‚£å—ï¼‰ // ä¹‹åä½ å°±å¯ä»¥é€šè¿‡publicçš„æ–¹å¼è®¿é—®publicç›®å½•çš„æ‰€æœ‰èµ„æºäº† // æ›¿ä»£äº†åŸæ¥åˆ¤æ–­è·¯å¾„+è¯»æ–‡ä»¶+endç»“æŸçš„è¿‡ç¨‹ app.use('/notebook/', express.static('./notebook/')); // ç›¸å½“äºserver.listen app.listen(5208, () => { console.log('app is running at port!'); }) ç„¶åç»§ç»­å³é”®åœ¨é›†æˆç»ˆç«¯æ‰“å¼€-&gt;è¾“å…¥å‘½ä»¤ node è¯¥jsçš„æ–‡ä»¶å è¿™é‡Œçš„ app.get(&#39;/&#39;,(request, response) ä¸­çš„ / æ˜¯è·¯å¾„ï¼ˆå½“ç„¶å¯ä»¥å†™æˆ/è·¯å¾„å ä¹‹ç±»çš„ï¼‰ï¼Œå½“å®¢æˆ·ç«¯æµè§ˆå™¨å‘æœåŠ¡å™¨å‘é€è¯·æ±‚æ—¶ï¼Œå¦‚æœurlçš„è·¯å¾„ï¼Œä¹Ÿå°±æ˜¯è¯·æ±‚è¡Œçš„ç¬¬äºŒéƒ¨åˆ†ï¼Œå®ƒçš„è·¯å¾„å¯¹åº”è¯¥è·¯å¾„çš„è¯ï¼Œå°±ä¼šæ‰§è¡Œè¿™ä¸ªå›è°ƒå‡½æ•°é‡Œé¢çš„ ä»£ç ï¼Œå¹¶ä¸”ç”±responseåšå‡ºå“åº” ä»¥ä¸Šæ­¥éª¤æ¥ç®€å•æ„å»ºä¸€ä¸ªæœåŠ¡ç«¯ï¼Œæä¾›ajaxä½¿ç”¨ expressçš„responseæ–¹æ³•ä¸€è§ˆ åŸºæœ¬è·¯ç”±æœåŠ¡å™¨ä¸­getå’Œpostéƒ¨åˆ†ç›¸å½“äºè·¯ç”±è¡¨ï¼Œå¸®ä½ æ˜ å°„å…³ç³»ï¼š app .get('/login', callback) .get('xxx', callback) .post('yyyy', callback) é…ç½®art-templateæ¨¡æ¿å¼•æ“åœ¨å®˜æ–¹æ–‡æ¡£å¯ä»¥çœ‹å¾—åˆ°Expressé…åˆä½¿ç”¨çš„å®‰è£…å¯¼èˆªï¼šhttps://aui.github.io/art-template/ npm install --save art-template npm install --save express-art-template æ³¨æ„ï¼šExpressæœ‰ä¸ªçº¦å®šï¼ŒæŠŠæ‰€æœ‰è§†å›¾æ–‡ä»¶éƒ½æ”¾åœ¨viewsç›®å½•ä¹‹ä¸­ï¼Œå¦‚æœæƒ³è¦ä¿®æ”¹ï¼Œåˆ™app.set(&#39;views&#39;, renderå‡½æ•°çš„é»˜è®¤è·¯å¾„) ç„¶å app.engine(&#39;art&#39;, require(&#39;express-art-template&#39;)) ç¬¬ä¸€ä¸ªå‚æ•°è¡¨ç¤ºå½“æ¸²æŸ“ä»¥.artç»“å°¾çš„æ–‡ä»¶æ—¶ï¼Œä½¿ç”¨art-templateæ¨¡æ¿å¼•æ“ï¼›express-art-templateä¸“é—¨ç”¨åœ¨Expressä¸­æŠŠart-templateæ•´åˆï¼Œä¸”express-art-templateä¾èµ–äº†art-template è€Œè¿™æ—¶å°±å¯ä»¥ä½¿ç”¨æ¨¡æ¿å¼•æ“çš„renderäº† app.engine('html', require('express-art-template')); app.get('/', (req, res) => { //å»æ‰¾viewsç›®å½•ä¸‹çš„404.html res.render('404.html'); }) æ¥è€Œæ ¹æ®å¯¼èˆªä¸€æ­¥ä¸€æ­¥æŒ‡å¼•ï¼Œè¿›è¡Œæ“ä½œå°±è¡Œäº† é‡å®šå‘æ³¨æ„ï¼šæœåŠ¡ç«¯é‡å®šå‘å¯¹å¼‚æ­¥è¯·æ±‚æ˜¯æ— æ•ˆçš„ï¼ˆè¡¨å•çš„å¼‚æ­¥æäº¤ï¼‰ï¼Œå¼‚æ­¥è¯·æ±‚çš„é‡å®šå‘åªèƒ½åœ¨å®¢æˆ·ç«¯é‡Œé¢å®ç°ï¼Œå¯ä»¥åœ¨ajaxçš„successé‡Œä½¿ç”¨ window.location.href = '/' åŸæ¥æ˜¯ res.statusCode = 302; res.setHeader('Location', '/'); //å“åº”å¤´çš„Loacationè·¯å¾„è®¾ç½®ä¸º '/' å³é¦–é¡µ res.end(); ç°åœ¨ï¼š res.redirect('/'); Expressè·å–è¡¨å•POSTè¯·æ±‚ä½“æ•°æ®å½“ä»¥postè¯·æ±‚/postçš„æ—¶å€™ï¼Œæ‰§è¡ŒæŒ‡å®šå‡½æ•°ï¼Œè·å–æ•°æ®çš„è¡¨å•formæ·»åŠ  action=è·¯å¾„, method=&quot;POST&quot; è¿™æ ·çš„è¯æˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨ä¸åŒçš„æ–¹æ³•ï¼Œè®©ä¸€ä¸ªè¯·æ±‚è·¯å¾„ä½¿ç”¨å¤šæ¬¡ app.post('/post', (req, res) => { // 1.è·å–è¡¨å•postæ•°æ® // 2.å¤„ç† // 3.å‘é€å“åº” }); å› ä¸ºexpresså†…ç½®æ²¡æœ‰è·å–è¡¨å•postçš„apiï¼Œæ‰€ä»¥éœ€è¦å€ŸåŠ©ç¬¬ä¸‰æ–¹æ’ä»¶ï¼Œåœ¨å®˜ç½‘-&gt;èµ„æº-&gt;body-parser å®˜ç½‘ç°åœ¨å·²ç»æœ‰äº†è·å–è¡¨å•postçš„API express.jsonï¼ŒåŸºäºbody-parser æ³¨æ„ï¼šexpress4ä¸å†æ”¯æŒbody-parser å¦‚æœä»æƒ³ä½¿ç”¨ï¼Œå¯ä»¥npm install express@3 å®‰è£… npm install --save body-parser ç„¶åè·Ÿç€å®˜ç½‘æŒ‡ç¤ºä¸€æ­¥ä¸€æ­¥è¿›è¡Œé…ç½® é…ç½®body-parserï¼Œåˆ™ä¼šåœ¨requestè¯·æ±‚å¯¹è±¡ä¸Šå¤šå‡ºä¸€ä¸ªbodyå±æ€§ï¼Œç„¶åæ­¤æ—¶æˆ‘ä»¬å¯ä»¥ä½¿ç”¨req.bodyè·å–è¡¨å•postè¯·æ±‚ä½“æ•°æ®äº† //å¼•åŒ… var bodyParser = require('body-parser'); //é…ç½®postæ’ä»¶body-parser // parse application/x-www-form-urlencoded app.use(bodyParser.urlencoded({ extended: false })); // parse application/json app.use(bodyParser.json()); app.post('/post', (req, res) => { // 1.è·å–è¡¨å•postæ•°æ® // 2.å¤„ç† // 3.å‘é€å“åº” console.log(req.body); //getä½¿ç”¨çš„æ˜¯req.query }); body-parserè¢«å¼ƒç”¨åæˆ‘ä»¬å¯ä»¥ç›´æ¥ä½¿ç”¨expressè‡ªå¸¦çš„ app.use(express.urlencoded({ extended: false })) app.use(express.json()) å®šåˆ¶404é¡µé¢åœ¨æŒ‚è½½è·¯ç”±app.use(router);ä¹‹åå¢åŠ  app.use(function(req, res) =&gt; {})å¤„ç†404é¡µé¢ï¼Œæ‰€æœ‰æœªå¤„ç†çš„è¯·æ±‚è·¯å¾„éƒ½ä¼šè·‘åˆ°è¿™é‡Œ expressæ“ä½œcookieä¸éœ€è¦ä»»ä½•ç¬¬ä¸‰æ–¹çš„åº“ app.get('/send', (req, res) => { const value = { name: 'Allen', sex: 'ç”·', age: 18 } res.cookie('message', JSON.stringify(value)) res.cookie('msg2', JSON.stringify(value), {maxAge: 1000 * 30}) //åœ¨æä¸€ä¸ª30ç§’è¿‡æœŸçš„çš„cookie }) ç„¶åå½“æœåŠ¡ç«¯è¯»å–å®¢æˆ·ç«¯æºå¸¦è¿‡æ¥çš„cookieéœ€è¦ç”¨åˆ°ä¸€ä¸ªåº“cookie-parser npm i cookie-parser const cookieParser = require('cookie-parser') app.use(cookieParser()) app.get('/receive', (req, res) => { console.log(req.cookies) const {message} = req.cookies; let a = JSON.parse(message.name) }) é™¤äº†ç”Ÿæˆcookieï¼Œè¿˜èƒ½åˆ é™¤æ‰cookie app.get('/delete', (req, res) => { //ç¬¬ä¸€ç§åˆ é™¤æ–¹æ³• res.cookie('message', '', {maxAge: 0}) //ç¬¬äºŒç§åˆ é™¤æ–¹æ³•ï¼š //res.clearCookie('message') }) expressä½¿ç”¨sessionnpm i express-session const session = require('express-session') app.use(session({ name: 'userid', //è®¾ç½®cookieçš„keyï¼Œé»˜è®¤ä¸ºconnect.sid secret: 'mistoryQianMing', //å‚ä¸åŠ å¯†çš„å­—ç¬¦ä¸²ï¼ˆåˆä¿—ç§°ç­¾åï¼‰ï¼ŒåŠ å¯†cookieä¼ è¾“çš„å­—æ®µ saveUninitialized: false, //æ˜¯å¦åœ¨å­˜å‚¨å†…å®¹ä¹‹å‰åˆ›å»ºå¯¹è¯ï¼Œæ„æ€å°±æ˜¯å½“æˆ‘ç›´æ¥æ­£å¸¸è¯·æ±‚/è®¿é—®æ—¶æ˜¯å¦ä¹Ÿç»™æˆ‘å¼€session //falseï¼šé™¤éæ‰§è¡Œäº†req.session.xx = xxxé€»è¾‘å†ç»™æˆ‘å­˜ resave: true, //æ¯æ¬¡è¯·æ±‚æ—¶ï¼Œå¼ºåˆ¶é‡æ–°ä¿å­˜sessionï¼Œå³ä½¿ä»–ä»¬æ²¡å˜åŒ–ï¼ˆç¨³å¦¥ï¼‰ cookie: { httpOnly: true, //å¼€å¯ä¹‹åå‰ç«¯æ— æ³•é€šè¿‡jsæ“ä½œcookie maxAge: 1000 * 30 //cookieè¿‡æœŸæ—¶é—´ } })) tipï¼š saveUninitializedï¼š å¼ºåˆ¶å°†â€œæœªåˆå§‹åŒ–â€çš„ä¼šè¯ä¿å­˜åˆ°å­˜å‚¨ä¸­ã€‚å½“ä¸€ä¸ªä¼šè¯æ˜¯æ–°çš„ä½†æœªè¢«ä¿®æ”¹æ—¶ï¼Œå®ƒæ˜¯æœªåˆå§‹åŒ–çš„ã€‚é€‰æ‹©falseå¯¹äºå®ç°ç™»å½•ä¼šè¯ã€å‡å°‘æœåŠ¡å™¨å­˜å‚¨ä½¿ç”¨æˆ–éµå®ˆåœ¨è®¾ç½® cookie ä¹‹å‰éœ€è¦è®¸å¯çš„æ³•å¾‹å¾ˆæœ‰ç”¨ã€‚é€‰æ‹©falseè¿˜æœ‰åŠ©äºè§£å†³ç«äº‰æ¡ä»¶ï¼Œå³å®¢æˆ·ç«¯åœ¨æ²¡æœ‰ä¼šè¯çš„æƒ…å†µä¸‹å‘å‡ºå¤šä¸ªå¹¶è¡Œè¯·æ±‚ã€‚ é»˜è®¤å€¼ä¸ºtrueï¼Œä½†ä¸æ¨èä½¿ç”¨é»˜è®¤å€¼ï¼Œå› ä¸ºé»˜è®¤å€¼å°†æ¥ä¼šæ›´æ”¹ã€‚è¯·ç ”ç©¶æ­¤è®¾ç½®å¹¶é€‰æ‹©é€‚åˆæ‚¨çš„ç”¨ä¾‹çš„è®¾ç½®ã€‚ æ­¤æ—¶æˆ‘ä»¬åœ¨æŸä¸ªè¯·æ±‚ä¸­æ‰§è¡Œä»¥ä¸‹æ­¥éª¤ ä¸ºæ­¤æ¬¡è¯·æ±‚å¼€è¾Ÿä¸€ä¸ªsessionç©ºé—´ å°†å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯äº§ç”Ÿçš„å¯¹è¯æ•°æ®å­˜å…¥sessionä¼šè¯ç©ºé—´ è·å–session id å°†session å­˜å…¥id ç„¶åè¿”å›cookie ä½†æ˜¯ä»¥ä¸Šæ­¥éª¤éƒ½ä¸€æ­¥æå®šï¼ //è¿™é‡Œçš„_idæ˜¯ä½¿ç”¨mongoDBå­˜å‚¨æ•°æ®æ—¶ï¼Œä¼šè‡ªåŠ¨ç”Ÿæˆçš„ï¼Œè¿™é‡Œçš„é€»è¾‘æ˜¯é€šè¿‡ç”¨æˆ·åå¯†ç åœ¨æ•°æ®åº“æŸ¥æ‰¾åŒ¹é…çš„dataï¼Œç„¶åç”¨_idæ¥å……å½“session idï¼Œå½“ç„¶ä½ ä¹Ÿå¯ä»¥æ¢æˆå…¶ä»–çš„ï¼Œæˆ–è€…è‡ªå·±å†™ä¸ªid //session._idè¿™ä¸ªæ˜¯å˜é‡åï¼Œå¯ä»¥éšä¾¿å–å app.get('/send', (req, res) => { req.session._id = data._id.toString() }) å½“æœåŠ¡ç«¯é€šè¿‡å®¢æˆ·ç«¯è¿”å›çš„session idéªŒè¯ä¼šè¯æ¶ˆæ¯æ—¶ è·å–cookieæºå¸¦è¿‡æ¥çš„session id æ ¹æ®session id åŒ¹é…sessionï¼Œæ­¤æ—¶æˆ‘ä»¬å¯ä»¥æ ¹æ®åŒ¹é…ç»“æœï¼Œè¦ä¹ˆä½¿ç”¨åŒ¹é…åˆ°çš„æ•°æ®ï¼Œè¦ä¹ˆå°±å»è®©å®¢æˆ·ç«¯é‡æ–°ç™»å½• //è¿™é‡Œæˆ‘ä»¬å½“æ—¶å­˜æ”¾äº†session._idï¼Œæ‰€ä»¥ç”¨_idå»å– app.get('/receive', (req, res) => { const { _id } = req.session //reqæºå¸¦è¿‡æ¥çš„cookieï¼š{key: userid, value: ç»è¿‡åŠ å¯†çš„session id} //æ ¹æ®_idå¯¹æ•°æ®åº“è¿›è¡ŒæŸ¥æ‰¾æ“ä½œã€‚ã€‚ã€‚ }) å¦‚æœæ˜¯é…åˆmongodbï¼Œåˆ™éœ€è¦ä¸‹è½½(è¿™ä¸€æ­¥æ˜¯é…åˆsessionæŒä¹…åŒ–çš„ï¼Œä¸éœ€è¦æŒä¹…åŒ–å¯ä¸ç”¨) npm i connect-mongo //å¯¼å…¥çš„æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œæ­¤æ—¶ä¼ å‚sessionä¼ è¿‡å»ï¼ŒåšsessionæŒä¹…åŒ– const MongoStore = require(\"connect-mongo\")(session); app.use(session({ //... store: new MongoStore({ //å¾€sessions_containeræ•°æ®åº“é‡Œå­˜å‚¨ï¼Œç„¶åä¿å­˜åœ¨sessionsé›†åˆé‡Œ url: \"mongodb://localhost:27017/sessions_container\", touchAfter: 24 * 3600, //ä¿®æ”¹é¢‘ç‡ï¼ˆä¾‹å¦‚24å°æ—¶å†…åªæ›´æ–°ä¸€æ¬¡ï¼‰,é˜²æ­¢è¿‡åº¦è®¿é—®æ•°æ®åº“é€ æˆå‹åŠ› }), })) crudæ¡ˆä¾‹å…ˆåˆå§‹åŒ– npm init -y è£…expressï¼šnpm i -S express å»º2ä¸ªæ–‡ä»¶å¤¹ï¼Œåˆ†åˆ«ä¸ºviewså’Œpublic è£…æ¨¡æ¿å¼•æ“ï¼šnpm install --save art-template express-art-template è£…bootstrapçš„cssï¼šnpm i -S bootstrap å¤–éƒ¨å¤‡ä¸Šä¸€ä¸ªindex.htmlã€db.json(ç”¨äºå­˜å‚¨æ•°æ®) å°†app.jsä½œä¸ºæ‰§è¡Œçš„jsæ–‡ä»¶ï¼Œè€Œrouter.jsä½œä¸ºè¾…ä½çš„è·¯ç”±jsæ–‡ä»¶ï¼Œå¹¶å°†å…¶å¼•å…¥app.jsï¼Œstudent.jsä½œä¸ºå¢åˆ æ”¹æŸ¥å°è£…çš„api è¯·æ±‚æ–¹æ³• è¯·æ±‚è·¯å¾„ getå‚æ•° postå‚æ•° å¤‡æ³¨ get /students æ¸²æŸ“é¡µé¢ get /students/new æ¸²æŸ“æ·»åŠ å­¦ç”Ÿ post /students/new nameã€ageã€colorã€hobbies å¤„ç†æ·»åŠ å­¦ç”Ÿè¯·æ±‚ get /students/edit id æ¸²æŸ“ç¼–è¾‘é¡µé¢ post /students/edit idã€nameã€ageã€colorã€hobbies å¤„ç†ç¼–è¾‘è¯·æ±‚ get /students/delete id å¤„ç†åˆ é™¤è¯·æ±‚ //app.js var express = require('express'); var router = require('./router.js'); var bodyParser = require('body-parser'); var app = express(); // ä¸€å®šè¦åœ¨æŒ‚è½½è·¯ç”±ä¹‹å‰é…ç½®å¥½æ¨¡æ¿å¼•æ“å’ŒbodyParser app.engine('html', require('express-art-template')); app.use(bodyParser.urlencoded({ extended: false })); app.use(bodyParser.json()); app.use('/node_modules/', express.static('./node_modules/')); app.use('/public/', express.static('./public/')); //æŒ‚è½½è·¯ç”± app.use(router); //è¿™é‡Œå¯ä»¥è®¾ç½®ä¸€ä¸ªå®šåˆ¶404é¡µé¢ï¼Œæ‰€æœ‰æœªå¤„ç†çš„è¯·æ±‚è·¯å¾„éƒ½ä¼šè·‘åˆ°è¿™é‡Œ //app.use(function(req, res) => {}) app.listen(5208, () => { console.log('5208 is running!!...'); }) expressæä¾›äº†ä¸€ç§æ›´å¥½çš„æ–¹å¼ï¼Œä¸“é—¨ç”¨æ¥åŒ…è£…è·¯ç”± 1.åˆ›å»ºä¸€ä¸ªè·¯ç”±å®¹å™¨ï¼Œå¯ä»¥æŠŠå®ƒçœ‹æˆæˆ‘ä»¬çš„å°å‹app 2.æŠŠè·¯ç”±éƒ½æŒ‚è½½åˆ°routerå®¹å™¨ä¸­ 3.åœ¨æˆ‘ä»¬çš„routerä¸­ï¼Œä¹Ÿå¯ä»¥é€šè¿‡ router.use(ä¸­é—´ä»¶)æ¥ä½¿ç”¨æˆ‘ä»¬çš„ä¸­é—´ä»¶ //å¤„ç†è·¯ç”±çš„router.jsæ–‡ä»¶ var fs = require('fs'); var express = require('express'); var Student = require('./student.js'); //è¿™æ ·ä¹Ÿä¸æ–¹ä¾¿æ¨¡å—åŒ– // module.exports = function (app) { // app.get('/students', (req, res) => { // }); // } var router = express.Router(); router.get('/students', (req, res) => { Student.find((err, data) => { if (err) { return res.status(500).send('Service err 500'); } // è¿›è¡Œæ•°æ®æ¸²æŸ“ res.render('index.html', { fruits: [ 'è‹¹æœ', 'é›ªæ¢¨', 'è¥¿ç“œ' ], students: data }); }) }); router.get('/students/new', (req, res) => { res.render('new.html'); }); router.post('/students/new', (req, res) => { // 1.è·å–è¡¨å•æ•°æ® // 2.å¤„ç†,å°†æ•°æ®ä¿å­˜ä¸db.jsonä¸­ï¼Œç”¨äºæŒä¹…åŒ–,å³å°†db.jsonè¯»å–å¤„ç†å•Šï¼Œè½¬å¯¹è±¡ï¼Œå¾€å¯¹è±¡ä¸­pushæ•°æ®ï¼Œå†è½¬å›å­—ç¬¦ä¸²ï¼Œå†æŠŠå­—ç¬¦ä¸²å†™å…¥æ–‡ä»¶ // 3.å‘é€å“åº” var student = req.body; Student.save(student, (err) => { if (err) { return res.status(500).send('Service err 500'); } res.redirect('/students'); }) }); router.get('/students/edit', (req, res) => { // 1.åœ¨å®¢æˆ·ç«¯å¤„ç†é“¾æ¥é—®é¢˜ï¼Œä½¿ç”¨&lt;a href=\"/students/edit?id={{ $value.id }}\"> // 2.è·å–ç¼–è¾‘çš„å­¦ç”Ÿid // 3.æ¸²æŸ“ç¼–è¾‘é¡µé¢ Student.findById(parseInt(req.query.id), (err, student) => { if (err) { return res.status(500).send('Service err 500'); } res.render('eidt.html', { student: student }) }) }); router.post('/students/edit', (req, res) => { Student.updateById(req.body, function (err) { if (err) { return res.status(500).send('Service err 500'); } res.redirect('/students'); }) }); router.get('/students/delete', (req, res) => { // è·å–åˆ é™¤çš„id // æ ¹æ®idï¼Œè¿›è¡Œåˆ é™¤ï¼Œç„¶åå‘é€å“åº” Student.remove(req.query.id, function (err) { if (err) { return res.status(500).send('Service err 500'); } res.redirect('/students'); }) }); // 3.å¯¼å‡º module.exports = router; student.jsç”¨äºçº¯ç²¹å¯¹æ–‡ä»¶å°è£…å¢åˆ æ”¹æŸ¥åŠŸèƒ½ åªå¤„ç†æ•°æ®ï¼Œä¸å…³å¿ƒä¸šåŠ¡ nodeçš„å¥¥ä¹‰æ‰€åœ¨ï¼šå°è£…å¼‚æ­¥api //student.js var fs = require('fs'); var dbPath = './db.json'; //1.è·å–å­¦ç”Ÿåˆ—è¡¨ // callbackçš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯errï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯ç»“æœ exports.find = function (callback) { //readFile çš„ç¬¬äºŒä¸ªå‚æ•°æ˜¯å¯é€‰çš„ï¼Œä¼ å…¥utf8åˆ™æŒ‰ç…§utf-8ç¼–ç è½¬æˆæ­£å¸¸å­—ç¬¦ fs.readFile(dbPath, 'utf8', function (err, data) { if (err) { return callback(err); } // å­—ç¬¦ä¸²è½¬å¯¹è±¡ callback(null, JSON.parse(data).students); }) }; // æ ¹æ®idè·å–å­¦ç”Ÿå¯¹è±¡ exports.findById = function (id, callback) { fs.readFile(dbPath, 'utf8', function (err, data) { if (err) { return callback(err); } // å­—ç¬¦ä¸²è½¬å¯¹è±¡ var students = JSON.parse(data).students; student = students.find((item, index) => { return item.id === parseInt(id); }); callback(null, student); }) } //2.ä¿å­˜å­¦ç”Ÿ exports.save = function (student, callback) { fs.readFile(dbPath, 'utf8', function (err, data) { if (err) { return callback(err); } // å­—ç¬¦ä¸²è½¬å¯¹è±¡ var students = JSON.parse(data).students; // å¤„ç†idå”¯ä¸€æ€§é—®é¢˜ student.id = students[students.length - 1].id + 1; students.push(student); // JavaScript å€¼(å¯¹è±¡æˆ–æ•°ç»„)è½¬æ¢ä¸º JSON å­—ç¬¦ä¸² var ret = JSON.stringify({ students: students }); ReRead(dbPath, ret, err, callback); }) }; //3.æ›´æ–°å­¦ç”Ÿ exports.updateById = function (student, callback) { fs.readFile(dbPath, 'utf8', function (err, data) { if (err) { return callback(err); } // å…ˆæŠŠnumberç±»å‹çš„ä¸‰ä¸ªå€¼ä»stringè½¬number student.id = parseInt(student.id); student.age = parseInt(student.age); student.color = parseInt(student.color); // å­—ç¬¦ä¸²è½¬å¯¹è±¡ var students = JSON.parse(data).students; // ä½¿ç”¨ES6çš„findæ–¹æ³•æ‰¾åˆ°idå¯¹åº”çš„å¯¹è±¡ var stu = students.find((item) => item.id === student.id); // éå†æ‹·è´å¯¹è±¡ for (let key in student) { stu[key] = student[key]; } // JavaScript å€¼(å¯¹è±¡æˆ–æ•°ç»„)è½¬æ¢ä¸º JSON å­—ç¬¦ä¸² var ret = JSON.stringify({ students: students }); ReRead(dbPath, ret, err, callback); }) }; //4.åˆ é™¤å­¦ç”Ÿ exports.remove = function (id, callback) { fs.readFile(dbPath, 'utf8', function (err, data) { if (err) { return callback(err); } // å­—ç¬¦ä¸²è½¬å¯¹è±¡ var students = JSON.parse(data).students; // è·å–è¦åˆ é™¤çš„idå¯¹è±¡çš„ä¸‹æ ‡ var deleteId = students.findIndex((item) => item.id === parseInt(id)); // åˆ é™¤è¯¥idçš„å¯¹è±¡ students.splice(deleteId, 1); var ret = JSON.stringify({ students: students }); ReRead(dbPath, ret, err, callback); }) }; // é‡æ–°è¯»å…¥çš„api function ReRead(dbPath, ret, err, callback) { fs.writeFile(dbPath, ret, (err) => { if (err) { return callback(err); } // æˆåŠŸä¸ºnull callback(null); }); } å…³äºExpresscookieå’ŒSessionåœ¨expressä¸­ï¼Œé»˜è®¤ä¸æ”¯æŒSessionå’ŒCookie sessionæ˜¯åŸºäºcookieå®ç°çš„ ä½†æ˜¯æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¤§ä¸‰æ–¹ä¸­é—´ä»¶ï¼šexpress-sessionæ¥è§£å†³ npm install express-session é…ç½®ï¼š var session = require('express-session'); app.use(session({ //é…ç½®åŠ å¯†å­—ç¬¦ä¸² secret: 'keyboard cat', resave: false, //æ— è®ºä½ æ˜¯å¦é€‚ç”¨session,æˆ‘éƒ½ç»™ä½ åˆ†é…ä¸€æŠŠé’¥åŒ™ saveUninitialized: true })); æ·»åŠ sessionæ•°æ®ï¼šreq.session.foo = &#39;xxx&#39; è®¿é—®sessionæ•°æ®ï¼šreq.session.foo è¿™æ—¶å€™ï¼ŒæœåŠ¡å™¨åªéœ€è¦è°ƒç”¨req.session.xxå°±å¯ä»¥ä½¿ç”¨sessionä¿å­˜çš„æ•°æ®äº† ä¸­é—´ä»¶ä½¿ç”¨expressæ¡†æ¶ã€ä¸€äº›å…¶ä»–çš„APIä¹‹åï¼Œä¼ è¿›æ¥çš„reqå’Œresç»è¿‡äº†ä¸€äº›ä¸­é—´ä»¶ï¼ˆå‡½æ•°æ–¹æ³•ï¼‰ï¼Œä½¿å¾—reqå’Œreså†…éƒ¨æ‹¥æœ‰äº†ä¸€äº›å±æ€§ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨req.bodyã€req.queryã€req.session ç­‰ï¼Œå¹¶ä¸”åœ¨æŒ‚è½½è·¯ç”±åï¼Œåœ¨è·¯ç”±çš„jsæ–‡ä»¶ä¸­ï¼Œä¸ç”¨å†æ¬¡å¼•ç”¨ï¼ˆrequireï¼‰è¿™äº›apiæ–¹æ³•ï¼ŒåŒæ ·å¯ä»¥ä½¿ç”¨req.bodyã€req.queryã€req.session ç­‰å±æ€§ï¼ˆå…¶å®ä¹Ÿå¯ä»¥ç†è§£ä¸ºï¼Œreqã€resç­‰å‚æ•°ä¼ è¿›æ¥è·¯ç”±å™¨jsæ–‡ä»¶æ—¶ï¼Œå·²ç»è¢«èµ‹äºˆä»¥ä¸Šå±æ€§ï¼Œé¡µé¢ä¸ç”¨å…³å¿ƒå‚æ•°ä»ä¸­é—´ä»¶å¾—åˆ°çš„å±æ€§ï¼Œè€Œæ˜¯è¦å…³å¿ƒæ˜¯å¦éœ€è¦å¼•åŒ…æ‰èƒ½ä½¿ç”¨æ–¹æ³•ï¼‰ ä¸­é—´ä»¶æœ¬èº«å°±æ˜¯ä¸€ä¸ªæ–¹æ³•ï¼Œå®ƒæœ‰ä¸‰ä¸ªå‚æ•°ï¼šrequestã€responseã€nextï¼ˆä½¿ç”¨ä¸‹ä¸€ä¸ªä¸­é—´ä»¶ï¼‰ å¦‚æœä¸€ä¸ªè¯·æ±‚è¿›å…¥ä¸­é—´ä»¶ï¼Œä¸è°ƒç”¨nextåˆ™ä¼šåœç•™åœ¨å½“å‰ä¸­é—´ä»¶ï¼Œè°ƒç”¨äº†nextåç»§ç»­å‘åæ‰¾åˆ°ç¬¬ä¸€ä¸ªåŒ¹é…çš„ä¸­é—´ä»¶ï¼ˆå¹³å¸¸æˆ‘ä»¬çœ‹åˆ°å¾ˆå¤šç»„ä»¶å¥½åƒæ²¡æœ‰nextï¼Œå…¶å®å·²ç»å§nextå°è£…å¥½äº†ï¼‰ ä¸ES6çš„Generatorä¸­çš„next()ç±»ä¼¼ åœ¨expressä¸­ï¼Œå¯¹ä¸­é—´ä»¶æœ‰å‡ ç§åˆ†ç±»ï¼š ï¼ˆ1ï¼‰ä¸å…³å¿ƒè¯·æ±‚è·¯å¾„å’Œè¯·æ±‚æ–¹æ³•çš„ä¸­é—´ä»¶ï¼Œä¹Ÿå°±æ˜¯ä»»ä½•è¯·æ±‚éƒ½ä¼šè¿›å…¥è¿™ä¸ªä¸­é—´ä»¶ app.use(function(req, res, next)) ï¼ˆ2ï¼‰å…³å¿ƒè¯·æ±‚è·¯å¾„çš„ä¸­é—´ä»¶ï¼Œä»¥â€™/xxxâ€™å¼€å¤´ï¼Œéœ€è¦åŒ¹é…æ‰ä¼šè¿›å…¥æ­¤ä¸­é—´ä»¶ï¼Œå¦‚æœä¸åŒ¹é…è‡ªåŠ¨è·³è¿‡ï¼Œå»ä¸‹ä¸€ä¸ªä¸­é—´ä»¶ app.use(&#39;/xx&#39;, function(req, res, next)) ï¼ˆ3ï¼‰ä¸¥æ ¼åŒ¹é…è¯·æ±‚æ–¹æ³•å’Œè¯·æ±‚è·¯å¾„çš„ä¸­é—´ä»¶ app.get() app.post() //127.0.0.1:5208/b app.use(function (req, res, next) { console.log(1); next(); }); app.use('/a', function (req, res, next) { console.log('a'); }); app.use('/b', function (req, res, next) { console.log('b'); }); app.use(function (req, res, next) { console.log(3); }); //è¾“å‡º: 1 b ä¸Šæ–¹ä¸ºé”™è¯¯çš„ä»£ç ï¼Œæ²¡æœ‰è°ƒç”¨nextï¼Œå¯¼è‡´åœé¡¿åœ¨ä¸­é—´ä»¶ä¸­ ä¸‹æ–¹åˆ©ç”¨nextå¤„ç†å‘ç”Ÿé”™è¯¯ï¼š //å½“è°ƒç”¨nextçš„æ—¶å€™ï¼Œå¦‚æœä¼ é€’äº†å‚æ•°ï¼Œåˆ™ç›´æ¥å¾€åæ‰¾åˆ°å¸¦æœ‰å››ä¸ªå‚æ•°çš„åº”ç”¨ç¨‹åºçº§åˆ«ä¸­é—´ä»¶ //if (err) { // next(err) // } //ä¸­é—´ä»¶è¦æ”¾åˆ°æœ€åï¼Œæ­é…404å¤„ç†ä¸€èµ·ä½¿ç”¨ app.use(function (req, res, next) { res.render('404.html') }); app.use(function (err, req, res, next) { res.status(500).send(err.message) }); expresså®ç°ä¸­é—´ä»¶æœºåˆ¶å‰æï¼š expresså‡½æ•°è°ƒç”¨è¿”å›ä¸€ä¸ªappå®ä¾‹ åœ¨expresså‡½æ•°å†…éƒ¨å®šä¹‰ä¸€ä¸ªæ•°ç»„æ¥å­˜å‚¨ä¸­é—´ä»¶å‡½æ•°ï¼ˆé˜Ÿåˆ—æ•°ç»„ï¼‰ constructor() { // å­˜æ”¾ä¸­é—´ä»¶çš„åˆ—è¡¨ this.routes = { all: [],// é€šç”¨çš„ä¸­é—´ä»¶ get: [],// getè¯·æ±‚çš„ä¸­é—´ä»¶ post: [],// postè¯·æ±‚çš„ä¸­é—´ä»¶ }; } åœ¨expresså‡½æ•°å†…éƒ¨å®šä¹‰ä¸€ä¸ªappå‡½æ•° åœ¨appå‡½æ•°çš„å†…éƒ¨å®šä¹‰ä¸€ä¸ªå˜é‡iä¿å­˜æ‰§è¡Œçš„ä¸­é—´ä»¶çš„ä½ç½®ã€‚ åœ¨appå‡½æ•°ä¸­å®šä¹‰ä¸€ä¸ªnextæ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•é€šè¿‡iå€¼è‡ªå¢è°ƒç”¨ä¸­é—´ä»¶ åœ¨appå‡½æ•°å†…éƒ¨è°ƒç”¨next åœ¨appå‡½æ•°ä¸Šå®šä¹‰ä¸€ä¸ªuseæ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•å¯ä»¥å°†ä¸­é—´ä»¶å‡½æ•°pushè¿›ä¸­é—´ä»¶æ•°ç»„ä¸­ã€‚ ä¸€ä¸ªå°æ¡ˆä¾‹åŠ æ·±ä¸­é—´ä»¶çš„ä½œç”¨å’Œå°è±¡ function middlewareA(req, res, next) { console.log('middlewareA before next()'); next(); console.log('middlewareA after next()'); } function middlewareB(req, res, next) { console.log('middlewareB before next()'); next(); console.log('middlewareB after next()'); } function middlewareC(req, res, next) { console.log('middlewareC before next()'); next(); console.log('middlewareC after next()'); } app.use(middlewareA); app.use(middlewareB); app.use(middlewareC); æ‰§è¡Œï¼šAå¼€å§‹ -&gt; Bå¼€å§‹ -&gt; Cå¼€å§‹ -&gt; Cç»“æŸ -&gt; Bç»“æŸ -&gt; Aç»“æŸ å…¶å®ä¹Ÿå¯ä»¥ä»¥å¼‚æ­¥è°ƒç”¨çš„æ–¹å¼çœ‹å¾…ä¸­é—´ä»¶çš„æ‰§è¡Œé¡ºåº const fn = async (ctx, next) => { console.log(1); await next(); console.log(2); }","categories":[{"name":"å‰ç«¯","slug":"å‰ç«¯","permalink":"https://taylor12138.github.io/categories/%E5%89%8D%E7%AB%AF/"}],"tags":[],"author":"Hello"},{"title":"NPMå°è§£","slug":"NPMå°è§£","date":"2021-01-30T16:00:00.000Z","updated":"2023-06-12T08:53:52.458Z","comments":true,"path":"2021/01/31/npm-xiao-jie/","link":"","permalink":"https://taylor12138.github.io/2021/01/31/npm-xiao-jie/","excerpt":"","text":"1.Nodejsçš„åŒ…é€šä¿—æ¥è¯´ï¼Œå•ä¸ªjsæ–‡ä»¶ç®—ä¸€ä¸ªæ¨¡å—ï¼Œæ”¾åœ¨ä¸€ä¸ªæ–‡ä»¶å¤¹é‡Œå°±æ˜¯ä¸€ä¸ªåŒ…äº† CommonJS çš„åŒ…è§„èŒƒç”±åŒ…ç»“æ„å’ŒåŒ…æè¿°ä¸¤ä¸ªéƒ¨åˆ†ç»„æˆ åŒ…ç»“æ„ï¼šç”¨äºç»„ç»‡åŒ…ä¸­çš„å„ç§æ–‡ä»¶ â€‹ -package.json æè¿°æ–‡ä»¶ ï¼ˆimportantï¼‰ â€‹ -bin å¯æ‰§è¡ŒäºŒè¿›åˆ¶æ–‡ä»¶ â€‹ -lib jsä»£ç  â€‹ -doc æ–‡æ¡£ â€‹ -test å•å…ƒæµ‹è¯• åŒ…æè¿°æ–‡ä»¶ï¼ˆä¸Šé¢çš„é‚£ä¸ª-package.json æè¿°æ–‡ä»¶ï¼‰ï¼šæè¿°åŒ…çš„ç›¸å…³ä¿¡æ¯ï¼Œä»¥ä¾›å¤–éƒ¨è¯»å–åˆ†æã€‚å®ƒç”¨äºè¡¨è¾¾éä»£ç ç›¸å…³ä¿¡æ¯ï¼Œæ˜¯ä¸€ä¸ªjsonæ ¼å¼çš„æ–‡ä»¶ï¼Œå®é™…ä¸ŠåŠ è½½åŒ…æ—¶ä½¿ç”¨çš„åŸåˆ™æ˜¯ï¼šnode_modules/express/package.json main, è€Œä¸”å®ƒå…¶ä¸­ä¿å­˜ç€ååˆ†é‡è¦çš„ç¬¬ä¸‰æ–¹åŒ…ä¾èµ–é¡¹ä¿¡æ¯ï¼ˆdependenciesï¼‰ å¹¶ä¸”å»ºè®®æ¯ä¸ªé¡¹ç›®é‡Œå¸¦ä¸€ä¸ªï¼ˆæœ‰ä¸”åªæœ‰ä¸€ä¸ªï¼‰package.jsonæ–‡ä»¶npm init npm init -y é‡Œé¢çš„-yå°±æ˜¯yesçš„æ„æ€ï¼Œåœ¨initçš„æ—¶å€™çœå»äº†æ•²å›è½¦çš„æ­¥éª¤ï¼Œç”Ÿæˆçš„é»˜è®¤çš„package.json 2.package.jonè§£æï¼ˆæ‚ç¢ï¼‰npmåŒ…å‘½åï¼š è‹¥åŒ…åç§°ä¸­å­˜åœ¨ä¸€äº›ç¬¦å·ï¼Œå°†ç¬¦å·å»é™¤åä¸å¾—ä¸ç°æœ‰åŒ…åé‡å¤ ä¾‹å¦‚ï¼šç”±äºreact-nativeå·²ç»å­˜åœ¨ï¼Œreact.nativeã€reactnativeéƒ½ä¸å¯ä»¥å†åˆ›å»ºã€‚ å¦‚æœä½ çš„åŒ…åä¸ç°æœ‰çš„åŒ…åå¤ªç›¸è¿‘å¯¼è‡´ä½ ä¸èƒ½å‘å¸ƒè¿™ä¸ªåŒ…ï¼Œé‚£ä¹ˆæ¨èå°†è¿™ä¸ªåŒ…å‘å¸ƒåˆ°ä½ çš„ä½œç”¨åŸŸä¸‹ã€‚ ä¾‹å¦‚ï¼šç”¨æˆ·å conardï¼Œé‚£ä¹ˆä½œç”¨åŸŸä¸º @conardï¼Œå‘å¸ƒçš„åŒ…å¯ä»¥æ˜¯@conard/reactã€‚ mainå±æ€§ï¼š main å±æ€§å¯ä»¥æŒ‡å®šç¨‹åºçš„ä¸»å…¥å£æ–‡ä»¶ { \"main\": \"lib/index.js\", } scriptå±æ€§ scripts ç”¨äºé…ç½®ä¸€äº›è„šæœ¬å‘½ä»¤çš„ç¼©å†™ package.jsonå’Œpackage-lock.jsonnpm 5ä»¥å‰æ˜¯ä¸ä¼šæœ‰package-lock.jsonè¿™ä¸ªæ–‡ä»¶çš„ npm 5 ä»¥åæ‰åŠ å…¥ ä»å®‰è£…ä¸Šçœ‹ï¼Œnpméƒ½ä¼šç”Ÿæˆæˆ–æ›´æ–°package-lock.jsonè¿™ä¸ªæ–‡ä»¶ npm 5 ç‰ˆæœ¬ä»¥åçš„å®‰è£…åŒ…ï¼Œä¸ç”¨åŠ â€“saveæ·»åŠ ä¾èµ–ï¼Œå®ƒä¼šè‡ªåŠ¨ä¿å­˜ä¾èµ– å®ƒä¼šè‡ªåŠ¨åˆ›å»ºæˆ–è€…æ›´æ–°package-lock.json package-lock.jsoné‡Œé¢ä¿å­˜çš„æ˜¯node_modulesæ‰€æœ‰åŒ…çš„ä¾èµ–ï¼ŒåŒ…æ‹¬ä¾èµ–çš„åŒ…é‡Œpackage.jsonæ‰€ä¾èµ–çš„åŒ…åï¼ˆå¥—å¨ƒï¼‰ å› æ­¤é‡æ–°npm installæ—¶é€Ÿåº¦ä¼šæœ‰æ‰€æå‡ ä»æ–‡ä»¶ä¸Šçœ‹ lockæ˜¯ç”¨æ¥é”å®šç‰ˆæœ¬çš„ï¼Œå¦‚æœå½“å‰é¡¹ç›®ä¾èµ–äº†1.1ç‰ˆæœ¬ï¼Œä½†æ˜¯é‡æ–°npm install å…¶å®ä¼šç»™ä½ ä¸‹è½½æœ€æ–°ç‰ˆæœ¬ï¼Œè€Œä¸æ˜¯1.1 è€Œpackage-lock.jsonçš„å¦ä¸€ä¸ªä½œç”¨å°±æ˜¯é”å®šç‰ˆæœ¬å·ï¼Œé˜²æ­¢è‡ªåŠ¨å‡çº§æœ€æ–°ç‰ˆ lockçš„ lockfileVersion lockfileVersion å­—æ®µæ¥æŒ‡å®šçš„ lock æ ¼å¼çš„ç‰ˆæœ¬ npm5ä¹‹åè®¾ç½®ä¸º1ï¼Œ ä»¥å‰çš„ lock æ ¼å¼ä»ç„¶æ”¯æŒå¹¶è¢«è¯†åˆ«ä¸ºç‰ˆæœ¬ 0 ã€‚ è€Œåæ¥ä» NPM 7 å‘å¸ƒä»¥æ¥ï¼Œä¸€ä¸ªæ–°çš„ package-lock.json æ–‡ä»¶è¢«é‡æ–°ç”Ÿæˆä¸ºä¸åŒçš„ç»“æ„ã€‚ä» lockfileVersion 1 åˆ° 2ï¼Œä»è€Œå…¼å®¹npm 6ç”¨æˆ·ï¼Œå¹¶ä¸”ä¸å†å¿½ç•¥ yarn.lock ç¬¦å·\"@music/mobile-toast\": \"ï½2.1.13\", \"@music/mobile-url\": \"^4.0.6\", 1.^æ’å…¥ç¬¦å· ä»–å°†ä¼šæŠŠå½“å‰åº“çš„ç‰ˆæœ¬æ›´æ–°åˆ°å½“å‰ä¸»ç‰ˆæœ¬ï¼ˆä¹Ÿå°±æ˜¯ç¬¬ä¸€ä½æ•°å­—ï¼‰ä¸­æœ€æ–°çš„ç‰ˆæœ¬ã€‚æ”¾åˆ°æˆ‘ä»¬çš„ä¾‹å­ä¸­å°±æ˜¯ï¼šâ€axiosâ€: â€œ^0.18.0â€, è¿™ä¸ªåº“ä¼šå»åŒ¹é…0.x.xä¸­æœ€æ–°çš„ç‰ˆæœ¬ï¼Œä½†æ˜¯ä»–ä¸ä¼šè‡ªåŠ¨æ›´æ–°åˆ°1.0.0ã€‚ 2.æ³¢æµªç¬¦å· ä»–ä¼šæ›´æ–°åˆ°å½“å‰æ¬¡ç‰ˆæœ¬å·ï¼ˆä¹Ÿå°±æ˜¯ä¸­é—´çš„é‚£ä½æ•°å­—ï¼‰ä¸­æœ€æ–°çš„ç‰ˆæœ¬ã€‚æ”¾åˆ°æˆ‘ä»¬çš„ä¾‹å­ä¸­å°±æ˜¯ï¼šâ€cross-envâ€: â€œ5.2.0â€ï¼Œè¿™ä¸ªåº“ä¼šå»åŒ¹é…æ›´æ–°åˆ°5.2.xçš„æœ€æ–°ç‰ˆæœ¬ï¼Œå¦‚æœå‡ºäº†ä¸€ä¸ªæ–°çš„ç‰ˆæœ¬ä¸º5.3.0ï¼Œåˆ™ä¸ä¼šè‡ªåŠ¨å‡çº§ã€‚æ³¢æµªç¬¦å·æ˜¯æ›¾ç»npmå®‰è£…æ—¶å€™çš„é»˜è®¤ç¬¦å·ï¼Œç°åœ¨å·²ç»å˜ä¸ºäº†æ’å…¥ç¬¦å·ã€‚ NPMå‘½ä»¤åŸºç¡€ï¼ˆNode Package Managerï¼‰ CommonJSåŒ…è§„èŒƒæ—¶ç†è®ºï¼ŒNPMæ˜¯å…¶ä¸­ä¸€ç§å®è·µï¼Œæ˜¯NodeåŒ…ç®¡ç†å™¨ å¯¹äºNodeè€Œè¨€ï¼ŒNPMå¸®åŠ©å…¶å®Œæˆç¬¬ä¸‰æ–¹æ¨¡å—çš„å‘å¸ƒï¼Œå®‰è£…å’Œä¾èµ–ï¼ˆA-&gt;B-&gt;Cï¼Œä¸‹è½½Cç›´æ¥A, Bä¹Ÿä¸‹ï¼‰ï¼Œå€ŸåŠ©NPMï¼ŒNodeä¸ç¬¬ä¸‰æ–¹æ¨¡å—ä¹‹é—´å½¢æˆè‰¯å¥½çš„ä¸€ä¸ªç”Ÿæ€ç³»ç»Ÿï¼ˆå®‰è£…äº†nodeä»¥åï¼Œè‡ªå¸¦å®‰è£…npmï¼‰ åœ¨cmdå‘½ä»¤è¡Œçª—å£ï¼š npm -v æŸ¥çœ‹ç‰ˆæœ¬ ï¼ˆæˆ–è€…åŒ…å --versionï¼‰ npm å¸®åŠ©è¯´æ˜ npm search åŒ…å æœç´¢åŒ… npm why xxx --long æŸ¥çœ‹å½“å‰é¡¹ç›®å¯¹xxxåŒ…çš„ä¾èµ–å…³ç³» å®‰è£… npm install ä¸‹è½½å½“å‰é¡¹ç›®æ‰€ä¾èµ–çš„åŒ…ï¼ˆæ ¹æ®package.jsoné…ç½®é‡Œçš„ä¾èµ–ä¸‹è½½ï¼‰ npm install åŒ…å / npm i åŒ…å å½“å‰ç›®å½•å®‰è£…åŒ…ï¼ˆå¯ä»¥å…ˆåˆ›å»ºä¸€ä¸ªæ–‡ä»¶å¤¹ï¼‰ï¼ˆå°¾éƒ¨åŠ --saveï¼Œåˆ™ä¸ºç”Ÿäº§ç¯å¢ƒæ—¶ä¾èµ–ï¼Œåˆ™æ·»åŠ åˆ°å½“å‰package.jsonçš„ä¾èµ–é‡Œï¼‰ å¦‚æœå°¾éƒ¨åŠ  --save-devåˆ™ä¸ºå¼€å‘æ—¶ä¾èµ– npm install åŒ…å -g å…¨å±€æ¨¡å¼å®‰è£…åŒ…ï¼ˆä¸€èˆ¬éƒ½æ˜¯è®¡ç®—æœºé‡Œçš„å·¥å…·ï¼‰ å¦‚æœæœ¬èº«ç”µè„‘ä¸Šæœ‰è¯¥åŒ…ï¼Œåˆ™ç›´æ¥ npm install åŒ…ååˆ™ä¼šç›´æ¥ä¸‹è½½æœ€æ–°ç‰ˆæœ¬ åˆ é™¤ npm remove åŒ…å / npm r åŒ…å åˆ é™¤åŒ… ï¼ˆè¿™ä¸ªå¥½åƒæ˜¯æ—§ç‰ˆçš„ï¼‰ npm uninstall æ¨¡å—ï¼šåˆ é™¤æ¨¡å—ï¼Œä½†ä¸åˆ é™¤æ¨¡å—ç•™åœ¨package.jsonä¸­çš„å¯¹åº”ä¿¡æ¯ npm uninstall æ¨¡å— --save åˆ é™¤æ¨¡å—ï¼ŒåŒæ—¶åˆ é™¤æ¨¡å—ç•™åœ¨package.jsonä¸­dependenciesä¸‹çš„å¯¹åº”ä¿¡æ¯ npm uninstall æ¨¡å— --save-dev åˆ é™¤æ¨¡å—ï¼ŒåŒæ—¶åˆ é™¤æ¨¡å—ç•™åœ¨package.jsonä¸­devDependenciesä¸‹çš„å¯¹åº”ä¿¡æ¯ æŸ¥çœ‹åŒ…ç‰ˆæœ¬npm view &lt;pkg&gt; version æŸ¥çœ‹åŒ…ç‰ˆæœ¬npm view &lt;pkg&gt; versions æŸ¥çœ‹åŒ…æ›´å¤šå†å²ç‰ˆæœ¬ npm i module_name -S = &gt; npm install module_name --save å†™å…¥åˆ° dependencies å¯¹è±¡ npm i module_name -D =&gt; npm install module_name --save-dev å†™å…¥åˆ° devDependencies å¯¹è±¡ npm i module_name -g å…¨å±€å®‰è£… npm i module_name@latest å®‰è£…æœ€æ–°ç‰ˆæœ¬é•œåƒæºé€šè¿‡ npm config set è¿›è¡Œnpmçš„é…ç½® æ¯”å¦‚é…ç½®é•œåƒæº npm config set åŒ…å:registry é…ç½®çš„ç½‘å€ # æŒ‡å®š åŒ…å èµ° é…ç½®çš„ç½‘å€å†™çš„é•œåƒæºæŸ¥çœ‹å½“å‰æº npm config list npm5ä»¥åçš„â€“saveåœ¨ç‰ˆæœ¬ 5 ä¹‹å‰ï¼ŒNPM åªæ˜¯node_modulesé»˜è®¤å®‰è£…äº†ä¸€ä¸ªåŒ…ã€‚å½“æ‚¨å°è¯•ä¸ºæ‚¨çš„åº”ç”¨ç¨‹åº/æ¨¡å—å®‰è£…ä¾èµ–é¡¹æ—¶ï¼Œæ‚¨éœ€è¦å…ˆå®‰è£…å®ƒä»¬ï¼Œç„¶åå°†å®ƒä»¬ï¼ˆè¿åŒé€‚å½“çš„ç‰ˆæœ¬å·ï¼‰æ·»åŠ åˆ°dependenciesæ‚¨çš„package.json. è¯¥--saveé€‰é¡¹æŒ‡ç¤º NPM è‡ªåŠ¨å°†åŒ…åŒ…å«åœ¨dependenciesæ‚¨çš„éƒ¨åˆ†ä¸­package.jsonï¼Œä»è€Œä¸ºæ‚¨èŠ‚çœäº†é¢å¤–çš„æ­¥éª¤ã€‚ æ­¤å¤–ï¼Œè¿˜æœ‰ä¸€äº›è¡¥å……é€‰é¡¹--save-devï¼Œ--save-optionalå®ƒä»¬åˆ†åˆ«å°†åŒ…ä¿å­˜åœ¨devDependencieså’Œä¸‹optionalDependenciesã€‚è¿™åœ¨å®‰è£…ä»…å¼€å‘åŒ…ï¼ˆå¦‚gruntæµ‹è¯•åº“ï¼‰æ—¶å¾ˆæœ‰ç”¨ã€‚ ä½†æ˜¯ 5çº§ä»¥ä¸Šæ›´æ–°ï¼š ä»npm 5.0.0å¼€å§‹ï¼Œå·²å®‰è£…çš„æ¨¡å—é»˜è®¤æ·»åŠ ä¸ºä¾èµ–é¡¹ï¼Œå› æ­¤--saveä¸å†éœ€è¦è¯¥é€‰é¡¹ã€‚å…¶ä»–ä¿å­˜é€‰é¡¹ä»ç„¶å­˜åœ¨ï¼Œå¹¶åˆ—åœ¨.npm install npm 5ä»¥åçš„installæ—©æœŸï¼šnpm å¤„ç†ä¾èµ–çš„æ–¹å¼ç®€å•ç²—æš´ï¼Œä»¥é€’å½’çš„å½¢å¼ï¼Œä¸¥æ ¼æŒ‰ç…§ package.json ç»“æ„ä»¥åŠå­ä¾èµ–åŒ…çš„ package.json ç»“æ„å°†ä¾èµ–å®‰è£…åˆ°ä»–ä»¬å„è‡ªçš„ node_modules ä¸­ã€‚ç›´åˆ°æœ‰å­ä¾èµ–åŒ…ä¸åœ¨ä¾èµ–å…¶ä»–æ¨¡å—ã€‚ è¿™æ ·å­å±‚çº§ç»“æ„ä¼šæ¯”è¾ƒæ˜æ˜¾ï¼Œ ä½†æ˜¯ï¼å¦‚æœä¸åŒæ¨¡å—å¼•ç”¨çš„æ˜¯åŒä¸€ä¸ªæ¨¡å—ï¼Œåˆ™ä¼šäº§ç”Ÿå¤§é‡å†—æ‚ åœ¨ Windows ç³»ç»Ÿä¸­ï¼Œæ–‡ä»¶è·¯å¾„æœ€å¤§é•¿åº¦ä¸º260ä¸ªå­—ç¬¦ï¼ŒåµŒå¥—å±‚çº§è¿‡æ·±å¯èƒ½å¯¼è‡´ä¸å¯é¢„çŸ¥çš„é—®é¢˜ã€‚ ä¸­æœŸï¼ˆnpm3ï¼‰ï¼šé€‰æ‹©æ‰å¹³åŒ–çš„ç»“æ„ï¼Œæ— è®ºæ˜¯ç›´æ¥ä¾èµ–è¿˜æ˜¯å­å­™ä¾èµ–ï¼Œéƒ½æ”¾åœ¨node_moduleså½“ä¸­ï¼Œè€Œæ­¤æ—¶æ¨¡å—çš„æœç´¢æ¨¡å¼ä¸ºï¼š åœ¨å½“å‰æ¨¡å—è·¯å¾„ä¸‹æœç´¢ åœ¨å½“å‰æ¨¡å— node_modules è·¯å¾„ä¸‹æœç´  åœ¨ä¸Šçº§æ¨¡å—çš„ node_modules è·¯å¾„ä¸‹æœç´¢ ä½†æ˜¯ï¼šå½“å®‰è£…åˆ°ç›¸åŒæ¨¡å—æ—¶ï¼Œåˆ¤æ–­å·²å®‰è£…çš„æ¨¡å—ç‰ˆæœ¬æ˜¯å¦ç¬¦åˆæ–°æ¨¡å—çš„ç‰ˆæœ¬èŒƒå›´ï¼Œå¦‚æœç¬¦åˆåˆ™è·³è¿‡ï¼Œä¸ç¬¦åˆåˆ™åœ¨å½“å‰æ¨¡å—çš„ node_modules ä¸‹å®‰è£…è¯¥æ¨¡å—ã€‚ è¿™ä½¿å¾—æ”¾ç½®é¡ºåºåˆ™å†³å®šäº† æ€»node_modules çš„ä¾èµ–ç»“æ„ ç„¶åå°±ä¼šå‡ºç°ï¼ˆbuffer2ä¾èµ– base64-js1.0.3ï¼Œbufferä¾èµ– base64-js@1.0.2 ï¼‰ å‡å¦‚æ²¡æœ‰ä¾èµ–äº† base64-js@1.0.1ï¼Œå‡ºç°ä¸¤ç§æƒ…å†µ ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœä¾èµ–ä¸åŒç‰ˆæœ¬ï¼Œæœ‰å¯èƒ½å¯¼è‡´ä¾èµ–ç»“æ„çš„ä¸ç¡®å®šæ€§ï¼Œè€Œè¿™ç§ä¸ç¡®å®šæ€§å¯èƒ½ä¼šç»™ç¨‹åºå¸¦æ¥ä¸å¯é¢„çŸ¥çš„é—®é¢˜ã€‚ åæœŸï¼šä¸ºäº†è§£å†³ npm install çš„ä¸ç¡®å®šæ€§é—®é¢˜ï¼Œåœ¨ npm 5.x ç‰ˆæœ¬æ–°å¢äº† package-lock.json æ–‡ä»¶ï¼Œè€Œå®‰è£…æ–¹å¼è¿˜æ²¿ç”¨äº† npm 3.x çš„æ‰å¹³åŒ–çš„æ–¹å¼ã€‚ package-lock.json çš„ä½œç”¨æ˜¯é”å®šä¾èµ–ç»“æ„ï¼Œå³åªè¦ä½ ç›®å½•ä¸‹æœ‰ package-lock.json æ–‡ä»¶ï¼Œé‚£ä¹ˆä½ æ¯æ¬¡æ‰§è¡Œ npm install åç”Ÿæˆçš„ node_modules ç›®å½•ç»“æ„ä¸€å®šæ˜¯å®Œå…¨ç›¸åŒã€ä¸€ä¸€å¯¹åº”çš„ã€‚ å¹¶ä¸”ï¼Œ package-lock.json ä¸­å·²ç»ç¼“å­˜äº†æ¯ä¸ªåŒ…çš„å…·ä½“ç‰ˆæœ¬å’Œä¸‹è½½é“¾æ¥ï¼Œä¸éœ€è¦å†å»è¿œç¨‹ä»“åº“è¿›è¡ŒæŸ¥è¯¢ï¼Œç„¶åç›´æ¥è¿›å…¥æ–‡ä»¶å®Œæ•´æ€§æ ¡éªŒç¯èŠ‚ï¼Œå‡å°‘äº†å¤§é‡ç½‘ç»œè¯·æ±‚ã€‚ ä½†æ˜¯ä»ç„¶å­˜åœ¨éƒ¨åˆ†ç¼ºé™· å¹³é“ºå¼çš„ç®—æ³•çš„å¤æ‚æ€§ï¼Œä»¥åŠPhantomï¼ˆæ‰€ä»¥é¡¹ç›®ä¸­å¯ä»¥éæ³•è®¿é—®æ²¡æœ‰å£°æ˜è¿‡ä¾èµ–çš„åŒ…ï¼Œå› ä¸ºè¯¥åŒ…å¯èƒ½æ˜¯ä½œä¸ºä¾èµ–çš„ä¾èµ–ï¼‰ã€æ€§èƒ½å’Œå®‰å…¨é—®é¢˜ npm i çš„æµç¨‹æ‰€ä»¥æ€»ç»“èµ·æ¥ npm i çš„æµç¨‹æ˜¯ï¼š æ£€æŸ¥.npmrc æ–‡ä»¶ï¼ˆnpm running cnfiguration, å³npmè¿è¡Œæ—¶é…ç½®æ–‡ä»¶ï¼‰ï¼Œä»é¡¹ç›®çº§çš„ .npmrc -&gt; ç”¨æˆ·çº§çš„.npmrc -&gt; å…¨å±€çš„ .npmrc ï¼ˆæœ‰ç‚¹DNSæŸ¥è¯¢çš„æ„Ÿè§‰ æ£€æŸ¥æœ‰æ²¡æœ‰lockæ–‡ä»¶ï¼Œ æœ‰lockæ–‡ä»¶ï¼Œæ£€æŸ¥ package.json ä¸­çš„ä¾èµ–ç‰ˆæœ¬æ˜¯å¦å’Œ package-lock.json ä¸­çš„ä¾èµ–æœ‰å†²çª æœ‰å†²çªçš„è¯åœ¨merge conflictsçš„é˜¶æ®µï¼Œåªéœ€è¦ä»ä¸»åˆ†æ”¯ä¸­checkoutå»package-lock.jsonï¼Œå†ä»¥æ­¤ä¸ºåŸºç¡€ï¼Œé‡æ–°å®‰è£…æ–°åˆ†æ”¯ä¸­éœ€è¦çš„ä¾èµ–ã€‚ git checkout dev -- package-lock.json; è¿™æ ·è®©npmè‡ªåŠ¨çš„å»ç»´æŠ¤package-lock.jsonã€‚ æˆ–è€…å›¢é˜Ÿåˆä½œä¸­ï¼Œåšmergeæ“ä½œçš„äººå¯ä»¥é€šè¿‡æŸ¥çœ‹package.jsonçš„å˜æ›´çŸ¥é“æ–°å®‰è£…äº†å“ªäº›ä¾èµ–åŒ…ï¼Œæ¥é‡æ–°å®‰è£…ï¼Œ æ²¡å†²çªç›´æ¥èµ°ç¼“å­˜æµç¨‹ æ²¡æœ‰lockæ–‡ä»¶ï¼Œåˆ™ï¼š ä» npm è¿œç¨‹ä»“åº“è·å–åŒ…ä¿¡æ¯ æ ¹æ® package.jsonæ„å»ºä¾èµ–æ ‘ï¼Œæ„å»ºè¿‡ç¨‹ï¼š æ„å»ºä¾èµ–æ ‘æ—¶ï¼Œä¸ç®¡å…¶æ˜¯ç›´æ¥ä¾èµ–è¿˜æ˜¯å­ä¾èµ–çš„ä¾èµ–ï¼Œä¼˜å…ˆå°†å…¶æ”¾ç½®åœ¨ node_modules æ ¹ç›®å½•ã€‚ å½“é‡åˆ°ç›¸åŒæ¨¡å—æ—¶ï¼Œåˆ¤æ–­å·²æ”¾ç½®åœ¨ä¾èµ–æ ‘çš„æ¨¡å—ç‰ˆæœ¬æ˜¯å¦ç¬¦åˆæ–°æ¨¡å—çš„ç‰ˆæœ¬èŒƒå›´ï¼Œå¦‚æœç¬¦åˆåˆ™è·³è¿‡ï¼Œä¸ç¬¦åˆåˆ™åœ¨å½“å‰æ¨¡å—çš„ node_modules ä¸‹æ”¾ç½®è¯¥æ¨¡å—ã€‚ æ³¨æ„è¿™ä¸€æ­¥åªæ˜¯ç¡®å®šé€»è¾‘ä¸Šçš„ä¾èµ–æ ‘ï¼Œå¹¶éçœŸæ­£çš„å®‰è£…ï¼Œåé¢ä¼šæ ¹æ®è¿™ä¸ªä¾èµ–ç»“æ„å»ä¸‹è½½æˆ–æ‹¿åˆ°ç¼“å­˜ä¸­çš„ä¾èµ–åŒ… è¿›å…¥ç¼“å­˜æµç¨‹ å°†åŒ…è§£å‹åˆ° node_modules ç”Ÿæˆ lock æ–‡ä»¶ ç¼“å­˜åœ¨æ‰§è¡Œ npm install æˆ– npm updateå‘½ä»¤ä¸‹è½½ä¾èµ–åï¼Œé™¤äº†å°†ä¾èµ–åŒ…å®‰è£…åœ¨node_modules ç›®å½•ä¸‹å¤–ï¼Œè¿˜ä¼šåœ¨æœ¬åœ°çš„ç¼“å­˜ç›®å½•ç¼“å­˜ä¸€ä»½ã€‚ ç¼“å­˜æµç¨‹ï¼š åœ¨ç¼“å­˜ä¸­ä¾æ¬¡æŸ¥æ‰¾ä¾èµ–æ ‘ä¸­çš„æ¯ä¸ªåŒ… ä¸å­˜åœ¨ç¼“å­˜ï¼š ä» npm è¿œç¨‹ä»“åº“ä¸‹è½½åŒ… æ ¡éªŒåŒ…çš„å®Œæ•´æ€§ æ ¡éªŒä¸é€šè¿‡ï¼š é‡æ–°ä¸‹è½½ æ ¡éªŒé€šè¿‡ï¼š å°†ä¸‹è½½çš„åŒ…å¤åˆ¶åˆ° npm ç¼“å­˜ç›®å½• å°†ä¸‹è½½çš„åŒ…æŒ‰ç…§ä¾èµ–ç»“æ„è§£å‹åˆ° node_modules å­˜åœ¨ç¼“å­˜ï¼šå°†ç¼“å­˜æŒ‰ç…§ä¾èµ–ç»“æ„è§£å‹åˆ° node_modules è¢«è®¨åŒäº†çš„npmNPM Clients That Are Better Than The Original npm72020å¹´10æœˆ13æ—¥æ˜¯npm CLIå›¢é˜Ÿçš„å¿«ä¹æ˜ŸæœŸäºŒï¼Œç»è¿‡å‡ ä¸ªæœˆçš„åŠªåŠ›ï¼Œnpm CLIå›¢é˜Ÿæ­£å¼å‘å¸ƒäº† npm@7.0.0ã€‚ å·¥ä½œåŒºï¼ˆé‡å¤å®‰è£…é—®é¢˜ï¼‰ï¼šå®ƒæ”¯æŒåœ¨ä¸€ä¸ªé¡¶çº§çš„æ ¹åŒ…ä¸­ç®¡ç†å¤šä¸ªåŒ…ï¼ˆYarnå’ŒPnpmä»¥ç›¸åŒçš„åç§°å®ç°ç±»ä¼¼çš„åŠŸèƒ½ï¼‰ã€‚å®ƒæ˜¯ä»€ä¹ˆï¼Ÿä½ å¯ä»¥å°†å®ƒè§†ä¸ºåœ¨é¢„å®šä¹‰å’Œé€šç”¨ä¸Šä¸‹æ–‡å†…çš„é¡¹ç›®ä¹‹é—´å…±äº«è½¯ä»¶åŒ…çš„ä¸€ç§æ–¹å¼ã€‚ï¼Œä½†æ˜¯å¹¶ä¸æ˜¯è¯´è½¯ä»¶åŒ…æ˜¯å®Œå…¨é€šç”¨çš„ï¼Œæˆ–è€…æ‰€æœ‰å†…å®¹éƒ½è¦æ”¾è¿›åŒä¸€ä¸ªä¸‹è½½ä½ç½®ã€‚è¿™ä¸ªæ–¹æ¡ˆç¡®å®å¯ä»¥è§£å†³ä¸€éåˆä¸€éåœ°å¤åˆ¶æ¨¡å—çš„éº»çƒ¦ï¼Œè¿˜èƒ½è®©ä½ æ§åˆ¶æˆ‘ä»¬çš„æ¨¡å—è¦å…±äº«ç»™å“ªäº›é¡¹ç›®ã€‚ æœ‰äº†å·¥ä½œåŒºä»¥åï¼Œä½ å°±å¯ä»¥æ˜ç¡®åœ°å‘Šè¯‰ NPMï¼Œä½ çš„ç¨‹åºåŒ…å°†å­˜æ”¾åœ¨ä½•å¤„ã€‚å¹¶ä¸”ç”±äºæ–°ç‰ˆå®¢æˆ·ç«¯å¯ä»¥æ„ŸçŸ¥å·¥ä½œåŒºï¼Œå› æ­¤å®ƒä¼šæ­£ç¡®å®‰è£…ä¾èµ–é¡¹ï¼Œè€Œä¸ä¼šå¤åˆ¶é‚£äº›é€šç”¨çš„ä¾èµ–ã€‚ åŒçº§é¡¹ä¾èµ–ï¼šåœ¨ä¹‹å‰çš„ç‰ˆæœ¬(npm v6)ä¸­ï¼Œnpmé»˜è®¤ä¸å®‰è£…åŒçº§é¡¹ä¾èµ–ï¼Œè¿™ä½¿å¾—å¼€å‘äººå‘˜ä¸å¾—ä¸è‡ªå·±å®‰è£…å’Œç®¡ç†åŒçº§é¡¹ä¾èµ–å…³ç³»ï¼ˆæ¯”å¦‚React15å’ŒReact16ï¼‰ã€‚è€Œç°åœ¨ï¼ŒNPM ç°åœ¨å°†å®Œæˆå¼€å‘äººå‘˜çš„å·¥ä½œå¹¶å¸®åŠ©åè€…å†³å®šæ˜¯å¦åº”è¯¥å®‰è£…è¯¥å¯¹ç­‰ä¾èµ–é¡¹ åŒçº§ä¾èµ–ï¼š è¿™é‡Œå°±ç®€å•ä»‹ç»ä¸€ä¸‹ï¼šå¯¹ç­‰ä¾èµ–é¡¹å’Œæ™®é€šçš„ä¾èµ–é¡¹å‡ ä¹æ²¡ä»€ä¹ˆåŒºåˆ«ï¼Œå®ƒä»¬å¹¶æ²¡æœ‰å®šä¹‰ä¸€ä¸ªä¸¥æ ¼çš„è¦æ±‚ï¼Œè€Œæ˜¯å£°æ˜ï¼š ä½ çš„è½¯ä»¶åŒ…ä¸å¦ä¸€ä¸ªæ¨¡å—çš„ç‰¹å®šç‰ˆæœ¬å…¼å®¹ã€‚ å¦‚æœè¯¥æ¨¡å—å·²ç»å®‰è£…å¹¶ä¸”æ˜¯æ­£ç¡®çš„ç‰ˆæœ¬ï¼Œåˆ™ä¸è¦æ‰§è¡Œä»»ä½•æ“ä½œã€‚ å¦‚æœæ‰¾ä¸åˆ°è¯¥æ¨¡å—æˆ–ç‰ˆæœ¬å­˜åœ¨å†²çªï¼Œåˆ™å‘å¼€å‘äººå‘˜æ˜¾ç¤ºä¸€æ¡æ¶ˆæ¯ï¼Œè­¦å‘Šä»–ä»¬è¿™ä¸€äº‹å®ï¼Œæ­¤å¤–ä»€ä¹ˆä¹Ÿä¸åšã€‚ Package-lock v2å’Œå¯¹yarn.lockçš„æ”¯æŒ å…¶ä»–ï¼š npmç°åœ¨ä½¿ç”¨äº† package.exportï¼Œè€Œä¸å†ä½¿ç”¨ require() npx çš„é‡å†™ï¼Œä¸‹è½½å·²ç»å¯ä»¥ä½¿ç”¨ npm exec äº† npm audit çš„è¾“å‡ºåœ¨äººå¯è¯»å’Œ --json è¾“å‡ºæ–¹å¼ä¸Šéƒ½æœ‰æ‰€æ”¹å˜ã€‚å®ƒä¸å†ä½¿ç”¨è¡¨æ ¼æ¥æ˜¾ç¤ºæ¼æ´ï¼Œvuln countä¹Ÿä¸å†æ˜¯å°†æ ‘ä¸Šçš„æ¯ä¸€ä¸ªèŠ‚ç‚¹ç›¸ä¹˜ã€‚ ç°åœ¨é»˜è®¤æƒ…å†µä¸‹ï¼Œnpm ls ä»…æ˜¾ç¤ºé¡¶çº§è½¯ä»¶åŒ… å‚è€ƒé“¾æ¥ï¼šhttps://blog.bitsrc.io/npm-7-this-is-what-i-call-an-update-de17a34ab787 å…¶ä»–çš„é€‰æ‹©NPM Clients That Are Better Than The Original 3.ç®¡ç†Nodeç‰ˆæœ¬å¯ä»¥ä½¿ç”¨nvmè¿›è¡ŒåŒ…ç®¡ç†ï¼Œéšæ—¶åˆ‡æ¢nodeç‰ˆæœ¬ // è®¾ç½® node å®‰è£…æº nvm node_mirror https://npm.taobao.org/mirrors/node/ nvm npm_mirror https://npm.taobao.org/mirrors/npm/ // å®‰è£…ç‰ˆæœ¬ nvm install latest // ä½¿ç”¨æŒ‡å®šç‰ˆæœ¬ nvm use v17.0.0 // æŸ¥çœ‹ç³»ç»Ÿå­˜åœ¨çš„ node ç‰ˆæœ¬ nvm list // å¸è½½æŒ‡å®š node ç‰ˆæœ¬ nvm uninstall 17.0.0 å¯ä»¥å‚è€ƒä»¥ä¸‹æ–‡ç«  https://blog.csdn.net/weixin_44582077/article/details/110237056 4.NPXnpxæ˜¯ä¸€ä¸ªå·¥å…·ï¼Œnpm v5.2.0å¼•å…¥çš„ä¸€æ¡å‘½ä»¤ï¼ˆnpxï¼‰ï¼Œä¸€ä¸ªnpmåŒ…æ‰§è¡Œå™¨ï¼ŒæŒ‡åœ¨æé«˜ä»npmæ³¨å†Œè¡¨ä½¿ç”¨è½¯ä»¶åŒ…æ—¶çš„ä½“éªŒ ï¼Œnpmä½¿å¾—å®ƒéå¸¸å®¹æ˜“åœ°å®‰è£…å’Œç®¡ç†æ‰˜ç®¡åœ¨æ³¨å†Œè¡¨ä¸Šçš„ä¾èµ–é¡¹ï¼Œnpxä½¿å¾—ä½¿ç”¨CLIå·¥å…·å’Œå…¶ä»–æ‰˜ç®¡åœ¨æ³¨å†Œè¡¨ã€‚å®ƒå¤§å¤§ç®€åŒ–äº†ä¸€äº›äº‹æƒ…ã€‚ å®è´¨ä¸Š npx æ‰§è¡Œçš„æ˜¯ node_module/.bin/ ä¸‹é¢åŒ…çš„å‘½ä»¤ ä¸»è¦ç‰¹ç‚¹ï¼š ä¸´æ—¶å®‰è£…å¯æ‰§è¡Œä¾èµ–åŒ…ï¼Œä¸ç”¨å…¨å±€å®‰è£…ï¼Œä¸ç”¨æ‹…å¿ƒé•¿æœŸçš„æ±¡æŸ“ã€‚ å¯ä»¥æ‰§è¡Œä¾èµ–åŒ…ä¸­çš„å‘½ä»¤ï¼Œå®‰è£…å®Œæˆè‡ªåŠ¨è¿è¡Œã€‚ ï¼ˆæ¯”å¦‚ä½¿ç”¨Reactæ—¶ï¼Œæˆ‘ä»¬ä½¿ç”¨npmï¼‰ npm i -g create-react-app create-react-app é¡¹ç›®åç§° ä½¿ç”¨npx npx create-react-app é¡¹ç›®åç§° è‡ªåŠ¨åŠ è½½node_modulesä¸­ä¾èµ–åŒ…ï¼Œä¸ç”¨æŒ‡å®š$PATHã€‚ å¯ä»¥æŒ‡å®šnodeç‰ˆæœ¬ã€å‘½ä»¤çš„ç‰ˆæœ¬ï¼Œè§£å†³äº†ä¸åŒé¡¹ç›®ä½¿ç”¨ä¸åŒç‰ˆæœ¬çš„å‘½ä»¤çš„é—®é¢˜ã€‚ï¼ˆ-på‚æ•°ç”¨äºæŒ‡å®š npx æ‰€è¦å®‰è£…çš„æ¨¡å—ï¼‰ npx -p node@8 npm run build ç”šè‡³å¯ä»¥ åˆ©ç”¨ npx å¯ä»¥ä¸‹è½½æ¨¡å—è¿™ä¸ªç‰¹ç‚¹ï¼Œå¯ä»¥æŒ‡å®šæŸä¸ªç‰ˆæœ¬çš„ Node è¿è¡Œè„šæœ¬ã€‚å®ƒçš„çªé—¨å°±æ˜¯ä½¿ç”¨ npm çš„ node æ¨¡å—ã€‚ $ npx node@0.12.8 -v v0.12.8 ä¸Šé¢å‘½ä»¤ä¼šä½¿ç”¨ 0.12.8 ç‰ˆæœ¬çš„ Node æ‰§è¡Œè„šæœ¬ã€‚åŸç†æ˜¯ä» npm ä¸‹è½½è¿™ä¸ªç‰ˆæœ¬çš„ nodeï¼Œä½¿ç”¨åå†åˆ æ‰ã€‚ æŸäº›åœºæ™¯ä¸‹ï¼Œè¿™ä¸ªæ–¹æ³•ç”¨æ¥åˆ‡æ¢ Node ç‰ˆæœ¬ï¼Œè¦æ¯” nvm é‚£æ ·çš„ç‰ˆæœ¬ç®¡ç†å™¨æ–¹ä¾¿ä¸€äº›ã€‚ 5.PNMPæˆªè‡³2021/11/5, GitHubçš„Staræ•°é‡ä¸º13.4kï¼Œç›®å‰Vueã€å¾®è½¯ã€å­—èŠ‚éƒ½æœ‰åœ¨ä½¿ç”¨ ä¸‹è½½åŒyarnï¼š npm install -g pnpm ä»ç»“æœä¸Šæ¥çœ‹ï¼Œå®ƒå…·æœ‰ä»¥ä¸‹ä¼˜åŠ¿ï¼š å®‰è£…é€Ÿåº¦å— ä¾èµ–è§£æã€‚ ä»“åº“ä¸­æ²¡æœ‰çš„ä¾èµ–éƒ½è¢«è¯†åˆ«å¹¶è·å–åˆ°ä»“åº“ã€‚ ç›®å½•ç»“æ„è®¡ç®—ã€‚ node_modules ç›®å½•ç»“æ„æ˜¯æ ¹æ®ä¾èµ–è®¡ç®—å‡ºæ¥çš„ã€‚ é“¾æ¥ä¾èµ–é¡¹ã€‚ æ‰€æœ‰ä»¥å‰å®‰è£…è¿‡çš„ä¾èµ–é¡¹éƒ½ä¼šç›´æ¥ä»ä»“åº“ä¸­è·å–å¹¶é“¾æ¥åˆ° node_modulesã€‚ æå…¶ç®€æ´çš„node_modulesç›®å½•ï¼ˆéæ‰å¹³çš„ node_modulesï¼‰ èƒ½æå¤§çš„é™ä½ç£ç›˜ç©ºé—´çš„å ç”¨ï¼šä½¿ç”¨ npm æ—¶ï¼Œä¾èµ–æ¯æ¬¡è¢«ä¸åŒçš„é¡¹ç›®ä½¿ç”¨ï¼Œéƒ½ä¼šé‡å¤å®‰è£…ä¸€æ¬¡ã€‚ è€Œåœ¨ä½¿ç”¨ pnpm æ—¶ï¼Œä¾èµ–ä¼šè¢«å­˜å‚¨åœ¨å†…å®¹å¯å¯»å€çš„å­˜å‚¨ä¸­ï¼Œæ‰€ä»¥ï¼š å¦‚æœä½ ç”¨åˆ°äº†æŸä¾èµ–é¡¹çš„ä¸åŒç‰ˆæœ¬ï¼Œåªä¼šå°†ä¸åŒç‰ˆæœ¬é—´æœ‰å·®å¼‚çš„æ–‡ä»¶æ·»åŠ åˆ°ä»“åº“ã€‚ ä¾‹å¦‚ï¼Œå¦‚æœæŸä¸ªåŒ…æœ‰100ä¸ªæ–‡ä»¶ï¼Œè€Œå®ƒçš„æ–°ç‰ˆæœ¬åªæ”¹å˜äº†å…¶ä¸­1ä¸ªæ–‡ä»¶ã€‚é‚£ä¹ˆ pnpm update æ—¶åªä¼šå‘å­˜å‚¨ä¸­å¿ƒé¢å¤–æ·»åŠ 1ä¸ªæ–°æ–‡ä»¶ï¼Œè€Œä¸ä¼šå› ä¸ºä»…ä»…ä¸€ä¸ªæ–‡ä»¶çš„æ”¹å˜å¤åˆ¶æ•´æ–°ç‰ˆæœ¬åŒ…çš„å†…å®¹ã€‚ æ‰€æœ‰æ–‡ä»¶éƒ½ä¼šå­˜å‚¨åœ¨ç¡¬ç›˜ä¸Šçš„æŸä¸€ä½ç½®ã€‚ å½“è½¯ä»¶åŒ…è¢«è¢«å®‰è£…æ—¶ï¼ŒåŒ…é‡Œçš„æ–‡ä»¶ä¼šç¡¬é“¾æ¥åˆ°è¿™ä¸€ä½ç½®ï¼Œè€Œä¸ä¼šå ç”¨é¢å¤–çš„ç£ç›˜ç©ºé—´ã€‚ è¿™å…è®¸ä½ è·¨é¡¹ç›®åœ°å…±äº«åŒä¸€ç‰ˆæœ¬çš„ä¾èµ–ã€‚ å¯¹monorepoæ”¯æŒ Monorepo å¯ä»¥ä¸€å®šç¨‹åº¦è§£å†³é‡å¤å®‰è£…å’Œä¿®æ”¹å›°éš¾çš„é—®é¢˜ï¼Œä½†éœ€è¦èµ°æœ¬åœ°ç¼–è¯‘ å®‰å…¨æ€§é«˜ï¼Œé¡¹ç›®æ— æ³•éæ³•è®¿é—®æœªå£°æ˜çš„ä¾èµ–ï¼ˆæ¯”å¦‚é¡¹ç›®Aä¾èµ–BåŒ…ï¼ŒBåŒ…ä¾èµ–CåŒ…ï¼Œæ­¤æ—¶æ˜¯é¡¹ç›®Aæ— æ³•ä½¿ç”¨CåŒ…ï¼‰ ç¬¦å·é“¾æ¥å’Œç¡¬é“¾æ¥ pnpm ä½¿ç”¨ç¬¦å·é“¾æ¥å’Œç¡¬é“¾æ¥ï¼ˆHard Linkï¼‰ï¼Œå®ƒä¼šåœ¨å…¨å±€çš„ store ç›®å½•é‡Œå­˜å‚¨é¡¹ç›® node_modules æ–‡ä»¶çš„ hard links ä¸€ä¸ªç¡¬é“¾æ¥æ˜¯ä¸€ä¸ªç›®å½•æ¡ç›®ï¼Œä¸€ä¸ªåå­—ä¸å…³è”æ–‡ä»¶çš„æ–‡ä»¶ç³»ç»Ÿï¼ˆæ–‡ä»¶åˆ«åï¼‰ã€‚æ‰€æœ‰åŸºäºç›®å½•çš„æ–‡ä»¶ç³»ç»Ÿå¿…é¡»è‡³å°‘æœ‰ä¸€ä¸ªç¡¬é“¾æ¥ï¼Œä¸ºæ¯ä¸ªæ–‡ä»¶æä¾›åŸå§‹åç§° ç¡¬é“¾æ¥æŒ‡é€šè¿‡ç´¢å¼•èŠ‚ç‚¹æ¥è¿›è¡Œè¿æ¥ã€‚åœ¨Linuxçš„æ–‡ä»¶ç³»ç»Ÿä¸­ï¼Œä¿å­˜åœ¨ç£ç›˜åˆ†åŒºä¸­çš„æ–‡ä»¶ä¸ç®¡æ˜¯ä»€ä¹ˆç±»å‹éƒ½ç»™å®ƒåˆ†é…ä¸€ä¸ªç¼–å·ï¼Œç§°ä¸ºç´¢å¼•èŠ‚ç‚¹å·(Inode Index)ã€‚åœ¨Linuxä¸­ï¼Œå¤šä¸ªæ–‡ä»¶åæŒ‡å‘åŒä¸€ç´¢å¼•èŠ‚ç‚¹æ˜¯å­˜åœ¨çš„ åªæœ‰åˆ é™¤äº†æºæ–‡ä»¶å’Œæ‰€æœ‰å¯¹åº”çš„ç¡¬é“¾æ¥æ–‡ä»¶ï¼Œæ–‡ä»¶å®ä½“æ‰ä¼šè¢«åˆ é™¤ ä¸€ä¸ªä¼˜åŠ¿ä¾‹å­æ¥æºäºçŸ¥ä¹ Pnpm: æœ€å…ˆè¿›çš„åŒ…ç®¡ç†å·¥å…· ä¾‹å¦‚é¡¹ç›®é‡Œé¢æœ‰ä¸ª 1MB çš„ä¾èµ– aï¼Œåœ¨ pnpm ä¸­ï¼Œçœ‹ä¸Šå»è¿™ä¸ª a ä¾èµ–åŒæ—¶å ç”¨äº† 1MB çš„ node_modules ç›®å½•ä»¥åŠå…¨å±€ store ç›®å½• 1MB çš„ç©ºé—´(åŠ èµ·æ¥æ˜¯ 2MB)ï¼Œä½†å› ä¸º hard link çš„æœºåˆ¶ä½¿å¾—ä¸¤ä¸ªç›®å½•ä¸‹ç›¸åŒçš„ 1MB ç©ºé—´èƒ½ä»ä¸¤ä¸ªä¸åŒä½ç½®è¿›è¡Œå¯»å€ï¼Œå› æ­¤å®é™…ä¸Šè¿™ä¸ª a ä¾èµ–åªç”¨å ç”¨ 1MB çš„ç©ºé—´ï¼Œè€Œä¸æ˜¯ 2MBã€‚ è½¯é“¾æ¥ ç¬¦å·è¿æ¥ï¼ˆSymbolic Linkï¼‰ï¼Œä¹Ÿå«è½¯è¿æ¥ã€‚è½¯é“¾æ¥æ–‡ä»¶æœ‰ç±»ä¼¼äºWindowsçš„å¿«æ·æ–¹å¼ï¼ˆæ–‡ä»¶è·¯å¾„æŒ‡å‘ï¼‰ã€‚å®ƒå®é™…ä¸Šæ˜¯ä¸€ä¸ªç‰¹æ®Šçš„æ–‡ä»¶ã€‚åœ¨ç¬¦å·è¿æ¥ä¸­ï¼Œæ–‡ä»¶å®é™…ä¸Šæ˜¯ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶ï¼Œå…¶ä¸­åŒ…å«çš„æœ‰å¦ä¸€æ–‡ä»¶çš„ä½ç½®ä¿¡æ¯ã€‚ ä¸è®ºæ˜¯ç¡¬é“¾æ¥æˆ–è½¯é“¾æ¥éƒ½ä¸ä¼šå°†åŸæœ¬çš„æ¡£æ¡ˆå¤åˆ¶ä¸€ä»½ï¼Œåªä¼šå ç”¨éå¸¸å°‘é‡çš„ç£ç¢Ÿç©ºé—´ã€‚ è½¯ã€ç¡¬é“¾æ¥æœ€æ ¹æœ¬çš„åŒºåˆ«åŸç†ä¸Šï¼Œç¡¬é“¾æ¥å’Œæºæ–‡ä»¶çš„inodeèŠ‚ç‚¹å·ç›¸åŒï¼Œä¸¤è€…äº’ä¸ºç¡¬é“¾æ¥ã€‚è½¯è¿æ¥å’Œæºæ–‡ä»¶çš„inodeèŠ‚ç‚¹å·ä¸åŒï¼Œè¿›è€ŒæŒ‡å‘çš„blockä¹Ÿä¸åŒï¼Œè½¯è¿æ¥blockä¸­å­˜æ”¾äº†æºæ–‡ä»¶çš„è·¯å¾„åã€‚ å®é™…ä¸Šï¼Œç¡¬é“¾æ¥å’Œæºæ–‡ä»¶æ˜¯åŒä¸€ä»½æ–‡ä»¶ï¼Œè€Œè½¯è¿æ¥æ˜¯ç‹¬ç«‹çš„æ–‡ä»¶ï¼Œç±»ä¼¼äºå¿«æ·æ–¹å¼ï¼Œå­˜å‚¨ç€æºæ–‡ä»¶çš„ä½ç½®ä¿¡æ¯ä¾¿äºæŒ‡å‘ã€‚ æºæ–‡ä»¶ -&gt; ç‰©ç†ç¡¬ç›˜ä¸€ä¸ªåŒºå— ç¡¬é“¾æ¥ -&gt; ç‰©ç†ç¡¬ç›˜ä¸€ä¸ªåŒºå— è½¯é“¾æ¥ -&gt; æºæ–‡ä»¶è·¯å¾„ä¹Ÿå°±æ˜¯è¯´ï¼Œåˆ é™¤æºæ–‡ä»¶ï¼Œä¸å½±å“ç¡¬é“¾æ¥çš„è®¿é—®ï¼Œä½†æ˜¯è½¯è¿æ¥å®é™…ä¸Šä¿å­˜äº†ä¸€ä¸ªæºæ–‡ä»¶çš„è®¿é—®è·¯å¾„ï¼Œæ‰€ä»¥ä¼šå½±å“è½¯é“¾æ¥çš„è®¿é—® ä½¿ç”¨é™åˆ¶ï¼š ä½¿ç”¨é™åˆ¶ä¸Šï¼Œä¸èƒ½å¯¹ç›®å½•åˆ›å»ºç¡¬é“¾æ¥ï¼Œä¸èƒ½å¯¹ä¸åŒæ–‡ä»¶ç³»ç»Ÿåˆ›å»ºç¡¬é“¾æ¥ï¼Œä¸èƒ½å¯¹ä¸å­˜åœ¨çš„æ–‡ä»¶åˆ›å»ºç¡¬é“¾æ¥ï¼›å¯ä»¥å¯¹ç›®å½•åˆ›å»ºè½¯è¿æ¥ï¼Œå¯ä»¥è·¨æ–‡ä»¶ç³»ç»Ÿåˆ›å»ºè½¯è¿æ¥ï¼Œå¯ä»¥å¯¹ä¸å­˜åœ¨çš„æ–‡ä»¶åˆ›å»ºè½¯è¿æ¥ã€‚ 6.npmå‘åŒ…é¦–å…ˆåœ¨githubä¸Šæ–°å»ºé¡¹ç›®ï¼Œcloneä¸‹æ¥å npm init -yï¼Œpushå®Œåæˆ‘ä»¬å°±å¯ä»¥å‘åŒ…å•¦ åœ¨å®˜ç½‘æ³¨å†Œè´¦å· éœ€è¦åˆ‡æ¢npmæº å¦‚æœæ˜¯æ·˜å®æºã€æˆ–è€…å…¬å¸çš„æºï¼Œéœ€è¦åœ¨æœ¬åœ°é¡¹ç›®å‘½ä»¤è¡Œè¾“å…¥ï¼ˆåé¢æˆ‘ä»¬è®°å¾—åˆ‡å›å»ï¼Œä»¥å…å½±å“æˆ‘ä»¬çš„æ—¥å¸¸ä½¿ç”¨ï¼‰ npm set registry https://registry.npmjs.org/ npm login åœ¨æœ¬åœ°å’Œnpmå®˜ç½‘çš„è´¦æˆ·è¿æ¥ åœ¨package.jsonç¡®ä¿åŒ…åå…¨çƒå”¯ä¸€ï¼Œä¹Ÿå°±æ˜¯nameå”¯ä¸€ï¼Œä¸”mainçš„å€¼ä¸ºæˆ‘ä»¬æ‰“åŒ…çš„æ–‡ä»¶ï¼Œå› ä¸ºè¯»å–çš„æ—¶å€™ä¼šæ ¹æ®mainè¯»å–å¯¹åº”çš„æ–‡ä»¶ { \"name\": \"åç§°\", \"version\": \"1.0.0\", \"description\": \"\", \"main\": \"./dist/bundle.js\", \"scripts\": { \"test\": \"echo \\\"Error: no test specified\\\" &amp;&amp; exit 1\" }, //è¦å‘å¸ƒåˆ°npmçš„æ–‡ä»¶ \"files\": [ \"lib\" ], \"keywords\": [], \"author\": \"\", \"license\": \"ISC\", \"devDependencies\": { \"webpack\": \"^5.68.0\", \"webpack-cli\": \"^4.9.2\" } } å‘å¸ƒ npm publish å‘åŒ…åæ— æ³•è·å–æœ€æ–°ç‰ˆæœ¬æ—¶ï¼Œè¯·æ£€æŸ¥æ˜¯å¦ä¿®æ”¹äº†srcä¸‹æ–‡ä»¶ï¼Œä¸ç„¶å¯èƒ½æ— æ³•è·å–åˆ°æœ€æ–°lateståŒ… å¹¶ä¸”ç¡®ä¿package.jsonä¸èƒ½ä¸º type:module (åˆ™ä»¥.jsç»“å°¾æˆ–æ²¡æœ‰ä»»ä½•æ‰©å±•åçš„æ–‡ä»¶å°†ä½œä¸ºESæ¨¡å—è¿›è¡ŒåŠ è½½ã€‚é»˜è®¤æ˜¯èµ°type: commonjs) 7.npm linknpm installå¯ä»¥æŠŠå‘å¸ƒåœ¨npmjså¹³å°ä¸Šçš„æ¨¡å—åŒ…ä¸‹è½½åˆ°æœ¬åœ° ä½†æ˜¯å¯¹äºæœªå‘å¸ƒçš„åŒ…ï¼Œæˆ‘ä»¬æ— æ³•æµ‹è¯•ä½¿ç”¨ï¼ˆä½ å¯ä»¥åœ¨æœ¬åœ°æ”¹æºç ï¼Œä½†æ˜¯åˆ«äººæµ‹è¯•çš„æ—¶å€™ä¸‹è½½ä½ çš„ä»“åº“æ–‡ä»¶ï¼Œç„¶å npm iï¼Œå°±ä¸çŸ¥é“è¦ä¸è¦æ”¹æºç äº† ï¼‰ï¼Œæ­¤æ—¶æˆ‘ä»¬å¯ä»¥ä½¿ç”¨npm link npm linkå¯ä»¥å¸®åŠ©æˆ‘ä»¬æ¨¡æ‹ŸåŒ…å®‰è£…åçš„çŠ¶æ€ï¼Œå®ƒä¼šåœ¨ç³»ç»Ÿä¸­åšä¸€ä¸ªå¿«æ·æ–¹å¼æ˜ å°„ï¼Œè®©æœ¬åœ°çš„åŒ…å°±å¥½åƒinstallè¿‡ä¸€æ ·ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ã€‚åœ¨MACä¸­ï¼Œæˆ‘ä»¬åœ¨ç»ˆç«¯å¯ä»¥ç›´æ¥æ•²å‘½ä»¤ï¼Œå…¶å®æ˜¯åœ¨æ‰§è¡Œ/xxxç›®å½•ä¸‹çš„è„šæœ¬ å½“å‰ï¼šæˆ‘ä»¬çš„test-projecté¡¹ç›®ä¾èµ– xx-module npm åŒ… é¦–å…ˆï¼Œè¿›å…¥æˆ‘ä»¬è¦å¼€å‘çš„npmæ¨¡å— xx-moduleï¼Œæ‰§è¡Œnpm link cd xx-module npm link æ‰§è¡Œå‘½ä»¤åï¼Œxx-moduleé¡¹ç›®ä¼šæ ¹æ®package.jsonä¸Šçš„é…ç½®ï¼Œè¢«é“¾æ¥åˆ°å…¨å±€ï¼Œè·¯å¾„æ˜¯{prefix}/lib/node_modules/&lt;package&gt;ï¼Œè¿™æ˜¯å®˜æ–¹æ–‡æ¡£ä¸Šçš„æè¿°ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨npm config get prefixå‘½ä»¤è·å–åˆ°prefixçš„å€¼ ç„¶åï¼Œè¿›å…¥test-projecté¡¹ç›®ï¼Œæ‰§è¡Œå‘½ä»¤ cd test-project npm link xx-module è¯·æ³¨æ„ï¼Œpackage-nameå–è‡ªpackage.jsonï¼Œè€Œä¸æ˜¯å–è‡ªç›®å½•åç§°ã€‚ è§£é™¤é“¾æ¥1ï¼‰è§£é™¤é¡¹ç›®å’Œæ¨¡å—çš„é“¾æ¥ cd xxx/xxx/test-project npm unlink xx-module 2ï¼‰è§£é™¤æ¨¡å—çš„å…¨å±€é“¾æ¥ cd xxx/xxx/xx-module npm unlink xx-module å‚è€ƒï¼š npm linkçš„ä½¿ç”¨ ç”¨ä¸€ä¸ªå®ä¾‹ç®€å•ä»‹ç»ä»€ä¹ˆæ˜¯pnpm NPM 7: This Is What I Call An Update","categories":[{"name":"å‰ç«¯","slug":"å‰ç«¯","permalink":"https://taylor12138.github.io/categories/%E5%89%8D%E7%AB%AF/"}],"tags":[],"author":"Hello"},{"title":"JQuery","slug":"JQuery","date":"2020-12-23T16:36:12.611Z","updated":"2020-12-23T16:36:12.611Z","comments":true,"path":"2020/12/24/jquery/","link":"","permalink":"https://taylor12138.github.io/2020/12/24/jquery/","excerpt":"","text":"1.JQueryæ¦‚è¿°JavaScriptåº“ï¼šå³libraryï¼Œæ˜¯ä¸€ä¸ªå°è£…å¥½çš„ç‰¹å®šé›†åˆï¼ˆæ–¹æ³•å’Œå‡½æ•°ï¼‰ï¼Œä½¿å¾—æˆ‘ä»¬å¯ä»¥å¿«é€Ÿé«˜æ•ˆçš„ä½¿ç”¨è¿™äº›å°è£…å¥½çš„åŠŸèƒ½ï¼Œè€ŒjQuery å°±æ˜¯ä¸€ä¸ª JavaScriptå‡½æ•°åº“ å…¶ä»–å¸¸è§åœ°jsåº“è¿˜æœ‰Prototypeã€YUIã€Dojoã€ExtJSå’Œç§»åŠ¨ç«¯çš„zepto ä¼˜ç‚¹ï¼š 1.è½»é‡çº§ï¼Œæ–‡ä»¶å¤Ÿå° 2.è·¨æµè§ˆå™¨å…¼å®¹ï¼ŒåŸºæœ¬å…¼å®¹ä¸»æµæµè§ˆå™¨ 3.é“¾å¼ç¼–ç¨‹ã€éšå¼è¿­ä»£ 4.å¯¹äº‹ä»¶ã€æ ·å¼ã€åŠ¨ç”»æ”¯æŒï¼Œæå¤§åœ°ç®€åŒ–äº†domçš„æ“ä½œï¼Œæ”¯æŒæ’ä»¶æ‰©å±•å¼€å‘ï¼Œæœ‰ä¸°å¯Œçš„ç¬¬ä¸‰æ–¹æ’ä»¶ 4.å…è´¹ã€å¼€æº å®˜ç½‘ä¸‹è½½ï¼šhttps://jquery.com/ æœ€æ–°ç‰ˆæœ¬æ—©å·²ä¸å…¼å®¹ie6ã€7ã€8 ç­‰é¡µé¢domåŠ è½½å®Œæ¯•å†å»æ‰§è¡Œä»£ç ï¼ˆç±»ä¼¼äºDOMContentLoadedï¼‰ //å…¥å£å‡½æ•° $(function() { xxxx }) è¦åœ¨é¡µé¢å¼•å…¥å®˜ç½‘ä¸‹è½½çš„jQueryçš„jsæ–‡ä»¶æ‰èƒ½ä½¿ç”¨ 2.jQueryçš„åŸºæœ¬ä½¿ç”¨$æ˜¯jqueryçš„ç®€ç§°ï¼Œä¸€èˆ¬åœ¨ä»£ç ä¸­ç”¨$æ›¿ä»£jQuery $(function() { $(&#39;div&#39;).hide() }) ç›¸å½“äº jQuery(function( jQuery(&#39;div&#39;).hide() ) {}) $æ˜¯jQueryçš„é¡¶çº§å¯¹è±¡ï¼Œç›¸å½“äºJavaScriptçš„windowï¼ŒæŠŠå…ƒç´ $åŒ…è£…æˆjQueryå¯¹è±¡ï¼Œå°±å¯ä»¥è°ƒç”¨jQueryæ–¹æ³• jQueryå’Œdomç”¨åŸç”Ÿjsè·å–çš„å¯¹è±¡å°±æ˜¯domå¯¹è±¡ ç”¨jQueryæ–¹å¼è·å–çš„å¯¹è±¡å°±æ˜¯jQueryå¯¹è±¡ è¿™ä¸¤ä¸ªå¯¹è±¡æ˜¯ä¸ä¸€æ ·çš„ jQueryå¯¹è±¡çš„æœ¬è´¨å°±æ˜¯åˆ©ç”¨$å¯¹DOMå¯¹è±¡åŒ…è£…åäº§ç”Ÿçš„å¯¹è±¡ï¼ˆä¼ªæ•°ç»„çš„å½¢å¼å‚¨å­˜ï¼‰ jQueryå¯¹è±¡åªèƒ½ç”¨jQueryæ–¹æ³•ï¼ŒDOMå¯¹è±¡åˆ™åªèƒ½ä½¿ç”¨åŸç”Ÿçš„JavaScriptå±æ€§å’Œæ–¹æ³• ä½†æ˜¯DOMå¯¹è±¡å’ŒjQueryå¯¹è±¡å¯ä»¥ç›¸äº’è½¬æ¢ï¼Œå› ä¸ºåŸç”Ÿjsæ¯”jQueryæ›´å¤§ï¼ŒåŸç”Ÿçš„ä¸€äº›å±æ€§å’Œæ–¹æ³•jQueryæ²¡æœ‰ä¸ºæˆ‘ä»¬è¿›è¡Œå°è£…ï¼Œæƒ³è¦ä½¿ç”¨è¿™äº›å±æ€§å’Œæ–¹æ³•éœ€è¦æŠŠjQueryè½¬æ¢æˆDOMå¯¹è±¡æ‰èƒ½ä½¿ç”¨ //DOMè½¬jQuery let myvideo = document.querySelector('video'); $(myvideo); //jQueryè½¬DOM $('video')[index]æˆ–è€…$('video').get(index) $('video'); //è·å–å…ƒç´  $('video')[0].play(); //å°†åªæœ‰ä¸€ä¸ªå…ƒç´ çš„è§†é¢‘è¿‡æ¥å¹¶ä¸”ä½¿ç”¨DOMåŠŸèƒ½ 3.jQueryçš„APIjQueryé€‰æ‹©å™¨$(&quot;é€‰æ‹©å™¨&quot;) è¯­æ³•å’ŒCSSé€‰æ‹©å™¨ä¸€æ ·å³å¯ å­ä»£é€‰æ‹©å™¨ $(&quot;ul&gt;li&quot;) åä»£é€‰æ‹©å™¨$(&quot;ul li&quot;) jQueryä¿®æ”¹æ ·å¼ï¼š$(&quot;div&quot;).css(&quot;å±æ€§&quot;, &quot;å€¼&quot;) jQueryæœ‰éšå¼è¿­ä»£ï¼Œå®ƒä¼šç»™åŒ¹é…åˆ°çš„æ‰€æœ‰å…ƒç´ è¿›è¡Œå¾ªç¯éå†ï¼Œæ‰§è¡Œç›¸åº”çš„æ–¹æ³•ï¼Œè€Œä¸ç”¨æˆ‘ä»¬å†å¾ªç¯ï¼Œç®€åŒ–æˆ‘ä»¬çš„æ“ä½œ //ä¸€æ¬¡æ€§å°†æ‰€æœ‰é€‰ä¸­çš„divå…ƒç´ èƒŒæ™¯é¢œè‰²æ”¹ä¸ºpinkï¼Œä¸å†éœ€è¦forå¾ªç¯ä¸€ä¸ªä¸€ä¸ªéå†æ›´æ”¹ $(\"div\").css(\"background\", \"pink\"); jQueryç­›é€‰é€‰æ‹©å™¨ $(&quot;li:first&quot;) é€‰ä¸­ç¬¬ä¸€ä¸ª $(&quot;li:last&quot;) é€‰ä¸­æœ€åä¸€ä¸ª $(&quot;li:eq(x)&quot;) é€‰ä¸­ç´¢å¼•å·ä¸ºxçš„å…ƒç´  $(&quot;li:odd&quot;) é€‰ä¸­ç´¢å¼•å·ä¸ºå¥‡æ•°çš„å…ƒç´  $(&quot;li:even&quot;) é€‰ä¸­ç´¢å¼•å·ä¸ºå¶æ•°çš„å…ƒç´  $(&quot;div&quot;).parent(); è¿”å›çš„æ˜¯æœ€è¿‘ä¸€çº§çš„çˆ¶å…ƒç´  $(&quot;div&quot;).parents(); è¿”å›çš„æ˜¯æ‰€æœ‰ç¥–å…ˆå…ƒç´ çš„æ•°ç»„ï¼Œå¯ä»¥åˆ¶å®šâ€()â€é‡Œçš„ç±»åå•ç‹¬æŒ‡å®šæ˜¯å“ªä¸ªç¥–å…ˆ $(&quot;div&quot;).children(&quot;ul&quot;); è¿”å›æŒ‡å®šçš„äº²å„¿å­ï¼Œç±»ä¼¼äºå­ä»£é€‰æ‹©å™¨div&gt;ul $(&quot;div&quot;).find(&quot;li&quot;); å¯ä»¥é€‰å®šæŒ‡å®šçš„æ‰€æœ‰å­©å­ï¼Œç±»ä¼¼äºåä»£é€‰æ‹©å™¨ div li $(&quot;.item&quot;).sibling(&quot;li&quot;); å¯ä»¥é€‰å®šé™¤æœ¬èº«å¤–æ‰€æœ‰äº²å…„å¼Ÿå…ƒç´  $(&quot;li&quot;).eq(x); é€‰ä¸­ç´¢å¼•å·ä¸ºxçš„å…ƒç´ , ç±»ä¼¼$(&quot;li:eq(x)&quot;) ï¼Œä½†æ˜¯æ­¤æ–¹æ³•æ›´æ¨è $(&quot;li&quot;).hasCLass(&quot;ç±»å&quot;); æŸ¥çœ‹æ˜¯å¦æœ‰è¯¥ç±»åï¼Œè¿”å›trueæˆ–false jqueryä¸­çš„å¿«é€Ÿå®ç°æ’ä»–æ€æƒ³ï¼š $(function() { $(\"button\").click(function() { $(this).css(\"background\",\"pink\"); $(this).siblings(\"button\").css(\"background\", \"\") }) }) jQueryå¯ä»¥å¿«é€Ÿå¾—åˆ°å½“å‰å…ƒç´ ç´¢å¼•å·ï¼Œä¸å†éœ€è¦è‡ªå·±æ·»åŠ è‡ªå®šä¹‰å±æ€§index $(this).index() $(&quot;xxx:checked&quot;) é€‰æ‹©å¤é€‰æ¡†ä¸­è¢«é€‰æ‹©çš„å…ƒç´ ï¼ˆ$(&quot;xxx:checked&quot;).lengthä¸ºè¢«é€‰ä¸­å¤é€‰æ¡†ä¸ªæ•°ï¼‰ jqueryæ ·å¼æ“ä½œä½¿ç”¨cssæ–¹æ³•ï¼š 1.å‚æ•°åªå†™å±æ€§åï¼Œè¿”å›å±æ€§å€¼ $(this).css(&quot;color&quot;) 2.è®¾ç½®æ ·å¼ï¼Œå±æ€§åå¿…é¡»åŠ å¼•å·ï¼Œå¦‚æœå±æ€§å€¼å€¼å¦‚æœæ˜¯æ•°å­—å¯ä»¥ä¸ç”¨è·Ÿå•ä½å’Œå¼•å· $(this).css(&quot;color&quot;, &quot;red&quot;) 3.å‚æ•°å¯ä»¥ç”¨å¯¹è±¡çš„å½¢å¼(é‡Œé¢çš„å±æ€§åä¸ç”¨åŠ å¼•å·ï¼Œå¦‚æœå¦‚æœå±æ€§å€¼å€¼å¦‚æœæ˜¯æ•°å­—å¯ä»¥ä¸ç”¨è·Ÿå•ä½å’Œå¼•å·) å¦‚æœæ˜¯å¤åˆå±æ€§å¿…é¡»é‡‡å–é©¼å³°å‘½åæ³•ï¼ˆå’ŒDOMä¸€æ ·ï¼‰ $(this).css({ width: 400, height: 400, backgroundColor: \"green\" }) ç›´æ¥è®¾ç½®ç±»æ–¹å¼ï¼š å†å†™ä¸€ä¸ªç±»ï¼Œé‡Œé¢åŒ…å«äº†æ‰€æœ‰ä½ æƒ³è¦æ”¹å˜çš„æ ·å¼ï¼Œç„¶ååˆ©ç”¨jQueryæ·»åŠ ç±»åŠŸèƒ½ï¼Œå°†å…¶æ·»åŠ è¿›å»ï¼ˆæ³¨æ„ç›´æ¥æ·»åŠ ç±»åï¼Œä¸éœ€è¦ â€œ.ç±»åâ€ï¼‰ (åŸç”Ÿjsçš„classNameè¿›è¡Œæ›´æ”¹ä¼šè¦†ç›–åŸå…ˆçš„ç±»å) // 1. æ·»åŠ ç±» addClass() $(\"div\").click(function() { $(this).addClass(\"current\"); }); // 2. åˆ é™¤ç±» removeClass() $(\"div\").click(function() { $(this).removeClass(\"current\"); }); // 3. åˆ‡æ¢ç±» toggleClass() $(\"div\").click(function() { $(this).toggleClass(\"current\"); }); jQueryæ•ˆæœæ˜¾ç¤ºå’Œéšè—æ•ˆæœ show([speed, [easing], [fn]]) æ˜¾ç¤ºåŠŸèƒ½ï¼Œå‚æ•°å¯ä»¥çœç•¥ï¼Œ speedï¼šä¸‰ç§é¢„å®šå­—ç¬¦ä¸²ï¼ˆâ€speedâ€,â€normalâ€,â€fastâ€ï¼‰ã€æˆ–è€…ä½¿ç”¨æ¯«ç§’æ•°è¡¨ç¤º easingï¼šswingï¼ˆåœ¨å¼€å¤´/ç»“å°¾ç§»åŠ¨æ…¢ï¼Œåœ¨ä¸­é—´ç§»åŠ¨å¿«ï¼‰ã€linearï¼ˆåŒ€é€Ÿï¼‰ fnï¼šå›è°ƒå‡½æ•° hide([speed, [easing], [fn]]) éšè—åŠŸèƒ½ï¼ŒåŒä¸Š toggle([speed, [easing], [fn]]) åˆ‡æ¢ï¼ˆåŸæœ¬æ˜¾ç¤ºåˆ™éšè—ï¼ŒåŸæœ¬éšè—åˆ™æ˜¾ç¤ºï¼‰ æ»‘åŠ¨ slideDown([speed, [easing], [fn]]) ä¸‹æ‹‰æ˜¾ç¤ºï¼Œç±»ä¼¼äºæ‰‹æœºå®˜ç½‘é‚£äº›ä¸‹æ‹‰èœå•ï¼Œå‚æ•°åŠŸèƒ½åŒä¸Š slideUp([speed, [easing], [fn]]) ä¸Šæ‹‰éšè—ï¼Œå‚æ•°åŒä¸Š slideToggle([speed, [easing], [fn]]) æ‹‰åŠ¨åˆ‡æ¢ï¼Œå‚æ•°åŒä¸Š äº‹ä»¶åˆ‡æ¢ hover([over],out) over: é¼ æ ‡ç§»åˆ°å…ƒç´ ä¸Šè§¦å‘çš„å‡½æ•°ï¼ˆç›¸å½“äºmouseenterï¼‰ outï¼šé¼ æ ‡ç§»å‡ºå…ƒç´ è§¦å‘çš„å‡½æ•°ï¼ˆç±»ä¼¼äºmouseleaveï¼‰ ç®€æ´ä¸‹æ‹‰èœå• $(\".nav>li\").hover(function() { $(this).children(\"ul\").slideDown(200); }, function() { $(this).children(\"ul\").slideUp(200); }); æˆ–è€… $(\".nav>li\").hover(function() { $(this).children(\"ul\").slideToggle(); }); åŠ¨ç”»é˜Ÿåˆ—å’Œå…¶åœæ­¢æ–¹æ³• ä¸Šè¿°ä¸‹æ‹‰èœå•ä»£ç æœ‰ä¸€ä¸ªé—®é¢˜ åŠ¨ç”»æˆ–è€…æ•ˆæœä¸€æ—¦è§¦å‘å°±ä¼šæ‰§è¡Œï¼Œå¦‚æœå¤šæ¬¡è§¦å‘ï¼Œå°±é€ æˆå¤šä¸ªåŠ¨ç”»æˆ–è€…æ•ˆæœçš„æ’é˜Ÿæ‰§è¡Œï¼ˆå³é¼ æ ‡ä¸€æ¬¡æ€§ç»è¿‡å¤šä¸ªé€‰é¡¹ï¼Œå¯¼è‡´é¼ æ ‡åœ¨ä¸€è¾¹åœä¸‹æ¥äº†ä¹‹åï¼ŒåŠ¨ç”»è¿˜åœ¨æ‰§è¡Œï¼ˆå› ä¸ºè¿˜æ²¡æ‰§è¡Œå®Œæ¯•ï¼‰ï¼‰ åœæ­¢æ’é˜Ÿï¼š stop() stop()ç”¨äºåœæ­¢åŠ¨ç”»æˆ–è€…æ•ˆæœï¼Œå°†å…¶å†™åœ¨åŠ¨ç”»æˆ–è€…æ•ˆæœçš„å‰é¢ï¼Œç›¸å½“äºåœæ­¢ç»“æŸä¸Šä¸€æ¬¡çš„åŠ¨ç”» //ä¸Šè¿°ç¤ºä¾‹æ”¹è¿›ï¼š $(\".nav>li\").hover(function() { $(this).children(\"ul\").stop().slideToggle(); }); æ·¡å…¥æ·¡å‡º fadeIn([speed, [easing], [fn]]) æ·¡å…¥åŠŸèƒ½ï¼Œå‚æ•°å¯ä»¥çœç•¥ï¼Œ speedï¼šä¸‰ç§é¢„å®šå­—ç¬¦ä¸²ï¼ˆâ€speedâ€,â€normalâ€,â€fastâ€ï¼‰ã€æˆ–è€…ä½¿ç”¨æ¯«ç§’æ•°è¡¨ç¤º easingï¼šswingï¼ˆåœ¨å¼€å¤´/ç»“å°¾ç§»åŠ¨æ…¢ï¼Œåœ¨ä¸­é—´ç§»åŠ¨å¿«ï¼‰ã€linearï¼ˆåŒ€é€Ÿï¼‰ fnï¼šå›è°ƒå‡½æ•° fadeOut([speed, [easing], [fn]]) æ·¡å‡º fadeToggle([speed, [easing], [fn]]) æ·¡å…¥æ·¡å‡ºåˆ‡æ¢ fadeTo([speed, opacity, [easing], [fn]]) ä»¥æ¸è¿›çš„æ–¹æ³•ä¿®æ”¹é€æ˜åº¦ï¼Œopacityä¸ºé€æ˜åº¦ï¼Œå¿…é¡»å†™ï¼Œå–å€¼èŒƒå›´0~1ï¼Œspeedä¹Ÿå¿…é¡»å†™ è‡ªå®šä¹‰åŠ¨ç”»animate animate(params, [speed], [easing], [fn]) paramsï¼šæƒ³è¦æ›´æ”¹çš„æ ·å¼å±æ€§ï¼Œä»¥å¯¹è±¡çš„å½¢å¼ä¼ é€’ï¼Œå¿…é¡»å†™ï¼Œå±æ€§åå¯ä»¥ä¸å¸¦å¼•å·ï¼Œå¦‚æœæ˜¯å¤åˆå±æ€§éœ€è¦é‡‡å–é©¼å³°å‘½åæ³• å…¶ä»–çš„speedã€easingã€fnå’Œä¹‹å‰ç›¸åŒ $(&quot;div&quot;).animate({ left: 500, top: 300, opacity: .4, width: 500 }, 500);4.jQueryå±æ€§æ“ä½œelement.prop(&quot;å±æ€§å&quot;) è·å–å±æ€§å€¼ï¼ˆå›ºæœ‰çš„å±æ€§å€¼ï¼‰ element.prop(&quot;å±æ€§å&quot;, &quot;å±æ€§å€¼&quot;) è®¾ç½®å±æ€§å€¼ element.attr(&quot;å±æ€§å&quot;) è·å–å±æ€§å€¼ï¼ˆè‡ªå®šä¹‰å±æ€§ï¼‰ï¼Œç±»ä¼¼åŸç”Ÿçš„getArribute element.attr(&quot;å±æ€§å&quot;, &quot;å±æ€§å€¼&quot;) è®¾ç½®å±æ€§å€¼ï¼ˆè‡ªå®šä¹‰å±æ€§ï¼‰ï¼Œç±»ä¼¼åŸç”Ÿçš„setArribute element.data(&quot;å±æ€§å&quot;, &quot;å±æ€§å€¼&quot;) è®¾ç½®æ•°æ®ç¼“å­˜ï¼Œdataé‡Œçš„æ•°æ®æ˜¯å­˜æ”¾åœ¨å…ƒç´ çš„å†…å­˜ä¸­ï¼Œè€Œä¸æ˜¯ä½œä¸ºå±æ€§ï¼ˆè¿™ä¸ªæ–¹æ³•å¯ä»¥è·å–data-index å³h5è‡ªå¸¦çš„è‡ªå®šä¹‰å±æ€§ï¼Œä¸ç”¨å†™data-ï¼Œå†™æˆ$(â€œdivâ€).data(â€œindexâ€)ï¼‰ 5.jQueryå†…å®¹æ–‡æœ¬å€¼element.html() è·å–å…ƒç´ å†…å®¹ï¼ˆåŒ…å«æ ‡ç­¾ï¼‰ ç›¸å½“äºåŸç”Ÿçš„innerHTML element.html(&quot;å†…å®¹&quot;) è®¾ç½®å…ƒç´ å†…å®¹ element.text() è·å–å…ƒç´ å†…å®¹ï¼ˆä¸åŒ…å«æ ‡ç­¾ï¼‰ ç›¸å½“äºåŸç”Ÿçš„innerText element.text(&quot;å†…å®¹&quot;) è®¾ç½®å…ƒç´ å†…å®¹ element.val() è·å–è¡¨å•å€¼ element.val(&quot;è¡¨å•å€¼&quot;) è®¾ç½®è¡¨å•å€¼ 6.jQueryçš„å…ƒç´ æ“ä½œè™½ç„¶jqueryæœ‰éšå¼è¿­ä»£ï¼Œä½†æ˜¯åªæ˜¯å¯¹åŒç±»å…ƒç´ åšç›¸åŒæ“ä½œï¼Œå¦‚æœæƒ³è¦ç»™ä¸åŒå…ƒç´ è¿›è¡Œä¸åŒçš„æ“ä½œï¼Œå°±éœ€è¦ä½¿ç”¨åˆ°éå† jQueryçš„éå†$(&quot;div&quot;).each(function (index, domEle) { xxxx; }) indexï¼ˆç¬¬ä¸€ä¸ªå‚æ•°ï¼‰æ˜¯æ¯ä¸ªå…ƒç´ çš„ç´¢å¼•å·ï¼ŒdomELeï¼ˆç¬¬äºŒä¸ªå‚æ•°ï¼‰æ˜¯éå†åçš„æ¯ä¸ªDOMå…ƒç´ å¯¹è±¡ï¼Œä¸æ˜¯jQueryå¯¹è±¡ï¼Œå¦‚æœæƒ³ä½¿ç”¨jQueryæ–¹æ³•ï¼Œéœ€è¦ç»™è¿™ä¸ªdomå…ƒç´ è½¬æ¢ä¸ºjQueryå¯¹è±¡ï¼ˆ$(domEle)ï¼‰ $.each(object, function(index, element) { xxx; }) $.each() æ–¹æ³•å¯ä»¥ç”¨äºéå†ä»»ä½•å¯¹è±¡ï¼Œä¸»è¦ç”¨äºæ•°æ®å¤„ç†ï¼Œå¦‚æ•°ç»„ã€å¯¹è±¡ï¼Œindexï¼ˆç¬¬ä¸€ä¸ªå‚æ•°ï¼‰ä¸ºç´¢å¼•å·ï¼ˆå¦‚æœæ˜¯å¯¹è±¡ï¼Œåˆ™ä¸ºå±æ€§åï¼‰ï¼Œelementï¼ˆç¬¬äºŒä¸ªå‚æ•°ï¼‰ä¸ºéå†å†…å®¹ï¼ˆå¦‚æœæ˜¯å¯¹è±¡ï¼Œåˆ™ä¸ºå±æ€§å€¼ï¼‰ åˆ›å»ºå…ƒç´  $(&quot;&lt;li&gt;&lt;/li&gt;&quot;) åŠ¨æ€åˆ›å»ºä¸€ä¸ªliæ ‡ç­¾ æ·»åŠ å…ƒç´ ï¼ˆåˆ›å»ºå®Œä¹‹åéœ€è¦æ·»åŠ å…ƒç´ ï¼‰ å†…éƒ¨æ·»åŠ ï¼šï¼ˆç”Ÿæˆåå®ƒä»¬æ˜¯çˆ¶å­å…³ç³»ï¼‰ element.append(&quot;å†…å®¹&quot;) æ”¾åˆ°åŒ¹é…å…ƒç´ çš„æœ€åé¢ï¼Œç±»ä¼¼äºåŸç”Ÿçš„appendChild element.prepend(&quot;å†…å®¹&quot;) æ”¾åˆ°åŒ¹é…å…ƒç´ çš„æœ€å‰ï¼Œç±»ä¼¼äºåŸç”Ÿçš„ul.insertBefore(xx, ul.children[0])(æŒ‡å®šå…ƒç´ çš„å‰é¢) å¤–éƒ¨æ·»åŠ ï¼šï¼ˆç”Ÿæˆåå®ƒä»¬æ˜¯å…„å¼Ÿå…³ç³»ï¼‰ å¤–éƒ¨æ·»åŠ ï¼šelement.after(&quot;å†…å®¹&quot;) æŠŠå†…å®¹æ”¾å…¥ç›®æ ‡å…ƒç´ çš„åé¢ element.before(&quot;å†…å®¹&quot;) æŠŠå†…å®¹æ”¾å…¥ç›®æ ‡å…ƒç´ å‰é¢ åˆ é™¤å…ƒç´ element.remove() åˆ é™¤åŒ¹é…å…ƒç´  element.empty() åˆ é™¤åŒ¹é…å…ƒç´ çš„æ‰€æœ‰å­èŠ‚ç‚¹ element.html(&quot;&quot;) æ¸…ç©ºåŒ¹é…å…ƒç´ çš„å†…å®¹ï¼ˆå­©å­ï¼‰ 7.jQueryäº‹ä»¶äº‹ä»¶æ³¨å†Œelement.äº‹ä»¶(function() {}) å•ä¸ªäº‹ä»¶æ³¨å†Œ å¦‚ $(&quot;div&quot;).click(function() {äº‹ä»¶å¤„ç†}) å…¶ä»–äº‹ä»¶å’ŒåŸç”ŸåŸºæœ¬ä¸€è‡´ äº‹ä»¶å¤„ç†on(å¯ä»¥ç»‘å®šå¤šä¸ªäº‹ä»¶)on() æ–¹æ³•åœ¨åŒ¹é…å…ƒç´ ä¸Šç»‘å®šä¸€ä¸ªæˆ–å¤šä¸ªäº‹ä»¶çš„äº‹ä»¶å¤„ç†å‡½æ•° element.on(events, [selector], fn) 1.events: ä¸€ä¸ªæˆ–å¤šä¸ªç”¨ç©ºæ ¼çš„äº‹ä»¶ç±»å‹ï¼Œå¦‚â€clickâ€ 2.selector: å…ƒç´ çš„å­å…ƒç´ é€‰æ‹©å™¨ 3.fnï¼šå›è°ƒå‡½æ•°ï¼Œå³ç»‘å®šåœ¨å…ƒç´ èº«ä¸Šå¾—åˆ°ä¾¦å¬å‡½æ•° å¦‚ $(\"div\").on({ mouseenter: function() { //xxxxx }, click: function() { //xxxxx }, mouseleave: function() { //xxxx } }) ä¸åŒäº‹ä»¶ç±»å‹è§¦å‘åŒä¸€å¤„ç†å‡½æ•°ï¼š $(&quot;div&quot;).on(&quot;mouseenter mouseleave&quot;, function() {}) onçš„ä¼˜åŠ¿2ï¼šå¯ä»¥è¿›è¡Œäº‹ä»¶å§”æ‰˜å¦‚ //ä¼ ç»Ÿï¼Œä½†æ˜¯ç»™æ¯ä¸ªliéƒ½æ·»åŠ äº†ä¸€ä¸ªäº‹ä»¶ï¼Œæ¯”è¾ƒéº»çƒ¦ $(\"ul li\").click(); //äº‹ä»¶æ˜¯ç»‘å®šåœ¨ulèº«ä¸Šï¼Œä½†æ˜¯è§¦å‘å¯¹è±¡æ—¶liï¼Œliäº‹ä»¶å†’æ³¡ï¼Œå†’æ³¡åˆ°çˆ¶çº§çš„ç‚¹å‡»äº‹ä»¶ç„¶åæ‰§è¡Œç¨‹åº $(\"ul\").on(\"click\", \"li\", function() { }) æ­¤å‰æœ‰blind()ã€live()ç­‰æ–¹æ³•å¤„ç†äº‹ä»¶ç»‘å®šæˆ–äº‹ä»¶å§”æ‰˜ï¼Œä½†æ˜¯æˆ‘ä»¬æœ€æ–°ç‰ˆæœ¬ç”¨onå°±è¡Œäº† onçš„ä¼˜åŠ¿3ï¼šåŠ¨æ€åˆ›å»ºå…ƒç´ ï¼Œonå¯ä»¥ç»™æœªæ¥åŠ¨æ€åˆ›å»ºçš„å…ƒç´ ç»‘å®šäº‹ä»¶//ä¼ ç»Ÿï¼Œå‰é¢ç»‘å®šäº‹ä»¶ï¼Œåé¢åˆ›å»ºçš„æ ‡ç­¾æ²¡æœ‰ç»‘å®šè¯¥äº‹ä»¶ $(\"ol li\").click(function() {}) let li = $(\"&lt;li>xxx&lt;/li>\"); $(\"ol\").append(li); //ä½¿ç”¨on,ä¹‹ååˆ›å»ºçš„ä¹Ÿèƒ½è¢«ç»™äºˆç»‘å®šæ•ˆæœ $(\"ol\").on(\"click\", \"li\", function() {}) let li = $(\"&lt;li>xxx&lt;/li>\"); $(\"ol\").append(li); äº‹ä»¶offè§£ç»‘off()æ–¹æ³•å¯ä»¥ç§»é™¤é€šè¿‡on()æ–¹æ³•æ·»åŠ çš„äº‹ä»¶å¤„ç†ç¨‹åº element.off() è§£ç»‘è¯¥å…ƒç´ ä¸Šæ‰€æœ‰äº‹ä»¶ element.off(&quot;click&quot;) è§£ç»‘è¯¥å…ƒç´ ä¸Šç‚¹å‡»äº‹ä»¶ $(&quot;ul&quot;).on(&quot;click&quot;, &quot;li&quot;, function() {}) $(&quot;ul&quot;).off(&quot;click&quot;, &quot;li&quot;) è§£é™¤äº‹ä»¶å§”æ‰˜ åªä½¿ç”¨ä¸€æ¬¡: ç”¨one()æ¥ç»‘å®šæœ‰çš„äº‹ä»¶åªæƒ³è§¦å‘ä¸€æ¬¡ï¼Œå¯ä»¥ä½¿ç”¨oneæ¥ç»‘å®š element.one(event, fn) è‡ªåŠ¨è§¦å‘äº‹ä»¶triggeræ¯”å¦‚clickäº‹ä»¶ï¼š 1.element.click() 2.element.trigger(&quot;click&quot;) å’Œä¸Šé¢çš„å·®ä¸å¤š 3.element.triggerHandler(&quot;click&quot;) triggerHandlerä¸ä¼šè§¦å‘å…ƒç´ é»˜è®¤è¡Œä¸ºï¼ˆåŒ…æ‹¬è¯¥å…ƒç´ ç»‘å®šçš„å…¶ä»–è¡Œä¸ºï¼‰ï¼Œåªè§¦å‘â€clickâ€ äº‹ä»¶å¯¹è±¡element.on(events, [selector], function(event) {}) ä¸­çš„eventä¸ºäº‹ä»¶å¯¹è±¡ event.preventDefault() æˆ–è€…return false ç”¨äºé˜»æ­¢é»˜è®¤è¡Œä¸º event.stopPropagation() å°†å…¶å†™äºäº‹ä»¶å‡½æ•°ä¸­ï¼Œå¯ä»¥ç”¨äºé˜»æ­¢å†’æ³¡ 8.jQueryçš„å…¶ä»–æ–¹æ³•jQueryæ‹·è´å¯¹è±¡$.extend([deep], target, object1, [objectN])ï¼ˆå¦‚æœæœ‰å†²çªçš„ï¼Œä¼šè¦†ç›–æ‰targetObj é‡Œé¢åŸæ¥çš„æ•°æ®ï¼‰ 1.deep: å¦‚æœä¸ºtrueä¸ºæ·±æ‹·è´ï¼Œé»˜è®¤falseä¸ºæµ…æ‹·è´ ï¼ˆæ³¨æ„æ˜¯å¤æ‚æ•°æ®ç±»å‹ï¼‰æµ…æ‹·è´æ˜¯æŠŠè¢«æ‹·è´çš„å¯¹è±¡å¤æ‚æ•°æ®ç±»å‹ä¸­çš„åœ°å€æ‹·è´ç»™ç›®æ ‡å¯¹è±¡ï¼Œä¿®æ”¹ç›®æ ‡å¯¹è±¡ä¼šå½±å“è¢«æ‹·è´çš„å¯¹è±¡ï¼Œå¦‚æœè¯¥å¤æ‚æ•°æ®ç±»å‹å¯¹è±¡æœ‰å†²çªï¼Œç›´æ¥è¦†ç›–æ‰ æ·±æ‹·è´ï¼Œå®Œå…¨å…‹éš†ï¼Œå¯¹äºå¤æ‚æ•°æ®ç±»å‹æ‹·è´çš„æ˜¯å¯¹è±¡ï¼Œä¸æ˜¯åœ°å€ï¼Œä¿®æ”¹ç›®æ ‡å¯¹è±¡ä¸ä¼šå½±å“è¢«æ‹·è´çš„å¯¹è±¡ï¼ˆå¦‚æœè¯¥å¤æ‚æ•°æ®ç±»å‹å¯¹è±¡æœ‰å†²çªï¼Œä½†æ˜¯é‡Œé¢çš„å±æ€§ä¸å†²çªï¼Œåˆ™å±æ€§ä¼šåˆå¹¶åœ¨ä¸€èµ·ï¼‰ //æ·±æ‹·è´æ—¶targetObjectçš„msgä¼šä¸objçš„msgåˆå¹¶ //æ­¤æ—¶éƒ½æœ‰idï¼Œobjçš„idä¼šè¦†ç›–æ‰targetObjectçš„id var targetObject = { id: 0, msg: { sex: 'ç”·' //å¯¹è±¡å¤æ‚æ•°æ®ç±»å‹ } }; var obj = { id: 1, name: 'andy', msg: { age: 18 } } $.extend(targetObject,obj); 2.targetï¼šè¦æ‹·è´çš„ç›®æ ‡å¯¹è±¡ 3.object1ï¼šå¾…è¢«æ‹·è´åˆ°ç¬¬ä¸€ä¸ªå¯¹è±¡çš„å¯¹è±¡ ï¼ˆobjectæ‹·è´ç»™targetï¼‰ jQueryÂ·å¤šåº“å…±å­˜éšç€jqueryçš„æµè¡Œï¼Œå…¶ä»–jsåº“ä¹Ÿä¼šä½¿ç”¨$ä½œä¸ºæ ‡è¯†ç¬¦ï¼Œè¿™æ ·ä¸€èµ·ä½¿ç”¨ä¼šèµ·å†²çª éœ€è¦ä¸€ä¸ªè§£å†³æ–¹æ¡ˆï¼Œè®©jQueryå’Œå…¶ä»–jsåº“ä¸å­˜åœ¨å†²çªï¼Œå¯ä»¥åŒæ—¶å­˜åœ¨ï¼Œè¿™å°±å«åšå¤šåº“å…±å­˜ jqueryè§£å†³æ–¹æ¡ˆï¼š 1.æŠŠé‡Œé¢çš„$ç¬¦å·ç»Ÿä¸€æ”¹ä¸ºjQuery ï¼Œæ¯”å¦‚jQuery(â€œdivâ€) 2.è‡ªå®šä¹‰ï¼Œé‡Šæ”¾å¯¹$å¯¹æ§åˆ¶æƒ var suibian = $.noConflict(); //var suibian = jQuery.noConflict(); suibian(\"span\") //åŸæœ¬æ˜¯$(\"span\") jQueryæ’ä»¶jQueryåŠŸèƒ½æ¯”è¾ƒæœ‰é™ï¼Œæƒ³è¦æ›´åŠ å¤æ‚çš„æ•ˆæœï¼Œå¯ä»¥å€ŸåŠ©jQueryæ’ä»¶ï¼ˆæ³¨ï¼šè¿™äº›æ’ä»¶æ˜¯ä¾èµ–äºjQueryï¼Œæ‰€ä»¥å¿…é¡»å…ˆå¼•å…¥jQueryæ–‡ä»¶ï¼Œå› æ­¤ä¹Ÿæˆä¸ºjQueryæ’ä»¶ï¼‰ jqueryå¸¸ç”¨ç½‘ç«™ï¼š 1.jQueryæ’ä»¶åº“ï¼šhttp://www.jq22.com/ 2.jQueryä¹‹å®¶ï¼šhttp://www.htmleaf.com/ (æ¨è) jQueryæ’ä»¶ä½¿ç”¨æ­¥éª¤ï¼š1.å¼•å…¥ç›¸å…³æ–‡ä»¶ï¼ˆjQueryã€æ’ä»¶æ–‡ä»¶ï¼‰ 2.èµ‹å€¼ç›¸å…³htmlã€cssã€js å›¾ç‰‡æ‡’åŠ è½½: åœ¨jQueryÂ·æ’ä»¶å¯ä»¥æ‰¾åˆ°ï¼Œå›¾ç‰‡åªåŠ è½½åˆ°å¯è§†åŒºåŸŸï¼Œå‡ç¼“æœåŠ¡å™¨å‹åŠ› å…¨å±æ»šåŠ¨ï¼šjQueryçš„fullPage.jsä¹Ÿååˆ†å¥½ç”¨ bootstrapä¹Ÿæ˜¯ä¾èµ–äºjQueryå¼€å‘çš„ï¼Œå› æ­¤é‡Œé¢çš„jsæ’ä»¶ä½¿ç”¨ï¼Œä¹Ÿå¿…é¡»å¼•å…¥jQueryæ–‡ä»¶ jQueryçš„ä½ç½®ä½ç½®ä¸»è¦æœ‰ä¸‰ä¸ªï¼šoffset()å¯è®¾ç½®ã€ position()åªè¯»ã€ scrollTop()/scollLeft()å¯è®¾ç½® element.offset() è¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œé‡Œé¢åŒ…å«leftå’Œtopï¼Œç”¨äºè®¾ç½®æˆ–è·å–ç›¸å¯¹äºæ–‡æ¡£documentçš„åç§»åæ ‡ ä½†æ˜¯å’ŒåŸç”Ÿä¸åŒçš„æ˜¯ï¼Œå®ƒå¯ä»¥è®¾ç½®åç§»ï¼šelement.offset({top: 10, left: 30})ï¼Œä¸”åŸç”Ÿjsçš„offsetè¿”å›çš„æ˜¯ç›¸å¯¹äºçˆ¶å…ƒç´ çš„åç§»é‡ element.position() è·å–å¸¦æœ‰ç›¸å¯¹äºçˆ¶çº§çš„åç§»è·ç¦»ï¼Œå¦‚æœæ²¡æœ‰å®šä¹‰çˆ¶çº§ï¼Œåˆ™ä»¥æ–‡æ¡£ä¸ºå‡†ï¼Œä½†æ˜¯æ­¤æ–¹æ³•åªèƒ½è·å–ä¸èƒ½è®¾ç½® element.scrollTop()/element.scrollLeft()è®¾ç½®æˆ–è·å–è¢«å·å»çš„å¤´éƒ¨å’Œå·¦ä¾§ï¼Œç±»ä¼¼äºåŸç”Ÿjsè‡ªå¸¦çš„å…ƒç´ æ»šåŠ¨scroll","categories":[{"name":"å‰ç«¯","slug":"å‰ç«¯","permalink":"https://taylor12138.github.io/categories/%E5%89%8D%E7%AB%AF/"}],"tags":[],"author":"Hello"},{"title":"å‰ç«¯å…³äºå­˜å‚¨","slug":"å‰ç«¯å…³äºå­˜å‚¨","date":"2020-11-27T16:00:00.000Z","updated":"2022-05-28T02:27:42.473Z","comments":true,"path":"2020/11/28/qian-duan-guan-yu-cun-chu/","link":"","permalink":"https://taylor12138.github.io/2020/11/28/qian-duan-guan-yu-cun-chu/","excerpt":"","text":"æœ¬åœ°å­˜å‚¨ä½¿ç”¨HTML5å¯ä»¥åœ¨æœ¬åœ°å­˜å‚¨ç”¨æˆ·çš„æµè§ˆæ•°æ®ï¼šlocal Storageã€session Storage 1.æ•°æ®å­˜å‚¨äºè‡ªå·±çš„æµè§ˆå™¨å½“ä¸­ 2.è®¾ç½®ã€è¯»å–ååˆ†æ–¹ä¾¿ï¼Œé¡µé¢åˆ·æ–°æ•°æ®ä¸ä¸¢å¤± 3.å®¹é‡è¾ƒå¤§ï¼ŒsessionStorageçº¦5Mï¼ŒlocalStorageçº¦20Mï¼ˆå¯æ˜¯æˆ‘æµ‹è¯•å¾—åˆ°æˆ‘chromeæµè§ˆå™¨localStorageæ‰5Mï¼‰ 4.åªèƒ½å­˜å‚¨å­—ç¬¦ä¸²ï¼Œå¯ä»¥å°†å¯¹è±¡JSON.stringify() ç¼–ç åå­˜å‚¨ cookieæ˜¯ç½‘ç«™ä¸ºäº†æ ‡ç¤ºç”¨æˆ·èº«ä»½è€Œå‚¨å­˜åœ¨ç”¨æˆ·æœ¬åœ°ç»ˆç«¯ä¸Šçš„æ•°æ®ï¼›cookieæ•°æ®å§‹ç»ˆåœ¨åŒæºçš„httpè¯·æ±‚ä¸­æºå¸¦ï¼ˆå³ä½¿ä¸éœ€è¦ï¼‰ï¼Œä¹Ÿä¼šåœ¨æµè§ˆå™¨å’ŒæœåŠ¡å™¨é—´æ¥å›ä¼ é€’ã€‚sessionStorageå’ŒlocalStorageä¸ä¼šè‡ªåŠ¨æŠŠæ•°æ®å‘ç»™æœåŠ¡å™¨ï¼Œä»…åœ¨æœ¬åœ°ä¿å­˜ï¼› 5.æ­¤å¤–ï¼ŒUser Data æ˜¯å¾®è½¯ä¸“é—¨ä¸ºIEåœ¨ç³»ç»Ÿä¸­å¼€è¾Ÿçš„ä¸€å—å­˜å‚¨ç©ºé—´ï¼Œå•ä¸ªæ–‡ä»¶é™åˆ¶å¤§å°128kbï¼Œä¸€ä¸ªåŸŸåä¸‹å¯ä¿å­˜1M window.sessionStorage1.ç”Ÿå‘½å‘¨æœŸä¸ºå…³é—­æµè§ˆå™¨çª—å£ 2.åŒä¸€ä¸ªçª—å£ä¸‹æ•°æ®å¯ä»¥å…±äº« 3.ä»¥é”®å€¼å¯¹çš„å½¢å¼å­˜å‚¨ä½¿ç”¨ window.sessionStorage.setItem(key, value) åˆ†åˆ«å¯¹åº”é”®å’Œå€¼ï¼Œè®¾ç½®ï¼ˆæ·»åŠ æˆ–æ›´æ”¹ï¼‰ window.sessionStorage.getItem(&#39;key&#39;) è·å– window.sessionStorage.removeItem(&#39;key&#39;) åˆ é™¤ window.sessionStorage.clear() åˆ é™¤æ‰€æœ‰æ•°æ®(æ…ç”¨)ï¼Œä¸åœ¨Firefoxä¸­å®ç° 4.æ‰€æœ‰ç°ä»£æµè§ˆå™¨åœ¨å®ç°å­˜å‚¨å†™å…¥æ—¶éƒ½ä½¿ç”¨äº†åŒæ­¥é˜»å¡æ–¹å¼ï¼Œå› æ­¤æ•°æ®ä¼šè¢«ç«‹å³æäº¤åˆ°å­˜å‚¨ã€‚ï¼ˆé™¤äº†è€ç‰ˆIEï¼‰ window.localStorage1.ç”Ÿå‘½å‘¨æœŸæ°¸ä¹…ç”Ÿæ•ˆï¼Œé™¤éæ‰‹åŠ¨åˆ é™¤ï¼Œä¸ç„¶å…³é—­é¡µé¢ä»ç„¶å­˜åœ¨ 2.å¤šçª—å£å…±äº«ï¼ˆåŒä¸€æµè§ˆå™¨æ‰èƒ½å…±äº«ï¼‰ 3.ä»¥é”®å€¼å¯¹çš„å½¢å¼å­˜å‚¨ä½¿ç”¨ window.localStorage.setItem(key, value) åˆ†åˆ«å¯¹åº”é”®å’Œå€¼ï¼Œè®¾ç½®ï¼ˆæ·»åŠ æˆ–æ›´æ”¹ï¼‰ï¼ˆå€¼æ˜¯ä»¥å­—ç¬¦ä¸²çš„å½¢å¼è¿›è¡Œå­˜å‚¨çš„ï¼‰ window.localStorage.getItem(&#39;key&#39;) è·å– window.localStorage.removeItem(&#39;key&#39;) åˆ é™¤ window.localStorage.clear() åˆ é™¤æ‰€æœ‰æ•°æ®(æ…ç”¨)ï¼Œä¸åœ¨Firefoxä¸­å®ç° CookieCookieæ˜¯ä¸€ç§åœ¨å®¢æˆ·ç«¯ä¿æŒHTTPçŠ¶æ€ä¿¡æ¯çš„æŠ€æœ¯ï¼šhttpåè®®æ˜¯æ— çŠ¶æ€çš„ï¼Œä½†æ˜¯åœ¨å®é™…å·¥ä½œä¸­ï¼Œä¸€äº›ä¸‡ç»´ç½‘ç½‘ç«™å¸Œæœ›èƒ½è¯†åˆ«ç”¨æˆ·ï¼ˆç»™ç”¨æˆ·æ¨é”€äº§å“ï¼‰=&gt;è¯ç”Ÿäº†cookieå°é¥¼å¹²ï¼ˆç”±æœåŠ¡å™¨ç”Ÿæˆï¼‰ cookieæ˜¯å­˜å‚¨åœ¨ç”¨æˆ·ä¸»æœºçš„æ–‡æœ¬æ–‡ä»¶ï¼Œå­˜å‚¨åœ¨æµè§ˆå™¨ä¸­çš„çº¯æ–‡æœ¬ï¼Œæµè§ˆå™¨çš„å®‰è£…ç›®å½•ä¸‹ä¼šä¸“é—¨æœ‰ä¸€ä¸ª cookie æ–‡ä»¶å¤¹æ¥å­˜æ”¾å„ä¸ªåŸŸä¸‹è®¾ç½®çš„cookieï¼Œè®°å½•ä¸€æ®µæ—¶é—´å†…æŸç”¨æˆ·çš„è®¿é—®è®°å½• ä¸€æ—¦æµè§ˆå™¨ä¿å­˜äº†æŸä¸ªCookieï¼Œé‚£ä¹ˆä»¥åæ¯æ¬¡è®¿é—®æœåŠ¡å™¨æ—¶ï¼Œéƒ½ä¼šåœ¨HTTPè¯·æ±‚å¤´ä¸­å°†è¿™ä¸ªCookieå›ä¼ ç»™æœåŠ¡å™¨ï¼Œæ‰€ä»¥æˆ‘ä»¬å‰ç«¯è¿™é‡Œå‡ ä¹æ— éœ€ä»€ä¹ˆæ“ä½œï¼Œå‡ ä¹éƒ½æ˜¯åç«¯é‚£è¾¹åœ¨æ“ä½œ cookieæ•°æ®å¤§å°ä¸èƒ½è¶…è¿‡4k æŒä¹…åŒ–cookieè®¾ç½®çš„cookieè¿‡æœŸæ—¶é—´ä¹‹å‰ä¸€ç›´æœ‰æ•ˆï¼Œå³ä½¿çª—å£æˆ–æµè§ˆå™¨å…³é—­ ä½†æ˜¯å¦‚æœcookieä¸åŒ…å«åˆ°æœŸæ—¥æœŸï¼ˆExpires/Max-Ageï¼‰ï¼Œåˆ™å¯è§†ä¸ºä¼šè¯cookieï¼Œå®ƒåœ¨æµè§ˆå™¨å…³é—­åå°±æ¶ˆå¤±äº† WebæœåŠ¡å™¨æ€ä¹ˆç»™å®¢æˆ·ç«¯å‘Cookieçš„å‘¢ï¼ŸæœåŠ¡å™¨é€šè¿‡åœ¨HTTPå“åº”å¤´ä¸­å¢åŠ Set-Cookie:å­—æ®µï¼Œè€Œæµè§ˆå™¨åˆ™é€šè¿‡HTTPè¯·æ±‚å¤´å¢åŠ Cookieå­—æ®µå›ä¼  å·¥ä½œä¸­è¯†åˆ«ç”¨æˆ·ç»™ç”¨æˆ·æ¨é”€äº§å“ï¼Œç”¨æ¥ä¿å­˜ä¸€äº›ä¸å¤ªæ•æ„Ÿçš„æ•°æ®ï¼ˆä½†æˆ‘å¾ˆçº³é—·ï¼Œå…¶å®å¾ˆå¤šç”¨æˆ·ç”¨cookieæ¥è®°ä½å¯†ç ï¼Œä¸è¿‡æˆ‘çœ‹åˆ°ä¸€ä¸ªç­”æ¡ˆå°±æ˜¯ï¼šchromeæ˜¯åŠ å¯†çš„ï¼Œåªæ˜¯åœ¨å¯†ç ç®¡ç†é‡Œé¢æ˜æ–‡æ˜¾ç¤ºè€Œå·²ã€‚å®ƒæ˜¯ä½¿ç”¨ä½ Windowsçš„ç™»å½•å¯†ç åŠ å¯†çš„ï¼Œè¿˜æ˜¯æ¯”è¾ƒå®‰å…¨çš„ã€‚ï¼‰ tipsï¼šä¸€ä¸ªæµè§ˆå™¨é’ˆå¯¹ä¸€ä¸ªç½‘ç«™æœ€å¤šå­˜ 20 ä¸ªCookieï¼Œæµè§ˆå™¨ä¸€èˆ¬åªå…è®¸å­˜æ”¾ 300 ä¸ªCookieç§»åŠ¨ç«¯å¯¹ cookie çš„æ”¯æŒä¸æ˜¯å¾ˆå¥½ï¼Œè€Œ session éœ€è¦åŸºäº cookie å®ç°ï¼Œæ‰€ä»¥ç§»åŠ¨ç«¯å¸¸ç”¨çš„æ˜¯ token Cookieå±æ€§domainæ˜¯åŸŸå pathæ˜¯è·¯å¾„ ä¸¤è€…åŠ èµ·æ¥å°±æ„æˆäº† URLï¼Œdomainå’Œpathä¸€èµ·æ¥é™åˆ¶ cookie èƒ½è¢«å“ªäº› URL è®¿é—®ã€‚ æŸcookieçš„ domainä¸ºâ€œbaidu.comâ€, pathä¸ºâ€œ/ â€ï¼Œè‹¥è¯·æ±‚çš„URL(URL å¯ä»¥æ˜¯js/html/img/cssèµ„æºè¯·æ±‚ï¼Œä½†ä¸åŒ…æ‹¬ XHR è¯·æ±‚)çš„åŸŸåæ˜¯â€œbaidu.comâ€æˆ–å…¶å­åŸŸå¦‚â€œapi.baidu.comâ€ã€â€œdev.api.baidu.comâ€ï¼Œä¸” URL çš„è·¯å¾„æ˜¯â€œ/ â€æˆ–å­è·¯å¾„â€œ/homeâ€ã€â€œ/home/loginâ€ï¼Œåˆ™æµè§ˆå™¨ä¼šå°†æ­¤ cookie æ·»åŠ åˆ°è¯¥è¯·æ±‚çš„ cookie å¤´éƒ¨ä¸­ã€‚ domainå’Œpath2ä¸ªé€‰é¡¹å…±åŒå†³å®šäº†cookieä½•æ—¶è¢«æµè§ˆå™¨è‡ªåŠ¨æ·»åŠ åˆ°è¯·æ±‚å¤´éƒ¨ä¸­å‘é€å‡ºå»ã€‚å¦‚æœæ²¡æœ‰è®¾ç½®è¿™ä¸¤ä¸ªé€‰é¡¹ï¼Œåˆ™ä¼šä½¿ç”¨é»˜è®¤å€¼ secureå±æ€§ secure é€‰é¡¹ç”¨æ¥è®¾ç½®cookieåªåœ¨ç¡®ä¿å®‰å…¨çš„è¯·æ±‚ä¸­æ‰ä¼šå‘é€ã€‚å½“è¯·æ±‚æ˜¯HTTPSæˆ–è€…å…¶ä»–å®‰å…¨åè®®æ—¶ï¼ŒåŒ…å« secure é€‰é¡¹çš„ cookie æ‰èƒ½è¢«å‘é€è‡³æœåŠ¡å™¨ã€‚ è®¾ç½®cookieæœåŠ¡ç«¯è®¾ç½®cookie cookieå’Œsessionæˆå¯¹é…åˆ + ç”Ÿæˆ ä¼  set-cookieå­—æ®µï¼Œå½“ä½ è¦æƒ³è®¾ç½®å¤šä¸ª cookieï¼Œéœ€è¦æ·»åŠ åŒæ ·å¤šçš„set-Cookieå­—æ®µã€‚ æœåŠ¡ç«¯å¯ä»¥è®¾ç½®cookie çš„æ‰€æœ‰é€‰é¡¹ï¼šexpiresã€domainã€pathã€secureã€HttpOnly å®¢æˆ·ç«¯è®¾ç½®cookie document.cookie = \"name=Jonh\"; document.cookie = \"age=12\"; document.cookie = \"class=111\"; ä½†æ˜¯çº¢å®ä¹¦æ¨èä½¿ç”¨ encodeURIComponent å¯¹åç§°å’Œå€¼è¿›è¡Œç¼–ç  document.cookie = encodeURIComponent(\"name\") + \"=\" + encodeURIComponent(\"Jonh\"); encodeURIComponent()å‡½æ•°é€šè¿‡å°†ä¸€ä¸ªï¼Œä¸¤ä¸ªï¼Œä¸‰ä¸ªæˆ–å››ä¸ªè¡¨ç¤ºå­—ç¬¦çš„UTF-8ç¼–ç çš„è½¬ä¹‰åºåˆ—æ›¿æ¢æŸäº›å­—ç¬¦çš„æ¯ä¸ªå®ä¾‹æ¥ç¼–ç  URI ï¼ˆå¯¹äºç”±ä¸¤ä¸ªâ€œä»£ç†â€å­—ç¬¦ç»„æˆçš„å­—ç¬¦è€Œè¨€ï¼Œå°†ä»…æ˜¯å››ä¸ªè½¬ä¹‰åºåˆ—ï¼‰ ã€‚ // encodes characters such as ?,=,/,&amp;,: console.log(`?x=${encodeURIComponent('test?')}`); // expected output: \"?x=test%3F\" console.log(`?x=${encodeURIComponent('ÑˆĞµĞ»Ğ»Ñ‹')}`); // expected output: \"?x=%D1%88%D0%B5%D0%BB%D0%BB%D1%8B\" decodeURIComponent() æ–¹æ³•ç”¨äºè§£ç ç”± encodeURIComponent æ–¹æ³•æˆ–è€…å…¶å®ƒç±»ä¼¼æ–¹æ³•ç¼–ç çš„éƒ¨åˆ†ç»Ÿä¸€èµ„æºæ ‡è¯†ç¬¦ï¼ˆURIï¼‰ Sessioncookieå’Œsessionéƒ½æ˜¯ç”¨æ¥è·Ÿè¸ªæµè§ˆå™¨ç”¨æˆ·èº«ä»½çš„ä¼šè¯æ–¹å¼ï¼Œé€šå¸¸ä½¿ç”¨cookieæ–¹å¼å­˜å‚¨session IDåˆ°å®¢æˆ·ç«¯ å¦‚æœæœåŠ¡ç«¯ç›´æ¥æ˜¯æŠŠç”¨æˆ·ä¿¡æ¯æ”¾åœ¨cookieï¼Œå¹¶ä¸”æ¯ä¸€æ¬¡ä»å®¢æˆ·ç«¯ä¼ è¿‡æ¥ä½¿ç”¨çš„è¯ï¼Œå¦‚æœå®¢æˆ·ç«¯å·å·æ›´æ”¹æ•°æ®ï¼Œæ¯”å¦‚ç”¨æˆ·åï¼Œå…¶å®ä¸æ˜¯ä¹±å¥—äº†ï¼Ÿæ‰€ä»¥æœåŠ¡ç«¯ ä¸èƒ½ ç›´æ¥æ‹¿cookieæ¥ä¿å­˜ç”¨æˆ·ä¿¡æ¯ï¼Œç„¶åç›´æ¥æ¥ä½¿ç”¨ï¼ˆä¹Ÿå°±æ˜¯nodejsé€šè¿‡ res.cookieä½¿ç”¨ ï¼‰ï¼Œæ‰€ä»¥å­˜session idæœ€ç¨³å¦¥ ç°åœ¨å¤§å¤šéƒ½æ˜¯Session + Cookieï¼Œä½†æ˜¯åªç”¨sessionä¸ç”¨cookieï¼Œæˆ–æ˜¯åªç”¨cookieï¼Œä¸ç”¨sessionåœ¨ç†è®ºä¸Šéƒ½å¯ä»¥ä¿æŒä¼šè¯çŠ¶æ€ã€‚å¯æ˜¯å®é™…ä¸­å› ä¸ºå¤šç§åŸå› ï¼Œä¸€èˆ¬ä¸ä¼šå•ç‹¬ä½¿ç”¨ ä¿æŒçŠ¶æ€ï¼šcookieä¿å­˜åœ¨æµè§ˆå™¨ç«¯ï¼Œsessionä¿å­˜åœ¨æœåŠ¡å™¨ç«¯ å­˜å‚¨çš„å¤§å°ï¼šcookieï¼šå•ä¸ªcookieä¿å­˜çš„æ•°æ®ä¸èƒ½è¶…è¿‡4kbï¼›sessionå¤§å°æ²¡æœ‰é™åˆ¶ã€‚ å®‰å…¨æ€§ï¼šcookieï¼šé’ˆå¯¹cookieæ‰€å­˜åœ¨çš„æ”»å‡»ï¼šCookieæ¬ºéª—ï¼ŒCookieæˆªè·ï¼›sessionçš„å®‰å…¨æ€§å¤§äºcookieã€‚ åº”ç”¨ cookieåˆ¤æ–­ç”¨æˆ·æ˜¯å¦ç™»é™†è¿‡ç½‘ç«™ï¼Œä»¥ä¾¿ä¸‹æ¬¡ç™»å½•æ—¶èƒ½å¤Ÿå®ç°è‡ªåŠ¨ç™»å½•ï¼ˆæˆ–è€…è®°ä½å¯†ç ï¼‰ï¼›ä¿å­˜ä¸Šæ¬¡ç™»å½•çš„æ—¶é—´ç­‰ä¿¡æ¯ã€‚ Sessionç”¨äºä¿å­˜æ¯ä¸ªç”¨æˆ·çš„ä¸“ç”¨ä¿¡æ¯ï¼Œå˜é‡çš„å€¼ä¿å­˜åœ¨æœåŠ¡å™¨ç«¯ï¼ŒæœåŠ¡ç«¯ä¼šä»è¯·æ±‚ä¼ å›æ¥çš„ Cookie ä¸­è·å– SessionIDï¼Œé€šè¿‡SessionIDæ¥åŒºåˆ†ä¸åŒçš„å®¢æˆ·ã€‚ ï¼ˆ1ï¼‰ç½‘ä¸Šå•†åŸä¸­çš„è´­ç‰©è½¦ ï¼ˆ2ï¼‰ä¿å­˜ç”¨æˆ·ç™»å½•ä¿¡æ¯ ï¼ˆ3ï¼‰å°†æŸäº›æ•°æ®æ”¾å…¥sessionä¸­ï¼Œä¾›åŒä¸€ç”¨æˆ·çš„ä¸åŒé¡µé¢ä½¿ç”¨ ï¼ˆ4ï¼‰é˜²æ­¢ç”¨æˆ·éæ³•ç™»å½• cookie - sessionè®¤è¯æµç¨‹ 1ã€ç”¨æˆ·å‘æœåŠ¡å™¨å‘é€ç”¨æˆ·åå’Œå¯†ç ã€‚ 2ã€æœåŠ¡å™¨éªŒè¯é€šè¿‡åï¼Œåœ¨å½“å‰å¯¹è¯ï¼ˆsessionï¼‰é‡Œé¢ä¿å­˜ç›¸å…³æ•°æ®ï¼Œæ¯”å¦‚ç”¨æˆ·è§’è‰²ã€ç™»å½•æ—¶é—´ç­‰ç­‰ã€‚ 3ã€æœåŠ¡å™¨å‘ç”¨æˆ·è¿”å›ä¸€ä¸ª session_idï¼Œå†™å…¥ Cookieï¼Œï¼ˆæœ‰æ—¶ä¸ºäº†å®‰å…¨ï¼Œåˆ†ä¸ºå¤šä¸ªcookieï¼‰ä¼ ç»™å®¢æˆ·ç«¯ã€‚ 4ã€ç”¨æˆ·éšåçš„æ¯ä¸€æ¬¡è¯·æ±‚ï¼Œéƒ½ä¼šé€šè¿‡ Cookieï¼Œå°† session_id ä¼ å›æœåŠ¡å™¨ã€‚ 5ã€æœåŠ¡å™¨æ”¶åˆ° session_idï¼Œæ‰¾åˆ°å‰æœŸä¿å­˜çš„æ•°æ®ï¼Œç”±æ­¤å¾—çŸ¥ç”¨æˆ·çš„èº«ä»½ã€‚ sessionç¼ºç‚¹ï¼š Sessionä¿å­˜çš„ä¸œè¥¿è¶Šå¤šï¼Œå°±è¶Šå ç”¨æœåŠ¡å™¨å†…å­˜ï¼Œå¯¹äºç”¨æˆ·åœ¨çº¿äººæ•°è¾ƒå¤šçš„ç½‘ç«™ï¼ŒæœåŠ¡å™¨çš„å†…å­˜å‹åŠ›ä¼šæ¯”è¾ƒå¤§ã€‚ sessionæŒä¹…åŒ–ç”±äºsessionæ˜¯å­˜å‚¨åœ¨æœåŠ¡å™¨çš„å†…å­˜ä¸­ï¼Œå¦‚æœæœåŠ¡å™¨çªç„¶å´©äº†ï¼Œæˆ–è€…æœåŠ¡å™¨å…³é—­ï¼Œé‚£å²‚ä¸æ˜¯â€œä¸ƒå¤©å…ç™»å½•â€å­˜å‚¨åŠŸèƒ½å¤±æ•ˆäº†ï¼Ÿ æ­¤æ—¶æœåŠ¡ç«¯ä¸èƒ½å•å•ä¿å­˜åœ¨æœåŠ¡å™¨å†…å­˜é‡Œï¼Œè¿˜è¦å­˜åˆ°æ•°æ®åº“ä¸­ sessionå¼Šç«¯å½“å‰ç™»é™†è´¦å·æˆåŠŸä¹‹åï¼Œåˆ«äººåªè¦æ‹¿åˆ°ä½ çš„cookieï¼ˆå¯ä»¥é€šè¿‡chromeæ’ä»¶ä¸€é”®å¯¼å‡ºcookieï¼‰ï¼Œç„¶ååˆ«äººå°±å¯ä»¥ç›´æ¥ä¼ªé€ ä½ çš„èº«ä»½ç›´æ¥æ‹¿cookieç™»å½•ï¼Œæ‰€ä»¥åœ¨å…¬å…±ç”µè„‘ï¼Œç¦»å¼€ä¹‹åå¿…é¡»è®°å¾—ç‚¹å‡»é€€å‡ºå½“å‰å¸å·ï¼Œæ­¤æ—¶æœåŠ¡å™¨å°±ä¼šé”€æ¯å½“å‰session Tokenä¸Šè¿°å±•ç¤ºäº†åŸºäºæœåŠ¡å™¨éªŒè¯çš„sessionï¼ˆsessionIDï¼‰æš´éœ²äº†ä¸€äº›å¼Šç«¯ï¼Œå½“ç„¶ä½¿ç”¨sessionè¿˜æœ‰å¯èƒ½å¼•èµ·ï¼šè·¨åŸŸå…±äº«é—®é¢˜ã€CSRFæ”»å‡»é—®é¢˜å’Œå¯æ‹“å±•æ€§é—®é¢˜ã€‚ åŸºäº Token çš„èº«ä»½éªŒè¯æ˜¯æ— çŠ¶æ€çš„ï¼Œæˆ‘ä»¬ä¸ç”¨å°†ç”¨æˆ·ä¿¡æ¯å­˜åœ¨æœåŠ¡å™¨æˆ– Session ä¸­ã€‚è¿™ç§æ¦‚å¿µè§£å†³äº†åœ¨æœåŠ¡ç«¯å­˜å‚¨ä¿¡æ¯æ—¶çš„è®¸å¤šé—®é¢˜ã€‚æ²¡æœ‰ session ä¿¡æ¯æ„å‘³ç€ä½ çš„ç¨‹åºå¯ä»¥æ ¹æ®éœ€è¦å»å¢å‡æœºå™¨ï¼Œè€Œä¸ç”¨å»æ‹…å¿ƒç”¨æˆ·æ˜¯å¦ç™»å½•å’Œå·²ç»ç™»å½•åˆ°äº†å“ªé‡Œã€‚ å¤§å¤šçš„tokenéªŒè¯æµç¨‹å¦‚ä¸‹ï¼š ç”¨æˆ·é€šè¿‡ç”¨æˆ·åå’Œå¯†ç å‘é€è¯·æ±‚ã€‚ ç¨‹åºéªŒè¯ã€‚ ç¨‹åºè¿”å›ä¸€ä¸ªç­¾åçš„ token ç»™å®¢æˆ·ç«¯ï¼ˆä»¤ç‰Œï¼‰ã€‚ å®¢æˆ·ç«¯å‚¨å­˜ token, å¹¶ä¸”æ¯æ¬¡è¯·æ±‚éƒ½ä¼šé™„å¸¦å®ƒã€‚ æœåŠ¡ç«¯éªŒè¯ token å¹¶è¿”å›æ•°æ®ã€‚ï¼ˆæœåŠ¡å™¨ç«¯é‡‡ç”¨filterè¿‡æ»¤å™¨æ ¡éªŒã€‚æ ¡éªŒæˆåŠŸåˆ™è¿”å›è¯·æ±‚æ•°æ®ï¼Œæ ¡éªŒå¤±è´¥åˆ™è¿”å›é”™è¯¯ç ï¼‰ tokenä¼˜åŠ¿ æ— çŠ¶æ€ï¼ˆå®é™…ä¸Šæ˜¯æ¥è‡ªäºJWTï¼‰ï¼Œæ— éœ€å­˜å‚¨sessionä¿¡æ¯ï¼Œè´Ÿè½½å‡è¡¡æœåŠ¡å™¨ï¼Œèƒ½å¤Ÿå°†ç”¨æˆ·è¯·æ±‚ä¼ é€’åˆ°ä»»ä½•ä¸€å°æœåŠ¡å™¨ä¸Š å¯æ‹“å±•ï¼Œtokenä¿å­˜åœ¨å®¢æˆ·ç«¯æœ¬åœ°ï¼Œä½¿ç”¨tokenå¯ä»¥å’Œå…¶ä»–åº”ç”¨å…±äº«æƒé™ï¼Œæ¯”å¦‚å°†åšå®¢è´¦å·å’Œqqè´¦å·è¿›è¡Œå…³è”ï¼Œå½“é€šè¿‡ç¬¬ä¸‰æ–¹å¹³å°ç™»å½•qqæ—¶ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠåšå®¢å‘åˆ°qqå¹³å°ä¸­ å®‰å…¨æ€§ï¼Œé˜²æ­¢CSRFæ”»å‡»ï¼Œè¯·æ±‚ä¸­å‘é€çš„æ˜¯tokenè€Œä¸æ˜¯cookieï¼Œæµè§ˆå™¨ä¼šå°†æ¥æ”¶åˆ°çš„tokenå€¼å­˜å‚¨åœ¨Local Storageã€sessionStorageæˆ–è€…cookieä¸­ æ ¹æ®æµè§ˆå™¨ç­–ç•¥ï¼Œé€šè¿‡domainå’Œpathä¼ é€’cookieæ˜¯æµè§ˆå™¨è¡Œä¸ºï¼ˆéäººä¸ºæ§åˆ¶ï¼‰ï¼Œè€Œtokençš„è·å–éœ€è¦é€šè¿‡jsè„šæœ¬æ§åˆ¶ï¼Œç„¶åæ ¹æ®åŒæºç­–ç•¥ï¼Œbç½‘ç«™ä¹Ÿåªèƒ½æ‹¿åˆ°bç½‘ç«™çš„Local Storageã€sessionStorageæˆ–è€…cookieä¸­ åœ¨ä¿¡ä»»ç½‘ç«™çš„HTMLæˆ–jsä¸­ï¼Œä¼šå‘æœåŠ¡å™¨ä¼ é€’å‚æ•°tokenï¼Œä¸æ˜¯é€šè¿‡Cookieä¼ é€’çš„ï¼Œè‹¥æ¶æ„ç½‘ç«™è¦ä¼ªé€ ç”¨æˆ·çš„è¯·æ±‚ï¼Œä¹Ÿå¿…é¡»ä¼ªé€ è¿™ä¸ªtokenï¼Œå¦åˆ™ç”¨æˆ·èº«ä»½éªŒè¯ä¸é€šè¿‡ã€‚ å³ä½¿tokenå­˜å‚¨å†cookieä¸­ï¼ŒåŒæºç­–ç•¥é™åˆ¶äº†æ¶æ„ç½‘ç«™ä¸èƒ½æ‹¿åˆ°ä¿¡ä»»ç½‘ç«™çš„Cookieå†…å®¹ï¼ˆtokençš„ç”Ÿæˆéœ€è¦æå–Cookieé‡Œé¢çš„å†…å®¹è¿›è¡Œç”Ÿæˆï¼‰ï¼Œåªèƒ½ä½¿ç”¨ï¼ˆåªèƒ½æºå¸¦ï¼Œä¸èƒ½æ‹¿å‡ºæ¥çœ‹ï¼ï¼ï¼‰ï¼Œæ‰€ä»¥å°±ç®—æ˜¯tokenæ˜¯å­˜æ”¾åœ¨Cookieä¸­çš„ï¼Œæ¶æ„ç½‘ç«™ä¹Ÿæ— æ³•æå–å‡ºCookieä¸­çš„tokenæ•°æ®è¿›è¡Œä¼ªé€ ã€‚ä¹Ÿå°±æ— æ³•ä¼ é€’æ­£ç¡®çš„tokenç»™æœåŠ¡å™¨ï¼Œè¿›è€Œæ— æ³•æˆåŠŸä¼ªè£…æˆç”¨æˆ·äº†ã€‚ ç§»åŠ¨ç«¯ä¸Šä¸æ”¯æŒ cookieï¼Œè€Œ token åªè¦å®¢æˆ·ç«¯èƒ½å¤Ÿè¿›è¡Œå­˜å‚¨å°±èƒ½å¤Ÿä½¿ç”¨ï¼Œå› æ­¤ token åœ¨ç§»åŠ¨ç«¯ä¸Šä¹Ÿå…·æœ‰ä¼˜åŠ¿ã€‚ ä¸è¿‡ï¼Œtokenæœ‰è¿‡æœŸæ—¶é—´ï¼Œè¶…è¿‡äº‹ä»¶åè¦é‡æ–°è·å–token Token çš„ç§ç±»ä¸€èˆ¬æ¥è¯´ token ä¸»è¦ä¸‰ç§ï¼š è‡ªå®šä¹‰çš„ tokenï¼šå¼€å‘è€…æ ¹æ®ä¸šåŠ¡é€»è¾‘è‡ªå®šä¹‰çš„ token JWTï¼šJSON Web Tokenï¼Œå®šä¹‰åœ¨ RFC 7519 ä¸­çš„ä¸€ç§ token è§„èŒƒ Oauth2.0ï¼šå®šä¹‰åœ¨ RFC 6750 ä¸­çš„ä¸€ç§æˆæƒè§„èŒƒï¼Œä½†è¿™å…¶å®å¹¶ä¸æ˜¯ä¸€ç§ tokenï¼Œåªæ˜¯å…¶ä¸­ä¹Ÿæœ‰ç”¨åˆ° token é™„ä¸Šç™»å½•è®¤è¯çš„è¿›åŒ–è·¯ç¨‹å‚è€ƒç½‘å€https://www.cnblogs.com/fengzheng/p/8416393.html ï¼ˆä¼ ç»Ÿcookie-Session -&gt; æ”¹é€ ç‰ˆcookie-session -&gt; åŸºäºJWTçš„Tokenè®¤è¯ -&gt; OAuthè®¤è¯ï¼‰ æ‹¦æˆªå™¨å®šä¹‰æºå¸¦tokenæœ¬ä¾‹ä½¿ç”¨axioså¸¦çš„è¯·æ±‚æ‹¦æˆªå™¨ï¼Œæ‹¦æˆªè¯·æ±‚ï¼Œå¹¶ä¸”é™„å¸¦ä¸Štoken import MYRequest from './request' import { BASE_URL } from './request/config' const myRequest = new MYRequest({ baseURL: BASE_URL, interceptors: { requesInterceptor: (config) => { const token = '123' if (token &amp;&amp; config.headers) { config.headers.Authorization = `Bearer ${token}` } console.log('è¯·æ±‚æˆåŠŸæ‹¦æˆª', config) return config }, requstInterceptorCatch: (err) => { console.log('è¯·æ±‚å¤±è´¥æ‹¦æˆª', err) }, responseInterceptor: (config) => { // console.log('å“åº”æˆåŠŸæ‹¦æˆª', config) return config } } }) export default myRequest å†…éƒ¨ä¸Šæœ‰ï¼š this.instance.interceptors.request.use( this.interceptors?.requesInterceptor, this.interceptors?.requstInterceptorCatch ) JWT çš„ç»„æˆå’Œä¼˜åŠ¿JSON Web Tokenï¼ˆJWTï¼‰æ˜¯ä¸€ä¸ªéå¸¸è½»å·§çš„è§„èŒƒã€‚è¿™ä¸ªè§„èŒƒå…è®¸æˆ‘ä»¬ä½¿ç”¨JWTåœ¨ç”¨æˆ·å’ŒæœåŠ¡å™¨ä¹‹é—´ä¼ é€’å®‰å…¨å¯é çš„ä¿¡æ¯ã€‚ ä¸€ä¸ªJWTå®é™…ä¸Šå°±æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå®ƒç”±ä¸‰éƒ¨åˆ†ç»„æˆï¼Œå¤´éƒ¨ã€è½½è·ä¸ç­¾åã€‚ä¸­é—´ç”¨ . åˆ†éš”ï¼Œä¾‹å¦‚ï¼šxxxxx.yyyyy.zzzzz å¤´éƒ¨ï¼ˆHeaderï¼‰å¤´éƒ¨ç”¨äºæè¿°å…³äºè¯¥JWTçš„æœ€åŸºæœ¬çš„ä¿¡æ¯ { &quot;typ&quot;: &quot;JWT&quot;, &quot;alg&quot;: &quot;HS256&quot; }è¯´æ˜äº†è¿™æ˜¯ä¸€ä¸ªJWTï¼Œå¹¶ä¸”æˆ‘ä»¬æ‰€ç”¨çš„ç­¾åç®—æ³•ï¼ˆåé¢ä¼šæåˆ°ï¼‰æ˜¯HS256ç®—æ³• è½½è·ï¼ˆPayloadï¼‰è½½è·ä¸­æ”¾ç½®äº† token çš„ä¸€äº›åŸºæœ¬ä¿¡æ¯ï¼Œä»¥å¸®åŠ©æ¥å—å®ƒçš„æœåŠ¡å™¨æ¥ç†è§£è¿™ä¸ª tokenã€‚åŒæ—¶è¿˜å¯ä»¥åŒ…å«ä¸€äº›è‡ªå®šä¹‰çš„ä¿¡æ¯ï¼Œç”¨æˆ·ä¿¡æ¯äº¤æ¢ã€‚ Payload éƒ¨åˆ†ä¹Ÿæ˜¯ä¸€ä¸ª JSON å¯¹è±¡ï¼ŒJWT è§„å®šäº†7ä¸ªå®˜æ–¹å­—æ®µï¼Œä¾›é€‰ç”¨ã€‚ iss (issuer)ï¼šç­¾å‘äºº exp (expiration time)ï¼šè¿‡æœŸæ—¶é—´ sub (subject)ï¼šä¸»é¢˜ aud (audience)ï¼šå—ä¼— nbf (Not Before)ï¼šç”Ÿæ•ˆæ—¶é—´ iat (Issued At)ï¼šç­¾å‘æ—¶é—´ jti (JWT ID)ï¼šç¼–å· { \"iss\": \"John Wu JWT\", //ç­¾å‘è€… \"iat\": 1441593502, //ç­¾å‘æ—¶é—´ \"exp\": 1441594722, //è¿‡æœŸæ—¶é—´ \"aud\": \"www.example.com\", //å—ä¼— \"sub\": \"jrocket@example.com\", //ä¸»é¢˜ \"from_user\": \"B\", //è‡ªå®šä¹‰ç§æœ‰å­—æ®µ \"target_user\": \"A\" //è‡ªå®šä¹‰ç§æœ‰å­—æ®µ } é€šè¿‡Node.jsçš„åŒ…base64urlæ¥å¾—åˆ°ä¸€ä¸ªå¾ˆé•¿çš„å­—ç¬¦ä¸²ï¼ˆ console.log(base64url(JSON.stringify(header))) ï¼‰ï¼Œå¦‚ä¸‹å›¾ ç­¾åï¼ˆSignatureï¼‰ä¸ºäº†é˜²æ­¢ç”¨æˆ·ç¯¡æ”¹æ•°æ®ï¼ŒæœåŠ¡å™¨åœ¨ç”Ÿæˆè¿™ä¸ªå¯¹è±¡çš„æ—¶å€™ï¼Œä¼šåŠ ä¸Šç­¾å ç­¾åæ—¶éœ€è¦ç”¨åˆ°å‰é¢ç¼–ç è¿‡çš„ä¸¤ä¸ªå­—ç¬¦ä¸²ï¼Œä½¿ç”¨ Header é‡Œé¢æŒ‡å®šçš„ç­¾åç®—æ³•ï¼ˆé»˜è®¤æ˜¯ HMAC SHA256ï¼‰ åŠ å¯†ç®—æ³•å¯¹äºä¸åŒçš„è¾“å…¥ï¼ˆå¤´éƒ¨å’Œè½½è·ï¼‰äº§ç”Ÿçš„è¾“å‡ºæ€»æ˜¯ä¸ä¸€æ ·çš„ï¼Œå¦‚æœæ•°æ®è¢«ä¿®æ”¹ï¼Œå¾—åˆ°çš„ç­¾åæ€»ä¼šæ˜¯ä¸ä¸€æ ·çš„ï¼Œè€Œä¸”ï¼Œå¦‚æœä¸çŸ¥é“æœåŠ¡å™¨åŠ å¯†çš„æ—¶å€™ä½¿ç”¨å¯†é’¥ï¼Œå¾—åˆ°çš„ç­¾åä¹Ÿä¼šæ˜¯ä¸ä¸€æ ·çš„ã€‚ å¦‚æœæœåŠ¡å™¨åº”ç”¨å¯¹å¤´éƒ¨å’Œè½½è·å†æ¬¡ä»¥åŒæ ·æ–¹æ³•ç­¾åä¹‹åå‘ç°ï¼Œè‡ªå·±è®¡ç®—å‡ºæ¥çš„ç­¾åå’Œæ¥å—åˆ°çš„ç­¾åä¸ä¸€æ ·ï¼Œé‚£ä¹ˆå°±è¯´æ˜è¿™ä¸ªTokençš„å†…å®¹è¢«åˆ«äººåŠ¨è¿‡çš„ï¼Œæˆ‘ä»¬åº”è¯¥æ‹’ç»è¿™ä¸ªTokenï¼Œè¿”å›ä¸€ä¸ªHTTP 401 Unauthorizedå“åº”ã€‚ ä¸‰è€…ç»„åˆå°±å½¢æˆäº†ä¸€ä¸ªå®Œæ•´çš„JWT å»ºè®® åœ¨JWTä¸­ï¼Œä¸åº”è¯¥åœ¨è½½è·é‡Œé¢åŠ å…¥ä»»ä½•æ•æ„Ÿçš„æ•°æ®ï¼ˆæ¯”å¦‚å¯†ç ï¼‰ï¼Œæ€€æœ‰æ¶æ„çš„ç¬¬ä¸‰æ–¹é€šè¿‡Base64è§£ç å¯ä»¥è·å–åˆ°JWTé‡Œçš„ä¿¡æ¯ è™½è¯´JWT é»˜è®¤æ˜¯ä¸åŠ å¯†ï¼Œä½†ä¹Ÿæ˜¯å¯ä»¥åŠ å¯†çš„ã€‚ç”ŸæˆåŸå§‹ Token ä»¥åï¼Œå¯ä»¥ç”¨å¯†é’¥å†åŠ å¯†ä¸€æ¬¡ã€‚ï¼ˆæ­¤æ—¶æ‰å¯ä»¥å†™å…¥ç§˜å¯†æ•°æ®ï¼‰ ä¸ºäº†å‡å°‘ç›—ç”¨ï¼ŒJWT ä¸åº”è¯¥ä½¿ç”¨ HTTP åè®®æ˜ç ä¼ è¾“ï¼Œè¦ä½¿ç”¨ HTTPS åè®®ä¼ è¾“ã€‚ JWT æœ¬èº«åŒ…å«äº†è®¤è¯ä¿¡æ¯ï¼Œä¸€æ—¦æ³„éœ²ï¼Œä»»ä½•äººéƒ½å¯ä»¥è·å¾—è¯¥ä»¤ç‰Œçš„æ‰€æœ‰æƒé™ã€‚ä¸ºäº†å‡å°‘ç›—ç”¨ï¼ŒJWT çš„æœ‰æ•ˆæœŸåº”è¯¥è®¾ç½®å¾—æ¯”è¾ƒçŸ­ã€‚å¯¹äºä¸€äº›æ¯”è¾ƒé‡è¦çš„æƒé™ï¼Œä½¿ç”¨æ—¶åº”è¯¥å†æ¬¡å¯¹ç”¨æˆ·è¿›è¡Œè®¤è¯ã€‚ ä½¿ç”¨åœºæ™¯ å®ŒæˆåŠ å¥½å‹çš„æ“ä½œï¼Œè¿˜æœ‰è¯¸å¦‚ä¸‹è®¢å•çš„æ“ä½œ è®¾è®¡ç”¨æˆ·è®¤è¯å’Œæˆæƒç³»ç»Ÿï¼Œç”šè‡³å®ç°Webåº”ç”¨çš„å•ç‚¹ç™»å½•ã€‚ JWTå’Œtokençš„ä¸åŒç‚¹Tokenï¼šæœåŠ¡ç«¯éªŒè¯å®¢æˆ·ç«¯å‘é€è¿‡æ¥çš„ Token æ—¶ï¼Œè¿˜éœ€è¦æŸ¥è¯¢æ•°æ®åº“è·å–ç”¨æˆ·ä¿¡æ¯ï¼Œç„¶åéªŒè¯ Token æ˜¯å¦æœ‰æ•ˆã€‚ JWTï¼šå°† Token å’Œ Payload åŠ å¯†åå­˜å‚¨äºå®¢æˆ·ç«¯ï¼ŒæœåŠ¡ç«¯åªéœ€è¦ä½¿ç”¨å¯†é’¥è§£å¯†è¿›è¡Œæ ¡éªŒï¼ˆæ ¡éªŒä¹Ÿæ˜¯ JWT è‡ªå·±å®ç°çš„ï¼‰å³å¯ï¼Œä¸éœ€è¦æŸ¥è¯¢æˆ–è€…å‡å°‘æŸ¥è¯¢æ•°æ®åº“ï¼Œå› ä¸º JWT è‡ªåŒ…å«äº†ç”¨æˆ·ä¿¡æ¯å’ŒåŠ å¯†çš„æ•°æ®ã€‚ JWTå‚è€ƒæ–‡ç« ï¼šhttp://blog.leapoahead.com/2015/09/06/understanding-jwt/ é˜®ä¸€å³°è€å¸ˆçš„ä»‹ç» http://www.ruanyifeng.com/blog/2018/07/json_web_token-tutorial.html JWTè¯¦è§£æ”»ç•¥ï¼šhttps://learnku.com/articles/17883?order_by=vote_count&amp; JWTå®æˆ˜æ¼”ç»ƒå…ˆè¿›è¡Œå®‰è£… npm i jsonwebtoken npm i express-jwt jsonwebtoken: ç”¨äºç”Ÿæˆ Token ã€‚å®ƒä¹Ÿæœ‰è§£æ Token çš„åŠŸèƒ½ express-jwt: ç”¨äºè§£æ Tokenï¼ˆæ¯” jsonwebtoken è§£å†³æ–¹ä¾¿ï¼‰ , å®ƒæŠŠè§£æä¹‹åçš„æ•°æ®ï¼Œå­˜æ”¾åˆ° requset.user ä¸­ jsonwebtoken æä¾›äº†sign(payload, secretOrPrivateKey, [options, callback])çš„æ–¹æ³•ã€‚ sign ï¼šå¯¹åº”çš„å…¶å®å°±æ˜¯ JWT ç­¾å(Signature)çš„åŠ¨ä½œ payloadï¼šå¯¹åº”çš„æ˜¯ä¼ å…¥çš„è½½è·ï¼Œå¯ä»¥çœç•¥å®˜æ–¹æä¾›ä¸ƒä¸ªå­—æ®µï¼Œé¢å¤–æ·»åŠ è‡ªå®šä¹‰ç§æœ‰å­—æ®µï¼Œæ¯”å¦‚ç”¨æˆ·ä¿¡æ¯userIdç­‰ç­‰ secretOrPrivateKeyï¼šè‡ªå®šä¹‰çš„å¯†é’¥ï¼Œå±äºæ•æ„Ÿä¿¡æ¯ optionsï¼šå¯ä»¥é…ç½® header ã€è·è½½ã€æŒ‡å®šç®—æ³•ç±»å‹ï¼ˆå¸¸ç”¨çš„åªæœ‰ exp(expiresIn)æœ‰æ•ˆæ—¶é—´ å’Œ algorithm ç®—æ³•ç±»å‹è¿™ä¸¤ä¸ªå­—æ®µï¼‰ å‚è€ƒæ–‡ç« https://juejin.cn/post/6932374305758167054","categories":[{"name":"å‰ç«¯","slug":"å‰ç«¯","permalink":"https://taylor12138.github.io/categories/%E5%89%8D%E7%AB%AF/"}],"tags":[],"author":"Hello"},{"title":"PC&ç§»åŠ¨ç«¯ç½‘é¡µç‰¹æ•ˆ(JS)","slug":"PC&ç§»åŠ¨ç«¯ç½‘é¡µç‰¹æ•ˆ(JS)","date":"2020-11-17T16:00:00.000Z","updated":"2023-01-29T14:58:57.427Z","comments":true,"path":"2020/11/18/pc-yi-dong-duan-wang-ye-te-xiao-js/","link":"","permalink":"https://taylor12138.github.io/2020/11/18/pc-yi-dong-duan-wang-ye-te-xiao-js/","excerpt":"","text":"PCç«¯1.offsetå…ƒç´ åç§»é‡æˆ‘ä»¬ä½¿ç”¨offsetç³»åˆ—ç›¸å…³å±æ€§å¯ä»¥åŠ¨æ€è·å–å…ƒç´ çš„ä½ç½®ï¼ˆå¤§å°ï¼‰ï¼ˆçˆ¶äº²è¦å®šä½æ­¤åŠŸèƒ½æ‰æœ‰ç”¨ element.offsetTop è¿”å›å…ƒç´ ç›¸å¯¹å¸¦æœ‰å®šä½çˆ¶å…ƒç´ ä¸Šæ–¹çš„åç§»ï¼Œä¸å¸¦å•ä½ï¼Œå¦‚æœæ²¡æœ‰å®šä½æˆ–è€…æ²¡æœ‰çˆ¶å…ƒç´ åˆ™ä»¥bodyä¸ºå‡† element.offsetLeft è¿”å›å…ƒç´ ç›¸å¯¹å¸¦æœ‰å®šä½çˆ¶å…ƒç´ å·¦æ–¹çš„åç§»ï¼Œæƒ…å†µåŒä¸Š element.offsetWidth è¿”å›è‡ªèº«å®½åº¦å¤§å°ï¼Œè‡ªèº«å®½åº¦+padding+border element.offsetHeight è¿”å›è‡ªèº«é«˜åº¦å¤§å°ï¼ŒåŒä¸Š element.offsetParent è¿”å›å¸¦æœ‰å®šä½çš„çˆ¶äº²ï¼Œå¦åˆ™è¿”å›bodyï¼ˆelement.parentNode ç›´æ¥è¿”å›æœ€è¿‘ä¸€çº§çš„çˆ¶èŠ‚ç‚¹ï¼Œä¸ç®¡çˆ¶èŠ‚ç‚¹æ˜¯å¦æœ‰å®šä½ï¼‰ offsetå’Œstyleçš„åŒºåˆ«ï¼šoffsetå¯ä»¥å¾—åˆ°ä»»æ„æ ·å¼è¡¨çš„æ ·å¼å€¼ styleåªèƒ½å¾—åˆ°è¡Œå†…æ ·å¼è¡¨çš„æ ·å¼å€¼ offsetç³»åˆ—è·å¾—çš„æ•°å€¼æ²¡æœ‰å¸¦å•ä½ style.widthè·å¾—çš„æ˜¯å¸¦å•ä½çš„å­—ç¬¦ä¸² offsetWidthç­‰æ˜¯åŒ…å«padding+border style.widthè·å¾—ä¸åŒ…å«paddingå’Œborderçš„å€¼ offsetWidthç­‰å±æ€§æ˜¯åªè¯»å±æ€§ï¼Œåªèƒ½è·å–ä¸èƒ½èµ‹å€¼ style.widthæ˜¯å¯è¯»å†™å±æ€§ï¼Œå¯ä»¥èµ‹å€¼ æ‰€ä»¥offseté€‚åˆè¯»å€¼ï¼Œstyleé€‚åˆèµ‹å€¼æ”¹å€¼ ä¸€å¼ å›¾è§£offset 2.å…ƒç´ å¯è§†åŒºclienté€šè¿‡clientç³»åˆ—çš„ç›¸å…³å±æ€§å¯ä»¥åŠ¨æ€å¾—åˆ°è¯¥å…ƒç´ çš„è¾¹æ¡†å¤§å°ã€å…ƒç´ å¤§å°ç­‰ï¼ˆä¸offsetä¸åŒç‚¹æ˜¯è¾¹æ¡†æ˜¯å¦å›Šæ‹¬å…¶ä¸­ï¼‰ element.clientTop è¿”å›å…ƒç´ ä¸Šè¾¹æ¡†çš„å¤§å° element.clientLeft è¿”å›å…ƒç´ å·¦è¾¹æ¡†çš„å¤§å° element.clientWidth è¿”å›è‡ªèº«åŒ…æ‹¬paddingã€å†…å®¹åŒºçš„å®½åº¦ï¼Œä¸åŒ…å«borderï¼Œè¿”å›æ•°å€¼ä¸å¸¦å•ä½ element.clientHeight åŒä¸Šï¼Œè¿”å›é«˜åº¦ clientHeight å¯ä»¥é€šè¿‡ CSS height + CSS padding - æ°´å¹³æ»šåŠ¨æ¡é«˜åº¦ (å¦‚æœå­˜åœ¨)æ¥è®¡ç®—. å¤‡æ³¨: æ­¤å±æ€§ä¼šå°†è·å–çš„å€¼å››èˆäº”å…¥å–æ•´æ•°ã€‚ å¦‚æœä½ éœ€è¦å°æ•°ç»“æœ, è¯·ä½¿ç”¨ element.getBoundingClientRect(). ï¼ˆç•ªå¤–ï¼‰ç«‹å³æ‰§è¡Œå‡½æ•°ç«‹å³æ‰§è¡Œå‡½æ•°ï¼Œä¸éœ€è¦è°ƒç”¨ï¼Œç›´æ¥æ‰§è¡Œ ä¼ ç»Ÿï¼š function fn() {} fn(); ç«‹æ‰§ï¼š (function(a, b) {}(1, 2)) //ç¬¬ä¸€ç§ (function(a, b) {})(å‚æ•°1, å‚æ•°2) //ç¬¬äºŒç§ ç«‹å³æ‰§è¡Œå‡½æ•°æœ€å¤§çš„ä¼˜ç‚¹å°±æ˜¯ç‹¬ç«‹åˆ›å»ºäº†ä¸€ä¸ªä½œç”¨åŸŸ 3.å…ƒç´ æ»šåŠ¨scrollè·å–æˆ–è®¾ç½®ä¸€ä¸ªå…ƒç´ çš„å†…å®¹å‚ç›´æ»šåŠ¨çš„åƒç´ æ•° æœ‰ç‚¹åƒclientï¼Œä½†æ˜¯clientæ˜¯ç›’å­çš„å¤§å°å®½é«˜ï¼Œå³ä½¿å†…å®¹æº¢å‡ºåä¿æŒä¸å˜ï¼Œä½†æ˜¯scrollé¢å¯¹æº¢å‡ºçŠ¶æ€çš„ç›’å­ï¼Œå®ƒæä¾›çš„å®½é«˜ä¸å†…å®¹æº¢å‡ºçš„å®½é«˜ç›¸äº’å…³è”ã€‚ ä»¥ä¸‹çš„elementï¼Œéƒ½æ˜¯é’ˆå¯¹çˆ¶ç›’å­çš„ï¼Œæ— è®ºæ˜¯äº‹ä»¶ç›‘å¬orå±æ€§(è®°å¾—çˆ¶ç›’å­å°ï¼Œå­ç›’å­è¦å¤§äºçˆ¶ç›’å­çš„å¤§å°ï¼Œå¹¶ä¸”è®¾ç½®çˆ¶ç›’å­çš„cssæ ·å¼overflow: scroll æˆ–è€… overflow: auto) father.addEventListener('scroll', () => { console.log(father.scrollTop); }) element.scrollHeight è¿”å›è‡ªèº«é«˜åº¦ï¼Œä¸å«è¾¹æ¡†ï¼Œä¸å¸¦å•ä½ï¼ŒåƒclientHeight + è¶…å‡ºæ–‡å­—éƒ¨åˆ†é«˜åº¦ element.scrollWidth è¿”å›è‡ªèº«å®½åº¦ï¼Œä¸å«è¾¹æ¡†ï¼Œä¸å¸¦å•ä½ï¼ŒåƒclientWidth + è¶…å‡ºæ–‡å­—éƒ¨åˆ†å®½åº¦ element.scrollTop è¿”å›è¢«æ»šåŠ¨æ¡å·ä¸Šå»çš„ä¸Šæ–¹è·ç¦»ï¼Œè¿”å›æ•°å€¼ä¸å¸¦å•ä½ï¼ˆè¦æœ‰æ»šåŠ¨æ¡ï¼Œä¸”å†…å®¹å¤§äºç›’å­ï¼Œå¾€ä¸‹æ‹‰çš„æ—¶å€™æ‰ä¼šæœ‰ï¼‰ element.scrollLeft è¿”å›è¢«æ»šåŠ¨æ¡å·å·¦çš„å·¦ä¾§è·ç¦»ï¼ŒåŒä¸Š (windowçš„scrollæ²¡æœ‰scrollTopã€scrollLeftï¼Œä½†æ˜¯æœ‰ä¸ªapiå¯ä»¥è·å–å½“å‰ç½‘é¡µçš„scrollTopï¼š var scrollTop = document.documentElement.scrollTop || document.body.scrollTop;) æ»šåŠ¨æ¡åœ¨æ»šåŠ¨æ—¶å‘ç”Ÿçš„äº‹ä»¶ï¼šonscrolläº‹ä»¶ æ£€æµ‹æ•´ä¸ªé¡µé¢çš„æ»šåŠ¨å±æ€§ï¼š window.pageYOffset window.pageXOffsetç­‰ (ie9ä»¥ä¸Šæ‰æ”¯æŒ) è®©çª—å£æ»šåŠ¨äº‹ä»¶ï¼šwindow.scroll(x, y) æ»šåŠ¨äº‹ä»¶æ–¹æ¡ˆantdesignå¯¹scrollçš„å¤„ç†ï¼ˆæ»šåŠ¨åˆ°å±å¹•é¡¶éƒ¨ï¼‰ https://github.com/ant-design/ant-design/blob/master/components/_util/scrollTo.ts#L34 ç½‘ç»œä¸Šçš„ä¸€äº›æ»šåŠ¨æ–¹æ¡ˆ https://www.cnblogs.com/nolaaaaa/p/9021967.html ä¸‰å¤§ç³»åˆ—æ€»ç»“offsetå¸¸ç”¨äºè·å–å…ƒç´ ä½ç½® element.offsetTop element.offsetLeft åªè¯»çš„ clientå¸¸ç”¨äºè·å–å…ƒç´ å¤§å° element.clientWidth element.clientHeight åªè¯»çš„ scrollå¸¸ç”¨äºè·å–æ»šåŠ¨è·ç¦» element.scrollTop element.scrollLeft å¯è®¾ç½® 4.æ»šåŠ¨è‡³æµè§ˆå™¨çš„å¯è§†åŒºåŸŸæ–¹æ³•ä¸€ï¼šå›¾ç‰‡/å…ƒç´ çš„offsetTop &lt; å½“å‰çš„å…ƒç´ çˆ¶äº²çš„scrollTop å›¾ç‰‡/å…ƒç´  offsetTop +å›¾ç‰‡/å…ƒç´  offsetHeight &gt; å½“å‰å…ƒç´ çˆ¶äº²çš„ scrollTop æ–¹æ³•äºŒï¼šwindow.scrollY &gt; å›¾ç‰‡/å…ƒç´ çš„offsetTop æ–¹æ³•ä¸‰ï¼šelement.getBoundingClientRect(),è¿”å›çš„ç»“æœæ˜¯åŒ…å«å®Œæ•´å…ƒç´ çš„æœ€å°çŸ©å½¢ï¼Œå¹¶ä¸”æ‹¥æœ‰left, top, right, bottom, x, y, width, å’Œ heightè¿™å‡ ä¸ªä»¥åƒç´ ä¸ºå•ä½çš„åªè¯»å±æ€§ç”¨äºæè¿°æ•´ä¸ªè¾¹æ¡†ã€‚é™¤äº†width å’Œ height ä»¥å¤–çš„å±æ€§æ˜¯ç›¸å¯¹äºè§†å›¾çª—å£çš„å·¦ä¸Šè§’æ¥è®¡ç®—çš„ã€‚ å›¾ç‰‡/å…ƒç´ çš„getBoundingClientRect().top &lt; window.innerHeight ä¸” å›¾ç‰‡/å…ƒç´ çš„getBoundingClientRect().bottom &gt; 0 æ–¹æ³•å›› IntersectionObserver APIä¼ ç»Ÿçš„å®ç°æ–¹æ³•æ˜¯ï¼Œç›‘å¬åˆ°scrolläº‹ä»¶åï¼Œè°ƒç”¨ç›®æ ‡å…ƒç´ ï¼ˆç»¿è‰²æ–¹å—ï¼‰çš„getBoundingClientRect()æ–¹æ³•ï¼Œå¾—åˆ°å®ƒå¯¹åº”äºè§†å£å·¦ä¸Šè§’çš„åæ ‡ï¼Œå†åˆ¤æ–­æ˜¯å¦åœ¨è§†å£ä¹‹å†…ã€‚è¿™ç§æ–¹æ³•çš„ç¼ºç‚¹æ˜¯ï¼Œç”±äºscrolläº‹ä»¶å¯†é›†å‘ç”Ÿï¼Œè®¡ç®—é‡å¾ˆå¤§ï¼Œå®¹æ˜“é€ æˆæ€§èƒ½é—®é¢˜ã€‚ ç›®å‰æœ‰ä¸€ä¸ªæ–°çš„ IntersectionObserver APIï¼Œå¯ä»¥è‡ªåŠ¨â€è§‚å¯Ÿâ€å…ƒç´ æ˜¯å¦å¯è§ï¼ŒChrome 51+ å·²ç»æ”¯æŒã€‚ç”±äºå¯è§ï¼ˆvisibleï¼‰çš„æœ¬è´¨æ˜¯ï¼Œç›®æ ‡å…ƒç´ ä¸è§†å£äº§ç”Ÿä¸€ä¸ªäº¤å‰åŒºï¼Œæ‰€ä»¥è¿™ä¸ª API å«åšâ€äº¤å‰è§‚å¯Ÿå™¨â€ã€‚ var io = new IntersectionObserver(callback, option); callbackä¸€èˆ¬ä¼šè§¦å‘ä¸¤æ¬¡ã€‚ä¸€æ¬¡æ˜¯ç›®æ ‡å…ƒç´ åˆšåˆšè¿›å…¥è§†å£ï¼ˆå¼€å§‹å¯è§ï¼‰ï¼Œå¦ä¸€æ¬¡æ˜¯å®Œå…¨ç¦»å¼€è§†å£ï¼ˆå¼€å§‹ä¸å¯è§ï¼‰ã€‚ // å¼€å§‹è§‚å¯Ÿ io.observe(document.getElementById('example')); // åœæ­¢è§‚å¯Ÿ io.unobserve(element); // å…³é—­è§‚å¯Ÿå™¨ io.disconnect(); callbackå‡½æ•°çš„å‚æ•°ï¼ˆentriesï¼‰æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œæ¯ä¸ªæˆå‘˜éƒ½æ˜¯ä¸€ä¸ªIntersectionObserverEntryå¯¹è±¡ IntersectionObserverEntryå¯¹è±¡æä¾›ç›®æ ‡å…ƒç´ çš„ä¿¡æ¯ï¼Œä¸€å…±æœ‰å…­ä¸ªå±æ€§ã€‚ timeï¼šå¯è§æ€§å‘ç”Ÿå˜åŒ–çš„æ—¶é—´ï¼Œæ˜¯ä¸€ä¸ªé«˜ç²¾åº¦æ—¶é—´æˆ³ï¼Œå•ä½ä¸ºæ¯«ç§’ targetï¼šè¢«è§‚å¯Ÿçš„ç›®æ ‡å…ƒç´ ï¼Œæ˜¯ä¸€ä¸ª DOM èŠ‚ç‚¹å¯¹è±¡ rootBoundsï¼šæ ¹å…ƒç´ çš„çŸ©å½¢åŒºåŸŸçš„ä¿¡æ¯ï¼ŒgetBoundingClientRect()æ–¹æ³•çš„è¿”å›å€¼ï¼Œå¦‚æœæ²¡æœ‰æ ¹å…ƒç´ ï¼ˆå³ç›´æ¥ç›¸å¯¹äºè§†å£æ»šåŠ¨ï¼‰ï¼Œåˆ™è¿”å›null boundingClientRectï¼šç›®æ ‡å…ƒç´ çš„çŸ©å½¢åŒºåŸŸçš„ä¿¡æ¯ intersectionRectï¼šç›®æ ‡å…ƒç´ ä¸è§†å£ï¼ˆæˆ–æ ¹å…ƒç´ ï¼‰çš„äº¤å‰åŒºåŸŸçš„ä¿¡æ¯ intersectionRatioï¼šç›®æ ‡å…ƒç´ çš„å¯è§æ¯”ä¾‹ï¼Œå³intersectionRectå boundingClientRectçš„æ¯”ä¾‹ï¼Œå®Œå…¨å¯è§æ—¶ä¸º1ï¼Œå®Œå…¨ä¸å¯è§æ—¶å°äºç­‰äº0 å®ç°æ‡’åŠ è½½å®ä¾‹ const observer = new IntersectionObserver(function(changes) { changes.forEach(function(element, index) { // å½“è¿™ä¸ªå€¼å¤§äº0ï¼Œè¯´æ˜æ»¡è¶³æˆ‘ä»¬çš„åŠ è½½æ¡ä»¶äº†ï¼Œè¿™ä¸ªå€¼å¯é€šè¿‡rootMarginæ‰‹åŠ¨è®¾ç½® if (element.intersectionRatio > 0) { // æ”¾å¼ƒç›‘å¬ï¼Œé˜²æ­¢æ€§èƒ½æµªè´¹ï¼Œå¹¶åŠ è½½å›¾ç‰‡ã€‚ observer.unobserve(element.target); element.target.src = element.target.dataset.src; } }); }); function initObserver() { const listItems = document.querySelectorAll('list-item-img'); listItems.forEach(function(item) { // å¯¹æ¯ä¸ªlistå…ƒç´ è¿›è¡Œç›‘å¬ observer.observe(item); }); } initObserver(); å…¼å®¹æ€§ Chrome 51+ï¼ˆå‘å¸ƒäº 2016-05-25ï¼‰ Android 5+ ï¼ˆChrome 56 å‘å¸ƒäº 2017-02-06ï¼‰ Edge 15 ï¼ˆ2017-04-11ï¼‰ iOS æ”¯æŒ IEä¸æ”¯æŒã€‚ã€‚ã€‚ moreï¼šé˜®ä¸€å³°è€å¸ˆhttp://www.ruanyifeng.com/blog/2016/11/intersectionobserver_api.html Chrome çš„é»‘ç§‘æŠ€â€”â€”loading å±æ€§ä»æ–°ç‰ˆæœ¬ Chrome(76)å¼€å§‹ï¼Œå·²ç»é»˜è®¤æ”¯æŒä¸€ç§æ–°çš„ html å±æ€§â€”â€”loadingï¼Œå®ƒåŒ…å«ä¸‰ç§å–å€¼:autoã€lazy å’Œ eager(ps: ä¹‹å‰æœ‰æ–‡ç« è¯´æ˜¯ lazyload å±æ€§ï¼Œåæ¥ chrome çš„å·¥ç¨‹å¸ˆå·²ç»å°†å…¶ç¡®å®šä¸º loading å±æ€§ï¼ŒåŸå› æ˜¯ lazyload è¯­ä¹‰ä¸å¤Ÿæ˜ç¡®)ï¼Œæˆ‘ä»¬çœ‹çœ‹è¿™ä¸‰ç§å±æ€§æœ‰ä»€ä¹ˆä¸åŒï¼š autoï¼šè®©æµè§ˆå™¨è‡ªåŠ¨å†³å®šæ˜¯å¦è¿›è¡Œæ‡’åŠ è½½ï¼Œè¿™å…¶ä¸­çš„æœºåˆ¶å°šä¸æ˜ç¡®ã€‚ lazyï¼šæ˜ç¡®åœ°è®©æµè§ˆå™¨å¯¹æ­¤å›¾ç‰‡è¿›è¡Œæ‡’åŠ è½½ï¼Œå³å½“ç”¨æˆ·æ»šåŠ¨åˆ°å›¾ç‰‡é™„è¿‘æ—¶æ‰è¿›è¡ŒåŠ è½½ï¼Œä½†ç›®å‰æ²¡æœ‰å…·ä½“è¯´æ˜è¿™ä¸ªâ€œé™„è¿‘â€å…·ä½“æ˜¯å¤šè¿‘ã€‚ eagerï¼šè®©æµè§ˆå™¨ç«‹åˆ»åŠ è½½æ­¤å›¾ç‰‡ã€‚ æˆ‘ä»¬å¯ä»¥é€šè¿‡ chrome çš„å¼€å‘å·¥å…·çœ‹çœ‹è¿™ä¸ªdemoä¸­çš„å›¾ç‰‡åŠ è½½æ–¹å¼ï¼Œæˆ‘ä»¬æŠŠä¸Šä¸€ä¸ª demo ä¸­çš„ js è„šæœ¬éƒ½åˆ æ‰äº†ï¼Œåªç”¨äº† loading=lazy è¿™ä¸ªå±æ€§ã€‚æ¥ç€ï¼Œå‹¾é€‰å·¥å…·æ ä¸­çš„ Disabled Cache åä»”ç»†è§‚å¯Ÿ Network ä¸€æ ï¼Œç»†å¿ƒçš„äººåº”è¯¥ä¼šå‘ç°ï¼Œä¸€å¼ å›¾ç‰‡è¢«åˆ†ä¸ºäº†ä¸¤æ¬¡å»è¯·æ±‚ï¼ç¬¬ä¸€æ¬¡çš„çŠ¶æ€ç æ˜¯ 206ï¼Œç¬¬äºŒæ¬¡çš„çŠ¶æ€ç æ‰æ˜¯ 200ï¼Œå¦‚å›¾æ‰€ç¤ºï¼š è¦æ³¨æ„ï¼Œä½¿ç”¨è¿™é¡¹ç‰¹æ€§è¿›è¡Œå›¾ç‰‡æ‡’åŠ è½½æ—¶ï¼Œè®°å¾—å…ˆè¿›è¡Œå…¼å®¹æ€§å¤„ç†ï¼Œå¯¹ä¸æ”¯æŒè¿™é¡¹å±æ€§çš„æµè§ˆå™¨ï¼Œè½¬è€Œä½¿ç”¨ JavaScript æ¥å®ç°ï¼Œæ¯”å¦‚ä¸Šé¢è¯´åˆ°çš„ IntersectionObserver ä½¿ç”¨ï¼š &lt;li class=\"list-item\"> &lt;img class=\"list-item-img\" alt=\"loading\" loading=\"lazy\" src='https://ss0.bdstatic.com/70cFvHSh_Q1YnxGkpoWK1HF6hhy/it/u=3648955221,727328923&amp;fm=26&amp;gp=0.jpg'> &lt;/li> åŸç† æµè§ˆå™¨ä¼šå‘é€ä¸€ä¸ªé¢„è¯·æ±‚ï¼Œä½†æ˜¯è¿™ä¸ªè¯·æ±‚åªæ‹‰å–è¿™å¼ å›¾ç‰‡çš„å¤´éƒ¨æ•°æ®ï¼Œä»è¿™æ®µæ•°æ®ä¸­ï¼Œæµè§ˆå™¨å°±å¯ä»¥è§£æå‡ºå›¾ç‰‡çš„å®½é«˜ç­‰åŸºæœ¬ç»´åº¦ï¼Œæ¥ç€æµè§ˆå™¨ç«‹é©¬ä¸ºå®ƒç”Ÿæˆä¸€ä¸ªç©ºç™½çš„å ä½ï¼Œæ­¤æ—¶è¿”å›206ï¼ˆèŒƒå›´è¯·æ±‚ï¼‰ åœ¨ç”¨æˆ·æ»šåŠ¨åˆ°å›¾ç‰‡é™„è¿‘æ—¶ï¼Œå†å‘èµ·ä¸€ä¸ªè¯·æ±‚ï¼Œå®Œæ•´åœ°æ‹‰å–å›¾ç‰‡çš„æ•°æ®ä¸‹æ¥ï¼Œè¿™ä¸ªæ‰æ˜¯æˆ‘ä»¬ç†Ÿæ‚‰çš„çŠ¶æ€ç 200è¯·æ±‚ã€‚ é¢å¯¹è¿æ¥æ•°ï¼Œä¸ç”¨æ€•ï¼Œæœ‰http2.0çš„å¤šè·¯å¤ç”¨æ’‘è…° å…¼å®¹å¤„ç† if (\"loading\" in HTMLImageElement.prototype) { // æ²¡æ¯›ç—… } else { // ..... } æ¥æºhttps://zhuanlan.zhihu.com/p/76820878 5.åŠ¨ç”»å‡½æ•°å°è£…åŸç†ï¼šè·å–ç›’å­å½“å‰ä½ç½®ï¼ˆpositionï¼‰ï¼Œé€šè¿‡å®šæ—¶å™¨setinterval()ä¸æ–­ç§»åŠ¨ç›’å­ä½ç½®ï¼Œåˆ©ç”¨å®šæ—¶å™¨ä¸æ–­è®©ç›’å­å½“å‰ä½ç½®åŠ ä¸Šä¸€ä¸ªç§»åŠ¨è·ç¦»ï¼Œæœ€ååŠ ä¸€ä¸ªç»“æŸå®šæ—¶å™¨æ¡ä»¶ï¼ˆå…¶å®ä¹Ÿå¯ä»¥ç”¨CSS animation å®šä¹‰åŠ¨ç”»ï¼‰ &lt;div>&lt;/div> &lt;script> //ç®€å•åŠ¨ç”»å‡½æ•°å°è£…objç›®æ ‡å‡½æ•°ï¼Œtargetç›®æ ‡ä½ç½® //ç»™ä¸åŒçš„å…ƒç´ åˆ¶å®šäº†ä¸åŒçš„å®šæ—¶å™¨ //ä¸è¿‡å†jsä¸­å°½é‡é¿å…è¿™ä¸€ç§â€œå…ˆåˆ›å»ºå†è¡¥å……â€çš„åŠ¨æ€å±æ€§èµ‹å€¼ function animate(obj, target) { obj.timer = setInterval(function () { if (obj.offsetLeft >= target) { clearInterval(obj.timer); } else { obj.style.left = obj.offsetLeft + 5 + 'px'; } }, 30); } // è°ƒç”¨å‡½æ•° let div = document.querySelector('div'); animate(div, 300); &lt;/script> ç¼“åŠ¨åŠ¨ç”»ï¼šè®©å…ƒç´ è¿åŠ¨é€Ÿåº¦æœ‰æ‰€å˜åŒ– ï¼Œå³è®©å®ƒæ¯æ¬¡ç§»åŠ¨çš„è·ç¦»æœ‰æ‰€å˜åŒ–ï¼ˆå¦‚æ…¢æ…¢å˜å°ï¼‰å°±å¯ä»¥è¾¾åˆ°æ•ˆæœ æ¯”å¦‚å¯ä»¥ï¼šï¼ˆç›®æ ‡å€¼-ç°åœ¨ä½ç½®ï¼‰/10 ä½œä¸ºæ¯æ¬¡ç§»åŠ¨çš„æ­¥é•¿ åœæ­¢æ¡ä»¶ï¼šè®©ç›’å­ä½ç½®ç­‰äºç›®æ ‡ä½ç½® åŠ¨ç”»å‡½æ•°æ·»åŠ å›è°ƒå‡½æ•°ï¼šå›è°ƒå‡½æ•°åŸç†ä¸ºå‡½æ•°ä½œä¸ºä¸€ä¸ªå‚æ•°ï¼Œå³å°†è¿™ä¸ªå‡½æ•°ä½œä¸ºå‚æ•°ä¼ åˆ°å¦ä¸€ä¸ªå‡½æ•°é‡Œï¼Œå½“é‚£ä¸ªå‡½æ•°æ‰§è¡Œå®Œæ¯•ä¹‹åï¼Œå†æ‰§è¡Œä¼ è¿›å»çš„è¿™ä¸ªå‡½æ•°ï¼Œè¿™ä¸ªè¿‡ç¨‹å«åšå›è°ƒ æ·»åŠ äº†ä¸€ç‚¹ç»†èŠ‚å’Œå›è°ƒå‡½æ•°åçš„æ”¹è¿›ä»£ç  //ç®€å•åŠ¨ç”»å‡½æ•°å°è£…objç›®æ ‡å‡½æ•°ï¼Œtargetç›®æ ‡ä½ç½® //ç»™ä¸åŒçš„å…ƒç´ åˆ¶å®šäº†ä¸åŒçš„å®šæ—¶å™¨ //ä¸è¿‡å†jsä¸­å°½é‡é¿å…è¿™ä¸€ç§â€œå…ˆåˆ›å»ºå†è¡¥å……â€çš„åŠ¨æ€å±æ€§èµ‹å€¼ function animate(obj, target, callback) { // å½“æˆ‘ä»¬ä¸æ–­ç‚¹å‡»æŒ‰é’®ï¼Œå…ƒç´ é€Ÿåº¦ä¼šè¶Šæ¥è¶Šå¿«ï¼Œå› ä¸ºå¼€å¯äº†å¤ªå¤šå®šæ—¶å™¨ // è§£å†³æ–¹æ¡ˆå°±æ˜¯è®©æˆ‘æ©çš„å…ƒç´ åªæœ‰ä¸€ä¸ªå®šæ—¶å™¨æ‰§è¡Œ,æ¸…æ¥šä¹‹å‰çš„å®šæ—¶å™¨ clearInterval(obj.timer); obj.timer = setInterval(function () { // æŠŠæ­¥é•¿å€¼æ”¹ä¸ºæ•´æ•°ï¼Œä¸è¦å‡ºç°å°æ•°çš„é—®é¢˜ let step = (target - obj.offsetLeft) / 10; // æ­£å€¼å¾€å°çš„å–æ•´ï¼Œè´Ÿå€¼å¾€å¤§çš„å–è¯, ä¿è¯æ•°å€¼åˆšå¥½ç­‰äºtargetï¼ˆï¼‰ step = step > 0 ? Math.ceil(step) : Math.floor(step); // å¯ä»¥è®©800å›åˆ°500ï¼Œæ‰€ä»¥ç”¨== è€Œä¸æ˜¯>= if (obj.offsetLeft == target) { clearInterval(obj.timer); // å¦‚æœæœ‰å›è°ƒå‡½æ•°ï¼Œåœ¨å®šæ—¶å™¨ç»“æŸæ—¶è°ƒç”¨ /*if (callback) { callback(); }*/ //æ›´æ£’å†™æ³• callback &amp;&amp; callback(); } else { obj.style.left = obj.offsetLeft + step + 'px'; } }, 30); } // è°ƒç”¨å‡½æ•° let div = document.querySelector('div'); let btn500 = document.querySelector('.btn500'); let btn800 = document.querySelector('.btn800'); btn500.addEventListener('click', function () { animate(div, 500, function () { alert('hello') }); }) btn800.addEventListener('click', function () { animate(div, 800); }) 6.åŒå‡»è¿›å…¥å…¨å±è¿™å¯ä»¥åœ¨å¾ˆå¤šæµè§ˆå™¨ä¸­é€‚ç”¨ï¼Œä½†æ˜¯ it wonâ€™t work in Safariã€‚ã€‚ window.addEventListener(\"dblclick\", () => { if (!document.fullscreenElement) { canvas.requestFullscreen(); } else { document.exitFullscreen(); } }); éœ€è¦é€‚é…ä¸€ä¸‹ï¼š window.addEventLisnter('dblclick', () => { if(!document.fullscreenElement) { canvas.requestFullscreem()'' } else { document.exitFullscreen(); } }) ç§»åŠ¨ç«¯ç§»åŠ¨ç«¯å…¼å®¹æ€§è¾ƒå¥½ï¼Œæˆ‘ä»¬ä¸éœ€è¦è€ƒè™‘ä»¥å‰jsçš„å…¼å®¹é—®é¢˜ï¼Œå¯ä»¥æ”¾å¿ƒä½¿ç”¨åŸç”Ÿçš„JSä¹¦å†™ï¼Œä½†æ˜¯ç§»åŠ¨ç«¯ä¹Ÿæœ‰è‡ªå·±ç‹¬ç‰¹çš„åœ°æ–¹ï¼Œå¦‚touchäº‹ä»¶ç­‰ 1.touchäº‹ä»¶å“åº”ç”¨æˆ·æ‰‹æŒ‡å¯¹å±å¹•çš„æ“ä½œ touchstart æ‰‹æŒ‡è§¦æ‘¸åˆ°ä¸€ä¸ªdomå…ƒç´  ï¼ˆåƒmousedownï¼‰ touchmove æ‰‹æŒ‡åœ¨ä¸€ä¸ªdomå…ƒç´ ä¸Šæ»‘åŠ¨ ï¼ˆåƒmousemoveï¼‰ touchend æ‰‹æŒ‡ä»ä¸€ä¸ªdomå…ƒç´ ä¸Šç§»å¼€ ï¼ˆåƒmouseupï¼‰ div.addEventListener('touchstart', function() {}) ç§»åŠ¨ç«¯æ‹–åŠ¨åŸç†ï¼šç›’å­åŸæ¥çš„ä½ç½®+æ‰‹æŒ‡ç§»åŠ¨çš„è·ç¦» æ‹–åŠ¨ä¸‰éƒ¨æ›²ï¼šï¼ˆæ‰‹æŒ‡ç§»åŠ¨ä¼šè§¦å‘æ»šåŠ¨å±å¹•ï¼Œæ‰€ä»¥è¦åœ¨è¿™é‡Œé˜»æ­¢çš„å±å¹•æ»šåŠ¨e.preventDefault()ï¼‰ è§¦æ‘¸ touchstart è·å–åˆå§‹åæ ‡ ç§»åŠ¨æ‰‹æŒ‡ touchmove è®¡ç®—æ‰‹æŒ‡æ»‘åŠ¨è·ç¦»ï¼Œå¹¶ä¸”ç§»åŠ¨ç›’å­ ç¦»å¼€æ‰‹æŒ‡ touchend //divåŠ äº†ç»å¯¹å®šä½ &lt;div>&lt;/div> &lt;script> let startX = 0; let startY = 0; let x = 0; let y = 0; let div = document.querySelector('div'); div.addEventListener('touchstart', function (e) { // è·å–ç¬¬ä¸€ä¸ªè§¦ç¢°çš„åæ ‡ startX = e.targetTouches[0].pageX; startY = e.targetTouches[0].pageY; // è·å–ç›’å­çš„ä½ç½® x = this.offsetLeft; y = this.offsetTop; }) div.addEventListener('touchmove', function (e) { // è®¡ç®—æ‰‹æŒ‡ç§»åŠ¨çš„è·ç¦»ï¼Œæ‰‹æŒ‡ç§»åŠ¨ååæ ‡-æ‰‹æŒ‡åˆå§‹åæ ‡ let moveX = e.targetTouches[0].pageX - startX; let moveY = e.targetTouches[0].pageY - startY; // ç§»åŠ¨ç›’å­ this.style.left = x + moveX + 'px'; this.style.top = y + moveY + 'px'; // é˜»æ­¢å±å¹•æ»šåŠ¨ e.preventDefault(); }) &lt;/script> æ— è®ºæ˜¯eä¸­çš„ targetTouches è¿˜æ˜¯ touches é‡Œé¢çš„iteméƒ½å±äºä¸€ä¸ª Touch å¯¹è±¡ touchesï¼šä¸€ä¸ªTouchå¯¹è±¡ä»£è¡¨ä¸€ä¸ªè§¦ç‚¹ï¼Œå½“æœ‰å¤šä¸ªæ‰‹æŒ‡è§¦æ‘¸å±å¹•æ—¶ï¼ŒTouchListå°±ä¼šå­˜å‚¨å¤šä¸ªTouchå¯¹è±¡ï¼Œå‰é¢è¯´åˆ°çš„identifierå°±ç”¨æ¥åŒºåˆ†æ¯ä¸ªæ‰‹æŒ‡å¯¹åº”çš„Touchå¯¹è±¡ã€‚ pageXã€clientXã€screenXçš„ä¸åŒï¼šhttps://stackoverflow.com/questions/6073505/what-is-the-difference-between-screenx-y-clientx-y-and-pagex-y 2.ç§»åŠ¨ç«¯å¸¸è§ç‰¹æ•ˆtransitionend äº‹ä»¶ç§»åŠ¨ç«¯å…¼å®¹æ€§è¾ƒå¼ºï¼Œåœ¨jsåˆ¶ä½œæ—¶å¯ä»¥ç©¿æ’ transform:translate(x, y) ã€transition ç­‰ï¼Œ å¯¹äºtransition ï¼Œæ­¤æ—¶éœ€è¦ç”¨åˆ° transitionend äº‹ä»¶ ï¼Œç­‰å¾…è¿‡æ¸¡å®Œæˆä¹‹åï¼Œå†å»åˆ¤æ–­æ˜¯å¦åˆ°è¾¾æœ€åä¸€å¼ ï¼Œç›‘å¬è¿‡æ¸¡å®Œæˆäº‹ä»¶ classList å±æ€§å®ƒæ˜¯h5æ–°å¢çš„å±æ€§ï¼Œè¿”å›å…ƒç´ çš„ç±»åï¼ˆè¿”å›å½¢å¼ä¸ºæ•°ç»„ï¼Œå› ä¸ºä¸€ä¸ªå…ƒç´ å¯èƒ½åŒ…å«å¤šä¸ªç±»ï¼‰ï¼Œä½†æ˜¯ie10ä»¥ä¸Šæ‰æ”¯æŒï¼ˆç§»åŠ¨ç«¯ä¹Ÿæ”¯æŒï¼‰ let div = document.querySelector('div'); //è¿”å›ç¬¬ä¸€ä¸ªç±»çš„ç±»å console.log(div.classList[0]); æ·»åŠ ç±»å, æ˜¯è¿½åŠ ï¼Œä¸ä¼šè¦†ç›–ä»¥å‰çš„ç±»åï¼Œæ³¨æ„xxå‰é¢ä¸ç”¨åŠ  â€˜.â€™ element.classList.add(&#39;xx&#39;) ç§»é™¤ç±»å element.classList.remove(&#39;xx&#39;) åˆ‡æ¢ç±»åï¼ˆåŸæ¥æœ‰ï¼Œå°±ç»™ä½ åˆ é™¤æ‰ï¼ŒåŸæ¥æ²¡æœ‰ï¼Œå°±ç»™ä½ åŠ ä¸Šï¼‰ element.classList.toggle(&#39;xx&#39;) ç§»åŠ¨ç«¯clické—®é¢˜ç§»åŠ¨ç«¯clickäº‹ä»¶ä¼šæœ‰300msçš„å»¶è¿Ÿï¼ŒåŸå› æ˜¯ç§»åŠ¨ç«¯åŒå‡»ä¼šç¼©æ”¾é¡µé¢ è§£å†³æ–¹æ¡ˆ1ï¼šç¦ç”¨ç¼©æ”¾åŠŸèƒ½ &lt;meta name=&quot;viewport&quot; content=&quot;user-scalable=no&quot;&gt; åœ¨æœ€é¡¶ç«¯çš„è§†å£æ ‡ç­¾å¤„å†™ä¸‹user-scalable=no è§£å†³æ–¹æ¡ˆ2ï¼šåˆ©ç”¨touchäº‹ä»¶è‡ªå·±å°è£…ï¼š æ‰‹æŒ‡è§¦å±è®°å½•è§¦æ‘¸æ—¶é—´ æ‰‹æŒ‡ç¦»å¼€å±å¹•ï¼Œç”¨ç¦»å¼€æ—¶é—´å‡å»è§¦æ‘¸çš„æ—¶é—´ï¼Œè‹¥æ—¶é—´å°äºæŒ‡å®šæ—¶é—´åˆ™æ²¡æœ‰ç¼©æ”¾å±å¹•ï¼Œå®šä¹‰ä¸ºç‚¹å‡»äº‹ä»¶ ç¦æ­¢åŒæŒ‡æ”¾å¤§ document.documentElement.addEventListener('touchstart', function (event) { if (event.touches.length > 1) { //touchesæ˜¯ä¸€ä¸ª TouchListï¼Œå…¶ä¼šåˆ—å‡ºæ‰€æœ‰å½“å‰åœ¨ä¸è§¦æ‘¸è¡¨é¢æ¥è§¦çš„ Touch å¯¹è±¡ event.preventDefault(); } }, false); ç¦æ­¢åŒå‡»æ”¾å¤§ var lastTouchEnd = 0; document.documentElement.addEventListener('touchend', function (event) { var now = Date.now(); if (now - lastTouchEnd &lt;= 300) { event.preventDefault(); } lastTouchEnd = now; }, false); è§£å†³æ–¹æ¡ˆ3ï¼šä½¿ç”¨fastclickæ’ä»¶ åœ¨ vue ä¸­ npm i fastclick -S åœ¨ main.js ä¸­ import fastClick from 'fastclick' fastClick.attach(document.body) å±•æœ›ç°åœ¨è°·æ­Œçš„å¼€å‘è€…æ–‡æ¡£ã€Š300ms tap delay, gone awayã€‹é‡Œé¢è¿˜æåˆ°åœ¨2014å¹´çš„Chrome 32ç‰ˆæœ¬å·²ç»æŠŠè¿™ä¸ªå»¶è¿Ÿå»æ‰äº†ï¼Œå¦‚æœæœ‰ä¸€ä¸ªmetaæ ‡ç­¾ï¼š &lt;meta name=\"viewport\" content=\"width=device-width\"> å³æŠŠviewportè®¾ç½®æˆè®¾å¤‡çš„å®é™…åƒç´ ï¼Œé‚£ä¹ˆå°±ä¸ä¼šæœ‰è¿™300msçš„å»¶è¿Ÿï¼Œå¹¶ä¸”è¿™ä¸ªä¸¾åŠ¨å—åˆ°äº†IE/Firefox/Safari(IOS 9.3)çš„æ”¯æŒï¼Œä¹Ÿå°±æ˜¯è¯´ç°åœ¨çš„ç§»åŠ¨ç«¯å¼€å‘å¯ä»¥ä¸ç”¨é¡¾è™‘clickä¼šæ¯”è¾ƒè¿Ÿé’çš„é—®é¢˜ã€‚ å¦‚æœè®¾ç½®initial-scale=1.0ï¼Œåœ¨chromeä¸Šæ˜¯å¯ä»¥ç”Ÿæ•ˆï¼Œä½†æ˜¯Safariä¸ä¼šï¼š &lt;meta name=\"viewport\" content=\"initial-scale=1.0\"> è¿˜æœ‰ç¬¬ä¸‰ç§åŠæ³•å°±æ˜¯è®¾ç½®CSSï¼š html{ touch-action: manipulation; } è¿™æ ·ä¹Ÿå¯ä»¥å–æ¶ˆæ‰300msçš„å»¶è¿Ÿï¼ŒChromeå’ŒSafariéƒ½å¯ä»¥ç”Ÿæ•ˆã€‚ 3.æ‘‡ä¸€æ‘‡äº‹ä»¶html5æ–°å¢äº†ä¸€ä¸ªdevicemotionçš„äº‹ä»¶ï¼Œå¯ä»¥ä½¿ç”¨æ‰‹æœºçš„é‡åŠ›æ„Ÿåº”ã€‚å¦‚ä¸‹ä»£ç æ‰€ç¤ºï¼š window.ondevicemotion = function(event){ var gravity = event.accelerationIncludingGravity; console.log(gravity.x, gravity.y, gravity.z); } xï¼Œyï¼Œzè¡¨ç¤ºä¸‰ä¸ªæ–¹å‘çš„é‡åŠ›åŠ é€Ÿåº¦ devicemotionäº‹ä»¶ä¼šè¢«ä¸æ–­åœ°è§¦å‘ï¼Œæ ¹æ®ä»¥ä¸Šï¼Œæˆ‘ä»¬å¯ä»¥æ‹¿åˆ°æ‘‡æ‘†çš„è§’åº¦ + æ—¶é—´é—´éš”æ¥åˆ¤æ–­ç”¨æˆ·æ˜¯å¦æ˜¯æ‘‡ä¸€æ‘‡ï¼ æ³¨æ„ï¼šios 13 beat2 æ›´æ–°ä¹‹å, devicemotionå®è·µéœ€è¦ç”¨æˆ·æˆæƒäº† å‚è€ƒé“¾æ¥https://zhuanlan.zhihu.com/p/28052894 4.æ¡†æ¶æ¯”å¦‚bootstrapï¼ŒåŒæ · æ¥è‡ªäºtwitterï¼Œç›®å‰æœ€å—æ¬¢è¿çš„å‰ç«¯æ¡†æ¶(æ‹¿æ¥ä¸»ä¹‰) ä¸­æ–‡å®˜ç½‘ï¼šhttps://www.bootcss.com/ å®˜ç½‘ï¼šhttps://getbootstrap.com/ 2.x.x å·²ç»åœæ­¢ç»´æŠ¤ï¼ŒåŠŸèƒ½ä¸å¤Ÿå®Œå–„ 3.x.x ç›®å‰ä½¿ç”¨æœ€å¤šï¼Œä½†å·²ç»æ”¾å¼ƒäº†ie6ï¼Œie7ï¼Œå¯¹ie8æ”¯æŒä½†æ˜¯ç•Œé¢æ•ˆæœä¸å¥½ï¼Œåå‘äºå¼€å‘å“åº”å¼å¸ƒå±€ï¼Œç§»åŠ¨è®¾å¤‡ä¼˜å…ˆçš„webé¡¹ç›® 4.x.x æœ€æ–°ç‰ˆï¼Œä½†æ˜¯ç›®å‰ä¸æµè¡Œ æ ¹æ®å®˜ç½‘çš„ä»‹ç»å¼•å…¥jså’Œç»“æ„å³å¯ä½¿ç”¨ 5.ç§»åŠ¨ç«¯æ»šåŠ¨é»˜è®¤çš„æ»šåŠ¨åŸç†ï¼Œåœ¨ç§»åŠ¨ç«¯ååˆ†å¡é¡¿ å¯ä»¥åœ¨githubä¸Šå®‰è£… better-scroll æ¡†æ¶ è®©ä½ çš„æ»šåŠ¨æ›´åŠ ä¸æ»‘ åŸç”Ÿ JS å®ç°å±€éƒ¨æ»šåŠ¨ï¼šç»™å®šç›’å­é«˜åº¦ï¼Œä½¿ç”¨ overflow:scroll ä½¿ç”¨better-scroll :ï¼ˆè€å¸ˆç”¨çš„ç‰ˆæœ¬1.13.2ï¼‰ å®‰è£… npm i better-scroll åŸºæœ¬ä½¿ç”¨åœ¨æ»šåŠ¨å†…å®¹å¤–é¢å¥—ä¸Šä¸€ä¸ª div æ ‡ç­¾ï¼Œ class=&quot;wrapper&quot; åœ¨jsé‡Œå¼•å…¥å¹¶ä¸”ä½¿ç”¨ import BScroll from 'better-scroll' let wrapper = document.querySelector(\".wrapper\"); //æ»šåŠ¨å†…å®¹éƒ¨åˆ†çš„å…ƒç´  let scroll = new BScroll(wrapper, {}); //åˆ›å»ºBScrollå®ä¾‹ å¦‚æœåœ¨vueå†…ä½¿ç”¨ï¼Œå¯ä»¥æŠŠåˆ›å»ºBScrollå¯¹è±¡æ”¾åœ¨ mountedç”Ÿå‘½å‘¨æœŸé’©å­é‡Œ htmléƒ¨åˆ†ï¼š æ³¨æ„ï¼šwrapperå­å…ƒç´ åªèƒ½æœ‰ä¸€ä¸ªï¼Œæ‰€ä»¥ä¸èƒ½ç›´æ¥ç»‘å®šåœ¨ulä¸Š æ³¨æ„ï¼šwrapper åœ¨CSSé‡Œå¿…é¡»è¦æœ‰ä¸€ä¸ªå›ºå®šçš„é«˜åº¦ &lt;div class=\"wrapper\"> &lt;ul> &lt;!--è®¸å¤šçš„li --> &lt;/ul> &lt;/div> äº‹ä»¶ç›‘å¬BScrollåˆ›å»ºå‡ºæ¥çš„å®ä¾‹å¯ä»¥ä½¿ç”¨ on ç›‘å¬äº‹ä»¶ srollæ˜¯æ»šåŠ¨äº‹ä»¶ pullingUpæ˜¯ä¸Šæ‹‰äº‹ä»¶ ä½†æ˜¯ *é»˜è®¤ *æƒ…å†µä¸‹ BScrollæ˜¯ä¸èƒ½å®æ—¶ç›‘å¬æ»šåŠ¨ä½ç½®çš„ï¼Œéœ€è¦é…ç½®probeType better-scroll ç®¡ç†çš„æ ‡ç­¾å†…éƒ¨é»˜è®¤ä¼šé˜»æ­¢æµè§ˆå™¨åŸç”Ÿçš„clickäº‹ä»¶ï¼Œéœ€è¦é…ç½®click å¿…é¡»åœ¨å®ä¾‹å¯¹è±¡é‡Œå¼€å¯pullUpLoadæ‰èƒ½ä½¿ç”¨pullingUpäº‹ä»¶ï¼ŒpullingUpäº‹ä»¶åªä¼šè§¦å‘ä¸€æ¬¡ï¼Œæƒ³è¦åœ¨å‘é€ç½‘ç»œè¯·æ±‚ï¼Œå°†æ–°æ•°æ®å±•ç¤ºå®Œæ¯•ç»§ç»­ä½¿ç”¨è¯¥åŠŸèƒ½çš„è¯ï¼Œéœ€è¦ scroll.finishPullUp() new BScroll(wrapper, {é…ç½®option}) 1.é‡è¦é…ç½®å±æ€§probeType, probeï¼šä¾¦æµ‹, é»˜è®¤å€¼0ï¼ˆç”¨scrolläº‹ä»¶ç›‘å¬ï¼‰ 0ã€1éƒ½è¡¨ç¤ºä¸ä¾¦æµ‹ 1ï¼šéå®æ—¶ï¼ˆå±å¹•æ»‘åŠ¨è¶…è¿‡ä¸€å®šæ—¶é—´åï¼‰æ´¾å‘scroll äº‹ä»¶ï¼› 2ï¼šæ‰‹æŒ‡æ»‘åŠ¨æ—¶ä¾¦æµ‹ï¼Œæƒ¯æ€§æ»‘åŠ¨ä¸ä¾¦æµ‹ 3ï¼šåªè¦æ»šåŠ¨éƒ½è¿›è¡Œä¾¦æµ‹ 2.clickï¼Œé»˜è®¤å€¼false better-scrollç®¡ç†çš„æ ‡ç­¾å†…éƒ¨é»˜è®¤ä¼šé˜»æ­¢æµè§ˆå™¨åŸç”Ÿçš„clickäº‹ä»¶ å½“è®¾ç½®ä¸ºtrueçš„æ—¶å€™ï¼Œbetter-scrollä¼šæ´¾å‘ä¸€ä¸ªclickäº‹ä»¶ 3.pullUpLoadå¸¸ç”¨äºä¸Šæ‹‰åŠ è½½æ›´å¤š é»˜è®¤å€¼false ç”¨pullingUpè¿›è¡Œäº‹ä»¶ç›‘å¬ï¼Œä¼ å…¥boolean / Object ï¼Œè®¾ç½®ä¸ºtrueæˆ–objectå¼€å¯åŠŸèƒ½ è¿˜æœ‰å¾ˆå¤šoptioné…ç½®ï¼Œè¯¦æƒ…çœ‹å®˜ç½‘ let wrapper = document.querySelector(\".wrapper\"); this.scroll = new BScroll(wrapper, { probeType: 2, click: true, pullUpLoad: true, }); //ç›‘å¬æ»šåŠ¨äº‹ä»¶ this.scroll.on(\"scroll\", (position) => { console.log(position); }); //å›æ‹‰è‡³x,yä½ç½® //this.scroll.scrollTo(x, y[, time]); //ç›‘å¬ä¸Šæ‹‰äº‹ä»¶ this.scroll.on(\"pullingUp\", () => { console.log(\"ä¸Šæ‹‰åŠ è½½æ›´å¤š\"); }); //ç›‘å¬åŠ è½½ä¸€æ¬¡ä¸Šæ‹‰äº‹ä»¶ï¼Œéœ€è¦ä½¿ç”¨æ­¤å‡½æ•°æ‰å¯ä»¥é‡æ–°å¼€å¯ç›‘å¬ä¸Šæ‹‰äº‹ä»¶ pullingUp this.scroll.finishPullUp(); // ä¿®å¤better-scroll å› å¼‚æ­¥çš„ç½‘ç»œè¯·æ±‚å›¾ç‰‡åˆ°è¾¾ï¼Œå´æœªè®¡ç®—å¯æ»šåŠ¨é«˜åº¦è€Œæ— æ³•æ»‘åŠ¨äº§ç”Ÿçš„bugï¼Œä½¿ç”¨refreshè¿›è¡Œåˆ·æ–° this.scroll.refresh(); //è¾“å‡ºæ»šæ¡å½“å‰çš„xå’Œy console.log(this.scroll.x); console.log(this.scroll.y); è§£å†³better-scrollå¯æ»šåŠ¨åŒºåŸŸäº§ç”Ÿçš„bugbetter-scrollæ»šåŠ¨åŒºåŸŸæ˜¯ç”± scrollHeightå±æ€§å†³å®šçš„ï¼Œä¹Ÿå°±æ˜¯contentä¸­å­ç»„ä»¶çš„é«˜åº¦ ä½†æœ‰æ—¶å› ä¸ºå¼‚æ­¥æ“ä½œï¼ˆæ¯”å¦‚ç½‘ç»œè¯·æ±‚ï¼‰ï¼Œå¯¼è‡´ scrollHeightæœªèƒ½å¤Ÿè®¡ç®—å‡ºæ­£ç¡®çš„ç»„ä»¶é«˜åº¦ è§£å†³ï¼š ç›‘å¬æ¯ä¸€å¼ å›¾ç‰‡åŠ è½½å®Œæˆï¼ˆæ¯ä¸€æ¬¡çš„ç½‘ç»œè¯·æ±‚ï¼‰ï¼Œåªè¦æœ‰ä¸€å¼ å›¾ç‰‡åŠ è½½å®Œæˆï¼Œå°±è°ƒç”¨ refresh()ä¸€æ¬¡ img.onload() = funciton(){}ï¼ˆvueä¸­ï¼Œç›‘å¬åŠ è½½åˆ™ @load=&quot;å‡½æ•°å&quot;ï¼‰ ä½¿ç”¨äº‹ä»¶æ€»çº¿ eventBusï¼Œç®¡ç†ã€ä¼ é€’è¯¥åŠ è½½äº‹ä»¶åˆ°å¯¹åº”çš„ç»„ä»¶ï¼Œç„¶åè¿›è¡Œ refresh() 6.é˜²æŠ–å‡½æ•°æœ‰ç‚¹åƒèŠ‚æµé˜€ï¼ŒèŠ‚æµé˜€ï¼šå°†å¤šæ¬¡æ‰§è¡Œå˜ä¸ºåœ¨è§„å®šæ—¶é—´å†…åªæ‰§è¡Œä¸€æ¬¡ ä¹Ÿå°±æ˜¯è¯´ï¼Œé‚£ä¹ˆåœ¨å‡½æ•°æ‰§è¡Œä¸€æ¬¡ä¹‹åï¼Œè¯¥å‡½æ•°åœ¨æŒ‡å®šçš„æ—¶é—´æœŸé™å†…ä¸å†å·¥ä½œï¼Œç›´è‡³è¿‡äº†è¿™æ®µæ—¶é—´æ‰é‡æ–°ç”Ÿæ•ˆã€‚ é˜²æŠ–ï¼š åœ¨è§„å®šçš„æ—¶é—´å†…æ‰§è¡Œå¤šæ¬¡äº‹ä»¶åªæ‰§è¡Œæœ€åä¸€æ¬¡ ï¼ˆåœ¨ç¬¬ä¸€æ¬¡è§¦å‘äº‹ä»¶æ—¶ï¼Œä¸ç«‹å³æ‰§è¡Œå‡½æ•°ï¼Œè€Œæ˜¯ç»™å‡ºä¸€ä¸ªæœŸé™å€¼æ¯”å¦‚200msï¼‰ ä¸Šè¿° â€œè§£å†³better-scrollå¯æ»šåŠ¨åŒºåŸŸäº§ç”Ÿçš„bugâ€ æ“ä½œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œæ¯æœ‰ä¸€å¼ å›¾ç‰‡åŠ è½½å®Œæˆï¼Œåˆ™å‘é€ä¸€æ¬¡è¯·æ±‚ï¼Œè¿™æ ·ä¼šå¤§å¤§é™ä½å‚åŠ ç¨‹åºæ•ˆç‡ã€æ€§èƒ½ ä¸ºæ­¤æˆ‘ä»¬å¯ä»¥å°è£…ä¸€ä¸ªé˜²æŠ–å‡½æ•° function debounce(func, delay) { let timer = null; return function (...args) { if (timer) clearTimeout(timer); timer = setTimeout(() => { // è¿™é‡Œçš„applyåªç”¨ä¸€ä¸ªä¼ å…¥å¤šä¸ªå‚æ•°ä½œç”¨ï¼Œç®­å¤´å‡½æ•°å·²ç»æŒ‡å‘ç¯å¢ƒthisï¼Œä¸éœ€è¦ç”¨applyç»‘å®š func.apply(this, args); }, delay); }; } åœ¨vueä¸­ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨mountedé‡Œè°ƒç”¨è¯¥å‡½æ•° mounted() { // ç›‘å¬goodListItemä¸­å›¾ç‰‡åŠ è½½å®Œæˆ // ä¿®å¤better-scroll å› å¼‚æ­¥çš„ç½‘ç»œè¯·æ±‚å›¾ç‰‡åˆ°è¾¾ï¼Œå´æœªè®¡ç®—å¯æ»šåŠ¨é«˜åº¦è€Œæ— æ³•æ»‘åŠ¨äº§ç”Ÿçš„bugï¼Œä½¿ç”¨refreshè¿›è¡Œåˆ·æ–° // ç„¶åç”¨é˜²æŠ–å‡½æ•°ä¼˜åŒ–,å‡å°‘å‡½æ•°è°ƒç”¨é¢‘ç‡ const refresh = this.debounce(this.$refs.scroll.refresh, 50); //å¾—åˆ°ä¸€ä¸ªå¸¦è®¡æ—¶å™¨çš„å‡½æ•°ï¼Œé‡Œé¢ä¿å­˜ç€é—­åŒ…çš„timer this.$bus.$on(\"itemImageLoad\", () => { refresh(); //è°ƒç”¨refeshè¿›è¡Œæ›´æ–° }); }, 7.èŠ‚æµé˜€æ§åˆ¶é€Ÿåº¦ï¼Œç”¨äºç±»ä¼¼äºé˜²æ­¢è½®æ’­å›¾æŒ‰é’®è¿ç»­ç‚¹å‡»ï¼Œå¯¼è‡´æ’­æ”¾è¿‡å¿«çš„åæœ å³å½“ä¸Šä¸€ä¸ªå‡½æ•°åŠ¨ç”»å†…å®¹æ‰§è¡Œå®Œæ¯•å†å»æ‰§è¡Œä¸‹ä¸€ä¸ªå‡½æ•°åŠ¨ç”»ï¼Œè®©äº‹ä»¶æ— æ³•è¿ç»­è§¦å‘ æ ¸å¿ƒæ€è·¯æ˜¯ï¼šåˆ©ç”¨å›è°ƒå‡½æ•°ï¼Œæ·»åŠ å˜é‡è¿›è¡Œæ§åˆ¶ã€‚é”ä½å‡½æ•°å’Œè§£é”å‡½æ•° // è®¾ç½®èŠ‚æµé˜€ let flag = true; arrow_r.addEventListener('click', function () { if (flag) { flag = false; fun(x, y, function () { flag = true; }); } }) å¹³æ—¶å¼€å‘ä¸­å¸¸é‡åˆ°çš„åœºæ™¯ï¼š æœç´¢æ¡†inputäº‹ä»¶ï¼Œä¾‹å¦‚è¦æ”¯æŒè¾“å…¥å®æ—¶æœç´¢å¯ä»¥ä½¿ç”¨èŠ‚æµæ–¹æ¡ˆï¼ˆé—´éš”ä¸€æ®µæ—¶é—´å°±å¿…é¡»æŸ¥è¯¢ç›¸å…³å†…å®¹ï¼‰ï¼Œæˆ–è€…å®ç°è¾“å…¥é—´éš”å¤§äºæŸä¸ªå€¼ï¼ˆå¦‚500msï¼‰ï¼Œå°±å½“åšç”¨æˆ·è¾“å…¥å®Œæˆï¼Œç„¶åå¼€å§‹æœç´¢ï¼Œå…·ä½“ä½¿ç”¨å“ªç§æ–¹æ¡ˆè¦çœ‹ä¸šåŠ¡éœ€æ±‚ã€‚ é¡µé¢resizeäº‹ä»¶ï¼Œå¸¸è§äºéœ€è¦åšé¡µé¢é€‚é…çš„æ—¶å€™ã€‚éœ€è¦æ ¹æ®æœ€ç»ˆå‘ˆç°çš„é¡µé¢æƒ…å†µè¿›è¡Œdomæ¸²æŸ“ï¼ˆè¿™ç§æƒ…å½¢ä¸€èˆ¬æ˜¯ä½¿ç”¨é˜²æŠ–ï¼Œå› ä¸ºåªéœ€è¦åˆ¤æ–­æœ€åä¸€æ¬¡çš„å˜åŒ–æƒ…å†µï¼‰ è¿™é‡Œå€Ÿç”¨è€å“¥çš„èŠ‚æµä»£ç  ï¼ˆé™„ä¸ŠåŸæ–‡https://segmentfault.com/a/1190000018428170/ï¼‰ function throttle(fn,delay){ let valid = true return function() { if(!valid){ //ä¼‘æ¯æ—¶é—´ æš‚ä¸æ¥å®¢ return false } // å·¥ä½œæ—¶é—´ï¼Œæ‰§è¡Œå‡½æ•°å¹¶ä¸”åœ¨é—´éš”æœŸå†…æŠŠçŠ¶æ€ä½è®¾ä¸ºæ— æ•ˆ valid = false setTimeout(() => { fn() valid = true; }, delay) } } /* è¯·æ³¨æ„ï¼ŒèŠ‚æµå‡½æ•°å¹¶ä¸æ­¢ä¸Šé¢è¿™ç§å®ç°æ–¹æ¡ˆ, ä¾‹å¦‚å¯ä»¥å®Œå…¨ä¸å€ŸåŠ©setTimeoutï¼Œå¯ä»¥æŠŠçŠ¶æ€ä½æ¢æˆæ—¶é—´æˆ³ï¼Œç„¶ååˆ©ç”¨æ—¶é—´æˆ³å·®å€¼æ˜¯å¦å¤§äºæŒ‡å®šé—´éš”æ—¶é—´æ¥åšåˆ¤å®šã€‚ ä¹Ÿå¯ä»¥ç›´æ¥å°†setTimeoutçš„è¿”å›çš„æ ‡è®°å½“åšåˆ¤æ–­æ¡ä»¶-åˆ¤æ–­å½“å‰å®šæ—¶å™¨æ˜¯å¦å­˜åœ¨ï¼Œå¦‚æœå­˜åœ¨è¡¨ç¤ºè¿˜åœ¨å†·å´ï¼Œå¹¶ä¸”åœ¨æ‰§è¡Œfnä¹‹åæ¶ˆé™¤å®šæ—¶å™¨è¡¨ç¤ºæ¿€æ´»ï¼ŒåŸç†éƒ½ä¸€æ · */ // ä»¥ä¸‹ç…§æ—§ function showTop () { var scrollTop = document.body.scrollTop || document.documentElement.scrollTop; console.log('æ»šåŠ¨æ¡ä½ç½®ï¼š' + scrollTop); } window.onscroll = throttle(showTop,1000) å…¶å®ä¹Ÿå¯ä»¥ç§°ä¹‹ä¸ºå‰ç½®é˜²æŠ–ï¼Œå› ä¸ºå¯ä»¥è¿™æ ·å†™ // å‰ç½®æ‰§è¡Œçš„é˜²æŠ– export const leadDebounce = (fn, delay = 400) => { let timer = null; return function () { if (timer) return; // eslint-disable-next-line prefer-rest-params if (fn) fn.apply(this, arguments); timer = setTimeout(() => { clearTimeout(timer); timer = null; }, delay); }; }; 8.å¼‚æ­¥ç«æ€è§£å†³æ–¹æ¡ˆï¼š èŠ‚æµé˜€ï¼šå¯èƒ½å¯¼è‡´ç”¨æˆ·ç‚¹å‡»æ— æ³•å“åº” é˜²æŠ–ï¼šå¯èƒ½å¯¼è‡´ç”¨æˆ·ç‚¹å‡»å»¶è¿Ÿç›¸åº” è®¾ç½®åŠ è½½ä¸­çš„å¼¹çª— é—­åŒ…çš„æ–¹å¼ï¼š(Reactä»£ç )ï¼Œæ¯ä¸€æ¬¡é‡æ–°æ¸²æŸ“ä¼šé‡æ–°åŠ è½½useEffectï¼Œå¹¶ä¸”è°ƒç”¨returné‡Œçš„å‡½æ•°ï¼Œç”±æ­¤å°†é—­åŒ…ä¸­çš„ç‹¬ç«‹çš„didRequestæ”¹ä¸ºtrueï¼Œä½¿å¾—æ•°æ®æ— æ³•æ›´æ”¹ï¼ˆsetStateï¼‰ å®˜æ–¹è§£é‡Šï¼šå¦‚æœç»„ä»¶å¤šæ¬¡æ¸²æŸ“ï¼ˆé€šå¸¸å¦‚æ­¤ï¼‰ï¼Œåˆ™åœ¨æ‰§è¡Œä¸‹ä¸€ä¸ª effect ä¹‹å‰ï¼Œä¸Šä¸€ä¸ª effect å°±å·²è¢«æ¸…é™¤ useEffect(() => { let didRequest = false; å¼‚æ­¥è¯·æ±‚.then((data) => { if (!didRequest) { setState(xx); //.. } }); return () => didRequest = true; }) 9.æ‡’åŠ è½½æˆ‘ä»¬å¯ä»¥åœ¨create-react-appã€ next.jsã€webpackä¸­ä½¿ç”¨æ‡’åŠ è½½ï¼Œå…ˆè®¾ç½®åˆå§‹å€¼ï¼Œç­‰åˆ°ç”¨åˆ°çš„æ—¶å€™å†å¼‚æ­¥åŠ è½½ åœ¨reactä½¿ç”¨æ‡’åŠ è½½çš„ä¸€ä¸ªå°ä¾‹å­ const changeTime = async () => { const moment = await import(\"moment\"); setNowTime(moment.default(Date.now()).format()); }; 10.ä¸€äº›å…¶ä»–çš„ä¼˜åŒ– å¯¹äºåŠ¨ç”»æ•ˆæœçš„å®ç°ï¼Œé¿å…ä½¿ç”¨ setTimeout æˆ– setIntervalï¼Œè¯·ä½¿ç”¨ requestAnimationFrameã€‚ å°†é•¿æ—¶é—´è¿è¡Œçš„ JavaScript ä»ä¸»çº¿ç¨‹ç§»åˆ° Web Workerã€‚ ä½¿ç”¨å¾®ä»»åŠ¡æ¥æ‰§è¡Œå¯¹å¤šä¸ªå¸§çš„ DOM æ›´æ”¹ã€‚ ä½¿ç”¨ Chrome DevTools çš„ Timeline å’Œ JavaScript åˆ†æå™¨æ¥è¯„ä¼° JavaScript çš„å½±å“ã€‚","categories":[{"name":"å‰ç«¯","slug":"å‰ç«¯","permalink":"https://taylor12138.github.io/categories/%E5%89%8D%E7%AB%AF/"}],"tags":[],"author":"Hello"},{"title":"lessæ ·å¼","slug":"lessæ ·å¼","date":"2020-10-01T16:00:00.000Z","updated":"2022-07-02T07:52:16.187Z","comments":true,"path":"2020/10/02/less-yang-shi/","link":"","permalink":"https://taylor12138.github.io/2020/10/02/less-yang-shi/","excerpt":"","text":"lessåŸºç¡€CSSçš„å†—ä½™åº¦æ¯”è¾ƒé«˜ï¼Œéœ€è¦ä¹¦å†™å¤§é‡çœ‹ä¼¼æ²¡æœ‰é€»è¾‘çš„ä»£ç ï¼Œä¸æ–¹ä¾¿ç»´æŠ¤ï¼Œä¸”æ— è®¡ç®—èƒ½åŠ› è€ŒLessæ˜¯CSSçš„æ‹“å±•è¯­è¨€ï¼Œä¹Ÿæˆä¸ºCSSé¢„å¤„ç†å™¨ï¼ˆå¸¸è§çš„CSSé¢„å¤„ç†å™¨ï¼šLessã€Sassã€Stylusï¼‰ï¼Œå¯ä»¥è®¡ç®—ï¼ˆè¿ç®—ç¬¦çš„å·¦å³ä¸¤ä¾§å¿…é¡»åŠ ä¸€ä¸ªç©ºæ ¼ï¼Œ ä¸¤ä¸ªæ•°å‚ä¸è¿ç®—ï¼Œå¦‚æœåªæœ‰ä¸€ä¸ªæ•°æœ‰å•ä½ï¼Œæœ€åç»“æœä»¥è¿™ä¸ªå•ä½ä¸ºå‡† ä¸¤ä¸ªæ•°å‚ä¸è¿ç®—ï¼Œå¦‚æœä¸¤ä¸ªæ•°éƒ½æœ‰å•ä½ï¼Œä»¥å‰é¢é‚£ä¸ªæ•°å­—å•ä½ä¸ºå‡†ï¼‰ Lessçš„æ–‡ä»¶åç¼€åï¼š.less ï¼ˆ1ï¼‰lesså˜é‡@color: pink; /*@å˜é‡å:å€¼;*/ @font: 14px; ä½¿ç”¨ï¼š background-color: @color ; ï¼ˆ2ï¼‰lessçš„ç¼–è¯‘éœ€è¦æŠŠlessç¼–è¯‘æˆCSSæ‰èƒ½æ”¾å…¥H5ä½¿ç”¨ åœ¨VScodeä¸­å®‰è£…easy-lessæ’ä»¶ï¼Œlessæ–‡ä»¶ä¿å­˜åä¸€é”®ç”ŸæˆCSSæ–‡ä»¶ ï¼ˆ3ï¼‰lessé•¶å¥—åœ¨lessä¸éœ€è¦å† .header a {} å»é€‰æ‹©åä»£é€‰æ‹©å™¨(å†è§) å¯ä»¥ç›´æ¥ï¼š .header { width: 100px; a { color: red; } } ä¼ªç±»é€‰æ‹©å™¨ï¼š .nav { &amp;:hover { color: blue; } &amp;::before { content: \"\"; } } åœ¨ä¸€ä¸ªlessä¸­å¯ä»¥å¼•å…¥å¦å¤–ä¸€ä¸ªlessï¼ˆå¥—å¨ƒï¼‰ @import \"common\"; /*å¯¼å…¥conmon.less*/ Lesså‡½æ•°each ç±»ä¼¼äºå¾ªç¯å‡½æ•° å…ˆå®šä¹‰ä¸€ä¸ªæ•°ç»„å˜é‡ @selectors: blue, green, red; é€šè¿‡each(æ•°ç»„å, { .sel-@{value} {} });çš„æ–¹å¼è·å–æ•°ç»„ä¸­æ¯ä¸€ä¸ªå€¼ï¼ˆ @{value} ï¼‰ each(@selectors, { .sel-@{value} { a: b; } }); Outputs: .sel-blue { a: b; } .sel-green { a: b; } .sel-red { a: b; } å½“ç„¶ä¹Ÿå¯ä»¥é€šè¿‡å®šä¹‰å¯¹è±¡å˜é‡ï¼Œé€šè¿‡eachå‡½æ•°åˆ†åˆ«å¾—åˆ°æ¯ä¸ªå¯¹è±¡çš„keyã€indexã€value @set: { one: blue; two: green; three: red; } .set { each(@set, { @{key}-@{index}: @value; }); } This will output: .set { one-1: blue; two-2: green; three-3: red; } range ä¼ å…¥ä¸€ä¸ªæ•°å­—ï¼Œåˆ›å»ºä¸€ä¸ªé¡ºåºæ•°ç»„åˆ—è¡¨ Examples: value: range(4); Outputs: value: 1 2 3 4; æ­é…eachæ¥ä½¿ç”¨ï¼š each(range(4), { .col-@{value} { height: (@value * 50px); } }); Outputs: .col-1 { height: 50px; } .col-2 { height: 100px; } .col-3 { height: 150px; } .col-4 { height: 200px; } lesså’ŒsassSassä¸Scssæ˜¯ä»€ä¹ˆå…³ç³»? Sassçš„ç¼©æ’è¯­æ³•ï¼Œå¯¹äºå†™æƒ¯csså‰ç«¯çš„webå¼€å‘è€…æ¥è¯´å¾ˆä¸ç›´è§‚ï¼Œä¹Ÿä¸èƒ½å°†cssä»£ç åŠ å…¥åˆ°Sassé‡Œé¢ï¼Œå› æ­¤sassè¯­æ³•è¿›è¡Œäº†æ”¹è‰¯ï¼ŒSass 3å°±å˜æˆäº†Scss(sassy css)ã€‚ä¸åŸæ¥çš„è¯­æ³•å…¼å®¹ï¼Œåªæ˜¯ç”¨{}å–ä»£äº†åŸæ¥çš„sç¼©è¿›ã€‚ ï¼ˆSASSç‰ˆæœ¬3.0ä¹‹å‰çš„åç¼€åä¸º.sassï¼Œè€Œç‰ˆæœ¬3.0ä¹‹åçš„åç¼€å.scssã€‚ï¼‰ lesså’Œsassçš„åŒºåˆ« Lesså’ŒSassçš„ä¸»è¦ä¸åŒå°±æ˜¯ä»–ä»¬çš„å®ç°æ–¹å¼ã€‚ Lessæ˜¯åŸºäºJavaScriptï¼Œæ˜¯åœ¨å®¢æˆ·ç«¯å¤„ç†çš„ã€‚ Sassæ˜¯åŸºäºRubyçš„ï¼Œæ˜¯åœ¨æœåŠ¡å™¨ç«¯å¤„ç†çš„ã€‚ å…³äºå˜é‡åœ¨Lesså’ŒSassä¸­çš„å”¯ä¸€åŒºåˆ«å°±æ˜¯Lessç”¨@ï¼ŒSassç”¨$ã€‚","categories":[{"name":"å‰ç«¯","slug":"å‰ç«¯","permalink":"https://taylor12138.github.io/categories/%E5%89%8D%E7%AB%AF/"}],"tags":[],"author":"Hello"},{"title":"ç§»åŠ¨&Webå¼€å‘çš„å¸¸è§å¸ƒå±€(CSS)","slug":"ç§»åŠ¨&Webå¼€å‘çš„å¸¸è§å¸ƒå±€(CSS)","date":"2020-10-01T16:00:00.000Z","updated":"2022-11-08T10:28:25.067Z","comments":true,"path":"2020/10/02/yi-dong-web-kai-fa-de-chang-jian-bu-ju-css/","link":"","permalink":"https://taylor12138.github.io/2020/10/02/yi-dong-web-kai-fa-de-chang-jian-bu-ju-css/","excerpt":"","text":"1.è§†å£è§†å£åˆ†ç±»è§†å£å¯ä»¥åˆ†ä¸ºå¸ƒå±€è§†å£ï¼Œè§†è§‰è§†å£å’Œç†æƒ³è§†å£ å¸ƒå±€è§†å£ï¼šä¸€èˆ¬ç§»åŠ¨è®¾å¤‡æµè§ˆå™¨éƒ½é»˜è®¤è®¾ç½®ä¸€ä¸ªå¸ƒå±€è§†å£ï¼ˆ980pxï¼‰ï¼Œç”¨äºæ—©æœŸPCç«¯é¡µé¢åœ¨æ‰‹æœºä¸Šæ˜¾ç¤ºçš„é—®é¢˜ ç¼ºç‚¹ï¼šä½¿å¾—å…ƒç´ çœ‹ä¸Šå»å¾ˆå°ï¼Œå­—ä½“å° è§†è§‰è§†å£ï¼šç”¨æˆ·æ­£åœ¨çœ‹çš„ç½‘ç«™åŒºåŸŸï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ç¼©æ”¾æ“ä½œè§†è§‰è§†å£ï¼Œä½†æ˜¯ä¸å½±å“å¸ƒå±€è§†å£ ç†æƒ³è§†å£ï¼šè®¾å®šæœ€ç†æƒ³çš„æµè§ˆå’Œé˜…è¯»å®½åº¦ï¼Œä¸è¦æ‰‹åŠ¨æ·»åŠ metaè§†å£æ ‡ç­¾é€šçŸ¥æµè§ˆå™¨ï¼ˆä¹”å¸ƒæ–¯å‘æ˜ï¼‰ &lt;meta name=\"viewport\" content=\"width-device-width, user-scalable=no,initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0\"> content=â€width-device-widthâ€ é€‚åº”çª—å£å¤§å° user-scalable=no ä¸å…è®¸ç”¨æˆ·ç¼©æ”¾ maximum-scale=1.0 åˆå§‹çš„æœ€å°ç¼©æ”¾æ¯” minimum-scale=1.0 åˆå§‹çš„æœ€å¤§ç¼©æ”¾æ¯” 2.å¤šå€å›¾æ¯”å¦‚è¯´2å€å›¾ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨2xå›¾æ¥æè¿°ï¼Œå¤šå€å›¾æ˜¯ä¸ºäº†åœ¨ç§»åŠ¨ç«¯ä¸Šæ˜¾ç¤ºæ›´åŠ é«˜æ¸… åœ¨pcç«¯ï¼Œ1px=ä¸€ä¸ªç‰©ç†åƒç´ ï¼Œä½†æ˜¯ç§»åŠ¨ç«¯ä¸å°½ç›¸åŒ ç§»åŠ¨ç«¯æœ‰ç‰©ç†åƒç´ æ¯”ï¼Œå¯ä»pxè½¬åŒ–ç§»åŠ¨ç«¯æ—¶ï¼Œï¼ˆå¼€å‘å°ºå¯¸ï¼‰px Ã— ç‰©ç†åƒç´ æ¯” = ç§»åŠ¨ç«¯æ˜¾ç¤ºçš„åƒç´ ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ Window.devicePixelRatio //è¿”å›å½“å‰æ˜¾ç¤ºè®¾å¤‡çš„*ç‰©ç†åƒç´ *åˆ†è¾¨ç‡ä¸*CSSåƒç´ *åˆ†è¾¨ç‡ä¹‹æ¯” æ¥æŸ¥çœ‹å½“å‰çš„åƒç´ æ¯” icon_alipay.pngâ†’iPhone 1-3ä»£çš„æ‰‹æœº(å·²ç»ä¸è€ƒè™‘äº†) icon_alipay@2x.pngâ†’iPhone4/4S/5/5S/6/6S/7å¯¹åº”å°ºå¯¸ï¼Œè¿™å°±æ˜¯æˆ‘ä»¬é€šå¸¸æ‰€è¯´çš„2å€å›¾ icon_alipay@3x.pngâ†’iPhone6P/6SP/7Pä½¿ç”¨çš„å°ºå¯¸ï¼Œè¿™å°±æ˜¯3å€å›¾ https://www.zhihu.com/question/26195746 èƒŒæ™¯ç¼©æ”¾background-sizeæ³¨æ„ï¼šbackground-sizeä¸€å®šè¦æ”¾åœ¨backgroundå±æ€§åè®¾ç½® background-sizeç”¨äºè§„å®šèƒŒæ™¯å°ºå¯¸ /*ç°æœ‰background: æ‰èƒ½è®¾ç½®*/ background-size: å›¾ç‰‡å®½åº¦,å›¾ç‰‡é«˜åº¦; /*å¯ä»¥pxï¼Œå¯ä»¥ç™¾åˆ†æ¯”ï¼ˆç›¸å¯¹äºçˆ¶ç›’å­ï¼‰*/ background-size: cover; /*å®Œå…¨ç›–ä½ç›’å­ï¼Œå¯èƒ½å›¾ç‰‡æ˜¾ç¤ºä¸å…¨*/ background-size: contain; /*å®½é«˜å®Œå…¨é€‚åº”çˆ¶ç›’å­ï¼Œçˆ¶ç›’å­å¯èƒ½æœ‰ç©ºç™½åŒºåŸŸ*/ åˆ‡å›¾æ—¶å¯ä»¥ç”¨psé‡Œçš„cuttermanå¤šå€åˆ‡å›¾ ç²¾çµå›¾ç¼©æ”¾1.ä½¿ç”¨å·¥å…·ï¼ˆå¦‚fireworkï¼‰æŠŠç²¾çµå›¾ç¼©æ”¾ä¸ºåŸæ¥çš„ä¸€åŠ 2.æ ¹æ®å¤§å°æµ‹é‡åæ ‡ 3.æ³¨æ„ä»£ç é‡Œé¢çš„background-sizeä¹Ÿè¦å†™ï¼šç²¾çµå›¾åŸæ¥çš„ä¸€åŠ ï¼ˆåŸå›¾è¿›è¡Œä¿®æ”¹æŸ¥çœ‹ï¼Œ ä½†æ˜¯ä¸è¦ä¿å­˜ï¼‰ ï¼ˆæˆ–è€…ç›´æ¥ä¸Šï¼Œç”¨chromeè°ƒè¯•å°±è¡Œäº†ï¼‰ background-size: å®½åº¦ï¼ˆåŸæ¥çš„å¤§å°/å€æ•°ï¼‰ é«˜åº¦auto 3.ç§»åŠ¨ç«¯å¼€å‘çš„é€‰æ‹©1.å•ç‹¬ç§»åŠ¨ç«¯é¡µé¢ï¼ˆä¸»æµï¼‰ï¼šäº¬ä¸œã€æ·˜å® pcå’Œæ‰‹æœºæ‰“å¼€åæ˜¾ç¤ºçš„ç½‘é¡µå¸ƒå±€ä¸åŒ 2.å“åº”å¼é¡µé¢å…¼å®¹ç§»åŠ¨ç«¯ï¼šä¸‰æ˜Ÿå®˜ç½‘ å“åº”å±å¹•å®½åº¦ï¼Œåˆ¶ä½œéº»çƒ¦ï¼Œéœ€è¦å¤§é‡è°ƒæ•´å…¼å®¹æ€§ CSSçš„åˆå§‹åŒ–æ¨èä½¿ç”¨ normalize.css CSS3ç›’å­æ¨¡å‹ä¼ ç»Ÿç›’å­è®¡ç®—æ–¹å¼ï¼šCSSè®¾ç½®çš„width+border+padding CSS3ç›’å­æ¨¡å‹ï¼šç›’å­å®½åº¦=CSSè®¾ç½®çš„å®½åº¦widthåŒ…å«äº†border+padding è®¾ç½®æ–¹å¼ï¼š(CSSé«˜çº§éƒ¨åˆ†è®²è¿‡ï¼Œä½†æ˜¯ä½¿ç”¨æ­¤æ–¹æ³•åæ–‡å­—ä½¿ç”¨line-heighå±…ä¸­ä¼šæœ‰æ‰€å½±å“,åŸå› æ˜¯æˆ‘ä»¬è¦å¯¹å…¶çš„æ˜¯ç›’å­å†…éƒ¨ä¸­é—´çš„ä½ç½®ï¼Œå³å»é™¤æ‰è¾¹æ¡†çš„é«˜åº¦çš„ä¸­é—´ä½ç½®ï¼Œä½†æ˜¯line-heighä¼šæŠŠæ‰€æœ‰æ–¹æ¡†æ‰€æœ‰é«˜åº¦ç®—è¿›å») box-sizing:border-box; ç§»åŠ¨ç«¯é“¾æ¥æ¸…é™¤é«˜äº®ç§»åŠ¨ç«¯ç‚¹å‡»å®Œé“¾æ¥ &lt;a&gt; ä¼šå‡ºç°é«˜äº® ï¼Œæ¸…é™¤é«˜äº®å¯ç”¨ -webkit-tap-highlight-color:transparent; ç§»åŠ¨ç«¯é“¾æ¥æ¸…é™¤å¤–è§‚æ•ˆæœåœ¨ç§»åŠ¨ç«¯æµè§ˆå™¨é»˜è®¤çš„å¤–è§‚ä¸Šåœ¨iosä¸ŠåŠ ä¸Šè¿™ä¸ªå±æ€§æ‰èƒ½ç»™æŒ‰é’®å’Œè¾“å…¥æ¡†è‡ªå®šä¹‰æ ·å¼ï¼ˆæ¸…é™¤åŸæ¥çš„æ ·å¼ï¼‰ -webkit-appearance: none; ç¦ç”¨é•¿å®‰é¡µé¢å¼¹å‡ºèœå•img, a {-webkit-touch-callout: none; } 4.ç§»åŠ¨ç«¯å¸¸è§å¸ƒå±€ä¸éœ€è¦åƒpcç«¯ä¸€æ ·æ’åˆ—ç‰ˆå¿ƒ å•ç‹¬ç§»åŠ¨ç«¯é¡µé¢ï¼ˆä¸»æµï¼‰ï¼šæµå¼å¸ƒå±€ï¼ˆç™¾åˆ†æ¯”å¸ƒå±€ï¼‰ï¼ˆäº¬ä¸œï¼‰ã€flexå¼¹æ€§å¸ƒå±€ï¼ˆæ–°é—»ç½‘ï¼Œå¼ºçƒˆæ¨èï¼‰ã€less+rem+åª’ä½“æŸ¥è¯¢å¸ƒå±€ï¼ˆè‹å®ï¼‰ã€æ··åˆå¸ƒå±€ æµå¼å¸ƒå±€ä¹Ÿå°±æ˜¯ç™¾åˆ†æ¯”å¸ƒå±€ï¼Œéå›ºå®šåƒç´ å¸ƒå±€ï¼Œå¯è‡ªç”±ä¼¸ç¼© ä¸ºäº†ä¿æŠ¤å±å¹•ä¸è¢«æ‹‰è¿‡å®½ï¼ˆç¼©è¿‡çª„ï¼‰ï¼Œå¯¼è‡´é‡Œé¢çš„å…ƒç´ æ˜¾ç¤ºå‡ºç°é—®é¢˜ï¼Œè®¾ç½®æœ€å¤§æœ€å°å®½åº¦ max-width: xxpx; min-width: xxpx; flexå¸ƒå±€ä¼ ç»Ÿå¸ƒå±€ï¼šå…¼å®¹æ€§å¥½ï¼Œå¸ƒå±€ç¹çï¼Œæœ‰ä¸€å®šå±€é™ flexå¸ƒå±€ï¼šæ“ä½œæ–¹ä¾¿ï¼Œpcç«¯æµè§ˆå™¨æ”¯æŒå·®ï¼ŒIE11æˆ–è€…æ›´ä½ç‰ˆæœ¬ä¸æ”¯æŒæˆ–ä»…éƒ¨åˆ†æ”¯æŒ flexå¯ä»¥è®©åŸæœ¬spanï¼ˆæ— æ³•è®¾ç½®å®½é«˜ï¼‰æˆåŠŸä½¿ç”¨å®½é«˜å±æ€§ï¼Œå³ä¸éœ€è¦æµ®åŠ¨ï¼Œæ›´ä¸ç”¨æ¸…é™¤æµ®åŠ¨ ï¼ˆ1ï¼‰flexåŸç†flexæ˜¯flexible boxçš„ç¼©å†™ï¼Œæ„ä¸ºå¼¹æ€§å¸ƒå±€ï¼Œä»»ä½•ä¸€ä¸ªå®¹å™¨éƒ½å¯ä»¥æŒ‡å®šä¸ºflexå¸ƒå±€ï¼ˆè°éƒ½å¯ä»¥ç”¨ï¼Œé™¤äº†IEï¼‰ çˆ¶ç›’å­è®¾ç½®ä¸ºflexåï¼Œå­å…ƒç´ çš„floatã€clearã€verticalå±æ€§éƒ½å¤±æ•ˆ é‡‡ç”¨flexå¸ƒå±€çš„å…ƒç´ ç§°ä¸ºflexå®¹å™¨ï¼Œä»–çš„æ‰€æœ‰å­å…ƒç´ è‡ªåŠ¨æˆä¸ºå®¹å™¨æˆå‘˜ï¼Œç§°ä¸ºflexé¡¹ç›®ï¼Œå³å®ƒæ˜¯é€šè¿‡ç»™çˆ¶ç›’å­æ·»åŠ flexå±æ€§ï¼Œæ¥æ§åˆ¶å­ç›’å­çš„ä½ç½®å’Œæ’åˆ— ï¼ˆ2ï¼‰flexå¸¸è§çˆ¶é¡¹å±æ€§é»˜è®¤ä¸»è½´æ–¹å‘æ˜¯xè½´ï¼Œæ°´å¹³å‘å³ ä¾§è½´æ–¹å‘æ˜¯yè½´ æ°´å¹³å‘ä¸‹ï¼Œæˆ‘ä»¬çš„å…ƒç´ æ˜¯è·Ÿç€ä¸»è½´æ’åˆ—åœ° flex-direction è®¾ç½®ä¸»è½´æ–¹å‘ï¼Œå‰©ä¸‹é‚£ä¸ªå°±è‡ªåŠ¨å˜æˆä¾§è½´ 1.é»˜è®¤å€¼rowä»å·¦åˆ°å³ 2.row-reverseä»å³åˆ°å·¦ 3.columnä»ä¸Šåˆ°ä¸‹ 4.column-reverseä»ä¸‹åˆ°ä¸Š justify-content è®¾ç½®ä¸»è½´ä¸Šå­å…ƒç´ çš„æ’åˆ—æ–¹å¼ 1.flex-starté»˜è®¤ 2.flex-endä»å°¾éƒ¨å¼€å§‹æ’åˆ— 3.centeråœ¨ä¸»è½´å±…ä¸­å¯¹é½ 4.space-aroundå¹³åˆ†å‰©ä½™ç©ºé—´ 5.space-betweenå…ˆä¸¤è¾¹è´´è¾¹ï¼Œå†å¹³åˆ†å‰©ä½™ç©ºé—´ flex-wrap è®¾ç½®å­å…ƒç´ æ˜¯å¦æ¢è¡Œ é»˜è®¤ä¸æ¢è¡Œï¼Œè£…ä¸å¼€ä¼šç¼©å°å­å…ƒç´ çš„å®½åº¦ï¼Œè‡ªåŠ¨é€‚åº” nowrapï¼šä¸æ¢è¡Œï¼Œé»˜è®¤ wrapï¼šæ¢è¡Œ wrap-reverseï¼šåç€æ¥æ¢è¡Œ align-content è®¾ç½®ä¾§è½´ä¸Šçš„å­å…ƒç´ çš„æ’åˆ—æ–¹å¼ï¼ˆå¤šè¡Œï¼‰ï¼ˆå³æœ‰æ¢è¡Œæƒ…å†µï¼‰ï¼ˆå•è¡Œæƒ…å†µä¸‹æ²¡ç”¨ï¼‰ 1.flex-start 2.flex-endä»å°¾éƒ¨å¼€å§‹æ’åˆ— 3.centeråœ¨ä¸»è½´å±…ä¸­å¯¹é½ 4.stretchæ‹‰ä¼¸ï¼Œé»˜è®¤ 5.space-aroundå¹³åˆ†å‰©ä½™ç©ºé—´ 6.space-betweenå…ˆä¸¤è¾¹è´´è¾¹ï¼Œå†å¹³åˆ†å‰©ä½™ç©ºé—´ align-items è®¾ç½®ä¾§è½´ä¸Šçš„å­å…ƒç´ çš„æ’åˆ—æ–¹å¼ï¼ˆå•è¡Œï¼‰ 1.flex-start 2.flex-endä»å°¾éƒ¨å¼€å§‹æ’åˆ— 3.centeråœ¨ä¸»è½´å±…ä¸­å¯¹é½ 4.stretchæ‹‰ä¼¸ï¼Œé»˜è®¤ï¼Œä½†æ˜¯å­ç›’å­ä¸è¦å¸¦é«˜åº¦ flex-flow å¤åˆå±æ€§ï¼Œç›¸å½“äºåŒæ—¶è®¾ç½®flex-directionå’Œflex-wrap flex-flow: column wrap; ï¼ˆ3ï¼‰flexå¸¸è§å­é¡¹å±æ€§flexå±æ€§ï¼Œå®šä¹‰å­é¡¹ç›®åˆ†é…å‰©ä½™ç©ºé—´ï¼Œç”¨flexè¡¨ç¤ºå æœ‰ä»½æ•° flex: number;/*é»˜è®¤ä¸º0*/ å¦‚æœæ˜¯flexï¼š1çš„è¯ï¼Œåˆ™å°†æ”¹è¡Œå‰©ä½™ç©ºé—´å…¨éƒ¨åˆ’åˆ†ç»™è¯¥å­å…ƒç´ ï¼Œä¸ç”¨è®¾ç½®å®½é«˜ï¼Œä¸”ç±»ä¼¼äºç™¾åˆ†æ¯”æµå¼å¸ƒå±€ï¼Œå¯ä»¥æ ¹æ®çª—å£å¤§å°è°ƒèŠ‚å‰©ä½™ç©ºé—´å¤§å° å¦‚æœè¯¥è¡Œæ²¡æœ‰è®¾ç½®ä»»ä½•å­å…ƒç´ åœ¨è¯¥è¡Œï¼ˆå‡è®¾å½“å‰ä¸»è½´ä¸ºxè½´ï¼‰ï¼Œç„¶åå°†ä¸‰ä¸ªå­å…ƒç´ è®¾ç½®flexï¼š1ï¼Œåˆ™æ¯ä¸ªç›’å­å 33.33%çš„å®½åº¦ï¼ˆå³è®¾ç½®è¯¥ç›’å­çš„ä¸»è½´é•¿åº¦ï¼‰ Aè®¾ç½®flex:2 ï¼Œ Bè®¾ç½®flex:1 åˆ™Aå æ¯”2/3ï¼ŒBå æ¯”1/3 (å…¶å®å¯ä»¥å†™ç™¾åˆ†æ¯” å³flex: 20%, ç›¸å¯¹çˆ¶çº§æ¥è¯´) align-selfï¼Œæ§åˆ¶å­é¡¹è‡ªå·±åœ¨ä¾§è½´ä¸Šçš„æ’åˆ—æ–¹å¼ã€‚ å®ƒå…è®¸å•ä¸ªé¡¹ç›®ä¸å…¶ä»–é¡¹ç›®ä¸ä¸€æ ·çš„å¯¹é½æ–¹å¼ï¼Œå¯ä»¥è¦†ç›–align-itemså±æ€§ï¼Œé»˜è®¤å€¼ä¸ºautoï¼Œè¡¨ç¤ºç»§æ‰¿align-itemsçš„å±æ€§ span:nth-child(3) { align-self: flex-end; /*åªè®©ç¬¬ä¸‰ä¸ªç›’å­åœ¨ä¾§è½´ä¸Šä»å°¾éƒ¨å¼€å§‹æ’åˆ—*/ } oderå®šä¹‰é¡¹ç›®çš„æ’åˆ—é¡ºåºï¼Œæ•°å€¼è¶Šå°ï¼Œæ’åè¶Šé å‰ï¼Œæ³¨æ„ï¼Œå’Œz-indexä¸ä¸€æ ·ï¼ˆå®šä½å±æ€§ï¼‰ span:nth-child(2) { order:-1; /*è®©2å·ç›’å­è·‘åˆ°1å·ç›’å­å‰é¢ï¼Œå› ä¸ºé»˜è®¤æ˜¯0ï¼Œ0&lt;1*/ } ï¼ˆ4ï¼‰flexçš„å‚æ•°flex: 1 ç›¸å½“äº flex-growï¼š1 flex-shrinkï¼š1 flex-basisï¼š0%ã€‚ ç¬¬ä¸€ä¸ªå‚æ•°è¡¨ç¤º: flex-grow å®šä¹‰é¡¹ç›®çš„æ”¾å¤§æ¯”ä¾‹ï¼Œé»˜è®¤ä¸º0ï¼Œå³å¦‚æœå­˜åœ¨å‰©ä½™ç©ºé—´ï¼Œä¹Ÿä¸æ”¾å¤§ ç¬¬äºŒä¸ªå‚æ•°è¡¨ç¤º: flex-shrink å®šä¹‰äº†é¡¹ç›®çš„ç¼©å°æ¯”ä¾‹ï¼Œé»˜è®¤ä¸º1ï¼Œå³å¦‚æœç©ºé—´ä¸è¶³ï¼Œè¯¥é¡¹ç›®å°†ç¼©å° ç¬¬ä¸‰ä¸ªå‚æ•°è¡¨ç¤º: flex-basisç»™ä¸Šé¢ä¸¤ä¸ªå±æ€§åˆ†é…å¤šä½™ç©ºé—´ä¹‹å‰, è®¡ç®—é¡¹ç›®æ˜¯å¦æœ‰å¤šä½™ç©ºé—´, é»˜è®¤å€¼ä¸º auto, å³é¡¹ç›®æœ¬èº«çš„å¤§å°** å•å€¼è¯­æ³• ç­‰åŒäº å¤‡æ³¨ flex: initial flex: 0 1 auto åˆå§‹å€¼ï¼Œå¸¸ç”¨ flex: 0 flex: 0 1 0% é€‚ç”¨åœºæ™¯å°‘ flex: none flex: 0 0 auto æ¨è flex: 1 flex: 1 1 0% æ¨è flex: auto flex: 1 1 auto é€‚ç”¨åœºæ™¯å°‘ Remé€‚é…å¸ƒå±€ï¼ˆ1ï¼‰remåŸºç¡€remæ˜¯ä¸€ä¸ªå•ä½ï¼ˆroot emï¼‰ï¼Œæ˜¯ä¸€ä¸ªç›¸å¯¹å•ä½ï¼Œç±»ä¼¼äºemï¼Œemæ˜¯çˆ¶å…ƒç´ çš„å­—ä½“å¤§å°ï¼Œå¦‚çˆ¶å…ƒç´ çš„font-sizeä¸º12pxï¼Œå­å…ƒç´ è®¾ç½®å®½é«˜ä¸º10emï¼Œåˆ™å¤§å°å®é™…ä¸º10*12=120pxï¼›è€Œä¸åŒçš„åœ°æ–¹åœ¨äºremæ˜¯ç›¸å¯¹äºhtmlå…ƒç´ çš„å­—ä½“å¤§å°ï¼Œremçš„ä¼˜ç‚¹æ˜¯å¯ä»¥é€šè¿‡ä¿®æ”¹htmlçš„æ–‡å­—å¤§å°æ¥æ”¹å˜é¡µé¢ä¸­çš„å…ƒç´ å¤§å° ï¼ˆ2ï¼‰åª’ä½“æŸ¥è¯¢åª’ä½“æŸ¥è¯¢æ˜¯CSS3çš„æ–°è¯­æ³•ï¼Œä½¿ç”¨@mediaå¯ä»¥é’ˆå¯¹ä¸åŒå±å¹•å°ºå¯¸è®¾ç½®ä¸åŒçš„å±å¹•æ ·å¼ /*ç”¨@mediaå¼€å¤´ï¼Œmediatypeæ˜¯åª’ä½“ç±»å‹ï¼Œå…³é”®å­—andã€notã€onlyï¼Œmedia featureæ˜¯åª’ä½“ç‰¹æ€§ï¼Œè¦ç”¨å°æ‹¬å·åŒ…å«*/ @media mediatype and|not|only (media feature) { CSS-Code; } mediatypeæŸ¥è¯¢ç±»å‹ï¼š all ç”¨äºæ‰€æœ‰è®¾å¤‡ print ç”¨äºæ‰“å°æœºå’Œæ‰“å°é¢„è§ˆ screenç”¨äºç”µè„‘å±å¹•ï¼Œæ™ºèƒ½æ‰‹æœº åª’ä½“ç‰¹æ€§ï¼šæš‚ä¸”å…ˆäº†è§£ä¸‰ä¸ª 1.width å®šä¹‰è¾“å‡ºè®¾å¤‡é¡µé¢å¯è§åŒºåŸŸçš„å®½åº¦ 2.min-width å®šä¹‰è¾“å‡ºè®¾å¤‡é¡µé¢æœ€å°å¯è§åŒºåŸŸå®½åº¦ 3.max-width å®šä¹‰è¾“å‡ºè®¾å¤‡é¡µé¢æœ€å¤§å¯è§åŒºåŸŸå®½åº¦ @media screen and (max-width: 800px) and (min-width: 540px) { /*åœ¨å±å¹•ä¸Šä¸”æœ€å¤§å®½åº¦ä¸º800pxä¸”æœ€å°å®½åº¦ä¸º540pxåˆ™è®¾ç½®è¯¥æ ·å¼*/ body { background-color: pink; } } å½“æ ·å¼æ”¹å˜æ¯”è¾ƒå¤šçš„æ—¶å€™ï¼ˆå¦‚ä¸‰æ˜Ÿå®˜ç½‘é¦–é¡µæ ¹æ®é¡µé¢ä¸åŒå¤§å°çš„å˜åŒ–æ ·å¼çš„æ”¹å˜ï¼‰ï¼Œå¯ä»¥é’ˆå¯¹ä¸åŒçš„åª’ä½“ä½¿ç”¨ä¸åŒçš„stylesheetsï¼ˆæ ·å¼è¡¨ï¼‰åŸç†ï¼Œç›´æ¥åœ¨linkä¸­åˆ¤æ–­è®¾å¤‡çš„å°ºå¯¸ï¼Œå¼•ç”¨ä¸åŒçš„CSSæ–‡ä»¶ &lt;link rel=\"stylesheet\" href=\"style320.css\" media=\"screen and (min-width: 320px)\"> åª’ä½“æŸ¥è¯¢æœ€å¥½çš„æ–¹æ³•æ˜¯ä»å°åˆ°å¤§ ç„¶åè¡¥å……çš„ä¸€ä¸ªç‚¹å°±æ˜¯åœ¨@mediaï¼šåª’ä½“æŸ¥è¯¢ç¬¬ 4 çº§ï¼ˆç¬¬å››ç‰ˆï¼‰ï¼ˆç¬¬äº”çº§ä»ç„¶åœ¨èµ·è‰ï¼‰ä¹‹åï¼Œæ”¯æŒè¿™æ ·çš„åª’ä½“æŸ¥è¯¢å†™æ³•ï¼š /* New Way */ @media (width &lt;= 768px) { â€¦ } @media (width >= 375px) { â€¦ } @media (375px &lt;= width &lt;= 768px) { ... } remçš„å®é™…é€‚é…1.æŒ‰ç…§è®¾è®¡ç¨¿ä¸è®¾å¤‡å®½åº¦æ¯”ä¾‹ï¼ŒåŠ¨æ€è®¡ç®—å¹¶è®¾ç½®htmlæ ¹æ ‡ç­¾font-sizeå¤§å°ï¼ˆå±å¹•å®½åº¦/åˆ’åˆ†çš„ä»½æ•°=font-sizeçš„å¤§å°ï¼‰ï¼ˆåˆ’åˆ†ä»½æ•°æœ‰15ã€20ã€10éƒ½æœ‰å¯èƒ½ï¼Œè‹å®ç§»åŠ¨ç«¯ç½‘é¡µæ˜¯15ï¼‰ 2.CSSä¸­ï¼Œè®¾è®¡ç¨¿å…ƒç´ å®½ã€é«˜ã€ç›¸å¯¹ä½ç½®ç­‰å–å€¼ï¼ŒæŒ‰ç…§åŒç­‰æ¯”ä¾‹æ¢ç®—ä¸ºrem remé€‚é…æ–¹æ¡ˆä¸€ï¼šless åª’ä½“æŸ¥è¯¢ rem é€‚é…æ–¹æ¡ˆäºŒï¼šflexible.js rem (æ¨è) flexible.js -&gt; remå†ä¹Ÿä¸ç”¨å¤ªè¿‡ç¹ççš„å†™ä¸‹å¤šä¸ªåª’ä½“æŸ¥è¯¢ï¼Œä½¿ç”¨jsåšäº†å¤„ç† å®ƒçš„åŸç†æ˜¯æŠŠå½“å‰è®¾å¤‡è‡ªåŠ¨åˆ’åˆ†ä¸º10ç­‰ä»½ ä¼šæ ¹æ®å±å¹•è‡ªåŠ¨ä¿®æ”¹æ–‡å­—å¤§å° githubä¸‹è½½åœ°å€ï¼šhttps://github.com/amfe/lib-flexible ä½†æ˜¯éœ€è¦åŠ ä¸€ä¸ªé™å®šå¼¥è¡¥ä¸è¶³ï¼š /* å¦‚æœå±å¹•è¶…è¿‡äº†750px, é‚£ä¹ˆæˆ‘ä»¬æŒ‰ç…§750çš„è®¾è®¡ç¨¿èµ°ï¼Œä¸è®©æˆ‘ä»¬çš„é¡µé¢è¶…è¿‡750px*/ @media screen and (min-width: 750px) { html { font-size: 75px!important; /*ææƒé‡*/ } } VScode -&gt; remé€‚é…æ–¹æ¡ˆï¼ˆaddï¼‰ï¼šVscode pxè½¬æ¢remæ’ä»¶cssrem ï¼ˆå ªç§°å¤–æŒ‚ï¼‰ï¼ŒåŠå…¶å¥½ç”¨ å¯ä»¥ä½¿å¾—pxç›´æ¥è½¬æ¢rem è¯¥æ’ä»¶é»˜è®¤çš„htmlå­—ä½“å¤§å°ä¸º16pxï¼ˆæ ¹æ®å½“å‰é¡µé¢å¤§å°ï¼ˆæ­£å¸¸å¤§å°çŠ¶æ€ï¼‰/åˆ’åˆ†ä»½æ•°=å¾—åˆ°æˆ‘ä»¬åº”è¯¥è®¾ç½®çš„å­—ä½“å¤§å°ï¼‰,éœ€è¦åœ¨è®¾ç½®é‡Œæ›´æ”¹setting.jsoné‡Œçš„&quot;cssrem.rootFontSize&quot;: 16æ‰å¯ä»¥ Gridå¸ƒå±€ä¹Ÿè¢«ç§°ä¸ºç½‘æ ¼å¸ƒå±€ã€‚æ“…é•¿äºå°†ä¸€ä¸ªé¡µé¢åˆ’åˆ†ä¸ºå‡ ä¸ªä¸»è¦åŒºåŸŸï¼Œä»¥åŠå®šä¹‰è¿™äº›åŒºåŸŸçš„å¤§å°ã€ä½ç½®ã€å±‚æ¬¡ç­‰å…³ç³»ï¼ˆå‰ææ˜¯HTMLç”Ÿæˆäº†è¿™äº›åŒºåŸŸï¼‰ã€‚ç±»ä¼¼äºä»¥ä¸‹çš„æ•ˆæœ æŒ‡å®šçˆ¶å…ƒç´ æ¨ªç«–ç½‘æ ¼çš„å¤§å°ï¼ˆä»è€Œè§„å®šå­å…ƒç´ çš„å¤§å°ï¼‰ #container{ display: grid; grid-template-columns: 50px 50px 50px; /*33.33% 33.33% 33.33%; ä¹Ÿå¯ä»¥*/ grid-template-rows: 50px 50px 50px; } ä¸ºäº†æ–¹ä¾¿è¡¨ç¤ºæ¯”ä¾‹å…³ç³»ï¼Œç½‘æ ¼å¸ƒå±€æä¾›äº†frå…³é”®å­—ï¼ˆä¸€ä¸‹è¡¨ç¤ºå®½åº¦æ¯” 1 ï¼š 2ï¼‰ .container { display: grid; grid-template-columns: 1fr 2fr; } justify-itemså±æ€§è®¾ç½®å•å…ƒæ ¼å†…å®¹çš„æ°´å¹³ä½ç½®ï¼ˆå·¦ä¸­å³ï¼‰ï¼Œalign-itemså±æ€§è®¾ç½®å•å…ƒæ ¼å†…å®¹çš„å‚ç›´ä½ç½®ï¼ˆä¸Šä¸­ä¸‹ï¼‰ã€‚ justify-contentå±æ€§æ˜¯æ•´ä¸ªå†…å®¹åŒºåŸŸåœ¨å®¹å™¨é‡Œé¢çš„æ°´å¹³ä½ç½®ï¼ˆå·¦ä¸­å³ï¼‰ï¼Œalign-contentå±æ€§æ˜¯æ•´ä¸ªå†…å®¹åŒºåŸŸçš„å‚ç›´ä½ç½®ï¼ˆä¸Šä¸­ä¸‹ï¼‰ã€‚ justify-selfå±æ€§è®¾ç½®å•å…ƒæ ¼å†…å®¹çš„æ°´å¹³ä½ç½®ï¼ˆå·¦ä¸­å³ï¼‰ï¼Œè·Ÿjustify-itemså±æ€§çš„ç”¨æ³•å®Œå…¨ä¸€è‡´ï¼Œä½†åªä½œç”¨äºå•ä¸ªé¡¹ç›®ã€‚ align-selfå±æ€§è®¾ç½®å•å…ƒæ ¼å†…å®¹çš„å‚ç›´ä½ç½®ï¼ˆä¸Šä¸­ä¸‹ï¼‰ï¼Œè·Ÿalign-itemså±æ€§çš„ç”¨æ³•å®Œå…¨ä¸€è‡´ï¼Œä¹Ÿæ˜¯åªä½œç”¨äºå•ä¸ªé¡¹ç›®ã€‚ å¯ä»¥çœ‹æˆå’Œflexç±»ä¼¼çš„éƒ¨åˆ† .container { justify-items: start | end | center | stretch; align-items: start | end | center | stretch; justify-content: start | end | center | stretch | space-around | space-between | space-evenly; align-content: start | end | center | stretch | space-around | space-between | space-evenly; } è¯¦æƒ…å¯ä»¥å‚è€ƒé˜®ä¸€å³°è€å¸ˆçš„æ•™ç¨‹https://www.ruanyifeng.com/blog/2019/03/grid-layout-tutorial.html å“åº”å¼å¸ƒå±€å…¶åŸç†å°±æ˜¯æ ¹æ®åª’ä½“æŸ¥è¯¢å¯¹ä¸åŒå®½åº¦è®¾å¤‡è¿›è¡Œå¸ƒå±€å’Œæ ·å¼è®¾ç½®ï¼Œä»è€Œé€‚é…ä¸åŒè®¾å¤‡çš„ç›®çš„ å°å±å¹•ï¼ˆæ‰‹æœºï¼‰&lt;768px å°å±è®¾å¤‡ï¼ˆå¹³æ¿ï¼‰ &gt;=768px~&lt;992px ä¸­ç­‰å±å¹•ï¼ˆæ¡Œé¢æ˜¾ç¤ºå™¨ï¼‰&gt;=992px~&lt;1200px å®½å±è®¾å¤‡ï¼ˆå¤§æ¡Œé¢æ˜¾ç¤ºå™¨ï¼‰&gt;=1200px @media screen and (max-width: 767px) { .container { width: 100%; } } @media screen and (min-width: 768px) { .container { width: 750px; } } @media screen and (min-width: 992x) { .container { width: 970px; } } @media screen and (min-width: 1200px) { .container { width: 1170px; } } (1)Bootstrapå‰ç«¯å¼€å‘æ¡†æ¶æ¥è‡ªäºtwitterï¼Œç›®å‰æœ€å—æ¬¢è¿çš„å‰ç«¯æ¡†æ¶(æ‹¿æ¥ä¸»ä¹‰) ä¸­æ–‡å®˜ç½‘ï¼šhttps://www.bootcss.com/ å®˜ç½‘ï¼šhttps://getbootstrap.com/ 2.x.x å·²ç»åœæ­¢ç»´æŠ¤ï¼ŒåŠŸèƒ½ä¸å¤Ÿå®Œå–„ 3.x.x ç›®å‰ä½¿ç”¨æœ€å¤šï¼Œä½†å·²ç»æ”¾å¼ƒäº†ie6ï¼Œie7ï¼Œå¯¹ie8æ”¯æŒä½†æ˜¯ç•Œé¢æ•ˆæœä¸å¥½ï¼Œåå‘äºå¼€å‘å“åº”å¼å¸ƒå±€ï¼Œç§»åŠ¨è®¾å¤‡ä¼˜å…ˆçš„webé¡¹ç›® 4.x.x æœ€æ–°ç‰ˆï¼Œä½†æ˜¯ç›®å‰ä¸æµè¡Œ æ ·å¼åº“çš„ä½¿ç”¨ï¼š1.åˆ›å»ºæ–‡ä»¶å¤¹ç»“æ„ï¼ˆå¤åˆ¶bootstrapçš„æ–‡ä»¶å¤¹ï¼‰-&gt; 2.åˆ›å»ºhtmléª¨æ¶ç»“æ„ï¼ˆåœ¨bootstrapä¸­æ–‡æ–‡æ¡£å®˜ç½‘ä¸­æ‰¾åˆ°bootstrapå…¥é—¨-åŸºç¡€æ¨¡æ¿ï¼‰-&gt; 3. å¼•å…¥ç›¸å…³æ ·å¼æ–‡ä»¶ -&gt; ä½¿ç”¨ (2)Bootstrapçš„å¸ƒå±€å®¹å™¨bootstrapéœ€è¦ä¸ºé¡µé¢å†…å®¹å’Œæ …æ ¼ç³»ç»ŸåŒ…è£¹ä¸€ä¸ª.containerå®¹å™¨ï¼ŒBootstrapé¢„å…ˆå®šä¹‰å¥½äº†è¿™ä¸ªç±» .containerå·²ç»å®šä¹‰å¥½äº†å“åº”å¼å¸ƒå±€ï¼Œå¦‚@media screen and (max-width: 767px)ä¹‹ç±»çš„ è€Œ.container-fluidç±»å®šä¹‰äº†æµå¼å¸ƒå±€ï¼ˆç™¾åˆ†æ¯”å¸ƒå±€ï¼‰ (3ï¼‰Bootstrapçš„æ …æ ¼ç³»ç»Ÿäº¦ç§°ä¸ºç½‘ç»œç³»ç»Ÿï¼Œå®ƒæŒ‡é¡µé¢å¸ƒå±€åˆ’åˆ†ä¸ºç­‰å®½çš„åˆ—ï¼Œé€šè¿‡æ ·å¼å®šä¹‰æ¥æ¨¡å—åŒ–é¡µé¢å¸ƒå±€ï¼ˆremæ˜¯æŠŠæ•´ä¸ªå±å¹•åˆ’åˆ†å¤šä¸ªç­‰ä»½ï¼Œè¿™ä¸ªæ˜¯é¡µé¢å†…å®¹ï¼‰ï¼Œbootstrapè‡ªåŠ¨æ‹“å±•åˆ°æœ€å¤š12ç­‰ä»½ bootstrapé‡Œé¢çš„CSSå·²ç»åŒ…å«äº†normalize.csså³å…³äºç½‘é¡µåˆå§‹åŒ–çš„å†…å®¹ï¼Œæ‰€ä»¥ä¸ç”¨å†å¼•å…¥normalize.cssè¿›è¡Œåˆå§‹åŒ– æ …æ ¼ç³»ç»Ÿç”¨äºé€šè¿‡ä¸€ç³»åˆ—çš„è¡Œrowå’Œåˆ—coloumçš„ç»„åˆæ¥åˆ›å»ºé¡µé¢å¸ƒå±€ ï¼ˆè¡Œç¼©å°åˆ°ä¸€å®šç¨‹åº¦ï¼Œæ¨¡å—è¿›å…¥ä¸‹ä¸€ä¸ªåˆ—ï¼‰,å®ç°åˆ—çš„å¹³å‡åˆ’åˆ†ï¼Œéœ€è¦ç»™åˆ—æ·»åŠ ç±»å‰ç¼€ï¼ˆæ·»åŠ ç±»åï¼‰ï¼Œåˆ†åˆ«å¯¹åº”ç€å“åº”å¼å¸ƒå±€ä¸Šé¢å®šä¹‰çš„å››ç§åª’ä½“æŸ¥è¯¢ä»£ç  è¶…å°å±å¹•åˆ—å‰ç¼€.col-xs-å°å±è®¾å¤‡åˆ—å‰ç¼€.col-sm-ä¸­ç­‰å±å¹•åˆ—å‰ç¼€.col-md-å®½å±å¹•åˆ—å‰ç¼€.col-lg-æœ‰12ä»½ï¼Œè®©å…¶å 4åˆ†ä¹‹ä¸€ï¼Œå³3ä»½,æ‰€æœ‰ç›’å­æ€»å’Œæ²¡è¾¾åˆ°12ï¼Œåˆ™å ä¸æ»¡ï¼Œè¶…è¿‡12ï¼Œåˆ™å¦èµ·ä¸€è¡Œï¼ˆåƒæµ®åŠ¨ï¼‰.col-lg-3 å¤§å±å¹•å 4åˆ†ä¹‹ä¸€ï¼Œå³3ä»½ï¼Œä¸­ç­‰å±å¹•å 3åˆ†ä¹‹ä¸€ï¼Œå³4ä»½ï¼Œå°å±å¹•å 2åˆ†ä¹‹ä¸€ï¼Œå³6ä»½ .col-lg-3 col-md-4 col-sm-6 æ¯ä¸€åˆ—çš„ç›’å­é‡Œæœ‰é»˜è®¤å·¦å³15pxçš„padding Bootstrapçš„åˆ—åµŒå¥—ï¼šçˆ¶ç›’å­ä¼šäº§ç”Ÿä¸€ä¸ªpaddingå€¼ï¼Œä½¿å¾—å­ç›’å­åˆ’åˆ†çš„æ—¶å€™æ²¡æœ‰æŒ‰ç…§çˆ¶ç›’å­çš„å®½é«˜åˆ’åˆ†ï¼Œè€Œæ˜¯æŒ‰ç…§çˆ¶ç›’å­çš„å®½é«˜-paddingå€¼åˆ’åˆ†ï¼Œæ‰€ä»¥åœ¨åµŒå¥—çš„æ—¶å€™æœ€å¥½åŠ å¤šä¸€ä¸ªç›’å­è¿›è¡ŒåŒ…è£…ï¼Œå¹¶ä¸”æ­¤æ—¶å­ç›’å­å’Œçˆ¶çº§ä¸€æ ·é«˜ï¼š &lt;div class=\"col-md-4\"> &lt;div> &lt;div class=\"col-md-6\">&lt;/div> &lt;div class=\"col-md-6\">&lt;/div> &lt;/div> &lt;/div> &lt;div class=\"col-md-4\">&lt;/div> &lt;div class=\"col-md-4\">&lt;/div> &lt;div class=&quot;col-mid-4 col-md-offset-4&quot;&gt;&lt;/div&gt;çš„offsetåŠŸèƒ½ï¼Œåœ¨ä¸­é—´å¢åŠ äº†4ä»½çš„ç©ºæ ¼ï¼ˆ1/3ï¼‰ï¼Œå®ç°æ¯ä¸ªç›’å­ä¸å¿…ç´§å¯†ç›¸è¿çš„æ¨¡å‹æ ¼å¼ï¼Œå…¶å®å¯ä»¥æŠŠoffsetå½“æˆç©ºç›’å­æ¥çœ‹å¾… &lt;div class=&quot;col-md-4 colmd-push-8&quot;&gt;å·¦ä¾§&lt;/div&gt; &lt;div class=&quot;col-md-4 colmd-pull-4&quot;&gt;å³ä¾§&lt;/div&gt;å¯ä»¥å®ç°å·¦å³ç›’å­é¢ å€’çš„çŠ¶æ€ï¼ˆåšç›’å­æ¨ï¼Œå³ç›’å­æ‹‰ï¼‰ (4ï¼‰å“åº”å¼å·¥å…·åˆ©ç”¨åª’ä½“æŸ¥è¯¢åŠŸèƒ½ï¼Œä½¿ç”¨å·¥å…·ç±»å¯ä»¥æ–¹ä¾¿é’ˆå¯¹ä¸åŒè®¾å¤‡å±•ç¤ºæˆ–è€…éšè—é¡µé¢å†…å®¹ï¼ˆç±»ä¼¼æ·˜å®é¦–é¡µæŸç±»å•†å“çš„éšè—ï¼‰ hidden-xs è¶…å°å±ï¼šéšè— å°å±ï¼šå¯è§ ä¸­å±ï¼šå¯è§ å¤§å±ï¼šå¯è§ hidden-sm è¶…å°å±ï¼šå¯è§ å°å±ï¼šéšè— ä¸­å±ï¼šå¯è§ å¤§å±ï¼šå¯è§ hidden-md è¶…å°å±ï¼šå¯è§ å°å±ï¼šå¯è§ ä¸­å±ï¼šéšè— å¤§å±ï¼šå¯è§ hidden-lg è¶…å°å±ï¼šå¯è§ å°å±ï¼šå¯è§ ä¸­å±ï¼šå¯è§ å¤§å±ï¼šéšè— &lt;div class=\"col-md-3 hidden-xs\">&lt;/div> ä¸ä¹‹ç›¸åçš„æ˜¯visible-xsï¼Œvisible-smç­‰ï¼Œå¯ä»¥å®ç°å¹¿ä¸œè´¢ç»å¤§å­¦é¦–é¡µçš„æœç´¢æ éšè—æ¨¡å—åŠŸèƒ½ bootstrapå®˜ç½‘é‡Œè¿˜æœ‰å­—ä½“å›¾æ ‡ä¾›ç»™ä½¿ç”¨ bootstrapå·²ç»å¸®ä½ å†™å¥½æ¸…é™¤æµ®åŠ¨ï¼Œåªéœ€æ·»åŠ ç±»åclearfix 5.çº¿æ€§æ¸å˜é¢œè‰²ï¼ˆé’ˆå¯¹äºç§»åŠ¨ç«¯ï¼‰pcç«¯éœ€è¦å¾ˆå¤šç§æœ‰å‰ç¼€ï¼Œç‰¹åˆ«éº»çƒ¦ï¼Œä½†æ˜¯ç§»åŠ¨ç«¯åªéœ€è¦æ·»åŠ webkitå°±å¯ä»¥äº† background: linear-gradient(èµ·å§‹æ–¹å‘,é¢œè‰²1,é¢œè‰²2); /*èµ·å§‹æ–¹å‘é»˜è®¤top*/ background: -webkit-linear-gradient(left,red,blue); /*ä¸€èˆ¬éƒ½è¦æ·»åŠ -webkit-ç§æœ‰å‰ç¼€*/ background: -webkit-linear-gradient(left top,red,blue); 6.CSSå˜é‡é™¤äº†lesså¯ä»¥å£°æ˜å˜é‡ï¼Œå…¶å®cssè‡ªèº«ä¹Ÿå¯ä»¥å£°æ˜å˜é‡ CSSå…¨å±€å˜é‡çš„å£°æ˜æ˜¯åœ¨å˜é‡åç§°å‰åŠ ä¸¤ä¸ªä¸­æ¨ªçº¿--ï¼Œé€šå¸¸ç”¨äºè®¾ç½®å…¨å±€çš„ä¸»é¢˜é¢œè‰²ï¼Œä¸»é¢˜èƒŒæ™¯é¢œè‰²ï¼Œå­—ä½“å¤§å°ç­‰ :root { /* csså®šä¹‰å˜é‡çš„æ–¹å¼ */ /* ä½¿ç”¨ï¼švar(å˜é‡å) */ --color-text: #666; --color-high-text: #ff5777; --color-tint: #fd5d7b; --color-background: #fff; --font-size: 20px; --line-height: 1.5; } /*ä½¿ç”¨*/ div { background-color: var(--color-tint); } 7.REMå®æˆ˜å¸ƒå±€å¯¹äºå±å¹•å®½åº¦å°äº600pxï¼Œæ ¹å­—ä½“å¤§å°è®¾ç½®ä¸º10vw å¤§äºç­‰äº600pxçš„æŒ‰ç…§ 600pxçš„å±å¹•å®½åº¦å»è®¡ç®—ï¼Œæ ¹å­—ä½“å¤§å°åŒæ ·ç»™åˆ°10vwï¼ˆé€‚é…pcç«¯ï¼‰ ç„¶åå¯¹æ”¹æ¨¡æ¿ä¸‹æ‰€æœ‰pxé‡‡å–remé€‚é…","categories":[{"name":"å‰ç«¯","slug":"å‰ç«¯","permalink":"https://taylor12138.github.io/categories/%E5%89%8D%E7%AB%AF/"}],"tags":[],"author":"Hello"},{"title":"matlabæœŸæœ«çŸ¥è¯†ç‚¹æ±‡æ€»","slug":"matlabæœŸæœ«çŸ¥è¯†ç‚¹æ±‡æ€»","date":"2020-08-05T16:00:00.000Z","updated":"2020-08-06T09:30:41.436Z","comments":true,"path":"2020/08/06/matlab-qi-mo-zhi-shi-dian-hui-zong/","link":"","permalink":"https://taylor12138.github.io/2020/08/06/matlab-qi-mo-zhi-shi-dian-hui-zong/","excerpt":"","text":"regresså‘½ä»¤ ç”¨äºä¸€å…ƒåŠå¤šå…ƒçº¿æ€§å›å½’ B = regress(Y,X)[B,BINT] = regress(Y,X)[B,BINT,R] = regress(Y,X)[B,BINT,R,RINT] = regress(Y,X)B,BINT,R,RINT,STATS] = regress(Y,X)[â€¦] = regress(Y,X,ALPHA) Bï¼šå›å½’ç³»æ•°ï¼Œç±»ä¼¼äºæ–œç‡ï¼Œæ˜¯ä¸ªå‘é‡ï¼ˆâ€œthe vector B of regression coefficients in the linear model Y = X*Bâ€ï¼‰ã€‚BINTï¼šå›å½’ç³»æ•°çš„åŒºé—´ä¼°è®¡ï¼ˆâ€œa matrix BINT of 95% confidence intervals for Bâ€ï¼‰ã€‚Rï¼šæ®‹å·®ï¼ˆ â€œa vector R of residualsâ€ï¼‰ã€‚RINTï¼šç½®ä¿¡åŒºé—´ï¼ˆâ€œa matrix RINT of intervals that can be used to diagnose outliersâ€ï¼‰ã€‚STATSï¼šç”¨äºæ£€éªŒå›å½’æ¨¡å‹çš„ç»Ÿè®¡é‡ã€‚æœ‰4ä¸ªæ•°å€¼ï¼šåˆ¤å®šç³»æ•°R^2ï¼Œæ¥è¿‘1ï¼Œå›å½’æ–¹ç¨‹è¶Šæ˜¾è‘—ï¼ŒFç»Ÿè®¡é‡è§‚æµ‹å€¼ï¼ŒFè¶Šå¤§ï¼Œå›å½’æ–¹ç¨‹è¶Šæ˜¾è‘—ï¼Œæ£€éªŒçš„pçš„å€¼ï¼Œè¯¯å·®æ–¹å·®çš„ä¼°è®¡ã€‚ALPHAï¼šæ˜¾è‘—æ€§æ°´å¹³ï¼ˆç¼ºå°‘æ—¶ä¸ºé»˜è®¤å€¼0.05ï¼‰ã€‚ %å¯¼å…¥æ•°æ® y=[7613.51 7850.91 8381.86 9142.81 10813.6 8631.43 8124.94 9429.79 10230.81 ... 10163.61 9737.56 8561.06 7781.82 7110.97]&#39;; x1=[7666 7704 8148 8571 8679 7704 6471 5870 5289 3815 3335 2927 2758 2591]&#39;; x2=[16.22 16.85 17.93 17.28 17.23 17 19 18.22 16.3 13.37 11.62 10.36 9.83 9.25]&#39;; X=[ones(size(y)) x1.^2 x2.^2 x1 x2 x1.*x2]; % sizeï¼ˆï¼‰ï¼šè·å–çŸ©é˜µçš„è¡Œæ•°å’Œåˆ—æ•° % s=size(A), å½“åªæœ‰ä¸€ä¸ªè¾“å‡ºå‚æ•°æ—¶ï¼Œè¿”å›ä¸€ä¸ªè¡Œå‘é‡ï¼Œè¯¥è¡Œå‘é‡çš„ç¬¬ä¸€ä¸ªå…ƒç´ æ—¶çŸ©é˜µçš„è¡Œæ•°ï¼Œç¬¬äºŒä¸ªå…ƒç´ æ˜¯çŸ©é˜µçš„åˆ—æ•°ã€‚ % ones(M,N)äº§ç”Ÿä¸€ä¸ªM*Nçš„çŸ©é˜µ %å¼€å§‹åˆ†æ [b,bint,r,rint,stats] = regress(y,X);åˆ›å»ºæ®‹å·®çš„ç½®ä¿¡åŒºé—´å›¾ç”¨regressè¿”å›çš„å€¼rï¼Œrintï¼šrcoplotï¼ˆrï¼Œrintï¼‰ çº¿æ€§å›å½’æ¨¡å‹ç±»çº¿æ€§å›å½’æ¨¡å‹ç±» wlb=LinearModel; %åˆ›å»ºçº¿æ€§å›å½’ç±»å¯¹è±¡ï¼Œå¯¹è±¡åwlb wlb=LinearModel.fit(x,y); %åˆ›å»ºçº¿æ€§å›å½’ç±»å¯¹è±¡ï¼Œå¹¶å¯¹è§‚æµ‹ æ•°æ®åšå¤šå…ƒçº¿æ€§å›å½’ wlb.plot %ç»˜åˆ¶wlbçš„æ•ˆæœå›¾ wlb.anova %ç»™å‡ºæ–¹å·®åˆ†æè¡¨ [y,ly]=wlb.predict(x) %ç»™å‡ºxé¢„æµ‹å’Œç½®ä¿¡åŒºé—´ wlb.plotResiduals %ç»˜åˆ¶æ®‹å·®å›¾ wlb. plotDiagnoisetics(method) %ç»˜åˆ¶ä¸åŒç»Ÿè®¡é‡çš„æ®‹å·®å›¾åˆ† æ properties(wlb) %æ˜¾ç¤ºæ‰€æœ‰ç»Ÿè®¡é‡å±æ€§tå€¼å’Œæ˜¾è‘—æ€§æ°´å¹³æœ‰ä»€ä¹ˆæ ·çš„å¯¹åº”å…³ç³»t-æ£€éªŒï¼šå¯ä»¥ç”¨äºæ¯”è¾ƒä¸¤ç»„æ•°æ®æ˜¯å¦æ¥è‡ªåŒä¸€åˆ†å¸ƒã€‚ï¼ˆå¯ä»¥ç”¨äºæ¯”è¾ƒä¸¤ç»„æ•°æ®çš„åŒºåˆ†åº¦ï¼‰ åœ¨ç»Ÿè®¡æ£€éªŒä¸­ï¼Œç»Ÿè®¡é‡tå€¼å’Œæ˜¾è‘—æ€§æ°´å¹³å…·æœ‰ä»€ä¹ˆæ ·çš„å¯¹åº”å…³ç³»ï¼Ÿä¸€èˆ¬æ¥è¯´ï¼Œå¤§æ ·æœ¬å’Œæ­£æ€åˆ†å¸ƒæƒ…å†µä¸‹çš„æ•°æ®ï¼Œå½“1.65&lt;|t|&lt;1.96æ—¶,p&lt;0.10;å½“1.96&lt;|t|&lt;2.58æ—¶ï¼Œp&lt;0.05ï¼›|t|å¤§äº2.58æ—¶ï¼Œp&lt;0.01ã€‚ ä½†æ˜¯è¦æ³¨æ„çš„æ˜¯ï¼Œå½“æ ·æœ¬é‡å¾ˆå°ï¼ˆå°äº30ï¼‰ï¼Œæ•°æ®åˆ†å¸ƒå½¢æ€ä¸æ˜æˆ–æ˜æ˜¾ä¸æœä»æ­£æ€åˆ†å¸ƒï¼ˆä¸€åº§å±±ä¸€æ ·çš„åˆ†å¸ƒï¼‰æ—¶ï¼Œtå€¼å’Œæ˜¾è‘—æ€§æ°´å¹³ä¸ä¸€å®šå®Œå…¨å¯¹åº”ï¼Œä¾‹å¦‚tå€¼ç»å¯¹å€¼å¤§äº2æ—¶ï¼Œpå€¼æœ‰å¯èƒ½å¤§äº0.05ï¼Œä¹Ÿå°±æ˜¯ä¸æ˜¾è‘—ã€‚è¿™ç§æƒ…å†µä¸€èˆ¬è¦é‡‡ç”¨éå‚æ•°æ£€éªŒçš„æ–¹æ³•ï¼Œè€Œä¸æ˜¯tæ£€éªŒã€‚ 1ã€tå€¼ï¼ŒæŒ‡çš„æ˜¯Tæ£€éªŒï¼Œä¸»è¦ç”¨äºæ ·æœ¬å«é‡è¾ƒå°ï¼ˆä¾‹å¦‚n&lt;30ï¼‰ï¼Œæ€»ä½“æ ‡å‡†å·®ÏƒæœªçŸ¥çš„æ­£æ€åˆ†å¸ƒèµ„æ–™ã€‚Tæ£€éªŒæ˜¯ç”¨tåˆ†å¸ƒç†è®ºæ¥æ¨è®ºå·®å¼‚å‘ç”Ÿçš„æ¦‚ç‡ï¼Œä»è€Œæ¯”è¾ƒä¸¤ä¸ªå¹³å‡æ•°çš„å·®å¼‚æ˜¯å¦æ˜¾è‘—ã€‚ 2ã€På€¼ï¼Œå°±æ˜¯å½“åŸå‡è®¾ä¸ºçœŸæ—¶ï¼Œæ‰€å¾—åˆ°çš„æ ·æœ¬è§‚å¯Ÿç»“æœæˆ–æ›´æç«¯ç»“æœå‡ºç°çš„æ¦‚ç‡ã€‚å¦‚æœPå€¼å¾ˆå°ï¼Œè¯´æ˜åŸå‡è®¾æƒ…å†µçš„å‘ç”Ÿçš„æ¦‚ç‡å¾ˆå°ï¼Œè€Œå¦‚æœå‡ºç°äº†ï¼Œæ ¹æ®å°æ¦‚ç‡åŸç†ï¼Œæˆ‘ä»¬å°±æœ‰ç†ç”±æ‹’ç»åŸå‡è®¾ï¼ŒPå€¼è¶Šå°ï¼Œæˆ‘ä»¬æ‹’ç»åŸå‡è®¾çš„ç†ç”±è¶Šå……åˆ†ã€‚ på€¼ä»£è¡¨çš„æ˜¯ä¸æ¥å—åŸå‡è®¾çš„æœ€å°çš„æ˜¾è‘—æ€§æ°´å¹³ï¼Œå¯ä»¥ä¸é€‰å®šçš„æ˜¾è‘—æ€§æ°´å¹³ç›´æ¥æ¯”è¾ƒã€‚ä¾‹å¦‚å–5%çš„æ˜¾è‘—æ€§æ°´å¹³ï¼Œå¦‚æœPå€¼å¤§äº5%ï¼Œå°±æ¥å—åŸå‡è®¾ï¼Œå¦åˆ™ä¸æ¥å—åŸå‡è®¾ã€‚è¿™æ ·ä¸ç”¨è®¡ç®—tå€¼ï¼Œä¸ç”¨æŸ¥è¡¨ã€‚ 3ã€På€¼èƒ½ç›´æ¥è·Ÿæ˜¾è‘—æ€§æ°´å¹³æ¯”è¾ƒï¼›è€Œtå€¼æƒ³è¦è·Ÿæ˜¾è‘—æ€§æ°´å¹³æ¯”è¾ƒï¼Œå°±å¾—æ¢ç®—æˆPå€¼ï¼Œæˆ–è€…å°†æ˜¾è‘—æ€§æ°´å¹³æ¢ç®—æˆtå€¼ã€‚åœ¨ç›¸åŒè‡ªç”±åº¦ä¸‹ï¼ŒæŸ¥tè¡¨æ‰€å¾—tç»Ÿè®¡é‡å€¼è¶Šå¤§ï¼Œå…¶å°¾ç«¯æ¦‚ç‡Pè¶Šå°ï¼Œä¸¤è€…æ˜¯æ­¤æ¶ˆå½¼é•¿çš„å…³ç³»ï¼Œä½†ä¸æ˜¯ç›´çº¿å‹è´Ÿç›¸å…³ æ€ä¹ˆå¾—åˆ°æ£€éªŒå›å½’ç³»æ•°æ˜¾è‘—æ€§çš„Tå€¼å¯¹äºXã€Yä¸¤ä¸ªæ­£æ€æ€»ä½“çš„æ ·æœ¬ï¼Œå…¶tæ£€éªŒåº”ä½¿ç”¨ttest2()å‡½æ•°æ¥æ£€éªŒå‡è®¾ã€‚[H,P,CI]=ttest2(X,Y) ttest2ï¼ˆï¼‰å‡½æ•°æ˜¯ç”¨æ¥æ£€éªŒå…·æœ‰ç›¸åŒæ–¹å·®çš„ä¸¤ä¸ªæ­£æ€æ€»ä½“å‡å€¼å·®çš„å‡è®¾æ£€éªŒï¼ˆå³ä¸¤æ­£æ€æ€»ä½“çš„æ£€éªŒæ³•ï¼‰ã€‚ åŸºæœ¬è°ƒç”¨æ ¼å¼ï¼š h=ttest2ï¼ˆxï¼Œyï¼‰åˆ¤æ–­æ¥è‡ªä¸åŒæ­£æ€æ€»ä½“çš„æ ·æœ¬æ•°æ®xä¸yæ˜¯å¦æœ‰ç›¸åŒçš„å‡å€¼ã€‚å½“h=0è¡¨ç¤ºæ¥å—åŸå‡è®¾ï¼Œå½“h=1è¡¨ç¤ºæ‹’ç»åŸå‡è®¾ã€‚ h=ttest2ï¼ˆxï¼Œyï¼Œalphaï¼‰è°ƒç”¨æ ¼å¼è¡¨ç¤ºæ‰§è¡Œæ˜¾è‘—æ€§æ°´å¹³ä¸ºï¼ˆ100*alphaï¼‰%çš„å‡è®¾æ£€éªŒã€‚æ²¡æœ‰ç»™å‡ºalphaå€¼ï¼Œé»˜è®¤alpha=0.05ã€‚ h=ttest2ï¼ˆxï¼Œyï¼Œalphaï¼Œtailï¼‰è°ƒç”¨æ ¼å¼è¡¨ç¤ºæ‰§è¡Œä»¥tailæŒ‡å®šçš„å¤‡æ‹©å‡è®¾ä½œå‡è®¾æ£€éªŒï¼ŒåŸå‡è®¾ä¸ºå‡å€¼ç­‰äºmï¼Œå½“tail=â€˜bothâ€™æ—¶è¡¨æ˜å¤‡æ‹©å‡è®¾ä¸ºâ€œxä¸yå‡å€¼ä¸ç›¸ç­‰â€ï¼Œå½“tail=â€˜rightâ€™æ—¶è¡¨æ˜å¤‡æ‹©å‡è®¾ä¸ºâ€œxçš„å‡å€¼å¤§äºyçš„å‡å€¼â€ï¼Œå½“tail=â€˜leftâ€™æ—¶è¡¨æ˜å¤‡æ‹©å‡è®¾ä¸ºâ€œxçš„å‡å€¼å°äºyçš„å‡å€¼â€ã€‚regstatså‡½æ•°ï¼ˆå›å½’ç³»æ•°æ˜¾è‘—æ€§æ£€æµ‹ï¼Ÿï¼‰MATLABç»Ÿè®¡å·¥å…·ç®±ä¸­æä¾›äº†regstatså‡½æ•°ï¼Œä¹Ÿå¯ç”¨æ¥ä½œå¤šé‡çº¿æ€§æˆ–å¹¿ä¹‰çº¿æ€§å›å½’åˆ†æï¼Œå®ƒçš„è°ƒç”¨æ–¹å¼å¦‚ä¸‹ï¼šregstats(y,X,model)stats = regstats(â€¦)stats = regstats(y,X,model,whichstats) éçº¿æ€§ç”¨nlinfitå‡½æ•°æˆ–è€…å¼€å¯cftoolå·¥å…·ç®± eyeå‡½æ•°è¯¥å‡½æ•°è¿”å›å•ä½çŸ©é˜µã€‚ Y = eye(n)ï¼šè¿”å›n*nå•ä½çŸ©é˜µï¼› Y = eye(m,n)ï¼šè¿”å›m*nå•ä½çŸ©é˜µï¼›","categories":[{"name":"matlab","slug":"matlab","permalink":"https://taylor12138.github.io/categories/matlab/"}],"tags":[],"author":"Hello"},{"title":"æ•°å­¦å»ºæ¨¡å›½èµ›matlabçŸ¥è¯†ç‚¹","slug":"æ•°å­¦å»ºæ¨¡å›½èµ›matlabçŸ¥è¯†ç‚¹","date":"2020-08-05T16:00:00.000Z","updated":"2020-08-22T07:55:04.587Z","comments":true,"path":"2020/08/06/shu-xue-jian-mo-guo-sai-matlab-zhi-shi-dian/","link":"","permalink":"https://taylor12138.github.io/2020/08/06/shu-xue-jian-mo-guo-sai-matlab-zhi-shi-dian/","excerpt":"","text":"1.åŸºç¡€å‘½ä»¤è¡Œå¤ªé•¿ï¼Œå¯åŠ ä¸Šä¸‰ä¸ªå°æ•°ç‚¹ï¼šâ€œâ€¦â€ è¿›è¡Œåˆ†å‰²ï¼ˆç»­è¡Œç¬¦ï¼‰ï¼Œå¦‚ s=1-1/2+1/3-1/4... +1/5-1/6+1/7æ•°å€¼æ•°æ®é»˜è®¤åŒç²¾åº¦double clearå‘½ä»¤ï¼Œæ¸…é™¤å·¥ä½œåŒºçš„æ‰€æœ‰å˜é‡ class(å˜é‡)å¾—åˆ°å˜é‡ç±»å‹ å¤å‹æ•°æ®ï¼Œè™šæ•°éƒ¨åˆ†ç”¨iæˆ–jè¡¨ç¤ºï¼Œå¦‚6+5i ï¼Œrealå‡½æ•°æ±‚å¤æ•°å®éƒ¨ï¼Œimagå‡½æ•°æ±‚å¤æ•°çš„è™šéƒ¨ ä»¥è§’åº¦ä¸ºå•ä½çš„å‡½æ•°ï¼Œåœ¨å‡½æ•°åååŠ â€œdâ€ï¼Œå¦‚sin(pi/2)=sind(90) abs(xx)å¯æ±‚å®æ•°ç»å¯¹å€¼ï¼Œå¤æ•°çš„æ¨¡ï¼Œå­—ç¬¦ä¸²çš„asciiç  rem(m,10)æ±‚m/10çš„ä½™æ•° isprime(n)æ±‚næ˜¯å¦ä¸ºç´ æ•°ï¼Œæ˜¯è¿”å›1ï¼Œå¦è¿”å›0 exp(pi/2)ä¸ºeçš„2/Î æ¬¡æ–¹ æ•´å½¢è½¬æ¢x=int8(129) //è½¬æœ‰ç¬¦å·çš„intï¼Œæœ€å¤§127ï¼Œå³è¿™é‡Œx=127 x=uint(129) //è½¬æ— ç¬¦å·uintï¼Œå³x=129 å–æ•´å‡½æ•°round()å‡½æ•°æŒ‰ç…§å››èˆäº”å…¥ ceil()å‘ä¸Šå–æ•´ floor()å‘ä¸‹å–æ•´ fix()å–é è¿‘0çš„æ•´æ•°çŸ©é˜µçš„å»ºç«‹//no.1 A=[1,2,3;4,5,6;7,8,9] //ç¬¬ä¸€è¡Œ1ï¼Œ2ï¼Œ3ï¼Œç¬¬äºŒè¡Œ4ï¼Œ5ï¼Œ6å†’å·è¡¨è¾¾å¼e1:e2:e3 //åˆ†åˆ«ä¸ºåˆå§‹å€¼ï¼Œæ­¥é•¿ï¼ˆä¸¤ä¸¤ä¹‹é—´é—´éš”çš„å¤§å°ï¼Œå¦‚æœçœç•¥æ­¥é•¿ï¼Œåˆ™æ­¥é•¿ä¸º1ï¼‰ï¼Œç»ˆæ­¢å€¼ inspace(a,b,n)//åˆ†åˆ«å¯¹åº”ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œæœ€åä¸€ä¸ªå…ƒç´ ï¼Œå…ƒç´ æ€»æ•°ï¼ˆçœç•¥æ—¶ä¸º100ï¼‰ç»“æ„çŸ©é˜µ&amp;å•ä½çŸ©é˜µ//ç»“æ„çŸ©é˜µ ç»“æ„çŸ©é˜µå…ƒç´ .æˆå‘˜å=è¡¨è¾¾å¼ a(1).x1=10; a(1).x2=&#39;liu&#39;; a(1).x3=[11,21;34,78]; //å•å…ƒçŸ©é˜µï¼Œç”¨å¤§æ‹¬å· b={10,&#39;liu&#39;,[11,21;34,78]}2.çŸ©é˜µå¼•ç”¨çŸ©é˜µå…ƒç´ A(3,2)è¡¨ç¤ºAçŸ©é˜µç¬¬ä¸‰è¡Œï¼Œç¬¬äºŒåˆ—å…ƒç´  å¯ç”¨åºå·å¼•ç”¨ï¼Œå¦‚åœ¨A=[1,2,3;4,5,6;7,8,9]ä¸­ï¼ŒA(3)=7 (çŸ©é˜µå…ƒç´ æŒ‰åˆ—å‚¨å­˜) D=sub2ind(S,I,J),åˆ†åˆ«ä¸ºè¡Œæ•°å’Œåˆ—æ•°ç»„æˆçš„å‘é‡ï¼Œè½¬æ¢çŸ©é˜µå…ƒç´ çš„è¡Œä¸‹æ ‡ï¼Œè½¬æ¢çŸ©é˜µå…ƒç´ çš„åˆ—ä¸‹æ ‡ï¼ŒDä¸ºåºå·ï¼ˆä¸‹æ ‡è½¬åºå·ï¼‰ size(A)æ±‚çŸ©é˜µAçš„è¡Œåˆ—æ•° [I,J]=ind2sub(S,D),åˆ†åˆ«ä¸ºè¡Œæ•°å’Œåˆ—æ•°ç»„æˆçš„å‘é‡ï¼Œåºå·ï¼ˆåºå·è½¬ä¸‹æ ‡ï¼‰ k=find(ch&gt;=&#39;a&#39;&amp;ch&lt;&#39;z&#39;) æ‰¾åˆ°ç¬¦åˆæ¡ä»¶çš„å…ƒç´ çš„åºå· åˆ©ç”¨å†’å·è·å¾—å­çŸ©é˜µA(i,:) ç¬¬iè¡Œçš„æ‰€æœ‰å…ƒç´  A(:,j) ç¬¬jåˆ—çš„æ‰€æœ‰å…ƒç´  A(i:i+m,k:k+m) ç¬¬i~i+mè¡Œä¸”åœ¨ç¬¬k~k+mè¡Œçš„æ‰€æœ‰å…ƒç´ endè¿ç®—ç¬¦ï¼šè¡¨ç¤ºæŸä¸€ç»´æœ«å°¾ä¸‹æ ‡ å¦‚ï¼šA(end,:)ï¼Œæ˜¯æŒ‡AçŸ©é˜µæœ€åä¸€è¡Œæ‰€æœ‰å…ƒç´  åˆ©ç”¨ç©ºçŸ©é˜µåˆ é™¤çŸ©é˜µçš„å…ƒç´ å°†æƒ³è¦çš„å…ƒç´ èŒƒå›´èµ‹å€¼ç©ºçŸ©é˜µ[]å³å¯ï¼Œå¦‚A(:,[2,4])=[]ï¼Œåˆ é™¤ç¬¬äºŒåˆ—ï¼Œç¬¬å››åˆ—å…ƒç´  æ”¹å˜çŸ©é˜µå½¢çŠ¶reshape(A,m,n)ï¼šåœ¨çŸ©é˜µç»¼æ´ç´ ä¸å˜çš„æƒ…å†µä¸‹ï¼Œå°†Aé‡æ–°æ’åˆ—æˆmÃ—nçš„äºŒç»´çŸ©é˜µ æ³¨æ„ï¼šå¹¶ä¸æ”¹å˜å…ƒç´ ä¸ªæ•°åŠå…¶å‚¨å­˜é¡ºåº A(:)ï¼šå°†çŸ©é˜µAæ¯ä¸€åˆ—å…ƒç´ å †å èµ·æ¥æˆä¸ºä¸€ä¸ªåˆ—å‘é‡ 3.ç®—æœ¯è¿ç®—&amp;å­—ç¬¦ä¸²é¡»çŸ¥ï¼šåŠ å‡è¿ç®—ä¸¤çŸ©é˜µå¿…é¡»åŒå‹ï¼Œä¹˜æ³•è¿ç®—è¦æ±‚Aè¡Œæ•°å’ŒBçš„åˆ—æ•°ç›¸åŒ ç‚¹è¿ç®—ï¼šä¸¤çŸ©é˜µè¿›è¡Œç‚¹è¿ç®—æ˜¯æŒ‡å®ƒä»¬å¯¹åº”å…ƒç´ è¿›è¡Œè¿ç®—ï¼Œè¦æ±‚ä¸¤çŸ©é˜µåŒå‹ é€»è¾‘è¿ç®—ç¬¦ï¼š&amp;ï¼Œ|ï¼Œ~ å­—ç¬¦ä¸²å’Œæ•°å€¼ä¹‹é—´çš„è½¬æ¢ï¼šæ•°å€¼ï¼ˆASCIIç ï¼‰=abs(å­—ç¬¦ä¸²) å­—ç¬¦ä¸²=char(ASCIIç ) strncmp(s1,s2)ï¼šç”¨äºæ¯”è¾ƒå­—ç¬¦ä¸²s1ï¼Œs2æ˜¯å¦ç›¸ç­‰ strncmp(s1,s2,n)ï¼šç”¨äºæ¯”è¾ƒå­—ç¬¦ä¸²s1ï¼Œs2å‰nä¸ªå­—ç¬¦æ˜¯å¦ç›¸ç­‰ strcmpi(s1,s2)ï¼šå¿½ç•¥å¤§å°å†™ 4.ç‰¹æ®ŠçŸ©é˜µzeroså‡½æ•°ï¼šäº§ç”Ÿå…¨é›¶çŸ©é˜µ oneså‡½æ•°ï¼šäº§ç”Ÿå…¨1çŸ©é˜µ eyeå‡½æ•°ï¼šäº§ç”Ÿå¯¹è§’çº¿ä¸º1çš„å‡½æ•° randå‡½æ•°ï¼šäº§ç”Ÿï¼ˆ0,1ï¼‰åŒºé—´å‡åŒ€åˆ†å¸ƒçš„éšæœºçŸ©é˜µ randnå‡½æ•°ï¼šäº§ç”Ÿå‡å€¼ä¸º0ï¼Œæ–¹å·®ä¸º1çš„æ ‡å‡†æ­£æ€åˆ†å¸ƒéšæœºçŸ©é˜µ inv(çŸ©é˜µ)ï¼šæ±‚å…¶é€†çŸ©é˜µ zeros(m):äº§ç”ŸmÃ—mé›¶çŸ©é˜µ zeros(m,n):äº§ç”ŸmÃ—né›¶çŸ©é˜µç‰¹æ®ŠçŸ©é˜µä»‹ç»ï¼š é­”æ–¹çŸ©é˜µM=magic(8) (8è¡Œ8åˆ—) èŒƒå¾·è’™çŸ©é˜µvander(1:5) å¸Œå°”ä¼¯ç‰¹çŸ©é˜µï¼šH=hilb(4) ä¼´éšçŸ©é˜µï¼šA=compan(P) å¸•æ–¯å¡çŸ©é˜µï¼šP=pascal(5) å¯¹è§’é˜µå¯¹è§’çŸ©é˜µï¼šå¯¹è§’çº¿ä¸Šå…ƒç´ éé›¶ æ•°é‡çŸ©é˜µï¼šå¯¹è§’çº¿ä¸Šå…ƒç´ ç›¸ç­‰ å¯¹è§’çŸ©é˜µï¼šå¯¹è§’çº¿ä¸Šå…ƒç´ ä¸º1 diag(A)ï¼šæå–çŸ©é˜µAå¯¹è§’çº¿å…ƒç´ ï¼Œäº§ç”Ÿä¸€ä¸ªåˆ—å‘é‡ diag(A,k)ï¼šæå–çŸ©é˜µAç¬¬kæ¡å¯¹è§’çº¿å…ƒç´ ï¼Œäº§ç”Ÿä¸€ä¸ªåˆ—å‘é‡ æ„é€ å¯¹è§’çŸ©é˜µï¼šdiag(V)ï¼šä»¥å‘é‡Vä¸ºä¸»å¯¹è§’çº¿å…ƒç´ ï¼Œäº§ç”Ÿå¯¹è§’çŸ©é˜µ ä¸‰è§’é˜µtriu(A)ï¼šæå–çŸ©é˜µAçš„ä¸»å¯¹è§’çº¿åŠä»¥ä¸Šçš„å…ƒç´  tril(A)ï¼šæå–çŸ©é˜µAçš„ä¸»å¯¹è§’çº¿åŠä»¥ä¸‹çš„å…ƒç´  triu(A,k)ï¼šæå–çŸ©é˜µAçš„ç¬¬kæ¡ä¸»å¯¹è§’çº¿åŠä»¥ä¸Šçš„å…ƒç´  çŸ©é˜µçš„è½¬ç½®A=[1,3;3+4i,1-2i] è½¬ç½®ï¼šA.â€™ å…±è½­è½¬ç½®ï¼šAâ€™ è‹¥çŸ©é˜µä¸ºå®æ•°ï¼Œè½¬ç½®å’Œå…±è½­è½¬ç½®æ˜¯ä¸€æ ·çš„ çŸ©é˜µæ—‹è½¬ï¼šrot90(A,k)ï¼Œå°†çŸ©é˜µAé€†æ—¶é’ˆæ—‹è½¬90Â°çš„kå€ï¼Œkä¸º1å¯çœç•¥ çŸ©é˜µå·¦å³ç¿»è½¬ï¼šfliplr(A) çŸ©é˜µä¸Šä¸‹ç¿»è½¬ï¼šflipud(A) çŸ©é˜µå…¶ä»–åŠŸèƒ½æŠŠä¸€ä¸ªæ–¹é˜µçœ‹ä½œä¸€è¡Œåˆ—å¼ï¼Œå¹¶å¯¹å…¶æŒ‰è¡Œåˆ—å¼çš„è§„åˆ™æ±‚å€¼ï¼šdet(A) æ±‚çŸ©é˜µçš„ç§©ï¼šrank(A) æ±‚çŸ©é˜µçš„è¿¹ï¼Œå³å¯¹è§’çº¿å…ƒç´ ä¹‹å’Œï¼štrace(A) æ±‚çŸ©é˜µAå…¨éƒ¨ç‰¹å¾å€¼ï¼Œæ„æˆå‘é‡Eï¼šE=eig(A) æˆ–è€… [X,D]=eig(A) Açš„å…¨éƒ¨ç‰¹å¾å€¼æ„æˆå¯¹è§’é˜µDï¼ŒXçš„å„åˆ—æ˜¯å¯¹åº”çš„ç‰¹å¾å‘é‡ 5.subplotç”»å›¾subplotï¼ˆm,n,pï¼‰æˆ–è€…subplotï¼ˆmnpï¼‰æ­¤å‡½æ•°æœ€å¸¸ç”¨ï¼šsubplotæ˜¯å°†å¤šä¸ªå›¾ç”»åˆ°ä¸€ä¸ªå¹³é¢ä¸Šçš„å·¥å…·ã€‚å…¶ä¸­ï¼Œmè¡¨ç¤ºæ˜¯å›¾æ’æˆmè¡Œï¼Œnè¡¨ç¤ºå›¾æ’æˆnåˆ—ï¼Œä¹Ÿå°±æ˜¯æ•´ä¸ªfigureä¸­æœ‰nä¸ªå›¾æ˜¯æ’æˆä¸€è¡Œçš„ï¼Œä¸€å…±mè¡Œï¼Œå¦‚æœç¬¬ä¸€ä¸ªæ•°å­—æ˜¯2å°±æ˜¯è¡¨ç¤º2è¡Œå›¾ã€‚pæ˜¯æŒ‡ä½ ç°åœ¨è¦æŠŠæ›²çº¿ç”»åˆ°figureä¸­å“ªä¸ªå›¾ä¸Šï¼Œæœ€åä¸€ä¸ªå¦‚æœæ˜¯1è¡¨ç¤ºæ˜¯ä»å·¦åˆ°å³ç¬¬ä¸€ä¸ªä½ç½®ã€‚ ï¼‰ 6.MatLabä¸­å…³äºç¨‹åºçš„æ“ä½œå»ºç«‹å‡½æ•°ï¼Œæ–°å»ºè„šæœ¬ï¼Œå¼€å¤´ä¸ºï¼š function C = å‡½æ•°å( å‚æ•°A,å‚æ•°B)ï¼Œå¹¶ä¸”é€šè¿‡Cè¿”å›ï¼ˆå½“æœ‰å¤šä¸ªå½¢å‚æ—¶ï¼Œå¯ç”¨é€—å·åˆ†éš”ï¼Œè€ŒCä¸ºè¾“å‡ºå½¢å‚è¡¨ï¼Œå¤šä¸ªè¾“å‡ºå½¢å‚éœ€è¦ç”¨æ–¹æ‹¬å·[] æ‹¬èµ·æ¥ï¼‰ æ•°æ®çš„è¾“å…¥ï¼šA=input(â€˜è¯·è¾“å…¥Açš„å€¼ï¼šâ€™); æ•°æ®çš„è¾“å‡ºï¼šdisp(è¾“å‡ºé¡¹) ç¨‹åºæš‚åœï¼špause(å»¶è¿Ÿæ•°ç§’),å¦‚æœçœç•¥å‚æ•°ï¼Œåˆ™ä¸€ç›´æš‚åœï¼Œé™¤éç”¨æˆ·æŒ‰ä»»æ„é”®å°±å¯ä»¥ç»§ç»­æ‰§è¡Œ x^(1/3)=power(x,1/3) matlabä¸­çš„switch caseç›¸å¯¹äºCï¼Œjavaä¸éœ€è¦breakï¼Œä¸”æœ€åä¸€ä¸ªçš„defaultæ”¹æˆotherwise åŒ¿åå‡½æ•°ï¼šç®€åŒ–äº†å‡½æ•°çš„è¿‡ç¨‹ï¼šå¦‚f=@(x,y)x^2+y^2ï¼Œf(3,4)è¿›è¡Œè°ƒç”¨ï¼Œä½†æ˜¯ä¸é€‚ç”¨äºå¤æ‚å‡½æ•° 7.Plotå‡½æ•°plot(x,y)ï¼Œxï¼Œyåˆ†åˆ«å­˜å‚¨xï¼Œyåæ ‡çš„æ•°æ® æœ€ç®€å•çš„plotè°ƒç”¨æ ¼å¼ï¼šplot(x)ï¼Œä¸‹æ ‡ä¸ºæ¨ªåæ ‡ï¼Œå€¼ä¸ºçºµåæ ‡ x,yä¸ºåŒå‹çŸ©é˜µï¼Œåˆ™åˆ†åˆ«å¯¹åº”xï¼Œyåæ ‡ç»˜ç”»å‡ºæ›²çº¿å›¾ å¤šæ¡æ›²çº¿å¯ä»¥plot(x1,y1,x2,y2,x3,y3â€¦â€¦) x=linspace(0,2*pi,100) ,ä½ç½®0åˆ°2piçš„100ä¸ªå…ƒç´ å­˜äºx plotï¼ˆx,y,é€‰é¡¹ï¼‰é€‰é¡¹æœ‰çº¿æ€§ï¼Œé¢œè‰²ï¼Œæ•°æ®ç‚¹æ ‡è®° çº¿å‹ï¼šâ€œ - â€ å®çº¿, â€œ : â€è™šçº¿, â€œ -. â€ç‚¹ç”»çº¿, â€œ â€“ â€ åŒç”»çº¿ é¢œè‰²ï¼šâ€œ r â€çº¢ï¼Œâ€œ g â€ç»¿ï¼Œâ€œ b â€è“ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ æ•°æ®ç‚¹æ ‡è®°ï¼šâ€œ * â€æ˜Ÿå·ï¼Œâ€œ o â€åœ†åœˆï¼Œâ€ s â€œæ–¹å—ã€‚ã€‚ã€‚ã€‚ 8.fplotå‡½æ•°fplotï¼ˆf,lim,é€‰é¡¹ï¼‰ï¼Œfæ˜¯å‡½æ•°ï¼Œlimæ˜¯xçš„å–å€¼èŒƒå›´ï¼Œç”¨äºŒå…ƒå‘é‡[xmin,xmax]è¡¨ç¤ºï¼Œé»˜è®¤[-5,5]ï¼Œé€‰é¡¹å’Œplotç›¸åŒ è‡ªå˜é‡æ— æ³•é—´éš”é‡‡æ ·æ—¶ä½¿ç”¨fplotï¼ˆå‡½æ•°å˜åŒ–è¶‹åŠ¿æœªçŸ¥ï¼Œæˆ–è€…åœ¨ä¸åŒåŒºé—´å‡½æ•°å˜åŒ–é¢‘ç‡è¿‡å¤§ï¼Œå¦‚sinï¼ˆx/1ï¼‰ï¼‰ 9.æ›²çº¿æ‹Ÿåˆpolyfitï¼ˆï¼‰è¿›è¡Œæ‹Ÿåˆï¼Œæ‰¾ä¸€ä¸ªå‡½æ•°å»é€¼è¿‘æ•°æ®ï¼Œå†æ ¹æ®æ‰¾åˆ°çš„å‡½æ•°é¢„æµ‹ä¸‹ä¸€ä¸ªç‚¹çš„å€¼ï¼ˆå¦‚ äººå£é¢„æµ‹é—®é¢˜ï¼‰ï¼ˆå®ƒå®é™…ä¸Šæ˜¯æ±‚å¾—æœ€å°äºŒä¹˜æ³•æ‹Ÿåˆçš„å¤šé¡¹å¼ç³»æ•°ï¼‰ p=ployfitï¼ˆx,y,3ï¼‰ç”Ÿæˆä¸‰æ¬¡å¤šé¡¹å¼å‡½æ•°ï¼Œè°ƒç”¨ployvalï¼ˆp,2020ï¼‰è¿›è¡Œè®¡ç®—ï¼ˆæ±‚2020å¹´çš„äººå£ï¼‰","categories":[{"name":"matlab","slug":"matlab","permalink":"https://taylor12138.github.io/categories/matlab/"}],"tags":[],"author":"Hello"},{"title":"æ¨¡æ‹Ÿé€€ç«ç®—æ³•","slug":"æ¨¡æ‹Ÿé€€ç«ç®—æ³•","date":"2020-08-05T16:00:00.000Z","updated":"2020-08-07T03:16:44.061Z","comments":true,"path":"2020/08/06/mo-ni-tui-huo-suan-fa/","link":"","permalink":"https://taylor12138.github.io/2020/08/06/mo-ni-tui-huo-suan-fa/","excerpt":"","text":"1.æ¨¡æ‹Ÿé€€ç«ç®—æ³•å¯èƒ½çš„æƒ…å†µå¾ˆå¤šï¼Œæ•°æ®é‡å¤ªå¤§ï¼Œç”¨æ¨¡æ‹Ÿé€€ç«æœç´¢å‡ºéœ€è¦çš„è§£ï¼ˆæ±‚æœ€å€¼ï¼‰ï¼ˆæœ€å¤§å€¼é—®é¢˜å¯ä»¥æ·»åŠ è´Ÿå·è½¬æ¢æˆæ±‚æœ€å°å€¼é—®é¢˜ï¼‰ å¯å‘å¼æœç´¢ï¼šåˆ©ç”¨æœç´¢è¿‡ç¨‹ä¸­è·å–çš„ä¿¡æ¯æ”¹è¿›æœç´¢ç­–ç•¥ã€‚å¯å‘å¼æœç´¢æœ‰åˆ©äºæ‰¾åˆ°é—®é¢˜æœ€ä¼˜è§£ï¼Œä¸”æœ‰åŠ©äºåŠ é€Ÿæ±‚è§£è¿‡ç¨‹ã€‚ æ¨¡æ‹Ÿé€€ç«å¯ä»¥è¯´æ˜¯æœ€ç®€å•ï¼ˆåº”ç”¨ï¼‰çš„å¯å‘å¼æœç´¢ä¹‹ä¸€ ç›¸æ¯”èµ·çˆ¬å±±æ³•ï¼ˆæ‰¾åˆ°å±€éƒ¨æœ€ä¼˜è§£ï¼‰ï¼Œæ¨¡æ‹Ÿé€€ç«ç®—æ³•æœ‰ä¸€å®šæ¦‚ç‡èƒ½æ¥å—æ¯”å½“å‰è¿˜è¦å·®çš„è§£ï¼Œæ¦‚ç‡pä½äº[0,1]ï¼Œæ—§è§£å’Œæ–°è§£çš„å‡½æ•°å€¼è¶Šæ¥è¿‘ï¼Œpå€¼å°±è¶Šå¤§ï¼ˆæ¦‚ç‡ä¸º0å¯¹åº”çˆ¬å±±æ³•ï¼Œæ¦‚ç‡ä¸º1å¯¹åº”è’™ç‰¹å¡æ´›ç®—æ³•ï¼‰ï¼›æ—¶é—´è¶Šé•¿ï¼Œpå€¼è¶Šå°ï¼›æœç´¢å‰æœŸpå¤§ï¼ŒåæœŸpå° 2.æœç´¢è¿‡ç¨‹1.éšæœºç”Ÿæˆä¸€ä¸ªè§£Aï¼Œè®¡ç®—F(A) 2.åœ¨Aé™„è¿‘éšæœºç”Ÿæˆä¸€ä¸ªè§£Bï¼Œè®¡ç®—F(B) 3.å¯¹æ¯”F(A)å’ŒF(B)ï¼Œè¿›è¡Œå¯¹æ¯”ï¼Œè‹¥F(B)&gt;F(A)ï¼ˆæ±‚æœ€å¤§å€¼ï¼‰,Bèµ‹å€¼Aï¼ŒF(B)&lt;F(A)ï¼Œè®¡ç®—æ¥å—Bçš„æ¦‚ç‡ï¼Œæ¥å—åˆ™Bèµ‹å€¼Aï¼Œä¸”é‡å¤ä»¥ä¸Šæ“ä½œï¼Œå¦åˆ™è¿”å›ç¬¬2æ­¥ï¼Œåœ¨åŸæ¥Aé™„è¿‘å†ç”Ÿæˆä¸€ä¸ªBç»§ç»­ä¸‹å» å¦‚æœä¼˜åŒ–é—®é¢˜æœ‰çº¦æŸæ¡ä»¶ï¼š 1.ç”ŸæˆBæ˜¯æŸ¥çœ‹æ˜¯å¦ç¬¦åˆè¦æ±‚ 2.ä½¿ç”¨ç½šå‡½æ•° ä¸æ—¶é—´ç›¸å…³çš„ç³»æ•°Ctå¦‚ä½•è®¾ç½®ï¼šCtæ˜¯æ¸©åº¦tçš„å€’æ•°ï¼ˆæ¨¡æ‹Ÿé€€ç«ï¼‰ å¦‚ä½•å†Aé™„è¿‘éšæœºç”Ÿæˆä¸€ä¸ªè§£Bï¼šæ²¡æœ‰ç»Ÿä¸€è§„å®šï¼Œéœ€è¦å…·ä½“é—®é¢˜å…·ä½“åˆ†æ åœæ­¢æœç´¢1.è¾¾åˆ°è¿­ä»£æ¬¡æ•° 2.è¾¾åˆ°æŒ‡å®šæ¸©åº¦ 3.æ‰¾åˆ°è¿ç»­æœ€ä¼˜è§£ï¼ŒMï¼ˆå¦‚30æ¬¡ï¼‰æ¬¡è¿­ä»£è¿˜æœªæ”¹å˜ 3.å®ç°äº§ç”Ÿæ–°è§£ï¼š 1.matlabå†…ç½®å·¥å…· æ ¹æ®æ¸©åº¦ä¸åŒï¼Œæ–°è§£è·ç¦»æ—§è§£çš„æ­¥é•¿æ”¹å˜ï¼Œæ¸©åº¦é«˜æ­¥é•¿é«˜ï¼Œæ¸©åº¦ä½æ­¥é•¿çŸ­ï¼Œç”±å…¨å±€ç¼©çŸ­ä¸º x_new=x_i+TÃ—z_i ç„¶åæ£€æŸ¥x_newæ˜¯å¦ä½äºä¸Šä¸‹ç•Œ 2.æ—…è¡Œå•†é—®é¢˜ äº¤æ¢æ³•ï¼Œä½ç§»æ³•ï¼Œå€’ç½®æ³•","categories":[{"name":"matlab","slug":"matlab","permalink":"https://taylor12138.github.io/categories/matlab/"}],"tags":[],"author":"Hello"},{"title":"CSSæ¸²æŸ“æ·±ç©¶","slug":"CSSæ¸²æŸ“æ·±ç©¶","date":"2020-07-30T16:00:00.000Z","updated":"2022-06-19T15:30:15.071Z","comments":true,"path":"2020/07/31/css-xuan-ran-shen-jiu/","link":"","permalink":"https://taylor12138.github.io/2020/07/31/css-xuan-ran-shen-jiu/","excerpt":"","text":"CSSåŠ¨ç”»å’ŒJSåŠ¨ç”»çš„å¯¹æ¯”CSSåŠ¨ç”»ä¼˜ç‚¹ï¼š åŠ¨ç”»æµç•…ï¼ˆä»¥æ¯ä¸€å¸§çš„é—´éš”ä¿è¯æ°å½“çš„æ—¶é—´åˆ·æ–°UIï¼‰ æ€§èƒ½è¾ƒä¼˜ åŠ¨ç”»æ•ˆæœå¯¹å¸§é€Ÿä¸å¥½çš„ä½ç‰ˆæœ¬æµè§ˆå™¨ ä»£ç ç®€å•ï¼Œè°ƒä¼˜æ–¹å‘å›ºå®š ç¼ºç‚¹ï¼š è¿è¡Œè¿‡ç¨‹æ§åˆ¶è¾ƒå¼±,æ— æ³•é™„åŠ äº‹ä»¶ç»‘å®šå›è°ƒå‡½æ•° ä»£ç å†—é•¿ JSåŠ¨ç”»ä¼˜ç‚¹ï¼š JavaScriptåŠ¨ç”»æ§åˆ¶èƒ½åŠ›å¾ˆå¼ºï¼ŒåŠ¨ç”»èƒ½åŠ›å¼º å…¼å®¹æ€§å¥½ CSSçš„repaintå’Œreflow ä»¥ä¸Šä¸ºæµè§ˆå™¨è§£ææµç¨‹å›¾(WebKit ä¸»æµç¨‹) 1ã€è§£æHTMLä»¥æ„å»ºDOMæ ‘ï¼šæ¸²æŸ“å¼•æ“å¼€å§‹è§£æHTMLæ–‡æ¡£ï¼Œè½¬æ¢æ ‘ä¸­çš„htmlæ ‡ç­¾æˆ–jsç”Ÿæˆçš„æ ‡ç­¾åˆ°DOMèŠ‚ç‚¹ï¼Œå®ƒè¢«ç§°ä¸º â€“ å†…å®¹æ ‘ï¼›æ­¤å¤–ï¼ŒCSSä¸‹è½½å®Œä¹‹åå¯¹CSSè¿›è¡Œè§£æï¼Œè§£ææˆCSSå¯¹è±¡ï¼Œç„¶åæŠŠCSSå¯¹è±¡ç»„è£…èµ·æ¥ï¼Œæ„å»ºCSSOMæ ‘ã€‚ 2ã€æ„å»ºæ¸²æŸ“æ ‘ï¼šè§£æCSSï¼ˆåŒ…æ‹¬å¤–éƒ¨CSSæ–‡ä»¶å’Œæ ·å¼å…ƒç´ ä»¥åŠjsç”Ÿæˆçš„æ ·å¼ï¼‰ï¼Œæ ¹æ®CSSé€‰æ‹©å™¨è®¡ç®—å‡ºèŠ‚ç‚¹çš„æ ·å¼ï¼Œåœ¨è§£ææ­¥éª¤ä¸­åˆ›å»ºçš„CSSOMæ ‘å’ŒDOMæ ‘ç»„åˆæˆä¸€ä¸ªRenderæ ‘ã€‚ï¼ˆdisplay: none;ä¸ä¼šå‡ºç°åœ¨renderæ ‘ä¸Šï¼Œvisibility: hiddenä¼šå‡ºç°åœ¨renderæ ‘ä¸Šï¼Œå› ä¸ºå®ƒä»¬ä¼šå ç”¨ç©ºé—´ï¼‰3ã€å¸ƒå±€æ¸²æŸ“æ ‘: ä¹Ÿå°±æ˜¯layoutï¼Œä»æ ¹èŠ‚ç‚¹é€’å½’è°ƒç”¨ï¼Œè®¡ç®—æ¯ä¸€ä¸ªå…ƒç´ çš„å¤§å°ã€ä½ç½®ç­‰ï¼Œç»™æ¯ä¸ªèŠ‚ç‚¹æ‰€åº”è¯¥å‡ºç°åœ¨å±å¹•ä¸Šçš„ç²¾ç¡®åæ ‡ã€‚4ã€ç»˜åˆ¶æ¸²æŸ“æ ‘: ä¹Ÿå°±æ˜¯paintï¼Œéå†æ¸²æŸ“æ ‘ï¼Œæ¯ä¸ªèŠ‚ç‚¹å°†ä½¿ç”¨UIåç«¯å±‚æ¥ç»˜åˆ¶ã€‚ åœ¨ Chromeã€Operaã€Safari å’Œ Internet Explorer ä¸­ç§°ä¸ºå¸ƒå±€ (Layout)ã€‚ åœ¨ Firefox ä¸­ç§°ä¸ºè‡ªåŠ¨é‡æ’ (Reflow)ï¼Œä½†å®é™…ä¸Šå…¶è¿‡ç¨‹æ˜¯ä¸€æ ·çš„ã€‚ reflowå¯¹èŠ‚ç‚¹å¤§å°å’Œä½ç½®çš„é‡æ–°è®¡ç®—ç§°ä¸ºå›æµreflow/ layoutï¼Œæ¯ä¸ªé¡µé¢è‡³å°‘éœ€è¦ä¸€æ¬¡å›æµï¼ˆreflow/ layoutï¼‰ï¼Œå°±æ˜¯é¡µé¢ç¬¬ä¸€æ¬¡åŠ è½½çš„æ—¶å€™ã€‚ å¯¹äºDOMç»“æ„ä¸­çš„å„ä¸ªå…ƒç´ éƒ½æœ‰è‡ªå·±çš„ç›’å­ï¼ˆæ¨¡å‹ï¼‰ï¼Œè¿™äº›éƒ½éœ€è¦æµè§ˆå™¨æ ¹æ®å„ç§æ ·å¼ï¼ˆæµè§ˆå™¨çš„ã€å¼€å‘äººå‘˜å®šä¹‰çš„ç­‰ï¼‰æ¥è®¡ç®—å¹¶æ ¹æ®è®¡ç®—ç»“æœå°†å…ƒç´ æ”¾åˆ°å®ƒè¯¥å‡ºç°çš„ä½ç½®ï¼Œè¿‡ç¨‹ç§°ä¸ºreflow å®ƒä¸€èˆ¬åœ¨DOMå…ƒç´ ä½ç½®å‘ç”Ÿæ”¹å˜åè§¦å‘ï¼Œæ¯”å¦‚JSæ·»åŠ  DOMå…ƒç´ ï¼ŒCSS widthçš„æ”¹å˜ã€CSS3çš„animationï¼ˆanimationé‡Œé¢è—ç€widthçš„æ”¹å˜ï¼‰ã€Scrollé¡µé¢ repaintå½“å„ç§ç›’å­çš„ä½ç½®ã€å¤§å°ä»¥åŠå…¶ä»–å±æ€§ï¼Œä¾‹å¦‚é¢œè‰²ã€å­—ä½“å¤§å°ç­‰éƒ½ç¡®å®šä¸‹æ¥åï¼Œæµè§ˆå™¨äºæ˜¯ä¾¿æŠŠè¿™äº›å…ƒç´ éƒ½æŒ‰ç…§å„è‡ªçš„ç‰¹æ€§ç»˜åˆ¶äº†ä¸€éï¼Œäºæ˜¯é¡µé¢çš„å†…å®¹å‡ºç°äº†ï¼Œè¿‡ç¨‹ç§°ä¸ºrepaint å®ƒä¸€èˆ¬åœ¨æ”¹å˜ DOM å…ƒç´ çš„è§†è§‰æ•ˆæœæ—¶è§¦å‘ï¼Œå³ä¸æ¶‰åŠä»»ä½•æ’ç‰ˆå¸ƒå±€çš„é—®é¢˜æ—¶è§¦å‘ï¼Œæ¯”å¦‚colorã€text-alignã€ æ³¨æ„ï¼šå›æµreflowä¸€å®šä¼šè§¦å‘é‡ç»˜repaintï¼Œè€Œé‡ç»˜ä¸ä¸€å®šä¼šå›æµ æˆ‘ä»¬åº”è¯¥å‡å°‘reflowå’Œrepaintçš„æ“ä½œï¼Œæé«˜æ¸²æŸ“é€Ÿåº¦ reflowçš„æˆæœ¬æ¯”repainté«˜å¾ˆå¤š ä¸‹é¢æ“ä½œå¯èƒ½å¯¼è‡´é«˜æˆæœ¬çš„æ¶ˆè€—ï¼š å½“ä½ å¢åŠ ã€åˆ é™¤ã€ä¿®æ”¹ DOM ç»“ç‚¹æ—¶ï¼Œä¼šå¯¼è‡´ Reflow æˆ– Repaintã€‚ å½“ä½ ç§»åŠ¨ DOM çš„ä½ç½®ï¼Œæˆ–æ˜¯æä¸ªåŠ¨ç”»çš„æ—¶å€™ã€‚ å½“ä½ ä¿®æ”¹ CSS æ ·å¼çš„æ—¶å€™ã€‚ å½“ä½  Resize çª—å£çš„æ—¶å€™ï¼ˆç§»åŠ¨ç«¯æ²¡æœ‰è¿™ä¸ªé—®é¢˜ï¼‰ï¼Œæˆ–æ˜¯æ»šåŠ¨çš„æ—¶å€™ã€‚ å½“ä½ ä¿®æ”¹ç½‘é¡µçš„é»˜è®¤å­—ä½“æ—¶ã€‚ display:none ä¼šè§¦å‘ reflowï¼Œè€Œ visibility:hidden åªä¼šè§¦å‘ repaint ä¼˜åŒ–æ–¹å¼ ä¸è¦ä¸€æ¡ä¸€æ¡åœ°ä¿®æ”¹ DOM çš„æ ·å¼ã€‚ä¸å…¶è¿™æ ·ï¼Œè¿˜ä¸å¦‚é¢„å…ˆå®šä¹‰å¥½ css çš„ classï¼Œç„¶åä¿®æ”¹ DOM çš„ classNameï¼ˆæˆ–è€…ä½¿ç”¨çš„æ˜¯vueã€reactç­‰æ¡†æ¶ï¼Œè™šæ‹Ÿdomä¼šå¸®åŠ©ä½ å®Œæˆä¸€æ¬¡æ€§çš„domæ“ä½œï¼‰ å¯ä»¥å…ˆæŠŠçˆ¶å…ƒç´ éšè—èµ·æ¥ï¼Œæ·»åŠ å®Œå­å…ƒç´ åï¼Œåœ¨æŠŠçˆ¶å…ƒç´ æ˜¾ç¤ºå‡ºæ¥ï¼›äº¦æˆ–è€…ä½¿ç”¨æ–‡æ¡£ç‰‡æ®µ(document fragment)åœ¨å½“å‰DOMä¹‹å¤–æ„å»ºä¸€ä¸ªå­æ ‘ï¼Œå†æŠŠå®ƒæ‹·è´å›æ–‡æ¡£ å‡å°‘ä½¿ç”¨tableå¸ƒå±€ ä¸è¦æŠŠ DOM èŠ‚ç‚¹çš„å±æ€§å€¼æ”¾åœ¨ä¸€ä¸ªå¾ªç¯é‡Œå½“æˆå¾ªç¯é‡Œçš„å˜é‡ ä½¿ç”¨transformã€opacityã€filtersè¿™äº›åŠ¨ç”»ä¸ä¼šå¼•èµ·å›æµé‡ç»˜ï¼Œå› ä¸ºä»–ä»¬æ˜¯åœ¨paintä¹‹åçš„ æ¯”å¦‚æˆ‘åœ¨ä½¿ç”¨äº†transform:translate()åï¼Œæ— æ³•è·å–æ­£ç¡®çš„offsetTopã€offsetLeftï¼Œç”±äºä»–ä»¬æœªè¿›è¡Œå›æµé‡ç»˜ï¼Œè™½ç„¶è§†è§‰ä¸Šç¡®å®æ˜¯ç§»åŠ¨äº†ï¼Œä½†æ˜¯divåœ¨æ–‡æ¡£æµä¸­çš„ä½ç½®æ˜¯ä¸å˜çš„ å®è´¨ä¸ŠLayout -&gt; Paint -&gt; è¿˜æœ‰ä¸€ä¸ªComposite(æ¸²æŸ“å±‚åˆå¹¶) å…·ä½“æœ‰å…³äºä¼šå½±å“Layoutçš„CSSå±æ€§å¯ä»¥åœ¨CSS Triggersç½‘ç«™ä¸­æŸ¥é˜…ã€‚ï¼ˆå¯ä»¥æ–¹ä¾¿æˆ‘ä»¬ä¼˜åŒ–ï¼‰ æµè§ˆå™¨å¯¹äºå›æµé‡ç»˜çš„ä¼˜åŒ–ç°ä»£çš„æµè§ˆå™¨éƒ½æ˜¯å¾ˆèªæ˜çš„ï¼Œç”±äºæ¯æ¬¡é‡æ’éƒ½ä¼šé€ æˆé¢å¤–çš„è®¡ç®—æ¶ˆè€—ï¼Œå› æ­¤å¤§å¤šæ•°æµè§ˆå™¨éƒ½ä¼šé€šè¿‡é˜Ÿåˆ—åŒ–ä¿®æ”¹å¹¶æ‰¹é‡æ‰§è¡Œæ¥ä¼˜åŒ–é‡æ’è¿‡ç¨‹ ä½†æ˜¯ï¼šå½“ä½ è·å–å¸ƒå±€ä¿¡æ¯çš„æ“ä½œçš„æ—¶å€™ï¼Œä¼šå¼ºåˆ¶é˜Ÿåˆ—åˆ·æ–°ï¼Œæ¯”å¦‚å½“ä½ è®¿é—®ä»¥ä¸‹å±æ€§æˆ–è€…ä½¿ç”¨ä»¥ä¸‹æ–¹æ³•ï¼š offsetTopã€offsetLeftã€offsetWidthã€offsetHeight scrollTopã€scrollLeftã€scrollWidthã€scrollHeight clientTopã€clientLeftã€clientWidthã€clientHeight getComputedStyle() getBoundingClientRect æ‰€ä»¥æˆ‘ä»¬è¦æœ‰å¯èƒ½é€ æˆå›æµé‡ç»˜æ—¶ï¼Œè¦é¿å…ä½¿ç”¨ä»¥ä¸Šæ–¹æ³•ï¼Œå¯¼è‡´é˜Ÿåˆ—è¿›è¡Œåˆ·æ–° å…³äºç‰¹æ®ŠCSSå±æ€§çš„ä¼˜åŒ–å¦‚æœä½ ä¿®æ”¹ä¸€ä¸ªéæ ·å¼ä¸”éç»˜åˆ¶çš„CSSå±æ€§ï¼Œé‚£ä¹ˆæµè§ˆå™¨ä¼šåœ¨å®Œæˆæ ·å¼è®¡ç®—ä¹‹åï¼Œè·³è¿‡å¸ƒå±€å’Œç»˜åˆ¶çš„è¿‡ç¨‹ï¼Œç›´æ¥åšæ¸²æŸ“å±‚åˆå¹¶ã€‚è¿™ç§æ–¹å¼åœ¨æ€§èƒ½ä¸Šæ˜¯æœ€ç†æƒ³çš„ã€‚ ä¸æ˜¯æ‰€æœ‰å±æ€§åŠ¨ç”»æ¶ˆè€—çš„æ€§èƒ½éƒ½ä¸€æ ·ï¼Œå…¶ä¸­æ¶ˆè€—æœ€ä½çš„æ˜¯transformå’Œopacityä¸¤ä¸ªå±æ€§ï¼ˆå½“ç„¶è¿˜æœ‰ä¼šè§¦å‘Compositeçš„å…¶ä»–CSSå±æ€§ï¼‰ï¼Œå…¶æ¬¡æ˜¯Paintç›¸å…³å±æ€§ã€‚æ‰€ä»¥åœ¨åˆ¶ä½œåŠ¨ç”»æ—¶ï¼Œå»ºè®®ä½¿ç”¨transformçš„translateæ›¿ä»£marginæˆ–positionä¸­çš„topã€rightã€bottomå’Œleftï¼ŒåŒæ—¶ä½¿ç”¨transformä¸­çš„scaleXæˆ–è€…scaleYæ¥æ›¿ä»£widthå’Œheightã€‚ transformåœ¨æ²¡æœ‰é‡ç»˜çš„æƒ…å†µä¸‹ï¼Œå˜æ¢ç©¶ç«Ÿæ˜¯å¦‚ä½•æ¸²æŸ“åŠ¨ç”»çš„å‘¢ï¼ŸåŸºæœ¬ç­”æ¡ˆæ˜¯ CSS è½¬æ¢ç›´æ¥å‘ç”Ÿåœ¨åˆ©ç”¨ç¡¬ä»¶åŠ é€Ÿçš„GPUå†…å­˜ä¸­ï¼Œä»è€Œé¿å…äº†è½¯ä»¶æ¸²æŸ“ã€‚ æ¸²æŸ“å±‚ï¼ˆPaintLayerï¼‰PaintLayer æœ€åˆæ˜¯ç”¨æ¥å®ç° stacking contestï¼ˆå±‚å ä¸Šä¸‹æ–‡ï¼‰ï¼Œä»¥æ­¤æ¥ä¿è¯é¡µé¢å…ƒç´ ä»¥æ­£ç¡®çš„é¡ºåºåˆæˆï¼ˆcompositeï¼‰ï¼Œè¿™æ ·æ‰èƒ½æ­£ç¡®çš„å±•ç¤ºå…ƒç´ çš„é‡å ä»¥åŠåŠé€æ˜å…ƒç´ ç­‰ç­‰ã€‚ å°†å…¶åˆ†ä¸ºå¸¸è§çš„ 3 ç±»ï¼š NormalPaintLayer æ ¹å…ƒç´ ï¼ˆHTMLï¼‰ æœ‰æ˜ç¡®çš„å®šä½å±æ€§ï¼ˆrelativeã€fixedã€stickyã€absoluteï¼‰ é€æ˜çš„ï¼ˆopacity å°äº 1ï¼‰ æœ‰ CSS æ»¤é•œï¼ˆfliterï¼‰ æœ‰ CSS mask å±æ€§ æœ‰ CSS mix-blend-mode å±æ€§ï¼ˆä¸ä¸º normalï¼‰ æœ‰ CSS transform å±æ€§ï¼ˆä¸ä¸º noneï¼‰ backface-visibility å±æ€§ä¸º hidden æœ‰ CSS reflection å±æ€§ æœ‰ CSS column-count å±æ€§ï¼ˆä¸ä¸º autoï¼‰æˆ–è€… æœ‰ CSS column-width å±æ€§ï¼ˆä¸ä¸º autoï¼‰ å½“å‰æœ‰å¯¹äº opacityã€transformã€fliterã€backdrop-filter åº”ç”¨åŠ¨ç”» OverflowClipPaintLayer overflow ä¸ä¸º visible NoPaintLayer ä¸éœ€è¦ paint çš„ PaintLayerï¼Œæ¯”å¦‚ä¸€ä¸ªæ²¡æœ‰è§†è§‰å±æ€§ï¼ˆèƒŒæ™¯ã€é¢œè‰²ã€é˜´å½±ç­‰ï¼‰çš„ç©º divã€‚ åˆæˆå±‚ï¼ˆCompositing Layersï¼‰åˆæˆå±‚ï¼ˆCompositing Layersï¼‰ï¼Œåˆæˆå±‚æ‹¥æœ‰å•ç‹¬çš„ GraphicsLayerï¼Œè€Œå…¶ä»–ä¸æ˜¯åˆæˆå±‚çš„æ¸²æŸ“å±‚ï¼Œåˆ™å’Œå…¶ç¬¬ä¸€ä¸ªæ‹¥æœ‰ GraphicsLayer çˆ¶å±‚å…¬ç”¨ä¸€ä¸ªã€‚ æ¸²æŸ“ä¼˜åŒ–ä¸æ­¤åŒæ—¶ï¼Œæˆ‘ä»¬é€šè¿‡CSSçš„å±æ€§æ¥è§¦å‘ GPUåŠ é€Ÿ æµè§ˆå™¨ä¼šä¸ºæ­¤å…ƒç´ å•ç‹¬åˆæˆå±‚ï¼Œä¸€ä¸ªæ–°çš„å¤åˆå±‚ã€‚æœ‰äº†è¿™ä¸€å±‚ï¼Œå°±æœ‰ç‚¹Reactçš„PureComponentã€usecallbackå†…å‘³äº†ï¼Œè¿›è¡Œå±€éƒ¨æ›´æ–°ï¼Œä¸å½±å“ä»–äººã€‚ ä¸ºä»€ä¹ˆå¼€å¯ç¡¬ä»¶åŠ é€ŸåŠ¨ç”»å°±ä¼šå˜å¾—æµç•…ï¼Œé‚£æ˜¯å› ä¸ºæ¯ä¸ªé¡µé¢å…ƒç´ éƒ½æœ‰ä¸€ä¸ªç‹¬ç«‹çš„Renderè¿›ç¨‹ã€‚ é¦–å…ˆç†è§£ä¸‰ä¸ªæ¦‚å¿µï¼š CPUå³ä¸­å¤®å¤„ç†å™¨ï¼Œå®ƒçš„åŠŸèƒ½ä¸»è¦æ˜¯è§£é‡Šè®¡ç®—æœºæŒ‡ä»¤ä»¥åŠå¤„ç†è®¡ç®—æœºè½¯ä»¶ä¸­çš„æ•°æ®,ä¹Ÿè¢«ç§°ä¸ºä¸»æ¿ã€‚ GPUå³å›¾å½¢å¤„ç†å™¨ï¼Œæ˜¯ä¸å¤„ç†å’Œç»˜åˆ¶å›¾å½¢ç›¸å…³çš„ç¡¬ä»¶ã€‚GPUæ˜¯ä¸“ä¸ºæ‰§è¡Œå¤æ‚çš„æ•°å­¦å’Œå‡ ä½•è®¡ç®—è€Œè®¾è®¡çš„ï¼Œæœ‰äº†å®ƒï¼ŒCPUå°±ä»å›¾å½¢å¤„ç†çš„ä»»åŠ¡ä¸­è§£æ”¾å‡ºæ¥ï¼Œå¯ä»¥æ‰§è¡Œå…¶ä»–æ›´å¤šçš„ç³»ç»Ÿä»»åŠ¡ã€‚ ç¡¬ä»¶åŠ é€Ÿæ˜¯æŒ‡åœ¨è®¡ç®—æœºä¸­é€è¿‡æŠŠè®¡ç®—é‡éå¸¸å¤§çš„å·¥ä½œåˆ†é…ç»™ä¸“é—¨çš„ç¡¬ä»¶æ¥å¤„ç†æ¥å‡è½»CPUçš„å·¥ä½œé‡çš„æŠ€æœ¯ã€‚åœ¨CSS transition, transformå’Œanimationçš„ä¸–ç•Œé‡Œï¼Œä»–æš—ç¤ºæˆ‘ä»¬åº”è¯¥å¸è½½è¿›ç¨‹åˆ°GPUï¼Œå› æ­¤åŠ å¿«é€Ÿåº¦ã€‚è¿™ç§æƒ…å†µé€šè¿‡å‘å®ƒè‡ªå·±çš„å±‚å åŠ å…ƒç´ ï¼Œå½“åŠ è½½åŠ¨ç”»çš„æ—¶å€™å¯ä»¥åŠ é€Ÿæ¸²æŸ“ã€‚ æœ‰äº†æ–°çš„â€œå±‚â€ï¼Œå°±æœ‰äº†æ–°çš„â€œRenderè¿›ç¨‹â€ã€‚Renderè¿›ç¨‹ä¸­åŒ…å«äº†ä¸»çº¿ç¨‹å’Œåˆæˆçº¿ç¨‹ï¼Œä¸»çº¿ç¨‹è´Ÿè´£ï¼š JavaScriptçš„æ‰§è¡Œ CSSæ ·å¼è®¡ç®— è®¡ç®—Layout å°†é¡µé¢å…ƒç´ ç»˜åˆ¶æˆä½å›¾(Paint) å‘é€ä½å›¾ç»™åˆæˆçº¿ç¨‹ åˆæˆçº¿ç¨‹åˆ™ä¸»è¦è´Ÿè´£ï¼š å°†ä½å›¾å‘é€ç»™GPU è®¡ç®—é¡µé¢çš„å¯è§éƒ¨åˆ†å’Œå³å°†å¯è§éƒ¨åˆ†(æ»šåŠ¨) é€šçŸ¥GPUç»˜åˆ¶ä½å›¾åˆ°å±å¹•ä¸Š(Draw) æˆ‘ä»¬å¯ä»¥å¾—åˆ°ä¸€ä¸ªå¤§æ¦‚çš„æµè§ˆå™¨çº¿ç¨‹æ¨¡å‹ï¼š è€Œåœ¨ä»€ä¹ˆæƒ…å†µä¸‹æˆ‘ä»¬å¯ä»¥å•ç‹¬åˆ›å»ºå‡ºè¿™æ ·ä¸€ä¸ªå¤åˆå±‚(åˆæˆå±‚)ï¼Ÿ å®ƒåœ¨ä»¥ä¸‹æƒ…å†µä¸‹è¿™æ ·åšï¼š å¯¹äº 3D æˆ–é€è§†ï¼ˆopacityï¼‰ CSS è½¬æ¢ï¼ˆåœ¨æˆ‘ä»¬çš„ç¤ºä¾‹ä¸­ï¼‰ï¼Œæ¯”å¦‚transform: translateZ(0)ï¼Œæ³¨æ„å®ƒå¿…é¡»æ˜¯ translateZ å¯¹äº&lt;video&gt;æˆ–&lt;canvas&gt;å…ƒç´  ä½¿ç”¨ CSS è¿‡æ»¤å™¨ï¼ˆfilterï¼‰æ—¶ å¯¹äºä¸æå–åˆ°å¤åˆå±‚çš„å¦ä¸€ä¸ªå…ƒç´ é‡å çš„å…ƒç´ ï¼ˆä¾‹å¦‚ï¼Œä½¿ç”¨z-indexï¼‰ æ‰€ä»¥è¿™æ—¶æˆ‘ä»¬ä¼šæƒ³åˆ°ï¼štransfrom: translate(x, y)è¿™ç§å¯ä»¥å®ç°å¤åˆå±‚å—ï¼Ÿï¼Ÿï¼Ÿä¸ºä»€ä¹ˆ2Dæ²¡æœ‰ä¼šå‡ºç°åœ¨ä¸Šé¢çš„æ¡ä»¶ä¸­ï¼Ÿ é›€é£Ÿå¯ä»¥ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä¸¤ä¸ªé¢å¤–çš„é‡ç»˜æ“ä½œåœ¨åŠ¨ç”»æ—¶é—´è½´çš„å¼€å§‹å’Œç»“æŸ 3D å’Œ 2D å˜æ¢ä¹‹é—´çš„åŒºåˆ«åœ¨äº 3D å˜æ¢ä½¿æµè§ˆå™¨é¢„å…ˆåˆ›å»ºä¸€ä¸ªå•ç‹¬çš„å¤åˆå±‚ï¼Œè€Œ 2D å˜æ¢åˆ™æ˜¯å³æ—¶å®Œæˆçš„ã€‚åœ¨åŠ¨ç”»å¼€å§‹æ—¶ï¼Œä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„å¤åˆå±‚å¹¶å°†çº¹ç†åŠ è½½åˆ° GPUï¼Œä»è€Œå¯åŠ¨é‡ç»˜ã€‚ç„¶ååŠ¨ç”»ç”± GPU ä¸­çš„åˆæˆå™¨æ‰§è¡Œã€‚å½“åŠ¨ç”»å®Œæˆæ—¶ï¼Œé™„åŠ çš„å¤åˆå±‚å°†è¢«ç§»é™¤ï¼Œè¿™å°†å¯¼è‡´å¦ä¸€ä¸ªé‡ç»˜æ“ä½œã€‚ å¦‚ä½•å¼€å¯GPUåŠ é€Ÿï¼Ÿå¹¶éå…ƒç´ ä¸Šçš„æ‰€æœ‰ CSS å±æ€§æ›´æ”¹éƒ½å¯ä»¥ç›´æ¥åœ¨ GPU ä¸­å¤„ç†ã€‚ä»…æ”¯æŒä»¥ä¸‹å±æ€§ï¼š transform opacity filter å› æ­¤ï¼Œä¸ºäº†ç¡®ä¿è·å¾—æµç•…ã€é«˜è´¨é‡åŠ¨ç”»çš„æœ€ä½³æœºä¼šï¼Œæˆ‘ä»¬åº”è¯¥å§‹ç»ˆå°è¯•ä½¿ç”¨è¿™äº› GPU å‹å¥½çš„å±æ€§ã€‚ æˆ–è€…å°è¯•ä¸€ä¸‹å¼ºåˆ¶åœ¨GPUä¸­æ¸²æŸ“å…ƒç´ çš„æ–¹æ³•ï¼šï¼ .example1 { transform: translateZ(0); } .example2 { transform: rotateZ(360deg); } ç¼ºç‚¹ï¼š æ²¡æœ‰ä»€ä¹ˆæ˜¯å…è´¹çš„ï¼ï¼ˆè‹±æ–‡ç›´è¯‘hhhï¼‰ å†…å­˜é—®é¢˜ï¼šæœ€é‡è¦çš„é—®é¢˜ä¸å†…å­˜æœ‰å…³ã€‚å‘ GPU åŠ è½½è¿‡å¤šçº¹ç†å¯èƒ½ä¼šå¯¼è‡´å†…å­˜é—®é¢˜ å­—ä½“æ¸²æŸ“ï¼šGPU ä¸­çš„æ¸²æŸ“ä¼šå½±å“å­—ä½“æŠ—é”¯é½¿ã€‚è¿™æ˜¯å› ä¸º GPU å’Œ CPU å…·æœ‰ä¸åŒçš„æ¸²æŸ“æœºåˆ¶ will-changeæˆ‘ä»¬å¯èƒ½å¬å¬è¯´è¿‡ï¼Œ3D transformä¼šå¯ç”¨GPUåŠ é€Ÿâ‘ ï¼Œä¾‹å¦‚translate3D, scaleZä¹‹ç±»ï¼Œä½†æ˜¯å‘¢ï¼Œè¿™äº›å±æ€§ä¸šç•Œå¾€å¾€ç§°ä¹‹ä¸ºhackåŠ é€Ÿæ³•ã€‚æˆ‘ä»¬å®é™…ä¸Šä¸éœ€è¦zè½´çš„å˜åŒ–ï¼Œä½†æ˜¯è¿˜æ˜¯å‡æ¨¡å‡æ ·åœ°å£°æ˜äº†ï¼Œæ¬ºéª—æµè§ˆå™¨ï¼Œè¿™å…¶å®æ˜¯ä¸€ç§ä¸äººé“çš„åšæ³•ã€‚ ä½¿ç”¨â€œtransform hackâ€æ¥åˆ›å»ºå•ç‹¬çš„å¤åˆå±‚çš„å¿…è¦æ€§å¾ˆéº»çƒ¦ã€‚æµè§ˆå™¨ç»å¯¹åº”è¯¥æä¾›ä¸€ç§ç›´æ¥çš„æ–¹æ³•æ¥åšåˆ°è¿™ä¸€ç‚¹ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆå¼•å…¥äº†will-change å±æ€§ã€‚è¿™ä¸ªåŠŸèƒ½å¯ä»¥è®©ä½ é€šçŸ¥æµè§ˆå™¨å“ªä¸ªå±æ€§ä¼šå‘ç”Ÿå˜åŒ–ï¼Œä»¥ä¾¿æµè§ˆå™¨æå‰åšç›¸åº”çš„ä¼˜åŒ–ã€‚ will-change è®¾ç½®ä¸º opacityã€transformã€topã€leftã€bottomã€right å¯ä»¥å°†å…ƒç´ æå‡ä¸ºåˆæˆå±‚ã€‚ è¿™æ˜¯ä¸€ä¸ªé€šçŸ¥æµè§ˆå™¨transformå±æ€§å°†è¢«æ›´æ”¹çš„ç¤ºä¾‹ï¼š .element { transition: opacity .3s linear; } /* declare changes on the element when the mouse enters / hovers its ancestor */ .ancestor:hover .element { will-change: opacity; } /* apply change when element is hovered */ .element:hover { opacity: .5; } æ˜¯ä¸æ˜¯æœ‰ç‚¹ç¼“å­˜å†…å‘³å„¿äº†ï¼Ÿ å¯æƒœå¹¶éæ‰€æœ‰æµè§ˆå™¨éƒ½æ”¯æŒwill-changeï¼Œä½†æ˜¯å®ƒå‡ºç°å·²ç»æœ‰äº›æ—¶æ—¥äº†ï¼Œå…¼å®¹æ€§è¿™å—Chrome/FireFox/Operaéƒ½æ˜¯æ”¯æŒçš„ã€‚ ä½¿ç”¨ å¦‚æœä½¿ç”¨JSæ·»åŠ will-change, äº‹ä»¶æˆ–åŠ¨ç”»å®Œæ¯•ï¼Œä¸€å®šè¦åŠæ—¶remove. æ¯”æ–¹è¯´ç‚¹å‡»æŸä¸ªæŒ‰é’®ï¼Œå…¶ä»–æŸä¸ªå…ƒç´ è¿›è¡ŒåŠ¨ç”»ã€‚ç‚¹å‡»æŒ‰é’®(click)ï¼Œè¦å…ˆæŒ‰ä¸‹(mousedown)å†æŠ¬èµ·æ‰å‡ºå‘ã€‚å› æ­¤ï¼Œå¯ä»¥mousedownæ—¶å€™æ‰“å£°æ‹›å‘¼, åŠ¨ç”»ç»“æŸè‡ªå¸¦å›è°ƒï¼Œäºæ˜¯ï¼ˆç¤ºæ„ï¼Œä¸è¦åœ¨æ„ç»†èŠ‚ï¼‰ï¼š dom.onmousedown = function() { target.style.willChange = 'transform'; }; dom.onclick = function() { // targetåŠ¨ç”»å“”å“©å“”å“©... }; target.onanimationend = function() { // åŠ¨ç”»ç»“æŸå›è°ƒï¼Œç§»é™¤will-change this.style.willChange = 'auto'; }; æ³¨æ„ï¼š ä¸èƒ½è¿‡åº¦ä½¿ç”¨ + è¦èŠ‚åˆ¶ä½¿ç”¨ + ä¸èƒ½è¿‡æ—©ä½¿ç”¨will-changeï¼ˆå› ä¸ºä¼šæ¶ˆè€—å†…å­˜ï¼‰ è€Œä¸”ä»»ä½•å¸¦æœ‰ position: fixed æˆ–è€… position: absolute çš„å­å…ƒç´ å°†ä¼šç›¸å¯¹äºè®¾ç½®äº† will-change: transform çš„å…ƒç´ è¿›è¡Œç›¸å¯¹å®šä½ã€‚æ‰€ä»¥åœ¨ä½ ä½¿ç”¨çš„æ—¶å€™éœ€è¦ç¡®ä¿è¿™ç§æ„æ–™ä¹‹å¤– containing blockä¸ä¼šå¯¹ä½ é€ æˆå½±å“ï¼ˆç±»ä¼¼äºä½ è¦å¯¹å­å…ƒç´ ä½¿ç”¨ç»å¯¹å®šä½ï¼Œçˆ¶å…ƒç´ ä¸è®¾ç½®ç›¸å¯¹å®šä½ï¼Œä½†æ˜¯çˆ¶å…ƒç´ å¦‚æœä½¿ç”¨transformå’Œwill-changeéƒ½ä¼šå¯¼è‡´å­å…ƒç´ æŒ‰ç…§çˆ¶å…ƒç´ çš„ä½ç½®æ¥å®šä½ï¼‰ æ€§èƒ½ç›‘æ§+åˆæˆå±‚æ•°é‡æŸ¥çœ‹å¯¹äºæ€§èƒ½ç›‘æ§æ¥è¯´ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥ä½¿ç”¨æµè§ˆå™¨è‡ªå¸¦çš„ Performance API æ¥å®ç°è¿™ä¸ªåŠŸèƒ½ã€‚ æˆ‘ä»¬åªéœ€è¦è°ƒç”¨ performance.getEntriesByType(&#39;navigation&#39;) äº¦æˆ–è€…å†å¼€å‘è€…æ¨¡å¼ä¸‹ï¼ˆF12ï¼‰æŸ¥çœ‹performanceæ  ä½¿ç”¨ Chrome çš„ DevTools å¯ä»¥æ–¹ä¾¿åœ°æŸ¥çœ‹é¡µé¢çš„åˆæˆå±‚æ•°é‡é€‰æ‹© â€œMore tools -&gt; Layersâ€ ä½†æ˜¯å®é™…ä¸Šé’ˆå¯¹ä¸åŒç§»åŠ¨ç«¯ï¼ˆioså’Œå®‰å“ï¼‰ä½¿ç”¨ä¸åŒçš„æµè§ˆå™¨ï¼Œå¯èƒ½ä¸æœ¬åœ°ç”µè„‘ä¸Šè°ƒè¯•æ—¶äº§ç”Ÿçš„åˆæˆå±‚æ•°é‡ä¸åŒï¼Œè¿™æ˜¯æ‰‹æœºæµè§ˆå™¨çš„è‡ªå¸¦çš„å±‚å‹ç¼©ç­–ç•¥ä¸åŒè€Œå¯¼è‡´çš„ å±‚çˆ†ç‚¸ç”±äºæŸäº›åŸå› å¯èƒ½å¯¼è‡´äº§ç”Ÿå¤§é‡ä¸åœ¨é¢„æœŸå†…çš„åˆæˆå±‚ï¼ˆä¹Ÿå°±æ˜¯ä¸Šæ–¹æ‰€è°ˆåŠçš„å¤åˆå±‚ï¼‰ï¼Œè™½ç„¶æœ‰æµè§ˆå™¨çš„å±‚å‹ç¼©æœºåˆ¶ï¼Œä½†æ˜¯ä¹Ÿæœ‰å¾ˆå¤šæ— æ³•è¿›è¡Œå‹ç¼©çš„æƒ…å†µï¼Œè¿™å°±å¯èƒ½å‡ºç°å±‚çˆ†ç‚¸çš„ç°è±¡ï¼ˆç®€å•ç†è§£å°±æ˜¯ï¼Œå¾ˆå¤šä¸éœ€è¦æå‡ä¸ºåˆæˆå±‚çš„å…ƒç´ å› ä¸ºæŸäº›ä¸å½“æ“ä½œæˆä¸ºäº†åˆæˆå±‚ï¼‰ã€‚ é¦–å…ˆå›é¡¾ä¸€ä¸‹å±‚çš„åˆ›å»ºæ ‡å‡† ä»ç›®å‰æ¥è¯´ï¼Œæ»¡è¶³ä»¥ä¸‹ä»»æ„æƒ…å†µä¾¿ä¼šåˆ›å»ºå±‚ï¼š1ã€3D æˆ–é€è§†å˜æ¢(perspective transform) CSS å±æ€§2ã€ä½¿ç”¨åŠ é€Ÿè§†é¢‘è§£ç çš„ å…ƒç´ 3ã€æ‹¥æœ‰ 3D (WebGL) ä¸Šä¸‹æ–‡æˆ–åŠ é€Ÿçš„ 2D ä¸Šä¸‹æ–‡çš„ å…ƒç´ 4ã€æ··åˆæ’ä»¶(å¦‚ Flash)5ã€å¯¹è‡ªå·±çš„ opacity åš CSS åŠ¨ç”»æˆ–ä½¿ç”¨ä¸€ä¸ªåŠ¨ç”» webkit å˜æ¢çš„å…ƒç´ 6ã€æ‹¥æœ‰åŠ é€Ÿ CSS è¿‡æ»¤å™¨çš„å…ƒç´ 7ã€å…ƒç´ æœ‰ä¸€ä¸ªåŒ…å«å¤åˆå±‚çš„åä»£èŠ‚ç‚¹(æ¢å¥è¯è¯´ï¼Œå°±æ˜¯ä¸€ä¸ªå…ƒç´ æ‹¥æœ‰ä¸€ä¸ªå­å…ƒç´ ï¼Œè¯¥å­å…ƒç´ åœ¨è‡ªå·±çš„å±‚é‡Œ)8ã€æœ‰ä¸€ä¸ª Z åæ ‡æ¯”è‡ªå·±å°çš„å…„å¼ŸèŠ‚ç‚¹ï¼Œä¸”è¯¥èŠ‚ç‚¹æ˜¯ä¸€ä¸ªåˆæˆå±‚(æ¢å¥è¯è¯´å°±æ˜¯è¯¥å…ƒç´ åœ¨å¤åˆå±‚çš„ä¸Šå±‚æ¸²æŸ“) è€Œæœ€å®¹æ˜“ä¸ç»æ„é—´äº§ç”Ÿå±‚çˆ†ç‚¸çš„æ˜¯æœ€åä¸€æ¡ï¼š å¦‚æœæœ‰ä¸€ä¸ªå…ƒç´ ï¼Œå®ƒçš„å…„å¼Ÿå…ƒç´ åœ¨å¤åˆå±‚ä¸­æ¸²æŸ“ï¼Œè€Œè¿™ä¸ªå…„å¼Ÿå…ƒç´ çš„z-indexæ¯”è¾ƒå°ï¼Œé‚£ä¹ˆè¿™ä¸ªå…ƒç´ ï¼ˆä¸ç®¡æ˜¯ä¸æ˜¯åº”ç”¨äº†ç¡¬ä»¶åŠ é€Ÿæ ·å¼ï¼‰ä¹Ÿä¼šè¢«æ”¾åˆ°å¤åˆå±‚ä¸­ã€‚ æœ€å¯æ€•çš„æ˜¯ï¼Œæµè§ˆå™¨æœ‰å¯èƒ½ç»™å¤åˆå±‚ä¹‹åçš„æ‰€æœ‰ç›¸å¯¹æˆ–ç»å¯¹å®šä½çš„å…ƒç´ éƒ½åˆ›å»ºä¸€ä¸ªå¤åˆå±‚æ¥æ¸²æŸ“ ä¾‹å­æ¼”ç¤ºhttp://fouber.github.io/test/layer/ å¦å¤–ä¸€ä¸ªä¾‹å­æ¼”ç¤ºï¼š(Bè¢«éšå¼æå‡ä¸ºåˆæˆå±‚) ä½†æ˜¯å¦‚æœè°ƒæ•´ä¸€ä¸‹bçš„ä½ç½® è§£å†³ï¼šäººä¸ºæå‡åŠ¨ç”»å…ƒç´ ï¼ˆå¤åˆå±‚æ ‡ç­¾ï¼‰çš„z-indexï¼Œè®©æµè§ˆå™¨çŸ¥é“è¿™ä¸ªå…ƒç´ çš„å±‚æ’åºï¼Œå°±ä¸ä¼šå¾ˆå‚»åœ°æŠŠå…¶ä»–z-indexæ¯”å®ƒé«˜çš„å…ƒç´ ä¹Ÿå¼„åˆ°å¤åˆå±‚ä¸­äº† è§£å†³å±‚çˆ†ç‚¸æœ€ä½³æ–¹æ¡ˆæ˜¯æ‰“ç ´ overlap çš„æ¡ä»¶ï¼Œä¹Ÿå°±æ˜¯è¯´è®©å…¶ä»–å…ƒç´ ä¸è¦å’Œåˆæˆå±‚å…ƒç´ é‡å ã€‚ç®€å•ç›´æ¥çš„æ–¹å¼ï¼šä½¿ç”¨3Dç¡¬ä»¶åŠ é€Ÿæå‡åŠ¨ç”»æ€§èƒ½æ—¶ï¼Œæœ€å¥½ç»™å…ƒç´ å¢åŠ ä¸€ä¸ªz-indexå±æ€§ï¼Œäººä¸ºå¹²æ‰°åˆæˆçš„æ’åºï¼Œå¯ä»¥æœ‰æ•ˆå‡å°‘chromeåˆ›å»ºä¸å¿…è¦çš„åˆæˆå±‚ï¼Œä¹Ÿå°±æ˜¯è®©ä»–ä»¬å›å½’æ™®é€šçš„æ¸²æŸ“å±‚ï¼Œæå‡æ¸²æŸ“æ€§èƒ½ï¼Œç§»åŠ¨ç«¯ä¼˜åŒ–æ•ˆæœå°¤ä¸ºæ˜æ˜¾ã€‚ æˆ–è€…æŠŠåˆæˆå±‚çš„äº§ç”ŸåŸå› æ¶ˆé™¤æ‰ï¼ˆåœ¨éå†å…ƒç´ ä¸­æ³¨æ„ä¼šå¼•èµ·å±‚çˆ†çš„æ ·å¼ï¼‰ å±‚å‹ç¼©å› ä¸ºåˆæˆå±‚æœ‰å¾ˆå¤šç§æƒ…å†µä¸‹éƒ½å¯ä»¥äº§ç”Ÿï¼Œç”šè‡³ä¸ç»æ„é—´äº§ç”Ÿ ï¼ˆoverlapï¼‰ï¼Œè¿™ä¸¥é‡å½±å“åˆ°cpuæ€§èƒ½å’Œå†…å­˜èµ„æºï¼Œæµè§ˆå™¨ä¹Ÿè€ƒè™‘åˆ°è¿™ä¸€ç‚¹ï¼Œæ‰€ä»¥æµè§ˆå™¨æœ‰å®ƒè‡ªå·±çš„å±‚å‹ç¼©ç­–ç•¥ï¼ˆæ‰€ä»¥å¯èƒ½äº§ç”Ÿå±‚çˆ†ç‚¸çš„æ—¶å€™ï¼Œå¯èƒ½å¹¶æ²¡æœ‰äº§ç”Ÿï¼Œå› ä¸ºæµè§ˆå™¨å¯¹å…¶è¿›è¡Œäº†å±‚å‹ç¼©ï¼‰ æ¯”å¦‚ä¸Šé¢çš„å±‚çˆ†ç‚¸ä¾‹å­http://fouber.github.io/test/layer/ï¼Œå®ƒåœ¨Chrome 94 Releases ç‰ˆæœ¬è¢«ä¼˜åŒ–äº†ã€‚ï¼ˆæˆ‘ç›®å‰æ—¶Chrome 96ï¼‰æ‰€ä»¥å±‚å‹ç¼©ç»™å¾—çœ‹æµè§ˆå™¨ç‰ˆæœ¬ å½“ç„¶ï¼Œæµè§ˆå™¨ä¹Ÿä¸æ˜¯ä¸‡èƒ½çš„ï¼Œä¹Ÿæœ‰æ— æ³•è¿›è¡Œå±‚å‹ç¼©çš„æƒ…å†µï¼Œæ— æ³•è¿›è¡Œå±‚å‹ç¼©çš„æƒ…å†µï¼šhttps://fed.taobao.org/blog/taofed/do71ct/performance-composite/ åœ¨ä¸Šé¢é“¾æ¥ä¸­æ·˜å®å‰ç«¯å›¢é˜Ÿä¹ŸæåŠåˆ° æ¸²æŸ“ä¼˜åŒ–çš„æ–‡ç« å‚è€ƒé“¾æ¥ å‚è€ƒé“¾æ¥https://github.com/amfe/article/issues/47 å‚è€ƒé“¾æ¥:https://www.w3cplus.com/css3/introduction-css-will-change-property.html å‚è€ƒé“¾æ¥https://www.sitepoint.com/introduction-to-hardware-acceleration-css-animations/ å‚è€ƒé“¾æ¥https://www.cnblogs.com/qiqi715/p/10207568.html å‚è€ƒé“¾æ¥ï¼ˆæ·˜å®æŠ€æœ¯å›¢é˜Ÿï¼‰https://fed.taobao.org/blog/taofed/do71ct/performance-composite/ å‚è€ƒé“¾æ¥ï¼ˆäº‘éŸ³ä¹æŠ€æœ¯å›¢é˜Ÿï¼‰https://segmentfault.com/a/1190000041197292","categories":[{"name":"å‰ç«¯","slug":"å‰ç«¯","permalink":"https://taylor12138.github.io/categories/%E5%89%8D%E7%AB%AF/"}],"tags":[],"author":"Hello"},{"title":"Canvas","slug":"Canvas","date":"2020-07-30T16:00:00.000Z","updated":"2023-06-11T09:59:24.461Z","comments":true,"path":"2020/07/31/canvas/","link":"","permalink":"https://taylor12138.github.io/2020/07/31/canvas/","excerpt":"","text":"çº¢å®ä¹¦å…³äºCanvasç»˜åˆ¶å›¾å½¢éœ€è¦å…ˆå–å¾—ç»˜å›¾ä¸Šä¸‹æ–‡ let drawing = document.getElementByTagName('canvas'); if(drawing.getContext) { //... } 2Dç»˜å›¾2Dä¸Šä¸‹æ–‡çš„åæ ‡åŸç‚¹ï¼ˆ0ï¼Œ0ï¼‰åœ¨canvasæ ‡ç­¾çš„å·¦ä¸Šè§’ï¼Œxå‘å³å¢é•¿ï¼Œyå‘ä¸‹å¢é•¿ çŸ©å½¢fillRectã€strokeRectã€clearRectæ¥æ”¶4ä¸ªå‚æ•°ï¼Œåˆ†åˆ«ä¸ºxåæ ‡ã€yåæ ‡ã€çŸ©å½¢å®½åº¦ã€é«˜åº¦ fillRect: ç»˜åˆ¶çŸ©å½¢ + å¡«å…… strokeRect: ç»˜åˆ¶éå®æ˜Ÿå¡«å…… clearRect : æ¸…é™¤æŒ‡å®šçš„çŸ©å½¢åŒºåŸŸ if(drawing.getContext) { let context = drawing.getContext(\"2d\"); context.fillStyle = \"#ff000\"; context.fillRect(10, 10, 50, 50) } clearRectæ–¹æ³•å¯ä»¥æ“¦é™¤ç”»å¸ƒä¸­æŸä¸ªåŒºåŸŸï¼Œè®©å…¶å˜å¾—é€æ˜ è·¯å¾„åœ¨ç»˜åˆ¶è·¯å¾„ä¹‹å‰ï¼Œéœ€è¦â€œåˆ›å»ºè·¯å¾„â€ï¼Œç»“æŸä¹‹åå†â€œæç”»è·¯å¾„â€ beginPathï¼šåˆ›å»ºè·¯å¾„ï¼ˆçº¿æ¡ï¼‰ strokeï¼šç”»è·¯å¾„ if(drawing.getContext) { let context = drawing.getContext(\"2d\"); context.beginPath(); //åˆ›å»ºè·¯å¾„ //.. context.stroke();//æç”»è·¯å¾„ } æ–¹æ³•ä¸€ï¼šç”»åˆå§‹ç‚¹å’Œæœ«å°¾ç‚¹ ctx.beginPath(); //æˆ‘è¦å¼€å§‹ç”»ç”»äº† ctx.strokeStyle = 'blue'; ctx.moveTo(80,40); //è·¯å¾„å…ˆåˆå§‹ç‚¹çš„åæ ‡ ctx.lineTo(200,40); //è·¯å¾„å…ˆæœ«å°¾ç‚¹çš„åæ ‡ ctx.stroke(); //æˆ‘ç”»å®Œäº† æ–¹æ³•äºŒï¼šå½“ç„¶ä¹Ÿå¯ä»¥é€šè¿‡ç”»åœ†çš„æ–¹å¼æ¥ç”» arc(x, y, radius, startAngle, endAngle, counterclockwise) xï¼Œyåæ ‡ä¸ºåœ†å¿ƒ radiusä¸ºåŠå¾„ï¼ŒstartAngleå¼€å§‹è§’åº¦ï¼ŒendAngleç»“æŸè§’åº¦ counterclockwiseæ˜¯å¦é€†æ—¶é’ˆè®¡ç®— ctx.arc(x, y, 30, 0, 2 * Math.PI); //ç”»ä¸€ä¸ªåœ† ctx.arc(x, y, 30, 0, Math.PI); //ç”»ä¸€ä¸ªåŠåœ† æ–¹æ³•ä¸‰ï¼šç”»ä¸€ä¸ªå¼§ arcTo(x1,y1,x2,y2,r); å‚æ•° æè¿° x1 ä¸¤åˆ‡çº¿äº¤ç‚¹çš„æ¨ªåæ ‡ã€‚ y1 ä¸¤åˆ‡çº¿äº¤ç‚¹çš„çºµåæ ‡ã€‚ x2 ç¬¬äºŒæ¡åˆ‡çº¿ä¸Šä¸€ç‚¹çš„æ¨ªåæ ‡ã€‚ y2 ç¬¬äºŒæ¡åˆ‡çº¿ä¸Šä¸€ç‚¹çš„çºµåæ ‡ã€‚ r å¼§çš„åŠå¾„ã€‚ å˜æ¢å½“ç„¶æˆ‘ä»¬ä¹Ÿå¯ä»¥åœ¨å…¶ä¸­ä½¿ç”¨æˆ‘ä»¬ç†Ÿæ‚‰çš„è€æœ‹å‹ rorateï¼ˆangleï¼‰ scale(scaleX, scaleY) translate(x, y)ï¼Œæ‰§è¡Œè¿™ä¸ªæ“ä½œä¹‹åï¼ŒåŸæœ¬æˆ‘ä»¬è¦ä»ªä»—çš„(0, 0)çš„åŸç‚¹åæ ‡ï¼Œå˜æˆäº†(x, y) æ‰€æœ‰çš„å˜æ¢ï¼ŒåŒ…æ‹¬fillStyleã€strokeStyleå±æ€§ï¼Œéƒ½ä¼šä¸€ç›´ä¿ç•™åœ¨ä¸Šä¸‹æ–‡ä¸­ï¼Œç›´åˆ°å†æ¬¡ä¿®æ”¹ä»–ä»¬ã€‚è™½ç„¶æ²¡æœ‰åŠæ³•æ˜ç¡®åœ°å°†æ‰€æœ‰ä¹‹éƒ½é‡ç½®ä¸ºé»˜è®¤å€¼ï¼Œä½†æ˜¯æœ‰ä¸¤ä¸ªæ–¹æ³•å¯ä»¥å¸®æˆ‘ä»¬è·Ÿè¸ªå˜åŒ–ï¼šsave()è¢«è°ƒç”¨ä¹‹åï¼Œï¼Œå½“å‰æ—¶åˆ»çš„æ‰€æœ‰è®¾ç½®ä¼šæ”¾åˆ°ä¸€ä¸ªæš‚å­˜æ ˆä¸­ï¼Œä¹‹åè°ƒç”¨ restore()æ–¹æ³•å¯ä»¥å–å‡ºå¹¶æ¢å¤ä¹‹å‰ä¿å­˜çš„è®¾ç½®ã€‚ è®°ä½ä¿å­˜çš„æ˜¯ä¸Šä¸‹æ–‡çš„è®¾ç½®å’Œå˜æ¢ï¼Œå¹¶æ²¡æœ‰ä¿å­˜ä¸Šä¸‹æ–‡çš„å†…å®¹ã€‚ ç»˜åˆ¶å›¾åƒ æˆ–è€…å¯ä»¥ä½¿ç”¨ canvas.toBlob let img = document.imges[0]; context.drawImage(img, 10, 10) drawImage(å›¾åƒ, ç»˜åˆ¶ç›®æ ‡çš„xåæ ‡, ç»˜åˆ¶ç›®æ ‡çš„yåæ ‡) drawImage(å›¾åƒ, ç»˜åˆ¶ç›®æ ‡çš„xåæ ‡, ç»˜åˆ¶ç›®æ ‡çš„yåæ ‡, ç›®æ ‡å®½åº¦, ç›®æ ‡é«˜åº¦) toDataURL è½¬æ¢å›¾ç‰‡ä¸ºdataURLï¼Œä¸€èˆ¬ä½¿ç”¨ä¸ºï¼š canvas.getContent('2d').drawImage(img, 0, 0, widht, height) const dataUrl = canvas.toDataURL('image/png'); ï¼ˆ1ï¼‰usageåœ¨ç”»å¸ƒä¸Šå®šä½å›¾åƒï¼š JavaScript è¯­æ³•ï¼š context.drawImage(img,x,y); åœ¨ç”»å¸ƒä¸Šå®šä½å›¾åƒ context.drawImage(img,x,y,width,height); åœ¨ç”»å¸ƒä¸Šå®šä½å›¾åƒï¼Œå¹¶è§„å®šå›¾åƒçš„å®½åº¦å’Œé«˜åº¦ï¼š context.drawImage(img,sx,sy,swidth,sheight,x,y,width,height); å‰ªåˆ‡å›¾åƒï¼Œå¹¶åœ¨ç”»å¸ƒä¸Šå®šä½è¢«å‰ªåˆ‡çš„éƒ¨åˆ† å‚æ•°å€¼ å‚æ•° æè¿° img è§„å®šè¦ä½¿ç”¨çš„å›¾åƒã€ç”»å¸ƒæˆ–è§†é¢‘ã€‚ sx å¯é€‰ã€‚å¼€å§‹å‰ªåˆ‡çš„ x åæ ‡ä½ç½®ã€‚ sy å¯é€‰ã€‚å¼€å§‹å‰ªåˆ‡çš„ y åæ ‡ä½ç½®ã€‚ swidth å¯é€‰ã€‚è¢«å‰ªåˆ‡å›¾åƒçš„å®½åº¦ã€‚ sheight å¯é€‰ã€‚è¢«å‰ªåˆ‡å›¾åƒçš„é«˜åº¦ã€‚ x åœ¨ç”»å¸ƒä¸Šæ”¾ç½®å›¾åƒçš„ x åæ ‡ä½ç½®ã€‚ y åœ¨ç”»å¸ƒä¸Šæ”¾ç½®å›¾åƒçš„ y åæ ‡ä½ç½®ã€‚ width å¯é€‰ã€‚è¦ä½¿ç”¨çš„å›¾åƒçš„å®½åº¦ï¼ˆä¼¸å±•æˆ–ç¼©å°å›¾åƒï¼‰ã€‚ height å¯é€‰ã€‚è¦ä½¿ç”¨çš„å›¾åƒçš„é«˜åº¦ï¼ˆä¼¸å±•æˆ–ç¼©å°å›¾åƒï¼‰ã€‚ ï¼ˆ2ï¼‰è½¬åŒ–æˆå›¾åƒæˆ–è€…å°†å½“å‰canvasè½¬åŒ–æˆä¸€ä¸ªå›¾åƒ &lt;canvas id=\"canvas\" width=\"5\" height=\"5\">&lt;/canvas> Copy to Clipboard å¯ä»¥ç”¨è¿™æ ·çš„æ–¹å¼è·å–ä¸€ä¸ª data-URL var canvas = document.getElementById(\"canvas\"); var dataURL = canvas.toDataURL(); console.log(dataURL); // \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNby // blAAAADElEQVQImWNgoBMAAABpAAFEI8ARAAAAAElFTkSuQmCC\" æˆ–è®¸ä½ æƒ³è¦è·å–çš„æ˜¯å›¾åƒçš„å¸§æ•°æ® const imageData = ctx.getImageData(0, 0, width, height); const pixelData = new Uint8Array(imageData.data.buffer); æ­¤æ—¶è¿˜èƒ½ç”¨upngè¿›è¡Œå‹ç¼© import UPNG from 'upng-js'; //.... const pngData = UPNG.encode([pixelData], width * scale, height * scale, 256); ï¼ˆ3ï¼‰å‹ç¼©å›¾ç‰‡è´¨é‡var base64 = canvas.toDataURL('image/jpeg', quality); type å¯é€‰ å›¾ç‰‡æ ¼å¼ï¼Œé»˜è®¤ä¸º image/png encoderOptions å¯é€‰ åœ¨æŒ‡å®šå›¾ç‰‡æ ¼å¼ä¸º image/jpeg æˆ– image/webpçš„æƒ…å†µä¸‹ï¼Œå¯ä»¥ä» 0 åˆ° 1 çš„åŒºé—´å†…é€‰æ‹©å›¾ç‰‡çš„è´¨é‡ã€‚å¦‚æœè¶…å‡ºå–å€¼èŒƒå›´ï¼Œå°†ä¼šä½¿ç”¨é»˜è®¤å€¼ 0.92ã€‚å…¶ä»–å‚æ•°ä¼šè¢«å¿½ç•¥ã€‚ Chromeæ”¯æŒâ€œimage/webpâ€ç±»å‹ã€‚ ï¼ˆ4ï¼‰è·å–å›¾åƒä¿¡æ¯CanvasRenderingContext2D.getImageData() è¿”å›ä¸€ä¸ªImageDataå¯¹è±¡ï¼Œç”¨æ¥æè¿° canvas åŒºåŸŸéšå«çš„åƒç´ æ•°æ®ï¼Œè¿™ä¸ªåŒºåŸŸé€šè¿‡çŸ©å½¢è¡¨ç¤ºï¼Œèµ·å§‹ç‚¹ä¸º(sx, sy)ã€å®½ä¸ºswã€é«˜ä¸ºshã€‚ è¯­æ³• ctx.getImageData(sx, sy, sw, sh);Copy to Clipboard å‚æ•° sx å°†è¦è¢«æå–çš„å›¾åƒæ•°æ®çŸ©å½¢åŒºåŸŸçš„å·¦ä¸Šè§’ x åæ ‡ã€‚ sy å°†è¦è¢«æå–çš„å›¾åƒæ•°æ®çŸ©å½¢åŒºåŸŸçš„å·¦ä¸Šè§’ y åæ ‡ã€‚ sw å°†è¦è¢«æå–çš„å›¾åƒæ•°æ®çŸ©å½¢åŒºåŸŸçš„å®½åº¦ã€‚ sh å°†è¦è¢«æå–çš„å›¾åƒæ•°æ®çŸ©å½¢åŒºåŸŸçš„é«˜åº¦ã€‚ ï¼ˆ5ï¼‰ç”»ä¸€ä¸ªåœ†å¹¶ä¸”å¡å…¥å›¾åƒctx.save(); ctx.beginPath(); ctx.arc(x + radius, y + radius, radius, 0, 2 * Math.PI); // ç”»ä¸€ä¸ªåœ† ctx.closePath(); ctx.clip(); ctx.drawImage(userAvator, x, y, radius * 2, radius * 2); ï¼ˆ6ï¼‰canvasåœ¨é«˜æ¸…å±å¹•çš„ç»˜åˆ¶ç”±äº canvas ä¸æ˜¯çŸ¢é‡å›¾ï¼Œè€Œæ˜¯åƒå›¾ç‰‡ä¸€æ ·æ˜¯ä½å›¾æ¨¡å¼çš„ã€‚é«˜ dpi æ˜¾ç¤ºè®¾å¤‡æ„å‘³ç€æ¯å¹³æ–¹è‹±å¯¸æœ‰æ›´å¤šçš„åƒç´ ã€‚ä¹Ÿå°±æ˜¯è¯´äºŒå€å±ï¼Œæµè§ˆå™¨å°±ä¼šä»¥2ä¸ªåƒç´ ç‚¹çš„å®½åº¦æ¥æ¸²æŸ“ä¸€ä¸ªåƒç´ ï¼Œè¯¥ canvas åœ¨ Retina å±å¹•ä¸‹ç›¸å½“äºå æ®äº†2å€çš„ç©ºé—´ï¼Œç›¸å½“äºå›¾ç‰‡è¢«æ”¾å¤§äº†ä¸€å€ï¼Œå› æ­¤ç»˜åˆ¶å‡ºæ¥çš„å›¾ç‰‡æ–‡å­—ç­‰ä¼šå˜æ¨¡ç³Šã€‚ æˆ‘ä»¬å¯ä»¥å…ˆæŠŠæ‰€æœ‰çš„å®½é«˜æ¯”éƒ½è®¾ç½®æˆ * dpr æ¯”å¦‚è®¾ç½®canvaså®½é«˜ï¼ˆstyleï¼‰ä¸º 320px Ã— 400pxï¼Œåˆ™ const dpr = window.devicePixelRatio || 2; export const MODAL_WIDTH = 320; export const MODAL_HEIGHT = 400; myCanvas.style.width = MODAL_WIDTH + 'px'; myCanvas.style.height = MODAL_HEIGHT + 'px'; myCanvas.width = MODAL_WIDTH * ratio; myCanvas.height = MODAL_HEIGHT * ratio; ç»˜åˆ¶å†…éƒ¨ï¼š æ–¹æ³•1: const context = myCanvas.getContext('2d'); context.font = \"36px Georgia\"; //ä¸€å€å±ä¸‹18pxå­—ä½“ context.fillStyle = \"#999\"; context.fillText(\"æˆ‘æ˜¯æ¸…æ™°çš„æ–‡å­—\", 50*ratio, 50*ratio);// åæ ‡ä½ç½®ä¹˜ä»¥åƒç´ æ¯” æ–¹æ³•2: const context = myCanvas.getContext('2d'); context.scale(ratio, ratio); context.font = \"18px Georgia\"; context.fillStyle = \"#999\"; context.fillText(\"æˆ‘æ˜¯æ¸…æ™°çš„æ–‡å­—\", 50, 50); å°å®æˆ˜ç”»ä¸€ä¸ªåˆ®åˆ®ä¹ &lt;!DOCTYPE html> &lt;html lang=\"en\"> &lt;head> &lt;meta charset=\"UTF-8\" /> &lt;meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\" /> &lt;meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\" /> &lt;title>Document&lt;/title> &lt;style> #ggk { width: 400px; height: 100px; position: relative; left: 50%; transform: translate(-50%, 0); } .jp, canvas { position: absolute; width: 400px; height: 100px; left: 0; top: 0; text-align: center; font-size: 25px; line-height: 100px; color: deeppink; } &lt;/style> &lt;/head> &lt;body> &lt;h1 style=\"text-align: center\">åˆ®åˆ®ä¹&lt;/h1> &lt;div id=\"ggk\"> &lt;div class=\"jp\">ä¸æŠ½å¤§å˜´å·´å­&lt;/div> &lt;canvas id=\"canvas\" width=\"400\" height=\"100\">&lt;/canvas> &lt;script> document.addEventListener(\"selectstart\", function (e) { e.preventDefault(); }); let canvas = document.querySelector(\"#canvas\"); let ctx = canvas.getContext(\"2d\"); ctx.fillStyle = \"darkgray\"; ctx.fillRect(0, 0, 400, 100); let ggkDom = document.querySelector(\"#ggk\"); let jp = document.querySelector(\".jp\"); let isDraw = false; canvas.onmousedown = function () { isDraw = true; }; canvas.onmousemove = function (e) { if (isDraw) { let x = e.pageX - ggkDom.offsetLeft + ggkDom.offsetWidth / 2; console.log(e.pageX, 'pageX', ggkDom.offsetLeft, 'ggkDom.offsetLeft', ggkDom.offsetWidth / 2, 'ggkDom.offsetWidth / 2'); let y = e.pageY - ggkDom.offsetTop; ctx.beginPath(); ctx.arc(x, y, 30, 0, 2 * Math.PI); ctx.globalCompositeOperation = \"destination-out\"; ctx.fill(); ctx.closePath(); } }; document.onmouseup = function () { isDraw = false; }; &lt;/script> &lt;/div> &lt;/body> &lt;/html> globalCompositeOperationï¼šåˆæˆå±æ€§ Canvas 2D API çš„ Canvas.globalCompositeOperation å±æ€§è®¾ç½®è¦åœ¨ç»˜åˆ¶æ–°å½¢çŠ¶æ—¶åº”ç”¨çš„åˆæˆæ“ä½œçš„ç±»å‹ï¼Œå…¶ä¸­ type æ˜¯ç”¨äºæ ‡è¯†è¦ä½¿ç”¨çš„åˆæˆæˆ–æ··åˆæ¨¡å¼æ“ä½œçš„å­—ç¬¦ä¸²ã€‚ å®ƒçš„æ¯ä¸ªå±æ€§å€¼åœ¨å®˜ç½‘é‡Œéƒ½æœ‰å›¾æ–‡ä»‹ç»ï¼šhttps://developer.mozilla.org/zh-CN/docs/Web/API/CanvasRenderingContext2D/globalCompositeOperation å½“ç„¶ï¼Œåœ¨w3cç½‘ä¸Šé¢ä¹Ÿæœ‰ä»‹ç»ï¼šhttps://www.runoob.com/w3cnote/html5-canvas-intro.html source-over: æ—§ç”»å¸ƒå›¾å½¢ç›´æ¥è¦†ç›–æ–°çš„å›¾å½¢ source-in: ä»…ä¼šå‡ºç°æ—§ç”»å¸ƒå›¾å½¢å’Œæ–°çš„å›¾å½¢é‡å çš„éƒ¨åˆ†ï¼ˆå±•ç¤ºæ–°å›¾åƒï¼‰ï¼Œæœ‰ç‚¹åƒ&amp;&amp;çš„æ„Ÿè§‰ source-out: ä»…æ˜¾ç¤ºæ–°å›¾å½¢éƒ¨åˆ†ï¼Œä¸”ä»…ä»…æ–°å›¾å½¢ä¸è€å›¾å½¢æ²¡æœ‰é‡å çš„éƒ¨åˆ†ï¼Œå…¶ä½™éƒ¨åˆ†å…¨éƒ¨é€æ˜ destination-over: æ–°å›¾åƒä¼šåœ¨è€å›¾åƒçš„ä¸‹é¢ã€‚ destination-in: ä»…ä¼šå‡ºç°æ—§ç”»å¸ƒå›¾å½¢å’Œæ–°çš„å›¾å½¢é‡å çš„éƒ¨åˆ†ï¼ˆå±•ç¤ºè€å›¾åƒï¼‰ï¼Œæœ‰ç‚¹åƒ&amp;&amp;çš„æ„Ÿè§‰ destination-out: ä»…æ˜¾ç¤ºè€å›¾å½¢éƒ¨åˆ†ï¼Œä¸”ä»…ä»…è€å›¾å½¢ä¸æ–°å›¾å½¢æ²¡æœ‰é‡å çš„éƒ¨åˆ†ï¼Œå…¶ä½™éƒ¨åˆ†å…¨éƒ¨é€æ˜ Canvas.fill() æ˜¯ Canvas 2D API æ ¹æ®å½“å‰çš„å¡«å……æ ·å¼ï¼Œå¡«å……å½“å‰æˆ–å·²å­˜åœ¨çš„è·¯å¾„çš„æ–¹æ³•ã€‚é‡‡å–éé›¶ç¯ç»•æˆ–è€…å¥‡å¶ç¯ç»•è§„åˆ™ã€‚ Canvas.closePath() æ˜¯ Canvas 2D API å°†ç¬”ç‚¹è¿”å›åˆ°å½“å‰å­è·¯å¾„èµ·å§‹ç‚¹çš„æ–¹æ³•ã€‚å®ƒå°è¯•ä»å½“å‰ç‚¹åˆ°èµ·å§‹ç‚¹ç»˜åˆ¶ä¸€æ¡ç›´çº¿ã€‚å¦‚æœå›¾å½¢å·²ç»æ˜¯å°é—­çš„æˆ–è€…åªæœ‰ä¸€ä¸ªç‚¹ï¼Œé‚£ä¹ˆæ­¤æ–¹æ³•ä¸ä¼šåšä»»ä½•æ“ä½œã€‚ å…¶ä»–å°æ¡ˆä¾‹å–è‡ªèœé¸Ÿæ•™ç¨‹ ä¸€ä¸ªå°å¤ªé˜³ã€ä¸€ä¸ªæ˜¯å°æ—¶é’Ÿæ¡ˆä¾‹ https://www.runoob.com/w3cnote/html5-canvas-intro.html &lt;!DOCTYPE html> &lt;html> &lt;head> &lt;meta charset=\"utf-8\"> &lt;title>èœé¸Ÿæ•™ç¨‹(runoob.com)&lt;/title> &lt;style> body { padding: 0; margin: 0; background-color: rgba(0, 0, 0, 0.1) } canvas { display: block; margin: 200px auto; } &lt;/style> &lt;/head> &lt;body> &lt;canvas id=\"solar\" width=\"300\" height=\"300\">&lt;/canvas> &lt;script> init(); function init(){ let canvas = document.querySelector(\"#solar\"); let ctx = canvas.getContext(\"2d\"); draw(ctx); } function draw(ctx){ requestAnimationFrame(function step(){ drawDial(ctx); //ç»˜åˆ¶è¡¨ç›˜ drawAllHands(ctx); //ç»˜åˆ¶æ—¶åˆ†ç§’é’ˆ requestAnimationFrame(step); }); } /*ç»˜åˆ¶æ—¶åˆ†ç§’é’ˆ*/ function drawAllHands(ctx){ let time = new Date(); let s = time.getSeconds(); let m = time.getMinutes(); let h = time.getHours(); let pi = Math.PI; let secondAngle = pi / 180 * 6 * s; //è®¡ç®—å‡ºæ¥sé’ˆçš„å¼§åº¦ let minuteAngle = pi / 180 * 6 * m + secondAngle / 60; //è®¡ç®—å‡ºæ¥åˆ†é’ˆçš„å¼§åº¦ let hourAngle = pi / 180 * 30 * h + minuteAngle / 12; //è®¡ç®—å‡ºæ¥æ—¶é’ˆçš„å¼§åº¦ drawHand(hourAngle, 60, 6, \"red\", ctx); //ç»˜åˆ¶æ—¶é’ˆ drawHand(minuteAngle, 106, 4, \"green\", ctx); //ç»˜åˆ¶åˆ†é’ˆ drawHand(secondAngle, 129, 2, \"blue\", ctx); //ç»˜åˆ¶ç§’é’ˆ } /*ç»˜åˆ¶æ—¶é’ˆã€æˆ–åˆ†é’ˆã€æˆ–ç§’é’ˆ * å‚æ•°1ï¼šè¦ç»˜åˆ¶çš„é’ˆçš„è§’åº¦ * å‚æ•°2ï¼šè¦ç»˜åˆ¶çš„é’ˆçš„é•¿åº¦ * å‚æ•°3ï¼šè¦ç»˜åˆ¶çš„é’ˆçš„å®½åº¦ * å‚æ•°4ï¼šè¦ç»˜åˆ¶çš„é’ˆçš„é¢œè‰² * å‚æ•°4ï¼šctx * */ function drawHand(angle, len, width, color, ctx){ ctx.save(); ctx.translate(150, 150); //æŠŠåæ ‡è½´çš„è¿œç‚¹å¹³ç§»åˆ°åŸæ¥çš„ä¸­å¿ƒ ctx.rotate(-Math.PI / 2 + angle); //æ—‹è½¬åæ ‡è½´ã€‚ xè½´å°±æ˜¯é’ˆçš„è§’åº¦ ctx.beginPath(); ctx.moveTo(-4, 0); ctx.lineTo(len, 0); // æ²¿ç€xè½´ç»˜åˆ¶é’ˆ ctx.lineWidth = width; ctx.strokeStyle = color; ctx.lineCap = \"round\"; ctx.stroke(); ctx.closePath(); ctx.restore(); } /*ç»˜åˆ¶è¡¨ç›˜*/ function drawDial(ctx){ let pi = Math.PI; ctx.clearRect(0, 0, 300, 300); //æ¸…é™¤æ‰€æœ‰å†…å®¹ ctx.save(); ctx.translate(150, 150); //ä¸€å®šåæ ‡åŸç‚¹åˆ°åŸæ¥çš„ä¸­å¿ƒ ctx.beginPath(); ctx.arc(0, 0, 148, 0, 2 * pi); //ç»˜åˆ¶åœ†å‘¨ ctx.stroke(); ctx.closePath(); for (let i = 0; i &lt; 60; i++){//ç»˜åˆ¶åˆ»åº¦ã€‚ ctx.save(); ctx.rotate(-pi / 2 + i * pi / 30); //æ—‹è½¬åæ ‡è½´ã€‚åæ ‡è½´xçš„æ­£æ–¹å½¢ä» å‘ä¸Šå¼€å§‹ç®—èµ· ctx.beginPath(); ctx.moveTo(110, 0); ctx.lineTo(140, 0); ctx.lineWidth = i % 5 ? 2 : 4; ctx.strokeStyle = i % 5 ? \"blue\" : \"red\"; ctx.stroke(); ctx.closePath(); ctx.restore(); } ctx.restore(); } &lt;/script> &lt;/body> &lt;/html> å…¶ä¸­ç”¨åˆ°äº†saveæ–¹æ³• let canvas = document.querySelector(\"#solar\"); let ctx = canvas.getContext(\"2d\"); ctx.save(); // Canvas 2D API é€šè¿‡å°†å½“å‰çŠ¶æ€æ”¾å…¥æ ˆä¸­ï¼Œä¿å­˜ canvas å…¨éƒ¨çŠ¶æ€çš„æ–¹æ³•ï¼›ä½ å¯ä»¥ç†è§£ä¸ºæ¯ä¸€æ¬¡ç»˜åˆ¶å®Œä¸€ä¸ªé’ˆåè®°å½•ä¸‹æ¥ï¼Œå­˜åˆ°æ ˆä¸­ï¼Œç„¶årestoreçš„æ—¶å€™è¿”å›åˆå§‹çŠ¶æ€ï¼Œä¸å½±å“ä¸Šä¸€ä¸ªé’ˆçš„ç»˜åˆ¶æ•ˆæœ ctx.restore(); //å›åˆ°saveä¹‹å‰çš„çŠ¶æ€ å¯ä»¥çœ‹ä¸€ä¸‹è¿™é‡Œçš„mdnä¾‹å­åŠ æ·±ä¸‹ç†è§£ï¼šhttps://developer.mozilla.org/zh-CN/docs/Web/API/CanvasRenderingContext2D/save è¿˜æœ‰ä¸€ä¸ª ctx.clearRect(0, 0, 300, 300) CanvasRenderingContext2D.clearRect()æ˜¯ Canvas 2D API çš„æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•é€šè¿‡æŠŠåƒç´ è®¾ç½®ä¸ºé€æ˜ä»¥è¾¾åˆ°æ“¦é™¤ä¸€ä¸ªçŸ©å½¢åŒºåŸŸçš„ç›®çš„ã€‚ å¤‡æ³¨ï¼š å¦‚æœæ²¡æœ‰ä¾ç…§ ç»˜åˆ¶è·¯å¾„ çš„æ­¥éª¤ï¼Œä½¿ç”¨ clearRect() ä¼šå¯¼è‡´æ„æƒ³ä¹‹å¤–çš„ç»“æœã€‚è¯·ç¡®ä¿åœ¨è°ƒç”¨ clearRect()ä¹‹åç»˜åˆ¶æ–°å†…å®¹å‰è°ƒç”¨beginPath() ã€‚ å¯ä»¥ç†è§£ä¸ºä¸€ä¸ªå‘½ä»¤è¡Œä¸­ clearçš„æ“ä½œ å‚è€ƒï¼š ä½¿ç”¨Canvasåˆ¶ä½œåˆ®åˆ®ä¹ï¼Œçœ‹çœ‹ä½ èƒ½åˆ®å‡ºä»€ä¹ˆå¥–å“æ¥ï¼Ÿ pixijs1.pixiåŸºç¡€ä½¿ç”¨ PixiJS ï¼Œæˆ‘ä»¬é¦–å…ˆåº”è¯¥åˆ›å»ºä¸€ä¸ª Pixi åº”ç”¨ï¼Œå¹¶ä¸”æ·»åŠ åˆ°å½“å‰çš„èŠ‚ç‚¹å¤„ // åˆ›å»ºä¸€ä¸ªPixi åº”ç”¨ let app = new PIXI.Application({width: 256, height: 256}); // æŠŠ Pixi åº”ç”¨ä¸­åˆ›å»ºå‡ºæ¥çš„ canvas æ·»åŠ åˆ°é¡µé¢ä¸Š document.body.appendChild(app.view); å®¹å™¨ï¼ˆcontainerï¼‰å®¹å™¨æ˜¯ç”¨æ¥è£…è½½å¤šä¸ªæ˜¾ç¤ºå¯¹è±¡çš„ï¼Œ å®ƒå¯ä»¥ç”¨ PIXI.Container() æ–¹æ³•æ¥åˆ›å»ºï¼Œå¯ä»¥æŠŠå®ƒçœ‹æˆä¸€ä¸ªå°ç»„ä»¶ï¼Œé‡Œé¢å¯ä»¥åŒ…è£¹å¤šä¸ªç²¾çµï¼Œæˆ–è€…å…¶ä»–å®¹å™¨ç­‰ ç²¾çµï¼ˆspiriteï¼‰ç²¾çµæ˜¯å¯ä»¥æ”¾åœ¨å®¹å™¨é‡Œçš„ç‰¹æ®Šå›¾åƒå¯¹è±¡ï¼Œ å®ƒå¯ä»¥ç”¨ PIXI.Sprite() æ–¹æ³•æ¥åˆ›å»ºã€‚ç²¾çµæ˜¯ä½ èƒ½ç”¨ä»£ç æ§åˆ¶å›¾åƒçš„åŸºç¡€ã€‚ä½ èƒ½å¤Ÿæ§åˆ¶ä»–ä»¬çš„ä½ç½®ï¼Œå¤§å°ï¼Œå’Œè®¸å¤šå…¶ä»–æœ‰ç”¨çš„å±æ€§æ¥äº§ç”Ÿäº¤äº’å’ŒåŠ¨ç”»ï¼Œæˆ‘è‡ªå·±æ„Ÿè§‰spiriteå¯¹äºpixiå°±åƒdomå¯¹äºdocumentä¸€æ · çº¹ç†ï¼ˆTextureï¼‰ å› ä¸º Pixi ç”¨ WebGL å’Œ GPU å»æ¸²æŸ“å›¾åƒï¼Œæ‰€ä»¥å›¾åƒéœ€è¦è½¬åŒ–æˆ GPU å¯ä»¥å¤„ç†çš„æ ¼å¼ã€‚å¯ä»¥è¢« GPU å¤„ç†çš„å›¾åƒè¢«ç§°ä½œ çº¹ç† ã€‚åœ¨ä½ è®©ç²¾çµæ˜¾ç¤ºå›¾ç‰‡ä¹‹å‰ï¼Œéœ€è¦å°†æ™®é€šçš„å›¾ç‰‡è½¬åŒ–æˆ WebGL çº¹ç†ã€‚ ä¸ºäº†è®©æ‰€æœ‰å·¥ä½œæ‰§è¡Œçš„å¿«é€Ÿæœ‰æ•ˆç‡ï¼ŒPixiä¼šè‡ªåŠ¨ä½¿ç”¨ çº¹ç†ç¼“å­˜ æ¥å­˜å‚¨å’Œå¼•ç”¨æ‰€æœ‰ä½ çš„ç²¾çµéœ€è¦çš„çº¹ç†ã€‚çº¹ç†çš„åç§°å­—ç¬¦ä¸²å°±æ˜¯å›¾åƒçš„åœ°å€ã€‚è¿™æ„å‘³ç€å¦‚æœä½ æœ‰ä»&quot;images/cat.png&quot; åŠ è½½çš„å›¾åƒ(æ³¨æ„æ˜¯å›¾åƒï¼Œä¸ä¼šæŠŠjsonä¹Ÿç»™ä½ å­˜è¿›æ¥)ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨çº¹ç†ç¼“å­˜ä¸­è¿™æ ·æ‰¾åˆ°ä»–ï¼š PIXI.utils.TextureCache[\"images/logo.png\"]; é‚£è¯¥å¦‚ä½•å°†å®ƒè½¬åŒ–æˆçº¹ç†ï¼Ÿé‚£å°±æ˜¯æ˜¯ç”¨Pixiå·²ç»æ„å»ºå¥½çš„loaderå¯¹è±¡ï¼ˆä¸‹æ–¹æœ‰loaderçš„ä½¿ç”¨ï¼‰,é€šè¿‡loaderåŠ è½½è¿‡çš„å›¾ç‰‡ï¼Œéƒ½å¯ä»¥åœ¨PIXI.utils.TextureCacheä¸­æ‰¾åˆ° PIXI.Application ä¼šè‡ªåŠ¨é€‰æ‹©ä½¿ç”¨ Canvas æˆ–è€…æ˜¯ WebGL æ¥æ¸²æŸ“å›¾å½¢ï¼Œè¿™å–å†³äºæ‚¨çš„æµè§ˆå™¨æ”¯æŒæƒ…å†µ æˆ‘ä»¬é€šå¸¸ä½¿ç”¨Pixiæä¾›çš„Applicationæ–¹æ³•æ¥åˆ›å»ºä¸€ä¸ªå®ä¾‹åº”ç”¨ï¼ˆappï¼‰ï¼Œå®ƒèƒ½è‡ªåŠ¨åˆ›å»ºæˆ‘ä»¬ç­‰ä¸‹è®²åˆ°çš„rendererï¼Œticker å’Œcontainerã€loader æ³¨æ„ï¼špixiä»v3åˆ°v5ï¼Œå†åˆ°v7ï¼Œå…³äºloaderçš„è¯­æ³•å˜åŠ¨å¾ˆå¤šï¼Œå¤§å®¶éœ€è¦æ³¨æ„ç½‘ä¸Šå­¦ä¹ çš„è¯­æ³•æ˜¯å“ªä¸ªç‰ˆæœ¬çš„ï¼Œæ¯”å¦‚v5æ˜¯æ²¡æœ‰çš„loaderæ˜¯æ²¡æœ‰onæ¥ç›‘å¬äº‹ä»¶çš„ï¼Œv7ç”šè‡³æ²¡æœ‰loader Application option: autoStart å¸ƒå°”å€¼ default é€‰ä¿®çš„æ„å»ºå®Œæˆåè‡ªåŠ¨å¼€å§‹æ¸²æŸ“ã€‚ æ³¨æ„ï¼šå°†æ­¤å‚æ•°è®¾ç½®ä¸º false ä¸ä¼šåœæ­¢å…±äº«ä»£ç ï¼Œå³ä½¿æ‚¨å°† options.sharedTicker è®¾ç½®ä¸º true ä»¥é˜²å®ƒå·²ç»å¯åŠ¨ã€‚è‡ªå·±é˜»æ­¢å§ã€‚ width æ•°å­— é€‰ä¿®çš„æ¸²æŸ“å™¨è§†å›¾çš„å®½åº¦ã€‚ height æ•°å­— é€‰ä¿®çš„æ¸²æŸ“å™¨è§†å›¾çš„é«˜åº¦ã€‚ view HTMLç”»å¸ƒå…ƒç´  é€‰ä¿®çš„ç”¨ä½œè§†å›¾çš„ç”»å¸ƒï¼Œå¯é€‰ã€‚ transparent å¸ƒå°”å€¼ False é€‰ä¿®çš„å¦‚æœæ¸²æŸ“è§†å›¾æ˜¯é€æ˜çš„ã€‚ autoDensity å¸ƒå°”å€¼ False é€‰ä¿®çš„ä»¥ CSS åƒç´ ä¸ºå•ä½è°ƒæ•´æ¸²æŸ“å™¨è§†å›¾çš„å¤§å°ï¼Œä»¥å…è®¸ 1 ä»¥å¤–çš„åˆ†è¾¨ç‡ã€‚ antialias å¸ƒå°”å€¼ False é€‰ä¿®çš„è®¾ç½®æŠ—é”¯é½¿ preserveDrawingBuffer å¸ƒå°”å€¼ False é€‰ä¿®çš„å¯ç”¨ç»˜å›¾ç¼“å†²åŒºä¿å­˜ï¼Œå¦‚æœæ‚¨éœ€è¦åœ¨ WebGL ä¸Šä¸‹æ–‡ä¸­è°ƒç”¨ toDataUrlï¼Œè¯·å¯ç”¨æ­¤åŠŸèƒ½ã€‚ resolution æ•°å­— 1 é€‰ä¿®çš„æ¸²æŸ“å™¨çš„åˆ†è¾¨ç‡/è®¾å¤‡åƒç´ æ¯”ï¼Œè§†ç½‘è†œå°†ä¸º 2ï¼Œç§»åŠ¨ç«¯ä¸€èˆ¬è¦æ ¹æ®window.devicePixelRatio æ¥ã€‚ forceCanvas å¸ƒå°”å€¼ False é€‰ä¿®çš„é˜»æ­¢é€‰æ‹© WebGL æ¸²æŸ“å™¨ï¼Œå³ä½¿å­˜åœ¨ï¼Œæ­¤é€‰é¡¹ä»…åœ¨ä½¿ç”¨pixi.js-legacyæˆ–@pixi/canvas-rendereræ¨¡å—æ—¶å¯ç”¨ï¼Œå¦åˆ™å°†è¢«å¿½ç•¥ã€‚ backgroundColor æ•°å­— 0x000000 é€‰ä¿®çš„æ¸²æŸ“åŒºåŸŸçš„èƒŒæ™¯é¢œè‰²ï¼ˆå¦‚æœä¸é€æ˜åˆ™æ˜¾ç¤ºï¼‰ã€‚ clearBeforeRender å¸ƒå°”å€¼ True é€‰ä¿®çš„è¿™ä¼šè®¾ç½®æ¸²æŸ“å™¨æ˜¯å¦ä¼šåœ¨æ–°çš„æ¸²æŸ“é€šé“ä¹‹å‰æ¸…é™¤ç”»å¸ƒã€‚ powerPreference ç»†ç»³ é€‰ä¿®çš„ä¼ é€’ç»™ webgl ä¸Šä¸‹æ–‡çš„å‚æ•°ï¼Œå¯¹äºå…·æœ‰åŒæ˜¾å¡çš„è®¾å¤‡è®¾ç½®ä¸ºâ€œé«˜æ€§èƒ½â€ã€‚ï¼ˆä»…é™ WebGLï¼‰ã€‚ sharedTicker å¸ƒå°”å€¼ False é€‰ä¿®çš„trueä½¿ç”¨ PIXI.Ticker.sharedï¼Œfalseåˆ›å»ºæ–°çš„ä»£ç ã€‚å¦‚æœè®¾ç½®ä¸º falseï¼Œåˆ™æ‚¨æ— æ³•å°†å¤„ç†ç¨‹åºæ³¨å†Œä¸ºåœ¨å…±äº«ä»£ç ä¸Šè¿è¡Œçš„ä»»ä½•å†…å®¹ä¹‹å‰å‘ç”Ÿã€‚ç³»ç»Ÿä»£ç å°†å§‹ç»ˆåœ¨å…±äº«ä»£ç å’Œåº”ç”¨ç¨‹åºä»£ç ä¹‹å‰è¿è¡Œã€‚ sharedLoader å¸ƒå°”å€¼ False é€‰ä¿®çš„trueä½¿ç”¨ PIXI.Loader.sharedï¼Œfalseåˆ›å»ºæ–°çš„ Loaderã€‚ resizeTo çª—å£ | HTMLå…ƒç´  applicationè¿˜æœ‰ä¸ªé”€æ¯çš„æ–¹æ³•ï¼š ï¼ˆremoveViewï¼ŒstageOptionsï¼‰ removeView å¸ƒå°”å€¼ &lt;å¯é€‰&gt; é”™è¯¯çš„ è‡ªåŠ¨ä» DOM ä¸­ç§»é™¤ç”»å¸ƒã€‚ stageOptions å¯¹è±¡ | å¸ƒå°”å€¼ &lt;å¯é€‰&gt; é€‰é¡¹å‚æ•°ã€‚å¸ƒå°”å€¼å°†è¡¨ç°å¾—å¥½åƒæ‰€æœ‰é€‰é¡¹éƒ½å·²è®¾ç½®ä¸ºè¯¥å€¼ stageOptions.children å¸ƒå°”å€¼ &lt;å¯é€‰&gt; é”™è¯¯çš„ å¦‚æœè®¾ç½®ä¸º trueï¼Œæ‰€æœ‰çš„å­©å­ä¹Ÿå°†è°ƒç”¨ä»–ä»¬çš„ destroy æ–¹æ³•ã€‚â€™stageOptionsâ€™ å°†ä¼ é€’ç»™é‚£äº›è°ƒç”¨ã€‚ stageOptions.texture å¸ƒå°”å€¼ &lt;å¯é€‰&gt; é”™è¯¯çš„ å¦‚æœ stageOptions.children è®¾ç½®ä¸º trueï¼Œåˆ™ä»…ç”¨äºå­ Spritesã€‚å®ƒæ˜¯å¦åº”è¯¥ç ´åå­ç²¾çµçš„çº¹ç† stageOptions.baseTexture å¸ƒå°”å€¼ &lt;å¯é€‰&gt; é”™è¯¯çš„ å¦‚æœ stageOptions.children è®¾ç½®ä¸º trueï¼Œåˆ™ä»…ç”¨äºå­ Spritesã€‚å®ƒæ˜¯å¦åº”è¯¥ç ´åå­ç²¾çµçš„åŸºç¡€çº¹ç† app.destroy(true, {}); applicationæ»‘åŠ¨é—®é¢˜ï¼š // å¯æ»‘åŠ¨ app.renderer.view.style.touchAction = 'auto'; app.renderer.plugins.interaction.autoPreventDefault = false; 2.loaderç±»ä¼¼äºthreejsçš„loaderï¼Œthreejsçš„loaderç§ç±»ç¹å¤šï¼Œä½†æ˜¯pixijsçš„loaderåªæœ‰ä¸€ç§ï¼Œæ˜¯ä¸€ä¸ªç”¨äºåŠ è½½èµ„æºçš„ä¸œè¥¿ï¼Œç”± Chad Engler ä» Resource Loader æ´¾ç”Ÿè€Œæ¥ï¼Œç”¨äºåŠ è½½èµ„æºï¼Œä¼ å…¥2ä¸ªå‚æ•°åˆ™å¯ä»¥è®¾ç½®åˆ«å import * as PIXI from 'pixi.js'; const loader = new PIXI.Loader(); loader.add('bunny', 'data/bunny.png') .add('images/logo.png') .add('spaceship', 'assets.json') .add(\"logo\", \"images/logo.png\") .load(init); function init((loader, resources)) { // ä»¥æŒ‡å®šåç¨±çš„æ–¹å¼å»å–ç”¨ Texture Cache var sprite = new PIXI.Sprite(loader.resources.logo.texture); var sprite = new PIXI.Sprite(resources.logo.texture); //æˆ–è€…è¿™æ · var sprite2 = new PIXI.Sprite(loader.resources['spaceship'].texture); } addä¹Ÿå¯ä»¥ä¼ å…¥æ•°ç»„ let app = new PIXI.Application({ width: 256, height: 256 }); app.loader .add([ \"images/imageOne.png\", \"images/imageTwo.png\", \"images/imageThree.png\" ]) .load((loader, res) => { console.log(loader === app.loader) //true }); å…³äºloaderè¿˜æœ‰ä¸€äº›ç›‘å¬äº‹ä»¶ //å¯å–å¾—ä¸‹è¼‰é€²åº¦ loader.onProgress.add((e) => { }); //è¼‰å…¥æª”æ¡ˆéŒ¯èª¤æ™‚ loader.onError.add((target, e, error) => { }); //æ¯ä¸€æ¬¡åŠ è½½çš„å›è°ƒ loader.onLoad.add((e, target) => { }); //å…¨éƒ¨åŠ è½½å®Œæˆåå›è°ƒ loader.onComplete.add(() => { }); V7 and loaderpixiå›¢é˜Ÿä¸€ç›´æƒ³è¦åˆ é™¤loaderï¼Œå› ä¸ºå®ƒçš„é—ç•™æ–¹æ³•ï¼ˆä¾‹å¦‚ï¼ŒXMLHttpRequestï¼‰ï¼Œæ˜¯ä» resource-loader è¡ç”Ÿå‡ºæ¥çš„ï¼ŒLoader æœ€åˆçš„è®¾è®¡çµæ„Ÿä¸»è¦æ˜¯ç”± Flash/AS3 é©±åŠ¨çš„ï¼Œç°åœ¨çœ‹æ¥å·²ç»è¿‡æ—¶äº†ã€‚æˆ‘ä»¬å¸Œæœ›ä»æ–°çš„è¿­ä»£ä¸­è·å¾—ä¸€äº›ä¸œè¥¿ï¼šé™æ€åŠ è½½ã€ä½¿ç”¨ Workers åŠ è½½ã€åå°åŠ è½½ã€åŸºäº Promiseã€æ›´å°‘çš„ç¼“å­˜å±‚ã€‚è¿™æ˜¯ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼Œè¯´æ˜è¿™å°†å¦‚ä½•æ”¹å˜ï¼š import { Loader, Sprite } from 'pixi.js'; const loader = new Loader(); loader.add('background', 'path/to/assets/background.jpg'); loader.load((loader, resources) => { const image = Sprite.from(resources.background.texture); }); ç°åœ¨å˜æˆï¼š import { Assets, Sprite } from 'pixi.js'; const texture = await Assets.load('path/to/assets/background.jpg'); const image = Sprite.from(texture); åˆ é™¤loaderç¼“å­˜èµ„æºæ­£å¸¸æˆ‘ä»¬å°†èµ„æºä»stageç§»é™¤ä¹‹åï¼Œutils.TextureCacheä¾ç„¶ä¼šå­˜åœ¨loaderåŠ è½½è¿‡çš„èµ„æºç¼“å­˜ é€šè¿‡ sprite.destroy() èµ„æºä¾ç„¶å­˜åœ¨ã€‚ çœŸæ­£åˆ é™¤éœ€è¦ï¼š sprite.destroy({texture: true, baseTexture: true}); ç§»é™¤TextureCacheã€BaseTextureCache çº¹ç†ï¼Œå¹¶ä¸”ä¼šä»stageæ¶ˆå¤± è¿˜æœ‰ä¸ªchildrené€‰é¡¹ï¼Œè‹¥ children è®¾å®šä¸º true æ™‚ï¼Œæœƒå°‡ destroy() çš„å…¶ä»–å±¬æ€§å¦‚ texture: true èˆ‡ baseTexture: true å†å‚³å…¥å­ç‰©ä»¶ã€å­å­™ç‰©ä»¶ PIXI.BaseTextureï¼šçº¹ç†å­˜å‚¨è¡¨ç¤ºå›¾åƒçš„ä¿¡æ¯ã€‚æ‰€æœ‰çº¹ç†éƒ½æœ‰ä¸€ä¸ªåŸºç¡€çº¹ç†ã€‚ PIXI.Textureï¼šçº¹ç†å­˜å‚¨è¡¨ç¤ºå›¾åƒæˆ–å›¾åƒçš„ä¸€éƒ¨åˆ†çš„ä¿¡æ¯ã€‚å®ƒä¸èƒ½ç›´æ¥æ·»åŠ åˆ°æ˜¾ç¤ºåˆ—è¡¨ä¸­ã€‚è€Œæ˜¯å°†å…¶ç”¨ä½œ Sprite çš„çº¹ç†ã€‚å¦‚æœæ²¡æœ‰æä¾›æ¡†æ¶ï¼Œåˆ™ä½¿ç”¨æ•´ä¸ªå›¾åƒã€‚ PIXI.Texture æ˜¯å¯¹ PIXI.BaseTexture çš„å¼•ç”¨ sprite.destroy - å°†é”€æ¯ç²¾çµï¼Œä½¿ PIXI.Texture å’Œ PIXI.BaseTexture ä¿æŒä¸å˜sprite.destroy(true); - å°†ç ´åç²¾çµå’Œ PIXI.Textureï¼›PIXI.BaseTexture ä¿æŒä¸å˜sprite.destroy(true, true); - å°†é”€æ¯ç²¾çµã€PIXI.Texture å’Œ PIXI.BaseTexture é€šå¸¸ï¼Œæ‚¨ä¸å¸Œæœ›æ¯æ¬¡è°ƒç”¨ addSprite() æ—¶éƒ½åˆ›å»º PIXI.Texture å¹¶åœ¨ removeSprite() ä¸­é”€æ¯å®ƒã€‚å³ä½¿è¿™æ˜¯åœ¨ Pixi å†…éƒ¨å¤„ç†çš„å¹¶ä¸”æ²¡æœ‰åˆ›å»ºé‡å¤çš„çº¹ç†ã€‚æå‰åˆ›å»ºä½ çš„çº¹ç†ï¼Œå°†å®ƒä»¬å­˜å‚¨åˆ°æ•°ç»„ä¸­å¹¶åœ¨éœ€è¦æ—¶é€‰æ‹©ä¸€ä¸ªã€‚åœ¨æ²¡æœ‰å…¶ä»–ç²¾çµä½¿ç”¨å®ƒæ—¶é”€æ¯ PIXI.Textureï¼Œå¹¶åœ¨å®Œå…¨å®Œæˆåé”€æ¯ PIXI.BaseTextureã€‚ å¹¶ä¸”é€šå¸¸ä¸å¤ªå»ºè®®é”€æ¯ Textureï¼Œå› ä¸ºï¼šé”€æ¯ PIXI.Texture ä¸ä¼šé‡Šæ”¾å†…å­˜ï¼Œå®ƒåªä¼šä½¿çº¹ç†æ— æ•ˆå¹¶å°†å…¶ä»å›¾åƒç¼“å­˜ä¸­åˆ é™¤ï¼Œå› æ­¤å…¶ä»–ç²¾çµå°†æ— æ³•ä½¿ç”¨å®ƒã€‚æˆ‘çœŸçš„ä¸çŸ¥é“ä»€ä¹ˆæ—¶å€™å¿…é¡»è°ƒç”¨å®ƒ é”€æ¯ PIXI.BaseTexture ä¼šé‡Šæ”¾ç»‘å®šåˆ°å®ƒçš„ WebGL å¯¹è±¡ã€‚ä¸ºæ‚¨ä½¿ç”¨çš„åŠ¨æ€çº¹ç†æˆ–ä¸å†éœ€è¦çš„ä¸€äº›é™æ€è°ƒç”¨å®ƒã€‚ 3.è®¾ç½®ç²¾çµå±æ€§æ¯”å¦‚æˆ‘ä¸Šé¢åŠ è½½äº†ä¸€ä¸ªspriteï¼Œå¯ä»¥è®¾ç½®å¤§å°ã€ç¼©æ”¾ã€ä½ç½® sprite.position.set(20, 20) sprite.x = sprite.x + 10 // å¯ä»¥å¯¹ xã€y çš„æŸä¸€é¡¹å•ç‹¬è®¾ç½® // ç¼©æ”¾ sprite.scale.set(num, num) // å¤§å° sprite.width = sprite.width + 10 // æ—‹è½¬ sprite.rotation += 0.1 mask ä¸º displayObject è®¾ç½®æ©ç ã€‚è’™ç‰ˆæ˜¯ä¸€ç§å¯¹è±¡ï¼Œå®ƒå°†å¯¹è±¡çš„å¯è§æ€§é™åˆ¶ä¸ºåº”ç”¨äºå®ƒçš„è’™ç‰ˆçš„å½¢çŠ¶ã€‚åœ¨ PixiJS ä¸­ï¼Œå¸¸è§„æ©ç å¿…é¡»æ˜¯ PIXI.Graphicsæˆ–PIXI.Spriteå¯¹è±¡ã€‚è¿™å…è®¸åœ¨ç”»å¸ƒä¸­æ›´å¿«åœ°è¿›è¡Œé®ç½©ï¼Œå› ä¸ºå®ƒä½¿ç”¨å½¢çŠ¶å‰ªè£ã€‚ ä½ å¯ä»¥ç›´æ¥ç†è§£ä¸ºå°±æ˜¯è’™ç‰ˆã€‚è£å‰ªçš„æ—¶å€™ç”¨åˆ°å®ƒ import { Graphics, Sprite } from 'pixi.js'; const graphics = new Graphics(); graphics.beginFill(0xFF3300); graphics.drawRect(50, 250, 100, 100); graphics.endFill(); const sprite = new Sprite(texture); sprite.mask = graphics; è®¾ç½®æ–‡æœ¬ + æ–‡æœ¬å±€ä¸­ + æ°”æ³¡å¤–æ¡† // åˆ›å»ºæ–‡æœ¬å¯¹è±¡ const text = new Text('æ‚¨å¥½ï¼Œè¿™æ˜¯ä¸€æ¡å¼¹å¹•æ¶ˆæ¯ï¼', { fontSize: 16, fill: 0xffffff }); text.anchor.set(0.5); // è®¡ç®—æ–‡æœ¬çš„é•¿åº¦ const textWidth = text.width; // åˆ›å»ºå¼¹å¹•æ°”æ³¡å¯¹è±¡ const bubble = new Graphics(); bubble.beginFill(0x000000, 0.8); bubble.drawRoundedRect(0, 0, textWidth + 20, 30, 15); bubble.endFill(); text.position.set(bubble.width / 2, bubble.height / 2); 4.pixijsçš„äº‹ä»¶pixijsçš„ä¸¤ç§æ¸²æŸ“æ¨¡å¼ï¼Œéƒ½ä¸æ˜¯ä»¥domç»“æ„ä¸ºåŸºç¡€ï¼ˆå¯ä»¥è”æƒ³åˆ°canvasï¼‰ï¼Œæ‰€ä»¥éœ€è¦ä½¿ç”¨å®ƒå†…ç½®çš„äº‹ä»¶ï¼š pointerdownï¼šç±»ä¼¼äº mousedownã€‚ pointerupï¼šç±»ä¼¼äº mouseupã€‚ pointeroverï¼šç±»ä¼¼äº mouseoverã€‚ pointeroutï¼šç±»ä¼¼äº mouseoutã€‚ pointermoveï¼šç±»ä¼¼äº mousemoveã€‚ ç°åœ¨æˆ‘ä»¬ç»™spriteæ·»åŠ äº‹ä»¶ // ç¬¬ä¸€æ­¥ï¼šè®¾ç½®å…ƒç´ ä¸ºå¯äº¤äº’çš„ cat.interactive = true; // ç¬¬äºŒéƒ¨ï¼šç›‘å¬å¯¹åº”çš„äº‹ä»¶ cat.addListener('pointerdown', (e) => { cat.alpha = 0.5 //ç±»ä¼¼CSS3æ»¤é•œfilter }); æˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡ä»£ç æ¥è§¦å‘äº‹ä»¶ cat.emit('pointerdown') 5.pixijsç»˜åˆ¶å›¾å½¢ç†Ÿæ‚‰canvasçš„åŒå­¦éƒ½çŸ¥é“ï¼Œcanvaså¯ä»¥åˆ©ç”¨ fillRectã€moveToã€lineToç­‰éšå–œæ‰€æ¬²ç”»ä¸€äº›ç®€å•çš„çŸ¢é‡å›¾å½¢ï¼Œpixijsä¹Ÿä¸ä¾‹å¤– å…¶ä¸­beginFillã€endFillå¯ä»¥ç†è§£ä¸ºcanvasçš„ beginPathã€strokeæ˜¯ä¸€ä¸ªé“ç† //ç”»ä¸€ä¸ªçŸ©å½¢ let rectangle = new PIXI.Graphics(); // å¤–è¾¹æ¡†çš„é¢œè‰² rectangle.lineStyle(4, 0xFF3300, 1); // ç»™çŸ©å½¢çš„å†…éƒ¨å¡«å……é¢œè‰² rectangle.beginFill(0x66CCcc); // ç»˜åˆ¶çŸ©å½¢ã€‚å®ƒçš„å››ä¸ªå‚æ•°æ˜¯ x, y, width, height rectangle.drawRect(0, 0, 64, 64); // ç»“æŸç»˜åˆ¶ rectangle.endFill(); // åˆ›å»ºä¸€ä¸ªåŠå¾„ä¸º32pxçš„åœ† const circle = new Graphics(); circle.beginFill(0xfb6a8f); circle.drawCircle(0, 0, 32); //x\\y\\åŠå¾„ circle.endFill(); 6.ç»™å®¹å™¨æ·»åŠ å…ƒç´ å’Œthreejsä¸€æ ·ï¼ˆthreejsæ˜¯å¾€sceneé‡Œæ·»åŠ ä¸œè¥¿ï¼‰ï¼Œæˆ‘ä»¬åšå¥½çš„å…ƒç´ ï¼Œè¦å¾€PIXIçš„å®¹å™¨ï¼ˆcontainerï¼‰é‡Œé¢åŠ ï¼Œç„¶åå†é€šè¿‡ï¼Œæ‰èƒ½æ˜¾ç¤ºåˆ°å±å¹•ä¸Š app.stageæ˜¯ä¸€ä¸ªpixijsContainerçš„å®ä¾‹ï¼Œä½œä¸ºæœ€åº•å±‚çš„èˆå°(stage)ï¼Œæ‰€æœ‰è¦æ¸²æŸ“çš„å›¾å½¢éƒ½åº”æ”¾åœ¨å®ƒçš„å†…éƒ¨ æˆ‘ä»¬å¯ä»¥é€‰æ‹©ç›´æ¥æ·»åŠ åœ¨pixiçš„app.stageä¸Šï¼Œä¹Ÿå¯ä»¥åˆ›å»ºä¸€ä¸ªè‡ªå®šä¹‰çš„containerï¼Œç„¶åå†æ·»åŠ åˆ°app.stageä¸Šï¼ˆè‡ªå®šä¹‰containerå¥½å¤„åœ¨äºï¼Œæ¯”å¦‚è¯´ä¿®æ”¹containerçš„é€æ˜åº¦ï¼Œä½äºå…¶ä¸­çš„å­èŠ‚ç‚¹ï¼Œéƒ½ä¼šå—åˆ°å½±å“ï¼‰ // è‡ªå®šä¹‰Container const myContainer = new Container(); // ç›¸å¯¹äºæ ¹èŠ‚ç‚¹åç§» myContainer.position.set(40, 40); myContainer.addChild(rectangle); app.stage.addChild(myContainer); document.body.appendChild(app.view); å®é™…ä¸Šè¿™é‡Œçš„app.viewå°±æ˜¯app.renderer.viewï¼Œæ‰“å°å‡ºæ¥æ˜¯ä¸€ä¸ªcanvas 7.æ¸²æŸ“å™¨Rendererapp.rendereræ˜¯ä¸€ä¸ªRendererçš„å®ä¾‹ï¼Œç†Ÿæ‚‰threejsçš„åŒå­¦åº”è¯¥ä¸é™Œç”Ÿï¼Œå¦‚æœWebGL å¯ä»¥ç”¨ï¼Œé‚£ä¹ˆapplicationè‡ªå¸¦çš„å°±æ˜¯ä¸€ä¸ªRendererï¼Œå¦åˆ™ä¸ºä¸€ä¸ªCanvasRendererï¼Œå®ƒå°†åœºæ™¯åŠå…¶æ‰€æœ‰å†…å®¹ç»˜åˆ¶åˆ°æ”¯æŒ WebGL çš„ç”»å¸ƒä¸Šã€‚æ¯å½“æˆ‘ä»¬çš„å…ƒç´ å˜åŠ¨ï¼Œå°±éœ€è¦é‡æ–°æ¸²æŸ“ï¼Œç„¶åæˆ‘ä»¬å°±å¯ä»¥çœ‹åˆ°åŠ¨ç”»æ•ˆæœ renderer PIXI.Renderer | PIXI.CanvasRenderer // æŠŠç”»å¸ƒé‡æ–°æ¸²æŸ“ä¸º500*500å¤§å° app.renderer.resize(500, 500); // æ¸²æŸ“ä¸€ä¸ªå®¹å™¨ const container = new Container(); app.renderer.render(container); é€šè¿‡æ‰“å°rendererçš„typeå±æ€§å¯ä»¥æŸ¥çœ‹ä»–çš„ç±»å‹ console.log(app.renderer.type); æ¸²æŸ“æ¨¡å¼ å–å€¼ UNKNOWN 0 WEBGL 1 CANVAS 2 æ”¹å˜å®¹å™¨(æ¸²æŸ“å™¨)çš„åº•è‰² app.renderer.backgroundColor = 0x061639; è¦æ›´æ”¹ç”»å¸ƒçš„å¤§å°ï¼Œè¯·ä½¿ç”¨rendererçš„resizeæ–¹æ³•ï¼Œå¹¶æä¾›ä»»ä½•æ–°çš„widthå’Œheightå€¼ã€‚ä½†æ˜¯ï¼Œä¸ºäº†ç¡®ä¿ç”»å¸ƒçš„å¤§å°è°ƒæ•´åˆ°ä¸åˆ†è¾¨ç‡åŒ¹é…ï¼Œè¯·å°†autoResizeè®¾ç½®ä¸ºtrueã€‚ app.renderer.autoResize = true; app.renderer.resize(512, 512); 8.TickerTickeræœ‰ç‚¹ç±»ä¼¼å‰ç«¯çš„requestAnimationFrameï¼Œå½“ç„¶å¤§éƒ¨åˆ†æƒ…å†µï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ç”¨ requestAnimationFrameæ¥æ›¿ä»£Ticker åœ¨pixiæºç å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬åœ¨æ³¨å†Œapplicationçš„æ—¶å€™ï¼Œapplicationä¼šåœ¨åˆå§‹åŒ–æ—¶æ³¨å…¥tickeræ’ä»¶ï¼ˆApplication.registerPlugin(TickerPlugin);ï¼‰ ä»–è¿˜ä¼šé»˜è®¤å¸®æˆ‘ä»¬æŠŠautoStartå¹²æˆtrue // è‡ªå®šä¹‰ticker const ticker = new Ticker(); // æ¯æ¬¡å±å¹•åˆ·æ–°é‡æ–°æ¸²æŸ“ï¼Œå¦åˆ™åªä¼šæ¸²æŸ“ç¬¬ä¸€å¸§ ticker.add(() => { chanziAnimate.x += 1; }); function gameLoop() { chanziAnimate.x += 1; renderer.render(stage); // é‡æ–°æ¸²æŸ“,å¦‚æœæ˜¯ä½¿ç”¨applicationåˆå§‹åŒ–ï¼Œå¯ä»¥å¿½ç•¥è¿™ä¸€è¡Œï¼Œå› ä¸ºapplication.tickeråœ¨ä¸æ–­æ‰§è¡Œ requestAnimationFrame(gameLoop); } requestAnimationFrame(gameLoop); å°è¯•ä¸€ä¸‹å§ï½https://codesandbox.io/s/elated-wind-5j60fu?file=/src/MoveDemo.js Tickerå¯ä»¥å®ç°ç®€å•çš„åŠ¨ç”»ï¼Œä½†å¦‚æœæˆ‘ä»¬å¸Œæœ›å®ç°ä¸€äº›å¤æ‚æ•ˆæœï¼Œåˆ™éœ€è¦è‡ªå·±ç¼–å†™å¾ˆå¤šä»£ç ï¼Œè¿™æ—¶å°±å¯ä»¥é€‰æ‹©ä¸€ä¸ªå…¼å®¹pixiçš„åŠ¨ç”»åº“ã€‚å¸‚é¢ä¸Šæ¯”è¾ƒå¸¸è§çš„åŠ¨ç”»åº“æœ‰ï¼šTween.jsï¼ŒTweenMaxï¼ˆå®ƒåŒ…æ‹¬äº†GreenSockåŠ¨ç”»å¹³å°çš„å¤§éƒ¨åˆ†æ ¸å¿ƒåŠŸèƒ½ï¼‰ chatGPT: æ€»çš„æ¥è¯´ï¼ŒTweenMax æ›´åŠ å¼ºå¤§ï¼Œè€Œ TweenJS æ›´åŠ è½»é‡çº§ã€‚TweenMax çš„å­¦ä¹ æ›²çº¿å¯èƒ½ä¼šæ¯” TweenJS æ›´é™¡å³­ï¼Œä½†æ˜¯å®ƒå¯ä»¥æä¾›æ›´å¤šçš„æ§åˆ¶å’ŒåŠŸèƒ½ã€‚å¦‚æœæ‚¨éœ€è¦ä¸€ä¸ªå…¨é¢çš„åŠ¨ç”»åº“ï¼Œæˆ–è€…éœ€è¦åˆ›å»ºå¤æ‚çš„åŠ¨ç”»æ•ˆæœï¼Œé‚£ä¹ˆ TweenMax å¯èƒ½æ˜¯æ›´å¥½çš„é€‰æ‹©ã€‚å¦‚æœæ‚¨åªéœ€è¦ç®€å•çš„ Tween åŠŸèƒ½ï¼Œå¹¶ä¸”å¸Œæœ›ä½¿ç”¨æ›´è½»é‡çº§çš„åº“ï¼Œé‚£ä¹ˆ TweenJS å¯èƒ½æ›´é€‚åˆæ‚¨ã€‚ å¦‚æœä½ ä¸å­˜åœ¨éœ€è¦æŒç»­åŠ¨ç”»æ¸²æŸ“çš„åŠŸèƒ½ï¼Œå¯ä»¥é€‰æ‹©å…³é—­app.tickerçš„å¯åŠ¨ï¼š app.ticker.stop(); //ç­‰åˆ°éœ€è¦æ—¶å†æ¸²æŸ“ï¼š app.render(); å…¶ä»–å›¾ç‰‡åˆæˆå‰ç«¯æœ‰æ—¶ä¼šæŠŠå¤šå¼ å›¾ç‰‡åˆå¹¶æˆä¸€å¼ å›¾ç‰‡ï¼ˆé›ªç¢§å›¾ï¼‰ï¼Œè€Œä¸æ˜¯ä¸€å¼ ä¸€å¼ å»åŠ è½½ã€‚ã€‚é€šè¿‡è®¾ç½®background-positionæ¥æ˜¾ç¤ºä¸åŒçš„å›¾ç‰‡ã€‚pixi.jsä¹Ÿæœ‰ç±»ä¼¼çš„æŠ€æœ¯ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨Texture Packerè½¯ä»¶ï¼ŒæŠŠå¤šå¼ å›¾ç‰‡åˆå¹¶æˆä¸€å¼ å›¾ç‰‡ï¼Œåˆå¹¶çš„åŒæ—¶ï¼Œè½¯ä»¶ä¼šç”Ÿæˆä¸€ä»½jsoné…ç½®æ–‡ä»¶ï¼Œè®°å½•äº†æ¯å¼ å›¾ç‰‡çš„ç›¸å¯¹ä½ç½®ã€‚ å…·ä½“æ•™ç¨‹è§è¿™é‡Œ é¦–å…ˆä¸‹è½½ -&gt; æ‹–åŠ¨æ‰€éœ€å›¾ç‰‡æ–‡ä»¶è‡³texure packerï¼Œä»–å°†ä¼šè‡ªåŠ¨ç”Ÿæˆ åˆ¶ä½œåŠ¨ç”»ï¼š å¤é€‰å³è¾¹çš„å›¾ç‰‡ï¼Œç„¶åç‚¹å‡»é¢„è§ˆåŠ¨ç”»å°±å¯ä»¥çœ‹åˆ°å›¾ç‰‡è¿ç»­èµ·æ¥çš„åŠ¨ç”»æ•ˆæœ ç„¶åç‚¹å‡»å‘å¸ƒç²¾çµè¡¨ å°±ä¼šå¯¹åº”ç”Ÿæˆä¸€ä¸ªjsonæ–‡ä»¶ï¼ˆè®°å½•æ¯ä¸ªå›¾åƒåå­—ã€å¤§å°ã€ä½ç½®ï¼‰å’Œä¸€ä¸ªpngæ–‡ä»¶ï¼ˆé›ªç¢§å›¾ï¼‰ spritesheetSritesheetsï¼šhttps://pixijs.io/guides/basics/sprite-sheets.html ä¸€èˆ¬spritesheetç”¨äºæ˜¯ä¸€å¼ å¤§çš„é›ªç¢§å›¾ï¼ˆpngï¼‰ï¼Œå¹¶ä¸”é…åˆä¸Šä¸€ä¸ªjsonæ–‡ä»¶ï¼Œjsonæ–‡ä»¶è®°å½•äº†é›ªç¢§å›¾æ¯ä¸ªå›¾ç‰‡çš„ä½ç½®ä»¥åŠå…¶ä»–ä¿¡æ¯ import { Application, Container, Sprite, Graphics, Loader, Spritesheet } from 'pixi.js'; // myjsonè®°å½•äº†æ¯å¼ å›¾ç‰‡çš„ç›¸å¯¹ä½ç½® import myjson from './assets/treasureHunter.json'; // mypngé‡Œé¢æœ‰å¤šå¼ å›¾ç‰‡ import mypng from './assets/treasureHunter.png'; const loader = Loader.shared; const app = new Application({ width: 300, height: 300, antialias: true, transparent: false, resolution: 1, backgroundColor: 0x1d9ce0 }); document.body.appendChild(app.view); loader .add('mypng', mypng) .load(setup) function setup() { const texture = loader.resources[\"mypng\"].texture.baseTexture; const sheet = new Spritesheet(texture, myjson); } éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œé€šè¿‡spritesheetåŠ è½½å®Œæˆåï¼Œæœ‰ä¸€äº›å±æ€§æ˜¯ä¸ºç©ºçš„ï¼Œæ‰€ä»¥æ‰€ä»¥æˆ‘ä»¬éœ€è¦ç­‰å¾…åŠ è½½å®Œæˆå»æ‰§è¡Œä¸€äº›æ“ä½œçš„è¯ï¼Œéœ€è¦ç­‰å¾…spritesheetåŠ è½½å®Œæˆåï¼ˆå¼‚æ­¥ï¼‰ï¼Œåœ¨è¿›è¡Œæ“ä½œï¼Œè¿™æ—¶éœ€è¦ç”¨çš„å“¦å®ƒçš„praseæ–¹æ³• sheet.parse((textures) => { // mypngé‡Œé¢çš„ä¸€å¼ å«treasure.pngçš„å›¾ç‰‡ const treasure = new Sprite(textures[\"treasure.png\"]); treasure.position.set(0, 0); // mypngé‡Œé¢çš„ä¸€å¼ å«blob.pngçš„å›¾ç‰‡ const blob = new Sprite(textures[\"blob.png\"]); blob.position.set(100, 100); app.stage.addChild(treasure); app.stage.addChild(blob); }); Texture Packerè¦æ”¶è´¹çš„ï¼Œå…è´¹ç‰ˆå¯èƒ½æœ‰æ°´å°ï¼ˆåˆšå¼€å§‹ä¼šé€ä½ 7å¤©proï¼‰ï¼Œè¿™é‡Œæœ‰ä¸ªå…è´¹ç‰ˆçš„Texture Packerå¯ä»¥çœ‹ä¸€ä¸‹ï¼š http://free-tex-packer.com/download/ AnimatedSpriteå¯ä»¥çœ‹æˆä¸€ä¸ªä¼šåŠ¨çš„Spriteï¼Œpng -&gt; apngï¼›Sprite -&gt; AnimatedSpriteï¼ŒAnimatedSpriteæ¥å—ä¸€ä¸ªå›¾åƒæ•°ç»„ï¼ŒæŒ‰ç…§æ•°ç»„é¡ºåºæ’­æ”¾å›¾åƒï¼Œç„¶åæˆ‘ä»¬å°±å¯ä»¥çœ‹åˆ°â€œåŠ¨èµ·æ¥çš„æ•ˆæœâ€ ä¼ å…¥2ä¸ªå‚æ•° textures autoUpdateï¼Œé»˜è®¤ä¸ºtrueï¼Œé‡‡ç”¨PIXI.Tickeræ¥æ›´æ–°åŠ¨ç”»æ—¶é—´ import { AnimatedSprite, Texture } from 'pixi.js'; const alienImages = [ 'image_sequence_01.png', 'image_sequence_02.png', 'image_sequence_03.png', 'image_sequence_04.png', ]; const textureArray = []; for (let i = 0; i &lt; 4; i++) { const texture = Texture.from(alienImages[i]); textureArray.push(texture); } const animatedSprite = new AnimatedSprite(textureArray); å½“ç„¶ï¼Œä½ ä¹Ÿå¯ä»¥é€‰æ‹©åœ¨å›¾ç‰‡åˆæˆå·¥å…·çš„texurePackeré‡Œï¼Œè®¾ç½®å›¾ç‰‡åç§°ï¼Œè®©ä»–è‡ªåŠ¨å¸®ä½ ç”ŸæˆåŠ¨ç”»ï¼š æ­¤æ—¶é€šè¿‡spritesheetå®ä¾‹åŒ–ç”Ÿæˆçš„ç²¾çµè¡¨ä¸­ï¼Œå¯ä»¥çœ‹åˆ°æœ‰animationså±æ€§ï¼ˆä¸€ä¸ªå›¾ç‰‡é›†æ•°ç»„ï¼‰ï¼Œæˆ‘ä»¬ç›´æ¥æŠŠå®ƒæ”¾åˆ°AnimatedSpriteï¼Œå°±æ˜¯ä¸€ä¸ªåŠ¨ç”»ç²¾çµäº† app.loader.add(\"chanziPng\", chanziPng).load(async (loader, resources) => { const chanziSheet = new PIXI.Spritesheet( resources[\"chanziPng\"].texture, chanzi ); await chanziSheet.parse(() => {}); // åˆ›å»ºåŠ¨ç”»é›ªç¢§ const chanziAnimate = new PIXI.AnimatedSprite( chanziSheet.animations[\"ani\"] ); // è®¾ç½®åŠ¨ç”»æ—¶é—´ chanziAnimate.animationSpeed = 0.05; chanziAnimate.play(); app.stage.addChild(chanziAnimate); }); å°è¯•ä¸€ä¸‹ï¼šhttps://codesandbox.io/s/elated-wind-5j60fu?file=/src/Component.js z-indexæœ‰æ—¶å€™æˆ‘ä»¬éœ€è¦å¯¹ä¸€äº›å…ƒç´ å±‚çº§æ¥å®šä½ï¼Œå†³å®šå…ƒç´ çš„å±‚æ¬¡ä¼˜å…ˆçº§ï¼Œæˆ‘ä»¬å¯ä»¥å…ˆå¼€å¯ PIXI.settings.SORTABLE_CHILDRENï¼šè®¾ç½®å®¹å™¨å±æ€§â€œsortableChildrenâ€çš„é»˜è®¤å€¼ã€‚å¦‚æœè®¾ç½®ä¸º trueï¼Œå®¹å™¨å°†åœ¨è°ƒç”¨ updateTransform() æ—¶æŒ‰ zIndex å€¼å¯¹å…¶å­é¡¹è¿›è¡Œæ’åºï¼Œæˆ–è€…åœ¨è°ƒç”¨ sortChildren() æ—¶æ‰‹åŠ¨æ’åºã€‚ PIXI.settings.SORTABLE_CHILDREN = true; æ­¤æ—¶æˆ‘ä»¬çš„ sprite.zIndex = xx;å°±å¯ä»¥ç”Ÿæ•ˆäº† ä¸€äº›pixiä¾‹å­Run Pixie Run WASTE INVADERS å®å¯æ¢¦å®æˆ˜ï¼ˆé€šè¿‡TexturePackerå®ç°åŠ¨ç”»ï¼‰ ç¢°æ’æ£€æµ‹æ¡ˆä¾‹(é£æœºå¤§æˆ˜å°æ¸¸æˆ) å¦ä¸€ä¸ªé£æœºå¤§æˆ˜github ä¸€äº›èµ„æºç½‘ç«™ï¼š çˆ±ç»™ç½‘ (ç²¾çµå›¾ï¼Œåœºæ™¯å›¾) å‚è€ƒæ–‡ç« PixiJs PixiJS - æœ€å¿«ã€æœ€çµæ´»çš„ 2D WebGL æ¸²æŸ“å¼•æ“ PixiJSåŸºç¡€æ•™ç¨‹ Pixi v7è¿ç§» ä¸€ä¸ªè€ç‰ˆæœ¬çš„pixiæ•™ç¨‹ fabricjsFabric.js æ˜¯ä¸€ä¸ªå¼ºå¤§çš„H5 canvasæ¡†æ¶ï¼Œåœ¨åŸç”Ÿcanvasä¹‹ä¸Šæä¾›äº†äº¤äº’å¼å¯¹è±¡æ¨¡å‹ï¼Œé€šè¿‡ç®€æ´çš„apiå°±å¯ä»¥åœ¨ç”»å¸ƒä¸Šè¿›è¡Œä¸°å¯Œçš„æ“ä½œã€‚å®ƒä¹Ÿæ˜¯ä¸€ä¸ªSVG-to-canvas è§£æå™¨ã€‚","categories":[{"name":"å‰ç«¯","slug":"å‰ç«¯","permalink":"https://taylor12138.github.io/categories/%E5%89%8D%E7%AB%AF/"}],"tags":[],"author":"Hello"},{"title":"finished gitee","slug":"finished gitee","date":"2020-07-06T16:11:42.941Z","updated":"2020-07-06T16:11:42.941Z","comments":true,"path":"2020/07/07/finished-gitee/","link":"","permalink":"https://taylor12138.github.io/2020/07/07/finished-gitee/","excerpt":"","text":"åŸæ¥æ˜¯ä¸ªäººé‚®ç®±çš„è®¾ç½®å¿…é¡»å¾—æ˜¯å…¬å¼€çš„ï¼Œæˆ‘ä¸€ç›´æ˜¯è®¾ç½®ä¸ºprivateï¼Œæå¾—ä¸€ç›´é”™ï¼Œç»ˆäºæå‡ºæ¥äº†ã€‚ ä½†æ˜¯å‘ç°äº†giteeçš„ä¸€ä¸ªç¼ºç‚¹ï¼Œæ¯æ¬¡éƒ¨ç½²å®Œåéƒ½è¦å»ç äº‘æ›´æ–°ä¸€æ¬¡ã€‚ã€‚ã€‚","categories":[],"tags":[],"author":"Hello"},{"title":"CSSé«˜çº§","slug":"CSSé«˜çº§","date":"2020-05-30T16:00:00.000Z","updated":"2022-07-17T08:12:58.281Z","comments":true,"path":"2020/05/31/css-gao-ji/","link":"","permalink":"https://taylor12138.github.io/2020/05/31/css-gao-ji/","excerpt":"","text":"1.å›¾å½¢ç²¾çµå›¾ä¸ºäº†æœ‰æ•ˆå‡å°‘æœåŠ¡å™¨æ¥æ”¶å’Œå‘å°„è¯·æ±‚æ¬¡æ•°ï¼Œæé«˜é€Ÿåº¦å‡ºç°çš„CSSæŠ€æœ¯ã€‚å³å°†ç½‘é¡µå°èƒŒæ™¯å›¾åˆæˆä¸€å¼ å¤§å›¾ã€‚ ä¸»è¦é’ˆå¯¹äºèƒŒæ™¯å›¾ç‰‡ï¼ˆéäº§å“ç±»ç­‰æ›´æ–°æ¢ä»£å›¾ç‰‡ï¼‰ ä¸»è¦ä½¿ç”¨background-position+xå’Œyè½´é…åˆä½¿ç”¨ï¼Œxè½´å‘å³ï¼Œyè½´å‘ä¸‹ background: url()no-repeat -182px 0; //åˆ†åˆ«å¯¹åº”xè½´ï¼Œyè½´,åŸºæœ¬éƒ½æ˜¯è´Ÿå€¼ç¼ºç‚¹ï¼šæ–‡ä»¶å¤§ï¼Œæ”¾å¤§ç¼©å°ä¼šå¤±çœŸï¼Œæ›´æ¢å¤æ‚ å›¾ç‰‡å‹ç¼©ä¼˜åŒ–ç½‘ç«™ï¼š è‡ªåŠ¨ç”Ÿæˆé›ªç¢§å›¾æ ·å¼çš„ç½‘ç«™ï¼šhttp://www.spritecow.com/ ç†ŠçŒ«å‹ç¼©è¾ƒå°‘å›¾ç‰‡ä½“ç§¯ åœ¨çº¿å‹ç¼©ç½‘ç«™ï¼šhttps://tinypng.com/ image è½¬ DataUrIçš„ç½‘å€ï¼šhttp://tool.c7sky.com/datauri/ ä¼ ç»Ÿçš„urlåœ¨æµè§ˆå™¨åœ°å€æ ä¸­è¾“å…¥ï¼Œå¯ä»¥ç›´æ¥å¯¼èˆªåˆ°ç›®æ ‡åœ°å€ï¼›è€Œdata URLåˆ™æ˜¯ä¸€ä¸ªdataçš„urlè¡¨ç°ï¼Œå¯ä»¥ç†è§£ä¸ºç”¨urlä»£è¡¨æ•°æ® æµè§ˆå™¨ä¸ä¼šç¼“å­˜å†…è”å›¾ç‰‡èµ„æºï¼› å…¼å®¹æ€§è¾ƒå·®ï¼Œåªæ”¯æŒie8ä»¥ä¸Šæµè§ˆå™¨ï¼› è¶…è¿‡1000kbçš„å›¾ç‰‡ï¼Œbase64ç¼–ç ä¼šä½¿å›¾ç‰‡å¤§å°å¢å¤§ï¼Œå¯¼è‡´ç½‘é¡µæ•´ä½“ä¸‹è½½é€Ÿåº¦å‡æ…¢ mobifyæœ€æ–°çš„æµ‹è¯•æ•°æ®ï¼šDataURIè¦æ¯”ç®€å•çš„å¤–é“¾èµ„æºè¦æ…¢6å€ã€‚ å‹ç¼©å›¾ç‰‡å¯ä»¥ä½¿ç”¨ç»Ÿä¸€çš„å‹ç¼©å·¥å…· â€” imageminï¼Œé‡Œé¢æä¾›å›¾ç‰‡å‹ç¼©ã€æ¸è¿›å¼å›¾ç‰‡è½¬æ¢ æ¸è¿›å¼å›¾ç‰‡ä¸€å¼€å§‹å°±å†³å®šäº†å¤§å°ï¼Œè€Œä¸åƒBaselineå›¾ç‰‡ä¸€æ ·ï¼Œä¸æ–­åœ°ä»ä¸Šå¾€ä¸‹åŠ è½½ï¼Œä»è€Œé€ æˆå¤šæ¬¡å›æµï¼Œä½†æ¸è¿›å¼å›¾ç‰‡éœ€è¦æ¶ˆè€—CPUå»å¤šæ¬¡è®¡ç®—æ¸²æŸ“ï¼Œè¿™æ˜¯å…¶ä¸»è¦ç¼ºç‚¹ æ›´å¤šå›¾ç‰‡ä¼˜åŒ–æ–¹å¼å¯ä»¥çœ‹https://akarin.dev/2021/11/04/progressive-image-loading/ è¿˜æœ‰nextjså¯¹å›¾ç‰‡ä¼˜åŒ–çš„æ–¹æ¡ˆï¼šhttps://github.com/findxc/blog/issues/68 svg + canvasSVG æŒ‡å¯ä¼¸ç¼©çŸ¢é‡å›¾å½¢ (Scalable Vector Graphics)ï¼ŒåŸºäºå¯æ‰©å±•æ ‡è®°è¯­è¨€XMLï¼ˆè€ï¼‰ï¼ŒSVG å›¾åƒåœ¨æ”¾å¤§æˆ–æ”¹å˜å°ºå¯¸çš„æƒ…å†µä¸‹å…¶å›¾å½¢è´¨é‡ä¸ä¼šæœ‰æ‰€æŸå¤±ã€‚SVGæ˜¯é€šè¿‡DOMæ“ä½œæ¥æ˜¾ç¤ºçš„ã€‚ canvasï¼šcanvas æ˜¯H5æ–°å‡ºæ¥çš„æ ‡ç­¾(æŠ€æœ¯æ¯”è¾ƒæ–°)ã€‚ç”»å¸ƒæ˜¯ä¸€ä¸ªçŸ©å½¢åŒºåŸŸï¼Œæ‚¨å¯ä»¥æ§åˆ¶å…¶æ¯ä¸€åƒç´ ï¼ŒCanvasæ˜¯é€åƒç´ è¿›è¡Œæ¸²æŸ“çš„ï¼Œä¸€æ—¦å›¾å½¢ç»˜åˆ¶å®Œæˆï¼Œå°±ä¸ä¼šç»§ç»­è¢«æµè§ˆå™¨å…³æ³¨ã€‚canvas æ‹¥æœ‰å¤šç§ç»˜åˆ¶è·¯å¾„ã€çŸ©å½¢ã€åœ†å½¢ã€å­—ç¬¦ä»¥åŠæ·»åŠ å›¾åƒçš„æ–¹æ³• SVG &amp; canvasçš„åŒºåˆ«ï¼š SVGä¸ä¾èµ–åˆ†è¾¨ç‡ SVGæ”¯æŒäº‹ä»¶å¤„ç†å™¨ SVGé€‚åˆå¸¦æœ‰å¤§å‹æ¸²æŸ“åŒºåŸŸçš„åº”ç”¨ç¨‹åºï¼ˆåœ°å›¾ï¼‰ SVGå¤æ‚åº¦é«˜ä¼šå‡æ…¢æ¸²æŸ“é€Ÿåº¦ï¼ˆå¯èƒ½ä¼šreflowï¼‰ SVGä¸é€‚åˆæ¸¸æˆåº”ç”¨ ä½†æ˜¯åœ¨å¤§éƒ¨åˆ†åœºæ™¯ä¸­è¢«ï¼ŒSVG å…·æœ‰é‡è¦çš„ä¼˜åŠ¿ï¼Œå®ƒçš„å†…å­˜å ç”¨æ›´ä½ï¼ˆè¿™å¯¹ç§»åŠ¨ç«¯å°¤å…¶é‡è¦ï¼‰ã€æ¸²æŸ“æ€§èƒ½æ›´é«˜ï¼Œå¹¶ä¸”ç”¨æˆ·ä½¿ç”¨æµè§ˆå™¨å†…ç½®çš„ç¼©æ”¾åŠŸèƒ½æ—¶ä¸ä¼šæ¨¡ç³Šã€‚ï¼ˆé¢å‘ä½ç«¯å®‰å“æœºï¼Œç‰¹å®šå›¾è¡¨ï¼Œæ°´çƒå›¾ç­‰ï¼‰ canvasä¾èµ–åˆ†è¾¨ç‡ canvasä¸æ”¯æŒäº‹ä»¶å¤„ç†å™¨ canvasæ–‡æœ¬æ¸²æŸ“èƒ½åŠ›è¾ƒå¼± canvasèƒ½å¤Ÿä»¥pngã€jpgæ ¼å¼ä¿å­˜ç»“æœå›¾åƒ canvasé€‚åˆå›¾åƒå¯†é›†å‹æ¸¸æˆï¼ˆä»–ä¸ä¼šrelfowï¼‰ Canvas æ›´é€‚åˆç»˜åˆ¶å›¾å½¢å…ƒç´ æ•°é‡è¾ƒå¤šï¼ˆè¿™ä¸€èˆ¬æ˜¯ç”±æ•°æ®é‡å¤§å¯¼è‡´ï¼‰çš„å›¾è¡¨ï¼ˆå¦‚çƒ­åŠ›å›¾ã€åœ°ç†åæ ‡ç³»æˆ–å¹³è¡Œåæ ‡ç³»ä¸Šçš„å¤§è§„æ¨¡çº¿å›¾æˆ–æ•£ç‚¹å›¾ç­‰ï¼‰ï¼Œä¹Ÿåˆ©äºå®ç°æŸäº›è§†è§‰ ç‰¹æ•ˆ 2.å­—ä½“å›¾æ ‡iconfontå¸¸ç”¨äºä¸€äº›å°å›¾æ ‡ï¼ˆæ ·å¼ç®€å•ï¼‰ï¼Œå±•ç¤ºçŠ¶æ€æ—¶å›¾æ ‡ï¼Œå®é™…ä¸Šæ˜¯å­—ä½“ ä¼˜ç‚¹1.è½»é‡çº§ï¼Œå¤Ÿå° 2.çµæ´»æ€§ï¼Œå¯æ”¹å¤šç§æ•ˆæœ 3.å‡ ä¹æ”¯æŒæ‰€æœ‰æµè§ˆå™¨ ä¸‹è½½ï¼šç›¸åº”ç½‘ç«™ï¼ˆå¦‚https://icomoon.io/ï¼‰ä¸‹è½½åå¾—åˆ°å‹ç¼©åŒ…ï¼Œè§£å‹åï¼ŒæŠŠä¸‹è½½åŒ…é‡Œçš„fontsæ”¾å…¥é¡µé¢æ ¹ç›®å½•ä¸‹ ä½¿ç”¨ï¼šåœ¨CSSä¸­æ ¹æ®è¯´æ˜å¼•ç”¨å…¨å±€å£°æ˜ï¼Œç„¶åå†åœ¨ä¸ªä½“cssä¸­å†æ¬¡å¼•ç”¨ä½ æƒ³è¦çš„å£°æ˜ï¼ŒåŒæ—¶å¯ä»¥è‡ªå·±è°ƒè‰²å’Œå­—ä½“å¤§å°ï¼ˆfont-sizeï¼‰ è¿™é‡Œä»¥é˜¿é‡Œçš„å›¾æ ‡ä¸ºä¾‹å­ï¼ŒæŠŠé¡¹ç›®æ·»åŠ å¥½ä¹‹åï¼Œæ ¹æ®æ“ä½œhttps://www.iconfont.cn/help/detail?spm=a313x.7781069.1998910419.16&amp;helptype=codeä¸€æ­¥ä¸€æ­¥æ¥ï¼ˆè¿™é‡Œæ˜¯unicodeå¼•ç”¨ï¼‰ï¼Œæ³¨æ„ï¼š**å¤åˆ¶ä»£ç çš„æ—¶å€™ï¼Œä¸€å®šè¦åœ¨urlçš„å€¼ä¸­è¡¥å…… â€œhttp:â€** ï¼ˆä½¿ç”¨bootstrapæ¡†æ¶ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨å…¶å®˜ç½‘ç»™çš„å›¾æ ‡ï¼‰ @font-faceCSS at-rule æŒ‡å®šä¸€ä¸ªç”¨äºæ˜¾ç¤ºæ–‡æœ¬çš„è‡ªå®šä¹‰å­—ä½“ï¼›å­—ä½“èƒ½ä»è¿œç¨‹æœåŠ¡å™¨æˆ–è€…ç”¨æˆ·æœ¬åœ°å®‰è£…çš„å­—ä½“åŠ è½½. å¦‚æœæä¾›äº†local()å‡½æ•°ï¼Œä»ç”¨æˆ·æœ¬åœ°æŸ¥æ‰¾æŒ‡å®šçš„å­—ä½“åç§°ï¼Œå¹¶ä¸”æ‰¾åˆ°äº†ä¸€ä¸ªåŒ¹é…é¡¹, æœ¬åœ°å­—ä½“å°±ä¼šè¢«ä½¿ç”¨. å¦åˆ™, å­—ä½“å°±ä¼šä½¿ç”¨url()å‡½æ•°ä¸‹è½½çš„èµ„æºã€‚ é€šè¿‡å…è®¸ä½œè€…æä¾›ä»–ä»¬è‡ªå·±çš„å­—ä½“ï¼Œ@font-face è®©è®¾è®¡å†…å®¹æˆä¸ºäº†ä¸€ç§å¯èƒ½ï¼ŒåŒæ—¶å¹¶ä¸ä¼šè¢«æ‰€è°“çš„â€ç½‘ç»œ-å®‰å…¨â€å­—ä½“æ‰€é™åˆ¶(å­—ä½“å¦‚æ­¤æ™®éä»¥è‡³äºå®ƒä»¬èƒ½è¢«å¹¿æ³›çš„ä½¿ç”¨). æŒ‡å®šæŸ¥æ‰¾å’Œä½¿ç”¨æœ¬åœ°å®‰è£…çš„å­—ä½“åç§°å¯ä»¥è®©å­—ä½“çš„è‡ªå®šä¹‰åŒ–ç¨‹åº¦è¶…è¿‡åŸºæœ¬å­—ä½“ï¼ŒåŒæ—¶åœ¨ä¸ä¾èµ–ç½‘ç»œæƒ…å†µä¸‹å®ç°æ­¤åŠŸèƒ½ã€‚ åœ¨åŒæ—¶ä½¿ç”¨url()å’Œlocal()åŠŸèƒ½æ—¶ï¼Œä¸ºäº†ç”¨æˆ·å·²ç»å®‰è£…çš„å­—ä½“å‰¯æœ¬åœ¨éœ€è¦ä½¿ç”¨æ—¶è¢«ä½¿ç”¨ï¼Œå¦‚æœåœ¨ç”¨æˆ·æœ¬åœ°æ²¡æœ‰æ‰¾åˆ°å­—ä½“å‰¯æœ¬å°±ä¼šå»ä½¿ç”¨æˆ·ä¸‹è½½çš„å‰¯æœ¬æŸ¥æ‰¾å­—ä½“ã€‚ @font-face è§„åˆ™ä¸ä»…ä»…ä½¿ç”¨åœ¨CSSçš„é¡¶å±‚ï¼Œè¿˜å¯ä»¥ç”¨åœ¨ä»»ä½•CSSæ¡ä»¶ç»„è§„åˆ™ä¸­. @font-face { font-family: \"Open Sans\"; src: url(\"/fonts/OpenSans-Regular-webfont.woff2\") format(\"woff2\"), url(\"/fonts/OpenSans-Regular-webfont.woff\") format(\"woff\"); } 3.ä¸‰è§’å½¢è‹¥ç›’å­è®¾ç½®å®½é«˜ä¸º0ï¼›æ­¤æ—¶åˆè®¾ç½®è¾¹æ¡†ï¼Œåˆ™ä¼šå½¢æˆç»„æˆä¸€ä¸ªæ­£æ–¹å½¢çš„4ä¸ªä¸‰è§’å½¢ï¼Œå®é™…ä¸Šæˆ‘ä»¬å†™ä¸‰è§’å½¢å¯ä»¥åˆ©ç”¨è¿™ä¸ªåŸç†ï¼ŒæŠŠå…¶ä»–ä¸‰ä¸ªä¸‰è§’å½¢éšè—èµ·æ¥åˆ™å°±åªæœ‰ä¸€ä¸ªä¸‰è§’å½¢äº† width: 0; height: 0; /*line-height: 0; font-size: 0; æœ‰æ—¶éœ€è¦æ·»åŠ ï¼Œçœ‹æµè§ˆå™¨*/ /*å…ˆè®¾ç½®ä¸€ä¸ªè¾¹æ¡†ï¼Œå°½é‡å¤§ï¼Œä»¥è¾¹æ¡†æ¦‚æ‹¬ç›’å­å¤§å°*/ border: 50px solid #ccc; border-color: transparent red transparent transparent //ä¸Šå³ä¸‹å·¦çš„é¢œè‰² 4.ç”¨æˆ·ç•Œé¢é¼ æ ‡æ ·å¼ cursorcursor: defalut é»˜è®¤æ— æ ·å¼ cursor: pointer å°æ‰‹ cursor: move ç§»åŠ¨ cursor: text æ–‡æœ¬ cursor: not-allowed ç¦æ­¢ è½®å»“çº¿ç»™è¡¨å•ï¼ˆinputï¼‰æ·»åŠ  outline: 0;ï¼Œç‚¹å‡»è¡¨å•æ—¶ï¼Œä¼šå»æ‰é»˜è®¤çš„lè“è‰²å…‰æ ‡ é˜²æ­¢æ‹–æ‹½æ–‡æœ¬åŸŸtextarea{ resize: none }å¯ä»¥ä½¿æ–‡æœ¬æ¡†æ²¡æœ‰æ‹–æ‹½é€‰é¡¹ 5.Vertical-align(å›¾ç‰‡)csså¸¸ç”¨vertical-alignè®©å›¾ç‰‡å’Œæ–‡å­—å¯¹é½ï¼ˆä½†æ˜¯åªèƒ½é’ˆå¯¹è¡Œå†…å…ƒç´ æˆ–è€…è¡Œå†…å—å…ƒç´ ï¼‰ vertical-align: middle; ä¸­çº¿å¯¹é½ï¼ˆä¸€èˆ¬ä½¿ç”¨è¿™ä¸ªæ¥å¯¹é½ï¼‰ å›¾ç‰‡åº•ä¾§æ”¾ç½®äºç›’å­å†…æ—¶ï¼Œæ—¶å¸¸æœ‰ä¸€ä¸ªç©ºç™½ç¼éš™ï¼Œå¯ä»¥ä½¿ç”¨vertical-align: middle||top||bottom;å°†å…¶è§£å†³ ï¼ˆå…¶å®è¿˜å¯ä»¥ç›´æ¥è½¬æˆå—å…ƒç´ ï¼Œä½†æ˜¯æ­¤æ–¹æ³•ä¸æå€¡ï¼‰ å…¶å®ä¹Ÿå¯ä»¥å°†è¯¥ç›’å­è½¬åŒ–æˆ display: table-cellï¼Œç„¶ååŒæ ·å¯ä»¥ä½¿ç”¨vertical-alignå±æ€§ å¸¸ç”¨çš„å‹ç¼©å›¾ç‰‡åœ°å€ï¼ˆpngï¼‰https://tinypng.com/ 6.æ–‡å­—æº¢å‡ºå˜çœç•¥å·ï¼ˆæ¨èè®©åç«¯å†™ï¼‰å•è¡Œæ–‡æœ¬ï¼šwhite-space: nowrap //å¼ºåˆ¶ä¸€è¡Œå†…æ˜¾ç¤º â€‹ overflow: hidden; //æº¢å‡ºéšè— â€‹ text-overflow: ellipsis ///å˜æˆçœç•¥å· å¤šè¡Œæ–‡æœ¬ï¼šï¼ˆæœ‰è¾ƒå¤§å…¼å®¹æ€§é—®é¢˜ï¼Œé€‚ç”¨äºç§»åŠ¨ç«¯æˆ–è€…webkitæµè§ˆå™¨ï¼‰ â€‹ overflow: hidden; + text-overflow: ellipsis display: -webkit-box; /*å•è¡Œä¼¸ç¼©ç›’å­*/ -webkit-line-clamp: 2; /*é™åˆ¶å…¶æ–‡æœ¬è¡Œæ•°*/ -webkit-box-orient: vertical; /*è®¾ç½®ç›’å­çš„å­å…ƒç´ æ’åˆ—æ–¹å¼ï¼Œï¼ˆå‚ç›´å±…ä¸­ï¼‰*/ 7.å¸¸è§å¸ƒå±€æŠ€å·§å¯ä»¥ä½¿ç”¨marginçš„è´Ÿå€¼æ¥æ¶ˆé™¤æµ®åŠ¨è¾¹æ¡†çš„é‡åˆï¼ˆæ¶ˆé™¤äº§ç”Ÿçš„å·¨å¤§å½±å­ï¼‰å¦‚ï¼š margin-left: -Xpx; æƒ³è¦ç§»åŠ¨åˆ°æŸä¸ªè¾¹æ¡†å†…è‡ªåŠ¨å˜è‰²å¯ä»¥ä½¿ç”¨hoverï¼Œä½†æ˜¯å½“æ’åˆ—æ–¹å¼ä¸ºæ¯ä¸ªç›’å­çš„å³è¾¹æ¡†è¢«å¦å¤–ä¸€ä¸ªç›’å­çš„å·¦è¾¹æ¡†å‹ä½æ—¶ï¼Œå˜è‰²æ•ˆæœä¼šå‡ºbugï¼Œæ­£ç¡®åšæ³•æ˜¯ï¼šxx:hover{ position: relative; }æ·»åŠ ç›¸å¯¹å®šä½ä½¿å…¶é©¬ä¸Šè¦†ç›–å½“å‰æ‰€æœ‰å•ä½ å¦‚æœå¤±è´¥ï¼Œæœ‰å¯èƒ½æ˜¯å› ä¸ºå½“å‰å·²ç»æ·»åŠ äº†ç»å¯¹å®šä½äº†ï¼Œæ­¤æ—¶åªéœ€è¦æé«˜å±‚çº§ï¼šz-index: 1; 8.CSSåˆå§‹åŒ–ä¸ºäº†ç…§é¡¾æµè§ˆå™¨å…¼å®¹ï¼Œå¿…é¡»é¦–å…ˆè¿›è¡ŒCSSåˆå§‹åŒ–ï¼Œå³é‡æ–°è®¾å®šCSSä¸ªæ ‡ç­¾çš„åˆå§‹é»˜è®¤å€¼ 9.CSS3æ–°ç‰¹æ€§ie9+æ‰æ”¯æŒ å±æ€§é€‰æ‹©å™¨å¯ä»¥ä¸å€ŸåŠ©ç±»é€‰æ‹©å™¨ input[att] {} å¸¦æœ‰attå±æ€§å€¼çš„è¢«é€‰ä¸­input[att=&quot;value&quot;] {} å¸¦æœ‰attå±æ€§å¹¶ä¸”å±æ€§å€¼ç­‰äºvalueè¢«é€‰ä¸­ input[class^=icon]{} é€‰æ‹©ç±»å±æ€§ä»¥iconå¼€å¤´çš„æ‰€æœ‰æ ‡ç­¾ input[class$=icon]{} é€‰æ‹©ç±»å±æ€§ä»¥iconç»“å°¾çš„æ‰€æœ‰æ ‡ç­¾ input[class*=icon]{} é€‰æ‹©ç±»å±æ€§å«æœ‰iconçš„æ‰€æœ‰æ ‡ç­¾ å¦‚ .local-nav li [class^=\"local-nav-icon\"] { } ç±»é€‰æ‹©å™¨ï¼Œä¼ªç±»é€‰æ‹©å™¨ï¼Œå±æ€§é€‰æ‹©å™¨ï¼ˆä¼ªç±»é€‰æ‹©å™¨ã€å±æ€§é€‰æ‹©å™¨ä¸€èˆ¬æ˜¯11ï¼Œå› ä¸ºåŒ…å«æ ‡ç­¾å+/ä¼ªç±»åå±æ€§å=1+10=11ï¼‰å®ƒä»¬æƒé‡éƒ½ä¸º10 ç»“æ„ä¼ªç±»é€‰æ‹©å™¨firstå’Œlastç­‰å¯ä»¥æ¥äº†è§£ä¸€ä¸‹ï¼Œå®é™…å¼€å‘ä¸å¤ªå»ºè®®ä½¿ç”¨ï¼Œä¹Ÿæ¯”è¾ƒå°‘ä½¿ç”¨ã€‚ å€¼å¾—æ³¨æ„çš„æ˜¯ nth-child(n)æ¯”è¾ƒé‡è¦ nå¯ä»¥æ˜¯æ•°å­—ï¼Œå¯ä»¥æ˜¯å…³é”®å­—ï¼ˆevenå¶æ•°ï¼Œoddå¥‡æ•°ï¼‰ï¼Œç”šè‡³å…¬å¼ ul li:nth-child(even){ } //é€‰æ‹©æ‰€æœ‰çš„å¶æ•°å­©å­ ul li:nth-child(n){ } //é€‰æ‹©æ‰€æœ‰å­©å­,å› ä¸ºnæ˜¯å…¬å¼ç±»ä¼¼n++ï¼Œä¾æ¬¡æ–½åŠ CSSæ•ˆæœ ul li:nth-child(2n){ } //é€‰æ‹©æ‰€æœ‰çš„å¶æ•°å­©å­ ul li:nth-child(-n+5){ } //é€‰æ‹©å‰5ä¸ªå­©å­ nth-of-typeå’Œnth-childçš„ä¸åŒï¼š section div:nth-child(1){ } //å…ˆæ’åºï¼Œå†çœ‹æ˜¯å¦ç¬¦åˆdivï¼Œå¦‚æœæ˜¯divå°±æ¸²æŸ“ section div:nth-type(1){ } //å…ˆçœ‹æ˜¯å¦ç¬¦åˆdivï¼Œå¦‚æœæ˜¯å°±åœ¨divé‡Œæ’åºï¼Œé€‰æ‹©ç¬¬ä¸€ä¸ªå°±æ¸²æŸ“ ä¼ªå…ƒç´ é€‰æ‹©å™¨é€šè¿‡CSSåˆ›å»ºæ–°çš„å­æ ‡ç­¾ï¼ˆæ¯”è¾ƒç®€å•çš„ï¼‰ï¼Œä»è€Œç®€åŒ–htmlç»“æ„ï¼Œï¼ˆè¿˜ä¸ä¹‹å‰æ¸…é™¤æµ®åŠ¨ä½¿ç”¨çš„ä¼ªå…ƒç´ æ–¹æ³•æœ‰å…³ï¼‰ element::before{ contentï¼š'XX'; /*å¿…é¡»è¦æœ‰contentå±æ€§ï¼Œä¸ºå†…å®¹*/ } /*åœ¨å…ƒç´ å†…éƒ¨å‰é¢ï¼ˆå·¦ï¼‰æ’å…¥å†…å®¹*/ element::after{ content: 'XX'; } /*åœ¨å…ƒç´ å†…éƒ¨åé¢ï¼ˆå³ï¼‰æ’å…¥å†…å®¹*/ å®ƒå’Œæ ‡ç­¾é€‰æ‹©å™¨ä¸€æ ·ï¼Œæƒé‡=1ï¼Œä¸”ä¸ºè¡Œå†…å…ƒç´ ï¼Œæƒ³è¦è®¾ç½®å¤§å°å¿…é¡»è½¬è¡Œå†…å— ï¼ˆè¿˜å¯ä»¥æœ‰element:hover::before{}çš„æ“ä½œï¼‰ ä¼ªç±»å’Œä¼ªå…ƒç´ å•å†’å·(:)ç”¨äºCSS3ä¼ªç±»ï¼ŒåŒå†’å·(::)ç”¨äºCSS3ä¼ªå…ƒç´  åŒå†’å·æ˜¯åœ¨å½“å‰è§„èŒƒä¸­å¼•å…¥çš„ï¼Œç”¨äºåŒºåˆ†ä¼ªç±»å’Œä¼ªå…ƒç´ ã€‚ä¸è¿‡æµè§ˆå™¨éœ€è¦åŒæ—¶æ”¯æŒæ—§çš„å·²ç»å­˜åœ¨çš„ä¼ªå…ƒç´ å†™æ³•ï¼Œæ¯”å¦‚:first-lineã€:first-letterã€:beforeã€:afterç­‰ï¼Œè€Œæ–°çš„åœ¨CSS3ä¸­å¼•å…¥çš„ä¼ªå…ƒç´ åˆ™ä¸å…è®¸å†æ”¯æŒæ—§çš„å•å†’å·çš„å†™æ³•; æ‰€ä»¥æˆ‘ä»¬æœ€å¥½å…»æˆä¹ æƒ¯ï¼Œä¼ªå…ƒç´ å†™ :: ä¼ªç±»å†™ : CSS3ç›’å­æ¨¡å‹åªéœ€å¢åŠ å¦‚ä¸‹ä»£ç  box-sizing: content-box; /*é»˜è®¤*/ box-sizing: border-box; /*åªçœ‹ç›’å­å¤§å°ï¼Œä¸è€ƒè™‘borderå’Œpaddingå› ç´ */ å³å¯ä¸ç”¨è€ƒè™‘borderå’Œpaddingå› ç´ æ˜¯å¦ä¼šå°†ç›’å­æœ¬èº«æ’‘å¤§ã€‚ æ ‡å‡†ç›’æ¨¡å‹ï¼šbox-sizingï¼šcontent-box æ€ªå¼‚ç›’æ¨¡å‹ï¼šbox-sizingï¼šborder-box è¿™é‡ŒæåŠåˆ°ç›’å­æ¨¡å‹å°±è®²ä¸€è®²æ ‡å‡†ç›’æ¨¡å‹å’Œæ€ªå¼‚ç›’æ¨¡å‹ ç›’å­æ¨¡å‹W3Cç›’å­æ¨¡å‹(æ ‡å‡†ç›’æ¨¡å‹)å’ŒIEç›’å­æ¨¡å‹(æ€ªå¼‚ç›’æ¨¡å‹) æ ‡å‡†ç›’æ¨¡å‹ï¼š ç›’å­å®é™…å†…å®¹ï¼ˆcontentï¼‰çš„width/height=æˆ‘ä»¬è®¾ç½®çš„width/height; ç›’å­æ€»å®½åº¦/é«˜åº¦=width/height+padding+border+marginã€‚ æ€ªå¼‚ç›’æ¨¡å‹ï¼š ç›’å­çš„ï¼ˆcontentï¼‰å®½åº¦+å†…è¾¹è·padding+è¾¹æ¡†borderå®½åº¦=æˆ‘ä»¬è®¾ç½®çš„width/heigh ç›’å­æ€»å®½åº¦/é«˜åº¦=width/height + margin = å†…å®¹åŒºå®½åº¦/é«˜åº¦ + padding + border + marginã€‚ æ€»ç»“ï¼š æ€»å¤§å°å…¶å®æ˜¯ä¸€æ ·çš„ï¼Œåªæ˜¯æˆ‘ä»¬è®¾ç½®æ ‡å‡†ç›’å­å®½é«˜æ˜¯è®¾ç½®å†…å®¹å®½é«˜ï¼Œè®¾ç½®æ€ªå¼‚ç›’å­å®½é«˜æ˜¯å†…å®¹ + padding + border å®½é«˜ CSS3æ»¤é•œfilterç”¨äºæ¨¡ç³Šå›¾å½¢æ•ˆæœï¼Œfilter: å‡½æ•°(); å¦‚ï¼šfilter:blur(5px); //æ¨¡ç³Šå¤„ç†ï¼Œæ•°å€¼è¶Šå¤§è¶Šæ¨¡ç³Š â€¦â€¦ å¦‚æœæ˜¯åªæ˜¯å•çº¯æ¨¡ç³ŠèƒŒæ™¯å›¾ç‰‡ï¼Œå¯ä»¥ä½¿ç”¨ backdrop-filter backdrop-filter: blur(8px); CSS3calcå‡½æ•°(è®¡ç®—å‡½æ•°)width: calc(100% - 80px); //å®½åº¦æ°¸è¿œæ¯”çˆ¶ç›’å­å®½åº¦å°30px CSSè¿‡æ¸¡ï¼ˆé‡ç‚¹ï¼‰ä¸€äº›å˜åŒ–çš„åŠ¨ç”»æ•ˆæœï¼ˆæ—¶é—´ç¼“æ»ï¼‰ï¼Œç»å¸¸å’Œ :hoverã€transformç­‰ ä¸€èµ·æ­é… åœ¨å®˜ç½‘ä¸­æŸ¥çœ‹åˆ°å…¼å®¹æ€§æ¯”è¾ƒå·®ï¼Œåè€Œ@keyframeçš„å…¼å®¹æ€§å¾ˆä¸é”™ï¼Ÿï¼ï¼ transition: è¦è¿‡æ¸¡çš„å±æ€§ èŠ±è´¹çš„æ—¶é—´ï¼ˆå•ä½ä¸ºsï¼‰ è¿åŠ¨æ›²çº¿ï¼ˆé»˜è®¤easeï¼Œå¯ä»¥çœç•¥ï¼‰ ä½•æ—¶å¼€å§‹ï¼ˆé»˜è®¤0sï¼Œå¯çœç•¥ï¼‰; transition: width 0.5s,heigh 0.5s; /*å¤šä¸ªå±æ€§\",\"åˆ†å‰²ï¼Œæƒ³è¦æ›´å¤šå±æ€§ï¼Œç›´æ¥å±æ€§å€¼å†™all*/ xx:hover{width:100px;heigh:100px;} è¿‡æ¸¡çš„å±æ€§ï¼š none æ²¡æœ‰å±æ€§ä¼šè·å¾—è¿‡æ¸¡æ•ˆæœã€‚ all æ‰€æœ‰å±æ€§éƒ½å°†è·å¾—è¿‡æ¸¡æ•ˆæœã€‚ property å®šä¹‰åº”ç”¨è¿‡æ¸¡æ•ˆæœçš„ CSS å±æ€§åç§°åˆ—è¡¨ï¼Œåˆ—è¡¨ä»¥é€—å·åˆ†éš”ã€‚ 10.CSSçš„morecssçš„2Dè½¬æ¢transformå¯ä»¥ç†è§£ä¸ºå˜å½¢ ç§»åŠ¨ï¼štranslate æ—‹è½¬ï¼šrotate ç¼©æ”¾ï¼šscale 2dä¸ºäºŒç»´åæ ‡ï¼Œxè½´å‘å³ï¼Œyè½´å‘ä¸‹ translateç±»ä¼¼äºå®šä½transform:translate(x,y); transform:translateX(n); transform:translateY(n); /*å•ä½æ˜¯pxï¼Œå¦‚æœæ˜¯ç™¾åˆ†å·ï¼Œåˆ™å®ƒçš„è·ç¦»æ˜¯ç›’å­è‡ªèº«é«˜å®½å¯¹æ¯”å‡ºæ¥çš„*/ translateæœ€å¤§çš„ä¼˜ç‚¹ï¼šä¸ä¼šå½±å“å…¶ä»–å…ƒç´ çš„ä½ç½®ï¼Œç»å¯¹å®šä½ä¼šè„±æ ‡ï¼Œmarginä¼šå½±å“ï¼Œï¼ˆæœ‰ç‚¹åƒç›¸å¯¹å®šä½ï¼Œä½†æ˜¯æ›´æ–¹ä¾¿ï¼Œå¯ä»¥åŠ è¿‡æ¸¡æ•ˆæœï¼‰ å¯ç”¨äºå®šä½çˆ¶ç›’å­çš„ä¸­é—´ä½ç½® ä½¿ç”¨ï¼š position: absolute; top: 50%; left: 50%; transform:translate(-50%,-50%);ä½†æ˜¯å®ƒå¯¹è¡Œå†…æ ‡ç­¾æ²¡æœ‰æ•ˆæœ rotateæ—‹è½¬transform:rotate(åº¦æ•°deg); transform-origin:x y; /*è®¾ç½®å…ƒç´ æ—‹è½¬ä¾é çš„ä¸­å¿ƒç‚¹*/ xï¼Œyé»˜è®¤ä¸º50%ï¼Œ50%ï¼Œè®¾ç½®xï¼Œyå¯ä»¥å¯æ˜¯bottomï¼Œleftç­‰ï¼Œå¦‚transform-origin:left bottom;ä¸ºè®¾ç½®å·¦ä¸‹è§’ä¸ºä¸­å¿ƒç‚¹ scaleä¹‹ç¼©æ”¾transform:scale(x,y);/*é‡Œé¢çš„æ•°å­—ä¸è·Ÿå•ä½ï¼Œæ˜¯å€æ•°ï¼Œxï¼Œyåˆ†åˆ«æ˜¯å®½ï¼Œé«˜*/ transform-origin:x y; /*è®¾ç½®å…ƒç´ æ—‹è½¬ä¾é çš„ä¸­å¿ƒç‚¹*/ è‹¥åªæœ‰ä¸€ä¸ªå‚æ•°ï¼Œåˆ™åŒæ¯”æ”¾å¤§ ä½¿ç”¨scaleçš„ä¼˜ç‚¹ï¼šå˜å¤§æ—¶ä¸ä¼šå½±å“å…¶ä»–ç›’å­çš„ä½ç½®ï¼Œä¸”æ”¾å¤§æ˜¯ä»¥ä¸­å¿ƒå‘å¤–æ‰©å¼ çš„æ”¾å¤§ï¼Œç›´æ¥ä¿®æ”¹widthå’Œheighæ”¾å¤§æ˜¯ç›´æ¥å¾€ä¸‹æ”¾å¤§ 11.åŠ¨ç”»ç”¨keyframeså®šä¹‰åŠ¨ç”» @keyframes åŠ¨ç”»åç§° { 0%{ width:100px.... } 100%{ width:200px.... } }//å¯ä»¥è®¾ç½®25%ï¼Œ75%ç­‰å¤šä¸ªçŠ¶æ€ï¼Œä¹ æƒ¯ä¸ŠæŠŠ0%ä¹Ÿå†™äº† //ä»¥ä¸‹ä¹Ÿå¯ä»¥ @keyframes åŠ¨ç”»åç§° { from{ width:100px.... } to{ width:200px.... } } 0%åŠ¨ç”»çš„å¼€å§‹ 100%åŠ¨ç”»çš„ç»“æŸ 1.å¯ä»¥åšå¤šä¸ªçŠ¶æ€å˜åŒ– keyframeå…³é”®å¸§ 2.é‡Œé¢çš„æ•°å­—ä¸ºæ•´æ•° 3.ç™¾åˆ†æ¯”ä¸ºæ—¶é—´çš„åˆ’åˆ† ä½¿ç”¨åŠ¨ç”»ï¼š div { animation-name:åŠ¨ç”»åç§°; animation-duration:æŒç»­æ—¶é—´; animation-iteration-count:æ’­æ”¾æ¬¡æ•°ï¼Œå¯ä»¥ä¸ºinfinite; animation-direction:xx; /*è®¾ç½®åŠ¨ç”»åœ¨æ¯æ¬¡è¿è¡Œå®Œåæ˜¯åå‘è¿è¡Œè¿˜æ˜¯é‡æ–°å›åˆ°å¼€å§‹ä½ç½®é‡å¤è¿è¡Œã€‚*/ /*é»˜è®¤normalï¼Œalternateä¸ºè®¾ç½®åŠ¨ç”»äº¤æ›¿åå‘è¿è¡Œï¼Œreverseä¸ºåå‘è¿è¡Œ*/ animation-fill-mode:xx; //é»˜è®¤backwardsï¼ŒåŠ¨ç”»ç»“æŸåè¿”å›åŸæ¥ä½ç½®ï¼Œforwardså¯å–æ¶ˆè¯¥åŠŸèƒ½ animation-play-state:xx; //running/paused æ˜¯åŠ¨ç”»è¿è¡Œæˆ–è€…æš‚åœ animation-timing-fuction: ease; //é»˜è®¤easeåŠ é€Ÿåº¦ï¼ŒlinearåŒ€é€Ÿï¼Œstepåˆ†æ­¥ã€‚ã€‚ã€‚ } å½“ç„¶ animation-timing-fuction å¯ä»¥ä½¿ç”¨ cubic-bezier æ§åˆ¶åŠ¨ç”»é€Ÿåº¦ https://cubic-bezier.com/#.51,0,.47,.99 ä½¿ç”¨å¤šä¸ªåŠ¨ç”»ç”¨â€œï¼Œâ€åˆ†éš” å¦‚animation: bear 0.7s steps(8) infinite, move 0.7s â€¦â€¦ animation: name duration timing-function delay iteration-count direction fill-mode play-state; animationä¸€ä¸ªæ¨èç½‘å€ï¼šhttps://xsgames.co/animatiss/ 3Dè½¬æ¢xè½´å‘å³ï¼Œyè½´å‘ä¸‹ï¼Œzè½´å‘å¤–ï¼Œæœ€å¸¸ç”¨çš„æ˜¯3dä½ç§»å’Œ3dæ—‹è½¬,ä»¥ä¸‹è®¸å¤šåŠŸèƒ½ä¸2dååˆ†ç›¸ä¼¼ è®¾ç½®ä¸º3dæ¨¡å¼(å˜å½¢æ•ˆæœ) å¦‚æœé€‰æ‹©å¹³é¢ï¼Œå…ƒç´ çš„å­å…ƒç´ å°†ä¸ä¼šæœ‰ 3D çš„é®æŒ¡å…³ç³»ã€‚ ç”±äºè¿™ä¸ªå±æ€§ä¸ä¼šè¢«ç»§æ‰¿ï¼Œå› æ­¤å¿…é¡»ä¸ºå…ƒç´ çš„æ‰€æœ‰éå¶å­å­å…ƒç´ è®¾ç½®å®ƒã€‚ transform-style: preserve-3d 3dç§»åŠ¨transform: translate3d(x,y,z); transform:translateZ(n); /*translateZä¸€èˆ¬é‡‡ç”¨pxï¼Œ3dçš„zè½´æ˜¾ç°å‡ºæ¥éœ€è¦é€è§†åŠŸèƒ½*/ translateZè¸©çš„å‘1.åœ¨androidä¸Šï¼Œå¦‚æœå¯¹å…ƒç´ åŒæ—¶è®¾ç½®zindexå’Œtransform translateZçš„å€¼æ—¶ï¼Œåœ¨æ˜¾ç¤ºä¸Šzindexçš„ä¼˜å…ˆçº§è¦é«˜äºtranslateZ 2.åœ¨iosä¸Šï¼Œåˆ™ç›¸åï¼ŒtranslateZçš„ä¼˜å…ˆçº§è¦é«˜äºzindex 3.æ‰€ä»¥æœ€å¥½åœ¨è®¾ç½®ä¸€ç³»åˆ—å…ƒç´ æ—¶ï¼Œzindexçš„å€¼å’ŒtranslateZçš„å€¼åº”è¯¥ä¸€èµ·é€çº§å¢é•¿æˆ–é€çº§å‡å°‘ https://blog.csdn.net/qappleh/article/details/95636682 æˆ‘çš„è§£å†³æ–¹æ¡ˆï¼š overflow:hidden //ç”¨äºæ¶ˆé™¤3dç¯å¢ƒä¸‹ioså±‚çº§é—®é¢˜ å¦‚æœæ”¾åœ¨çˆ¶çº§åˆ«ä¸è¡Œï¼Œé‚£å°±æ”¾åœ¨çˆ·çˆ·çº§åˆ« ç½‘ä¸Šçš„è§£å†³æ–¹æ¡ˆï¼š æ–¹æ³•1ï¼šçˆ¶çº§ï¼Œä»»æ„çˆ¶çº§ï¼Œébodyçº§åˆ«ï¼Œè®¾ç½®overflow:hiddenå¯æ¢å¤å’Œå…¶ä»–æµè§ˆå™¨ä¸€æ ·çš„æ¸²æŸ“ã€‚ æ–¹æ³•2ï¼šä»¥æ¯’æ”»æ¯’ã€‚æœ‰æ—¶å€™ï¼Œé¡µé¢å¤æ‚ï¼Œæˆ‘ä»¬ä¸èƒ½ç»™çˆ¶çº§è®¾ç½®overflow:hiddenï¼Œæ€ä¹ˆåŠå‘¢ï¼Ÿ æ¨è¿‡çš„æƒ…èŠ±å‰§æ¯’æ€ä¹ˆè§£çš„ï¼Ÿæ–­è‚ è‰å•Šï¼Œå¦ä¸€ç§å‰§æ¯’ã€‚è¿™é‡Œä¹Ÿæ˜¯ç±»ä¼¼ã€‚æ—¢ç„¶â€œç©¿è¶Šâ€çš„æ¸²æŸ“é—®é¢˜æ˜¯ç”±3D transformå˜æ¢äº§ç”Ÿçš„ï¼Œé‚£ä¹ˆï¼Œè¦è§£å†³æ­¤é—®é¢˜ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨3D transformå˜æ¢ã€‚ é€è§†é€è§†æˆ‘ä»¬ä¹Ÿæˆä¸ºè§†è·ï¼Œå³çœ¼ç›åˆ°å±å¹•çš„è·ç¦»ï¼Œé€è§†çš„å•ä½æ˜¯åƒç´ ï¼Œé€è§†è¶Šå°ï¼Œç›’å­è¶Šå¤§ é€è§†å†™åœ¨è¢«è§‚å¯Ÿå…ƒç´ çš„çˆ¶ç›’å­ä¸Š perspective: xxpx;3dæ—‹è½¬ä¸€èˆ¬åŠ ä¸Šé€è§†æ•ˆæœä¼šæ¯”è¾ƒæ˜æ˜¾ï¼Œ3dæ—‹è½¬æ–¹å‘éµå¾ªå·¦æ‰‹å®šåˆ™ï¼š å·¦æ‰‹å¤§æ‹‡æŒ‡æŒ‡å‘æ—‹è½¬è½´çš„æ–¹å‘ï¼Œæ‰‹æŒ‡å¼¯æ›²çš„æ–¹å‘åˆ™ä¸ºæ—‹è½¬çš„æ–¹å‘ transform: rotateX(åº¦æ•°); /*æ²¿ç€Xè½´æ—‹è½¬*/ transform: rotateY(åº¦æ•°); transform: rotateZ(åº¦æ•°); /*zè½´æ—‹è½¬å’Œ2dæ™®é€šrotateæœ‰ç‚¹åƒ*/ transform: rotate3d(x,y,z,åº¦æ•°); /*è‡ªå®šä¹‰è½´æ—‹è½¬*/ è‡ªå®šä¹‰æ—‹è½¬åªå¯¹xè½´é€‰å–ä¸ºtransform: rotate3d(1,0,0,åº¦æ•°); å¯¹è§’çº¿æ—‹è½¬ä¸ºtransform: rotate3d(1,1,0,åº¦æ•°) transformè¦çœ‹æƒ…å†µé€‰æ‹©ï¼šå…ˆå†™æ—‹è½¬rotateå†å†™ç§»åŠ¨translateæˆ–è€…ç›¸åæƒ…å†µ 3då‘ˆç°transform-styleæ§åˆ¶å­å…ƒç´ æ˜¯å¦å¼€å¯ä¸‰ç»´ç«‹ä½“ç¯å¢ƒï¼Œä»£ç è¦å†™ç»™çˆ¶çº§ï¼ˆä¸€å®šæ˜¯çˆ¶çº§ï¼Œä¸èƒ½çˆ·çˆ·çº§åˆ«ï¼Œäº²æµ‹è¿‡ï¼‰ï¼Œæ­¤å±æ€§å¾ˆé‡è¦ transform-style: preserve-3d /*æ­¤ä¸ºå¼€å¯ç«‹ä½“ç©ºé—´ï¼Œä½†æ˜¯é»˜è®¤å€¼ä¸ºflatï¼Œä¸å¼€å¯ç«‹ä½“ç©ºé—´*/ 12.styled-componentsç§‰æ‰¿ç€ä¸‡ç‰©çš†æ˜¯ç»„ä»¶çš„æ€æƒ³ï¼Œè®©cssæ ·å¼å˜æˆç»„ä»¶ï¼Œæ¥åŠ å…¥ npm i styled-components å¦‚æœæ˜¯é…åˆä¸Štsï¼Œè¿˜éœ€è¦ä¸‹è½½å®ƒçš„å£°æ˜æ–‡ä»¶ npm i --save-dev @types/styled-components styled-componentsé…åˆreactä½¿ç”¨ å®ƒå†…éƒ¨è¿˜æ”¯æŒsassã€lessè¯­æ³•ï¼Œå…ˆå£°æ˜ä¸€ä¸ªå¯¹è±¡ styled.æ ‡ç­¾å+cssæ¨¡æ¿å­—ç¬¦ä¸² import React from \"react\"; import styled from 'styled-components' export default function index() { const StyleFooter = styled.footer` background: yellow ul{ display: flex; li{ flex:1 } } ` return &lt;div> &lt;StyleFooter> &lt;ul> &lt;li>å•†åº—&lt;/li> &lt;li>å•†åº—&lt;/li> &lt;/ul> &lt;/StyleFooter> &lt;/div>; } å¯¹å­ç»„ä»¶ä½¿ç”¨styled-componentsçš„æ–¹å¼ï¼š styled(å­ç»„ä»¶)+cssæ¨¡æ¿å­—ç¬¦ä¸² åŒæ—¶å­ç»„ä»¶è¿˜éœ€è¦é€šè¿‡props.classNameæ¥æ”¶è¯¥æ ·å¼ import React from \"react\"; import styled from 'styled-components' export default function Index() { const StyleChild = styled(Child)` background: yellow ` return &lt;div> father &lt;StyleChild>&lt;/StyleChild> &lt;/div>; } function Child(props: any) { return ( &lt;div className={props.className}>child&lt;/div> ) } ä¼˜ç¼ºç‚¹å¸¸è§„cssæ€§èƒ½ vs cssinjs css in js æ›´å°ï¼ˆåŒ…çš„å¤§å°ï¼‰ å¸¸è§„cssæ¸²æŸ“æ—¶é—´æ›´çŸ­ å¹¶ä¸”ï¼šä¸ºäº†æ›´å¥½åœ°æ¯”è¾ƒç”¨æˆ·äº¤äº’ï¼Œè€Œä¸ä»…ä»…æ˜¯é¡µé¢åŠ è½½ã€‚æµ‹é‡äº†è¿›è¡Œé¡¹ç›®åˆ†ç»„çš„æ‹–æ”¾æ´»åŠ¨æ€§èƒ½ã€‚ç»“æœæ€»ç»“å¦‚ä¸‹ï¼šå³ä½¿åœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒLinariaåœ¨å‡ ä¸ªç±»åˆ«ä¸­ä¹Ÿå‡»è´¥äº†CSS-in-JSã€‚ å‚è€ƒï¼šhttps://zhuanlan.zhihu.com/p/513843865 13.clip-pathä¸€ä¸ªç”¨æ¥è®¾ç½®è’™ç‰ˆçš„csså±æ€§ï¼Œç”¨å®ƒæ¥ç»˜åˆ¶åŒºåŸŸï¼Œåªæœ‰åœ¨åŒºåŸŸå†…çš„éƒ¨åˆ†æ‰èƒ½è¢«çœ‹åˆ°ï¼Œå®ƒæ”¯æŒ circleï¼ˆåœ†å½¢ï¼‰ ellipseï¼ˆæ¤­åœ†ï¼‰ polygonï¼ˆå¤šè¾¹å½¢åŒºåŸŸï¼‰ ä½¿ç”¨è¯¥è’™ç‰ˆåä¸èƒ½æ­é…box-shadowï¼Œå› ä¸ºæ­¤æ—¶è’™ç‰ˆè¢«è’™ä½çš„éƒ¨åˆ†ï¼Œä¼šå±•ç¤ºä¸å‡ºbox-shadow ä½†æ˜¯å¯ä»¥ä½¿ç”¨ä¼ªå…ƒç´  before ä»£æ›¿é˜´å½±ï¼Œè®¾ç½®ä¸ºé˜´å½±çš„é¢œè‰² å„ç§å½¢çŠ¶çš„ç¤ºä¾‹ï¼šhttps://blog.csdn.net/weixin_44116302/article/details/98882841 ä¸€ä¸ªå°çš„æ•™å­¦è§†é¢‘åœ¨bç«™ï¼šhttps://www.bilibili.com/video/BV18y4y1i7oP?zw è¯¥æ•™å­¦çš„æ–‡æ¡£https://zxuqian.cn/videos/effects/effects-glitch/ 14 CSS3ä¸­-moz-æˆ–-webkit-æ˜¯ä»€ä¹ˆæ„æ€CSS3ä¸­æ–°å¢äº†ä¸€äº›å±æ€§ï¼Œä¾‹å¦‚box-reduisã€box-orientã€text-overflowç­‰ç­‰ï¼Œè€Œè¿™äº›å±æ€§åœ¨ä»¥å¾€çš„ç‰ˆæœ¬ä¸­æ˜¯ä¸å­˜åœ¨çš„ï¼Œæˆ–è€…ä¸è¢«æ”¯æŒçš„ï¼Œå› æ­¤ï¼Œé’ˆå¯¹ä¸åŒçš„æµè§ˆå™¨ï¼Œè§„å®šå…¶å†…æ ¸åç§°è®©å®ƒä»¬å¯ä»¥å¯¹è¿™äº›æ–°å¢å±æ€§è¿›è¡Œè§£æã€‚è¿™çœ‹ä¸Šå»æ˜¯ä¸€ä¸ªåˆç†çš„è§£é‡Šï¼Œå³-moz-æ˜¯é’ˆå¯¹firefoxçš„ï¼Œ-webkit-æ˜¯é’ˆå¯¹safariå’Œchromeçš„ã€‚","categories":[{"name":"å‰ç«¯","slug":"å‰ç«¯","permalink":"https://taylor12138.github.io/categories/%E5%89%8D%E7%AB%AF/"}],"tags":[],"author":"Hello"},{"title":"CSSæµ®åŠ¨+å®šä½","slug":"CSSæµ®åŠ¨+å®šä½","date":"2020-05-16T16:00:00.000Z","updated":"2022-04-02T12:24:31.374Z","comments":true,"path":"2020/05/17/css-fu-dong-ding-wei/","link":"","permalink":"https://taylor12138.github.io/2020/05/17/css-fu-dong-ding-wei/","excerpt":"","text":"1.æµ®åŠ¨CSSä¸‰ç§ä¼ ç»Ÿå¸ƒå±€ï¼šæ™®é€šæµ æµ®åŠ¨ å®šä½ æ ‡å‡†æµï¼šæ ‡ç­¾æŒ‰ç…§é»˜è®¤æ’åº å¤šä¸ªå—çº§å…ƒç´ çºµå‘æ’åˆ—ç”¨æ ‡å‡†æµï¼Œæ¨ªå‘æ’åˆ—ç”¨æµ®åŠ¨ é€‰æ‹©å™¨{ float: å±æ€§å€¼; //noneä¸æµ®åŠ¨ leftå‘å·¦æµ®åŠ¨ rightå‘å³æµ®åŠ¨ }//åˆ›å»ºæµ®åŠ¨æ¡†ï¼Œå°†å…¶ç§»åŠ¨åˆ°ä¸€è¾¹ï¼ŒçŸ¥é“å·¦è¾¹ç¼˜æˆ–å³è¾¹ç¼˜è§¦åŠåŒ…å«å—æˆ–å¦ä¸€ä¸ªæµ®åŠ¨æ¡†çš„è¾¹ç¼˜ 1.æµ®åŠ¨å…ƒç´ ä¼šè„±ç¦»æ ‡å‡†æµåŸæ¥ï¼ˆæ’åœ¨æµ®åŠ¨åé¢çš„ï¼‰æ ‡å‡†æµçš„æ ‡ç­¾ä¼šé¡¶ä¸Šä½ åŸæ¥çš„ä½ç½®ï¼ˆä½†æ ‡å‡†æµä¹‹åçš„æµ®åŠ¨æŒ¤ä¸ä¸Šå»ï¼‰ ï¼ˆä½†æ˜¯ï¼ï¼ä¸ä¼šè¦†ç›–æ‰ä½ çš„æ–‡å­—ï¼ï¼Œå› ä¸ºæœ¬èº«æµ®åŠ¨æ˜¯ä¸ºç¯ç»•å›¾ç‰‡è€Œè®¾è®¡çš„ï¼‰ 2.æµ®åŠ¨å…ƒç´ ä¼šä¸€è¡Œå†…æ˜¾ç¤ºå¹¶ä¸”å…ƒç´ é¡¶éƒ¨å¯¹é½ç´§è´´åœ¨ä¸€èµ·ï¼Œä¸ä¼šæœ‰ç¼éš™ï¼Œè£…ä¸å¼€ä¼šå¦èµ·ä¸€è¡Œ 3.æµ®åŠ¨å…ƒç´ å…·æœ‰è¡Œå†…å—å…ƒç´ çš„ç‰¹æ€§æ·»åŠ æµ®åŠ¨åè‡ªåŠ¨é™„å¸¦è¡Œå†…å—å…ƒç´ çš„ç‰¹æ€§ 4.æµ®åŠ¨è‡ªå¸¦æ–‡å­—ç¯ç»•æ•ˆæœæµ®åŠ¨çš„ä½¿ç”¨ï¼šä¸€èˆ¬é‡‡å–å…ˆç”¨æ ‡å‡†æµçˆ¶å…ƒç´ æ’åˆ—ä¸Šä¸‹ä½ç½®ï¼Œä¹‹ååœ¨å­å…ƒç´ é‡‡å–æµ®åŠ¨ï¼Œä½¿å¾—æµ®åŠ¨åœ¨ç½‘é¡µä¸­é—´è€Œä¸æ˜¯å·¦å³ä¾§ ä¸€èˆ¬ä¸€ä¸ªå…ƒç´ æµ®åŠ¨äº†ï¼Œä»–çš„å…„å¼Ÿæ ‡ç­¾æœ€å¥½ä¹Ÿä½¿ç”¨æµ®åŠ¨ 2.æ¸…é™¤æµ®åŠ¨å¸ƒå±€1.çˆ¶ç›’å­ä¸ç»™é«˜åº¦ï¼Œå­ç›’å­ä¼šè‡ªåŠ¨æ’‘å¼€ 2.çˆ¶ç›’å­ä¸ç»™é«˜åº¦çš„è¯ï¼Œå­ç›’å­å¦‚æœæ˜¯æµ®åŠ¨ï¼Œçˆ¶ç›’å­ä¼šå‘ç”Ÿé«˜åº¦å¡Œé™·ï¼Œå¯¼è‡´é«˜åº¦å˜æˆ0 æ‰€ä»¥æ€»ç»“ï¼šéœ€è¦æ¸…é™¤æµ®åŠ¨ï¼ï¼ï¼ clear: å±æ€§å€¼ ä¸€èˆ¬å±æ€§å€¼å–bothï¼ˆå¸¸ç”¨ï¼‰æ¸…æ¥šä¸¤ä¾§æµ®åŠ¨ï¼Œä¹Ÿæœ‰leftï¼Œright 1.é¢å¤–æ ‡ç­¾æ³•ï¼Œéš”å¢™æ³•ï¼ŒW3Cæ¨èåšæ³•åœ¨æµ®åŠ¨æ ‡ç­¾æœ€ååŠ å¤šä¸ªä¸€å­æ ‡ç­¾ï¼ˆå¿…é¡»æ˜¯å—çº§å…ƒç´ ï¼‰ï¼Œå¦‚ï¼š .clear{ clear: both; } &lt;div class=&quot;clear&quot;&gt;&lt;/div&gt;ä¼˜ç‚¹ï¼šé€šä¿—æ˜“æ‡‚ï¼Œä¹¦å†™æ–¹ä¾¿ ç¼ºç‚¹ï¼šç»“æ„åŒ–å·® 2.çˆ¶çº§æ·»åŠ overflowï¼ˆç”ŸæˆBFCå…ƒç´ ï¼‰ //çˆ¶çº§ç›’å­ .box{ overflow: hidden; //æˆ–è€…auto } ä¼˜ç‚¹ï¼šä»£ç ç®€æ´ ç¼ºç‚¹ï¼šæ— æ³•æ˜¾ç¤ºå‡ºæº¢å‡ºéƒ¨åˆ† 3.ï¼šafterä¼ªå…ƒç´ æ³•é¢å¤–æ ‡ç­¾çš„å‡çº§ç‰ˆï¼Œç»™çˆ¶å…ƒç´ æ·»åŠ  .clearfix::after { content: \"\"; display: block; //ä¼ªå…ƒç´ é»˜è®¤æ˜¯è¡Œå†…å…ƒç´ ï¼Œæ‰€ä»¥å¾—è½¬ height: 0; clear: both; visibility: hidden; } .clearfix { *zoom: 1; //å…¼å®¹ie6ï¼Œie7 } /*ä¸€èˆ¬ç±»åå®šä¹‰ä¸ºclearfix*/ ä¼˜ç‚¹ï¼šç»“æ„ç®€å• ç¼ºç‚¹ï¼šéœ€è¦ç…§é¡¾ä½ç‰ˆæœ¬æµè§ˆå™¨ ä»£è¡¨ç½‘ç«™ï¼šç™¾åº¦ï¼Œæ·˜å®ï¼Œç½‘æ˜“ 4.åŒä¼ªå…ƒç´ æ¸…é™¤æµ®åŠ¨.clearfix::before, .clearfix::after { content: &quot;&quot;; display: table; //è½¬åŒ–ä¸ºå—çº§ï¼Œå¹¶ä¸”ä¸€è¡Œæ˜¾ç¤º } .clear::after { clear: both; } .clearfix { *zoom: 1; //å…¼å®¹ie6ï¼Œie7 }ä¼˜ç¼ºç‚¹åŒä¸Šï¼Œä»£è¡¨ç½‘ç«™ï¼šå°ç±³ï¼Œè…¾è®¯ 3.CSSå®šä½1.æŸä¸ªå…ƒç´ å¯ä»¥åœ¨ç›’å­å†…ç§»åŠ¨ä½ç½®ï¼Œå¹¶ä¸”å‹ä½å…¶ä»–ç›’å­ã€‚ 2.æ»šåŠ¨çª—å£æ—¶ï¼Œç›’å­å›ºå®šäºå±å¹•æŸä¸ªä½ç½®ã€‚ å®šä½=å®šä½æ¨¡å¼+è¾¹åç§»é‡ å®šä½é€‰æ‹©å™¨{ position: static; position: relative; position: absolute; position: fixed; position: sticky; top: 100px; //å¿…å¤‡çš„æŒ‡å®šä½ç½®ï¼Œå¯ä»¥ä¸ºleftï¼Œrightï¼Œbottom } position: static; //é»˜è®¤ï¼Œæ— å®šä½,æ ‡å‡†æµç‰¹æ€§ position: relative; //ç›¸å¯¹å®šä½ï¼Œå‚ç…§ç‚¹æ˜¯è‡ªå·±ï¼Œç§»åŠ¨ä½ç½®åï¼ŒåŸæ¥çš„ä½ç½®ç»§ç»­å æœ‰ï¼ˆæ²¡æœ‰è„±æ ‡ï¼‰ position: absolute; //ç»å¯¹å®šä½ï¼Œæ˜¯ç›¸å¯¹äºä»–çš„ç¥–å…ˆå…ƒç´ ã€‚ 1.æ²¡æœ‰ç¥–å…ˆå…ƒç´ æˆ–è€…ï¼Œç¥–å…ˆå…ƒç´ æ²¡æœ‰ä½¿ç”¨å®šä½ï¼Œåˆ™ä»¥æµè§ˆå™¨ä¸ºå‡†ç›´æ¥åç§» 2.å¦‚æœç¥–å…ˆå…ƒç´ æœ‰å®šä½ï¼ˆç›¸å¯¹ï¼Œç»å¯¹ï¼Œå›ºå®šï¼‰ï¼Œåˆ™ä»¥æœ€è¿‘ä¸€çº§å®šä½çš„ç¥–å…ˆå…ƒç´ ä¸ºå‚è€ƒç‚¹ 3.ç»å¯¹å®šä½ä¸å†å æœ‰åŸæ¥çš„ä½ç½®ï¼ˆè„±æ ‡ï¼‰ 4.åŠ äº†ç»å¯¹å®šä½çš„ç›’å­ä¸èƒ½é€šè¿‡ margin: 0 auto; æ¥å±…ä¸­ï¼Œè®©å®ƒå±…ä¸­çš„åŸç†å’Œfixedè®¾ç½®ç‰ˆå¿ƒçš„åŸç†å·®ä¸å¤šï¼Œéƒ½æ˜¯leftï¼š50%+marginç»„åˆ position: fixed; //å›ºå®šäºæµè§ˆå™¨å¯è§†åŒºä½ç½®ï¼Œä¸å æœ‰åŸå…ˆä½ç½® 1.è¿˜å¯ä»¥è®¾ç½®äºç‰ˆå¿ƒé™„è¿‘ï¼Œæ–¹æ³•ï¼šè®©é‚£ä¸ªå›ºå®šå®šä½çš„ç›’å­ left: 50%,ç„¶åè®©å›ºå®šå®šä½çš„ç›’å­margin-leftï¼šç‰ˆå¿ƒçš„ä¸€åŠè·ç¦» position: sticky; //ç²˜æ€§å®šä½ï¼Œè¢«è®¤ä¸ºç›¸å¯¹å®šä½å’Œå›ºå®šå®šä½çš„æ··åˆä½“ relative -&gt; fixed 1.ä»¥æµè§ˆå™¨å¯è§†çª—å£ä¸ºå‚ç…§ç§»åŠ¨çš„å…ƒç´ ï¼ˆå›ºå®šç‰¹ç‚¹ï¼‰ 2.ç²˜æ€§å®šä½å æœ‰åŸå…ˆçš„ä½ç½® 3.å¿…é¡»æ·»åŠ topï¼Œleftç­‰ï¼Œä¸ç„¶ç›¸å½“äºç›¸å¯¹å®šä½ 4.å¸¸ç”¨äºå¯¼èˆªæ çš„æ»šåŠ¨ ç¼ºç‚¹ï¼šå¾ˆå¤šæ¯”è¾ƒè€çš„æµè§ˆå™¨éƒ½ä¸æ”¯æŒï¼ˆç§»åŠ¨ç«¯ä¸è€ƒè™‘ï¼‰ (å­ç»çˆ¶ç›¸â€”â€“å‡ºè‡ªpinkè€å¸ˆ) -&gt;&gt;&gt;&gt;&gt;&gt;&gt; â€”â€“&gt; å­çº§ä½¿ç”¨ç»å¯¹å®šä½ï¼Œçˆ¶äº²åˆ™éœ€è¦ä½¿ç”¨ç›¸å¯¹å®šä½ ä½ç½®å¦‚æœä¸€ä¸ªå®šä½æ—¢è®¾ç½®äº†leftï¼Œä¹Ÿè®¾ç½®äº†rightï¼Œå®ƒé»˜è®¤ä¼šæ‰§è¡Œleftã€‚è‹¥åŠè®¾ç½®äº†topï¼Œä¹Ÿè®¾ç½®äº†bottomï¼Œä¼šé»˜è®¤æ‰§è¡Œtopï¼ˆæ— å…³æƒé‡çš„äº‹æƒ…ï¼‰ å®šä½å æ”¾æ¬¡åºé€šè¿‡æ§åˆ¶z-indexæ¥æ§åˆ¶ç›’å­çš„å‰åæ¬¡åºï¼ˆå æ”¾æ¬¡åºï¼‰z-indexï¼š 1; 1.æ•°å€¼è¶Šå¤§ç›’å­è¶Šé ä¸Š 2.å¦‚æœå€¼ç›¸åŒï¼ŒæŒ‰ç…§ä¹¦å†™é¡ºåºï¼Œåæ¥å±…ä¸Š 3.æ•°å­—ä¸èƒ½åŠ å•ä½ 4.åªæœ‰å®šä½ç›’å­æ‰æœ‰z-indexå±æ€§ï¼ˆè¿˜æœ‰flexï¼‰ 5.å¦‚æœè¯¥ç›’å­çˆ¶ç›’å­å±‚çº§ä½¿ç”¨äº†å®šä½+z-indexï¼Œä½†æ˜¯çˆ¶ç›’å­çš„z-indexå€¼æ¯”è¾ƒä½ï¼Œåœ¨â€œæ‹¼çˆ¹â€çš„è§„åˆ™åº•ä¸‹ï¼Œå³ä½¿å­ç›’å­æœ¬èº«z-indexå†å¤§ï¼Œä¹Ÿä¼šè¢«å‹ç€ å®šä½çš„ç‰¹æ®Šæ€§è´¨1.è¡Œå†…å…ƒç´ æ·»åŠ ç»å¯¹æˆ–å›ºå®šå®šä½ï¼Œå¯ä»¥ç›´æ¥è®¾ç½®é«˜åº¦å’Œå®½åº¦ 2.å—çº§å…ƒç´ æ·»åŠ ç»å¯¹æˆ–å›ºå®šå®šä½ï¼Œæœªè®¾ç½®å®½é«˜ï¼Œä¼šè„±æ ‡ï¼Œé»˜è®¤å†…å®¹å¤§å°ï¼ˆç±»ä¼¼æµ®åŠ¨ï¼‰ï¼ˆä¸ä¼šå‘ç”Ÿå¤–è¾¹è·åˆå¹¶ï¼‰ 3.å’Œæµ®åŠ¨ä¸åŒï¼Œç»å¯¹æˆ–å›ºå®šå®šä½ä¼šå‹ä½ä½ æ ‡å‡†æµæ–‡å­—ç­‰å†…å®¹ 4.å…ƒç´ çš„æ˜¾ç¤ºå’Œéšè—1.displaydisplay: none; éšè—å¯¹è±¡ï¼ˆä¸å†å æœ‰åŸæ¥çš„ä½ç½®ï¼Œå¯ä»¥ç”¨äºjsçš„ä¸‹æ‹‰èœå•ç­‰åŠŸèƒ½ï¼‰ display: block; æ˜¾ç¤ºå¯¹è±¡ï¼ˆä¹Ÿå¯ä»¥æ˜¯è½¬æ¢å—å…ƒç´ ï¼‰ 2.visiblevisibility: visible; å…ƒç´ å¯è§† visibility: hidden; å…ƒç´ éšè—ï¼ˆä»ç„¶å æœ‰åŸæ¥ä½ç½®ï¼‰ 3.overflowoverflow: visible; è¶…å‡ºä½ çš„æ ‡ç­¾éƒ¨åˆ†ï¼ˆå›ºå®šå¤§å°ï¼‰å¯è§ overflow: hidden; è¶…å‡ºä½ çš„æ ‡ç­¾éƒ¨åˆ†ï¼ˆå›ºå®šå¤§å°ï¼‰éšè—ï¼Œå¦‚æœæœ‰å®šä½çš„ç›’å­æ…ç”¨ï¼Œä»–ä¼šåˆ‡æ‰ä½ æº¢å‡ºå¸ƒå±€æ ‡ç­¾çš„éƒ¨åˆ† overflow: scroll; å¯æ·»åŠ æ»šåŠ¨æ¡ overflow: auto; éœ€è¦çš„æ—¶å€™æ·»åŠ æ»šåŠ¨æ¡ 5.æ–‡æ¡£æµæµ®åŠ¨å’Œå®šä½ä¸€äº›å±æ€§ä¼šè„±ç¦»æ–‡æ¡£æµ å…¶å®è¿˜æœ‰ä¸€ä¸ªæ–‡æœ¬æµï¼Œå®ƒå…¶å®å°±æ˜¯ä¸€ç³»åˆ—å­—ç¬¦ï¼Œæ˜¯æ–‡æ¡£çš„è¯»å–å’Œè¾“å‡ºé¡ºåºï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬é€šå¸¸çœ‹åˆ°çš„ç”±å·¦åˆ°å³ã€ç”±ä¸Šè€Œä¸‹çš„è¯»å–å’Œè¾“å‡ºå½¢å¼ã€‚ åªæœ‰postionä¸€äº›å±æ€§å¯ä»¥ä»æ–‡æœ¬æµè„±ç¦»å‡ºæ¥ æ–‡æ¡£æµæ˜¯ç›¸å¯¹äºç›’å­æ¨¡å‹è®²çš„æ–‡æœ¬æµæ˜¯ç›¸å¯¹äºæ–‡å­—æ®µè½è®²çš„ æ‰€ä»¥æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æµ®åŠ¨çš„æ—¶å€™æ–‡å­—ç¯ç»•çš„å½¢å¼ï¼Œè¯´æ˜æµ®åŠ¨å¹¶æ²¡æœ‰è„±ç¦»æ–‡æœ¬æµï¼›ä½†æ˜¯positionä¸­çš„absoluteå’Œfixedå…¨éƒ¨è„±ç¦»ã€‚ mdn: ä¸‹åˆ—å…ƒç´ ä¼šè„±ç¦»å¸¸è§„æµ: floated itemsã€‚æµ®åŠ¨çš„å…ƒç´  items with position: absolute (including position: fixed which acts in the same way)ã€‚é€šè¿‡è®¾ç½®positionå±æ€§ä¸ºabsoluteæˆ–è€…fixedçš„å…ƒç´  the root element (html)æ ¹å…ƒç´ ","categories":[{"name":"å‰ç«¯","slug":"å‰ç«¯","permalink":"https://taylor12138.github.io/categories/%E5%89%8D%E7%AB%AF/"}],"tags":[],"author":"Hello"},{"title":"CSSæ ·å¼","slug":"CSSæ ·å¼","date":"2020-05-09T16:00:00.000Z","updated":"2022-11-23T08:22:47.295Z","comments":true,"path":"2020/05/10/css-yang-shi/","link":"","permalink":"https://taylor12138.github.io/2020/05/10/css-yang-shi/","excerpt":"","text":"å£°æ˜ï¼šå¯ä»¥ä½¿ç”¨chromeçš„F12æµè§ˆå­¦ä¹ åˆ«äººçš„æ ·å¼å¹¶ä¸”è°ƒè¯•ä½ çš„ä»£ç  å¼•å…¥CSS/*1ï¼‰linkçš„å†™æ³•ï¼š*/ &lt;link rel=\"stylesheet\" href=\"index.css\"> /*2ï¼‰importçš„å†™æ³•ï¼š*/ &lt;style type=â€text/cssâ€> @import urlï¼ˆâ€œindex.cssâ€ï¼‰ï¼› &lt;/style> linkå’Œ@importçš„åŒºåˆ«ï¼š ï¼ˆ1ï¼‰linkæ˜¯XHTMLæ ‡ç­¾ï¼Œæ— å…¼å®¹é—®é¢˜ï¼›@importæ˜¯åœ¨CSS2.1æå‡ºçš„ï¼Œä½ç‰ˆæœ¬çš„æµè§ˆå™¨ä¸æ”¯æŒã€‚ ï¼ˆ2ï¼‰linkå¯ä»¥åŠ è½½CSSï¼ŒJavascriptï¼›@importåªèƒ½åŠ è½½CSSã€‚ ï¼ˆ3ï¼‰linkåŠ è½½çš„å†…å®¹æ˜¯ä¸é¡µé¢åŒæ—¶åŠ è½½ï¼›@importéœ€è¦é¡µé¢ç½‘é¡µå®Œå…¨è½½å…¥ä»¥ååŠ è½½ã€‚ï¼ˆæ‰€ä»¥æœ‰æ—¶å€™æµè§ˆ@importåŠ è½½CSSçš„é¡µé¢æ—¶ä¼šæ²¡æœ‰æ ·å¼ï¼ˆå°±æ˜¯é—ªçƒï¼‰ï¼Œç½‘é€Ÿæ…¢çš„æ—¶å€™è¿˜æŒºæ˜æ˜¾ã€‚ï¼‰ 1.ä¸»è¦å®šä¹‰/*æ˜¯ç±»å‹é€‰æ‹©,æ ‡ç­¾é€‰æ‹©å™¨*/ å…ƒç´ ï¼ˆæ ‡ç­¾ï¼‰ { } /*é€‰æ‹©æ‰€æœ‰å…ƒç´ */ * { } /*çš„é€‰æ‹© é€‰æ‹©å¤šä¸ªç±»å¯ä»¥ &lt;div class=\"ç±»1 ç±»2\">&lt;/div>*/ .class(ç±»å) { } /*idçš„é€‰æ‹©,æœ‰ç‚¹ç±»ä¼¼classï¼Œåªèƒ½è°ƒç”¨ä¸€æ¬¡ï¼Œåˆ«äººåˆ‡å‹¿ä½¿ç”¨*/ #(idå) { } /*å¤åˆï¼Œåä»£é€‰æ‹©å™¨*/ å…ƒç´ 1ï¼ˆå¯ä»¥æ˜¯ç±»åï¼‰ å…ƒç´ 2ï¼ˆå¯ä»¥æ˜¯ç±»åï¼‰ { } /*åªé€‰æ‹©äº²å„¿å­ï¼Œå­™å­ä¸é€‰*/ å…ƒç´ 1ï¼ˆå¯ä»¥æ˜¯ç±»åï¼‰>å…ƒç´ 2ï¼ˆå¯ä»¥æ˜¯ç±»åï¼‰ { } /*å¹¶é›†é€‰æ‹©å™¨ï¼Œå¤šä¸ªç»Ÿä¸€*/ å…ƒç´ 1, å…ƒç´ 2 { } /*é€‰æ‹©ç±»å1çš„ä¸‹ä¸€ä¸ªå…„å¼ŸèŠ‚ç‚¹å…ƒç´ 2*/ ç±»å1+å…ƒç´ 2 { } /*m-small-cont å†™æˆ &amp;-contçš„å½¢å¼ï¼Œ &amp; è¡¨ç¤ºåµŒå¥—çš„ä¸Šä¸€çº§*/ .m-small { &amp;-cont { } } æ³¨æ„ï¼šå¦‚æœä¸€ä¸ªå…ƒç´ æ‹¥æœ‰IDå±æ€§,é‚£ä¹ˆIDå±æ€§çš„å±æ€§å€¼å°±ä¼šæˆä¸ºwindowå¯¹è±¡çš„å±æ€§å æ–‡å­—æ³¨æ„ï¼šchromeé»˜è®¤æœ€å°å±•ç°å­—ä½“ä¸º12pxï¼Œæƒ³è¦æŸ¥çœ‹éœ€è¦åœ¨æµè§ˆå™¨è®¾ç½®ä¸­è®¾ç½® PCç«¯è§£å†³å°äº12pxå­—ä½“é—®é¢˜çš„é¡µé¢ï¼Œéœ€è¦è‡ªè¡Œè®¾ç½®ä½¿ç”¨transformå±æ€§ï¼ˆscaleï¼‰å¯¹é¡µé¢è¿›è¡Œç¼©æ”¾è§£å†³ font-size: 12px 12åƒç´ å¤§å°æ–‡å­— è°·æ­Œé»˜è®¤16px font-size: 12px 12åƒç´ å¤§å°æ–‡å­— è¡Œé«˜ä¸º12*1.5=18 font-weight: xxx å­—ä½“åŠ ç²— text-align: center æ–‡å­—æ°´å¹³å±…ä¸­å¯¹é½ text-indent: 10px æ–‡æœ¬é¦–è¡Œç¼©è¿›,æœ€å¥½ä½¿ç”¨emï¼Œå¦‚text-indent: 2em,emæ˜¯ç›¸å¯¹å•ä½ï¼Œå½“å‰1ä¸ªæ–‡å­—å…ƒç´ çš„å¤§å° text-decoration: noneå–æ¶ˆä¸‹åˆ’çº¿ line-height: 26px è¡Œé—´è·ï¼Œç”¨QQæˆªå›¾å¯ä»¥å·å·æµ‹é‡ï¼Œç­‰äºç›’å­é«˜åº¦æ—¶å‚ç›´å±…ä¸­ white-space: val; CSS å±æ€§æ˜¯ç”¨æ¥è®¾ç½®å¦‚ä½•å¤„ç†å…ƒç´ ä¸­çš„ ç©ºç™½ (en-US)ã€‚ normal è¿ç»­çš„ç©ºç™½ç¬¦ä¼šè¢«åˆå¹¶ï¼Œæ¢è¡Œç¬¦ä¼šè¢«å½“ä½œç©ºç™½ç¬¦æ¥å¤„ç†ã€‚æ¢è¡Œåœ¨å¡«å……ã€Œè¡Œæ¡†ç›’å­(line boxes)ã€æ—¶æ˜¯å¿…è¦ã€‚ nowrap å’Œ normal ä¸€æ ·ï¼Œè¿ç»­çš„ç©ºç™½ç¬¦ä¼šè¢«åˆå¹¶ã€‚ä½†æ–‡æœ¬å†…çš„æ¢è¡Œæ— æ•ˆã€‚ pre è¿ç»­çš„ç©ºç™½ç¬¦ä¼šè¢«ä¿ç•™ã€‚åœ¨é‡åˆ°æ¢è¡Œç¬¦æˆ–è€…``å…ƒç´ æ—¶æ‰ä¼šæ¢è¡Œã€‚ pre-wrap è¿ç»­çš„ç©ºç™½ç¬¦ä¼šè¢«ä¿ç•™ã€‚åœ¨é‡åˆ°æ¢è¡Œç¬¦æˆ–è€…``å…ƒç´ ï¼Œæˆ–è€…éœ€è¦ä¸ºäº†å¡«å……ã€Œè¡Œæ¡†ç›’å­(line boxes)ã€æ—¶æ‰ä¼šæ¢è¡Œã€‚ pre-line è¿ç»­çš„ç©ºç™½ç¬¦ä¼šè¢«åˆå¹¶ã€‚åœ¨é‡åˆ°æ¢è¡Œç¬¦æˆ–è€…``å…ƒç´ ï¼Œæˆ–è€…éœ€è¦ä¸ºäº†å¡«å……ã€Œè¡Œæ¡†ç›’å­(line boxes)ã€æ—¶ä¼šæ¢è¡Œã€‚ èƒŒæ™¯background-color //èƒŒæ™¯é¢œè‰² ä½¿ç”¨èƒŒæ™¯æ¸å˜è‰²ï¼š linear-gradient background: linear-gradient(90deg,#9370DB,#AFEEEE,#FFA500,#9370DB); background: rgba(redï¼ˆæ•°å€¼ï¼‰,green(æ•°å€¼),blueï¼ˆæ•°å€¼ï¼‰ï¼Œé€æ˜åº¦ï¼ˆ0-1ï¼‰) //èƒŒæ™¯é¢œè‰² é€æ˜åŒ– background-image: url(åœ°å€)//èƒŒæ™¯å›¾ç‰‡ï¼Œå¸¸è§äºæ ‡å¿—ï¼Œlogoæˆ–è€…è¶…å¤§èƒŒæ™¯å›¾ç‰‡ï¼Œæœ‰ç‚¹æ˜¯ä¾¿äºæ§åˆ¶ä½ç½® baackground-repeat: no-repeat//èƒŒæ™¯å¹³é“ºï¼Œé»˜è®¤ä¸ºå¹³é“ºï¼Œå¯ä»¥æ”¹æˆå–æ¶ˆå¹³é“º background-position: x y//èƒŒæ™¯å›¾ç‰‡çš„ä½ç½® ï¼Œå¯ä»¥ä½¿ç”¨æ–¹ä½åè¯ï¼Œå‰åé¡ºåºå¯å¯ä»¥ä¸ä¸€æ ·topï¼Œcenter ï¼Œbottonï¼Œleftç­‰ï¼ˆåªå†™ä¸€ä¸ªå¦å¤–ä¸€ä¸ªé»˜è®¤å±…ä¸­ï¼‰ã€‚ä¹Ÿå¯ä»¥ä½¿ç”¨ç²¾ç¡®å•ä½xè½´é•¿åº¦ï¼Œyè½´é•¿åº¦ï¼Œï¼ˆåªå†™ä¸€ä¸ªå¦å¤–ä¸€ä¸ªé»˜è®¤å±…ä¸­ï¼‰ background-attachment: scroll||fixed//èƒŒæ™¯å›¾åƒéšå¯¹è±¡å†…å®¹æ»šåŠ¨||èƒŒæ™¯å›¾åƒå›ºå®š` backgroundçš„å¤åˆæ–¹å¼ï¼ˆåˆ†åˆ«å¯¹åº”å›¾ç‰‡ä½ç½®ã€å›¾ç‰‡å¤§å°ï¼Œæ˜¯å¦é‡å¤ï¼Œurlåœ°å€ï¼‰ background: left 5% / 60% 60% no-repeat-x url(); åˆ—è¡¨list-style: none//å»æ‰æ— åºåˆ—è¡¨é‡Œ li åˆ—è¡¨å‰é¢çš„å°åœ†ç‚¹ é˜´å½±box-shadow: 10px 10px 5px #888888; åˆ†åˆ«å¯¹åº”é˜´å½±çš„æ°´å¹³ï¼Œå‚ç›´å’Œé˜´å½±ï¼Œé¢œè‰² text-shadow: 1px 1px rgba(0,0,0,.2); æ–‡å­—é˜´å½±æ•ˆæœ inputoutline: none; æ¶ˆé™¤è¾“å…¥è¾¹æ¡† border: 0; æ¶ˆé™¤è¾“å…¥æ¡†çš„è‡ªå¸¦è¾¹æ¡† é€æ˜opacity: 0.5 åŠé€æ˜ opacity: 1 ä¸é€æ˜ opacity / display none / visibility çš„ä¸åŒï¼šhttps://segmentfault.com/a/1190000015116392 box-sizingbox-sizing å±æ€§å¯ä»¥è¢«ç”¨æ¥è°ƒæ•´è¿™äº›è¡¨ç°: content-box æ˜¯é»˜è®¤å€¼ã€‚å¦‚æœä½ è®¾ç½®ä¸€ä¸ªå…ƒç´ çš„å®½ä¸º100pxï¼Œé‚£ä¹ˆè¿™ä¸ªå…ƒç´ çš„å†…å®¹åŒºä¼šæœ‰100px å®½ï¼Œå¹¶ä¸”ä»»ä½•è¾¹æ¡†å’Œå†…è¾¹è·çš„å®½åº¦éƒ½ä¼šè¢«å¢åŠ åˆ°æœ€åç»˜åˆ¶å‡ºæ¥çš„å…ƒç´ å®½åº¦ä¸­ã€‚ border-box å‘Šè¯‰æµè§ˆå™¨ï¼šä½ æƒ³è¦è®¾ç½®çš„è¾¹æ¡†å’Œå†…è¾¹è·çš„å€¼æ˜¯åŒ…å«åœ¨widthå†…çš„ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœä½ å°†ä¸€ä¸ªå…ƒç´ çš„widthè®¾ä¸º100pxï¼Œé‚£ä¹ˆè¿™100pxä¼šåŒ…å«å®ƒçš„borderå’Œpaddingï¼Œå†…å®¹åŒºçš„å®é™…å®½åº¦æ˜¯widthå‡å»(border + padding)çš„å€¼ã€‚å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œè¿™ä½¿å¾—æˆ‘ä»¬æ›´å®¹æ˜“åœ°è®¾å®šä¸€ä¸ªå…ƒç´ çš„å®½é«˜ã€‚ border-boxä¸åŒ…å«margin å°ºå¯¸å•ä½ pxå•ä½ï¼Œåƒç´ å•ä½ emå•ä½ï¼Œemæ˜¯ç›¸å¯¹äºçˆ¶å…ƒç´ çš„å­—ä½“å¤§å°ï¼Œå¦‚çˆ¶å…ƒç´ çš„font-sizeä¸º12pxï¼Œå­å…ƒç´ è®¾ç½®å®½é«˜ä¸º10emï¼Œåˆ™å¤§å°å®é™…ä¸º10*12=120px remå•ä½ï¼Œç›¸å¯¹äºhtmlå­—ä½“å¤§å° %å•ä½ï¼Œç»§æ‰¿çˆ¶å…ƒç´ å•ä½ dpå•ä½ï¼Œå±å¹•å¯†åº¦ vhå•ä½ï¼Œviewpoint heightï¼Œè§†çª—é«˜åº¦ï¼Œ1vhç­‰äºè§†çª—é«˜åº¦çš„1%ã€‚ vwå•ä½ï¼Œviewpoint widthï¼Œè§†çª—å®½åº¦ï¼Œ1vwç­‰äºè§†çª—å®½åº¦çš„1%ã€‚ è§†åŒºâ€æ‰€æŒ‡ä¸ºæµè§ˆå™¨å†…éƒ¨çš„å¯è§†åŒºåŸŸå¤§å°ï¼Œå³window.innerWidth/window.innerHeightå¤§å°ï¼Œä¸åŒ…å«ä»»åŠ¡æ æ ‡é¢˜æ ä»¥åŠåº•éƒ¨å·¥å…·æ çš„æµè§ˆå™¨åŒºåŸŸå¤§å°ã€‚ dpr ç‰©ç†åƒç´ æ¯” pcç«¯ä¸€èˆ¬éƒ½æ˜¯1ï¼Œç§»åŠ¨ç«¯æ¯”å¦‚iPhone6/7/8éƒ½æ˜¯2ï¼Œç§»åŠ¨ç«¯ä¸å°½ç›¸åŒ var dpr = window.devicePixelRatio || 1 vhè§†çª—å•ä½ç»™ç§»åŠ¨ç«¯å¼€å‘çš„é€‚é…æ˜¯å¸¦æ¥äº†æå¤§çš„ä¼˜åŠ¿ï¼Œä½†æˆ‘æƒ³ä½ åœ¨ä½¿ç”¨è§†çª—å•ä½çš„æ—¶å€™ï¼Œåº”è¯¥ä¹Ÿç¢°åˆ°äº†iOSä¸Š Safari çš„å…¼å®¹æ€§é—®é¢˜ã€‚å› ä¸ºï¼Œåœ¨iOSä¸Šçš„ Safari æœ‰ä¸€ä¸ªé•¿æœŸå­˜åœ¨çš„ï¼Œæå…¶æ¼äººçš„Bugï¼Œå®ƒä¸èƒ½ä¸ vh å•ä½å¾ˆå¥½çš„é…åˆã€‚å¦‚æœä½ å°†ä¸€ä¸ªå®¹å™¨çš„é«˜åº¦è®¾ç½®ä¸º 100vh æ—¶ï¼Œä¼šå¯¼è‡´è¿™ä¸ªå…ƒç´ æœ‰ç‚¹å¤ªé«˜ï¼ˆä¼šå‡ºç°æ»šåŠ¨æ¡ï¼‰ã€‚é€ æˆè¿™ç§ç°è±¡çš„ä¸»è¦åŸå› æ˜¯ç§»åŠ¨ç«¯ä¸Šçš„ Safari åœ¨è®¡ç®— 100vh æ—¶å¿½ç•¥äº†å®ƒçš„éƒ¨åˆ†ç”¨æˆ·ç•Œé¢ã€‚ è¿™æ˜¯ç”±äº Safari å’Œ Chrome ä½¿ç”¨çš„è®¡ç®—æ–¹æ³•é€ æˆçš„ ä½œè€…Luke Channingsäº2021 å¹´ 6 æœˆ 11 æ—¥ Safari çš„æ–°æµ®åŠ¨åœ°å€æ æ˜¾ç¤ºåœ¨æˆ‘ä»¬çš„æµ‹è¯•æŒ‰é’®ä¸Šæ–¹ï¼Œè¿™æˆ–å¤šæˆ–å°‘ä¸ iOS 14 çš„è¡Œä¸ºå®Œå…¨ç›¸åŒã€‚ ä»ç„¶è¯´Safari 15 ä¸ä¼šæ”¹å˜100vhğŸ˜¢ çš„è¡Œä¸ºã€‚ è§£å†³æ–¹æ¡ˆï¼š æ–¹æ¡ˆ1 Letâ€™s get started first with the JS file: æ‚¨å§‹ç»ˆå¯ä»¥é€šè¿‡ä½¿ç”¨å…¨å±€å˜é‡æ¥è·å–å½“å‰è§†å£çš„å€¼window.innerHeightã€‚è¯¥å€¼å°†æµè§ˆå™¨çš„ç•Œé¢è€ƒè™‘åœ¨å†…ï¼Œå¹¶åœ¨å…¶å¯è§æ€§æ›´æ”¹æ—¶æ›´æ–° const appHeight = () =&gt; { const doc = document.documentElement doc.style.setProperty(â€˜ â€” app-heightâ€™, `${window.innerHeight}px`) } window.addEventListener(â€˜resizeâ€™, appHeight) appHeight()appHeight function has sets new style property var(â€” app-height) including current window height, â€” app-height it is necessary for next steps. :root { â€” app-height: 100%; }html, body { padding: 0; margin: 0; overflow: hidden; width: 100vw; height: 100vh; height: var( â€” app-height); }In the previous step Iâ€™ve created the reference â€” app-height, wrapping in the var() Iâ€™ve received CSS variable var( â€” app-height). This variable is allowed to read values created by JS. æ–¹æ¡ˆ2 CSS solution (not recommend)The last, but not the least solution is â€” webkit-fill-available, this solution works only on Apple devices, it wonâ€™t solve the problem on Android devices. I donâ€™t recommend this solution, but itâ€™s worth showing. è¯€çªåœ¨äºmin-height: -webkit-fill-available;body ä½œä¸ºå¯¹ çš„æ¸è¿›å¢å¼º100vhï¼Œå®ƒåº”è¯¥é€‚ç”¨äº iOS è®¾å¤‡ã€‚ height: 100%; height: -webkit-fill-available;ä½†æ˜¯æ–¹æ³•äºŒåœ¨æ—¶å¯èƒ½å‡ºç°çš„å…¶ä»–é—®é¢˜ï¼ˆä¾‹å¦‚ï¼Œå¯¹æ—‹è½¬è®¾å¤‡çš„å½±å“ã€Chrome æ²¡æœ‰å®Œå…¨å¿½ç•¥è¯¥å±æ€§ç­‰ï¼‰ã€‚ å‚è€ƒï¼š 100vh problem with iOS Safari ç§»åŠ¨ WebKit ä¸­ 100vh çš„ CSS ä¿®å¤ 2.ä¼ªç±»é€‰æ‹©å™¨/*aè¶…é“¾æ¥ç±» æˆ–è€…å†™æˆ açš„ç±»å:XXX{}*/ a:link é€‰æ‹©æ‰€æœ‰æœªè®¿é—®çš„é“¾æ¥ a:visited é€‰æ‹©æ‰€æœ‰å·²è¢«è®¿é—®çš„é“¾æ¥ a:hover å¸¸ç”¨ï¼Œé€‰æ‹©é¼ æ ‡æŒ‡å‘çš„é“¾æ¥ a:ative é¼ æ ‡æŒ‰ä¸‹æœªå¼¹èµ·çš„é“¾æ¥ /*å¦‚æœå…¨éƒ¨éƒ½å†™ï¼Œè¯·æŒ‰ç…§LVHAçš„é¡ºåºå†™*/ /*inputç±»ï¼ŒæŠŠè·å¾—å…‰æ ‡çš„inuté€‰å–å‡ºæ¥æ”¹å†™CSS*/ input:focus 3.è¡Œå—è½¬æ¢display:block /*è½¬å—å…ƒç´ */ display:inline /*è½¬è¡Œå†…å…ƒç´ */ display: inline-block /*è½¬è¡Œå†…å—*/ displat: table /*æˆä¸ºä¸€ä¸ªå—çº§è¡¨æ ¼å…ƒç´ */ display: table-cell /*ä½¿å­å…ƒç´ æˆä¸ºè¡¨æ ¼å•å…ƒæ ¼*/ /*ä½¿æ–‡å­—å‚ç›´å±…ä¸­ è®©æ–‡å­—è¡Œé«˜=ç›’å­çš„è¡Œé«˜ è¡Œé«˜>ç›’å­é«˜åº¦åä¸‹ï¼Œ&lt;åä¸Š*/ line-height: ç›’å­é«˜åº¦ å¤šè¡Œæ–‡å­—å±…ä¸­ çˆ¶å…ƒç´  displayçš„table + å­å…ƒç´ ï¼štable-cell vertical-align: middle é…åˆå¯ä»¥å®ç°å¤šè¡Œæ–‡å­—å±…ä¸­ çˆ¶å…ƒç´ è®¾ç½®å¯¹åº”çš„heightå’Œline-height å­å…ƒç´ è®¾ç½®display:inline-block + vertical-align:middle() + line-height (ç¼ºç‚¹ï¼šæ–‡æœ¬çš„é«˜åº¦ä¸èƒ½è¶…è¿‡å¤–éƒ¨ç›’å­çš„é«˜åº¦ã€‚) .parent { height: 300px; line-height: 300px; } .son { display: inline-block; width: 300px; line-height: 20px; vertical-align: middle; } CSSæ°´å¹³å‚ç›´å±…ä¸­æ–¹å¼1.ç»å¯¹å®šä½ position: absolute; top: 50%; left: 50%; transform:translate(-50%,-50%); 2.flexå¸ƒå±€ .parent{ display:flex; justify-content:center; align-content:center; } 3.gridå¸ƒå±€ï¼Œæ¯”flexçš„å…¼å®¹æ€§è¿˜ä½ .parent { display: grid; } .child { align-self: center; justify-self: center; } .parent{ display: grid; place-items: center; } 4.table-cell + vertical + text-align .parent { display: table-cell; vertical-align: middle; text-align: center; } .child { display: inline-block; } 5.table-cell + vertical + margin .parent { display: table-cell; vertical-align: middle; } .child { /*åŠ ä¸Š display: table å…¼å®¹ie7*/ margin: 0 auto; } 6.è¡Œå†…å…ƒç´ æ°´å¹³å‚ç›´å±…ä¸­ text-align: center; line-height: 300px; /*å’Œç›’å­é«˜åº¦ä¿æŒä¸€è‡´*/ å…³äºä¹å®«æ ¼æ ·å¼å¸ƒå±€å¯ä»¥å‚è€ƒä»¥ä¸‹é“¾æ¥åšä¸»çš„è®²è§£ï¼Œå¾ˆè¯¦ç»† https://juejin.cn/post/6886770985060532231#heading-2 displayå’Œvisibilitydisplay: noneï¼šè¯¥å…ƒç´ ä»¥åŠå®ƒçš„æ‰€æœ‰åä»£å…ƒç´ éƒ½ä¼šéšè—ï¼Œæ— æ³•ä½¿ç”¨å±å¹•é˜…è¯»å™¨ç­‰è¾…åŠ©è®¾å¤‡è®¿é—®ï¼Œå æ®çš„ç©ºé—´æ¶ˆå¤± visibility: hiddenï¼šä¹Ÿå¯ä»¥éšè—è¿™ä¸ªå…ƒç´ ï¼Œä½†æ˜¯éšè—å…ƒç´ ä»éœ€å ç”¨ä¸æœªéšè—æ—¶ä¸€æ ·çš„ç©ºé—´ï¼Œä¹Ÿå°±æ˜¯è¯´è™½ç„¶å…ƒç´ ä¸å¯è§äº†ï¼Œä½†æ˜¯ä»ç„¶ä¼šå½±å“é¡µé¢å¸ƒå±€ã€‚ï¼ˆä¹Ÿå°±æ˜¯ä»ç„¶å æ®ç©ºé—´ï¼Œåªæ˜¯éšè—èµ·æ¥ï¼‰ é™¤äº†å æ®ç©ºé—´è¿™ä¸ªé‡å¤§çš„åŒºåˆ«ä¹‹å¤–ï¼Œè¿˜æœ‰2ä¸ªåŒºåˆ«ï¼š visibilityå…·æœ‰ç»§æ‰¿æ€§ï¼Œç»™çˆ¶å…ƒç´ è®¾ç½®visibility:hidden;å­å…ƒç´ ä¹Ÿä¼šç»§æ‰¿è¿™ä¸ªå±æ€§ã€‚ä½†æ˜¯å¦‚æœé‡æ–°ç»™å­å…ƒç´ è®¾ç½®visibility: visible,åˆ™å­å…ƒç´ åˆä¼šæ˜¾ç¤ºå‡ºæ¥ã€‚è¿™ä¸ªå’Œdisplay: noneæœ‰ç€è´¨çš„åŒºåˆ« visibility: hiddenä¸ä¼šå½±å“è®¡æ•°å™¨çš„è®¡æ•°ï¼Œå¦‚å›¾æ‰€ç¤ºï¼Œvisibility: hiddenè™½ç„¶è®©ä¸€ä¸ªå…ƒç´ ä¸è§äº†ï¼Œä½†æ˜¯å…¶è®¡æ•°å™¨ä»åœ¨è¿è¡Œã€‚è¿™å’Œdisplay: noneå®Œå…¨ä¸ä¸€æ · è§£å†³è¡Œå†…å…ƒç´ é€ æˆçš„é—´è· ç»™å…¶çˆ¶å…ƒç´ æ·»åŠ äº†font-size:0 ä½†æ˜¯æ³¨æ„ï¼šIE6ï¼ŒIE7æµè§ˆå™¨å½“è®¾ç½®font-sizeï¼š0æ—¶ï¼Œæ¢è¡Œç¬¦ã€tabï¼ˆåˆ¶è¡¨ç¬¦ï¼‰ã€ç©ºæ ¼å§‹ç»ˆå­˜åœ¨1pxçš„ç©ºéš™è€Œæœ€æ–°ç‰ˆæœ¬çš„Safariæµè§ˆå™¨ï¼ŒChromeæµè§ˆå™¨ä¸æ”¯æŒå­—ä½“å¤§å°ä¸º0çš„æµè§ˆå™¨ è®¾ç½®æµ®åŠ¨ï¼ˆä¸è¿‡å¯èƒ½ä¼šæœ‰å¸ƒå±€é—®é¢˜ï¼‰ è®¾ç½®marginä¸ºè´Ÿå€¼ï¼ˆæ„Ÿè§‰ä¸å¤ªå¥½ï¼‰ å°†è¡Œå†…æ ‡ç­¾éƒ½æ”¾åœ¨åŒä¸€è¡Œä¸Š 4.CSSçš„ä¸‰å¤§ç‰¹æ€§1.å±‚å æ€§æ ·å¼å†²çªé€‰æ‹©å°±è¿‘åŸåˆ™ï¼ŒæŠŠå‰é¢çš„è¦†ç›–æ‰ï¼Œä¸å†²çªçš„ä¸è¦†ç›– 2.ç»§æ‰¿æ€§å­æ ‡ç­¾ä¼šç»§æ‰¿çˆ¶æ ‡ç­¾çš„å±æ€§ 3.ä¼˜å…ˆçº§1.é€‰æ‹©å™¨ç›¸åŒï¼Œæ‰§è¡Œå±‚å æ€§ 2.é€‰æ‹©å™¨ä¸åŒï¼Œç»§æ‰¿/*(0,0,0,0)&lt;å…ƒç´ (0,0,0,1)&lt;ç±»(0,0,1,0)&lt;id(0,1,0,0)&lt;è¡Œå†…æ ·å¼style(1,0,0,0)&lt;ï¼importantæ— é™å¤§ ï¼ˆå±æ€§é€‰æ‹©å™¨input[class^=icon]{} æ˜¯ï¼ˆ0,0,0,1ï¼‰ï¼ˆ0,0,1,0ï¼‰ ï¼‰ ï¼ˆï¼importantåŠ åœ¨æŸå±æ€§åé¢ï¼Œå¦‚color: green!importantï¼‰ ç»§æ‰¿çš„ä½ åŠ äº†ï¼importantï¼Œæƒå€¼è¿˜æ˜¯ï¼ˆ0ï¼Œ0ï¼Œ0ï¼Œ0ï¼‰ï¼Œæ¯•ç«Ÿæ˜¯ç»§æ‰¿è¿‡æ¥çš„ 3.å¤åˆé€‰æ‹©å™¨æœ‰æƒé‡å åŠ çš„é—®é¢˜ ul li{}æƒé‡ä¸º(0,0,0,1)+(0,0,0,1) liä¸º(0,0,0,1) .nav liä¸ºï¼ˆ0ï¼Œ0ï¼Œ1ï¼Œ1ï¼‰ æƒé‡ä¼šå åŠ ï¼Œä½†æ˜¯æ°¸ä¸è¿›ä½ï¼Œä¸æ˜¯äºŒè¿›åˆ¶ ï¼ˆa:hoverä¸º(0,0,1,1)ï¼‰ 5.CSSç›’å­borderï¼ˆä¼šå½±å“ç›’å­å¤§å°ï¼‰ border-style: solid(å®çº¿è¾¹æ¡†ï¼Œæœ€å¸¸ç”¨) dashed(è™šçº¿) dottedï¼ˆç‚¹çº¿è¾¹æ¡†ï¼‰ border-width: XXpx border-color: XX å¤å†™ï¼š border: 1px solid red è¾¹æ¡†åˆ†å¼€å†™æ³•ï¼š border-top: 1px solid red border-collapse:collapse /*ç›¸é‚»è¾¹æ¡†åˆå¹¶*/ border-top-right-radius: 15px; /*å³ä¸Šæ–¹æ”¹åœ†è§’ï¼Œæ— topï¼Œrightåˆ™å…¨éƒ¨éƒ½æ”¹*/ paddingå†…è¾¹è·ï¼ˆä¼šå½±å“ç›’å­å¤§å°ï¼Œè¦è®¾ç½®äº†ç›’å­å®½é«˜æ‰ä¼šæ’‘å¼€ï¼‰ é€‚ç”¨äºæ–‡å­—å¤§å°ä¸ä¸€çš„ç›’å­ï¼Œä¸è®¾ç½®å®½é«˜ï¼Œç›´æ¥è®¾ç½®paddingï¼Œå­—å°‘ç©ºé—´å°ã€‚å­—å¤šç©ºé—´å¤§ å­å®¹å™¨ç›’å­æ²¡è®¾ç½®å®½é«˜ï¼Œçˆ¶å®¹å™¨ç›’å­paddingä¸ä¼šè¢«æ’‘å¼€ padding: 5px; padding: 0 10px; /*åˆ†åˆ«å¯¹åº”ä¸Šä¸‹å’Œå·¦å³*/ padding-top: 5px; /*ä»…å†™ä¸Šæ–¹å†…è¾¹è·*/ marginå¤–è¾¹è·ï¼Œç›’å­å’Œç›’å­ä¹‹é—´çš„è·ç¦»ï¼ˆä¸ä¼šæ’‘å¼€ï¼‰ ä½¿ç”¨æ–¹æ³•å’Œpaddingæ˜¯ä¸€è‡´çš„ marginå¯ä»¥è®©å—çº§ç›’å­æ°´å¹³å±…ä¸­ï¼š1ç›’å­å¿…é¡»æœ‰å®½åº¦ï¼Œç›’å­å·¦å³å¤–è¾¹è·è®¾ç½®ä¸ºauto margin: 0 auto;(ä¸é€‚ç”¨äºå®šä½) è¡Œå†…å…ƒç´ æˆ–è€…è¡Œå†…å—å…ƒç´ æ°´å¹³å±…ä¸­åªéœ€åœ¨å…¶çˆ¶å…ƒç´ CSSæ ·å¼ä¸­æ·»åŠ ï¼štext-align: center; å¤–è¾¹è·åˆå¹¶é—®é¢˜1.å¤–è¾¹è·åˆå¹¶æŒ‡çš„æ˜¯ï¼Œå½“ä¸¤ä¸ªå‚ç›´å¤–è¾¹è·ï¼ˆ2ä¸ªmarginï¼‰ç›¸é‡æ—¶ï¼Œå®ƒä»¬å°†å½¢æˆä¸€ä¸ªå¤–è¾¹è·ã€‚åˆå¹¶åçš„å¤–è¾¹è·çš„é«˜åº¦ç­‰äºä¸¤ä¸ªå‘ç”Ÿåˆå¹¶çš„å¤–è¾¹è·çš„é«˜åº¦ä¸­çš„è¾ƒå¤§è€…ã€‚è€Œå·¦å³å¤–è¾¹è·ä¸åˆå¹¶ã€‚2.åœ¨CSSå½“ä¸­ï¼Œç›¸é‚»çš„ä¸¤ä¸ªç›’å­ï¼ˆå¯èƒ½æ˜¯å…„å¼Ÿå…³ç³»ä¹Ÿå¯èƒ½æ˜¯ç¥–å…ˆå…³ç³»ï¼‰çš„å¤–è¾¹è·å¯ä»¥ç»“åˆæˆä¸€ä¸ªå•ç‹¬çš„å¤–è¾¹è·ã€‚è¿™ç§åˆå¹¶å¤–è¾¹è·çš„æ–¹å¼è¢«ç§°ä¸ºæŠ˜å ï¼Œå¹¶ä¸”å› è€Œæ‰€ç»“åˆæˆçš„å¤–è¾¹è·ç§°ä¸ºæŠ˜å å¤–è¾¹è·ã€‚3.æ³¨é‡Šï¼šåªæœ‰æ™®é€šæ–‡æ¡£æµä¸­å—æ¡†çš„å‚ç›´å¤–è¾¹è·æ‰ä¼šå‘ç”Ÿå¤–è¾¹è·åˆå¹¶ã€‚è¡Œå†…æ¡†ã€æµ®åŠ¨æ¡†æˆ–ç»å¯¹å®šä½ä¹‹é—´çš„å¤–è¾¹è·ä¸ä¼šåˆå¹¶ã€‚ 4.æˆ‘ä»¬å¯ä»¥åœ¨aå…ƒç´ æˆ–è€…bå…ƒç´ å†åŒ…è£¹ä¸€ä¸ªå®¹å™¨å¹¶è§¦å‘è¯¥å®¹å™¨ç”Ÿæˆä¸€ä¸ªBFCï¼Œå°±ä¸ä¼šå‘ç”Ÿmarginé‡å äº† æ¯”å¦‚ &lt;div class=\"container\"> &lt;p>&lt;/p> &lt;/div> &lt;div class=\"container\"> &lt;p>&lt;/p> &lt;/div> overflow visible é»˜è®¤å€¼ã€‚å†…å®¹ä¸ä¼šè¢«ä¿®å‰ªï¼Œä¼šå‘ˆç°åœ¨å…ƒç´ æ¡†ä¹‹å¤–ã€‚ hidden å†…å®¹ä¼šè¢«ä¿®å‰ªï¼Œå¹¶ä¸”å…¶ä½™å†…å®¹æ˜¯ä¸å¯è§çš„ã€‚ scroll å†…å®¹ä¼šè¢«ä¿®å‰ªï¼Œä½†æ˜¯æµè§ˆå™¨ä¼šæ˜¾ç¤ºæ»šåŠ¨æ¡ä»¥ä¾¿æŸ¥çœ‹å…¶ä½™çš„å†…å®¹ã€‚ auto å¦‚æœå†…å®¹è¢«ä¿®å‰ªï¼Œåˆ™æµè§ˆå™¨ä¼šæ˜¾ç¤ºæ»šåŠ¨æ¡ä»¥ä¾¿æŸ¥çœ‹å…¶ä½™çš„å†…å®¹ã€‚ inherit è§„å®šåº”è¯¥ä»çˆ¶å…ƒç´ ç»§æ‰¿ overflow å±æ€§çš„å€¼ã€‚ ä½¿ç”¨äº†overflow: scroll æˆ–è€… overflow: auto æ‰å¯ä»¥ä½¿ç”¨scrolläº‹ä»¶çš„é‚£äº› scrollTopå±æ€§ç­‰ 6.PSjpgï¼š JPEGå¯¹è‰²å½©ä¿ç•™å¥½ï¼Œé«˜æ¸…é¢œè‰²å¤š gifï¼šå¸¸ç”¨äºå°å›¾ç‰‡åŠ¨ç”»ï¼Œå¯ä¿ç•™é€æ˜èƒŒæ™¯ pngï¼šç»“åˆjpgå’Œgifï¼Œå‚¨å­˜å½¢å¼ä¸°å¯Œï¼Œæ”¯æŒé€æ˜èƒŒæ™¯ PSDï¼šä¿å­˜PSè®¾è®¡ç¨¿ å›¾å±‚åˆ‡å›¾ï¼š é€‰å®šå›¾å±‚ï¼Œå³é”®ï¼Œå¿«é€Ÿå¯¼å‡ºä¸ºpng åˆ‡ç‰‡åˆ‡å›¾ï¼š åˆ‡ç‰‡å·¥å…·â€”ã€‹é€‰ä¸­â€”ã€‹å·¦ä¸Šè§’æ–‡ä»¶â€”ã€‹å¯¼å‡ºâ€”ã€‹å­˜å‚¨ä¸ºWebæ‰€ç”¨æ ¼å¼â€”ã€‹JPEGï¼ˆpngå¯ç”¨äºä¿å­˜é€æ˜å›¾ï¼‰ï¼ˆä¿å­˜çš„æ—¶å€™é€‰â€é€‰ä¸­çš„åˆ‡ç‰‡â€œï¼‰ psæ’ä»¶åˆ‡å›¾ï¼šéœ€è¦ä¸‹è½½Cuttermanæ’ä»¶ 7.éƒ¨ç½²ç½‘ç«™å…è´¹çš„è¿œç¨‹æœåŠ¡å™¨ï¼šhttp://free.3v.do/ 8.vhvhï¼šviewport hetght æŒ‡å½“å‰å¯è§†çª—å£é«˜åº¦ 100vhä¸º100%çš„å¯è§†åŒºåŸŸ height: 100vh; 9.BFCæˆ‘ä»¬å¸¸è¯´çš„æ–‡æ¡£æµå…¶å®åˆ†ä¸ºå®šä½æµã€æµ®åŠ¨æµã€æ™®é€šæµä¸‰ç§ã€‚è€Œæ™®é€šæµå…¶å®å°±æ˜¯æŒ‡BFCä¸­çš„FC Box æ˜¯ CSS å¸ƒå±€çš„å¯¹è±¡å’ŒåŸºæœ¬å•ä½ Formatting context æ˜¯ W3C CSS2.1 è§„èŒƒä¸­çš„ä¸€ä¸ªæ¦‚å¿µã€‚å®ƒæ˜¯é¡µé¢ä¸­çš„ä¸€å—æ¸²æŸ“åŒºåŸŸï¼Œå¹¶ä¸”æœ‰ä¸€å¥—æ¸²æŸ“è§„åˆ™ï¼Œå®ƒå†³å®šäº†å…¶å­å…ƒç´ å°†å¦‚ä½•å®šä½ï¼Œä»¥åŠå’Œå…¶ä»–å…ƒç´ çš„å…³ç³»å’Œç›¸äº’ä½œç”¨ BFCï¼šå—çº§æ ¼å¼åŒ–ä¸Šä¸‹æ–‡ï¼Œæˆ‘ä¸ªäººç†è§£çš„æ˜¯ä¸€ç§è§„åˆ™ BFCå¸ƒå±€è§„åˆ™ å†…éƒ¨çš„Boxä¼šåœ¨å‚ç›´æ–¹å‘ï¼Œä¸€ä¸ªæ¥ä¸€ä¸ªåœ°æ”¾ç½®ã€‚ Boxå‚ç›´æ–¹å‘çš„è·ç¦»ç”±marginå†³å®šã€‚å±äºåŒä¸€ä¸ªBFCçš„ä¸¤ä¸ªç›¸é‚»Boxçš„marginä¼šå‘ç”Ÿé‡å ï¼ˆmarginå¤–è¾¹è·åˆå¹¶é—®é¢˜ï¼‰ æ¯ä¸ªå…ƒç´ çš„margin boxçš„å·¦è¾¹ï¼Œ ä¸åŒ…å«å—border boxçš„å·¦è¾¹ç›¸æ¥è§¦(å¯¹äºä»å·¦å¾€å³çš„æ ¼å¼åŒ–ï¼Œå¦åˆ™ç›¸å)ã€‚å³ä½¿å­˜åœ¨æµ®åŠ¨ä¹Ÿæ˜¯å¦‚æ­¤ã€‚ BFCçš„åŒºåŸŸä¸ä¼šä¸float boxé‡å ã€‚ BFCå°±æ˜¯é¡µé¢ä¸Šçš„ä¸€ä¸ªéš”ç¦»çš„ç‹¬ç«‹å®¹å™¨ï¼Œå®¹å™¨é‡Œé¢çš„å­å…ƒç´ ä¸ä¼šå½±å“åˆ°å¤–é¢çš„å…ƒç´ ã€‚åä¹‹ä¹Ÿå¦‚æ­¤ã€‚ è®¡ç®—BFCçš„é«˜åº¦æ—¶ï¼Œæµ®åŠ¨å…ƒç´ ä¹Ÿå‚ä¸è®¡ç®—ï¼ˆæ¸…é™¤æµ®åŠ¨çš„åŸç†ï¼Œoverflow: hiddenï¼‰ è§¦å‘BFC æ ¹å…ƒç´ ï¼ˆCSS ä¸­çš„æ ¹å…ƒç´ æ˜¯æŒ‡ :root é€‰æ‹©å™¨åŒ¹é…åˆ°çš„å…ƒç´ ï¼Œåœ¨ HTML ä¸­æ˜¯ html å…ƒç´ ï¼‰ floatå±æ€§ä¸ä¸ºnone positionä¸ºabsoluteæˆ–fixed displayä¸ºinline-block, table-cell, table-caption, flex, inline-flex overflowä¸ä¸ºvisible https://segmentfault.com/a/1190000013023485 è¿™ä¸ªç½‘å€é‡Œé¢åˆç”ŸæˆBFCçš„å°æ¡ˆä¾‹ï¼Œå¾ˆæœ‰è¶£ï¼Œå¯ä»¥åŠ æ·±ç†è§£","categories":[{"name":"å‰ç«¯","slug":"å‰ç«¯","permalink":"https://taylor12138.github.io/categories/%E5%89%8D%E7%AB%AF/"}],"tags":[],"author":"Hello"},{"title":"å‰ç«¯å†—æ‚çŸ¥è¯†","slug":"å‰ç«¯å†—æ‚çŸ¥è¯†","date":"2020-05-09T16:00:00.000Z","updated":"2023-03-26T05:42:01.931Z","comments":true,"path":"2020/05/10/qian-duan-rong-za-zhi-shi/","link":"","permalink":"https://taylor12138.github.io/2020/05/10/qian-duan-rong-za-zhi-shi/","excerpt":"","text":"1.BFFBack-end for Front-endï¼ŒæœåŠ¡äºå‰ç«¯çš„åç«¯ BFFå°±æ˜¯è€ç”Ÿé•¿è°ˆçš„ä¸­é—´å±‚æ¦‚å¿µï¼Œåˆè¡·æ˜¯åœ¨åå°æœåŠ¡ä¸å‰ç«¯ä¹‹å‰æ·»åŠ ä¸€å±‚ï¼Œæ¯”å¦‚åœ¨ä¸­é—´åŠ ä¸Šä¸€ä¸ªnode.jsï¼Œåšåˆ°è¯·æ±‚çš„è½¬å‘ å’Œ æ•°æ®çš„è½¬æ¢ï¼ŒNodejsæ—¢é…åˆäº†å‰ç«¯æŠ€æœ¯æ ˆï¼Œä¹Ÿæ›´é€‚åº”å‘å¾®æœåŠ¡çš„å¹¶å‘è¯·æ±‚ BFFä½œä¸ºä¸­é—´å±‚ï¼Œä¼˜ç‚¹æ˜¯ï¼š å‰åç«¯å½»åº•åˆ†ç¦»ï¼Œå³ä¾¿æ˜¯åæœŸæœ‰å¾®æœåŠ¡è¿ç§»ï¼Œä¹Ÿä¸éœ€æ”¹åŠ¨å‰ç«¯ä»£ç  ä¸šåŠ¡æ›´å‘å‰é æ‹¢ï¼Œçç¢çš„apiç”±å‰ç«¯å¼€å‘è‡ªå·±å†³å®šï¼Œæ›´é€‚é…å‰ç«¯æ¡†æ¶ BFFå¯ä»¥è‡ªå¼€mockï¼Œæ’ä»¶ä¹Ÿèƒ½ç”ŸæˆAPIæ–‡æ¡£ï¼Œç›¸æ¯”åç«¯å•å¼€è¿™ç±»æœåŠ¡è¦æ–¹ä¾¿äº›å§ ç•™ç»™åç«¯æ›´æ¸…æ™°çš„æœåŠ¡è¾¹ç•Œï¼Œåªéœ€è¦æä¾›ç²—ç²’åº¦çš„æ¥å£å³å¯ ç¼ºç‚¹ï¼š ä¸­é—´å±‚è½¬å‘ä¼šå¢åŠ è¯·æ±‚å»¶è¿Ÿã€‚ éœ€è¦ä¿è¯ç«¯åˆ°ç«¯æµ‹è¯• å¿…é¡»éšæ—¶å‡†å¤‡å¥½åç«¯å¼‚å¸¸è¯·æ±‚ BFFåˆ†æˆä¼šå¢åŠ å¼€å‘æˆæœ¬ èµ„æ–™æ¥æºï¼šhttps://www.jianshu.com/p/9cca72f9e93c 2.VSCodeç¼–è¯‘Emmetè¯­æ³•æ’ä»¶äºå¸‚é¢ä¸Šå¤§å¤šå‰ç«¯ç¼–è¯‘è½¯ä»¶ï¼Œå¦‚VScodeæ‰€å¸¦æœ‰çš„ï¼Œä¾¿äºå¿«é€Ÿå†™htmlå’ŒCSS ç½‘é¡µç§»åŠ¨ç«¯é€‚é…ï¼Œå¼€å¯ç†æƒ³è§†å£ï¼Œç”¨äºåšç§»åŠ¨ç«¯ç½‘é¡µçš„é€‚é… &lt;meta name=\"viewport\" content=\"width=device-width, initial-scale=1\" /> h5æƒ³è¦ç”Ÿæˆå¤šä¸ªæ ‡ç­¾ï¼šdiv*10ï¼Œå†å›è½¦ï¼ˆæˆ–è€…tabï¼‰ï¼Œå³å¯ç”Ÿæˆ10ä¸ªdivæ ‡ç­¾ã€‚ ç”Ÿæˆçˆ¶å­å…³ç³»æ ‡ç­¾ï¼šdiv&gt;span,å†å›è½¦ï¼ˆæˆ–è€…tabï¼‰ï¼Œå³å¯ç”ŸæˆåŒ…å«spanæ ‡ç­¾çš„divæ ‡ç­¾ã€‚ ç”Ÿæˆå…„å¼Ÿå…³ç³»æ ‡ç­¾ï¼šdiv+span,å†å›è½¦ï¼ˆæˆ–è€…tabï¼‰ã€‚ è¾“å…¥ï¼š.nav ç›´æ¥ç”Ÿæˆä¸€ä¸ªclass=â€œnavâ€çš„divæ ‡ç­¾ã€‚(é»˜è®¤div) è¾“å…¥ï¼š#nav ç›´æ¥ç”Ÿæˆä¸€ä¸ªid=â€œnavâ€çš„divæ ‡ç­¾ã€‚ è¾“å…¥ï¼šp.nav ç›´æ¥ç”Ÿæˆä¸€ä¸ªclass=â€œnavâ€çš„pæ ‡ç­¾ã€‚ è¾“å…¥ï¼š.nav$*5 ç›´æ¥ç”Ÿæˆ5ä¸ªclass=â€œnav1â€,class=â€œnav2â€â€¦..çš„divæ ‡ç­¾ã€‚($æ˜¯è‡ªå¢ç¬¦å·) è¾“å…¥ï¼šdiv{å‰ç«¯çœŸå¥½ç©}*5 ç›´æ¥ç”Ÿæˆ5ä¸ª&lt;div&gt; å‰ç«¯çœŸå¥½ç© &lt;/div&gt; CSSæ ·å¼å†…è¾“å…¥ï¼štac ç›´æ¥ç”Ÿæˆtext-align: center; å…¶ä»–è¯­æ³•ç¼©å†™åŒæ ·ç±»ä¼¼ï¼Œè¯¸å¦‚w100â€”&gt;width: 100 æ ¼å¼åŒ–ç›´æ¥é¼ æ ‡å³é”®ï¼Œæ ¼å¼åŒ–æ–‡æ¡£ï¼Œå³å¯ç›´æ¥è®©æ–‡æ¡£å˜æ•´é½ã€‚ ï¼ˆæˆ–è€…æƒ³è¦æ¯æ¬¡ä¿å­˜åè‡ªåŠ¨æ ¼å¼åŒ–ï¼Œéœ€è¦åœ¨é¦–é¡µâ€”é¦–é€‰é¡¹â€”è®¾ç½®â€”æœç´¢emmet.include,åœ¨setting.jsonä¸‹çš„ç”¨æˆ·ï¼Œæ·»åŠ  â€œeditor.formatOnTypeâ€: true, â€œeditor.formatOnSaveâ€: true å³å¯ï¼‰ åˆæˆ–è€… On Windows Shift + Alt + F On Mac Shift + Option + F On Ubuntu Ctrl + Shift + I ç”Ÿæˆä»£ç ç‰‡æ®µsnippetæ¨¡æ¿ç½‘ç«™ https://snippet-generator.app/ ç„¶åå†vscodeä¸­ shift+control+Pè¾“å…¥snippetè¿›è¡Œä»£ç ç‰‡æ®µé…ç½®ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥ç›´æ¥è¾“å…¥æˆ‘ä»¬çš„å‰ç¼€ï¼ˆprefixï¼‰æ‹¿æˆ‘ä»¬çš„ä»£ç ç‰‡æ®µæ¨¡æ¿äº†ï¼ ä½¿ç”¨Prettierè‡ªåŠ¨æ ¼å¼åŒ–Prettieræ˜¯ä¸€ä¸ªå¼ºå¤§çš„ä»£ç æ ¼å¼åŒ–å·¥å…· æ–¹æ³•ä¸€ï¼š åœ¨vscodeä¸­å®‰è£…Prettieræ’ä»¶ é¡¹ç›®ä¸­æ–°ç”Ÿæˆ .prettierrcæ–‡ä»¶ ï¼ˆPrettier runtime compilerï¼‰ { \"semi\": false, \"singleQuote\": true, \"trailingComma\": \"none\" } useTabï¼šä½¿ç”¨tab/ç©ºæ ¼ç¼©è¿› tabWidthï¼štabæ˜¯ç©ºæ ¼çš„æƒ…å†µä¸‹ï¼Œç©ºæ ¼æ•° printWidthï¼šå½“è¡Œå­—ç¬¦é•¿åº¦ã€‚æ¨è80 singleQuoteï¼šä½¿ç”¨å•å¼•å·è¿˜æ˜¯åŒå¼•å· trailingCommaï¼šå¤šè¡Œè¾“å…¥æ—¶ï¼Œå°¾éƒ¨é€—å·æ˜¯å¦æ·»åŠ  semiå°¾éƒ¨æ˜¯å¦æ·»åŠ åˆ†å· endOfLineï¼šç»“æŸè¡Œå½¢å¼ prettieræ ¼å¼åŒ–å‚è€ƒè¡¨æ ¼https://juejin.cn/post/6938687606687432740 ä¸€èˆ¬æˆ‘ä»¬è¿˜ä¼šç»™Prettieræ·»åŠ å¿½ç•¥æ–‡ä»¶ æ­¤æ—¶åœ¨æ ¹ç›®å½•ä¸‹æ–°å»º .prettierignore æ–‡ä»¶ /dist/* .local .output.js /node_modules/** **/*.svg **/*.sh /public/*åœ¨è®¾ç½®ä¸­ save ä¸­è®¾ç½®ä¿å­˜æ—¶è‡ªåŠ¨åŒ– åœ¨ç¼–è¾‘å™¨ä¸­å³é”®æœ‰è‡ªåŠ¨æ ¼å¼åŒ–é€‰é¡¹ æ–¹æ³•äºŒï¼š ç›´æ¥åœ¨é¡¹ç›®ä¸­å®‰è£… npm i prettier -D ä¾æ—§åœ¨æ ¹ç›®å½•ä¸‹æ–°å»ºæ–‡ä»¶.prettierrcæ–‡ä»¶ ï¼ˆPrettier runtime compilerï¼‰ï¼Œå¹¶ä¸”ç¼–è¾‘ä¿å­˜ æ­¤æ—¶åœ¨æ ¹ç›®å½•ä¸‹ï¼Œå¯¹æ–‡ä»¶ä¿å­˜å³å¯ å½“ç„¶æ–¹æ³•ä¸€ã€äºŒä¸€æ­¥ä¸€æ­¥ä¿å­˜å«Œéº»çƒ¦ï¼Œä¹Ÿå¯ä»¥åœ¨ package.jsonæ–‡ä»¶ä¸‹å®è¡Œä¸€æ­¥ä¿å­˜å‘½ä»¤çš„é…ç½® \"script\": { \"prettier\": \"prettier --write .\" } jsx and tsx å¯¹äºtsxã€jsxæ–‡ä»¶ï¼Œåœ¨vscodeä¸­Prettieré»˜è®¤ä¸å¯ç”¨ éœ€è¦åœ¨vscodeä¸­çš„setting.jsonä¸­é…ç½®ï¼ˆé€šè¿‡Ctrl+Shift+P æ‰“å¼€ setting.jsonï¼‰ { \"[typescriptreact]\": { \"editor.defaultFormatter\": \"esbenp.prettier-vscode\" }, \"[javascriptreact]\": { \"editor.defaultFormatter\": \"esbenp.prettier-vscode\" }, } 3.RPCRPCæ˜¯æŒ‡è¿œç¨‹è¿‡ç¨‹è°ƒç”¨ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸¤å°æœåŠ¡å™¨Aï¼ŒBï¼Œä¸€ä¸ªåº”ç”¨éƒ¨ç½²åœ¨AæœåŠ¡å™¨ä¸Šï¼Œæƒ³è¦è°ƒç”¨BæœåŠ¡å™¨ä¸Šåº”ç”¨æä¾›çš„å‡½æ•°/æ–¹æ³•ï¼Œç”±äºä¸åœ¨ä¸€ä¸ªå†…å­˜ç©ºé—´ï¼Œä¸èƒ½ç›´æ¥è°ƒç”¨ï¼Œéœ€è¦é€šè¿‡ç½‘ç»œæ¥è¡¨è¾¾è°ƒç”¨çš„è¯­ä¹‰å’Œä¼ è¾¾è°ƒç”¨çš„æ•°æ®ã€‚ é¦–å…ˆï¼Œè¦è§£å†³é€šè®¯çš„é—®é¢˜ï¼Œä¸»è¦æ˜¯é€šè¿‡åœ¨å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´å»ºç«‹TCPè¿æ¥ ç¬¬äºŒï¼Œè¦è§£å†³å¯»å€çš„é—®é¢˜ï¼Œè¿æ¥åˆ°å¯¹åº”çš„æœåŠ¡å™¨ï¼ˆå¦‚ä¸»æœºæˆ–IPåœ°å€ï¼‰ä»¥åŠç‰¹å®šçš„ç«¯å£ ä¸¤å°æœåŠ¡å™¨ä¹‹é—´ä»¥ åºåˆ—åŒ–ä¼ è¾“æ•°æ® + ååºåˆ—åŒ–å¾—åˆ°æ•°æ®ç»“æœ ä»¥ä¸Šæ˜¯å®ƒä»¬è¿æ¥çš„å»ºç«‹å’Œæ•°æ®çš„ä¼ è¾“è¿‡ç¨‹ è¿œç¨‹è°ƒç”¨çš„é—®é¢˜ Call IDæ˜ å°„ã€‚æˆ‘ä»¬æ€ä¹ˆå‘Šè¯‰è¿œç¨‹æœºå™¨æˆ‘ä»¬è¦è°ƒç”¨Multiplyï¼Œè€Œä¸æ˜¯Addæˆ–è€…FooBarå‘¢ï¼Ÿåœ¨æœ¬åœ°è°ƒç”¨ä¸­ï¼Œå‡½æ•°ä½“æ˜¯ç›´æ¥é€šè¿‡å‡½æ•°æŒ‡é’ˆæ¥æŒ‡å®šçš„ï¼Œæˆ‘ä»¬è°ƒç”¨Multiplyï¼Œç¼–è¯‘å™¨å°±è‡ªåŠ¨å¸®æˆ‘ä»¬è°ƒç”¨å®ƒç›¸åº”çš„å‡½æ•°æŒ‡é’ˆã€‚ä½†æ˜¯åœ¨è¿œç¨‹è°ƒç”¨ä¸­ï¼Œå‡½æ•°æŒ‡é’ˆæ˜¯ä¸è¡Œçš„ï¼Œå› ä¸ºä¸¤ä¸ªè¿›ç¨‹çš„åœ°å€ç©ºé—´æ˜¯å®Œå…¨ä¸ä¸€æ ·çš„ã€‚æ‰€ä»¥ï¼Œåœ¨RPCä¸­ï¼Œæ‰€æœ‰çš„å‡½æ•°éƒ½å¿…é¡»æœ‰è‡ªå·±çš„ä¸€ä¸ªIDã€‚è¿™ä¸ªIDåœ¨æ‰€æœ‰è¿›ç¨‹ä¸­éƒ½æ˜¯å”¯ä¸€ç¡®å®šçš„ã€‚ åºåˆ—åŒ–å’Œååºåˆ—åŒ–é—®é¢˜ ç½‘ç»œä¼ è¾“é—®é¢˜ RPCçš„å¤§é¡¹ç›®é€‚ç”¨æ€§ï¼š åšä¸€ä¸ªè®¿é—®é‡ä¸å¤§çš„é¡¹ç›®çš„æ—¶å€™,ä¸€å°æœåŠ¡å™¨éƒ¨ç½²ä¸Šä¸€ä¸ªåº”ç”¨+æ•°æ®åº“ä¹Ÿå°±å¤Ÿäº†. è®¿é—®é‡ç¨å¾®å¤§ä¸€ç‚¹ä¹‹åå‘¢,éœ€è¦ï¼šé›†ç¾¤.æ¶è®¾nginx,éƒ¨ç½²å¤šä¸ªæœåŠ¡ å†å¤§ä¸€ç‚¹ï¼Œæ•°æ®åº“å·²ç»æ‰›ä¸ä½äº†,æœ‰æ—¶å€™å®•æœº. é‚£è¿™ä¸ªæ—¶å€™å‘¢æˆ‘ä»¬éœ€è¦æ•°æ®åº“è¯»å†™åˆ†ç¦»,å†æ¶è®¾å‡ å°æ•°æ®åº“æœåŠ¡å™¨,åšä¸»ä»,åšåˆ†åº“åˆ†è¡¨ã€‚ å†å¤§ä¸€ç‚¹ï¼Œæˆ‘ä»¬éœ€è¦æ‹†åˆ†æ¨¡å—ï¼Œæ‹†åˆ†é¡¹ç›®ï¼Œæ¯”å¦‚è®¢å•ç³»ç»Ÿåˆ†ä¸€ä¸ªé¡¹ç›®ï¼Œä½†æ˜¯è¿˜æ˜¯éœ€è¦åˆ‡æ¢é¡¶å±‚çš„nginx.æŠŠè¦é‡å¯çš„æœåŠ¡çš„æµé‡åˆ‡åˆ°å¯ç”¨æœåŠ¡ä¸Š. è¿™ä¸ªæ—¶å€™å°±å¯ä»¥ä½¿ç”¨RPC æ‰€æœ‰çš„æœåŠ¡åœ¨å¯åŠ¨çš„æ—¶å€™æ³¨å†Œåˆ°ä¸€ä¸ªæ³¨å†Œæœºé‡Œé¢,ç„¶åé¡¶å±‚å¤„ç†åœ¨æ¥æ”¶åˆ°nginxçš„è¯·æ±‚æ—¶,å»æ³¨å†Œæœºæ‰¾ä¸€ä¸ªå¯ç”¨çš„æœåŠ¡,å¹¶è°ƒç”¨æ¥å£. è¿™æ ·å­å‘¢,åœ¨ä¸åŠ æ–°åŠŸèƒ½çš„æ—¶å€™,é¡¶å±‚å¤„ç†æœåŠ¡æˆ‘ä»¬å°±ä¸éœ€è¦åŠ¨äº†ï¼Œé‚£ä¿®æ”¹äº†ç”¨æˆ·ä¿¡æ¯é¡¹ç›®çš„æ—¶å€™,æˆ‘ä»¬åªéœ€è¦ä¸€ä¸ªä¸ªæ›´æ–°ç”¨æˆ·ä¿¡æ¯é¡¹ç›®çš„æœåŠ¡ç¾¤å°±å¥½äº†ã€‚ éƒ¨åˆ†è§‚ç‚¹æºè‡ªhttps://www.zhihu.com/question/25536695 Native Moduleså®˜æ–¹è§£é‡Š æœ‰æ—¶ï¼ŒReact Native åº”ç”¨ç¨‹åºéœ€è¦è®¿é—® JavaScript ä¸­é»˜è®¤ä¸å¯ç”¨çš„åŸç”Ÿå¹³å° APIï¼Œä¾‹å¦‚ç”¨äºè®¿é—® Apple æˆ– Google Pay çš„åŸç”Ÿ APIã€‚ä¹Ÿè®¸ä½ æƒ³é‡ç”¨ä¸€äº›ç°æœ‰çš„ Objective-Cã€Swiftã€Java æˆ– C++ åº“ï¼Œè€Œä¸å¿…åœ¨ JavaScript ä¸­é‡æ–°å®ç°å®ƒï¼Œæˆ–è€…ä¸ºå›¾åƒå¤„ç†ä¹‹ç±»çš„äº‹æƒ…ç¼–å†™ä¸€äº›é«˜æ€§èƒ½ã€å¤šçº¿ç¨‹çš„ä»£ç ã€‚ NativeModule ç³»ç»Ÿå°† Java/Objective-C/C++ï¼ˆæœ¬æœºï¼‰ç±»çš„å®ä¾‹ä½œä¸º JS å¯¹è±¡å…¬å¼€ç»™ JavaScriptï¼ˆJSï¼‰ï¼Œä»è€Œå…è®¸æ‚¨ä» JS å†…æ‰§è¡Œä»»æ„æœ¬æœºä»£ç ã€‚è™½ç„¶æˆ‘ä»¬ä¸å¸Œæœ›æ­¤åŠŸèƒ½æˆä¸ºé€šå¸¸å¼€å‘è¿‡ç¨‹çš„ä¸€éƒ¨åˆ†ï¼Œä½†å®ƒçš„å­˜åœ¨è‡³å…³é‡è¦ã€‚å¦‚æœ React Native æ²¡æœ‰å¯¼å‡ºä½ çš„ JS åº”ç”¨ç¨‹åºéœ€è¦çš„åŸç”Ÿ APIï¼Œä½ åº”è¯¥èƒ½å¤Ÿè‡ªå·±å¯¼å‡ºå®ƒï¼ æ‰€ä»¥æˆ‘ä»¬å¯ä»¥åœ¨RNçš„é¡¹ç›®é‡Œä¸­çœ‹åˆ°å¯¼å…¥RPCæ•°æ®ä½¿ç”¨çš„æ˜¯ import {NativeModules} from 'react-native'; const NERCTAppContextModule = NativeModules.NERCTAppContextModule || {}; // iOSå®¡æ ¸å±è”½åŠŸèƒ½ const { source = '' } = NERCTAppContextModule; 4.Worker4.1 Web Worksæœ‰æ—¶å€™æˆ‘ä»¬éœ€è¦åœ¨å®¢æˆ·ç«¯è¿›è¡Œå¤§é‡çš„è¿ç®—ï¼Œä½†åˆä¸å¸Œæœ›æ¥é˜»å¡æˆ‘ä»¬jsä¸»çº¿ç¨‹ æˆ‘ä»¬å¯èƒ½ç¬¬ä¸€æ—¶é—´è€ƒè™‘çš„æ˜¯å¼‚æ­¥ï¼Œä½†æ˜¯å®é™…ä¸Šè¿ç®—é‡å¤§ã€è¿ç®—æ—¶é—´é•¿çš„ä»»åŠ¡åŒæ ·ä¼šé˜»å¡æˆ‘ä»¬å¼‚æ­¥çš„äº‹ä»¶å¾ªç¯ï¼Œç”šè‡³ä¼šå¯¼è‡´æµè§ˆå™¨çš„å‡æ­»çŠ¶æ€ æ­¤æ—¶html5çš„æ–°ç‰¹æ€§ï¼šWeb Workså°±æ´¾ä¸Šç”¨åœºï¼Œå®ƒå…è®¸æˆ‘ä»¬æŠŠå¦‚æ­¤å¤æ‚çš„é€»è¾‘æ”¾åœ¨æµè§ˆå™¨çš„åå°çº¿ç¨‹ä¸­è¿›è¡Œå¤„ç†ï¼Œè®©jsä¸é˜»å¡uiçº¿ç¨‹çš„æ¸²æŸ“ //index.js const worker = new Worker(new URL('./worker.js', import.meta.url)) worker.postMessage({ question: 'hi workerçº¿ç¨‹ï¼Œè¯·å‘Šè¯‰æˆ‘ä»Šå¤©çš„å¹¸è¿æ•°å­—æ˜¯å•¥' }) worker.onmessage = (message) => { console.log('ä»Šå¤©å¹¸è¿æ•°å­—æ˜¯ï¼š', message.data.answer) } //worker.js self.onmessage((message) => { self.postMessage({ answer: 111 }) }) 4.2 HTML5ä¸­è·¨æ–‡æ¡£æ¶ˆæ¯ä¼ é€’è·¨æ–‡æ¡£æ¶ˆæ¯ä¼ é€ï¼ˆcross-document messagingï¼‰ï¼Œæœ‰æ—¶å€™ä¹Ÿç®€ç§°ä¸ºXDMï¼ŒæŒ‡çš„æ˜¯æ¥è‡ªä¸åŒåŸŸçš„é¡µé¢é—´ä¼ é€’æ¶ˆæ¯ã€‚ ç€æ˜¯ä¸€ä¸ªbomçš„apiï¼Œ MDNï¼šwindow.postMessageã€‚ XDMçš„æ ¸å¿ƒæ˜¯postMessage()æ–¹æ³•ï¼Œå®é™…ä¸Šæˆ‘ä»¬å¯ä»¥ä½¿ç”¨postMessage()æ–¹æ³•è¿›è¡Œè·¨åŸŸ postMessageä¸¤ä¸ªå‚æ•°ï¼š data:ä½œä¸ºpostMessage()ç¬¬ä¸€ä¸ªå‚æ•°ä¼ å…¥çš„å­—ç¬¦ä¸²æ•°æ®ã€‚ origin:å‘é€æ¶ˆæ¯çš„æ–‡æ¡£æ‰€åœ¨çš„åŸŸï¼Œä¾‹å¦‚â€œhttps://www.w3cmm.comâ€ã€‚ // è·¨åŸŸå‘é€æ•°æ®åˆ°ç›®æ ‡æº window.onload = function () { document.getElementsByTagName(\"iframe\")[0].contentWindow.postMessage({name: 'wujiang'}, \"http://localhost:8090\") } // ç›‘å¬ç›®æ ‡æºå‘é€è¿‡æ¥çš„æ•°æ® window.addEventListener('message', function (e) { if(event.origin==\"http://localhost:8080\"){//æ³¨æ„originæ˜¯å‘é€æ¶ˆæ¯çš„æ–‡æ¡£æ‰€åœ¨çš„åŸŸã€‚ console.log('http://localhost:8090/a.ftl ===> http://localhost:8080/index.jsp') console.log(e) } }) 4.3 Service Workeræ¦‚è¿°Service workers æœ¬è´¨ä¸Šå……å½“ Web åº”ç”¨ç¨‹åºã€æµè§ˆå™¨ä¸ç½‘ç»œï¼ˆå¯ç”¨æ—¶ï¼‰ä¹‹é—´çš„ä»£ç†æœåŠ¡å™¨ã€‚è¿™ä¸ª API æ—¨åœ¨åˆ›å»ºæœ‰æ•ˆçš„ç¦»çº¿ä½“éªŒï¼Œå®ƒä¼šæ‹¦æˆªç½‘ç»œè¯·æ±‚å¹¶æ ¹æ®ç½‘ç»œæ˜¯å¦å¯ç”¨é‡‡å–æ¥é€‚å½“çš„åŠ¨ä½œã€æ›´æ–°æ¥è‡ªæœåŠ¡å™¨çš„çš„èµ„æºã€‚å®ƒè¿˜æä¾›å…¥å£ä»¥æ¨é€é€šçŸ¥å’Œè®¿é—®åå°åŒæ­¥ APIã€‚ï¼ˆåœ¨webpackä¸­ä½¿ç”¨service workeréœ€è¦å®‰è£…WorkboxPluginï¼‰ ç›¸å½“äºä¸€ä¸ªæœåŠ¡å™¨ä¸æµè§ˆå™¨ä¹‹é—´çš„ä¸­é—´äººè§’è‰²ï¼Œä¸€ä¸ªè¶…çº§æ‹¦æˆªå™¨ ç»†èŠ‚ åŸºäºweb worker åœ¨web workerçš„åŸºç¡€ä¸Šå¢åŠ äº†ç¦»çº¿ç¼“å­˜çš„èƒ½åŠ› å¯ä»¥æ‹¦æˆªå…¨ç«™çš„è¯·æ±‚ï¼Œå¹¶ä½œå‡ºç›¸åº”çš„åŠ¨ä½œ-&gt;ç”±å¼€å‘è€…æŒ‡å®šçš„åŠ¨ä½œ ç”±äº‹ä»¶é©±åŠ¨çš„,å…·æœ‰ç”Ÿå‘½å‘¨æœŸ å¯ä»¥è®¿é—®cacheå’ŒindexDB æ”¯æŒæ¨é€ å¹¶ä¸”å¯ä»¥è®©å¼€å‘è€…è‡ªå·±æ§åˆ¶ç®¡ç†ç¼“å­˜çš„å†…å®¹ä»¥åŠç‰ˆæœ¬ å¯ä»¥é€šè¿‡ postMessage æ¥å£æŠŠæ•°æ®ä¼ é€’ç»™å…¶ä»– JS æ–‡ä»¶ ç‰¹ç‚¹è¿™ä¸ª API ä¹‹æ‰€ä»¥ä»¤äººå…´å¥‹ï¼Œæ˜¯å› ä¸ºå®ƒå¯ä»¥æ”¯æŒç¦»çº¿ä½“éªŒï¼Œè®©å¼€å‘è€…èƒ½å¤Ÿå…¨é¢æ§åˆ¶è¿™ä¸€ä½“éªŒã€‚ï¼ˆå®é™…ä¸Šçš„ç¼“å­˜çš„æ•ˆæœï¼‰ åœ¨ Service Worker å‡ºç°å‰ï¼Œå­˜åœ¨èƒ½å¤Ÿåœ¨ç½‘ç»œä¸Šä¸ºç”¨æˆ·æä¾›ç¦»çº¿ä½“éªŒçš„å¦ä¸€ä¸ª APIï¼Œç§°ä¸º AppCacheã€‚ AppCache API å­˜åœ¨çš„è®¸å¤šç›¸å…³é—®é¢˜ï¼Œåœ¨è®¾è®¡ Service Worker æ—¶å·²äºˆä»¥é¿å…ã€‚ æ¯”å¦‚ï¼šæˆ‘ä»¬å¯ä»¥ä»¥ç½‘æ˜“æ–°é—»çš„wapé¡µä¸ºä¾‹,å…¶é’ˆå¯¹ä¸æ€ä¹ˆå˜åŒ–çš„é™æ€èµ„æºå¼€å¯äº†swç¼“å­˜ï¼ˆä¾‹å­åœ¨é‡Œé¢çš„ç¬¬å…­èŠ‚éƒ¨åˆ†ï¼‰ https://mp.weixin.qq.com/s/3Ep5pJULvP7WHJvVJNDV-g ä½¿ç”¨Service Workerä½¿ç”¨æ¡ä»¶ï¼š ä¼ è¾“åè®®å¿…é¡»ä¸º HTTPSã€‚å› ä¸º Service Worker ä¸­æ¶‰åŠåˆ°è¯·æ±‚æ‹¦æˆªï¼Œæ‰€ä»¥å¿…é¡»ä½¿ç”¨ HTTPS åè®®æ¥ä¿éšœå®‰å…¨ã€‚ åœ¨Firefoxæµè§ˆå™¨çš„ç”¨æˆ·éšç§æ¨¡å¼ï¼ŒService Workerä¸å¯ç”¨ã€‚ æ³¨å†ŒService Workerï¼ˆé€šè¿‡ .registeræ–¹æ³•è¿›è¡Œæ³¨å†Œï¼Œé€šè¿‡ .thenæ–¹æ³•è¿›è¡Œå›è°ƒï¼‰ ç›‘å¬installäº‹ä»¶ï¼Œç¼“å­˜éœ€è¦çš„æ–‡ä»¶ æ‹¦æˆªè¯·æ±‚æŸ¥çœ‹æ˜¯å¦å·²ç»æœ‰éœ€è¦çš„æ•°æ® // index.js /* åˆ¤æ–­å½“å‰æµè§ˆå™¨æ˜¯å¦æ”¯æŒserviceWorker */ if (navigator.serviceWorker) { navigator.serviceWorker .register('sw.js') .then(function(registration) { console.log('service worker æ³¨å†ŒæˆåŠŸ') //æœåŠ¡å™¨è¢«åœäº†ä¹‹åä»ç„¶ä¼šæ‰“å°å‡ºæ¥ }) .catch(function(err) { console.log('servcie worker æ³¨å†Œå¤±è´¥') }) } swå†…å¯ä»¥ä½¿ç”¨selfä¹Ÿå¯ä»¥ä½¿ç”¨this,æ¯ä¸ªswä»…ä¼šå®‰è£…ä¸€æ¬¡,é™¤éå‘ç”Ÿæ›´æ–° //sw.js //ç›‘å¬ `install` äº‹ä»¶ï¼Œå›è°ƒä¸­ç¼“å­˜æ‰€éœ€æ–‡ä»¶ //event.waitUntil ä½ å¯ä»¥ç†è§£ä¸º new Promiseï¼Œ //å®ƒæ¥å—çš„å®é™…å‚æ•°åªèƒ½æ˜¯ä¸€ä¸ª promiseï¼Œå› ä¸º,caches å’Œ cache.addAll è¿”å›çš„éƒ½æ˜¯ Promiseï¼Œ this.addEventListener('install', e => { e.waitUntil( caches.open('my-cache').then(function(cache) { return cache.addAll(['./index.html', './index.js']) //èµ„æºåˆ—è¡¨ }) ) }) // æ‹¦æˆªæ‰€æœ‰è¯·æ±‚äº‹ä»¶ // å¦‚æœç¼“å­˜ä¸­å·²ç»æœ‰è¯·æ±‚çš„æ•°æ®å°±ç›´æ¥ç”¨ç¼“å­˜ï¼Œå¦åˆ™å»è¯·æ±‚æ•°æ® this.addEventListener('fetch', e => { e.respondWith( caches.open('my-cache').then((cache) => { return cache.match(e.request.url) }) ) æ­¤æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨chromeçš„F12å¼€å‘è€…æ¨¡å¼ä¸­æŸ¥çœ‹ Application çœ‹åˆ° Service Worker å·²ç»å¯åŠ¨äº† åœ¨ Cache ä¸­ä¹Ÿå¯ä»¥å‘ç°æˆ‘ä»¬æ‰€éœ€çš„æ–‡ä»¶å·²è¢«ç¼“å­˜ è¯¥ç¤ºä¾‹éƒ¨ç½²åˆ°æœåŠ¡å™¨ä¸Šä¹‹åï¼Œç”¨æˆ·ç¬¬ä¸€æ¬¡æ‰“å¼€indexé¡µé¢ï¼Œä»ç„¶ä¼šä»æœåŠ¡å™¨ä¸Šæ‹‰å–ï¼Œä¹‹åä¾¿å»å®‰è£…Service Workerï¼Œæ‰§è¡ŒService Workerä¸­çš„installäº‹ä»¶ï¼Œæµè§ˆå™¨ä¼šå†æ¬¡æ‹‰å–éœ€è¦ç¼“å­˜çš„èµ„æºï¼Œè¿™ä¸€æ¬¡çš„ç¼“å­˜æ˜¯å¦ä»ç½‘ç»œæ‹‰å–å–å†³äºèµ„æºè®¾ç½®çš„è¿‡æœŸæ—¶é—´ã€‚å½“installäº‹ä»¶ä¸­çš„èµ„æºå‡æ‹‰å–æˆåŠŸï¼ŒService Workerç®—æ˜¯å®‰è£…æˆåŠŸã€‚å¦‚æœæœ‰ä¸€ä¸ªèµ„æºæ‹‰å–å¤±è´¥ï¼Œæ­¤æ¬¡Service Workerå®‰è£…å¤±è´¥ï¼Œè‹¥ç”¨æˆ·ä¸‹æ¬¡å†æ‰“å¼€è¯¥é¡µé¢ï¼Œæµè§ˆå™¨ä»ç„¶ä¼šé‡å¤ä¹‹å‰çš„å®‰è£…æµç¨‹å°è¯•å®‰è£…ã€‚ å¦‚æœindexé¡µé¢çš„Service Workerå®‰è£…æˆåŠŸï¼Œç”¨æˆ·å†æ¬¡æ‰“å¼€indexé¡µé¢å‘èµ·çš„èµ„æºè¯·æ±‚ä¾¿ä¼šå…ˆç»è¿‡Service Wokerè„šæœ¬çš„fetchäº‹ä»¶ï¼Œåœ¨è¯¥äº‹ä»¶ä¸­å‰ç«¯å¼€å‘å¯ä»¥é€šè¿‡ç¼–å†™é€»è¾‘æ§åˆ¶è¯·æ±‚ä»ç½‘ç»œæ‹‰å–è¿˜æ˜¯ä»cacheä¸­è¯»å–æˆ–è€…è‡ªå·±æ„é€ ä¸€ä¸ªresponseä¸¢ç»™å‰ç«¯ã€‚ æ¨é€æ¶ˆæ¯ if ('serviceWorker' in window.navigator) { navigator.serviceWorker.register('sw.js', { scope: './' }) .then(function (reg) { console.log('success', reg); navigator.serviceWorker.controller &amp;&amp; navigator.serviceWorker.controller.postMessage(\"hello im page\"); }); } //sw.js this.addEventListener('message', function (event) { console.log(event.data); }) æ¥æ”¶ä¿¡æ¯ //sw.js this.addEventListener('message', function (event) { event.source.postMessage('æˆ‘æ˜¯ sw å°†å‘é€ä¿¡æ¯åˆ° page'); }); if ('serviceWorker' in window.navigator) { navigator.serviceWorker.addEventListener('message', function (e) { console.log(e.data); }); } æ›´å¤šé€šè®¯æ–¹å¼å¯ä»¥æŸ¥çœ‹https://www.lmcc.top/articles/73.htmlï¼ˆåŒ…å«è·¨ç«¯é€šè®¯ã€ä¸¤ä¸ªswæœåŠ¡é€šè®¯ï¼‰ æ¿€æ´»service worker ä½†æ˜¯ç”±äºService Worker çš„æ¿€æ´»æ˜¯å¼‚æ­¥çš„,å› æ­¤é¦–æ¬¡æ³¨å†Œ Service Worker çš„æ—¶å€™å¯èƒ½Service Worker ä¸ä¼šè¢«ç«‹åˆ»æ¿€æ´», reg.active ä¸º Nullï¼Œç³»ç»Ÿå°±ä¼šæŠ¥é”™ã€‚è¿™ä¸ªæ—¶å€™æˆ‘ä»¬å¯ä»¥é‡‡ç”¨Promiseå†…éƒ¨è½®è¯¢é€»è¾‘è¿›è¡Œå¤„ç†å¦‚æœ Service Worker å·²ç»è¢«æ¿€æ´»é‚£å°±resolve if ('serviceWorker' in window.navigator) { navigator.serviceWorker.register('sw.js') .then(function (reg) { return new Promise((resolve, reject) => { const interval = setInterval(function () { if (reg.active) { clearInterval(interval); resolve(reg.active); } }, 50) }) }).then(sw => { sw.postMessage(\"im sw\"); }) navigator.serviceWorker.register('sw2.js') .then(function (reg) { return new Promise((resolve, reject) => { const interval = setInterval(function () { if (reg.active) { clearInterval(interval); resolve(reg.active); } }, 50) }) }).then(sw => { sw.postMessage(\"im sw2\"); }) } ç”Ÿå‘½å‘¨æœŸé¦–æ¬¡åŠ è½½ æ³¨å†Œ(register) å®‰è£…(installing) æ´»åŠ¨(activated)æˆ–è€…å¼‚å¸¸(error) å¯ä»¥æ›´æ–°å­˜å‚¨åœ¨Cacheä¸­çš„keyå’Œvalue ç©ºé—²(idle) æ‹¦æˆª(fetch)æˆ–ç»ˆæ­¢(terminated) fetchæ˜¯æœ€é‡è¦çš„ä¸€ä¸ªé˜¶æ®µï¼Œæ‹¦æˆªä»£ç†æ‰€æœ‰æŒ‡å®šçš„è¯·æ±‚ï¼Œå¹¶è¿›è¡Œå¯¹åº”çš„æ“ä½œ æ›´æ–°åŠ è½½ æ›´æ–°(update) å®‰è£…(installing) ç­‰å¾…æ´»åŠ¨(waiting)æˆ–è€…å¼‚å¸¸(error) ç”Ÿå‘½å‘¨æœŸæµç¨‹å›¾ï¼ˆç”Ÿå‘½å‘¨æœŸç« èŠ‚ï¼‰ï¼ˆååˆ†æ¨èï¼æ¡ç†æ¸…æ™°ï¼‰https://xie.infoq.cn/article/d6db2099c0064563a403c51ec æ³¨æ„çš„ç‚¹1ã€Service Workerçº¿ç¨‹è¿è¡Œçš„æ˜¯jsï¼Œæœ‰ç€ç‹¬ç«‹çš„jsç¯å¢ƒï¼Œä¸èƒ½ç›´æ¥æ“ä½œDOMæ ‘ï¼Œä½†å¯ä»¥é€šè¿‡postMessageä¸å…¶æœåŠ¡çš„å‰ç«¯é¡µé¢é€šä¿¡ã€‚ 2ã€Service WorkeræœåŠ¡çš„ä¸æ˜¯å•ä¸ªé¡µé¢ï¼Œå®ƒæœåŠ¡çš„æ˜¯å½“å‰ç½‘ç»œpathä¸‹æ‰€æœ‰çš„é¡µé¢ï¼Œåªè¦å½“å‰path çš„Service Workerè¢«å®‰è£…ï¼Œç”¨æˆ·è®¿é—®å½“å‰pathä¸‹çš„ä»»æ„é¡µé¢å‡ä¼šå¯åŠ¨è¯¥Service Workerã€‚å½“ä¸€æ®µæ—¶é—´æ²¡æœ‰äº‹ä»¶è¿‡æ¥ï¼Œæµè§ˆå™¨ä¼šè‡ªåŠ¨åœæ­¢Service Workeræ¥èŠ‚çº¦èµ„æºï¼Œæ‰€ä»¥Service Workerçº¿ç¨‹ä¸­ä¸èƒ½ä¿å­˜éœ€è¦æŒä¹…åŒ–çš„ä¿¡æ¯ã€‚ 3ã€Service Workerå®‰è£…æ˜¯åœ¨åå°æ‚„æ‚„æ‰§è¡Œï¼Œæ›´æ–°ä¹Ÿæ˜¯å¦‚æ­¤ã€‚æ¯æ¬¡æ–°å”¤èµ·Service Workerçº¿ç¨‹ï¼Œå®ƒéƒ½ä¼šå»æ£€æŸ¥Service Workerè„šæœ¬æ˜¯å¦æœ‰æ›´æ–°ï¼Œå¦‚æœ‰ä¸€ä¸ªå­—èŠ‚çš„å˜åŒ–ï¼Œå®ƒéƒ½ä¼šæ–°èµ·ä¸€ä¸ªService Workerçº¿ç¨‹ç±»ä¼¼äºå®‰è£…ä¸€æ ·å»å®‰è£…æ–°çš„Service Workerè„šæœ¬ï¼Œå½“æ—§çš„Service Workeræ‰€æœåŠ¡çš„é¡µé¢éƒ½å…³é—­åï¼Œæ–°çš„Service Workerä¾¿ä¼šç”Ÿæ•ˆã€‚ æ›´å¤šservice worker æ¡†æ¶åº“ç”±äºgoogleæ¨å‡ºç›´æ¥ç¼–å†™åŸç”Ÿswæ¯”è¾ƒç¹çå’Œå¤æ‚æ‰€ä»¥ä¸€äº›å·¥å…·æ¡†æ¶å°±å‡ºç°äº†,è€ŒWorkboxç›¸å¯¹æ¥è¯´è¾ƒä¸ºä¼˜ç§€ åœ¨ Workbox ä¹‹å‰ï¼ŒGoogleChrome å›¢é˜Ÿè¾ƒæ—©æ—¶é—´æ¨å‡ºè¿‡ sw-precache å’Œ sw-toolbox åº“ï¼Œä½†æ˜¯åœ¨ GoogleChrome å·¥ç¨‹å¸ˆä»¬çœ‹æ¥ï¼Œworkbox æ‰æ˜¯çœŸæ­£èƒ½æ–¹ä¾¿ç»Ÿä¸€çš„å¤„ç†ç¦»çº¿èƒ½åŠ›çš„æ›´å®Œç¾çš„æ–¹æ¡ˆï¼Œæ‰€ä»¥åœæ­¢äº†å¯¹ sw-precache å’Œ sw-toolbox çš„ç»´æŠ¤ã€‚ å‚è€ƒï¼š https://zhuanlan.zhihu.com/p/115243059 https://x5.tencent.com/product/service-worker.html https://mp.weixin.qq.com/s/3Ep5pJULvP7WHJvVJNDV-g https://www.lmcc.top/articles/73.html https://xie.infoq.cn/article/d6db2099c0064563a403c51ec 5.GIFä¸ŠæŠ¥åŸ‹ç‚¹ä½¿ç”¨GIFä¸ŠæŠ¥çš„åŸå› ï¼š å›¾åƒç±»å¯ä»¥è§£å†³è·¨åŸŸçš„é—®é¢˜ é˜²æ­¢é˜»å¡é¡µé¢çš„åŠ è½½ ç›¸æ¯”png/jpgï¼Œgifä½“ç§¯æœ€å°ï¼Œæœ€å°çš„bmpæ–‡ä»¶éœ€è¦74Bï¼Œpngéœ€è¦67Bï¼Œè€Œåˆæ³•çš„gifåªéœ€è¦43B ç”¨gifæŠ¥åŸ‹ç‚¹å¤§å¤šæ•°é‡‡ç”¨1*1é€æ˜GIFä¸ŠæŠ¥ 6.jsonserverå¯ä»¥ç”¨äºä¸´æ—¶æ¨¡æ‹Ÿåç«¯æ¥å£æ•°æ®ï¼Œåªéœ€è¦ä¸€ä¸ªjsonæ–‡ä»¶å³å¯ï¼ˆjsonserverå†…ç½®å¸®ä½ è§£å†³äº†è·¨åŸŸé—®é¢˜ï¼Œè®¾ç½®äº†ï¼‰ ä½¿ç”¨æµç¨‹Install JSON Server npm install -g json-serverCreate a db.json file with some data { &quot;posts&quot;: [ { &quot;id&quot;: 1, &quot;title&quot;: &quot;json-server&quot;, &quot;author&quot;: &quot;typicode&quot; } ], &quot;comments&quot;: [ { &quot;id&quot;: 1, &quot;body&quot;: &quot;some comment&quot;, &quot;postId&quot;: 1 } ], &quot;profile&quot;: { &quot;name&quot;: &quot;typicode&quot; } }Start JSON Server json-server --watch db.json æˆ–è€…æŒ‡å®šå¥½ç«¯å£å· json-server --watch db.json --port 8000 Now if you go to http://localhost:3000/posts/1, youâ€™ll get { &quot;id&quot;: 1, &quot;title&quot;: &quot;json-server&quot;, &quot;author&quot;: &quot;typicode&quot; }å¢åˆ æ”¹æŸ¥æ­¤æ—¶ä½ è¿˜å¯ä»¥é€šè¿‡è®¾ç½®è¯·æ±‚çš„methodï¼Œæ¥å¢åˆ æ”¹æŸ¥ æŸ¥ getï¼š http://localhost:8000/posts/1http://localhost:8000/posts?id=1ç›´æ¥æŸ¥è¯¢åˆ°idä¸º1çš„æ¥å£æ•°æ®ï¼ˆè‡ªåŠ¨æ£€ç´¢ ï¼‰ å¢åŠ æ•°æ® post axios.post(\"http://localhost:8000/posts\", { { \"id\": 2, \"title\": \"json-server\", \"author\": \"typicode\" } }) ä¿®æ”¹æ•°æ® putã€patch axios.patch(\"http://localhost:8000/posts/1\", { { \"title\": \"json-server\" } }) åˆ é™¤æ•°æ® delete åœ¨åˆ é™¤æ•°æ®çš„æ—¶å€™ï¼Œè‹¥å¯¹äºä¸åŒçš„æ•°æ®è¡¨ï¼Œæœ‰å…³è”çš„æ•°æ®ä¹Ÿä¼šä¸€å¹¶åˆ é™¤ æ¯”å¦‚ { \"posts\": [ { \"id\": 1, \"title\": \"json-server\", \"author\": \"typicode\" }, { \"id\": 2, \"title\": \"other\", \"author\": \"othercode\" } ], \"comments\": [ { \"id\": 1, \"body\": \"some comment\", \"postId\": 1 } ], } æ­¤æ—¶ comments ç¬¬ä¸€ä¸ªæ•°æ®æœ‰ä¸€ä¸ªå­—æ®µæ˜¯ postIdï¼Œä¼šå’Œ postsä¸­idä¸º1çš„æ•°æ®è¿›è¡Œå…³è”ï¼Œæ­¤æ—¶åˆ é™¤æ‰postsçš„ç¬¬ä¸€æ¡æ•°æ®ï¼Œåˆ™è¿å¸¦commentsçš„æ•°æ®ä¹Ÿä¼šè¢«åˆ é™¤æ‰ å…³è”æ•°æ®ä¸Šé¢å†2åˆ é™¤æ•°æ®ä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æœ‰éƒ¨åˆ†çš„æ•°æ®æ˜¯å…³è”çš„ å¦‚æœæˆ‘ä»¬æƒ³è¦åœ¨getçš„æ—¶å€™ï¼Œå¸¦ä¸Šå…³è”çš„æ•°æ®ï¼Œæˆ‘ä»¬è¦ç”¨ _embed æˆ–è€… _expand å­—æ®µ _embed ï¼šè·å–å‘ä¸‹å…³è”çš„æ•°æ® _expand ï¼šè·å–å‘ä¸Šå…³è”çš„æ•°æ® //å…³è”çš„è¡¨æ˜¯comments axios.post(\"http://localhost:8000/posts?_embed=comments\").then(res => { console.log(res) }) //å­—æ®µæ˜¯postIdï¼Œæ‰€ä»¥è¦ç”¨postï¼Œè€Œä¸æ˜¯posts axios.post(\"http://localhost:8000/comments?_expand=post\").then(res => { console.log(res) }) 7.ç½‘ç»œåŸºç¡€çŸ¥è¯†åŒºå—é“¾åŒºå—é“¾æˆ‘ä¸ªäººè®¤ä¸ºå°±æ˜¯ä¸€ä¸ªå»ä¸­å¿ƒåŒ–çš„ä¸€ä¸ªæ•°æ®å­˜å‚¨ä¸­å¿ƒï¼Œé‡Œé¢è®°å½•äº†æ¯ä¸ªäººæ˜¯ä»€ä¹ˆã€æ‹¥æœ‰ä»€ä¹ˆï¼Œå¹¶ä¸è¢«æŸä¸€å…¬å¸æ‰€å„æ–­ï¼Œè€Œæ˜¯ç”±ä¸–ç•Œä¸Šæ¯ä¸ªäººé€šè¿‡äº’è”ç½‘æ¥ç»´æŠ¤çš„å­˜å‚¨ä¸­å¿ƒï¼ˆè®°è´¦æœ¬ï¼‰ web3Web 1.0 é˜¶æ®µï¼Œç”¨æˆ·æ˜¯å•çº¯çš„å†…å®¹æ¶ˆè´¹è€…ï¼Œå†…å®¹ç”±ç½‘ç«™æä¾›ï¼Œç½‘ç«™è®©ä½ çœ‹ä»€ä¹ˆï¼Œä½ å°±çœ‹ä»€ä¹ˆï¼Œå…¸å‹ä¾‹å­å°±æ˜¯æ–°é—»é—¨æˆ·ç½‘ç«™ã€‚ Web 2.0 é˜¶æ®µï¼Œç”¨æˆ·æ˜¯å†…å®¹çš„ç”Ÿäº§è€…ï¼Œç½‘ç«™åªæ˜¯ä¸€ä¸ªå‘ç”¨æˆ·æä¾›æœåŠ¡çš„å¹³å°ï¼Œå…¸å‹çš„ Web 2.0 å¹³å°æœ‰ç»´åŸºç™¾ç§‘ã€æŠ–éŸ³ã€å¾®ä¿¡ç­‰ç­‰ã€‚ Web3 çš„å¾ˆå¤šç‰¹å¾è¿˜ä¸æ˜ç¡®ï¼Œä½†æ˜¯å›½å¤–å¾ˆå¤šæ–‡ç« è®¤ä¸ºï¼Œå®ƒè·ŸåŒºå—é“¾æœ‰å…³ã€‚ï¼ˆé€šè¿‡åŒºå—é“¾ï¼Œæˆ‘ä»¬åœ¨è™šæ‹Ÿä¸–ç•Œä¸­å¾—ä»¥ç”Ÿå­˜ï¼Œæ— æ³•è¢«æŸä¸ªå¼ºå¤§çš„é›†å›¢ / å…¬å¸ å„æ–­ï¼‰ Web 1.0 æ˜¯ç”¨æˆ·è¯»å–äº’è”ç½‘ï¼ŒWeb 2.0 æ˜¯ç”¨æˆ·å†™å…¥äº’è”ç½‘ï¼ŒWeb3 æ˜¯ç”¨æˆ·ç”Ÿæ´»åœ¨äº’è”ç½‘ã€‚ å‚è€ƒï¼š https://www.ruanyifeng.com/blog/2021/12/web3.html https://pizzaparty.substack.com/p/the-metaverse-abstracted-reality 8.å‰ç«¯å‘å±•å²https://developer.51cto.com/article/712519.html","categories":[{"name":"å‰ç«¯","slug":"å‰ç«¯","permalink":"https://taylor12138.github.io/categories/%E5%89%8D%E7%AB%AF/"}],"tags":[],"author":"Hello"},{"title":"ä¸»é¢˜ä¸2däººç‰©","slug":"ä¸»é¢˜ä¸2däººç‰©","date":"2020-05-05T17:03:19.452Z","updated":"2020-05-05T17:03:19.452Z","comments":true,"path":"2020/05/06/zhu-ti-yu-2d-ren-wu/","link":"","permalink":"https://taylor12138.github.io/2020/05/06/zhu-ti-yu-2d-ren-wu/","excerpt":"","text":"Startäººç‰©ä½¿ç”¨å‘½ä»¤å®‰è£…npmï¼šnpm uninstall hexo-helper-live2d npm install â€“save hexo-helper-live2dæ­¤æ—¶åœ¨blog/node_modelesä¸‹å¤šå‡ºäº†ä¸€ä¸ªâ€œlive2d-widgetâ€ä¸‹è½½åŠ¨ç”»modelï¼šè¿™é‡Œæ˜¯å¥—ç”¨åˆ«äººï¼ˆå¤§ä½¬ï¼‰çš„ä»“åº“https://github.com/xiazeyu/live2d-widget-models.gitä¸‹è½½å¥½åå°†packagesé‡Œçš„æ‰€æœ‰æ–‡ä»¶æ‹·è´åˆ°blog/node_modelesæœ€ååœ¨winä½¿ç”¨padnote _config.ymlï¼ŒæŠŠä»¥ä¸‹ï¼šlive2d: enable: true pluginModelPath: assets/ model: use: live2d-widget-model-epsilon2_1 #æ¨¡æ¿ç›®å½•ï¼Œåœ¨node_modulesé‡Œ display: position: right width: 150 height: 300 mobile: show: false #æ˜¯å¦åœ¨æ‰‹æœºè¿›è¡Œæ˜¾ç¤º å¤åˆ¶è¿›å» å†ä½¿ç”¨hexo clean g dè¿›è¡Œéƒ¨ç½² ä¸»é¢˜ä¸‹è½½å¥½äº†ä¹‹åæ”¾å…¥blog/themesé‡Œé¢ï¼ˆæ•´ä¸ªæ–‡ä»¶ï¼‰å†åœ¨winä½¿ç”¨padnote _config.ymlæŠŠtheme: xxæ”¹æˆtheme: (ä½ è¦çš„ä¸»é¢˜å)æœ€åéƒ¨ç½²","categories":[],"tags":[],"author":"Hello"}],"categories":[{"name":"å‰ç«¯","slug":"å‰ç«¯","permalink":"https://taylor12138.github.io/categories/%E5%89%8D%E7%AB%AF/"},{"name":"ç½‘ç»œ","slug":"ç½‘ç»œ","permalink":"https://taylor12138.github.io/categories/%E7%BD%91%E7%BB%9C/"},{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"https://taylor12138.github.io/categories/%E7%AE%97%E6%B3%95/"},{"name":"personal","slug":"personal","permalink":"https://taylor12138.github.io/categories/personal/"},{"name":"matlab","slug":"matlab","permalink":"https://taylor12138.github.io/categories/matlab/"}],"tags":[]}